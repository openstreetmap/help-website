<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Routing traffic from primary router to firewall with IPSec tunnel not working - Wireshark Q&amp;A</title>
        <meta name="description" content="I have both a ASUS RT-AC68U primary router and a Zywall USG20W firewall connected to the Internet. The firewall supports an IPSec tunnel to a remote location. The primary router has a static route for the remote network pointed to the LAN firewall connection. All routing appears to be working. When ..." />
        <meta name="keywords" content="firewall,router,ipsec" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/42947/routing-traffic-from-primary-router-to-firewall-with-ipsec-tunnel-not-working" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/42947/routing-traffic-from-primary-router-to-firewall-with-ipsec-tunnel-not-working?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='CNvocSj1GKQujFGpMKDkLxTaCWUOWwkr' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/42947/routing-traffic-from-primary-router-to-firewall-with-ipsec-tunnel-not-working">Routing traffic from primary router to firewall with IPSec tunnel not working</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-42947-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/42947/up/" rel="nofollow"> </a>
<div id="post-42947-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-42947-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/42947/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/42947/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>I have both a ASUS RT-AC68U primary router and a Zywall USG20W firewall connected to the Internet.  The firewall supports an IPSec tunnel to a remote location.  The primary router has a static route for the remote network pointed to the LAN firewall connection.  All routing appears to be working.  When in this configuration I cannot bring up an https session with my remote NAS box.  If I add a router to my PC for the remote network pointed directly to the firewall, the https session works fine.  So, bouncing the traffic thru the primary router is not working.  Running wireshark, I see the following error messages:</p>
<p>171 16.375639000    172.29.35.30    172.29.27.100   TCP 66  [TCP Spurious Retransmission] 443→1682 [SYN, ACK] Seq=0 Ack=1 Win=5840 Len=0 MSS=1386 SACK_PERM=1 WS=16</p>
<p>172 16.375701000    172.29.27.100   172.29.35.30    TCP 66  [TCP Dup ACK 133#1] 1682→443 [ACK] Seq=210 Ack=1 Win=66304 Len=0 SLE=0 SRE=1</p>
<p>I did try lowering my MTU on the PC Ethernet port to 1386 thinking the primary router may be passing too large of a packet for the IPSec tunnel on the Firewall, but the same problem occurred.  Any thoughts on what might be happening?</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/firewall/" class="post-tag tag-link-firewall"
                                        title="see questions tagged 'firewall'" rel="tag">firewall</a>
                                
                                    <a href="/tags/router/" class="post-tag tag-link-router"
                                        title="see questions tagged 'router'" rel="tag">router</a>
                                
                                    <a href="/tags/ipsec/" class="post-tag tag-link-ipsec"
                                        title="see questions tagged 'ipsec'" rel="tag">ipsec</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>07 Jun '15, 11:04</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f815dcd043dee3bc2e98014e2a2b93b3?s=32&amp;d=identicon&amp;r=g" alt="SedonaRider's gravatar image" />
    <p><a href="/users/17604/sedonarider">SedonaRider</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">&#9679;</span><span class="badgecount">4</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="SedonaRider has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-42947">
    
        <a name="42949"></a>
        <div class="comment" id="comment-42949">
            <div id="post-42949-score" class="comment-score"></div>
            <div class="comment-text"><p>Could you provide us a trace on cloudshark or dropbox?</p></div>
            <div class="comment-info" id="comment-42949-info">
                
                
                
                

                

                <span class="comment-age">(07 Jun '15, 11:59)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
        <a name="42950"></a>
        <div class="comment" id="comment-42950">
            <div id="post-42950-score" class="comment-score"></div>
            <div class="comment-text"><p>It is my first time using Cloudshark, but I think it is now uploaded.  The URL is:  <a href="https://www.cloudshark.org/captures/c8bf551babc8">https://www.cloudshark.org/captures/c8bf551babc8</a><br>
</p>

<p>My PC is 172.29.27.100 and the NAS box is 172.29.35.30</p>

<p>I should add that I have a ping monitor running in the background which works fine, indicating the routing is set up correctly from my PC to the primary router, to the firewall, across the IPSec VPN to the remote location and back.<br>
</p></div>
            <div class="comment-info" id="comment-42950-info">
                
                
                
                

                

                <span class="comment-age">(07 Jun '15, 13:19)</span>
                <a class="comment-user userinfo" href="/users/17604/sedonarider">SedonaRider</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-42947" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-42947-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    3 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/42947/routing-traffic-from-primary-router-to-firewall-with-ipsec-tunnel-not-working?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/42947/routing-traffic-from-primary-router-to-firewall-with-ipsec-tunnel-not-working?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/42947/routing-traffic-from-primary-router-to-firewall-with-ipsec-tunnel-not-working?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/42947/routing-traffic-from-primary-router-to-firewall-with-ipsec-tunnel-not-working?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="42952"></a>
                    <div id="answer-container-42952" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-42952-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/42952/up/" rel="nofollow"> </a>
<div id="post-42952-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-42952-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/42952/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>What I can say is that the SYN and the ICMP Request got an answer.
But the ACK of the 3Way Handshake and all other following packets don´t reach the NAS. The cause I can´t tell you at the moment. Can you trace next to the internal FW or the NAS? </p>
<p>And as you told you send to the router Asus and the Answers are sent from the FW directly to the client. So it could be interesting what happens between Router and FW.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/42952/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>07 Jun '15, 15:31</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/3b24b339fc62fb46dced6a443d3202ea?s=32&amp;d=identicon&amp;r=g" alt="Christian_R's gravatar image" />
    <p><a href="/users/16160/christian_r">Christian_R</a><br/>
    <span class="score" title="1830 reputation points"><span class="">1.8k</span></span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="6 badges"><span class="silver">&#9679;</span><span class="badgecount">6</span></span><span title="25 badges"><span class="bronze">&#9679;</span><span class="badgecount">25</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Christian_R has 25 accepted answers">16&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-42952">
    
        <a name="42953"></a>
        <div class="comment" id="comment-42953">
            <div id="post-42953-score" class="comment-score"></div>
            <div class="comment-text"><p>Thank you for looking at the records.  It is surprising that bouncing the packet thru the primary router would disrupt the communication.  I uploaded a trace of where I have the static route in my PC and the communication works fine.<br>
</p>

<p><a href="https://www.cloudshark.org/captures/56ac591188f5">https://www.cloudshark.org/captures/56ac591188f5</a></p>

<p>I am not experienced with reading traces, but I do see what you are saying when comparing it to the trace where it works.<br>
</p>

<p>I agree it would be good to see what is happening between the ASUS and firewall, plus probably the firewall and NAS box at the remote location.  The ASUS static route is working for packets, so I would suspect the packet is being forwarded to the firewall.  There are no error or blocked messages in the log, so it would seem the firewall would pass this forward to the NAS box as it has the other messages.  I wonder if there is something in the SSL handshake that does not like the return being one hop shorter.  <br>
</p></div>
            <div class="comment-info" id="comment-42953-info">
                
                
                
                

                

                <span class="comment-age">(07 Jun '15, 17:49)</span>
                <a class="comment-user userinfo" href="/users/17604/sedonarider">SedonaRider</a>
                
            </div>
        </div>
    
        <a name="42959"></a>
        <div class="comment" id="comment-42959">
            <div id="post-42959-score" class="comment-score"></div>
            <div class="comment-text"><p>It is like I guessed. But why it is so I Can't tell you without further documentation.</p></div>
            <div class="comment-info" id="comment-42959-info">
                
                
                
                

                

                <span class="comment-age">(08 Jun '15, 00:13)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-42952" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-42952-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="42957"></a>
                    <div id="answer-container-42957" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-42957-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/42957/up/" rel="nofollow"> </a>
<div id="post-42957-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-42957-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/42957/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>I'm personally seeing 4 or so (RST,ACK) packets to that IP address of 172.29.35.30. Which tells me that packets are indeed getting there, however, something (possibly a firewall) is blocking traffic to there. Please correct me if I'm wrong guys. </p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/42957/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>07 Jun '15, 21:55</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/4784c5fb1a0142030d51a339706a456c?s=32&amp;d=identicon&amp;r=g" alt="Beldum's gravatar image" />
    <p><a href="/users/9297/beldum">Beldum</a><br/>
    <span class="score" title="49 reputation points">49</span><span title="11 badges"><span class="badge1">&#9679;</span><span class="badgecount">11</span></span><span title="11 badges"><span class="silver">&#9679;</span><span class="badgecount">11</span></span><span title="16 badges"><span class="bronze">&#9679;</span><span class="badgecount">16</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Beldum has no accepted answers">0&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-42957">
    
        <a name="42961"></a>
        <div class="comment" id="comment-42961">
            <div id="post-42961-score" class="comment-score"></div>
            <div class="comment-text"><p>The RST are send by the client. In this case they are just a follow up.</p></div>
            <div class="comment-info" id="comment-42961-info">
                
                
                
                

                

                <span class="comment-age">(08 Jun '15, 00:17)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
        <a name="42962"></a>
        <div class="comment" id="comment-42962">
            <div id="post-42962-score" class="comment-score"></div>
            <div class="comment-text"><p>Ok got it, but what could be causing the client to be sending the RST packets? I do see that the 3-way handshake is successful to 172.29.35.30 and then there is a client Hello at the ssl handshake, then there are a whole bunch of Hello retransmissions from the client to the NAS.</p></div>
            <div class="comment-info" id="comment-42962-info">
                
                
                
                

                

                <span class="comment-age">(08 Jun '15, 00:23)</span>
                <a class="comment-user userinfo" href="/users/9297/beldum">Beldum</a>
                
            </div>
        </div>
    
        <a name="42963"></a>
        <div class="comment" id="comment-42963">
            <div id="post-42963-score" class="comment-score"></div>
            <div class="comment-text"><p>The prob is that the 3way handshake is not succesfully for both sides. The NAS is missing the ACK (asuming , because I only have the trace of the client)
And the RST is probably application related in this case.</p></div>
            <div class="comment-info" id="comment-42963-info">
                
                
                
                

                

                <span class="comment-age">(08 Jun '15, 00:33)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-42957" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-42957-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="42983"></a>
                    <div id="answer-container-42983" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-42983-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/42983/up/" rel="nofollow"> </a>
<div id="post-42983-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-42983-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/42983/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Apparently there is asymmetric routing in your setup.</p>
<p><strong>Frame #1:</strong> Source/Destination MAC both Austek. So, the SYN goes to your ASUS router <br>
<strong>Frame #2:</strong> Source MAC Zyxel: Destination MAC: Austek. So, the SYN-ACK went trough the ZyWall. It's strange that the firewall let it pass, as it has not seen the SYN frame, <strong>UNLESS</strong> the Asus router does a L2 forward to the Zywall (which comments in the question suggest). <br>
<strong>Frame #3:</strong> Source/Destination MAC both Austek. So, the SYN goes to your ASUS router, as well as the next few frames. </p>
<p>The ZyWall is a statefull firewall, and those devices don't like to see only parts of a TCP connection. They <strong>need</strong> to see the whole traffic to be able to handle it correctly.</p>
<p>To test my assumption, please add a route to the remote network to the ZyWall on your PC. If that works, there is something wrong with the L2 forward of the router to the Firewall (maybe the firewall does some MAC checks as well). If it does not work, even with the route to the firewall, there is something else broken in your network and/or router/firewall. However, it's impossible to figure out what, by looking at capture files! So, in that case, please double check the configuration of all involved systems and ask your local ZyWall guru for help.</p>
<p>Regards <br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/42983/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>08 Jun '15, 12:53</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-42983">
    
        <a name="42984"></a>
        <div class="comment" id="comment-42984">
            <div id="post-42984-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes, the route is asymmetrical.  I have added the route to the remote network to my PC so it points directly to the Zywall firewall instead of the primary router and everything works fine.  I had not thought of the firewall doing mac checks.  It is a good point.  However, you would think something would turn up in the log of the Zywall if it detects a problem.  I wonder if the ReadyNAS box is detecting a different hop count each way and dropping the session.  Hence, the reason why no message is returned. I have not found a log to check on that box. </p></div>
            <div class="comment-info" id="comment-42984-info">
                
                
                
                

                

                <span class="comment-age">(08 Jun '15, 13:36)</span>
                <a class="comment-user userinfo" href="/users/17604/sedonarider">SedonaRider</a>
                
            </div>
        </div>
    
        <a name="42985"></a>
        <div class="comment" id="comment-42985">
            <div id="post-42985-score" class="comment-score"></div>
            <div class="comment-text"><p>It's (most certainly) <strong>not</strong> the NAS, as a different hop count (TTL) is totally normal and should not lead to any network disruption. </p>

<p>I think it's the ZyWall, even if it does not log anything. Could be a bug or a simple (missing) config option.</p></div>
            <div class="comment-info" id="comment-42985-info">
                
                
                
                

                

                <span class="comment-age">(08 Jun '15, 13:41)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="42993"></a>
        <div class="comment" id="comment-42993">
            <div id="post-42993-score" class="comment-score"></div>
            <div class="comment-text"><p>If the NAS had a problem with TTL counts, it would not allowed to connect the nas to a network where a dynamic routing protocol is active.</p></div>
            <div class="comment-info" id="comment-42993-info">
                
                
                
                

                

                <span class="comment-age">(08 Jun '15, 22:30)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-42983" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-42983-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/42947/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='CNvocSj1GKQujFGpMKDkLxTaCWUOWwkr' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/42947/routing-traffic-from-primary-router-to-firewall-with-ipsec-tunnel-not-working?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/42947/routing-traffic-from-primary-router-to-firewall-with-ipsec-tunnel-not-working?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/router/"
            class="tag-link-router"
            title="see questions tagged'router'using tags"
            rel="tag">router</a> <span class="tag-number">&#215;58</span><br/>
        
        <a href="/tags/firewall/"
            class="tag-link-firewall"
            title="see questions tagged'firewall'using tags"
            rel="tag">firewall</a> <span class="tag-number">&#215;23</span><br/>
        
        <a href="/tags/ipsec/"
            class="tag-link-ipsec"
            title="see questions tagged'ipsec'using tags"
            rel="tag">ipsec</a> <span class="tag-number">&#215;19</span><br/>
        
    </p>
    <p>
        question asked: <strong title="June 7, 2015, 11:04 a.m.">07 Jun '15, 11:04</strong>
    </p>
    <p> 
     	question was seen: <strong>2,956 times</strong>
    </p>
    <p> 
        last updated: <strong title="June 8, 2015, 10:30 p.m.">08 Jun '15, 22:30</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/3277/http-post-command-not-received-and-mss-value-changed-in-transit">HTTP POST command not received and MSS value changed in transit</a>
        </p>
        
        <p>
            <a href="/questions/51711/not-able-to-see-firewall-acl-rules-option-in-tools-menu-in-wireshark-202">[closed] Not able to see &quot;firewall ACL Rules&quot; option in tools menu in wireshark 2.0.2 ?</a>
        </p>
        
        <p>
            <a href="/questions/13467/hacking-wifi-router">Hacking wifi router</a>
        </p>
        
        <p>
            <a href="/questions/28192/home-router-repetitive-arp-request">home router repetitive ARP request</a>
        </p>
        
        <p>
            <a href="/questions/42858/can-wifi-router-run-wireshark">Can Wifi router run Wireshark?</a>
        </p>
        
        <p>
            <a href="/questions/13022/decrypting-esp-packets-verifying-ipsec-settings">Decrypting ESP packets, verifying IPSec settings</a>
        </p>
        
        <p>
            <a href="/questions/59653/saving-ipsec-decrypted-stream-to-tcpdump-readable-format">Saving IPSec decrypted stream to tcpdump-readable format</a>
        </p>
        
        <p>
            <a href="/questions/3538/firewall-implementation">FireWall Implementation.</a>
        </p>
        
        <p>
            <a href="/questions/52319/help-with-blocking-filmora">Help With Blocking Filmora</a>
        </p>
        
        <p>
            <a href="/questions/13804/how-to-capture-linksys-wrt320n-to-arris-tm722-home-network-http-and-other-traffic">HOW TO capture linksys wrt320n to arris tm722 home network HTTP and other traffic</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
