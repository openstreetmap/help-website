<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>dumpcap/tshark loopback capture continual TCP ACKed unseen segment, fine on tcpdump - Wireshark Q&amp;A</title>
        <meta name="description" content="I&#39;m bumped into a weird bug on a virtualized RHEL/Centos 7.2 where if you capture on the loopback interface with tshark or dumpcap, that I get continual &quot;TCP ACKed unseen segment&quot; errors. But it works fine with tcpdump In this scenario, I have HAProxy doing SSL termination and then proxying to tomca..." />
        <meta name="keywords" content="tcpdump,unseen_segment,tshark,dumpcap" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/53918/dumpcaptshark-loopback-capture-continual-tcp-acked-unseen-segment-fine-on-tcpdump" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/53918/dumpcaptshark-loopback-capture-continual-tcp-acked-unseen-segment-fine-on-tcpdump?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='Py33AUwO0IV3YPcIPdcdOmC1gqI94Kbt' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/53918/dumpcaptshark-loopback-capture-continual-tcp-acked-unseen-segment-fine-on-tcpdump">dumpcap/tshark loopback capture continual TCP ACKed unseen segment, fine on tcpdump</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-53918-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/53918/up/" rel="nofollow"> </a>
<div id="post-53918-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-53918-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/53918/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/53918/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>I'm bumped into a weird bug on a virtualized RHEL/Centos 7.2 where if you capture on the loopback interface with tshark or dumpcap, that I get continual "TCP ACKed unseen segment" errors.  But it works fine with tcpdump</p>
<p>In this scenario, I have HAProxy doing SSL termination and then proxying to tomcat running on 8080.</p>
<p>For example:</p>
<pre><code>$tshark -i lo -f 'tcp port 8080'
Capturing on 'Loopback'
  7 3.492486804    127.0.0.1 -&gt; 127.0.0.1    HTTP 436 [TCP ACKed unseen segment] HTTP/1.1 200 OK  (text/html)
  8 3.492498208    127.0.0.1 -&gt; 127.0.0.1    TCP 66 [TCP Previous segment not captured] 41497 &gt; http-alt [ACK] Seq=95 Ack=371 Win=44800 Len=0 TSval=701453508 TSecr=701453508
  9 3.492541125    127.0.0.1 -&gt; 127.0.0.1    HTTP 68 Continuation or non-HTTP traffic
 10 5.007425117    127.0.0.1 -&gt; 127.0.0.1    TCP 74 41499 &gt; http-alt [SYN] Seq=0 Win=43690 Len=0 MSS=65495 SACK_PERM=1 TSval=701455023 TSecr=0 WS=128
 11 1544792488.772437180    127.0.0.1 -&gt; 127.0.0.1    TCP 74 http-alt &gt; 41499 [SYN, ACK] Seq=0 Ack=1 Win=43690 Len=0 MSS=65495 SACK_PERM=1 TSval=701455023 TSecr=701455023 WS=128
 12 5.007450399    127.0.0.1 -&gt; 127.0.0.1    TCP 66 41499 &gt; http-alt [ACK] Seq=1 Ack=1 Win=43776 Len=0 TSval=701455023 TSecr=701455023
 13 5.007968787    127.0.0.1 -&gt; 127.0.0.1    HTTP 436 [TCP ACKed unseen segment] HTTP/1.1 200 OK  (text/html)
 14 5.007980410    127.0.0.1 -&gt; 127.0.0.1    TCP 66 [TCP Previous segment not captured] 41499 &gt; http-alt [ACK] Seq=95 Ack=371 Win=44800 Len=0 TSval=701455023 TSecr=701455023
 15 5.008025474    127.0.0.1 -&gt; 127.0.0.1    HTTP 68 Continuation or non-HTTP traffic
 16 8.422922387    127.0.0.1 -&gt; 127.0.0.1    TCP 74 41504 &gt; http-alt [SYN] Seq=0 Win=43690 Len=0 MSS=65495 SACK_PERM=1 TSval=701458438 TSecr=0 WS=128
 17 1544807156.089171770    127.0.0.1 -&gt; 127.0.0.1    TCP 74 http-alt &gt; 41504 [SYN, ACK] Seq=0 Ack=1 Win=43690 Len=0 MSS=65495 SACK_PERM=1 TSval=701458438 TSecr=701458438 WS=128
 18 8.422947104    127.0.0.1 -&gt; 127.0.0.1    TCP 66 41504 &gt; http-alt [ACK] Seq=1 Ack=1 Win=43776 Len=0 TSval=701458438 TSecr=701458438
 19 8.423516653    127.0.0.1 -&gt; 127.0.0.1    HTTP 436 [TCP ACKed unseen segment] HTTP/1.1 200 OK  (text/html)
 20 8.423526522    127.0.0.1 -&gt; 127.0.0.1    TCP 66 [TCP Previous segment not captured] 41504 &gt; http-alt [ACK] Seq=95 Ack=371 Win=44800 Len=0 TSval=701458439 TSecr=701458439
 21 8.423632416    127.0.0.1 -&gt; 127.0.0.1    HTTP 68 Continuation or non-HTTP traffic
 22 8.423633078    127.0.0.1 -&gt; 127.0.0.1    TCP 66 [TCP ACKed unseen segment] http-alt &gt; 41504 [FIN, ACK] Seq=371 Ack=95 Win=43776 Len=0 TSval=701458439 TSecr=701458439
 23 8.423657361    127.0.0.1 -&gt; 127.0.0.1    TCP 54 http-alt &gt; 41504 [RST] Seq=371 Win=0 Len=0
</code></pre>
<p>However if I specify <em>any</em> snaplen (including 65535), then it works properly:</p>
<pre><code>$tshark -s 1500 -i lo -f 'tcp port 8080'
Capturing on 'Loopback'
  1 0.000000000    127.0.0.1 -&gt; 127.0.0.1    TCP 74 41926 &gt; http-alt [SYN] Seq=0 Win=43690 Len=0 MSS=65495 SACK_PERM=1 TSval=701753517 TSecr=0 WS=128
  2 1546074207.537697209    127.0.0.1 -&gt; 127.0.0.1    TCP 74 http-alt &gt; 41926 [SYN, ACK] Seq=0 Ack=1 Win=43690 Len=0 MSS=65495 SACK_PERM=1 TSval=701753517 TSecr=701753517 WS=128
  3 0.000023710    127.0.0.1 -&gt; 127.0.0.1    TCP 66 41926 &gt; http-alt [ACK] Seq=1 Ack=1 Win=43776 Len=0 TSval=701753517 TSecr=701753517
  4 0.000039374    127.0.0.1 -&gt; 127.0.0.1    HTTP 160 GET /opensso/isAlive.jsp HTTP/1.0
  5 0.000050069    127.0.0.1 -&gt; 127.0.0.1    TCP 66 http-alt &gt; 41926 [ACK] Seq=1 Ack=95 Win=43776 Len=0 TSval=701753517 TSecr=701753517
  6 0.000595231    127.0.0.1 -&gt; 127.0.0.1    HTTP 436 HTTP/1.1 200 OK  (text/html)
  7 0.000617025    127.0.0.1 -&gt; 127.0.0.1    TCP 66 41926 &gt; http-alt [ACK] Seq=95 Ack=371 Win=44800 Len=0 TSval=701753517 TSecr=701753517
  8 0.000733316    127.0.0.1 -&gt; 127.0.0.1    HTTP 68 Continuation or non-HTTP traffic
  9 0.000748411    127.0.0.1 -&gt; 127.0.0.1    TCP 66 http-alt &gt; 41926 [FIN, ACK] Seq=371 Ack=95 Win=43776 Len=0 TSval=701753518 TSecr=701753517
 10 0.000770966    127.0.0.1 -&gt; 127.0.0.1    TCP 54 http-alt &gt; 41926 [RST] Seq=371 Win=0 Len=0
 11 0.000777847    127.0.0.1 -&gt; 127.0.0.1    TCP 66 41926 &gt; http-alt [ACK] Seq=97 Ack=372 Win=44800 Len=0 TSval=701753518 TSecr=701753518
 12 0.000784413    127.0.0.1 -&gt; 127.0.0.1    TCP 66 41926 &gt; http-alt [FIN, ACK] Seq=97 Ack=372 Win=44800 Len=0 TSval=701753518 TSecr=701753518
 13 0.000784484    127.0.0.1 -&gt; 127.0.0.1    TCP 54 http-alt &gt; 41926 [RST] Seq=372 Win=0 Len=0
 14 0.000794534    127.0.0.1 -&gt; 127.0.0.1    TCP 54 http-alt &gt; 41926 [RST] Seq=372 Win=0 Len=0
 15 1.412536403    127.0.0.1 -&gt; 127.0.0.1    TCP 74 41928 &gt; http-alt [SYN] Seq=0 Win=43690 Len=0 MSS=65495 SACK_PERM=1 TSval=701754929 TSecr=0 WS=128
 16 1546080272.032933044    127.0.0.1 -&gt; 127.0.0.1    TCP 74 http-alt &gt; 41928 [SYN, ACK] Seq=0 Ack=1 Win=43690 Len=0 MSS=65495 SACK_PERM=1 TSval=701754929 TSecr=701754929 WS=128
 17 1.412560984    127.0.0.1 -&gt; 127.0.0.1    TCP 66 41928 &gt; http-alt [ACK] Seq=1 Ack=1 Win=43776 Len=0 TSval=701754929 TSecr=701754929
 18 1.412577999    127.0.0.1 -&gt; 127.0.0.1    HTTP 160 GET /opensso/isAlive.jsp HTTP/1.0
</code></pre>
<p>This is strange because the help text says that the default snaplan is "65535", however it's clear from my testing that <code>-s</code> has additional side effects.</p>
<pre><code>$tshark --help
tshark: invalid option -- '-'
TShark 1.10.14 (Git Rev Unknown from unknown)
...
Capture interface:
  -i &lt;interface&gt;           name or idx of interface (def: first non-loopback)
  -f &lt;capture filter&gt;      packet filter in libpcap filter syntax
  -s &lt;snaplen&gt;             packet snapshot length (def: 65535)
</code></pre>
<p>I raised a ticket with RedHat support and they have also confirmed with a virtualized RHEL 7.2 this issue is reproduceable, but it is fine on bare-metal.</p>
<p>I have tried this with Ubuntu 16.04 on AWS and it's fine there, so it only seems to affect RHEL/Centos.</p>
<p>I thought tcpdump and dumpcap/tshark used the same underlying capture library, libpcap?</p>
<p>Any ideas what's up with this?</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/tcpdump/" class="post-tag tag-link-tcpdump"
                                        title="see questions tagged 'tcpdump'" rel="tag">tcpdump</a>
                                
                                    <a href="/tags/unseen_segment/" class="post-tag tag-link-unseen_segment"
                                        title="see questions tagged 'unseen_segment'" rel="tag">unseen_segment</a>
                                
                                    <a href="/tags/tshark/" class="post-tag tag-link-tshark"
                                        title="see questions tagged 'tshark'" rel="tag">tshark</a>
                                
                                    <a href="/tags/dumpcap/" class="post-tag tag-link-dumpcap"
                                        title="see questions tagged 'dumpcap'" rel="tag">dumpcap</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>07 Jul '16, 16:43</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/400af70f37e9e9b8a4b536cb03a63838?s=32&amp;d=identicon&amp;r=g" alt="Joel%20Pearson's gravatar image" />
    <p><a href="/users/24257/joel-pearson">Joel Pearson</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="6 badges"><span class="bronze">&#9679;</span><span class="badgecount">6</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Joel Pearson has one accepted answer">100&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/53918/">
                edited
                <strong>08 Jul '16, 05:33</strong>
            </a>
        </p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-53918">
    
</div>
<div id="comment-tools-53918" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-53918-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/53918/dumpcaptshark-loopback-capture-continual-tcp-acked-unseen-segment-fine-on-tcpdump?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/53918/dumpcaptshark-loopback-capture-continual-tcp-acked-unseen-segment-fine-on-tcpdump?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/53918/dumpcaptshark-loopback-capture-continual-tcp-acked-unseen-segment-fine-on-tcpdump?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/53918/dumpcaptshark-loopback-capture-continual-tcp-acked-unseen-segment-fine-on-tcpdump?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="63315"></a>
                    <div id="answer-container-63315" class="answer accepted-answer answered-by-owner">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-63315-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/63315/up/" rel="nofollow"> </a>
<div id="post-63315-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-63315-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/63315/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="Joel Pearson has selected this answer as the correct answer"
        href="/accept_answer/63315/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Turns out it was an issue with the default capture buffer in RHEL 7, RedHat finally released a fix for it:</p>
<p><a href="https://git.centos.org/commitdiff/rpms!wireshark.git/60db69006fe48d5744fdfa2a1b982dc552b5fd1b">https://git.centos.org/commitdiff/rpms!wireshark.git/60db69006fe48d5744fdfa2a1b982dc552b5fd1b</a></p>
<p>It seems that the actual default snaplen is 262144, which would explain why it was running out of buffer too quickly and why changing it to 65536 helped.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/63315/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>01 Aug '17, 17:50</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/400af70f37e9e9b8a4b536cb03a63838?s=32&amp;d=identicon&amp;r=g" alt="Joel%20Pearson's gravatar image" />
    <p><a href="/users/24257/joel-pearson">Joel Pearson</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="6 badges"><span class="bronze">&#9679;</span><span class="badgecount">6</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Joel Pearson has one accepted answer">100&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/63315/">
                edited
                <strong>01 Aug '17, 17:52</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-63315">
    
</div>
<div id="comment-tools-63315" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-63315-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="53929"></a>
                    <div id="answer-container-53929" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-53929-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/53929/up/" rel="nofollow"> </a>
<div id="post-53929-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-53929-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/53929/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>This is not an issue of tshark, it's a side effect. TCPdump doesn't track TCP sequence numbers (meaning, it has no "TCP expert") like tshark does, so it won't complain about "TCP ACKed unseen segment". It has nothing to do with libpcap, but with the analyzing layers on top of it. </p>
<p>"ACKed unknown segment" means that the TCP expert has seen an acknowledge for a packet that it hasn't seen. This is usually a capture performance problem, meaning that your hardware can't capture the packets fast enough (for various possible reasons). Reducing the snaplength helps in this case of course, because you're writing less bytes to disk, allowing the capture to grab more frames in the same timespan.</p>
<p>If you need maximum capture performance, use dumpcap instead of tshark. See <a href="https://blog.packet-foo.com/2013/05/the-notorious-wireshark-out-of-memory-problem/">this blog post</a> for more details why dumpcap is the better choice, and how to run it.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/53929/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>08 Jul '16, 04:23</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" alt="Jasper's gravatar image" />
    <p><a href="/users/145/jasper">Jasper ♦♦</a><br/>
    <span class="score" title="23806 reputation points"><span class="">23.8k</span></span><span title="5 badges"><span class="badge1">&#9679;</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">&#9679;</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">&#9679;</span><span class="badgecount">284</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Jasper has 263 accepted answers">18&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-53929">
    
        <a name="53931"></a>
        <div class="comment" id="comment-53931">
            <div id="post-53931-score" class="comment-score"></div>
            <div class="comment-text"><p>I don't believe this is the problem. This happens at any capture rate even at 1 packer per second. Any value of snaplen fixes the problem. Even "-s 65535" fixes the problem.</p></div>
            <div class="comment-info" id="comment-53931-info">
                
                
                
                

                

                <span class="comment-age">(08 Jul '16, 04:47)</span>
                <a class="comment-user userinfo" href="/users/24257/joel-pearson">Joel Pearson</a>
                
            </div>
        </div>
    
        <a name="53933"></a>
        <div class="comment" id="comment-53933">
            <div id="post-53933-score" class="comment-score"></div>
            <div class="comment-text"><p>Okay, then it's probably related to the loopback capture I guess...</p></div>
            <div class="comment-info" id="comment-53933-info">
                
                
                
                

                

                <span class="comment-age">(08 Jul '16, 05:37)</span>
                <a class="comment-user userinfo" href="/users/145/jasper">Jasper ♦♦</a>
                
            </div>
        </div>
    
        <a name="53934"></a>
        <div class="comment" id="comment-53934">
            <div id="post-53934-score" class="comment-score"></div>
            <div class="comment-text"><p>Capturing on eth0 has no problems either. It's just loopback, it's just so odd that actually specifying a snaplen has different behaviour. I suppose RedHat will figure it out.</p></div>
            <div class="comment-info" id="comment-53934-info">
                
                
                
                

                

                <span class="comment-age">(08 Jul '16, 06:30)</span>
                <a class="comment-user userinfo" href="/users/24257/joel-pearson">Joel Pearson</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-53929" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-53929-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/53918/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='Py33AUwO0IV3YPcIPdcdOmC1gqI94Kbt' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/53918/dumpcaptshark-loopback-capture-continual-tcp-acked-unseen-segment-fine-on-tcpdump?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/53918/dumpcaptshark-loopback-capture-continual-tcp-acked-unseen-segment-fine-on-tcpdump?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/tshark/"
            class="tag-link-tshark"
            title="see questions tagged'tshark'using tags"
            rel="tag">tshark</a> <span class="tag-number">&#215;832</span><br/>
        
        <a href="/tags/tcpdump/"
            class="tag-link-tcpdump"
            title="see questions tagged'tcpdump'using tags"
            rel="tag">tcpdump</a> <span class="tag-number">&#215;97</span><br/>
        
        <a href="/tags/dumpcap/"
            class="tag-link-dumpcap"
            title="see questions tagged'dumpcap'using tags"
            rel="tag">dumpcap</a> <span class="tag-number">&#215;89</span><br/>
        
        <a href="/tags/unseen_segment/"
            class="tag-link-unseen_segment"
            title="see questions tagged'unseen_segment'using tags"
            rel="tag">unseen_segment</a> <span class="tag-number">&#215;14</span><br/>
        
    </p>
    <p>
        question asked: <strong title="July 7, 2016, 4:43 p.m.">07 Jul '16, 16:43</strong>
    </p>
    <p> 
     	question was seen: <strong>2,984 times</strong>
    </p>
    <p> 
        last updated: <strong title="Aug. 1, 2017, 5:52 p.m.">01 Aug '17, 17:52</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/12348/how-to-calculate-the-total-network-traffic-pass-though-a-gigabit-nic-with-high-precision">How to calculate the total network traffic pass though a Gigabit NIC with high precision?</a>
        </p>
        
        <p>
            <a href="/questions/31215/capture-filter-based-on-data-in-packet">Capture filter based on data in packet</a>
        </p>
        
        <p>
            <a href="/questions/51057/batch-file-to-read-pcap-file-how">Batch file to read pcap file ? how</a>
        </p>
        
        <p>
            <a href="/questions/62684/bypassing-dumpcap-with-tshark-and-pipes">Bypassing dumpcap with TShark and pipes</a>
        </p>
        
        <p>
            <a href="/questions/44454/tshark-rotating-pcap-files">tshark rotating pcap files</a>
        </p>
        
        <p>
            <a href="/questions/56898/tshark-alternative-tcpdump-for-long-time-on-the-fly-capturing-and-analysis">tshark alternative (tcpdump?) for long-time on-the-fly capturing and analysis</a>
        </p>
        
        <p>
            <a href="/questions/14376/generating-tshark-decoded-output-from-tcpdump-pcap-file-without-tshark">Generating TSHARK decoded output from TCPDUMP PCAP file ? without tshark</a>
        </p>
        
        <p>
            <a href="/questions/18809/dumpcap-outfile-save-location">dumpcap outfile save location</a>
        </p>
        
        <p>
            <a href="/questions/36127/capture-all-incoming-traffic-and-only-incoming-traffic">Capture ALL incoming traffic and ONLY incoming traffic.</a>
        </p>
        
        <p>
            <a href="/questions/56715/dropped-packet-stats-in-cli-during-capture">Dropped packet stats in CLI during capture</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
