<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>tshark output data in not completly correct - Wireshark Q&amp;A</title>
        <meta name="description" content="Hello, I am using tshark to retreive a lot of data from a captured file. I am using the command: tshark.exe -r C:\Temp\input.pcap -z &quot;follow,tcp,hex,0&quot; -w C:\Temp\output.ps -Y &quot;tcp.stream eq 0&quot; The output contains extra header and trailer (unwanted) data in front of the requested data  I expect that..." />
        <meta name="keywords" content="output,tshark" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/46833/tshark-output-data-in-not-completly-correct" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/46833/tshark-output-data-in-not-completly-correct?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='59rlg8UNJOiE7aYCAZ8Ya5txqmX52O9B' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/46833/tshark-output-data-in-not-completly-correct">tshark output data in not completly correct</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-46833-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/46833/up/" rel="nofollow"> </a>
<div id="post-46833-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-46833-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/46833/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/46833/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hello,</p>
<p>I am using tshark to retreive a lot of data from a captured file.</p>
<p>I am using the command:</p>
<p>tshark.exe -r C:\Temp\input.pcap -z "follow,tcp,hex,0" -w C:\Temp\output.ps -Y "tcp.stream eq 0"</p>
<p>The output contains extra header and trailer (unwanted) data in front of the requested data </p>
<p>I expect that the comandline is not correct, but I am unable to find the problem</p>
<p>Header data</p>
<p>X   M&lt;+   ÿÿÿÿÿÿÿÿ 3 TShark 1.12.8 (v1.12.8-0-g5b6e543 from master-1.12)     X                                    l       2 |Y€J   J    ÝåjÄ„&lt;Š°+ä E  &lt;Õ<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="8ddfcd">[email&#160;protected]</a> 9vN°daÀ¨ ò¾f#Œj’;A     9¥±  ¬
ýXî      l      <code>2 I[€&gt;   &gt;   &lt;Š°+ä ÝåjÄ„ E  0M  ÿ¬_À¨ ò°da#Œ¾f mýbj’;Bp û\  ´</code>      \       2 E”€&lt;   &lt;    ÝåjÄ„&lt;Š°+ä E  (Õ<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2d7e6d">[email&#160;protected]</a> 9va°daÀ¨ ò¾f#Œj’;B mýcP9û        \      \       2 B˜€&lt;   &lt;   &lt;Š°+ä ÝåjÄ„ E  (N  ÿ¬fÀ¨ ò°da#Œ¾f mýcj’;BP` Ô   ´\            2 ±Ç½â  â   ÝåjÄ„&lt;Š°+ä E ÔÕ<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="184c58">[email&#160;protected]</a> 9p´°daÀ¨ ò¾f#Œj’;B mýcP9þ<br>
</p>
<p>Trailer data</p>
<pre><code>     \       2 \RÁ&lt;   &lt;   &lt;Š°+ä ÝåjÄ„ E  (a  ÿ¬SÀ¨ ò°da#Œ¾f mýcj“œ²P&gt;ý“²  ´\      \       2 YSÁ&lt;   &lt;   &lt;Š°+ä ÝåjÄ„ E  (b  ÿ¬RÀ¨ ò°da#Œ¾f mýcj“œ²P&gt;ý“±  ´\      \       2 FˆÁ&lt;   &lt;    ÝåjÄ„&lt;Š°+ä E  (Õ”@ 9v °daÀ¨ ò¾f#Œj“œ² mýdP9™¦        \
</code></pre>
<p>X   M&lt;+   ÿÿÿÿÿÿÿÿ 3 TShark 1.12.8 (v1.12.8-0-g5b6e543 from master-1.12)     X                                    l       2 |Y€J   J    ÝåjÄ„&lt;Š°+ä E  &lt;Õ<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="cc9e8c">[email&#160;protected]</a> 9vN°daÀ¨ ò¾f#Œj’;A     9¥±  ¬
ýXî      l      <code>2 I[€&gt;   &gt;   &lt;Š°+ä ÝåjÄ„ E  0M  ÿ¬_À¨ ò°da#Œ¾f mýbj’;Bp û\  ´</code>      \       2 E”€&lt;   &lt;    ÝåjÄ„&lt;Š°+ä E  (Õ<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="134053">[email&#160;protected]</a> 9va°daÀ¨ ò¾f#Œj’;B mýcP9û        \      \       2 B˜€&lt;   &lt;   &lt;Š°+ä ÝåjÄ„ E  (N  ÿ¬fÀ¨ ò°da#Œ¾f mýcj’;BP` Ô   ´\            2 ±Ç½â  â   ÝåjÄ„&lt;Š°+ä E ÔÕ<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="affbef">[email&#160;protected]</a> 9p´°daÀ¨ ò¾f#Œj’;B mýcP9þ<br>
</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/output/" class="post-tag tag-link-output"
                                        title="see questions tagged 'output'" rel="tag">output</a>
                                
                                    <a href="/tags/tshark/" class="post-tag tag-link-tshark"
                                        title="see questions tagged 'tshark'" rel="tag">tshark</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>22 Oct '15, 07:27</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/c72b4cb1a266757ec318febb2cc62d1e?s=32&amp;d=identicon&amp;r=g" alt="Ton%20Helmerhorst's gravatar image" />
    <p><a href="/users/20413/ton-helmerhorst">Ton Helmerhorst</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">&#9679;</span><span class="badgecount">2</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Ton Helmerhorst has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-46833">
    
</div>
<div id="comment-tools-46833" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-46833-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/46833/tshark-output-data-in-not-completly-correct?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/46833/tshark-output-data-in-not-completly-correct?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/46833/tshark-output-data-in-not-completly-correct?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/46833/tshark-output-data-in-not-completly-correct?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="46839"></a>
                    <div id="answer-container-46839" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-46839-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/46839/up/" rel="nofollow"> </a>
<div id="post-46839-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-46839-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/46839/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>You are <strong>writing a pcap file</strong> with the option <strong>-w ....</strong>. That's certainly not what you want if you are using <strong>-z follow</strong>.</p>
<p>Please try this, to direct the output of tshark into a file.</p>
<blockquote>
<p>tshark.exe -r C:\Temp\input.pcap -z "follow,tcp,hex,0" -q &gt; C:\Temp\output.txt</p>
</blockquote>
<p>BTW: You don't need the option "-Y ...." as you specified the TCP Stream already in the follow option.</p>
<p>The output would be hex data and you need to parse that with a script to get the payload.</p>
<pre>===================================================================
Follow: tcp,hex
Filter: tcp.stream eq 2
Node 0: 192.168.90.57:41170
Node 1: 104.25.10.6:443
00000000  17 03 03 03 52 00 00 00  00 00 00 00 4e f1 aa 31  ....R... ....N..1
00000010  43 37 e6 74 ed cc cf fa  ec fb 18 0f 72 65 9d 57  C7.t.... ....re.W
00000020  df f9 d9 0c 9f 17 3a 3c  3a 42 11 92 11 4a 87 76  ......:&lt; :B...J.v
00000030  30 9c e0 68 e0 e4 d1 8f  ce af 7a a5 bf 24 cd 06  0..h.... ..z..$..
00000040  30 47 cd 60 00 85 44 f8  00 3f 12 c1 5a 1b 16 cd  0G.`..D. .?..Z...
00000050  64 5f a7 df d5 75 1f b1  fe b7 5d b6 4a cf 76 71  d_...u.. ..].J.vq
00000060  dd 60 50 d1 30 4a e6 a1  4d 4f 3c 2e b4 3b bf 55  .`P.0J.. MO&lt;..;.U
00000070  1b 37 d1 c1 2e 88 9b a3  04 9a ce 6e 8b 5b 1e 86  .7...... ...n.[..
00000080  f2 47 ad fe 45 25 e3 7f  03 e1 71 af 38 c2 c4 e3  .G..E%.. ..q.8...
00000090  5e bb 0b 0e 99 d5 7a c9  01 f1 d5 9d 49 51 5c 21  ^.....z. ....IQ\!
000000A0  0b 1e dd 57 fc 71 2d b2  53 01 78 bb 01 75 13 66  ...W.q-. S.x..u.f
000000B0  20 3e 94 04 6c 19 f8 b4  e9 92 45 0d 59 a5 e6 14   &gt;..l... ..E.Y...
</pre>

<p>If you need <strong>raw data</strong>, please run this:</p>
<blockquote>
<p>tshark.exe -r C:\Temp\input.pcap -z "follow,tcp,raw,0" -q &gt; C:\Temp\output.raw</p>
</blockquote>
<p>This will give slightly different output.</p>
<pre>===================================================================
Follow: tcp,raw
Filter: tcp.stream eq 2
Node 0: 192.168.90.57:41170
Node 1: 104.25.10.6:443
1703030352000000000000004ef1aa314337e674edcccffaecfb180f72659d57dff9
bf24cd063047cd60008544f8003f12c15a1b16cd645fa7dfd5751fb1feb75db64acf
049ace6e8b5b1e86f247adfe4525e37f03e171af38c2c4e35ebb0b0e99d57ac901f1
6c19f8b4e992450d59a5e614b3b4bddff9f70cd6e485d6744d4157a7df44edad3cd7
5b651c7bae4ede2cc5fe85fbf626eb6ed75492256ffd7573bd4a779fe03705f84b32
</pre>

<p>If you need <strong>'text' data</strong>, please run this:</p>
<blockquote>
<p>tshark.exe -r C:\Temp\input.pcap -z "follow,tcp,ascii,0" -q &gt; C:\Temp\output.text</p>
</blockquote>
<p><strong>++UPDATE++</strong></p>
<p>based on your comment, I'd like to add this:</p>
<p>Now I understand what you want. It's the <strong>binary</strong> data, as saved in the of <strong>TCP Follow Stream</strong> pop-up in Wireshark. </p>
<p><strong>Unfortunately</strong>, there is no such functionality in tshark. So, what you can do is this:</p>
<ul>
<li>let tshark output hex data (-z follow,tcp,hex,0)</li>
<li>use a script (perl, python, whatever) or an editor (notepad++) to convert the output to something that xxd (included in gvim), understands (see below)</li>
<li>run xxd to convert the <strong>hex</strong> data to <strong>binary</strong> data</li>
</ul>
<p>This is what tshark generates:</p>
<pre>===================================================================
Follow: tcp,hex
Filter: tcp.stream eq 36
Node 0: 176.31.100.97:56001
Node 1: 192.168.32.242:9100
00000000  1b 25 2d 31 32 33 34 35  58 40 50 4a 4c 0a 40 50  .%-12345 X<a href="/users/5458/p-gooding"><a href="/users/5458/p-gooding"><a href="/users/5458/p-gooding">@P</a></a></a>JL.<a href="/users/5458/p-gooding"><a href="/users/5458/p-gooding"><a href="/users/5458/p-gooding">@P</a></a></a>
00000010  4a 4c 20 4a 4f 42 20 4e  41 4d 45 20 3d 20 22 36  JL JOB N AME = "6
00000020  31 39 30 38 33 2d 35 35  64 64 64 63 30 37 34 64  19083-55 dddc074d
00000030  65 38 36 2e 70 64 66 22  20 44 49 53 50 4c 41 59  e86.pdf"  DISPLAY
00000040  20 3d 20 22 33 30 37 35  33 37 20 61 70 61 63 68   = "3075 37 apach

</pre>

<p>this is what <strong>xxd</strong> needs to be able to convert it to binary</p>
<pre>00000000  1b 25 2d 31 32 33 34 35 58 40 50 4a 4c 0a 40 50  .%-12345 X<a href="/users/5458/p-gooding"><a href="/users/5458/p-gooding"><a href="/users/5458/p-gooding">@P</a></a></a>JL.<a href="/users/5458/p-gooding"><a href="/users/5458/p-gooding"><a href="/users/5458/p-gooding">@P</a></a></a>
00000010  4a 4c 20 4a 4f 42 20 4e 41 4d 45 20 3d 20 22 36  JL JOB N AME = "6
00000020  31 39 30 38 33 2d 35 35 64 64 64 63 30 37 34 64  19083-55 dddc074d
00000030  65 38 36 2e 70 64 66 22 20 44 49 53 50 4c 41 59  e86.pdf"  DISPLAY
00000040  20 3d 20 22 33 30 37 35 33 37 20 61 70 61 63 68   = "3075 37 apach
00000050  65 20 36 31 39 30 38 33 2d 35 35 64 64 64 63 30  e 619083 -55dddc0
00000060  37 34 64 65 22 0a 40 50 4a 4c 20 45 4e 54 45 52  74de".<a href="/users/5458/p-gooding"><a href="/users/5458/p-gooding"><a href="/users/5458/p-gooding">@P</a></a></a> JL ENTER
00000070  20 4c 41 4e 47 55 41 47 45 20 3d 20 50 4f 53 54   LANGUAG E = POST
</pre>

<p>So, basically, the process is:</p>
<ul>
<li>run tshark: <strong>tshark -nr input.pcap -q -z follow,tcp,hex,0 &gt; tshark.out.hex</strong></li>
<li>open <strong>tshark.out.hex</strong> with an editor or use a script to do the following:</li>
<li>remove the 'comment' lines at the beginning</li>
<li>remove the double space in the middle of the output, so '35__58' becomes '35_58', etc.</li>
<li>save <strong>tshark.out.hex</strong></li>
<li>run xxd: <strong>xxd.exe -r -g 1 tshark.out.hex tshark.out.bin</strong></li>
</ul>
<p><strong>Result:</strong> tshark.out.bin is identical to your file 'correct_data.raw' in the ZIP file.</p>
<p>You will find <strong>xxd.exe</strong> in the installation directory of <a href="http://www.vim.org/">vim</a></p>
<p>Regards<br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/46839/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>22 Oct '15, 08:53</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/46839/">
                edited
                <strong>22 Oct '15, 15:23</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-46839">
    
        <a name="46854"></a>
        <div class="comment" id="comment-46854">
            <div id="post-46854-score" class="comment-score"></div>
            <div class="comment-text"><p>Dear all,</p>

<p>Many thanks for your kind response. I tried all the options you mentioned, but unfortunatly without success. I still observe unwanted data in the header and trailer of the datastream.</p>

<p>I published the related files on the following URL:</p>

<p><a href="https://www.hidrive.strato.com/lnk/hQzNGqJd">https://www.hidrive.strato.com/lnk/hQzNGqJd</a></p>

<p>Password:       <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="6730561502140f27150c">[email&#160;protected]</a></p>

<p>In this zip file you will find the procedure (avi file) to retrieve the correct data from wireshark. Also a batch file with all the used (tried) commands and the output of the related commands.
In the file correct_data.raw you can observe the expected data without the unwanted data in the header and trailer.</p>

<p>I appriciate your help very much !!!</p>

<p>Ton</p></div>
            <div class="comment-info" id="comment-46854-info">
                
                
                
                

                

                <span class="comment-age">(22 Oct '15, 13:28)</span>
                <a class="comment-user userinfo" href="/users/20413/ton-helmerhorst">Ton Helmerhorst</a>
                
            </div>
        </div>
    
        <a name="46862"></a>
        <div class="comment" id="comment-46862">
            <div id="post-46862-score" class="comment-score"></div>
            <div class="comment-text"><p>Please see the <strong>++UPDATE++</strong> in my answer!</p></div>
            <div class="comment-info" id="comment-46862-info">
                
                
                
                

                

                <span class="comment-age">(22 Oct '15, 15:23)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-46839" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-46839-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/46833/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='59rlg8UNJOiE7aYCAZ8Ya5txqmX52O9B' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/46833/tshark-output-data-in-not-completly-correct?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/46833/tshark-output-data-in-not-completly-correct?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/tshark/"
            class="tag-link-tshark"
            title="see questions tagged'tshark'using tags"
            rel="tag">tshark</a> <span class="tag-number">&#215;832</span><br/>
        
        <a href="/tags/output/"
            class="tag-link-output"
            title="see questions tagged'output'using tags"
            rel="tag">output</a> <span class="tag-number">&#215;22</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Oct. 22, 2015, 7:27 a.m.">22 Oct '15, 07:27</strong>
    </p>
    <p> 
     	question was seen: <strong>1,888 times</strong>
    </p>
    <p> 
        last updated: <strong title="Oct. 22, 2015, 3:23 p.m.">22 Oct '15, 15:23</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/26315/how-to-add-mac-addresses-into-t-text">How to add mac-addresses into -T text ?</a>
        </p>
        
        <p>
            <a href="/questions/29656/how-to-preserve-timestamps-in-tshark-output-file">How to preserve timestamps in tshark output file?</a>
        </p>
        
        <p>
            <a href="/questions/32441/how-can-i-get-tshark-to-display-data-from-wireshark-parameterize-column-values-as-formatted-text">How can I get tshark to display data from Wireshark Parameterize column values as formatted text</a>
        </p>
        
        <p>
            <a href="/questions/15374/dump-raw-packet-data-field-only">Dump raw packet &#39;data&#39; field only?</a>
        </p>
        
        <p>
            <a href="/questions/32552/tshark-suppress-random-line-numbers">Tshark: suppress random line numbers</a>
        </p>
        
        <p>
            <a href="/questions/45363/is-there-any-way-to-directly-capture-in-csv-using-tshark">Is there any way to directly capture in CSV using tshark?</a>
        </p>
        
        <p>
            <a href="/questions/37587/tshark-w-switch">Tshark -w switch</a>
        </p>
        
        <p>
            <a href="/questions/41951/use-capture-filter-on-tshark-when-reading-a-file">Use capture filter on tshark when reading a file</a>
        </p>
        
        <p>
            <a href="/questions/43342/how-to-extract-basic-authorization-details-from-a-pcap-file">How to extract basic authorization details from a pcap file ?</a>
        </p>
        
        <p>
            <a href="/questions/44371/tshark-export-tcp-conversations-while-running">TShark - export TCP conversations while running</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
