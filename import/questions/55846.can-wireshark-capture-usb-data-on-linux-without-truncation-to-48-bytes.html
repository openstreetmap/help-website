<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Can Wireshark capture USB data on Linux without truncation to 48 bytes? - Wireshark Q&amp;A</title>
        <meta name="description" content="As per the title: can Wireshark capture USB data without truncation to 48 bytes? I understand that this is a limitation of usbmon - whether it&#39;s a hard limit that can never be breached, I don&#39;t know, hence the question. But truncating the data to 48 bytes renders the capture useless for my present p..." />
        <meta name="keywords" content="usb,truncate,linux" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/55846/can-wireshark-capture-usb-data-on-linux-without-truncation-to-48-bytes" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/55846/can-wireshark-capture-usb-data-on-linux-without-truncation-to-48-bytes?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='bOgQI3Yi6yF04nkvzs7NxjeNEpBuZpcg' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/55846/can-wireshark-capture-usb-data-on-linux-without-truncation-to-48-bytes">Can Wireshark capture USB data on Linux without truncation to 48 bytes?</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-55846-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/55846/up/" rel="nofollow"> </a>
<div id="post-55846-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-55846-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/55846/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/55846/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>As per the title: can Wireshark capture USB data without truncation to 48 bytes?</p>
<p>I understand that this is a limitation of usbmon - whether it's a hard limit that can never be breached, I don't know, hence the question.  But truncating the data to 48 bytes renders the capture useless for my present purposes.</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/usb/" class="post-tag tag-link-usb"
                                        title="see questions tagged 'usb'" rel="tag">usb</a>
                                
                                    <a href="/tags/truncate/" class="post-tag tag-link-truncate"
                                        title="see questions tagged 'truncate'" rel="tag">truncate</a>
                                
                                    <a href="/tags/linux/" class="post-tag tag-link-linux"
                                        title="see questions tagged 'linux'" rel="tag">linux</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>26 Sep '16, 08:34</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/cd46c2b5d0039a8d23281c5490b2ebe1?s=32&amp;d=identicon&amp;r=g" alt="davehigton's gravatar image" />
    <p><a href="/users/25489/davehigton">davehigton</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">&#9679;</span><span class="badgecount">4</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="davehigton has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/55846/">
                edited
                <strong>26 Sep '16, 13:36</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" alt="Guy%20Harris's gravatar image" />
            <p><a href="/users/79/guy-harris">Guy Harris ♦♦</a><br/>
            <span class="score" title="17443 reputation points"><span class="">17.4k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">&#9679;</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">&#9679;</span><span class="badgecount">196</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-55846">
    
        <a name="55866"></a>
        <div class="comment" id="comment-55866">
            <div id="post-55866-score" class="comment-score"></div>
            <div class="comment-text"><p>Can you be more specific regarding the kernel version, type of USB communication to be captured, the application used for capturing (<code>tcpdump</code>, Wireshark/tshark capturing via <code>dumpcap</code>, anything else) etc.? The thing is that I am routinely using <code>usbmon</code> to capture USB traffic and I haven't encountered any frame truncations. But as I mainly concentrate on isochronous transfers, there may be an issue which is related to a particular transfer type which I haven't run into. <code>usbmon</code> declares to truncate the <strong>text</strong> output, but not the <strong>binary</strong> one which is used by <code>tcpdump</code> and/or <code>dumpcap</code> from the Wireshark suite. Also, I am using <code>tcpdump</code> to capture to a file at the source machines and then use Wireshark to analyze the saved files on my laptop, so there may be an unnoticed <code>dumpcap</code> issue.</p></div>
            <div class="comment-info" id="comment-55866-info">
                
                
                
                

                

                <span class="comment-age">(26 Sep '16, 10:40)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="55875"></a>
        <div class="comment" id="comment-55875">
            <div id="post-55875-score" class="comment-score"></div>
            <div class="comment-text"><p>To quote <a href="https://github.com/torvalds/linux/blob/master/Documentation/usb/usbmon.txt">the usbmon documentation</a>:</p>

<blockquote>
<p>These events can be received from a character device by reading with read(2), with an ioctl(2), or by accessing the buffer with mmap. However, read(2) only returns first 48 bytes for compatibility reasons.</p>
</blockquote>

<p>If your kernel and libpcap support memory-mapped access for usbmon ("accessing the buffer with mmap"), there is no 48-byte truncation limit.  That's why we need to know the kernel version <em>and</em> the libpcap version.</p></div>
            <div class="comment-info" id="comment-55875-info">
                
                
                
                

                

                <span class="comment-age">(26 Sep '16, 13:38)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="55931"></a>
        <div class="comment" id="comment-55931">
            <div id="post-55931-score" class="comment-score"></div>
            <div class="comment-text"><p>Kernel is 4.4.0-38-generic; it's a fully up to date Ubuntu 16.04 LTS 64 bit OS.</p>

<p>Type of USB communication to be captured: even the traffic from a keyboard is sometimes truncated, but the real killer is traffic with a Bluetooth dongle, where packets frequently are in the region of 256 bytes.</p>

<p>Capture is directly with Wireshark after selecting the usbmon2 interface.  I'm not running separate capture and analysis sessions.</p>

<p>libpcap is 1.7.4, tcpdump is 4.7.4, but I am not aware of how what I'm doing interacts with either of them.</p></div>
            <div class="comment-info" id="comment-55931-info">
                
                
                
                

                

                <span class="comment-age">(27 Sep '16, 13:21)</span>
                <a class="comment-user userinfo" href="/users/25489/davehigton">davehigton</a>
                
            </div>
        </div>
    
        <a name="55932"></a>
        <div class="comment" id="comment-55932">
            <div id="post-55932-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>libpcap is 1.7.4, tcpdump is 4.7.4, but I am not aware of how what I'm doing interacts with either of them.</p>
</blockquote>

<p>As you start the capture from Wireshark, you use <code>libpcap</code> via <code>dumpcap</code> which is a process that Wireshark spawns for the actual capturing and reads its output. You do not use <code>tcpdump</code> at all.</p>

<blockquote>
<p>even the traffic from a keyboard is sometimes truncated, but the real killer is traffic with a Bluetooth dongle, where packets frequently are in the region of 256 bytes.</p>
</blockquote>

<p>Well, my question was related to the type of transfers (isochronous, interrupt, bulk, control) which are affected. But what you just wrote sounds to me as if only some of the URBs are truncated ("the traffic from a keyboard is <strong>sometimes</strong> truncated") and some are not even though larger than 48 bytes. Is this a correct understanding or it is just that some URBs from the keyboard are smaller than 48 bytes and thus are not truncated?</p>

<p>Just to be sure, can you capture some USB traffic using <code>tcpdump -i usbmon -s 0 -w tcpdump_usb_test.pcap</code>, press <code>Ctrl-C</code> when done, and then check whether the USBs in this file (<code>tcpdump_usb_test.pcap</code>) are also truncated if you open it using Wireshark?</p></div>
            <div class="comment-info" id="comment-55932-info">
                
                
                
                

                

                <span class="comment-age">(27 Sep '16, 13:40)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="56044"></a>
        <div class="comment" id="comment-56044">
            <div id="post-56044-score" class="comment-score"></div>
            <div class="comment-text"><p>Firstly, I apologise for taking so long to respond.</p>

<blockquote>
<p>Well, my question was related to the type of transfers (isochronous, interrupt, bulk, control) which are affected.</p>
</blockquote>

<p>Ah, I didn't understand, sorry.</p>

<blockquote>
<p>Is this a correct understanding or it is just that some URBs from the keyboard are smaller than 48 bytes and thus are not truncated?</p>
</blockquote>

<p>Nothing in the capture exceeds 48 bytes; anything that had more than 48 bytes on the wire is truncated.  Some packets only have 48 bytes on the wire and therefore are not truncated.  My apologies for being unclear.</p>

<blockquote>
<p><code>tcpdump -i usbmon -s 0 -w tcpdump_usb_test.pcap</code></p>
</blockquote>

<p>Slightly modified - needs sudo, also needs to be usbmon2 rather than just usbmon, but this capture is NOT truncated.</p>

<p>So thank you for at least giving me a work-round.</p>

<p>Is it possible to make live capture-and-display work the same way?</p></div>
            <div class="comment-info" id="comment-56044-info">
                
                
                
                

                

                <span class="comment-age">(01 Oct '16, 11:58)</span>
                <a class="comment-user userinfo" href="/users/25489/davehigton">davehigton</a>
                
            </div>
        </div>
    
        <a name="56047"></a>
        <div class="comment not_top_scorer" id="comment-56047">
            <div id="post-56047-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>needs to be <code>usbmon2</code> rather than just <code>usbmon</code></p>
</blockquote>

<p>that's true if you need to reduce the amount of captured data and system load, as use of <code>usbmon</code> causes traffic from all root hubs to be captured, while use of <code>usbmon2</code> causes only traffic from root hub 2 to be captured.</p>

<blockquote>
<p>Is it possible to make live capture-and-display work the same way?</p>
</blockquote>

<p>well, it is possible but not really convenient. You can tell tcpdump to write the output to a named pipe and let Wireshark read from the pipe, as described at <a href="https://wiki.wireshark.org/CaptureSetup/Pipes">the Capture Setup chapter of Wireshark's wiki</a>:</p>

<pre><code>mkfifo /tmp/my_pipe
wireshark -k -i /tmp/my_pipe &amp;
sudo tcpdump -i usbmon2 -s 0 -w /tmp/my_pipe &amp;
</code></pre>

<p>But the difference in behaviour between tcpdump and Wireshark makes me wonder what version of Wireshark you are running? Have you compiled it from source, or has it come with your Ubuntu distribution?</p></div>
            <div class="comment-info" id="comment-56047-info">
                
                
                
                

                

                <span class="comment-age">(01 Oct '16, 12:31)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="56063"></a>
        <div class="comment not_top_scorer" id="comment-56063">
            <div id="post-56063-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>But the difference in behaviour between tcpdump and Wireshark makes me wonder what version of Wireshark you are running? Have you compiled it from source, or has it come with your Ubuntu distribution?</p>
</blockquote>

<p>You may well ask what version.  Dash suggested it was the current stable version (2.0.2 something - this is Ubuntu 16.04), but Wireshark's Help About Wireshark said 1.12.8 (Git Rev Unknown from unknown).</p>

<p>I didn't compile it myself, and it isn't part of the Ubuntu distribution.  I must have installed it from a download from the Wireshark downloads site.  I did have a folder named Wireshark 1.12.8, which I have deleted.</p>

<p>Anyway, within the last few minutes I've attempted to remove Wireshark via apt-get, then install the current dev one (2.2.0 something) via apt-get.  However, Help About Wireshark still says version 1.12.8, and the truncation issue when capturing from usbmon remains.</p>

<p>So, somewhat bizarrely, I can't be certain what version I'm running, as the information I have is contradictory.</p>

<p>Does Help About correctly identify Wireshark's version?  If so, then it looks to me as if the removal process didn't work properly (and I would appreciate some pointers about removing it completely).</p></div>
            <div class="comment-info" id="comment-56063-info">
                
                
                
                

                

                <span class="comment-age">(01 Oct '16, 14:45)</span>
                <a class="comment-user userinfo" href="/users/25489/davehigton">davehigton</a>
                
            </div>
        </div>
    
        <a name="56064"></a>
        <div class="comment not_top_scorer" id="comment-56064">
            <div id="post-56064-score" class="comment-score"></div>
            <div class="comment-text"><p>Sorry - I must correct myself here.  I am looking at a capture from the mouse.  All packets are 52 bytes on the wire.  All packets from host to device are truncated to 48 bytes; all packets from device to host have the full 52 bytes.</p></div>
            <div class="comment-info" id="comment-56064-info">
                
                
                
                

                

                <span class="comment-age">(01 Oct '16, 15:03)</span>
                <a class="comment-user userinfo" href="/users/25489/davehigton">davehigton</a>
                
            </div>
        </div>
    
        <a name="56065"></a>
        <div class="comment not_top_scorer" id="comment-56065">
            <div id="post-56065-score" class="comment-score"></div>
            <div class="comment-text"><p>Wireshark's Help About identifies the version of Wireshark that is displaying Help About.</p></div>
            <div class="comment-info" id="comment-56065-info">
                
                
                
                

                

                <span class="comment-age">(01 Oct '16, 15:36)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="56066"></a>
        <div class="comment not_top_scorer" id="comment-56066">
            <div id="post-56066-score" class="comment-score"></div>
            <div class="comment-text"><p>Wireshark captures network traffic by running the dumpcap program, which is part of the Wireshark package; dumpcap uses libpcap, just as tcpdump does, to capture traffic.</p>

<p>This is why it's strange that tcpdump isn't truncating any packet but Wireshark - which means dumpcap - <em>is</em> truncating packets going from the host to the device.</p>

<p>Perhaps they're using different versions of libpcap.</p>

<p>What do the commands <code>which wireshark</code>, <code>which dumpcap</code>, and <code>which tcpdump</code> print?</p>

<p>What does the command <code>dumpcap -v</code> print (<em>all</em> of what it prints, not just the version of dumpcap itself)?</p>

<p>When you say "install the current dev one (2.2.0 something) via apt-get." what do you mean by "dev" in "current dev one"?</p></div>
            <div class="comment-info" id="comment-56066-info">
                
                
                
                

                

                <span class="comment-age">(01 Oct '16, 23:25)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="56277"></a>
        <div class="comment not_top_scorer" id="comment-56277">
            <div id="post-56277-score" class="comment-score"></div>
            <div class="comment-text"><p>Apologies again for the long absence.</p>

<p>I had a zombie copy of Wireshark 1.12.8 that refused to die - whatever I installed, or even when I uninstalled it, 1.12.8 was still there.</p>

<p>I did kill it in the end.  Now I've got 2.0.2 installed.  Properly.</p>

<p>OK, does it capture truncated now?</p>

<p>I just tried capturing from usbmon2 and simply hitting the NumLock key several times.  There are some pairs of lines for control out transactions.  For each pair, the first has source as host and destination as 2.3.0, length 49.  The packet details show 49 bytes on wire, 49 bytes captured, and I can recognise a control transaction with bmRequestType = 0x21, bRequest = 0x09, wValue = 0x0200, wIndex = 0x0000, wLength = 1 and one data byte (contents 0x01 when NumLock goes on, 0 when off).  Good.  The second of the pair has "[Packet size limited during capture]" in the Info column.  Source is 2.3.0 and destination is host.  The packet details say 49 bytes on wire, 48 bytes captured.  But this is just an ACK for the out transaction, isn't it?  Have any data been truncated?  Or is this just a spurious error message from the dissector?</p></div>
            <div class="comment-info" id="comment-56277-info">
                
                
                
                

                

                <span class="comment-age">(10 Oct '16, 03:25)</span>
                <a class="comment-user userinfo" href="/users/25489/davehigton">davehigton</a>
                
            </div>
        </div>
    
        <a name="56278"></a>
        <div class="comment not_top_scorer" id="comment-56278">
            <div id="post-56278-score" class="comment-score"></div>
            <div class="comment-text"><p>Discrepancy between "on the wire" and "captured" size is normally not an issue of dissector, at least it would be an issue of the <code>frame</code> dissector, not the <code>usb</code> one. Both sizes are stored in the capture file.</p>

<p>Given the description of your activity, you should see two interrupt transfers per keypress (because the press sends one message and the release sends another one) plus one SEND STATUS (or something similar) for the change of NumLock indicator LED status. What you describe seems to be only the exchange related to LED control.</p>

<p>However, to properly dissect what you now see as generic "USB CONTROL OUT" as a USBHID message SEND STATUS, you need to have the capture running already when connecting the keyboard, because Wireshark chooses the right dissector based on information from the USB descriptors which are only transferred over the bus right after the device gets connected. It should be safe to disconnect the keyboard after starting the capture and connect it back, but if you have another keyboard, better keep the main one connected and use the second one for the experiments.</p>

<p>Not to be misunderstood - this won't change the interpretation of the frame size, it will only improve the dissection of the contents.</p>

<p>Also, please export that single weird frame into a separate capture file, publish that file somewhere in the web and place here a link to it. Cloudshark is popular here, but any file sharing service or your own web site will do. To be sure whether it is a dissection issue or a capture file issue, it needs a hex view to see what is written in the pcap file.</p>

<p>But as you said the issue didn't happen when you used tcpdump, please do exactly the same activity while capturing using tcpdump, and then do the same activity once again while using dumpcap (with the same parameters like tcpdump) to capture.</p>

<p>It's simply weird that the (probably) same libpcap on the same (definitely) usbmon should yield different results.</p></div>
            <div class="comment-info" id="comment-56278-info">
                
                
                
                

                

                <span class="comment-age">(10 Oct '16, 04:25)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="56291"></a>
        <div class="comment not_top_scorer" id="comment-56291">
            <div id="post-56291-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>The packet details say 49 bytes on wire, 48 bytes captured.</p>
</blockquote>

<p>So whatever capture mechanism is being used, in that case, is, in fact, truncating the capture at 48 bytes.</p>

<p>Does this happen if you use tcpdump to capture on <code>usbmon2</code> and save the packets a capture file with '-w', and then read the capture in Wireshark?</p>

<p>Does this happen if you capture on <code>usbmon2</code> in Wireshark?</p>

<p>What does <code>tcpdump -h</code> print?  (The entire output, not just the tcpdump version number.)</p>

<p>What does <code>dumpcap -v</code> print?  (The entire output, not just the dumpcap version number.)</p>

<p>What does</p>

<pre><code>ls -l `which tcpdump`
</code></pre>

<p>print?</p>

<p>What does</p>

<pre><code>ls -l `which dumpcap`
</code></pre>

<p>print?</p></div>
            <div class="comment-info" id="comment-56291-info">
                
                
                
                

                

                <span class="comment-age">(10 Oct '16, 23:23)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="56353"></a>
        <div class="comment not_top_scorer" id="comment-56353">
            <div id="post-56353-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>What does tcpdump -h print? (The entire output, not just the tcpdump version number.)</p>
</blockquote>

<pre><code>tcpdump version 4.7.4libpcap version 1.7.4
OpenSSL 1.0.2g  1 Mar 2016
Usage: tcpdump [-aAbdDefhHIJKlLnNOpqRStuUvxX#] [ -B size ] [ -c count ]
        [ -C file_size ] [ -E algo:secret ] [ -F file ] [ -G seconds ]
        [ -i interface ] [ -j tstamptype ] [ -M secret ] [ --number ]
        [ -Q in|out|inout ]
        [ -r file ] [ -s snaplen ] [ --time-stamp-precision precision ]
        [ --immediate-mode ] [ -T type ] [ --version ] [ -V file ]
        [ -w file ] [ -W filecount ] [ -y datalinktype ] [ -z command ]
        [ -Z user ] [ expression ]
</code></pre>

<blockquote>
<p>What does dumpcap -v print? (The entire output, not just the dumpcap version number.)</p>
</blockquote>

<pre><code>Dumpcap (Wireshark) 2.0.2 (SVN Rev Unknown from unknown)

Copyright 1998-2016 Gerald Combs &lt;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="9dfaf8effcf1f9ddeaf4eff8eef5fceff6b3f2effa">[email&#160;protected]</a>&gt; and contributors.
License GPLv2+: GNU GPL version 2 or later &lt;<a href="http://www.gnu.org/licenses/old-licenses/gpl-2.0.html>">http://www.gnu.org/licenses/old-licenses/gpl-2.0.html&gt;</a>
This is free software; see the source for copying conditions. There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

Compiled (64-bit) with GLib 2.48.0, with libpcap, with POSIX capabilities
(Linux), with libnl 3, with libz 1.2.8.

Running on Linux 4.4.0-43-generic, with locale C, with libpcap version 1.7.4,
with libz 1.2.8.
Intel(R) Core(TM)2 CPU          6600  @ 2.40GHz

Built using gcc 5.3.1 20160407.
</code></pre>

<blockquote>
<p>What does ls -l <code>which tcpdump</code> print?</p>
</blockquote>

<pre><code>-rwxr-x--- 1 root pcap 1106360 Jun  2  2015 /usr/sbin/tcpdump
</code></pre>

<blockquote>
<p>What does ls -l <code>which dumpcap</code> print?</p>
</blockquote>

<pre><code>-rwxr-xr-x 1 root root 88272 Apr  8  2016 /usr/bin/dumpcap
</code></pre>

<p>Does this suggest that I still have an out of date version of tcpdump?</p></div>
            <div class="comment-info" id="comment-56353-info">
                
                
                
                

                

                <span class="comment-age">(13 Oct '16, 13:21)</span>
                <a class="comment-user userinfo" href="/users/25489/davehigton">davehigton</a>
                
            </div>
        </div>
    
        <a name="56357"></a>
        <div class="comment not_top_scorer" id="comment-56357">
            <div id="post-56357-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>What does tcpdump -h print?</p>
</blockquote>

<pre><code>tcpdump version 4.7.4
libpcap version 1.7.4
OpenSSL 1.0.2g  1 Mar 2016
Usage: tcpdump [-aAbdDefhHIJKlLnNOpqRStuUvxX#] [ -B size ] [ -c count ]
        [ -C file_size ] [ -E algo:secret ] [ -F file ] [ -G seconds ]
        [ -i interface ] [ -j tstamptype ] [ -M secret ] [ --number ]
        [ -Q in|out|inout ]
        [ -r file ] [ -s snaplen ] [ --time-stamp-precision precision ]
        [ --immediate-mode ] [ -T type ] [ --version ] [ -V file ]
        [ -w file ] [ -W filecount ] [ -y datalinktype ] [ -z command ]
        [ -Z user ] [ expression ]
</code></pre>

<p><code></code></p><code>
</code><p><code></code></p><p><code></code></p><p></p></div>
            <div class="comment-info" id="comment-56357-info">
                
                
                
                

                

                <span class="comment-age">(13 Oct '16, 13:29)</span>
                <a class="comment-user userinfo" href="/users/25489/davehigton">davehigton</a>
                
            </div>
        </div>
    
        <a name="56358"></a>
        <div class="comment not_top_scorer" id="comment-56358">
            <div id="post-56358-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>What does dumpcap -v print?</p>
</blockquote>

<p><code>Dumpcap (Wireshark) 2.0.2 (SVN Rev Unknown from unknown)</code></p>

<p><code>
</code></p><p><code>Copyright 1998-2016 Gerald Combs <a href="/cdn-cgi/l/email-protection#e7808295868b83a7908e9582948f86958cc9889580"><span class="__cf_email__" data-cfemail="f7909285969b93b7809e8592849f96859cd9988590">[email&#160;protected]</span></a> and contributors.
License GPLv2+: GNU GPL version 2 or later <a href="http://www.gnu.org/licenses/old-licenses/gpl-2.0.html">http://www.gnu.org/licenses/old-licenses/gpl-2.0.html</a>
This is free software; see the source for copying conditions. There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</code></p><code>
<p>Compiled (64-bit) with GLib 2.48.0, with libpcap, with POSIX capabilities
(Linux), with libnl 3, with libz 1.2.8.</p>
<p>Running on Linux 4.4.0-43-generic, with locale C, with libpcap version 1.7.4,
with libz 1.2.8.
Intel(R) Core(TM)2 CPU          6600  @ 2.40GHz</p>
</code><p><code>Built using gcc 5.3.1 20160407.
</code></p><p></p></div>
            <div class="comment-info" id="comment-56358-info">
                
                
                
                

                

                <span class="comment-age">(13 Oct '16, 13:29)</span>
                <a class="comment-user userinfo" href="/users/25489/davehigton">davehigton</a>
                
            </div>
        </div>
    
        <a name="56359"></a>
        <div class="comment not_top_scorer" id="comment-56359">
            <div id="post-56359-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>What does ls -l <code>which tcpdump</code> print?</p>
</blockquote>

<p><code>-rwxr-x--- 1 root pcap 1106360 Jun  2  2015 /usr/sbin/tcpdump
</code></p></div>
            <div class="comment-info" id="comment-56359-info">
                
                
                
                

                

                <span class="comment-age">(13 Oct '16, 13:31)</span>
                <a class="comment-user userinfo" href="/users/25489/davehigton">davehigton</a>
                
            </div>
        </div>
    
        <a name="56360"></a>
        <div class="comment not_top_scorer" id="comment-56360">
            <div id="post-56360-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>What does ls -l <code>which dumpcap</code> print?</p>
</blockquote>

<p><code>-rwxr-xr-x 1 root root 88272 Apr  8  2016 /usr/bin/dumpcap
</code></p></div>
            <div class="comment-info" id="comment-56360-info">
                
                
                
                

                

                <span class="comment-age">(13 Oct '16, 13:32)</span>
                <a class="comment-user userinfo" href="/users/25489/davehigton">davehigton</a>
                
            </div>
        </div>
    
        <a name="56361"></a>
        <div class="comment not_top_scorer" id="comment-56361">
            <div id="post-56361-score" class="comment-score"></div>
            <div class="comment-text"><p>Does this indicate that I still have an out of date version of tcpdump?</p></div>
            <div class="comment-info" id="comment-56361-info">
                
                
                
                

                

                <span class="comment-age">(13 Oct '16, 13:34)</span>
                <a class="comment-user userinfo" href="/users/25489/davehigton">davehigton</a>
                
            </div>
        </div>
    
        <a name="56362"></a>
        <div class="comment not_top_scorer" id="comment-56362">
            <div id="post-56362-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>What you describe seems to be only the exchange related to LED control.</p>
</blockquote>

<p>Absolutely.  The interrupt in message from the keyboard wasn't in question, so I didn't mention it.  I believe that I'm seeing /all/ messages on the USB, including the control transfer to command the LED status, and a USB ACK (a level that we don't normally care about) to signal back from device to host that the control transfer succeeded.</p></div>
            <div class="comment-info" id="comment-56362-info">
                
                
                
                

                

                <span class="comment-age">(13 Oct '16, 13:40)</span>
                <a class="comment-user userinfo" href="/users/25489/davehigton">davehigton</a>
                
            </div>
        </div>
    
        <a name="56363"></a>
        <div class="comment not_top_scorer" id="comment-56363">
            <div id="post-56363-score" class="comment-score"></div>
            <div class="comment-text"><p>It indicates that you have a reasonably recent version of <em>libpcap</em>, and a reasonably recent version of tcpdump, which is using that version of libpcap, and that dumpcap is using the same version of libpcap.</p>

<p>It's libpcap that matters here.</p></div>
            <div class="comment-info" id="comment-56363-info">
                
                
                
                

                

                <span class="comment-age">(13 Oct '16, 13:41)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="56364"></a>
        <div class="comment not_top_scorer" id="comment-56364">
            <div id="post-56364-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>Does this suggest that I still have an out of date version of tcpdump?</p>
</blockquote>

<p>Your <code>tcpdump</code> is older than your <code>dumpcap</code> but it doesn't matter as <code>tcpdump</code> is not part of the Wireshark project, so unlike your Wireshark 1.12.x was, your <code>tcpdump</code> is not a zombie as reinstallation of Wireshark does not affect it.</p>

<p>What really bothers me is that, as now confirmed, both <code>tcpdump</code> and <code>dumpcap</code> use the same <code>libpcap</code> (1.7.4) and still give different results. As said, can you please capture the same usb activity into a file once using <code>tcpdump</code> and once using <code>dumpcap</code> with the same parameters (<code>-i usbmon -s 0 -w /some/file/name</code> and compare the results? Doing so should highlight whether the bug is between libpcap and the rest of dumpcap code or, less likely, between dumpcap and Wireshark during live capture.</p></div>
            <div class="comment-info" id="comment-56364-info">
                
                
                
                

                

                <span class="comment-age">(13 Oct '16, 13:43)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="56365"></a>
        <div class="comment not_top_scorer" id="comment-56365">
            <div id="post-56365-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>Does this indicate that I still have an out of date version of tcpdump?</p>
</blockquote>

<p>On second thoughts: no, according to www.tcpdump.org.</p></div>
            <div class="comment-info" id="comment-56365-info">
                
                
                
                

                

                <span class="comment-age">(13 Oct '16, 13:43)</span>
                <a class="comment-user userinfo" href="/users/25489/davehigton">davehigton</a>
                
            </div>
        </div>
    
        <a name="56366"></a>
        <div class="comment not_top_scorer" id="comment-56366">
            <div id="post-56366-score" class="comment-score"></div>
            <div class="comment-text"><p>So:</p>

<p>Does tcpdump truncate any USB packets when you capture a particular sequence of traffic, such as the "repeatedly hitting Num Lock" sequence?</p>

<p>Does a capture done with Wireshark do so for the same sequence of traffic?</p>

<p>Does a capture done with dumpcap on the command line do so for the same sequence of traffic?</p></div>
            <div class="comment-info" id="comment-56366-info">
                
                
                
                

                

                <span class="comment-age">(13 Oct '16, 13:55)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-55846" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 24
        </span>
        <a href="#" class="show-all-comments-link">show 19 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-55846-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/55846/can-wireshark-capture-usb-data-on-linux-without-truncation-to-48-bytes?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/55846/can-wireshark-capture-usb-data-on-linux-without-truncation-to-48-bytes?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/55846/can-wireshark-capture-usb-data-on-linux-without-truncation-to-48-bytes?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/55846/can-wireshark-capture-usb-data-on-linux-without-truncation-to-48-bytes?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="56391"></a>
                    <div id="answer-container-56391" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-56391-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/56391/up/" rel="nofollow"> </a>
<div id="post-56391-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-56391-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/56391/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Wireshark on Linux can capture USB traffic without truncating it to 48 bytes, kernel 4.4 is new enough such that you do not have to worry about the historical limitation. Are you sure that your device is not sending less? While comparing libpcap versions is an option, to be absolutely sure you can first whether the kernel gives actually gives you data.</p>
<p>So, check whether the kernel (USB device) really returns more than 48 bytes. To do so, either access the device nodes in debugfs (<code>cat /sys/kernel/debug/usb/usbmon/*u</code>) or invoke ioctls on the <code>/dev/usbmon*</code> devices. (Here, <code>*</code> is the bus number or <code>0</code> for a catch-all.)</p>
<p>Pay especially attention to the number before the equals sign. This is the actual data length. For the textual output in debugfs, the data after <code>=</code> is truncated to 32 bytes (see <code>DATA_MAX</code> in the kernel sources, <code>drivers/usb/mon/mon_text.c</code>).</p>
<p>You can run the above experiment while capturing with <code>tcpdump -i usbmon*</code> (or Wireshark), the results should match up. If not, you could try to run <code>strace</code> against the capture process (tcpdump or dumpcap), but if this happens, then something is seriously wrong. Maybe you are capturing from the wrong usbmon device?</p>
<p>Related material:</p>
<ul>
<li><a href="https://www.kernel.org/doc/Documentation/usb/usbmon.txt">https://www.kernel.org/doc/Documentation/usb/usbmon.txt</a> (describes debugfs output and the ioctls).</li>
<li><a href="https://wiki.wireshark.org/CaptureSetup/USB#Linux">https://wiki.wireshark.org/CaptureSetup/USB#Linux</a></li>
</ul>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/56391/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>14 Oct '16, 14:29</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/285b1f0f4caadc088a38c40aea22feba?s=32&amp;d=identicon&amp;r=g" alt="Lekensteyn's gravatar image" />
    <p><a href="/users/5644/lekensteyn">Lekensteyn</a><br/>
    <span class="score" title="2213 reputation points"><span class="">2.2k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="7 badges"><span class="silver">&#9679;</span><span class="badgecount">7</span></span><span title="24 badges"><span class="bronze">&#9679;</span><span class="badgecount">24</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Lekensteyn has 32 accepted answers">30&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-56391">
    
</div>
<div id="comment-tools-56391" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-56391-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/55846/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='bOgQI3Yi6yF04nkvzs7NxjeNEpBuZpcg' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/55846/can-wireshark-capture-usb-data-on-linux-without-truncation-to-48-bytes?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/55846/can-wireshark-capture-usb-data-on-linux-without-truncation-to-48-bytes?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/linux/"
            class="tag-link-linux"
            title="see questions tagged'linux'using tags"
            rel="tag">linux</a> <span class="tag-number">&#215;154</span><br/>
        
        <a href="/tags/usb/"
            class="tag-link-usb"
            title="see questions tagged'usb'using tags"
            rel="tag">usb</a> <span class="tag-number">&#215;69</span><br/>
        
        <a href="/tags/truncate/"
            class="tag-link-truncate"
            title="see questions tagged'truncate'using tags"
            rel="tag">truncate</a> <span class="tag-number">&#215;2</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Sept. 26, 2016, 8:34 a.m.">26 Sep '16, 08:34</strong>
    </p>
    <p> 
     	question was seen: <strong>3,671 times</strong>
    </p>
    <p> 
        last updated: <strong title="Oct. 14, 2016, 2:29 p.m.">14 Oct '16, 14:29</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/35660/determine-physical-usb-port-in-wireshark-dump">Determine Physical USB Port in Wireshark Dump</a>
        </p>
        
        <p>
            <a href="/questions/36116/what-does-port-1-mean-in-a-usb-capture">What does [Port 1] mean in a USB capture?</a>
        </p>
        
        <p>
            <a href="/questions/170/wireshark-only-showing-one-way-communication-over-vpn-tunnel">Wireshark only showing one way communication over VPN tunnel</a>
        </p>
        
        <p>
            <a href="/questions/10784/can-download-wireshark-for-ubuntu-linux">Can Download Wireshark for Ubuntu Linux?</a>
        </p>
        
        <p>
            <a href="/questions/18435/how-do-i-set-up-wireshark-for-linux">How do I set up Wireshark for Linux?</a>
        </p>
        
        <p>
            <a href="/questions/24613/what-does-sll-stand-for-as-in-the-context-of-linux-cooked-headers">What does SLL stand for (as in the context of Linux &quot;cooked&quot; headers)?</a>
        </p>
        
        <p>
            <a href="/questions/29024/compiled-wireshark-does-not-color-the-packets-by-default">Compiled wireshark does not color the packets by default</a>
        </p>
        
        <p>
            <a href="/questions/35615/expert-information-field">Expert information field</a>
        </p>
        
        <p>
            <a href="/questions/43707/how-to-get-individual-vlan-information-of-same-frame-from-a-wireshark-8021q-packet">How to get individual vlan information of same frame from a Wireshark 802.1q packet</a>
        </p>
        
        <p>
            <a href="/questions/48124/start-development-wireshark-build-on-linux">Start development wireshark build on linux</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
