<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Displaying all TCP connections with SYN packets - Wireshark Q&amp;A</title>
        <meta name="description" content="Hello, I&#39;m working on a rather large .pcap file, and I&#39;m interested in displaying only the TCP connections that contain a SYN packet. Is there any way to do this?" />
        <meta name="keywords" content="connection,syn,tcp" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/230/displaying-all-tcp-connections-with-syn-packets" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/230/displaying-all-tcp-connections-with-syn-packets?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='DBy96Ic4pnIHhqj7nnKV3qztUFJjsVti' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/230/displaying-all-tcp-connections-with-syn-packets">Displaying all TCP connections with SYN packets</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-230-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/230/up/" rel="nofollow"> </a>
<div id="post-230-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-230-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/230/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/230/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   3
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hello,</p>
<p>I'm working on a rather large .pcap file, and I'm interested in displaying only the TCP connections that contain a SYN packet.  Is there any way to do this?</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/connection/" class="post-tag tag-link-connection"
                                        title="see questions tagged 'connection'" rel="tag">connection</a>
                                
                                    <a href="/tags/syn/" class="post-tag tag-link-syn"
                                        title="see questions tagged 'syn'" rel="tag">syn</a>
                                
                                    <a href="/tags/tcp/" class="post-tag tag-link-tcp"
                                        title="see questions tagged 'tcp'" rel="tag">tcp</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>20 Sep '10, 10:44</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/832728debd1b180125e7979571c329f7?s=32&amp;d=identicon&amp;r=g" alt="cmkastn's gravatar image" />
    <p><a href="/users/110/cmkastn">cmkastn</a><br/>
    <span class="score" title="1 reputation points">1</span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="3 badges"><span class="silver">&#9679;</span><span class="badgecount">3</span></span><span title="2 badges"><span class="bronze">&#9679;</span><span class="badgecount">2</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="cmkastn has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-230">
    
</div>
<div id="comment-tools-230" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-230-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    5 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/230/displaying-all-tcp-connections-with-syn-packets?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/230/displaying-all-tcp-connections-with-syn-packets?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/230/displaying-all-tcp-connections-with-syn-packets?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/230/displaying-all-tcp-connections-with-syn-packets?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="236"></a>
                    <div id="answer-container-236" class="answer accepted-answer">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-236-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/236/up/" rel="nofollow"> </a>
<div id="post-236-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-236-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/236/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="Loris Degioanni has selected this answer as the correct answer"
        href="/accept_answer/236/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>The display filter to show only SYN packets is:</p>
<pre><code>tcp.flags.syn==1 &amp;&amp; tcp.flags.ack==0
</code></pre>
<p>If you only want to capture TCP/SYN packets, the capture filter would be:</p>
<pre><code>tcp[0xd]&amp;18=2
</code></pre>
<p>When you are not only interested in the SYN packets, but also the SYN/ACK packets this changes to:</p>
<pre><code>tcp.flags.syn==1
tcp[0xd]&amp;2=2
</code></pre>
<p>If I read your question in another way, you are looking for "all packets belonging to a TCP session for which the SYN packet is actually in the capture file". If this is your question, this can't be done directly with Wireshak. But you can do it by using <a href="http://wiki.wireshark.org/Mate">MATE</a> or <a href="http://wiki.wireshark.org/Lua">LUA</a>.</p>
<p>Or you can write a <a href="http://www.cacetech.com/sharkfest.10/A-6_Blok%20HANDS-ON%20LAB%20-%20Using%20Wireshark%20Command%20Line%20Tools%20and%20Scripting.zip">tshark script</a> to extract all the TCP sessions that have the initial SYN in the capture file.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/236/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>20 Sep '10, 10:54</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7901a94d8fdd1f9f47cda9a32fcfa177?s=32&amp;d=identicon&amp;r=g" alt="SYN-bit's gravatar image" />
    <p><a href="/users/5/syn-bit">SYN-bit ♦♦</a><br/>
    <span class="score" title="17094 reputation points"><span class="">17.1k</span></span><span title="9 badges"><span class="badge1">&#9679;</span><span class="badgecount">9</span></span><span title="57 badges"><span class="silver">&#9679;</span><span class="badgecount">57</span></span><span title="245 badges"><span class="bronze">&#9679;</span><span class="badgecount">245</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="SYN-bit has 174 accepted answers">20&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/236/">
                edited
                <strong>20 Sep '10, 10:56</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-236">
    
</div>
<div id="comment-tools-236" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-236-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="232"></a>
                    <div id="answer-container-232" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-232-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/232/up/" rel="nofollow"> </a>
<div id="post-232-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-232-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/232/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>(tcp.flags.syn == 1 and tcp.flags.ack == 0) is the display filter you want</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/232/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>20 Sep '10, 10:48</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/e458b44fd60b4064eb73fc42e67b3897?s=32&amp;d=identicon&amp;r=g" alt="grossman's gravatar image" />
    <p><a href="/users/85/grossman">grossman</a><br/>
    <span class="score" title="16 reputation points">16</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">&#9679;</span><span class="badgecount">4</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="grossman has no accepted answers">0&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-232">
    
        <a name="233"></a>
        <div class="comment" id="comment-233">
            <div id="post-233-score" class="comment-score"></div>
            <div class="comment-text"><p>That will get you SYN packets only.  Removing the "and tcp.flags.ack == 0" part will get you SYNs and SYN/ACKs.</p></div>
            <div class="comment-info" id="comment-233-info">
                
                
                
                

                

                <span class="comment-age">(20 Sep '10, 10:49)</span>
                <a class="comment-user userinfo" href="/users/85/grossman">grossman</a>
                
            </div>
        </div>
    
        <a name="235"></a>
        <div class="comment" id="comment-235">
            <div id="post-235-score" class="comment-score"></div>
            <div class="comment-text"><p>That will show all packets that are SYN packets, but I want to see the complete connections for all connections that have SYN packets.</p></div>
            <div class="comment-info" id="comment-235-info">
                
                
                
                

                

                <span class="comment-age">(20 Sep '10, 10:50)</span>
                <a class="comment-user userinfo" href="/users/110/cmkastn">cmkastn</a>
                
            </div>
        </div>
    
        <a name="237"></a>
        <div class="comment" id="comment-237">
            <div id="post-237-score" class="comment-score"></div>
            <div class="comment-text"><p>Ah.  Hmm.  Well, you could use the results of such a filter and then Right Click-&gt;Prepare A Filter-&gt;And Selected for the Stream Index under the TCP section of each SYN packet.  Not exactly elegant, but that is the first thing that comes to mind.</p></div>
            <div class="comment-info" id="comment-237-info">
                
                
                
                

                

                <span class="comment-age">(20 Sep '10, 10:55)</span>
                <a class="comment-user userinfo" href="/users/85/grossman">grossman</a>
                
            </div>
        </div>
    
        <a name="239"></a>
        <div class="comment" id="comment-239">
            <div id="post-239-score" class="comment-score"></div>
            <div class="comment-text"><p>Which can be automated with a little tshark scripting :-)</p></div>
            <div class="comment-info" id="comment-239-info">
                
                
                
                

                

                <span class="comment-age">(20 Sep '10, 11:05)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-232" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-232-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="4442"></a>
                    <div id="answer-container-4442" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-4442-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/4442/up/" rel="nofollow"> </a>
<div id="post-4442-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-4442-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/4442/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>With the release of Wireshark 1.6.0, and thanks to some code changes by Sake Blok, you can now show all conversations that have their three-way handshake in the trace file with the display filter "tcp.window_size_scalefactor!=-1".</p>
<p>Note that this will show each CONVERSATION whose three-way handshake is present in the trace file, but it won't show the SYN packet or the SYN/ACK packet. The display will start with the third packet of the three-way handshake for each conversation. To see everything, select the stream you're interested in and then select "Follow TCP Stream."</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/4442/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>07 Jun '11, 13:51</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/071fe61f64868d98bdf4eb060b63b6ca?s=32&amp;d=identicon&amp;r=g" alt="Jim%20Aragon's gravatar image" />
    <p><a href="/users/527/jim-aragon">Jim Aragon</a><br/>
    <span class="score" title="7187 reputation points"><span class="">7.2k</span></span><span title="7 badges"><span class="badge1">&#9679;</span><span class="badgecount">7</span></span><span title="33 badges"><span class="silver">&#9679;</span><span class="badgecount">33</span></span><span title="118 badges"><span class="bronze">&#9679;</span><span class="badgecount">118</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Jim Aragon has 70 accepted answers">24&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-4442">
    
        <a name="4443"></a>
        <div class="comment" id="comment-4443">
            <div id="post-4443-score" class="comment-score">2</div>
            <div class="comment-text"><p>That was indeed a nice semi-planned by-product from my code change... Glad to see it got picked up :-)</p>

<p>Well, since we're looking for all conversations that do have the 3-way handshake in the tracefile, adding all the SYN packets will not harm us here. So you could use:</p>

<pre><code>tcp.flags.syn==1 or tcp.window_size_scalefactor!=-1
</code></pre></div>
            <div class="comment-info" id="comment-4443-info">
                
                
                
                

                

                <span class="comment-age">(07 Jun '11, 14:17)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="4445"></a>
        <div class="comment" id="comment-4445">
            <div id="post-4445-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks, Sake. That's what we're looking for. Question: In bug 5541, you said that the three values were going to be:</p>

<p>-1: 3WHS missing
0: No scaling negotiated, using the real value.
1 &amp; higher powers of two: scaling has been negotiated &amp; the window_size has been calculated accordingly</p>

<p>I see the following in the packet details pane:</p>

<p>[Window size scaling factor: -2 (no window scaling used)]</p>

<p>tcp.window_size_scalefactor==-2 shows me the streams that don't use window scaling; tcp.window_size_scalefactor==0 doesn't display anything. So I guess "0" got changed to "-2" in the final code revision?</p></div>
            <div class="comment-info" id="comment-4445-info">
                
                
                
                

                

                <span class="comment-age">(07 Jun '11, 15:07)</span>
                <a class="comment-user userinfo" href="/users/527/jim-aragon">Jim Aragon</a>
                
            </div>
        </div>
    
        <a name="4446"></a>
        <div class="comment" id="comment-4446">
            <div id="post-4446-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes, while implementing, I wanted to be able to make a distinction between window scaling factor 0 and no window scaling used. Both will result in the window size not being scaled up, but they are completely different situations. So the values are:</p>

<ul>
<li>-2 : Either the client or the server did not negotiate(!) window scaling, so no window scaling used</li>
<li>-1 : We have not seen the 3WHS and can therefor not tell whether or not to use window scaling</li>
<li>0+ : We do window scaling and this is the announced(!) window scaling factor for this flow</li>
</ul>

<p>Hope this makes it clear...</p></div>
            <div class="comment-info" id="comment-4446-info">
                
                
                
                

                

                <span class="comment-age">(07 Jun '11, 15:43)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="4447"></a>
        <div class="comment" id="comment-4447">
            <div id="post-4447-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes, that makes it clear. And I agree with distinguishing between the two situations. That was the original problem with bug 5541: Using the same name/value for things that are different.</p></div>
            <div class="comment-info" id="comment-4447-info">
                
                
                
                

                

                <span class="comment-age">(07 Jun '11, 16:02)</span>
                <a class="comment-user userinfo" href="/users/527/jim-aragon">Jim Aragon</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-4442" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-4442-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="248"></a>
                    <div id="answer-container-248" class="answer answered-by-owner">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-248-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/248/up/" rel="nofollow"> </a>
<div id="post-248-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-248-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/248/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>For anyone who's curious, this bash script seems to work.  I'm sure there's an easier way to do it, but I'm not the best scripter in the world.</p>
<pre><code>#!/bin/bash

file=$1
outfile=$2

string=""
counter=0

for src in `tshark -r $file -R "tcp.flags.syn == 1" -T fields -e ip.src -e ip.dst -e tcp.srcport -e tcp.dstport | cut -d ' ' -f1-4`
do
    if [ $counter == 0 ]; then
        string=$string"(ip.src == $src &amp;&amp; "
    elif [ $counter == 1 ]; then
        string=$string"ip.dst == $src &amp;&amp; "
    elif [ $counter == 2 ]; then
        string=$string"tcp.srcport == $src &amp;&amp; "
    else
        string=$string"tcp.dstport == $src) || " 
    fi

    if [ $counter == 3 ]; then
        let counter=0
    else
        let counter=$counter+1
    fi 
done

string=${string%????}

tshark -r $file -R "$string" -w "$outfile"
</code></pre>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/248/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>21 Sep '10, 10:12</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/832728debd1b180125e7979571c329f7?s=32&amp;d=identicon&amp;r=g" alt="cmkastn's gravatar image" />
    <p><a href="/users/110/cmkastn">cmkastn</a><br/>
    <span class="score" title="1 reputation points">1</span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="3 badges"><span class="silver">&#9679;</span><span class="badgecount">3</span></span><span title="2 badges"><span class="bronze">&#9679;</span><span class="badgecount">2</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="cmkastn has no accepted answers">0&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-248">
    
</div>
<div id="comment-tools-248" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-248-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="309"></a>
                    <div id="answer-container-309" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-309-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/309/up/" rel="nofollow"> </a>
<div id="post-309-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-309-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/309/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>If I only want to see the SYN-Flag (and not also SYN/ACK or funky flag combinations created by OS fingerprinting tools like nmap) I usually go for </p>
<p>"tcp.flags==0x02"</p>
<p>I used to do it like Sake suggested with the "tcp.flags.syn==1 and tcp.flags.ack==0", but I'm lazy and since my memory now allows me to remember the shorter version with "0x02" I use that :-)</p>
<p>Oh, and maybe this helps: if you want to avoid loading the whole trace and then filter it, you can also use the "tcp.flags==0x02" as a load filter in the open file dialog. That will then only load the frames that match and allow faster processing afterwards.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/309/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>24 Sep '10, 02:52</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" alt="Jasper's gravatar image" />
    <p><a href="/users/145/jasper">Jasper ♦♦</a><br/>
    <span class="score" title="23806 reputation points"><span class="">23.8k</span></span><span title="5 badges"><span class="badge1">&#9679;</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">&#9679;</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">&#9679;</span><span class="badgecount">284</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Jasper has 263 accepted answers">18&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/309/">
                edited
                <strong>24 Sep '10, 02:55</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-309">
    
</div>
<div id="comment-tools-309" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-309-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/230/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='DBy96Ic4pnIHhqj7nnKV3qztUFJjsVti' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/230/displaying-all-tcp-connections-with-syn-packets?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/230/displaying-all-tcp-connections-with-syn-packets?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/tcp/"
            class="tag-link-tcp"
            title="see questions tagged'tcp'using tags"
            rel="tag">tcp</a> <span class="tag-number">&#215;752</span><br/>
        
        <a href="/tags/syn/"
            class="tag-link-syn"
            title="see questions tagged'syn'using tags"
            rel="tag">syn</a> <span class="tag-number">&#215;55</span><br/>
        
        <a href="/tags/connection/"
            class="tag-link-connection"
            title="see questions tagged'connection'using tags"
            rel="tag">connection</a> <span class="tag-number">&#215;41</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Sept. 20, 2010, 10:44 a.m.">20 Sep '10, 10:44</strong>
    </p>
    <p> 
     	question was seen: <strong>153,348 times</strong>
    </p>
    <p> 
        last updated: <strong title="April 10, 2014, 7:23 p.m.">10 Apr '14, 19:23</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/54778/what-should-i-see-in-capture-when-there-is-tcp-error-could-not-connect-to-the-server">What should I see in capture when there is TCP error: Could not connect to the server?</a>
        </p>
        
        <p>
            <a href="/questions/29758/syn-with-ecn-flag-set-on-certain-port-number">Syn with ECN flag set on certain port number</a>
        </p>
        
        <p>
            <a href="/questions/50122/tcp-retransmissions-to-port-445">TCP Retransmissions to port 445</a>
        </p>
        
        <p>
            <a href="/questions/31714/is-there-a-filter-for-a-full-tcp-sequence">Is there a filter for a Full TCP sequence ?</a>
        </p>
        
        <p>
            <a href="/questions/59379/using-wireshark-to-troubleshoot-a-tcp-connection">Using wireshark to troubleshoot a tcp connection?</a>
        </p>
        
        <p>
            <a href="/questions/31401/filter-by-tcp-connection-handshake-time">Filter by TCP Connection (handshake) time.</a>
        </p>
        
        <p>
            <a href="/questions/18817/syn-is-answered-by-a-strange-ack-rst-is-ignored-windows">SYN is answered by a strange ACK, RST is ignored. Windows</a>
        </p>
        
        <p>
            <a href="/questions/54348/rst-after-syn-synack">RST after SYN -&gt; SYN/ACK</a>
        </p>
        
        <p>
            <a href="/questions/34954/connection-reset-rst-ack-causing-print-failure">Connection reset (RST, ACK) causing print failure</a>
        </p>
        
        <p>
            <a href="/questions/41529/tcp-connection-closure">TCP connection closure</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
