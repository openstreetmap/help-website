<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Complex Lua TCP Reassembly Problem - Wireshark Q&amp;A</title>
        <meta name="description" content="Hello Wireshark Community! I have been using lua to create various protocol dissectors for quite a while now and I am facing a problem I haven&#39;t been able to figure out. The way lua handles TCP reassembly is relatively simple however it seems like there is one shortcoming considering the following s..." />
        <meta name="keywords" content="reassembly,dissection,dissector,tcp,lua" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/44057/complex-lua-tcp-reassembly-problem" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/44057/complex-lua-tcp-reassembly-problem?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='X8B3oP9Z628GMsqvFxO2HnPMW7WWykhz' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/44057/complex-lua-tcp-reassembly-problem">Complex Lua TCP Reassembly Problem</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-44057-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/44057/up/" rel="nofollow"> </a>
<div id="post-44057-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-44057-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/44057/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/44057/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hello Wireshark Community!</p>
<p>I have been using lua to create various protocol dissectors for quite a while now and I am facing a problem I haven't been able to figure out. The way lua handles TCP reassembly is relatively simple however it seems like there is one shortcoming considering the following situation:
<br></p>
<ul>
<li>You are dissecting some streaming protocol FOO where a message unit is N byte long (N &lt; 1500).</li>
<li>Your capture starts at the beginning of one message unit.</li>
<li>All the TCP packets you receive contains at least one cut off message (at the end of the packet)</li>
<li>And this keeps going on for as long as your capture is taken.</li>
<li>Let's say your whole capture contains 100 packets.</li>
<li>Let's say when you reassemble all those packets, you have 500 complete messages.</li>
</ul>
<p><br>
Now here is where it gets tricky. 
<br><strong>CASE 1</strong> If your last packet actually contains the bytes that complete the message cut off in the previous packet PLUS one complete message (and nothing else) then your Wireshark will display 99 TCP frames and 1 FOO frame. When looking at this FOO frame it will say something like "100 reassembled TCP segments.." with all the packet numbers composing this huge reassembled frame. You'll be able to look at your 500 decoded FOO messages and you'll be happy (so would I be).
<br><strong>CASE 2</strong> If your last packet also contains the end of the previous message but also contains an incomplete message, then in Wireshark you will see 100 TCP frames marked as "TCP segment of a reassembled PDU" and basically even though your dissector has been able to decode all the messages (but the very last) in all those packets, no decoded FOO frame will be displayed. This is because the dissector "thinks" the dissection is not over because it is expecting the end of the last message in another packet (which is not available because the capture has ended.) <strong>This is a huge problem because it means that even though 499 FOO messages were successfully decoded, none of them will be displayed because the 500th one is incomplete!</strong>
<br><strong>So the question is how can you tell wireshark to just display what it has been able to dissect even if the last message was not complete?</strong> (Disabling dissector reassembly is not a solution because in this scenario you would only decode 1 message out of the hundreds actually available)</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/reassembly/" class="post-tag tag-link-reassembly"
                                        title="see questions tagged 'reassembly'" rel="tag">reassembly</a>
                                
                                    <a href="/tags/dissection/" class="post-tag tag-link-dissection"
                                        title="see questions tagged 'dissection'" rel="tag">dissection</a>
                                
                                    <a href="/tags/dissector/" class="post-tag tag-link-dissector"
                                        title="see questions tagged 'dissector'" rel="tag">dissector</a>
                                
                                    <a href="/tags/tcp/" class="post-tag tag-link-tcp"
                                        title="see questions tagged 'tcp'" rel="tag">tcp</a>
                                
                                    <a href="/tags/lua/" class="post-tag tag-link-lua"
                                        title="see questions tagged 'lua'" rel="tag">lua</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>10 Jul '15, 09:32</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/75e8b57bc655647abd3b12d5735f0de3?s=32&amp;d=identicon&amp;r=g" alt="MarkoPaulo's gravatar image" />
    <p><a href="/users/18386/markopaulo">MarkoPaulo</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">&#9679;</span><span class="badgecount">3</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="MarkoPaulo has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-44057">
    
        <a name="44058"></a>
        <div class="comment" id="comment-44058">
            <div id="post-44058-score" class="comment-score"></div>
            <div class="comment-text"><p>How are you performing the TCP reassembly in Lua, exactly?  There are multiple ways to do it.
Can you paste your script here, or something similar to your script?</p></div>
            <div class="comment-info" id="comment-44058-info">
                
                
                
                

                

                <span class="comment-age">(10 Jul '15, 09:50)</span>
                <a class="comment-user userinfo" href="/users/4318/hadriel">Hadriel</a>
                
            </div>
        </div>
    
        <a name="44061"></a>
        <div class="comment" id="comment-44061">
            <div id="post-44061-score" class="comment-score"></div>
            <div class="comment-text"><p>Hey Hadriel,
Thanks for your comment. Well I usually use 2 ways of reassembling my packets, but in this particular case I do something like this:</p>

<p>function isFooMessage(buf)
   <br>//if header corresponds to FOO header then return (true, expected_length)
   <br>//otherwise return false (heuristic dissection failed)
<br>end</p>

<p><br>
function dissectFOOMessage(buf, pinfo, rootTree)
   <br>//doing some dissection
   <br>//if successful return true otherwise return false (heuristic dissection)
<br>end</p>

<p><br>
function p_FOO.dissector(buf, pinfo, rootTree)
<br>   local is_FOO_message, expected_length = isFooMessage(buf);
<br>
<br>   if(~is_FOO_message) then
<br>        //heuristic dissection failed
<br>        return false;
<br>   end
<br>
 <br>   local offset = pkt.desegment_offset or 0
 <br>   if(expected_length &gt; buf:len()) then
   <br>      pinfo.desegment_len = DESEGMENT_ONE_MORE_SEGMENT;
   <br>      pinfo.desegment_offset = offset
   <br>      return nil
 <br>   end
 <br>   return dissectFOOMessage(buf, pinfo, rootTree);
<br>end</p>

<p><br>
<br>//Makes the dissector heuristic : Dissects only if p_FOO.dissector
<br>//does NOT return false
<br>p_FOO:register_heuristic("tcp", function(...) p_FOO.dissector (...) end)</p></div>
            <div class="comment-info" id="comment-44061-info">
                
                
                
                

                

                <span class="comment-age">(10 Jul '15, 10:35)</span>
                <a class="comment-user userinfo" href="/users/18386/markopaulo">MarkoPaulo</a>
                
            </div>
        </div>
    
        <a name="44062"></a>
        <div class="comment" id="comment-44062">
            <div id="post-44062-score" class="comment-score"></div>
            <div class="comment-text"><p>So basically all I do here is check if the message looks like a FOO message, then if it does and it's larger than the packet, I tell wireshark that I'll need another packet to finish decoding. In this dissector I purposely don't handle the case where my capture starts in the middle of a message but it's not in the scope of the scenario I described in my question.</p></div>
            <div class="comment-info" id="comment-44062-info">
                
                
                
                

                

                <span class="comment-age">(10 Jul '15, 10:41)</span>
                <a class="comment-user userinfo" href="/users/18386/markopaulo">MarkoPaulo</a>
                
            </div>
        </div>
    
        <a name="44064"></a>
        <div class="comment" id="comment-44064">
            <div id="post-44064-score" class="comment-score"></div>
            <div class="comment-text"><p>That's not really enough detail to figure things out. :)</p>

<p>But anyway, doing a heuristic dissector with the end for TCP reassembly is quite tricky.</p>

<p>I'd suggest starting with it <em>not</em> being a heuristic dissector, but instead just add your <code>p_FOO</code> to the TCP port that your capture file has. Then you can work on the logic to make it work even when missing a last segment  -which should be able to work, BTW.</p>

<p>What I don't see in the example script above is a while-loop, handling each of multiple potential messages inside a TCP segment.</p>

<p>For an example, see the 'fpm.lua' script and its associated capture file 'segmented_fpm.pcap' in the <a href="https://wiki.wireshark.org/Contrib#Protocol_Dissectors">repository of Lua plugins</a>.</p></div>
            <div class="comment-info" id="comment-44064-info">
                
                
                
                

                

                <span class="comment-age">(10 Jul '15, 12:54)</span>
                <a class="comment-user userinfo" href="/users/4318/hadriel">Hadriel</a>
                
            </div>
        </div>
    
        <a name="44065"></a>
        <div class="comment" id="comment-44065">
            <div id="post-44065-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks for your reply Hadriel. This was just a sample of dummy code to keep things short. I also added the proto to the tcp table. I thought that all the heuristic registration did was to "cancel" the dissection if the dissector returns false, meaning that it turns out the packet was not of the expected format.
I'm gonna try removing the heuristic part anyways and start from there.</p>

<p>I am not sure I understand what you mean with the "while loop thing". Are you talking about a while loop that would iterate through all the types of messages defined in the FOO protocol? If so then it would be in the function  dissectFOOMessage(buf, pinfo, rootTree), which I did not develop to keep things short. I was putting what I thought was the right amount of code to show you how I handled the reassembly and nothing else.</p>

<p>I never found the page you linked in your comment, and I think I am going to find it very useful. I will look at your lua scripts there and see if I can get what I want to work.</p>

<p>I'll get back to you whether I am successful or not :). Thanks again!</p></div>
            <div class="comment-info" id="comment-44065-info">
                
                
                
                

                

                <span class="comment-age">(10 Jul '15, 13:11)</span>
                <a class="comment-user userinfo" href="/users/18386/markopaulo">MarkoPaulo</a>
                
            </div>
        </div>
    
        <a name="44066"></a>
        <div class="comment not_top_scorer" id="comment-44066">
            <div id="post-44066-score" class="comment-score"></div>
            <div class="comment-text"><p>There can be multiple of your FOO messages inside a single TCP segment (inside a single <code>Tvb</code> buffer passed into the dissector function).  So you need a while-loop to handle dissecting each of them. If the last one is only partial, then you should be setting the <code>pinfo.desegment_offset</code> to the beginning of that last partial one - but the full ones will have already been dissected, so even if your capture file doesn't have another TCP segment to be able to dissect that last partial one, you'll still have the complete messages dissected and in the tree, etc.</p></div>
            <div class="comment-info" id="comment-44066-info">
                
                
                
                

                

                <span class="comment-age">(10 Jul '15, 14:14)</span>
                <a class="comment-user userinfo" href="/users/4318/hadriel">Hadriel</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-44057" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 6
        </span>
        <a href="#" class="show-all-comments-link">show 1 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-44057-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
        <form id="fmanswer" action="/questions/44057/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='X8B3oP9Z628GMsqvFxO2HnPMW7WWykhz' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Be the first one to answer this question!
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/44057/complex-lua-tcp-reassembly-problem?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/44057/complex-lua-tcp-reassembly-problem?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/tcp/"
            class="tag-link-tcp"
            title="see questions tagged'tcp'using tags"
            rel="tag">tcp</a> <span class="tag-number">&#215;752</span><br/>
        
        <a href="/tags/dissector/"
            class="tag-link-dissector"
            title="see questions tagged'dissector'using tags"
            rel="tag">dissector</a> <span class="tag-number">&#215;637</span><br/>
        
        <a href="/tags/lua/"
            class="tag-link-lua"
            title="see questions tagged'lua'using tags"
            rel="tag">lua</a> <span class="tag-number">&#215;431</span><br/>
        
        <a href="/tags/reassembly/"
            class="tag-link-reassembly"
            title="see questions tagged'reassembly'using tags"
            rel="tag">reassembly</a> <span class="tag-number">&#215;78</span><br/>
        
        <a href="/tags/dissection/"
            class="tag-link-dissection"
            title="see questions tagged'dissection'using tags"
            rel="tag">dissection</a> <span class="tag-number">&#215;31</span><br/>
        
    </p>
    <p>
        question asked: <strong title="July 10, 2015, 9:32 a.m.">10 Jul '15, 09:32</strong>
    </p>
    <p> 
     	question was seen: <strong>3,235 times</strong>
    </p>
    <p> 
        last updated: <strong title="July 10, 2015, 2:14 p.m.">10 Jul '15, 14:14</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/1357/lua-tcp-reassembly">Lua TCP reassembly</a>
        </p>
        
        <p>
            <a href="/questions/28076/pdu-reassembly-over-udp-within-a-lua-dissector">PDU reassembly over UDP within a lua dissector</a>
        </p>
        
        <p>
            <a href="/questions/37566/wireshark-dissector-development-reassembly-tcp-frames">Wireshark dissector development - Reassembly tcp frames</a>
        </p>
        
        <p>
            <a href="/questions/30529/does-reassembly-address-multiple-pdus-in-a-single-tcp-segment">Does reassembly address multiple PDUs in a single TCP segment?</a>
        </p>
        
        <p>
            <a href="/questions/61912/handling-missing-fragments-while-reassembling">Handling missing fragments while reassembling</a>
        </p>
        
        <p>
            <a href="/questions/43383/during-reassembly-of-a-protocol-running-on-top-of-tcp-setting-desegment_offset0-and-desegment_lendesegment_one_more_segment-seems-to-break-down-the-behavior-stated-in-readmedissector-is-this-expected">During reassembly of a protocol running on top of TCP, setting desegment_offset=0 and desegment_len=DESEGMENT_ONE_MORE_SEGMENT seems to break down the behavior stated in README.dissector. Is this expected?</a>
        </p>
        
        <p>
            <a href="/questions/9018/confusing-lua-reassembly-documentation-how-is-this-done-in-current-16x170">Confusing Lua reassembly documentation, how is this done in current 1.6.x/1.7.0 ?</a>
        </p>
        
        <p>
            <a href="/questions/5382/custom-dissector-and-info-column">Custom dissector and info column</a>
        </p>
        
        <p>
            <a href="/questions/61954/my-dissector-is-processing-the-first-packet-multiple-times">My dissector is processing the first packet multiple times.</a>
        </p>
        
        <p>
            <a href="/questions/41107/why-does-my-lua-dissector-cause-wireshark-to-consume-all-memory">Why does my Lua dissector cause Wireshark to consume all memory?</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
