<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Unable to capture unicast packets in monitor mode on wireshark - Wireshark Q&amp;A</title>
        <meta name="description" content="I have two RPi-3&#39;s and a desktop linux system. I have the two RPi-3&#39;s creating ping and iperf3 traffic between each other over wifi. I have the desktop linux system running wireshark in monitor mode, and have not been able to capture any data packets. Things I have done/tried include:  I am currentl..." />
        <meta name="keywords" content="wlan,802.11,monitor-mode,wireshark" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/52286/unable-to-capture-unicast-packets-in-monitor-mode-on-wireshark" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/52286/unable-to-capture-unicast-packets-in-monitor-mode-on-wireshark?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='upzmDKskgbmverdHvlhyGzv51vYs8wlV' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/52286/unable-to-capture-unicast-packets-in-monitor-mode-on-wireshark">Unable to capture unicast packets in monitor mode on wireshark</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-52286-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/52286/up/" rel="nofollow"> </a>
<div id="post-52286-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-52286-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/52286/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/52286/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   1
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>I have two RPi-3's and a desktop linux system.  I have the two RPi-3's creating ping and iperf3 traffic between each other over wifi.  I have the desktop linux system running wireshark in monitor mode, and have not been able to capture any data packets.  Things I have done/tried include:</p>
<ul>
<li>I am currently running wireshark with ubuntu 14.04 lts using an ASUS PCE-N10 (pci-e) network card</li>
<li>I am running wireshark Version 1.10.6 (v1.10.6 from master-1.10)</li>
<li>I have tried 6 different wifi cards (5 usb, 1 pci-e)</li>
<li>I am capturing 802.11n (no 5G ac)</li>
<li>I have set wireshark 802.11 encryption keys, and enabled encryption</li>
<li>I have enabled monitor mode multiple ways (wireshark capture options, airmon-ng, iwconfig, ...)</li>
<li>I have tried various settings for 802.11 protocol "Ignore Protection bit" and "Assume packets have FCS"</li>
<li>I have set the channel to match the wifi router (iwconfig or airmon-ng)</li>
<li>I see lot of broadcast packets </li>
<li>List item</li>
</ul>
<p><code>
eth0      Link encap:Ethernet  HWaddr f0:4d:a2:f6:15:82<br>
          inet addr:10.10.3.16  Bcast:10.10.3.255  Mask:255.255.255.0
          inet6 addr: fe80::f24d:a2ff:fef6:1582/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:1583160 errors:0 dropped:80 overruns:0 frame:0
          TX packets:3340647 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:213443629 (213.4 MB)  TX bytes:4339356507 (4.3 GB)</code></p><code>
<p>lo        Link encap:Local Loopback<br>
          inet addr:127.0.0.1  Mask:255.0.0.0
          inet6 addr: ::1/128 Scope:Host
          UP LOOPBACK RUNNING  MTU:65536  Metric:1
          RX packets:810841 errors:0 dropped:0 overruns:0 frame:0
          TX packets:810841 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:4257012230 (4.2 GB)  TX bytes:4257012230 (4.2 GB)</p>
<p>mon0      Link encap:UNSPEC  HWaddr F0-79-59-EB-24-78-3A-30-00-00-00-00-00-00-00-00<br>
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:32865 errors:0 dropped:22794 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:7563887 (7.5 MB)  TX bytes:0 (0.0 B)</p>
</code><p><code>wlan5     Link encap:UNSPEC  HWaddr F0-79-59-EB-24-78-00-00-00-00-00-00-00-00-00-00<br>
          BROADCAST MULTICAST  MTU:1500  Metric:1
          RX packets:329980 errors:0 dropped:164334 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:76222872 (76.2 MB)  TX bytes:0 (0.0 B
</code>  <br>
</p>
<p>Does anyone have any suggestion on what I could be doing wrong</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/wlan/" class="post-tag tag-link-wlan"
                                        title="see questions tagged 'wlan'" rel="tag">wlan</a>
                                
                                    <a href="/tags/802.11/" class="post-tag tag-link-802.11"
                                        title="see questions tagged '802.11'" rel="tag">802.11</a>
                                
                                    <a href="/tags/monitor-mode/" class="post-tag tag-link-monitor-mode"
                                        title="see questions tagged 'monitor-mode'" rel="tag">monitor-mode</a>
                                
                                    <a href="/tags/wireshark/" class="post-tag tag-link-wireshark"
                                        title="see questions tagged 'wireshark'" rel="tag">wireshark</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>06 May '16, 14:23</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/796d353373746c193c6e5c1ca1655320?s=32&amp;d=identicon&amp;r=g" alt="mw-ed's gravatar image" />
    <p><a href="/users/24084/mw-ed">mw-ed</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="3 badges"><span class="silver">&#9679;</span><span class="badgecount">3</span></span><span title="5 badges"><span class="bronze">&#9679;</span><span class="badgecount">5</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="mw-ed has one accepted answer">100&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/52286/">
                edited
                <strong>09 May '16, 11:42</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" alt="Guy%20Harris's gravatar image" />
            <p><a href="/users/79/guy-harris">Guy Harris ♦♦</a><br/>
            <span class="score" title="17443 reputation points"><span class="">17.4k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">&#9679;</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">&#9679;</span><span class="badgecount">196</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-52286">
    
        <a name="52288"></a>
        <div class="comment" id="comment-52288">
            <div id="post-52288-score" class="comment-score">1</div>
            <div class="comment-text"><blockquote>
<p>have not been able to capture any data packets</p>
</blockquote>

<p>I.e., you are not seeing any 802.11 packets with a "Type and subtype" field of "Data" or "QoS Data" or some other "Data" type?</p>

<p>If you <em>are</em> seeing them, please indicate what you mean by "have not been able to capture any data packets" - do you mean that nothing gets dissected past the 802.11 layer?</p></div>
            <div class="comment-info" id="comment-52288-info">
                
                
                
                

                

                <span class="comment-age">(06 May '16, 15:06)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="52292"></a>
        <div class="comment" id="comment-52292">
            <div id="post-52292-score" class="comment-score"></div>
            <div class="comment-text"><p>I have seen some broadcast packets, but no "Type and subtype" field of "Data" or "QoS Data" packets</p></div>
            <div class="comment-info" id="comment-52292-info">
                
                
                
                

                

                <span class="comment-age">(06 May '16, 15:36)</span>
                <a class="comment-user userinfo" href="/users/24084/mw-ed">mw-ed</a>
                
            </div>
        </div>
    
        <a name="52293"></a>
        <div class="comment" id="comment-52293">
            <div id="post-52293-score" class="comment-score">1</div>
            <div class="comment-text"><p>Just to be sure, does the above mean that you cannot see any 802.11 frames whose <code>wlan.da</code> field would differ from <code>ff:ff:ff:ff:ff:ff</code> (applying a display filter <code>!(wlan.da == ff:ff:ff:ff:ff:ff)</code> will show you whether any such frame remains in the packet list pane) or that such frames are there but you cannot decrypt their contents?</p>

<p>If there are really no frames but those with broadcast destination address, and if you are sure that the RPi-3s don't use 802.11ac mode, it may be a linux regression, as <a href="/users/112/bob-jones">@Bob Jones</a> pointed out in his comment from 30 Apr, 05:48 to <a href="https://ask.wireshark.org/questions/52027/capturing-traffic-from-wireless-cctv/52107">this answer</a>.</p>

<p>In general, it doesn't matter how many different WLAN adaptors you have but how many different chipsets they are built on, as any number of adaptors based on the same chipset will behave the same - at least in linux where adaptor manufacturer's specific modifications of generic drivers for a chipset are really rare.</p></div>
            <div class="comment-info" id="comment-52293-info">
                
                
                
                

                

                <span class="comment-age">(06 May '16, 23:03)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="52297"></a>
        <div class="comment not_top_scorer" id="comment-52297">
            <div id="post-52297-score" class="comment-score"></div>
            <div class="comment-text"><p>Can you share a trace of what you are seeing?  Otherwise we are just guessing at what you might or might not observe.</p></div>
            <div class="comment-info" id="comment-52297-info">
                
                
                
                

                

                <span class="comment-age">(07 May '16, 10:36)</span>
                <a class="comment-user userinfo" href="/users/112/bob-jones">Bob Jones</a>
                
            </div>
        </div>
    
        <a name="52344"></a>
        <div class="comment not_top_scorer" id="comment-52344">
            <div id="post-52344-score" class="comment-score"></div>
            <div class="comment-text"><p>I am currently using ASUS PCE-N10 (pci-e) which is a rtl8192ce chipset (as are most).  Other adapters also include and rtl8192cu and  Atheros ath9k chipsets.  I have also tried running it on a RPi3, but the RPi3 does not seem to support monitor mode.</p></div>
            <div class="comment-info" id="comment-52344-info">
                
                
                
                

                

                <span class="comment-age">(09 May '16, 05:20)</span>
                <a class="comment-user userinfo" href="/users/24084/mw-ed">mw-ed</a>
                
            </div>
        </div>
    
        <a name="52345"></a>
        <div class="comment not_top_scorer" id="comment-52345">
            <div id="post-52345-score" class="comment-score"></div>
            <div class="comment-text"><p><img alt="alt text" src="https://osqa-ask.wireshark.org/upfiles/wireshark_rE5AV0k.png"></p></div>
            <div class="comment-info" id="comment-52345-info">
                
                
                
                

                

                <span class="comment-age">(09 May '16, 05:53)</span>
                <a class="comment-user userinfo" href="/users/24084/mw-ed">mw-ed</a>
                
            </div>
        </div>
    
        <a name="52354"></a>
        <div class="comment not_top_scorer" id="comment-52354">
            <div id="post-52354-score" class="comment-score"></div>
            <div class="comment-text"><p>So what is the value of the "Type and subtype" field in the "LLC" frames?</p></div>
            <div class="comment-info" id="comment-52354-info">
                
                
                
                

                

                <span class="comment-age">(09 May '16, 11:23)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="52356"></a>
        <div class="comment not_top_scorer" id="comment-52356">
            <div id="post-52356-score" class="comment-score"></div>
            <div class="comment-text"><p>Unfortunately, screen shots do not provide enough details to provide analysis. It is best to post a PCAP file with the capture in question to Cloudshark, Google drive, etc. and share it so others can download the file.</p>

<p>With that said, did you try the other suggestions made above:</p>

<ol>
<li>
<p>Configure the WLAN (if possible) to 802.11a/b/g so that the higher coding schemes are not used.  I suspect the WiFi chipsets do not support the higher modulation schemes offered in an 802.11ac networks.</p>
</li>
<li>
<p>Apply the following filter to ensure no Data and/or QoS-Data packets are being captured:
wlan.fc.type eq 2 and !(wlan.fc.subtype eq 4 or wlan.fc.subtype eq 12)
If you apply the filter and see nothing, then you know that no Data and/or QoS-Data frames are not captured.</p>
</li>
</ol></div>
            <div class="comment-info" id="comment-52356-info">
                
                
                
                

                

                <span class="comment-age">(09 May '16, 11:27)</span>
                <a class="comment-user userinfo" href="/users/3386/amato_c">Amato_C</a>
                
            </div>
        </div>
    
        <a name="52357"></a>
        <div class="comment not_top_scorer" id="comment-52357">
            <div id="post-52357-score" class="comment-score"></div>
            <div class="comment-text"><p>"Type and subtype" field in the "LLC" frames? </p>

<pre><code>Type/Subtype: Data (0x20)
</code></pre></div>
            <div class="comment-info" id="comment-52357-info">
                
                
                
                

                

                <span class="comment-age">(09 May '16, 11:29)</span>
                <a class="comment-user userinfo" href="/users/24084/mw-ed">mw-ed</a>
                
            </div>
        </div>
    
        <a name="52360"></a>
        <div class="comment not_top_scorer" id="comment-52360">
            <div id="post-52360-score" class="comment-score"></div>
            <div class="comment-text"><p>OK, so you <em>are</em> seeing 802.11 packets with a "Type and subtype" field of "Data" or "QoS Data" or some other "Data" type.</p>

<p>I.e., you <em>are</em> capturing data packets; that's what those LLC packets are.</p>

<p>What you don't appear to be capturing are <em>unicast</em> packets.</p></div>
            <div class="comment-info" id="comment-52360-info">
                
                
                
                

                

                <span class="comment-age">(09 May '16, 11:41)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="52361"></a>
        <div class="comment" id="comment-52361">
            <div id="post-52361-score" class="comment-score">1</div>
            <div class="comment-text"><p>So you are seeing data frames now?
What happens when you apply this filter in Wireshark:</p>

<p>wlan.fc.type eq 2 and !(wlan.fc.subtype eq 4 or wlan.fc.subtype eq 12)</p>

<p>Do you see any frames?</p></div>
            <div class="comment-info" id="comment-52361-info">
                
                
                
                

                

                <span class="comment-age">(09 May '16, 11:42)</span>
                <a class="comment-user userinfo" href="/users/3386/amato_c">Amato_C</a>
                
            </div>
        </div>
    
        <a name="52362"></a>
        <div class="comment not_top_scorer" id="comment-52362">
            <div id="post-52362-score" class="comment-score"></div>
            <div class="comment-text"><p>Amato_C,</p>

<p>I set the router to support B/G only (no n and it does not support ac).
I ran wireshark capture, with the display filter wlan.fc.type eq 2 and !(wlan.fc.subtype eq 4 or wlan.fc.subtype eq 12) </p>

<p>The result was a bunch of LLC packets and a few SNA,STP, CLNP.  I also received a a few IPv4 packet with warnings ("Bogus IP Header" and "Malformed Packet")</p></div>
            <div class="comment-info" id="comment-52362-info">
                
                
                
                

                

                <span class="comment-age">(09 May '16, 11:53)</span>
                <a class="comment-user userinfo" href="/users/24084/mw-ed">mw-ed</a>
                
            </div>
        </div>
    
        <a name="52363"></a>
        <div class="comment not_top_scorer" id="comment-52363">
            <div id="post-52363-score" class="comment-score"></div>
            <div class="comment-text"><p>Guy Harris,</p>

<p>Yes you are correct, and I guess the unicast packets are what I am looking for, and thanks for changing the topic line.</p></div>
            <div class="comment-info" id="comment-52363-info">
                
                
                
                

                

                <span class="comment-age">(09 May '16, 11:56)</span>
                <a class="comment-user userinfo" href="/users/24084/mw-ed">mw-ed</a>
                
            </div>
        </div>
    
        <a name="52376"></a>
        <div class="comment" id="comment-52376">
            <div id="post-52376-score" class="comment-score">1</div>
            <div class="comment-text"><p>Looks like monitor mode is supported on the adapter but not promiscuous mode.  I don't have that chipset, but several others that behave this way.  Broadcast/multicast is usually sent at lower rates/modulation coding schemes so they tend to be easier to get.  However, ACKs, RTS, and CTS tend to be sent at lower rates too and we don't see any of those, and they are typically unicast.  I rule out modulation then (though you might still have issues collecting at higher rates) and assign root cause to no promiscuous mode support while in monitor mode.</p>

<p>Suggest to change hardware and/or kernel.</p></div>
            <div class="comment-info" id="comment-52376-info">
                
                
                
                

                

                <span class="comment-age">(09 May '16, 18:24)</span>
                <a class="comment-user userinfo" href="/users/112/bob-jones">Bob Jones</a>
                
            </div>
        </div>
    
        <a name="52390"></a>
        <div class="comment not_top_scorer" id="comment-52390">
            <div id="post-52390-score" class="comment-score"></div>
            <div class="comment-text"><p>Bob Jones,</p>

<p>Thanks, I went back and tried the TP-LINK TL-WN722N (Atheros ath9k chipset) and I seem to be up and running now.</p>

<p>Thank you for everyone's help.</p></div>
            <div class="comment-info" id="comment-52390-info">
                
                
                
                

                

                <span class="comment-age">(10 May '16, 06:40)</span>
                <a class="comment-user userinfo" href="/users/24084/mw-ed">mw-ed</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-52286" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 15
        </span>
        <a href="#" class="show-all-comments-link">show 10 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-52286-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/52286/unable-to-capture-unicast-packets-in-monitor-mode-on-wireshark?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/52286/unable-to-capture-unicast-packets-in-monitor-mode-on-wireshark?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/52286/unable-to-capture-unicast-packets-in-monitor-mode-on-wireshark?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/52286/unable-to-capture-unicast-packets-in-monitor-mode-on-wireshark?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="52392"></a>
                    <div id="answer-container-52392" class="answer accepted-answer answered-by-owner">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-52392-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/52392/up/" rel="nofollow"> </a>
<div id="post-52392-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-52392-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/52392/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="mw-ed has selected this answer as the correct answer"
        href="/accept_answer/52392/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>The key points for me to capture unicast packets from other systems seem to be:</p>
<ul>
<li>the rtl8192 chipset does not seem to capture unicast packets on ubuntu 14.04 LTS</li>
<li>both monitor and pomiscuous mode must be set</li>
<li>the wlan card must be set to monitor the appropriate frequency (i.e. iwconfig wlan0 channel 11)</li>
</ul>
<p>Further, to decode the packets:</p>
<ul>
<li>Edit-&gt;Preferences-&gt;Protocols-&gt;IEEE 802.11-&gt;</li>
<li>"Enable Decryption" must be set</li>
<li>"Decryption Keys" must be set</li>
<li>Not sure if Ignore Protection bit needs to be set (I have it set)</li>
<li>the EAPOL packets must have been captured for the device connection some time in the wireshark session</li>
</ul>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/52392/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>10 May '16, 06:49</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/796d353373746c193c6e5c1ca1655320?s=32&amp;d=identicon&amp;r=g" alt="mw-ed's gravatar image" />
    <p><a href="/users/24084/mw-ed">mw-ed</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="3 badges"><span class="silver">&#9679;</span><span class="badgecount">3</span></span><span title="5 badges"><span class="bronze">&#9679;</span><span class="badgecount">5</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="mw-ed has one accepted answer">100&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-52392">
    
</div>
<div id="comment-tools-52392" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-52392-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/52286/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='upzmDKskgbmverdHvlhyGzv51vYs8wlV' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/52286/unable-to-capture-unicast-packets-in-monitor-mode-on-wireshark?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/52286/unable-to-capture-unicast-packets-in-monitor-mode-on-wireshark?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/wireshark/"
            class="tag-link-wireshark"
            title="see questions tagged'wireshark'using tags"
            rel="tag">wireshark</a> <span class="tag-number">&#215;1,620</span><br/>
        
        <a href="/tags/802.11/"
            class="tag-link-802.11"
            title="see questions tagged'802.11'using tags"
            rel="tag">802.11</a> <span class="tag-number">&#215;114</span><br/>
        
        <a href="/tags/wlan/"
            class="tag-link-wlan"
            title="see questions tagged'wlan'using tags"
            rel="tag">wlan</a> <span class="tag-number">&#215;76</span><br/>
        
        <a href="/tags/monitor-mode/"
            class="tag-link-monitor-mode"
            title="see questions tagged'monitor-mode'using tags"
            rel="tag">monitor-mode</a> <span class="tag-number">&#215;36</span><br/>
        
    </p>
    <p>
        question asked: <strong title="May 6, 2016, 2:23 p.m.">06 May '16, 14:23</strong>
    </p>
    <p> 
     	question was seen: <strong>4,172 times</strong>
    </p>
    <p> 
        last updated: <strong title="June 29, 2016, 3:45 p.m.">29 Jun '16, 15:45</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/34620/wireshark-on-mac-stuck-in-monitor-mode-only-capturing-80211-headers">Wireshark (on Mac) stuck in monitor mode only capturing 802.11 headers</a>
        </p>
        
        <p>
            <a href="/questions/38741/decrypt-only-outgoing-packets-promiscuous-mode">Decrypt only outgoing packets - promiscuous mode.</a>
        </p>
        
        <p>
            <a href="/questions/41030/python-pcapng-cannot-understand-80211-data-frame-format-in-pcapng-file">python-pcapng: cannot understand 802.11 Data Frame format in PcapNG file</a>
        </p>
        
        <p>
            <a href="/questions/13982/80211-decryption-not-working-properly">802.11 decryption not working properly</a>
        </p>
        
        <p>
            <a href="/questions/55145/kali-linuxwiresharkmonitor-mode-and-others">Kali Linux,Wireshark,Monitor mode and others...</a>
        </p>
        
        <p>
            <a href="/questions/29592/decrypting-a-80211-packets-on-wpa2-psk">Decrypting a 802.11 packets on WPA2-PSK</a>
        </p>
        
        <p>
            <a href="/questions/60179/cannot-capture-80211-data-frames">Cannot capture 802.11 data frames</a>
        </p>
        
        <p>
            <a href="/questions/18023/how-can-i-capture-non-data-packets-beacon-associate-etc-on-os-x">How can I capture non-data packets (Beacon, Associate, etc.) on OS X?</a>
        </p>
        
        <p>
            <a href="/questions/49288/problems-with-capturing-other-device-wlan-traffic">Problems with capturing other device WLAN traffic</a>
        </p>
        
        <p>
            <a href="/questions/42897/how-do-i-turn-on-monitor-mode-in-mac-os-x-with-wireshark-v199">How do I turn on monitor mode in Mac OS X with Wireshark v1.99?</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
