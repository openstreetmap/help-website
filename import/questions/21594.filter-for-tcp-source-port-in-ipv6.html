<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Filter for TCP source port in IPv6 - Wireshark Q&amp;A</title>
        <meta name="description" content="Hello,  I&#39;m trying to create a capture filter for my TCP packets. I want to filter for packets with a specific source port, lets say port 1.  My filter is &quot;tcp src port 1&quot;, and I also tried &quot;tcp and src port 1&quot;.  However, this works perfectly when I use IPv4. But when I use IPv6, it doesn&#39;t. I don&#39;t..." />
        <meta name="keywords" content="source,port,libpcap,ipv6" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/21594/filter-for-tcp-source-port-in-ipv6" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/21594/filter-for-tcp-source-port-in-ipv6?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='S57jtZSLlLlQ0Rdhjz2LP1V1pij9ZYTq' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/21594/filter-for-tcp-source-port-in-ipv6">Filter for TCP source port in IPv6</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-21594-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/21594/up/" rel="nofollow"> </a>
<div id="post-21594-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-21594-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/21594/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/21594/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hello, </p>
<p>I'm trying to create a capture filter for my TCP packets. I want to filter for packets with a specific source port, lets say port 1. </p>
<p>My filter is "tcp src port 1", and I also tried "tcp and src port 1". </p>
<p>However, this works perfectly when I use IPv4. But when I use IPv6, it doesn't. I don't capture any packets, although the TCP header is exactly the same, I just exchanged the IP-layer. 
When I filter for "tcp port 1" or "tcp and port 1", I get all packets which have 1 as destination port, but none of the packets which have 1 as source port. </p>
<p>Could this be a bug in the pcap library? The fact that it fully works with IPv4, but only with the destination port in IPv6 and not with the source port makes me think that way.... </p>
<p>Oh yeah, also, when I try to make a display filter, everything works if I set it for example to "tcp.srcport==1", in both IPv4 and IPv6. </p>
<p>I'm running libpcap0.8 version 1.4.0-1, my wireshark version is 1.8.7-1. </p>
<p>Thanks for your help! </p>
<p>Regards,
Moe</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/source/" class="post-tag tag-link-source"
                                        title="see questions tagged 'source'" rel="tag">source</a>
                                
                                    <a href="/tags/port/" class="post-tag tag-link-port"
                                        title="see questions tagged 'port'" rel="tag">port</a>
                                
                                    <a href="/tags/libpcap/" class="post-tag tag-link-libpcap"
                                        title="see questions tagged 'libpcap'" rel="tag">libpcap</a>
                                
                                    <a href="/tags/ipv6/" class="post-tag tag-link-ipv6"
                                        title="see questions tagged 'ipv6'" rel="tag">ipv6</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>30 May '13, 05:57</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/6c33bb9edee5bd585393bbd6a8b83b26?s=32&amp;d=identicon&amp;r=g" alt="moe's gravatar image" />
    <p><a href="/users/5038/moe">moe</a><br/>
    <span class="score" title="16 reputation points">16</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="5 badges"><span class="bronze">&#9679;</span><span class="badgecount">5</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="moe has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-21594">
    
        <a name="21598"></a>
        <div class="comment" id="comment-21598">
            <div id="post-21598-score" class="comment-score"></div>
            <div class="comment-text"><p>Just changed the virtual network card, did not make a difference</p></div>
            <div class="comment-info" id="comment-21598-info">
                
                
                
                

                

                <span class="comment-age">(30 May '13, 07:05)</span>
                <a class="comment-user userinfo" href="/users/5038/moe">moe</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-21594" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-21594-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/21594/filter-for-tcp-source-port-in-ipv6?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/21594/filter-for-tcp-source-port-in-ipv6?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/21594/filter-for-tcp-source-port-in-ipv6?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/21594/filter-for-tcp-source-port-in-ipv6?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="21595"></a>
                    <div id="answer-container-21595" class="answer accepted-answer">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-21595-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/21595/up/" rel="nofollow"> </a>
<div id="post-21595-score" class="post-score"
    title="current number of votes">
    3
</div>
<a id="post-21595-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/21595/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="moe has selected this answer as the correct answer"
        href="/accept_answer/21595/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Works for me (libpcap version 1.3.0 on OSX):</p>
<pre><code>$ tshark -i en1 "tcp src port 80"
Capturing on en1
  0.000000 2001:898:2000:1::244 -&gt; 2001:980:5354:3:fa1e:dfff:fed8:8748 TCP 94 http &gt; 53101 [SYN, ACK] Seq=0 Ack=1 Win=5712 Len=0 MSS=1440 SACK_PERM=1 TSval=1714395974 TSecr=394066808 WS=128
  0.027056 2001:898:2000:1::244 -&gt; 2001:980:5354:3:fa1e:dfff:fed8:8748 TCP 86 http &gt; 53101 [ACK] Seq=1 Ack=784 Win=7296 Len=0 TSval=1714396004 TSecr=394066809
  0.046179 2001:898:2000:1::244 -&gt; 2001:980:5354:3:fa1e:dfff:fed8:8748 TCP 1410 [TCP segment of a reassembled PDU]
  0.051261 2001:898:2000:1::244 -&gt; 2001:980:5354:3:fa1e:dfff:fed8:8748 HTTP 91 HTTP/1.1 200 OK  (text/html)
</code></pre>
<p>Could you show the output of "compile BPF filter" (or run 'tcpdump -d "&lt;filter&gt;"' on the CLI). It should show something like this:</p>
<pre><code>(000) ldh      [12]
(001) jeq      #0x86dd          jt 2    jf 6
(002) ldb      [20]
(003) jeq      #0x6             jt 4    jf 15
(004) ldh      [54]
(005) jeq      #0x50            jt 14   jf 15
(006) jeq      #0x800           jt 7    jf 15
(007) ldb      [23]
(008) jeq      #0x6             jt 9    jf 15
(009) ldh      [20]
(010) jset     #0x1fff          jt 15   jf 11
(011) ldxb     4*([14]&amp;0xf)
(012) ldh      [x + 14]
(013) jeq      #0x50            jt 14   jf 15
(014) ret      #65535
(015) ret      #0
</code></pre>
<p>Maybe there is a bug in your version of libpcap indeed. Also, are you sure your frames are not vlan tagged (or encapsulated in pppoe or something else)?</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/21595/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>30 May '13, 06:27</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7901a94d8fdd1f9f47cda9a32fcfa177?s=32&amp;d=identicon&amp;r=g" alt="SYN-bit's gravatar image" />
    <p><a href="/users/5/syn-bit">SYN-bit ♦♦</a><br/>
    <span class="score" title="17094 reputation points"><span class="">17.1k</span></span><span title="9 badges"><span class="badge1">&#9679;</span><span class="badgecount">9</span></span><span title="57 badges"><span class="silver">&#9679;</span><span class="badgecount">57</span></span><span title="245 badges"><span class="bronze">&#9679;</span><span class="badgecount">245</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="SYN-bit has 174 accepted answers">20&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-21595">
    
        <a name="21596"></a>
        <div class="comment" id="comment-21596">
            <div id="post-21596-score" class="comment-score"></div>
            <div class="comment-text"><p>Thats my output from "compile BF filter":</p>

<pre><code>(000) ldh      [12]
(001) jeq      #0x86dd          jt 2    jf 6
(002) ldb      [20]
(003) jeq      #0x6             jt 4    jf 15
(004) ldh      [54]
(005) jeq      #0x1             jt 14   jf 15
(006) jeq      #0x800           jt 7    jf 15
(007) ldb      [23]
(008) jeq      #0x6             jt 9    jf 15
(009) ldh      [20]
(010) jset     #0x1fff          jt 15   jf 11
(011) ldxb     4*([14]&amp;0xf)
(012) ldh      [x + 14]
(013) jeq      #0x1             jt 14   jf 15
(014) ret      #65535
(015) ret      #0
</code></pre>

<p>Its the same output as you have, except that I specified port 1 in line 6. </p>

<p>The communication I'm capturing is between two Virtual machines on the same physical PC. Wireshark runs on one of the virtual machines. 
So, yes, I'm sure that there's no VLAN or other things. </p>

<p>Here is (part of) the output of tshark when I do not filter for ports: </p>

<pre><code>$ sudo tshark -i eth0 "tcp"
Capturing on eth0
  0.000000          ::a -&gt; ::c          TCP 54425 &gt; tcpmux [SYN, ACK] Seq=500048637 Ack=3996483048 Win=1024 Len=0 MSS=1460
  0.000253          ::c -&gt; ::a          TCP tcpmux &gt; 54425 [RST] Seq=3996483048 Win=0 Len=0
</code></pre>

<p>Now with the filter applied: </p>

<pre><code>$ sudo tshark -i eth0 "tcp port 1"
Capturing on eth0
  0.000000          ::a -&gt; ::c          TCP 35982 &gt; tcpmux [SYN, ACK] Seq=4190420215 Ack=4138811225 Win=1024 Len=0 MSS=1460
</code></pre>

<p>The RST packet does not appear. </p>

<p>Any clues how to debug this further? I will try to change the virtual network cards of the machines, maybe this helps... 
I also already tried a different libpcap version (1.3.0-1), but that also did not help. </p></div>
            <div class="comment-info" id="comment-21596-info">
                
                
                
                

                

                <span class="comment-age">(30 May '13, 06:50)</span>
                <a class="comment-user userinfo" href="/users/5038/moe">moe</a>
                
            </div>
        </div>
    
        <a name="21597"></a>
        <div class="comment" id="comment-21597">
            <div id="post-21597-score" class="comment-score"></div>
            <div class="comment-text"><p>Are you able to share the capture files on www.cloudshark.org? One taken with just "tcp" as filter and the other one taken with "tcp port 1" as filter (preferably made at the same time)?</p></div>
            <div class="comment-info" id="comment-21597-info">
                
                
                
                

                

                <span class="comment-age">(30 May '13, 07:04)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="21601"></a>
        <div class="comment" id="comment-21601">
            <div id="post-21601-score" class="comment-score"></div>
            <div class="comment-text"><p>here you go!
the first pcap with the filter "tcp": <a href="http://cloudshark.org/captures/7c257d3b1532">http://cloudshark.org/captures/7c257d3b1532</a></p>

<p>the second pcap with the filter "tcp port 1": <a href="http://cloudshark.org/captures/5c6adae06fa1">http://cloudshark.org/captures/5c6adae06fa1</a></p>

<p>both taken at the same time</p></div>
            <div class="comment-info" id="comment-21601-info">
                
                
                
                

                

                <span class="comment-age">(30 May '13, 07:21)</span>
                <a class="comment-user userinfo" href="/users/5038/moe">moe</a>
                
            </div>
        </div>
    
        <a name="21602"></a>
        <div class="comment" id="comment-21602">
            <div id="post-21602-score" class="comment-score"></div>
            <div class="comment-text"><p>The return traffic is having an IPv6 fragmentation header. This changes the offset of the TCP within the packet. Since there are no loops allowed in BPF filtering, it is not possible for BPF to dynamically hop over all the possible IPv6 headers to adjust the offset for the tcp header.</p>

<p>The strange part is that when using only "tcp" as filter, the fragmentation header is accounted for (see line 4 of the BPF code):</p>

<pre><code>$ tcpdump -d "tcp"
(000) ldh      [12]
(001) jeq      #0x86dd          jt 2    jf 7
(002) ldb      [20]
(003) jeq      #0x6             jt 10   jf 4
(004) jeq      #0x2c            jt 5    jf 11
(005) ldb      [54]
(006) jeq      #0x6             jt 10   jf 11
(007) jeq      #0x800           jt 8    jf 11
(008) ldb      [23]
(009) jeq      #0x6             jt 10   jf 11
(010) ret      #65535
(011) ret      #0
$
</code></pre>

<p>This might be considered a bug in libpcap or if looked at differently, it would be an enhancement request in libpcap :-)</p></div>
            <div class="comment-info" id="comment-21602-info">
                
                
                
                

                

                <span class="comment-age">(30 May '13, 07:41)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="21603"></a>
        <div class="comment" id="comment-21603">
            <div id="post-21603-score" class="comment-score"></div>
            <div class="comment-text"><p>As for now, you can manually do the skipping of the extra header as follows:</p>

<pre><code>$ tcpdump -nnlr tcp.pcap "(ip6[6]=6 and ip6[40:2]=1) or (ip6[6]=44 and ip6[40]=6 and ip6[48:2]=1)"
reading from file tcp.pcap, link-type EN10MB (Ethernet)
16:14:23.515746 IP6 ::0.0.0.12 &gt; ::0.0.0.10: frag (0|20) 1 &gt; 63034: Flags [R], seq 1099986487, win 0, length 0
16:14:23.547560 IP6 ::0.0.0.12 &gt; ::0.0.0.10: frag (0|20) 1 &gt; 63035: Flags [R], seq 1099986487, win 0, length 0
16:14:23.579576 IP6 ::0.0.0.12 &gt; ::0.0.0.10: frag (0|20) 1 &gt; 63036: Flags [R], seq 1099986487, win 0, length 0
16:14:23.611582 IP6 ::0.0.0.12 &gt; ::0.0.0.10: frag (0|20) 1 &gt; 63037: Flags [R], seq 1099986487, win 0, length 0
16:14:23.644003 IP6 ::0.0.0.12 &gt; ::0.0.0.10: frag (0|20) 1 &gt; 63038: Flags [R], seq 1099986487, win 0, length 0
16:14:23.676372 IP6 ::0.0.0.12 &gt; ::0.0.0.10: frag (0|20) 1 &gt; 63039: Flags [R], seq 1099986487, win 0, length 0
$
</code></pre></div>
            <div class="comment-info" id="comment-21603-info">
                
                
                
                

                

                <span class="comment-age">(30 May '13, 07:50)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="21608"></a>
        <div class="comment not_top_scorer" id="comment-21608">
            <div id="post-21608-score" class="comment-score"></div>
            <div class="comment-text"><p>You are the man! I would have never found that issue on my own! </p>

<p>I guess changing this in libpcap would be desirable, especially because there might be also extension headers before the fragmentation header. </p>

<p>Thanks! If I managed to get my code published in Nmap, I will give you the credits for this one :)</p></div>
            <div class="comment-info" id="comment-21608-info">
                
                
                
                

                

                <span class="comment-age">(30 May '13, 09:05)</span>
                <a class="comment-user userinfo" href="/users/5038/moe">moe</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-21595" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 6
        </span>
        <a href="#" class="show-all-comments-link">show 1 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-21595-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/21594/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='S57jtZSLlLlQ0Rdhjz2LP1V1pij9ZYTq' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/21594/filter-for-tcp-source-port-in-ipv6?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/21594/filter-for-tcp-source-port-in-ipv6?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/port/"
            class="tag-link-port"
            title="see questions tagged'port'using tags"
            rel="tag">port</a> <span class="tag-number">&#215;69</span><br/>
        
        <a href="/tags/ipv6/"
            class="tag-link-ipv6"
            title="see questions tagged'ipv6'using tags"
            rel="tag">ipv6</a> <span class="tag-number">&#215;51</span><br/>
        
        <a href="/tags/source/"
            class="tag-link-source"
            title="see questions tagged'source'using tags"
            rel="tag">source</a> <span class="tag-number">&#215;40</span><br/>
        
        <a href="/tags/libpcap/"
            class="tag-link-libpcap"
            title="see questions tagged'libpcap'using tags"
            rel="tag">libpcap</a> <span class="tag-number">&#215;37</span><br/>
        
    </p>
    <p>
        question asked: <strong title="May 30, 2013, 5:57 a.m.">30 May '13, 05:57</strong>
    </p>
    <p> 
     	question was seen: <strong>4,411 times</strong>
    </p>
    <p> 
        last updated: <strong title="May 30, 2013, 9:05 a.m.">30 May '13, 09:05</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/53335/how-to-add-ip-and-port-source-and-ip-port-destination-for-filter">how to add ip and port source and ip port destination for filter?</a>
        </p>
        
        <p>
            <a href="/questions/61492/change-alias-in-src-dest-port-to-actual-port-number">Change alias in src / dest port to actual port number</a>
        </p>
        
        <p>
            <a href="/questions/12/how-do-you-filter-different-types-of-icmpv6-messages">How do you filter different types of ICMPv6 messages?</a>
        </p>
        
        <p>
            <a href="/questions/14908/freenet6-wireshark-trace">Freenet6 Wireshark Trace</a>
        </p>
        
        <p>
            <a href="/questions/37660/wireshark-converting-ipv4-to-ipv6">Wireshark converting IPv4 to IPv6</a>
        </p>
        
        <p>
            <a href="/questions/60860/how-to-view-raw-proto-41-packets-as-ipv4-packets">How to view raw proto 41 packets as IPv4 packets</a>
        </p>
        
        <p>
            <a href="/questions/10823/program-running-on-some-machine-and-some-not-wireshark-report">program running on some machine and some not wireshark report</a>
        </p>
        
        <p>
            <a href="/questions/22644/so-how-do-you-work-out-the-switch-port-your-on">So how do you work out the switch port your on?</a>
        </p>
        
        <p>
            <a href="/questions/34801/how-can-i-identify-a-ddosdos-attack-with-wireshark">How can I identify a DDoS/DoS attack with wireshark</a>
        </p>
        
        <p>
            <a href="/questions/52443/destport-and-payload">destport and payload</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
