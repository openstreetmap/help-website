<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Nexus, microsoft loadbalancer and wireshark - Wireshark Q&amp;A</title>
        <meta name="description" content="Hello, I&#39;m dealing with the following situation: I have 2 servers running window 2012 R2 and 1 server running windows 2008 R2. I need to build a Microsoff Network LoadBalancer Cluster using the 3 servers; servers are connected to a cisco Nexus Switch; servers are using Intel as well as Broadcom Nic ..." />
        <meta name="keywords" content="nexus" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/43552/nexus-microsoft-loadbalancer-and-wireshark" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/43552/nexus-microsoft-loadbalancer-and-wireshark?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='o7jsDfRGZ7Cmk9a0mvUrFe9gucm50XAr' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/43552/nexus-microsoft-loadbalancer-and-wireshark">Nexus, microsoft loadbalancer and wireshark</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-43552-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/43552/up/" rel="nofollow"> </a>
<div id="post-43552-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-43552-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/43552/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/43552/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   1
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hello,</p>
<p>I'm dealing with the following situation: I have 2 servers running window 2012 R2 and 1 server running windows 2008 R2. I need to build a Microsoff Network LoadBalancer Cluster using the 3 servers; servers are connected to a cisco Nexus Switch; servers are using Intel as well as Broadcom Nic cards. The servers are in the same subnet and the Network LoadBalancer VIP of the newly formed cluster is also in the same subnet. As long as wireshark is running on the servers the cluster is working (setting the nic interfaces to promiscuous mode) - members are detecting / seeing each other and passing each other the Primary / Master role when configured via the Network Load Balancer UI. How can this be possible ? Another strange thing: if I take one of the member offline from the cluster and run a wireshark capture, I can see the Microsoft Network Load Balancer hearthbeat broadcast messages being received from that host; nevertheless, as soon as I add the host again in the cluster, and I restart Wireshark, then the Network Load balancer cluster is working but in the Wireshark capture I don't see any Network Load Balancer hearthbeat messages received any longer .... Moreover, each time I take any host offline from the Network Load Balancer cluster or add it to the Network Load Balancer cluster, wireshark stops the formerly ongoing capture and displays a notification message stating that the ongoing capture cannot continue as the NIC formerly in use is no longer available ....</p>
<p>I'm kind of puzzled ....</p>
<p>Thank for any help.</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/nexus/" class="post-tag tag-link-nexus"
                                        title="see questions tagged 'nexus'" rel="tag">nexus</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>25 Jun '15, 10:25</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/182850fefc90d1555ab682b3d6007bb1?s=32&amp;d=identicon&amp;r=g" alt="Carlo's gravatar image" />
    <p><a href="/users/18043/carlo">Carlo</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="bronze">&#9679;</span><span class="badgecount">2</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Carlo has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-43552">
    
        <a name="43553"></a>
        <div class="comment" id="comment-43553">
            <div id="post-43553-score" class="comment-score"></div>
            <div class="comment-text"><p>In which mode have you configuredthe nlb (unicast, multicast or igmp)?</p></div>
            <div class="comment-info" id="comment-43553-info">
                
                
                
                

                

                <span class="comment-age">(25 Jun '15, 10:40)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
        <a name="43555"></a>
        <div class="comment" id="comment-43555">
            <div id="post-43555-score" class="comment-score"></div>
            <div class="comment-text"><p>Thank you for your feedback.
The NLB is operating in Multicast mode - the nexus has been configured to operate in IGMP multicast mode
Unfortunately I don't have access to the nexus config to post it here ....
Nevertheless, I'm puzzled by the fact that, in one scenario (server not part of the NLB cluster / group), running wireshark on the server I can see the hearthbeat messages .... as soon as I add the server to the NLB group, cluster intra-connectivity will not work until I start wireshark on the newly added server (setting in this way the NIC to promiscuous mode) ... nevertheless the wireshark capture now running on the newly added server doesn't show any hearthbear packets any longer ...</p></div>
            <div class="comment-info" id="comment-43555-info">
                
                
                
                

                

                <span class="comment-age">(25 Jun '15, 10:45)</span>
                <a class="comment-user userinfo" href="/users/18043/carlo">Carlo</a>
                
            </div>
        </div>
    
        <a name="43556"></a>
        <div class="comment" id="comment-43556">
            <div id="post-43556-score" class="comment-score"></div>
            <div class="comment-text"><p>ok the nlb in this mode uses normal ip adress with multicast ip. it could be that you need a static arp entry on the router.  Depends a little bit at your router. Some router discards these frames without static arp entry.</p></div>
            <div class="comment-info" id="comment-43556-info">
                
                
                
                

                

                <span class="comment-age">(25 Jun '15, 10:54)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
        <a name="43557"></a>
        <div class="comment" id="comment-43557">
            <div id="post-43557-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi Christian_R,</p>

<p>absolutely. But the overall cluster is working flawlessly as long as I run wireshark on each member and perform a live capture ... that is, as long as the NICs are in promiscuous mode .... I can't understand why this might happen.</p>

<p>Moreover, I can't understand why in one case (host NOT in the MNLB cluster) I see the hearthbeat and in the other case (host part of the MNLB cluster) I don't ...</p></div>
            <div class="comment-info" id="comment-43557-info">
                
                
                
                

                

                <span class="comment-age">(25 Jun '15, 10:58)</span>
                <a class="comment-user userinfo" href="/users/18043/carlo">Carlo</a>
                
            </div>
        </div>
    
        <a name="43559"></a>
        <div class="comment" id="comment-43559">
            <div id="post-43559-score" class="comment-score"></div>
            <div class="comment-text"><p>you are right at the moment I can't understand this all, too. And for that kind of readon I just want more information. So for backkround I have asked my question. And I am still interested at the answer.</p>

<p>And are your server physical or virzualized?</p></div>
            <div class="comment-info" id="comment-43559-info">
                
                
                
                

                

                <span class="comment-age">(25 Jun '15, 11:32)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
        <a name="43560"></a>
        <div class="comment not_top_scorer" id="comment-43560">
            <div id="post-43560-score" class="comment-score"></div>
            <div class="comment-text"><p>the servers are Dell PowerEdge. they are all running windows os. 2 of them are on win2012R2, the 3rd one is on win2008R2</p></div>
            <div class="comment-info" id="comment-43560-info">
                
                
                
                

                

                <span class="comment-age">(25 Jun '15, 11:42)</span>
                <a class="comment-user userinfo" href="/users/18043/carlo">Carlo</a>
                
            </div>
        </div>
    
        <a name="43561"></a>
        <div class="comment not_top_scorer" id="comment-43561">
            <div id="post-43561-score" class="comment-score"></div>
            <div class="comment-text"><p>O.K. You were talking that you have different nic types.
How many nics has each server. And how are they connected to the network? (One or more switches, port channel???)</p>

<p>And what kind of series of the Nexus do you use?</p>

<p>And a output of the "dumpcap -D -M" command at the servers could be also useful. (with enabled nlb)</p></div>
            <div class="comment-info" id="comment-43561-info">
                
                
                
                

                

                <span class="comment-age">(25 Jun '15, 12:09)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-43552" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 7
        </span>
        <a href="#" class="show-all-comments-link">show 2 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-43552-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
        <form id="fmanswer" action="/questions/43552/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='o7jsDfRGZ7Cmk9a0mvUrFe9gucm50XAr' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Be the first one to answer this question!
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/43552/nexus-microsoft-loadbalancer-and-wireshark?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/43552/nexus-microsoft-loadbalancer-and-wireshark?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/nexus/"
            class="tag-link-nexus"
            title="see questions tagged'nexus'using tags"
            rel="tag">nexus</a> <span class="tag-number">&#215;5</span><br/>
        
    </p>
    <p>
        question asked: <strong title="June 25, 2015, 10:25 a.m.">25 Jun '15, 10:25</strong>
    </p>
    <p> 
     	question was seen: <strong>1,198 times</strong>
    </p>
    <p> 
        last updated: <strong title="June 25, 2015, 12:09 p.m.">25 Jun '15, 12:09</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/3783/wireshark-supporting-nexus-protocol-analyzer">wireshark supporting NEXUS protocol analyzer?</a>
        </p>
        
        <p>
            <a href="/questions/14582/how-to-identify-the-cause-of-network-flooding-using-wireshark">How to identify the cause of network flooding using wireshark?</a>
        </p>
        
        <p>
            <a href="/questions/48575/wireshark-interpret-pcap-file">Wireshark interpret pcap file</a>
        </p>
        
        <p>
            <a href="/questions/53402/dissector-for-cisco-timetag">Dissector for Cisco TimeTag</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
