<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Capturing from multiple pipes - Wireshark Q&amp;A</title>
        <meta name="description" content="In our environment we do a lot of live traces on specific interface on a Linux server, and pipes the result back to our Windows PC where it is presented in wireshark. We use PLINK to open a SSH connection to the server and have the stream piped back: plink.exe -ssh -pw somepassword root@someserver t..." />
        <meta name="keywords" content="pipe,multiple" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/13059/capturing-from-multiple-pipes" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/13059/capturing-from-multiple-pipes?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='ojCGdPByXDkXhm5caxo91fbfF2bsxc4W' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/13059/capturing-from-multiple-pipes">Capturing from multiple pipes</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-13059-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/13059/up/" rel="nofollow"> </a>
<div id="post-13059-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-13059-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/13059/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/13059/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>In our environment we do a lot of live traces on specific interface on a Linux server, and pipes the result back to our Windows PC where it is presented in wireshark. We use PLINK to open a SSH connection to the server and have the stream piped back:</p>
<p>plink.exe -ssh -pw somepassword <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="42302d2d3602312d2f27312730342730">[email&#160;protected]</a> tcpdump -i eth4 -s 0 -w - | "C:\Program Files\Wireshark\Wireshark.exe" -k -i -</p>
<p>This works just fine, but now we need to traces simultanously on two different Linux servers and have the two streams merged into one and presented in Wireshark. </p>
<p>Does anyone know if that's possible or have a hint on what to try?</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/pipe/" class="post-tag tag-link-pipe"
                                        title="see questions tagged 'pipe'" rel="tag">pipe</a>
                                
                                    <a href="/tags/multiple/" class="post-tag tag-link-multiple"
                                        title="see questions tagged 'multiple'" rel="tag">multiple</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>27 Jul '12, 00:52</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/a51e5eea71f2707eb30483c5b5bf2714?s=32&amp;d=identicon&amp;r=g" alt="sblar's gravatar image" />
    <p><a href="/users/3150/sblar">sblar</a><br/>
    <span class="score" title="16 reputation points">16</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">&#9679;</span><span class="badgecount">4</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="sblar has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-13059">
    
</div>
<div id="comment-tools-13059" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-13059-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/13059/capturing-from-multiple-pipes?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/13059/capturing-from-multiple-pipes?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/13059/capturing-from-multiple-pipes?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/13059/capturing-from-multiple-pipes?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="13070"></a>
                    <div id="answer-container-13070" class="answer accepted-answer">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-13070-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/13070/up/" rel="nofollow"> </a>
<div id="post-13070-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-13070-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/13070/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="sblar has selected this answer as the correct answer"
        href="/accept_answer/13070/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>you can't just merge several streams, as that's binary data in libpcap format. What you need is this:</p>
<ul>
<li>write the output every ssh connection to a named pipe (possible with linux and windows)</li>
<li>Create a tool that reads from all named pipes and parses the pcap files. Then the tool would output the frames one by one. Either to another named pipe or to STDOUT.</li>
<li>Wireshark reads from the named pipe or from STDIN (as you do now)</li>
</ul>
<p><strong>Windows:</strong></p>
<ul>
<li>run several plink commands and write the output to <code>\\.\pipe\linuxhost1</code>, <code>\\.\pipe\linuxhost2</code>, <code>\\.\pipe\linuxhost3</code>, etc.</li>
<li>Use a python/perl script to read from those pipes and let it write to another pipe (<code>\\.\pipe\linuxhostall</code>) or to STDOUT. Sample script: <code><a href="http://wiki.wireshark.org/CaptureSetup/Pipes">http://wiki.wireshark.org/CaptureSetup/Pipes</a></code> - Way 3: Python</li>
<li>Let Wireshark read from <code>\\.\pipe\linuxhostall</code> or STDIN</li>
</ul>
<p><strong>Linux:</strong></p>
<ul>
<li>run just one plink command to a Linux system and run a shell script within that ssh connection</li>
<li>the shell script creates the named pipes (mkfifo - see link above) and starts several ssh connections to other linux hosts (similar to your plink commands). The output of every ssh connection goes to one of the named pipes. You MUST suppress any output to STDOUT (see below) !!</li>
<li>then start a script (perl/python - see example in the link above, or google one) that reads from all named pipes, parses the pcap files and writes the frames one by one to STDOUT</li>
<li>STDOUT will be piped to Wireshark (as your script runs in the plink session)</li>
</ul>
<p><strong>UPDATE</strong>:</p>
<p><a href="http://www.winpcap.org/docs/docs_41b5/html/group__remote.html#UNIX">rpcapd for Linux (WinPcap)</a>, together with the multiple interface capture capability of Wireshark 1.8, could be an alternative for the scripting solution.</p>
<p>Try to compile and run rpcapd on your linux systems. Then use dumpcap with multiple -i statements to capture from both/all systems. </p>
<blockquote>
<p><code><a href="http://ask.wireshark.org/questions/13012/remote-packet-capturing-from-command-prompt">http://ask.wireshark.org/questions/13012/remote-packet-capturing-from-command-prompt</a></code><br>
</p>
</blockquote>
<p>You can write the output of dumpcap to STDOUT by using <strong><code>-w -</code></strong>  as last parameter.</p>
<blockquote>
<p><code>dumpcap -n -i rpcap://[10.0.0.1]/eth0 -i  rpcap://[10.0.0.2]/eth1 -w - | wireshark -k -i -</code><br>
</p>
</blockquote>
<p>I have not tested, but it should work. Or run wireshark with -i directly (not tested either)</p>
<blockquote>
<p><code>wireshark -k -n -i rpcap://[10.0.0.1]/eth0 -i  rpcap://[10.0.0.2]/eth1</code><br>
</p>
</blockquote>
<p><strong>Other Alternatives:</strong></p>
<p>You could also use <a href="http://rpcap.sourceforge.net/">rpcap for linux</a>. With that you don't need the named pipes on linux. Just one tool that connects to several linux hosts, gets the captured data and writes the frames of all hosts to STDOUT. However, using rpcap requires some programming skills.</p>
<p>Regards<br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/13070/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>27 Jul '12, 03:01</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/13070/">
                edited
                <strong>29 Jul '12, 02:06</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-13070">
    
        <a name="13085"></a>
        <div class="comment" id="comment-13085">
            <div id="post-13085-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks Kurt.
I got the picture and understand the general idea, but I have no clue on how to write a tool that reads from all pipes and parse the pcap stream so that each frame will come out one by one. Can anyone enlighten me?</p>

<p>Also, I forgot to mention that the resulting trace must contain all frames in cronological order, but maybe that's not an issue at all? </p></div>
            <div class="comment-info" id="comment-13085-info">
                
                
                
                

                

                <span class="comment-age">(28 Jul '12, 02:04)</span>
                <a class="comment-user userinfo" href="/users/3150/sblar">sblar</a>
                
            </div>
        </div>
    
        <a name="13086"></a>
        <div class="comment" id="comment-13086">
            <div id="post-13086-score" class="comment-score"></div>
            <div class="comment-text"><p>without programming knowledge, it's rather hard to acomplish. You can start with the sample script (link above).</p>

<blockquote>
<p>Also, I forgot to mention that the resulting trace must contain all frames in cronological order, but maybe that's not an issue at all? </p>
</blockquote>

<p>That's even harder to do, as you need to buffer the frames from all machines and then write them in the right (chronological order).</p>

<p>BTW: Why do you need a "live" stream? Can't you just write the captured data on all linux machines to a file and then use <strong><code>mergecap</code></strong> to merge those files into one (chronological order is possible)?</p></div>
            <div class="comment-info" id="comment-13086-info">
                
                
                
                

                

                <span class="comment-age">(28 Jul '12, 02:47)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="13089"></a>
        <div class="comment" id="comment-13089">
            <div id="post-13089-score" class="comment-score"></div>
            <div class="comment-text"><p>see my UPDATE in the answer.</p></div>
            <div class="comment-info" id="comment-13089-info">
                
                
                
                

                

                <span class="comment-age">(28 Jul '12, 03:19)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="13091"></a>
        <div class="comment" id="comment-13091">
            <div id="post-13091-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks againg Kurt, I will look into your suggestions in detail. I'm a little confused though since I can't separate the alternatives from each other; 
can rpcap for Linux fulfill my needs without programming?
After your suggestion to use WinPcap on Linux, you wrote "Try to compile and run rpcapd on your linux systems". Was that a typo or another alternative?
Does any of your suggestion work (without programming) when I need the correct order of frames?</p>

<p>I could write data from each machine to file and merge them directly in Wireshark (even without mergecap), in fact that's how we are forced to do it in the production environment, but in the lab, live trace is so much nicer because we can change the setup (SIP) and see the result immediately.</p>

<p>BTW: Can Wireshark 1.8.x with it's multiple interface possibility help me in any way?</p></div>
            <div class="comment-info" id="comment-13091-info">
                
                
                
                

                

                <span class="comment-age">(28 Jul '12, 07:16)</span>
                <a class="comment-user userinfo" href="/users/3150/sblar">sblar</a>
                
            </div>
        </div>
    
        <a name="13093"></a>
        <div class="comment" id="comment-13093">
            <div id="post-13093-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>can rpcap for Linux fulfill my needs without programming?</p>
</blockquote>

<p>No.</p>

<blockquote>
<p>Was that a typo or another alternative?</p>
</blockquote>

<p>it's an alternative, that I did not think about when I suggested rpcap. rpcapd (Winpcap) is the better alternative for you and you don't need programming skills.</p>

<blockquote>
<p>Does any of your suggestion work (without programming) when I need the correct order of frames?</p>
</blockquote>

<p>No. Only with mergecap it is possible to merge the capture files in chronoligical order. The other solutions will output the packets as they arrive. However, if the time on the linux machines is synchronized with NTP and there is not much data, the packets will be in chronological order (more or less). </p>

<p>Why is chronological order of two different machines important for you?</p>

<blockquote>
<p>BTW: Can Wireshark 1.8.x with it's multiple interface possibility help me in any way?</p>
</blockquote>

<p>That was my last suggestion in the answer. Use Wireshark with multiple -i options. It's the same as within the GUI.</p></div>
            <div class="comment-info" id="comment-13093-info">
                
                
                
                

                

                <span class="comment-age">(28 Jul '12, 08:05)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="13094"></a>
        <div class="comment not_top_scorer" id="comment-13094">
            <div id="post-13094-score" class="comment-score"></div>
            <div class="comment-text"><p>Ah, now I see. rpcap and rpcapd are two different things. I didn't notice that, for the same reason that I didn't catch your last suggestion: So much (excellent) information :-)</p>

<p>The cronological order is important to see correct sequence for a call (SIP) as it traverses several servers (proxies, user agents, registrars etc.). Some of these servers are located in different networks (even in the lab), hence the need for multiple trace sources. All the servers are synced with NTP and there not too much data, so maybe we are good here...</p>

<p>Anyway, thank you so much for your effort. It looks promising and I will post the result here if I get it to work.</p></div>
            <div class="comment-info" id="comment-13094-info">
                
                
                
                

                

                <span class="comment-age">(28 Jul '12, 13:34)</span>
                <a class="comment-user userinfo" href="/users/3150/sblar">sblar</a>
                
            </div>
        </div>
    
        <a name="13095"></a>
        <div class="comment not_top_scorer" id="comment-13095">
            <div id="post-13095-score" class="comment-score"></div>
            <div class="comment-text"><p>O.K. good luck!</p></div>
            <div class="comment-info" id="comment-13095-info">
                
                
                
                

                

                <span class="comment-age">(28 Jul '12, 14:46)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="20236"></a>
        <div class="comment not_top_scorer" id="comment-20236">
            <div id="post-20236-score" class="comment-score"></div>
            <div class="comment-text"><p>Sorry for this very late update, the solution was put together just a few days ago.</p>

<p>We have compiled rpcapd for linux and put in on two servers which tap on a switch in their local site.</p>

<p>From our workstations we start Wireshark with command line parameters (multiple -i rpcap://&lt;host&gt;/&lt;adapter&gt; -f &lt;capture filter=""&gt;).</p>

<p>This works well and we can now merge the streams from the two sites into one monitor session.
With this approach, compared to what we used to do, we can stop and restart the capture in the same Wireshark session.</p>

<p>Thanks again Kurt for putting me in the right direction.</p></div>
            <div class="comment-info" id="comment-20236-info">
                
                
                
                

                

                <span class="comment-age">(09 Apr '13, 05:36)</span>
                <a class="comment-user userinfo" href="/users/3150/sblar">sblar</a>
                
            </div>
        </div>
    
        <a name="20237"></a>
        <div class="comment not_top_scorer" id="comment-20237">
            <div id="post-20237-score" class="comment-score"></div>
            <div class="comment-text"><p>You're welcome.</p></div>
            <div class="comment-info" id="comment-20237-info">
                
                
                
                

                

                <span class="comment-age">(09 Apr '13, 05:50)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-13070" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 9
        </span>
        <a href="#" class="show-all-comments-link">show 4 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-13070-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="51721"></a>
                    <div id="answer-container-51721" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-51721-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/51721/up/" rel="nofollow"> </a>
<div id="post-51721-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-51721-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/51721/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Seeing as this is actually fairly recent... For what it's worth, I'll leave here my preferred one-liner solution for live remote capture on non-standard ssh ports using Windows' version of wireshark and standard tcpdump on whatever flavor of Linux the remote machine has. It doesn't strictly require you to use a key to authorize, but if you don't, it stops being a one-liner. Also, it isn't hugely efficient in that some of the packets get lost to whatever perils there exist in ssh tunnels... Yet it allows you to benefit from the convenience of Windows Wireshark while utilizing the power of Linux's tcpdump. I experimented with opening remote/local tunnels seeking to capture and display all the packets that came, even if they would be displayed with a delay, and this so far is the most accurate representation. Still, not ALL the packets show up on the capture, compared to a local file tcpdump dump. For various reasons of convenience, I can't/don't want to use named pipes unless they can be incorporated into a one-liner. The quest continues :)</p>
<p>Anyway, using cygwin with standard packages:</p>
<p><code>ssh -i [PATH_TO_PRIVATE_KEY] -p [REMOTEPORT] [REMOTE_USER]@[REMOTE_HOST] "tcpdump -ni [REMOTEINTERFACE] -s 0 -w - not port 22 and not port [REMOTEPORT] | gzip" | gunzip | "[LOCAL_WINDOWS_PATH.EXE]" -k -i -</code></p>
<p>(Unconvinced about gzip|gunzip, but so far my tests show that fewer packets get lost this way, at the cost of speed and latency of course.)</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/51721/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>17 Apr '16, 02:21</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/51db6b4630760142d4116dad2e6b4b79?s=32&amp;d=identicon&amp;r=g" alt="katzurki's gravatar image" />
    <p><a href="/users/23907/katzurki">katzurki</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">&#9679;</span><span class="badgecount">2</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="katzurki has no accepted answers">0&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-51721">
    
</div>
<div id="comment-tools-51721" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-51721-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/13059/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='ojCGdPByXDkXhm5caxo91fbfF2bsxc4W' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/13059/capturing-from-multiple-pipes?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/13059/capturing-from-multiple-pipes?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/multiple/"
            class="tag-link-multiple"
            title="see questions tagged'multiple'using tags"
            rel="tag">multiple</a> <span class="tag-number">&#215;41</span><br/>
        
        <a href="/tags/pipe/"
            class="tag-link-pipe"
            title="see questions tagged'pipe'using tags"
            rel="tag">pipe</a> <span class="tag-number">&#215;37</span><br/>
        
    </p>
    <p>
        question asked: <strong title="July 27, 2012, 12:52 a.m.">27 Jul '12, 00:52</strong>
    </p>
    <p> 
     	question was seen: <strong>10,381 times</strong>
    </p>
    <p> 
        last updated: <strong title="April 17, 2016, 2:21 a.m.">17 Apr '16, 02:21</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/1645/wireshark-freezing-when-restartshow-optionslist-interfaces-after-stop-the-running-live-capture-using-pipe-file-feed-data">Wireshark freezing when restart/show options/List interfaces after stop the running live capture using PIPE file feed data</a>
        </p>
        
        <p>
            <a href="/questions/35047/piping-tshark-output-to-wireshark">Piping tshark output to wireshark</a>
        </p>
        
        <p>
            <a href="/questions/61758/how-to-create-wireshark-plugin-to-handle-duplextwo-way-pipe-on-windows">How to create Wireshark plugin to handle duplex/two-way pipe on Windows?</a>
        </p>
        
        <p>
            <a href="/questions/11857/how-to-use-multiple-lines-for-one-header-field">How to use multiple lines for one header field?</a>
        </p>
        
        <p>
            <a href="/questions/44963/call-capture-over-multiple-files">Call capture over multiple files</a>
        </p>
        
        <p>
            <a href="/questions/1825/wireshark-crash-when-do-some-menu-operation-on-wireshark-using-pipe-file-to-feed-data">Wireshark crash when do some menu operation on Wireshark  using Pipe file to feed data</a>
        </p>
        
        <p>
            <a href="/questions/36396/how-to-create-named-pipe-in-windows-xp-from-which-to-capture">How to create named pipe in windows xp from which to capture</a>
        </p>
        
        <p>
            <a href="/questions/62651/using-google-protobuf-to-export-full-packet-dissection-data-via-named-pipe">Using Google Protobuf to Export Full Packet Dissection Data via Named Pipe</a>
        </p>
        
        <p>
            <a href="/questions/14810/tshark-http-multiple-files">Tshark HTTP multiple files</a>
        </p>
        
        <p>
            <a href="/questions/45872/multiple-arp-request-for-nonexistent-ip-address">Multiple ARP Request for Nonexistent IP Address</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
