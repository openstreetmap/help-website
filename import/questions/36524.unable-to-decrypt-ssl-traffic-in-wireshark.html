<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>unable to decrypt ssl traffic in wireshark - Wireshark Q&amp;A</title>
        <meta name="description" content="seems to be similar problem as the one posted 2 years ago, but starting a new thread per Kurt&#39;s recommendation. https://ask.wireshark.org/questions/12121/unable-to-decrypt-ssl-traffic-in-wireshark-logs?page=1&amp;amp;focusedAnswerId=12122#12122 Here is my Wireshark SSL debug log  ssl_association_remove ..." />
        <meta name="keywords" content="ssl,certificate,decryption" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/36524/unable-to-decrypt-ssl-traffic-in-wireshark" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/36524/unable-to-decrypt-ssl-traffic-in-wireshark?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='PBP8qADOsQNY0vOalJV6XAfE2NDjQgA8' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/36524/unable-to-decrypt-ssl-traffic-in-wireshark">unable to decrypt ssl traffic in wireshark</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-36524-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/36524/up/" rel="nofollow"> </a>
<div id="post-36524-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-36524-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/36524/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/36524/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>seems to be similar problem as the one posted 2 years ago, but starting a new thread per Kurt's recommendation.</p>
<p><a href="https://ask.wireshark.org/questions/12121/unable-to-decrypt-ssl-traffic-in-wireshark-logs?page=1&amp;focusedAnswerId=12122#12122">https://ask.wireshark.org/questions/12121/unable-to-decrypt-ssl-traffic-in-wireshark-logs?page=1&amp;focusedAnswerId=12122#12122</a></p>
<p>Here is my Wireshark SSL debug log </p>
<pre><code>ssl_association_remove removing TCP 443 - ssl handle 00000000041CF020 6553 bytes read 
PKCS#12 imported 
Bag 0/0: PKCS#8 Encrypted key 
Private key imported: KeyID b7:20:ac:00:7b:d3:57:53:4b:c0:e5:69:42:fb:27:50:... 
ssl_load_key: swapping p and q parameters and recomputing u 
Bag 1/0: Encrypted 
Bag 1/0 decrypted: Certificate 
Certificate imported: smtp.****.com &lt;&lt;ERROR&gt;&gt;, KeyID b720ac007bd357534bc0e56942fb27502483819a
Bag 1/1: Certificate 
Certificate imported: DigiCert High Assurance EV Root CA &lt;&lt;ERROR&gt;&gt;, KeyID 13317e62854253d6d7783190ec919056e991b9e3
Bag 1/2: Certificate
Certificate imported: DigiCert High Assurance CA-3 &lt;&lt;ERROR&gt;&gt;, KeyID 25f9d7434b1ce71def4211ee6be3c0e0256fad95
ssl_init IPv4 addr '192.168.1.15' (192.168.1.15) port '443' filename 'P:\n0.pfx' password(only for p12 file) '*****' 
ssl_init private key file P:\n0.pfx successfully loaded.
association_add TCP port 443 protocol ssl handle 00000000041CF020
</code></pre>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/ssl/" class="post-tag tag-link-ssl"
                                        title="see questions tagged 'ssl'" rel="tag">ssl</a>
                                
                                    <a href="/tags/certificate/" class="post-tag tag-link-certificate"
                                        title="see questions tagged 'certificate'" rel="tag">certificate</a>
                                
                                    <a href="/tags/decryption/" class="post-tag tag-link-decryption"
                                        title="see questions tagged 'decryption'" rel="tag">decryption</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>23 Sep '14, 09:08</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/bcfdf26904f3a8a9fb69c7ca0dc5e7b1?s=32&amp;d=identicon&amp;r=g" alt="net_tech's gravatar image" />
    <p><a href="/users/249/net_tech">net_tech</a><br/>
    <span class="score" title="116 reputation points">116</span><span title="30 badges"><span class="badge1">&#9679;</span><span class="badgecount">30</span></span><span title="33 badges"><span class="silver">&#9679;</span><span class="badgecount">33</span></span><span title="37 badges"><span class="bronze">&#9679;</span><span class="badgecount">37</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="net_tech has 2 accepted answers">13&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/36524/">
                edited
                <strong>23 Sep '14, 12:50</strong>
            </a>
        </p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-36524">
    
        <a name="36525"></a>
        <div class="comment" id="comment-36525">
            <div id="post-36525-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>association_add TCP port 443 protocol ssl handle 00000000041CF020</p>
</blockquote>

<p>In "the RSA Keys list:" dialog box where you configure the certificate path, is "Protocol" set to "ssl" or "http"? I'm not familiar with what shows up in the ssl debug log, but this line makes me suspect it's "ssl" when it should be "http".</p></div>
            <div class="comment-info" id="comment-36525-info">
                
                
                
                

                

                <span class="comment-age">(23 Sep '14, 09:31)</span>
                <a class="comment-user userinfo" href="/users/5429/smp">smp</a>
                
            </div>
        </div>
    
        <a name="36526"></a>
        <div class="comment" id="comment-36526">
            <div id="post-36526-score" class="comment-score"></div>
            <div class="comment-text"><p>It's encrypted SMTP traffic, it should be smtp I think. Wrong port? Should it be 25 instead of 443 since communication is happening over 25.</p></div>
            <div class="comment-info" id="comment-36526-info">
                
                
                
                

                

                <span class="comment-age">(23 Sep '14, 09:42)</span>
                <a class="comment-user userinfo" href="/users/249/net_tech">net_tech</a>
                
            </div>
        </div>
    
        <a name="36527"></a>
        <div class="comment" id="comment-36527">
            <div id="post-36527-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>Wrong port?<br>
</p>
</blockquote>

<p>Sorry, I didn't go back and fully digest your original message. In that RSA Keys List dialog box, the port number should be the destination (serverside) port number of the tcp connection you're trying to decrypt. If the unencrypted traffic is SMTP instead of HTTP, then yes, specify "smtp".</p>

<p>Perhaps you've already decrypted this and don't know it. Do you see readable text if you right-click a packet and select "Follow SSL Stream"?</p></div>
            <div class="comment-info" id="comment-36527-info">
                
                
                
                

                

                <span class="comment-age">(23 Sep '14, 09:48)</span>
                <a class="comment-user userinfo" href="/users/5429/smp">smp</a>
                
            </div>
        </div>
    
        <a name="36528"></a>
        <div class="comment" id="comment-36528">
            <div id="post-36528-score" class="comment-score"></div>
            <div class="comment-text"><p>updated from 443 to 25 and changed from ssl to smtp. still unable to decrypt when I follow SSL stream. (blank screen comes up)</p></div>
            <div class="comment-info" id="comment-36528-info">
                
                
                
                

                

                <span class="comment-age">(23 Sep '14, 09:52)</span>
                <a class="comment-user userinfo" href="/users/249/net_tech">net_tech</a>
                
            </div>
        </div>
    
        <a name="36529"></a>
        <div class="comment" id="comment-36529">
            <div id="post-36529-score" class="comment-score"></div>
            <div class="comment-text"><p>This probably won't work, but try re-opening the trace. I've had to refresh it before.</p>

<p>In any case, would you mind including a bit more of the ssl debug log? There should be a record for every packet it tries to decrypt. It looks like you might have decided to cut it off before that point.</p></div>
            <div class="comment-info" id="comment-36529-info">
                
                
                
                

                

                <span class="comment-age">(23 Sep '14, 09:54)</span>
                <a class="comment-user userinfo" href="/users/5429/smp">smp</a>
                
            </div>
        </div>
    
        <a name="36530"></a>
        <div class="comment not_top_scorer" id="comment-36530">
            <div id="post-36530-score" class="comment-score"></div>
            <div class="comment-text"><p>looks like the answer is right here.</p>

<p>ssl_find_private_key server 204.232.236.146:25<br>
ssl_find_private_key: testing 1 keys<br>
ssl_find_private_key can't find private key for this server! Try it again with universal port 0<br>
ssl_find_private_key can't find private key for this server (universal port)! Try it again with universal address 0.0.0.0 <br>
ssl_find_private_key can't find private key for this server! Try it again with universal address 0.0.0.0 and universal port 0 <br>
ssl_find_private_key can't find any private key!<br></p></div>
            <div class="comment-info" id="comment-36530-info">
                
                
                
                

                

                <span class="comment-age">(23 Sep '14, 10:13)</span>
                <a class="comment-user userinfo" href="/users/249/net_tech">net_tech</a>
                
            </div>
        </div>
    
        <a name="36531"></a>
        <div class="comment not_top_scorer" id="comment-36531">
            <div id="post-36531-score" class="comment-score"></div>
            <div class="comment-text"><p>the private key I have is for incoming connections, can't decrypt outgoing connection since I don't have the key from the remote side.</p></div>
            <div class="comment-info" id="comment-36531-info">
                
                
                
                

                

                <span class="comment-age">(23 Sep '14, 10:17)</span>
                <a class="comment-user userinfo" href="/users/249/net_tech">net_tech</a>
                
            </div>
        </div>
    
        <a name="36532"></a>
        <div class="comment not_top_scorer" id="comment-36532">
            <div id="post-36532-score" class="comment-score"></div>
            <div class="comment-text"><p>Not sure I understand what you mean there, but perhaps I just don't understand SSL enough - entirely possible. Regardless, glad you feel you have an explanation.</p></div>
            <div class="comment-info" id="comment-36532-info">
                
                
                
                

                

                <span class="comment-age">(23 Sep '14, 10:34)</span>
                <a class="comment-user userinfo" href="/users/5429/smp">smp</a>
                
            </div>
        </div>
    
        <a name="36534"></a>
        <div class="comment not_top_scorer" id="comment-36534">
            <div id="post-36534-score" class="comment-score"></div>
            <div class="comment-text"><p>spoke too soon... looking at a stream from an external smtp server to mine and still get blank window when ssl stream is followed</p></div>
            <div class="comment-info" id="comment-36534-info">
                
                
                
                

                

                <span class="comment-age">(23 Sep '14, 11:23)</span>
                <a class="comment-user userinfo" href="/users/249/net_tech">net_tech</a>
                
            </div>
        </div>
    
        <a name="36535"></a>
        <div class="comment not_top_scorer" id="comment-36535">
            <div id="post-36535-score" class="comment-score"></div>
            <div class="comment-text"><p>OK, now I'm confused. Perhaps you should post the stream you want to decrypt to cloudshark, or attach, so we can look at the same thing.</p>

<p>It's possible that the stream was a cached session, in which case Wireshark can't decrypt - it needs the full handshake. We should be able to confirm this if you post the trace somewhere we can see it.</p></div>
            <div class="comment-info" id="comment-36535-info">
                
                
                
                

                

                <span class="comment-age">(23 Sep '14, 11:37)</span>
                <a class="comment-user userinfo" href="/users/5429/smp">smp</a>
                
            </div>
        </div>
    
        <a name="36537"></a>
        <div class="comment not_top_scorer" id="comment-36537">
            <div id="post-36537-score" class="comment-score"></div>
            <div class="comment-text"><p>SSL Log <a href="http://www.remontnetworks.com/ssl_log.txt">link</a></p></div>
            <div class="comment-info" id="comment-36537-info">
                
                
                
                

                

                <span class="comment-age">(23 Sep '14, 12:00)</span>
                <a class="comment-user userinfo" href="/users/249/net_tech">net_tech</a>
                
            </div>
        </div>
    
        <a name="36538"></a>
        <div class="comment not_top_scorer" id="comment-36538">
            <div id="post-36538-score" class="comment-score"></div>
            <div class="comment-text"><p>Sorry, I was referring to the actual trace file (.pcap or .pcapng). But the log file you linked to does seem to have the answer:</p>

<blockquote>
<p>dissect_ssl3_hnd_srv_hello trying to generate keys</p>
<p>ssl_generate_keyring_material not enough data to generate key (0x17 required 0x37 or 0x57)</p>
<p>dissect_ssl3_hnd_srv_hello can't generate keyring material</p>
</blockquote>

<p>I think this means that the SSL session was cached. Wireshark can't decrypt a cached SSL session because the full key exchange doesn't take place. We should be able to tell pretty quickly if you post the actual trace file. You can also confirm yourself by looking for the certificate in the Packet Details pane of the Server Hello packet. If instead you see Session ID and renegotiation fields, it's a re-used session and Wireshark can't decrypt it. You need the full handshake.</p></div>
            <div class="comment-info" id="comment-36538-info">
                
                
                
                

                

                <span class="comment-age">(23 Sep '14, 12:09)</span>
                <a class="comment-user userinfo" href="/users/5429/smp">smp</a>
                
            </div>
        </div>
    
        <a name="36539"></a>
        <div class="comment not_top_scorer" id="comment-36539">
            <div id="post-36539-score" class="comment-score"></div>
            <div class="comment-text"><p>it does!</p>

<p><a href="https://ask.wireshark.org/questions/16788/wireshark-decrypt-ssl-traffic">https://ask.wireshark.org/questions/16788/wireshark-decrypt-ssl-traffic</a></p></div>
            <div class="comment-info" id="comment-36539-info">
                
                
                
                

                

                <span class="comment-age">(23 Sep '14, 12:11)</span>
                <a class="comment-user userinfo" href="/users/249/net_tech">net_tech</a>
                
            </div>
        </div>
    
        <a name="36540"></a>
        <div class="comment not_top_scorer" id="comment-36540">
            <div id="post-36540-score" class="comment-score"></div>
            <div class="comment-text"><p>googled for ssl_decrypt_pre_master_secret session uses DH (17) key exchange, which is impossible to decrypt and found my answer in Q16788</p></div>
            <div class="comment-info" id="comment-36540-info">
                
                
                
                

                

                <span class="comment-age">(23 Sep '14, 12:12)</span>
                <a class="comment-user userinfo" href="/users/249/net_tech">net_tech</a>
                
            </div>
        </div>
    
        <a name="36541"></a>
        <div class="comment not_top_scorer" id="comment-36541">
            <div id="post-36541-score" class="comment-score"></div>
            <div class="comment-text"><p>I am way out of my league now. And I'm not entirely convinced it's impossible - the <a href="http://wiki.wireshark.org/SSL">SSL Wiki</a> seems to say otherwise. Also see <a href="https://ask.wireshark.org/questions/4229/follow-ssl-stream-using-master-key-and-session-id">this link</a>. I'm sure someone more knowledgeable will chime in here.</p>

<p>Good luck.</p></div>
            <div class="comment-info" id="comment-36541-info">
                
                
                
                

                

                <span class="comment-age">(23 Sep '14, 12:20)</span>
                <a class="comment-user userinfo" href="/users/5429/smp">smp</a>
                
            </div>
        </div>
    
        <a name="36542"></a>
        <div class="comment not_top_scorer" id="comment-36542">
            <div id="post-36542-score" class="comment-score"></div>
            <div class="comment-text"><p>Cipher TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA (cipher suite 0xc014) is used in the stream I am trying to decrypt. </p>

<p>Another post by Kurt (from this year) suggests that it's possible with Wireshark 1.11, I am running 1.12.</p>

<p><a href="https://ask.wireshark.org/questions/32668/unable-to-decrypt-ssl-sessions-in-wireshark">https://ask.wireshark.org/questions/32668/unable-to-decrypt-ssl-sessions-in-wireshark</a></p></div>
            <div class="comment-info" id="comment-36542-info">
                
                
                
                

                

                <span class="comment-age">(23 Sep '14, 12:48)</span>
                <a class="comment-user userinfo" href="/users/249/net_tech">net_tech</a>
                
            </div>
        </div>
    
        <a name="36544"></a>
        <div class="comment not_top_scorer" id="comment-36544">
            <div id="post-36544-score" class="comment-score"></div>
            <div class="comment-text"><p>Yeah, I don't (yet) think the issue here is with the protocol being used. The debug log says it can't find the right private key:</p>

<blockquote>
<p>can't find private key for this server</p>
</blockquote>

<p>So I think either you haven't quite yet specified the right properties in the RSA Keys List dialog, or you didn't catch the full handshake.</p>

<p>In the RSA Keys List dialog, are you sure you have the private key from the serverside of the connection (204.232.236.146:25), and that the Port number is 25?</p>

<p>Can you post the trace?</p></div>
            <div class="comment-info" id="comment-36544-info">
                
                
                
                

                

                <span class="comment-age">(23 Sep '14, 12:54)</span>
                <a class="comment-user userinfo" href="/users/5429/smp">smp</a>
                
            </div>
        </div>
    
        <a name="36545"></a>
        <div class="comment not_top_scorer" id="comment-36545">
            <div id="post-36545-score" class="comment-score"></div>
            <div class="comment-text"><p>Unfortunately i can't post this trace anywhere, but after examining Server Hello, Certificate, Server Key Exchange, Server Hello Done frame I can see that the serialNumber of the cert does not match the serial number of the private key I exported.</p></div>
            <div class="comment-info" id="comment-36545-info">
                
                
                
                

                

                <span class="comment-age">(23 Sep '14, 13:24)</span>
                <a class="comment-user userinfo" href="/users/249/net_tech">net_tech</a>
                
            </div>
        </div>
    
        <a name="36563"></a>
        <div class="comment not_top_scorer" id="comment-36563">
            <div id="post-36563-score" class="comment-score"></div>
            <div class="comment-text"><p>I was unable to decrypt SSL traffic with wireshark even after obtaining the correct private key.</p>

<p>SYN-bit's post confirms this
<a href="https://ask.wireshark.org/questions/17630/cant-decrypt-tlsv1-traffic">https://ask.wireshark.org/questions/17630/cant-decrypt-tlsv1-traffic</a><br>
Perhaps this is the way to decrypt...
<a href="http://www.codybaker.org/2012/08/debugging-ssl-communications/">http://www.codybaker.org/2012/08/debugging-ssl-communications/</a></p></div>
            <div class="comment-info" id="comment-36563-info">
                
                
                
                

                

                <span class="comment-age">(24 Sep '14, 07:07)</span>
                <a class="comment-user userinfo" href="/users/249/net_tech">net_tech</a>
                
            </div>
        </div>
    
        <a name="36565"></a>
        <div class="comment not_top_scorer" id="comment-36565">
            <div id="post-36565-score" class="comment-score"></div>
            <div class="comment-text"><p>I've done my best to help you here, but I'm at my limits. You'll need to wait for someone more knowledgeable to respond. If you decide to post a new question, I'll hold off from commenting to encourage responses from others.</p>

<p>Sorry I couldn't help more.</p></div>
            <div class="comment-info" id="comment-36565-info">
                
                
                
                

                

                <span class="comment-age">(24 Sep '14, 08:00)</span>
                <a class="comment-user userinfo" href="/users/5429/smp">smp</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-36524" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 20
        </span>
        <a href="#" class="show-all-comments-link">show 15 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-36524-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
        <form id="fmanswer" action="/questions/36524/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='PBP8qADOsQNY0vOalJV6XAfE2NDjQgA8' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Be the first one to answer this question!
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/36524/unable-to-decrypt-ssl-traffic-in-wireshark?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/36524/unable-to-decrypt-ssl-traffic-in-wireshark?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/ssl/"
            class="tag-link-ssl"
            title="see questions tagged'ssl'using tags"
            rel="tag">ssl</a> <span class="tag-number">&#215;319</span><br/>
        
        <a href="/tags/decryption/"
            class="tag-link-decryption"
            title="see questions tagged'decryption'using tags"
            rel="tag">decryption</a> <span class="tag-number">&#215;165</span><br/>
        
        <a href="/tags/certificate/"
            class="tag-link-certificate"
            title="see questions tagged'certificate'using tags"
            rel="tag">certificate</a> <span class="tag-number">&#215;18</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Sept. 23, 2014, 9:08 a.m.">23 Sep '14, 09:08</strong>
    </p>
    <p> 
     	question was seen: <strong>7,173 times</strong>
    </p>
    <p> 
        last updated: <strong title="Sept. 24, 2014, 8 a.m.">24 Sep '14, 08:00</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/54975/issues-decrypting-ssl-traffic">issues decrypting SSL Traffic</a>
        </p>
        
        <p>
            <a href="/questions/6426/ssl-decryption-problems">SSL Decryption Problems</a>
        </p>
        
        <p>
            <a href="/questions/8373/dtls-decryption-not-working-on-wireshark-165-even-for-sample-capture">DTLS decryption not working on Wireshark 1.6.5, even for sample capture</a>
        </p>
        
        <p>
            <a href="/questions/28145/cant-decrypt-ssl-in-capture-from-windump">Can&#39;t decrypt ssl in capture from windump</a>
        </p>
        
        <p>
            <a href="/questions/50305/how-does-wireshark-decrypt-ssltls-with-only-clientrandom">How does Wireshark decrypt SSL/TLS with only ClientRandom</a>
        </p>
        
        <p>
            <a href="/questions/4337/how-to-identify-ssl-certificate-file-name">How to identify SSL Certificate file name</a>
        </p>
        
        <p>
            <a href="/questions/50584/not-decrypting-all-http2-traffic-in-session">Not Decrypting all HTTP/2 traffic in session.</a>
        </p>
        
        <p>
            <a href="/questions/55099/tshark-decrypts-only-firsts-https-packets">Tshark decrypts only firsts https packets</a>
        </p>
        
        <p>
            <a href="/questions/4685/decrypting-ssl">Decrypting SSL</a>
        </p>
        
        <p>
            <a href="/questions/28503/decrypt-ssl-using-wildcard-ip-address">Decrypt SSL using wildcard IP address</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
