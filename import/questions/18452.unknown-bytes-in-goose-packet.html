<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Unknown bytes in GOOSE packet - Wireshark Q&amp;A</title>
        <meta name="description" content="I can read ALMOST every byte now in the pcap file mentioned in this question, thanks to Guy_Harris.c. All but 5 bytes. 5 bytes. Frame 2 of this file is a GOOSE package, according to Wireshark. The length is 161 bytes: 01 a0 f4 04 9c 5f 00 a0 f4 04 9c 5f 88 b8 00 00 00 93 00 00 00 00 61 81 88 80 1a (..." />
        <meta name="keywords" content="goose,asn.1,ber" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/18452/unknown-bytes-in-goose-packet" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/18452/unknown-bytes-in-goose-packet?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='2KHlp6wR40H0ekIeNaTulpxnszYNaoVB' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/18452/unknown-bytes-in-goose-packet">Unknown bytes in GOOSE packet</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-18452-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/18452/up/" rel="nofollow"> </a>
<div id="post-18452-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-18452-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/18452/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/18452/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>I can read ALMOST every byte now in the pcap file mentioned <a href="http://ask.wireshark.org/questions/18380/first-40-bytes">in this question</a>, thanks to Guy_Harris.c.  All but 5 bytes.  5 bytes.</p>
<p>Frame 2 of this file is a GOOSE package, according to Wireshark.  The length is 161 bytes:</p>
<p>01 a0 f4 04 9c 5f 00 a0 f4 04 9c 5f 88 b8 00 00 00 93 00 00 00 00 61 81 88</p>
<p>80 1a (26 bytes) 81 02 23 28 82 18 (24 bytes) 83 0e (14 bytes) 84</p>
<p>08 00 00 00 00 00 00 00 3f 85 01 01 86 03 01 e3 68 87 01 00 88 01 01 89 01</p>
<p>00 8a 01 02 ab 1e 84 09 00 55 55 55 55 55 55 55 55 84 11 00 55 55 55 55 55</p>
<p>55 55 55 55 55 55 55 55 55 55 55</p>
<p>I removed the GOOSE ID so I don't get into trouble.</p>
<p>Now, I have no trouble understanding the first 22 bytes:</p>
<p>01 a0 f4 04 9c 5f    from nic</p>
<p>00 a0 f4 04 9c 5f    to   nic</p>
<p>88 b8                packet type (goose)</p>
<p>00 00                application ID</p>
<p>00 93                PDU Length 0x00000093 or 147</p>
<p>00 00                reserved 1</p>
<p>00 00                reserved 2</p>
<p>but Wireshark doesn't tell me what the next 3 bytes are:</p>
<p>61 81 88             what's this???</p>
<p>before telling me I have a 26 byte Control Block Ref:</p>
<p>80 1a <strong> </strong> <strong> </strong> <strong> </strong> <strong> </strong> <strong> </strong> <strong> </strong> <strong> </strong> <strong> </strong> <strong> </strong> <strong> </strong> <strong> </strong> <strong> </strong> <strong> </strong> </p>
<p>follow by the time allowed to live 9000 msec</p>
<p>81 02    23 28 </p>
<p>Dataset ref:</p>
<p>82 18 <strong> </strong> <strong> </strong> <strong> </strong> <strong> </strong> <strong> </strong> <strong> </strong> <strong> </strong> <strong> </strong> <strong> </strong> <strong> </strong> <strong> </strong> <strong> </strong></p>
<p>84 08 00 00 00 00 00 00 00 3f  Event Timestamp: 1970-01-01 00:00.0.00000; Timeequality: 3F</p>
<p>85 01 01                       StateNumber:   last byte 01 = 1</p>
<p>86 03 01 e3 68                 Sequence Number: 01 e3 68 = 123752</p>
<p>87 01 00                       Simulation bit: last byte 00 = FALSE,</p>
<p>88 01 01                       Config Revision: last byte 01 = 1</p>
<p>89 01 00                       Needs commissioning: last byte 00 = FALSE</p>
<p>8a 01 02                       Number Dataset Entries: last byte 02 = 2</p>
<p>and now comes 2 bytes Wireshark doesn't say what it is:</p>
<p>ab 1e                          What's this ????</p>
<p>before displaying the rest of the payload.  So what are these 5 bytes?</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/goose/" class="post-tag tag-link-goose"
                                        title="see questions tagged 'goose'" rel="tag">goose</a>
                                
                                    <a href="/tags/asn.1/" class="post-tag tag-link-asn.1"
                                        title="see questions tagged 'asn.1'" rel="tag">asn.1</a>
                                
                                    <a href="/tags/ber/" class="post-tag tag-link-ber"
                                        title="see questions tagged 'ber'" rel="tag">ber</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>08 Feb '13, 15:40</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/4025240b8c0475c260d9cb7529e827c9?s=32&amp;d=identicon&amp;r=g" alt="ecs1749's gravatar image" />
    <p><a href="/users/4343/ecs1749">ecs1749</a><br/>
    <span class="score" title="21 reputation points">21</span><span title="7 badges"><span class="badge1">&#9679;</span><span class="badgecount">7</span></span><span title="8 badges"><span class="silver">&#9679;</span><span class="badgecount">8</span></span><span title="11 badges"><span class="bronze">&#9679;</span><span class="badgecount">11</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="ecs1749 has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/18452/">
                edited
                <strong>08 Feb '13, 20:26</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" alt="Guy%20Harris's gravatar image" />
            <p><a href="/users/79/guy-harris">Guy Harris ♦♦</a><br/>
            <span class="score" title="17443 reputation points"><span class="">17.4k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">&#9679;</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">&#9679;</span><span class="badgecount">196</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-18452">
    
</div>
<div id="comment-tools-18452" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-18452-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/18452/unknown-bytes-in-goose-packet?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/18452/unknown-bytes-in-goose-packet?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/18452/unknown-bytes-in-goose-packet?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/18452/unknown-bytes-in-goose-packet?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="18461"></a>
                    <div id="answer-container-18461" class="answer accepted-answer">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-18461-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/18461/up/" rel="nofollow"> </a>
<div id="post-18461-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-18461-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/18461/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="ecs1749 has selected this answer as the correct answer"
        href="/accept_answer/18461/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>The first 14 bytes are specified by the Ethernet specification (IEEE 802.3).</p>
<p>The next 8 bytes are as per Annex C, Figure C. 1 of IEC 61850-8-1 (note that, in that figure, the frames have a VLAN tag, while the frame in your capture has no VLAN tag, so the offsets in the frame are different).</p>
<p>What follows, again as per Annex C, Figure C. 1, is an "APDU", meaning an Application-layer Protocol Data Unit.  Section 6.3.2 "A-Profile" of IEC 61850-8-1 says that the specification for the GSE/GOOSE protocol is in Annex A, and that "The presentation layer encoding shall be <a href="https://en.wikipedia.org/wiki/Basic_Encoding_Rules#BER_encoding">Basic Encoding Rules</a> as defined in ISO/IEC 8824-1 and ISO/IEC 8825-1 to encode the grammar referenced."</p>
<p>Annex A contains the <a href="https://en.wikipedia.org/wiki/Asn.1">Abstract Syntax Notation One</a> (ASN.1) syntax of a GSE/GOOSE PDU, which starts with</p>
<pre><code>IEC 61850-8-1 Specific Protocol ::= CHOICE {
    gseMngtPdu     [APPLICATION 0] IMPLICIT GSEMngtPdu,
    goosePdu       [APPLICATION 1] IMPLICIT IECGoosePdu,
    ...}
</code></pre>
<p>A GOOSE PDU would thus start with the Basic Encoding Rules (BER) tag for [APPLICATION 1].  The type identifier octet in that tag would, as per the WIkipedia article on BER linked above, have the bits 01 1 00001, for "Application" (01), "Constructed" (1 - a GOOSE PDU is not a primitive BER data type), 0 (00001).  That's the 0x61.</p>
<p>Following that are the length octets of the tag.  The first octet is 0x81; that has the uppermost bit set, so the length is in the "long form", and the remaining bits are the value 1, meaning that there's one more length octet.  That octet has the value 0x88, which is 136, so there are 136 bytes of data in the PDU.</p>
<p>Normally, when dissecting data encoded using ASN.1's Basic Encoding Rules (such as, for example, SNMP or LDAP traffic), people are interested in what's been encoded, not the details of <em>how</em> it was encoded, so, by default, Wireshark does <em>not</em> show the dissection of BER tag information when dissecting BER-encoded packets.</p>
<p>For those cases when people <em>are</em> interested in the details of how BER-encoded information is encoded - for example, if they're trying to investigate a bug in the encoding, or trying to determine what some particular bytes in a packet are - you can turn on a preference to get Wireshark to show the details.  Open up Edit -&gt; Preferences, select the "Protocols" list, look for the "BER" protocol, check the "Show internal BER encapsulation tokens" checkbox, and click "OK".  Wireshark will then show the gory details of BER tags.</p>
<p>If you want to see what all the bytes are in your GOOSE packet, you will have to do that.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/18461/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>08 Feb '13, 20:24</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" alt="Guy%20Harris's gravatar image" />
    <p><a href="/users/79/guy-harris">Guy Harris ♦♦</a><br/>
    <span class="score" title="17443 reputation points"><span class="">17.4k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">&#9679;</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">&#9679;</span><span class="badgecount">196</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Guy Harris has 216 accepted answers">19&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-18461">
    
        <a name="18493"></a>
        <div class="comment" id="comment-18493">
            <div id="post-18493-score" class="comment-score"></div>
            <div class="comment-text"><p>Your "answer" has been converted to a comment as that's how this site works. Please read the FAQ for more information.</p></div>
            <div class="comment-info" id="comment-18493-info">
                
                
                
                

                

                <span class="comment-age">(11 Feb '13, 10:31)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="18497"></a>
        <div class="comment" id="comment-18497">
            <div id="post-18497-score" class="comment-score"></div>
            <div class="comment-text"><p>Sorry, "as per Annex C, Figure C. 1" was a bit confusingly stated.</p>

<p>What I meant was that the next 8 bytes are as per the stuff in that figure <em>following the "Ethertype (see Table C.2)" field</em>.</p>

<p>That figure shows a <em>complete</em> Ethernet packet, <em>with a VLAN header</em>, so it also shows the Ethernet header, as well as a VLAN tag; your packets don't have a VLAN tag, so you won't see the TPID or TCI; instead, what you'll see following the source address is the Ethertype.</p>

<p>"m" is the length of the GOOSE ASN.1-BER-encapsulated packet; see "APDU (of length m)" later in that figure.</p></div>
            <div class="comment-info" id="comment-18497-info">
                
                
                
                

                

                <span class="comment-age">(11 Feb '13, 10:53)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="18499"></a>
        <div class="comment" id="comment-18499">
            <div id="post-18499-score" class="comment-score"></div>
            <div class="comment-text"><p>"The first 14 bytes are specified by the Ethernet specification (IEEE 802.3)".</p>

<p>So, that's bytes 0-13 as per Annex C, Figure C. 1 of IEC 61850-8-1.  My TPID is 0x88b8 because my frame doesn't have VLAN tag, or else it would be 0x8100.  Do I understand that correctly?</p></div>
            <div class="comment-info" id="comment-18499-info">
                
                
                
                

                

                <span class="comment-age">(11 Feb '13, 11:08)</span>
                <a class="comment-user userinfo" href="/users/4343/ecs1749">ecs1749</a>
                
            </div>
        </div>
    
        <a name="18500"></a>
        <div class="comment" id="comment-18500">
            <div id="post-18500-score" class="comment-score"></div>
            <div class="comment-text"><p>"The next 8 bytes are as per Annex C, Figure C. 1 of IEC 61850-8-1 (note that, in that figure, the frames have a VLAN tag, while the frame in your capture has no VLAN tag, so the offsets in the frame are different)."</p>

<p>That would be TCI (2 bytes in my case), Ethertype (2 bytes), APPID (2 bytes), m+8 (2 bytes).   But according to Wireshark, I have (no TCI, no Ethertype): APPID (2 bytes), m+8 (2 bytes), reserve 1 &amp; 2 (4 bytes).  Then APDU starts.    So, what happened to TCI and Ethertype?</p></div>
            <div class="comment-info" id="comment-18500-info">
                
                
                
                

                

                <span class="comment-age">(11 Feb '13, 11:08)</span>
                <a class="comment-user userinfo" href="/users/4343/ecs1749">ecs1749</a>
                
            </div>
        </div>
    
        <a name="18501"></a>
        <div class="comment" id="comment-18501">
            <div id="post-18501-score" class="comment-score"></div>
            <div class="comment-text"><p>I understand what you said about the 61 81 88 Octets.</p></div>
            <div class="comment-info" id="comment-18501-info">
                
                
                
                

                

                <span class="comment-age">(11 Feb '13, 11:09)</span>
                <a class="comment-user userinfo" href="/users/4343/ecs1749">ecs1749</a>
                
            </div>
        </div>
    
        <a name="18504"></a>
        <div class="comment not_top_scorer" id="comment-18504">
            <div id="post-18504-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>My TPID is 0x88b8 because my frame doesn't have VLAN tag, or else it would be 0x8100. Do I understand that correctly?</p>
</blockquote>

<p>Not exactly.  VLANs work by setting the last 2 bytes of the Ethernet header to 0x8100, so that the frame looks as if it has an EtherType value of 0x8100.  Only if it has the value 0x8100 is it called the TPID field (Tag Protocol Identifier); otherwise, it's just the EtherType field.</p>

<blockquote>
<p>That would be TCI (2 bytes in my case)</p>
</blockquote>

<p>No.  As your frame does not have a VLAN frame, it has no TCI, and the two bytes immediately after the source address are the Ethertype, not the TPID.</p></div>
            <div class="comment-info" id="comment-18504-info">
                
                
                
                

                

                <span class="comment-age">(11 Feb '13, 11:32)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-18461" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 6
        </span>
        <a href="#" class="show-all-comments-link">show 1 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-18461-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="18455"></a>
                    <div id="answer-container-18455" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-18455-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/18455/up/" rel="nofollow"> </a>
<div id="post-18455-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-18455-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/18455/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>I have never worked with the GOOSE protocol, but for the fun of it I tried to reverse engineer it a bit. As far as I can tell those bytes are probably a type and length indicator. In the sample trace I got from <a href="http://wiki.wireshark.org/Protocols/IEC61850GOOSEGSE">http://wiki.wireshark.org/Protocols/IEC61850GOOSEGSE</a> there are many decoded fields in the "allData section" that have "gaps" when trying to match bytes to decoded value, and these are seemingly always type and length of the value that is shown. </p>
<p>So I guess that is what it is; the other thing I found in the specs I googled for was that there may be padding in some cases, but I haven't tried to verify this. Padding bytes may be arbitrary bytes, so it is futile to try to make some sense of them.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/18455/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>08 Feb '13, 16:41</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" alt="Jasper's gravatar image" />
    <p><a href="/users/145/jasper">Jasper ♦♦</a><br/>
    <span class="score" title="23806 reputation points"><span class="">23.8k</span></span><span title="5 badges"><span class="badge1">&#9679;</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">&#9679;</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">&#9679;</span><span class="badgecount">284</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Jasper has 263 accepted answers">18&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-18455">
    
        <a name="18462"></a>
        <div class="comment" id="comment-18462">
            <div id="post-18462-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>As far as I can tell those bytes are probably a type and length indicator</p>
</blockquote>

<p>Yes - GOOSE uses ASN.1 BER, as per my answer to this question, so, yes, they're type/length indicators.</p></div>
            <div class="comment-info" id="comment-18462-info">
                
                
                
                

                

                <span class="comment-age">(08 Feb '13, 20:25)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="18503"></a>
        <div class="comment" id="comment-18503">
            <div id="post-18503-score" class="comment-score"></div>
            <div class="comment-text"><p>But what about that ab 1e?  These are the leading bytes of the Data block.</p>

<p>01 a0 f4 04 9c 5f 00 a0 f4 04 9c 5f 88 b8 00 00 00 93 00 00 00 00 
61 81 88
80 1a (26 bytes) 
81 02 23 28 
82 18 (24 bytes) 
83 0e (14 bytes) 
84 08 00 00 00 00 00 00 00 3f 
85 01 01 
86 03 01 e3 68 
87 01 00 
88 01 01 
89 01 00 
8a 01 02 </p>

<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>ab 1e&lt;&lt;&lt;&lt;&lt; 
84 09 00 55 55 55 55 55 55 55 55 
84 11 00 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote></div>
            <div class="comment-info" id="comment-18503-info">
                
                
                
                

                

                <span class="comment-age">(11 Feb '13, 11:24)</span>
                <a class="comment-user userinfo" href="/users/4343/ecs1749">ecs1749</a>
                
            </div>
        </div>
    
        <a name="18506"></a>
        <div class="comment" id="comment-18506">
            <div id="post-18506-score" class="comment-score"></div>
            <div class="comment-text"><p>They're probably ASN.1 BER tag information.  I spent a lot of time going through the first 3 bytes of the APDU to indicate what they are, and to check that the packet is, as I expected, using ASN.1 BER.  I will <em>NOT</em> do any more such analysis; that's the sort of analysis that is best done by a program, not a human, and you already have a program that can do that analysis - it's called "Wireshark".  As I already said in my answer, if you set a Wireshark preference, it will show you the BER tag information; the answer says how to do that.  If you want to know what those bytes are, set that pref.</p></div>
            <div class="comment-info" id="comment-18506-info">
                
                
                
                

                

                <span class="comment-age">(11 Feb '13, 11:35)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="18507"></a>
        <div class="comment" id="comment-18507">
            <div id="post-18507-score" class="comment-score"></div>
            <div class="comment-text"><p>Sorry, I forgot to mention that I did turn on BER as instructed.  Still no info about these 2 bytes.  I appreciate greatly about the help you offered to this point.<br>
</p>

<p>I will read further about the ASN.1 BER.</p>

<p>Thanks again.</p></div>
            <div class="comment-info" id="comment-18507-info">
                
                
                
                

                

                <span class="comment-age">(11 Feb '13, 12:26)</span>
                <a class="comment-user userinfo" href="/users/4343/ecs1749">ecs1749</a>
                
            </div>
        </div>
    
        <a name="18508"></a>
        <div class="comment" id="comment-18508">
            <div id="post-18508-score" class="comment-score"></div>
            <div class="comment-text"><p>Oh, my bad.  I thought 1e is 31.  "BONK".  1e is 30.  So, it's total number of bytes inn the Data block.  That's why its ab 1e.</p></div>
            <div class="comment-info" id="comment-18508-info">
                
                
                
                

                

                <span class="comment-age">(11 Feb '13, 12:41)</span>
                <a class="comment-user userinfo" href="/users/4343/ecs1749">ecs1749</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-18455" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-18455-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/18452/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='2KHlp6wR40H0ekIeNaTulpxnszYNaoVB' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/18452/unknown-bytes-in-goose-packet?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/18452/unknown-bytes-in-goose-packet?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/asn.1/"
            class="tag-link-asn.1"
            title="see questions tagged'asn.1'using tags"
            rel="tag">asn.1</a> <span class="tag-number">&#215;10</span><br/>
        
        <a href="/tags/ber/"
            class="tag-link-ber"
            title="see questions tagged'ber'using tags"
            rel="tag">ber</a> <span class="tag-number">&#215;6</span><br/>
        
        <a href="/tags/goose/"
            class="tag-link-goose"
            title="see questions tagged'goose'using tags"
            rel="tag">goose</a> <span class="tag-number">&#215;5</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Feb. 8, 2013, 3:40 p.m.">08 Feb '13, 15:40</strong>
    </p>
    <p> 
     	question was seen: <strong>5,139 times</strong>
    </p>
    <p> 
        last updated: <strong title="Feb. 11, 2013, 12:41 p.m.">11 Feb '13, 12:41</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/47668/goosepdu-wireshark-capture">goosePDU wireshark capture</a>
        </p>
        
        <p>
            <a href="/questions/58179/presentation-contexts-negotiation">Presentation Contexts Negotiation</a>
        </p>
        
        <p>
            <a href="/questions/21169/float-values-in-goose-protocol">Float values in GOOSE Protocol</a>
        </p>
        
        <p>
            <a href="/questions/1022/camelentityreleased">camel.EntityReleased</a>
        </p>
        
        <p>
            <a href="/questions/32855/dissecting-oracle-wallet-pkcs12">Dissecting Oracle Wallet PKCS#12</a>
        </p>
        
        <p>
            <a href="/questions/58132/decoding-implicit-tagging">decoding implicit tagging</a>
        </p>
        
        <p>
            <a href="/questions/10457/asn1-tag-encoding-problem">ASN.1 Tag Encoding Problem</a>
        </p>
        
        <p>
            <a href="/questions/16847/lte-rrc-how-to-prepare-data">LTE RRC: how to prepare data?</a>
        </p>
        
        <p>
            <a href="/questions/25296/32298-r-960-support-on-wireshark">32.298 R 9.6.0 support on wireshark</a>
        </p>
        
        <p>
            <a href="/questions/29552/how-to-make-ansi-map-asn1-spec-compile-able-in-oss-asn1-studio">How to make ANSI MAP ASN.1 spec compile-able in OSS ASN.1 studio</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
