<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>What is the IP header checksum used for and how to calculate it? - Wireshark Q&amp;A</title>
        <meta name="description" content="Solved I have a udp packet captured through multicast channel and I found that there is a Header checksum under Internet Protocol Version 4.  I would like to ask  What is it used for? How to calculate it?  I have tried to search on the web but what I found is the check sum calculation for the whole ..." />
        <meta name="keywords" content="ip,checksum,calculate,header" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/64084/what-is-the-ip-header-checksum-used-for-and-how-to-calculate-it" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/64084/what-is-the-ip-header-checksum-used-for-and-how-to-calculate-it?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='PxK7jZMwHJ1uK3XdplK5YCOdrhTU0it7' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/64084/what-is-the-ip-header-checksum-used-for-and-how-to-calculate-it">What is the IP header checksum used for and how to calculate it?</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-64084-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/64084/up/" rel="nofollow"> </a>
<div id="post-64084-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-64084-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/64084/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/64084/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p><strong>Solved</strong><br>
I have a udp packet captured through multicast channel and I found that there is a <em>Header checksum</em> under <em>Internet Protocol Version 4</em>.<br>
<img alt="alt text" src="https://osqa-ask.wireshark.org/upfiles/temp_oDAS9cc.png"></p>
<p>I would like to ask</p>
<ol>
<li>What is it used for?</li>
<li>How to calculate it?</li>
</ol>
<p>I have tried to search on the web but what I found is the check sum calculation for the whole UDP packet which seems not the same checksum that I am asking for on the above.</p>
<p>Here is what I do for IP Header checksum:</p>
<pre><code>void ReCalculateCheckSum_IPHeader(u_char* pData)
{
    // reset checksum
    pData[24] = 0;
    pData[25] = 0;

    uint32_t unChecksum = 0;
    const uint16_t* pD16;
    pD16 = reinterpret_cast&lt;const uint16_t*&gt;(pData + CommonHelper::IP_HEADER_OFFSET);

    // adding checksum for scr IP and dst IP
    for (int i = 0; i &lt; 10; i++)
    {
        unChecksum += _byteswap_ushort(*pD16++);
    }
    while (unChecksum &gt;&gt; 16)
    {
        unChecksum = (unChecksum &amp; 0xffff) + (unChecksum &gt;&gt; 16);
    }

    // set checksum back to data
    uint16_t un16TempChecksum = static_cast&lt;uint16_t&gt;(~unChecksum);
    un16TempChecksum = _byteswap_ushort(un16TempChecksum);
    memcpy((char*)(pData + 24), &amp;un16TempChecksum, sizeof(uint16_t));
}
</code></pre>
<p>Here is what I do for the UDP checksum:</p>
<pre><code>void ReCalculateCheckSum_UDP_Pkt(u_char* pData, unsigned int unDataLen)
{
    // reset checksum
    pData[40] = 0;
    pData[41] = 0;

    uint32_t unChecksum = 0;
    const uint16_t* pD16;
    const uint8_t* pD8;
    // handle IP layer
    //      handle src IP
    pD16 = reinterpret_cast&lt;const uint16_t*&gt;(pData + 26);
    unChecksum += _byteswap_ushort(*pD16++); // since wireshark file is big-endian, but c++ in PC is little-endian
    unChecksum += _byteswap_ushort(*pD16);
    //      handle dst IP
    pD16 = reinterpret_cast&lt;const uint16_t*&gt;(pData + 30);
    unChecksum += _byteswap_ushort(*pD16++); // since wireshark file is big-endian, but c++ in PC is little-endian
    unChecksum += _byteswap_ushort(*pD16);
    //      handle portocol
    pD8 = reinterpret_cast&lt;const uint8_t*&gt;(pData + 23);
    unChecksum += *pD8;
    //      handle data lenght, from IP layer to udp data layer
    pD16 = reinterpret_cast&lt;const uint16_t*&gt;(pData + 38);
    unChecksum += _byteswap_ushort(*pD16);


    // handle UDP layer
    //      handle src Port
    pD16 = reinterpret_cast&lt;const uint16_t*&gt;(pData + 34);
    unChecksum += _byteswap_ushort(*pD16);
    //      handle dst Port
    pD16 = reinterpret_cast&lt;const uint16_t*&gt;(pData + 36);
    unChecksum += _byteswap_ushort(*pD16);
    //      handle data lenght, from IP layer to udp data layer
    pD16 = reinterpret_cast&lt;const uint16_t*&gt;(pData + 38);
    unChecksum += _byteswap_ushort(*pD16);

    // handle udp data
    size_t len = unDataLen - CommonHelper::DATAGRAME_DATA_OFFSET; // 42 is the Ethernet header
    pD16 = reinterpret_cast&lt;const uint16_t*&gt;(pData + CommonHelper::DATAGRAME_DATA_OFFSET);
    while (len &gt; 1)
    {
        unChecksum += _byteswap_ushort(*pD16++); // since wireshark file is big-endian, but c++ in PC is little-endian
        len -= sizeof(uint16_t);
    }
    if (len) // if total lenght the data is odd
    {
        unChecksum += *reinterpret_cast&lt;const uint8_t*&gt;(pD16);
    }


    while (unChecksum &gt;&gt; 16)
    {
        unChecksum = (unChecksum &amp; 0xffff) + (unChecksum &gt;&gt; 16);
    }

    // set checksum back to data
    uint16_t un16TempChecksum = static_cast&lt;uint16_t&gt;(~unChecksum);
    un16TempChecksum = _byteswap_ushort(un16TempChecksum);
    memcpy((char*)(pData + 40), &amp;un16TempChecksum, sizeof(uint16_t));
}
</code></pre>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/ip/" class="post-tag tag-link-ip"
                                        title="see questions tagged 'ip'" rel="tag">ip</a>
                                
                                    <a href="/tags/checksum/" class="post-tag tag-link-checksum"
                                        title="see questions tagged 'checksum'" rel="tag">checksum</a>
                                
                                    <a href="/tags/calculate/" class="post-tag tag-link-calculate"
                                        title="see questions tagged 'calculate'" rel="tag">calculate</a>
                                
                                    <a href="/tags/header/" class="post-tag tag-link-header"
                                        title="see questions tagged 'header'" rel="tag">header</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>22 Oct '17, 03:00</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7c0faeca14601a7e181f27988b503982?s=32&amp;d=identicon&amp;r=g" alt="SulfredLee's gravatar image" />
    <p><a href="/users/24692/sulfredlee">SulfredLee</a><br/>
    <span class="score" title="26 reputation points">26</span><span title="4 badges"><span class="badge1">&#9679;</span><span class="badgecount">4</span></span><span title="4 badges"><span class="silver">&#9679;</span><span class="badgecount">4</span></span><span title="8 badges"><span class="bronze">&#9679;</span><span class="badgecount">8</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="SulfredLee has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/64084/">
                edited
                <strong>22 Oct '17, 06:12</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/55158e2322c4e365a5e0a4a0ac3fbcef?s=32&amp;d=identicon&amp;r=g" alt="cmaynard's gravatar image" />
            <p><a href="/users/402/cmaynard">cmaynard ♦♦</a><br/>
            <span class="score" title="9361 reputation points"><span class="">9.4k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="38 badges"><span class="silver">&#9679;</span><span class="badgecount">38</span></span><span title="142 badges"><span class="bronze">&#9679;</span><span class="badgecount">142</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-64084">
    
</div>
<div id="comment-tools-64084" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-64084-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/64084/what-is-the-ip-header-checksum-used-for-and-how-to-calculate-it?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/64084/what-is-the-ip-header-checksum-used-for-and-how-to-calculate-it?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/64084/what-is-the-ip-header-checksum-used-for-and-how-to-calculate-it?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/64084/what-is-the-ip-header-checksum-used-for-and-how-to-calculate-it?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="64085"></a>
                    <div id="answer-container-64085" class="answer accepted-answer">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-64085-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/64085/up/" rel="nofollow"> </a>
<div id="post-64085-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-64085-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/64085/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="SulfredLee has selected this answer as the correct answer"
        href="/accept_answer/64085/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>The picture shows the IP header and its header checksum. The IP header checksum is used to protect it against errors, same as all the other checksums in a packet for their various parts.</p>
<p>Here's one example of how to calculate it: <a href="http://www.thegeekstuff.com/2012/05/ip-header-checksum/">http://www.thegeekstuff.com/2012/05/ip-header-checksum/</a></p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/64085/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>22 Oct '17, 03:08</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" alt="Jasper's gravatar image" />
    <p><a href="/users/145/jasper">Jasper ♦♦</a><br/>
    <span class="score" title="23806 reputation points"><span class="">23.8k</span></span><span title="5 badges"><span class="badge1">&#9679;</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">&#9679;</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">&#9679;</span><span class="badgecount">284</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Jasper has 263 accepted answers">18&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-64085">
    
        <a name="64087"></a>
        <div class="comment" id="comment-64087">
            <div id="post-64087-score" class="comment-score"></div>
            <div class="comment-text"><p>Thank you very much. It works.</p></div>
            <div class="comment-info" id="comment-64087-info">
                
                
                
                

                

                <span class="comment-age">(22 Oct '17, 05:30)</span>
                <a class="comment-user userinfo" href="/users/24692/sulfredlee">SulfredLee</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-64085" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-64085-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="64091"></a>
                    <div id="answer-container-64091" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-64091-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/64091/up/" rel="nofollow"> </a>
<div id="post-64091-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-64091-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/64091/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>To be clear, the IP Header Checksum helps protect against errors in the IP header <em>only</em>, and not with errors in the payload.  This is by design.  For further reading, refer to <a href="https://tools.ietf.org/html/rfc791">RFC 791</a> <code>INTERNET PROTOCOL</code>:</p>
<p><strong>1.4. Operation</strong></p>
<pre><code>The Header Checksum provides a verification that the information used
in processing internet datagram has been transmitted correctly.  The
data may contain errors.  If the header checksum fails, the internet
datagram is discarded at once by the entity which detects the error.
</code></pre>
<p><strong>3.1.  Internet Header Format</strong></p>
<pre><code>Header Checksum:  16 bits

  A checksum on the header only.  Since some header fields change
  (e.g., time to live), this is recomputed and verified at each point
  that the internet header is processed.

  The checksum algorithm is:

    The checksum field is the 16 bit one's complement of the one's
    complement sum of all 16 bit words in the header.  For purposes of
    computing the checksum, the value of the checksum field is zero.

  This is a simple to compute checksum and experimental evidence
  indicates it is adequate, but it is provisional and may be replaced
  by a CRC procedure, depending on further experience.
</code></pre>
<p><strong>3.2.  Discussion</strong></p>
<pre><code>Checksum

  The internet header checksum is recomputed if the internet header is
  changed.  For example, a reduction of the time to live, additions or
  changes to internet options, or due to fragmentation.  This checksum
  at the internet level is intended to protect the internet header
  fields from transmission errors.

  There are some applications where a few data bit errors are
  acceptable while retransmission delays are not.  If the internet
  protocol enforced data correctness such applications could not be
  supported.
</code></pre>
<p>For implementations of the Internet Checksum, refer to <a href="https://tools.ietf.org/html/rfc1071">RFC 1071</a> <code>Computing the Internet Checksum</code> along with its <a href="https://www.rfc-editor.org/errata_search.php?rfc=1071">Errata</a>, <a href="https://tools.ietf.org/html/rfc1141">RFC 1141</a>  <code>Incremental Updating of the Internet Checksum</code> and <a href="https://tools.ietf.org/html/rfc1624">RFC 1624</a> <code>Computation of the Internet Checksum via Incremental Update</code>, which corrects a mistake made in RFC 1141.</p>
<p>If you're interested in the UDP Checksum, refer to <a href="https://tools.ietf.org/html/rfc768">RFC 768</a> <code>User Datagram Protocol</code>, where you'll find:</p>
<pre><code>Checksum is the 16-bit one's complement of the one's complement sum of a
pseudo header of information from the IP header, the UDP header, and the
data,  padded  with zero octets  at the end (if  necessary)  to  make  a
multiple of two octets.

The pseudo  header  conceptually prefixed to the UDP header contains the
source  address,  the destination  address,  the protocol,  and the  UDP
length.   This information gives protection against misrouted datagrams.
This checksum procedure is the same as is used in TCP.

                  0      7 8     15 16    23 24    31
                 +--------+--------+--------+--------+
                 |          source address           |
                 +--------+--------+--------+--------+
                 |        destination address        |
                 +--------+--------+--------+--------+
                 |  zero  |protocol|   UDP length    |
                 +--------+--------+--------+--------+

If the computed  checksum  is zero,  it is transmitted  as all ones (the
equivalent  in one's complement  arithmetic).   An all zero  transmitted
checksum  value means that the transmitter  generated  no checksum  (for
debugging or for higher level protocols that don't care).
</code></pre>
<p>Since RFC 768 indicates that, <em>"This checksum procedure is the same as is used in TCP."</em>, you might also want to have a look at <a href="https://tools.ietf.org/html/rfc793">RFC 793</a> <code>TRANSMISSION CONTROL PROTOCOL</code>, where the Checksum field is described as follows:</p>
<pre><code>Checksum:  16 bits

  The checksum field is the 16 bit one's complement of the one's
  complement sum of all 16 bit words in the header and text.  If a
  segment contains an odd number of header and text octets to be
  checksummed, the last octet is padded on the right with zeros to
  form a 16 bit word for checksum purposes.  The pad is not
  transmitted as part of the segment.  While computing the checksum,
  the checksum field itself is replaced with zeros.

  The checksum also covers a 96 bit pseudo header conceptually
  prefixed to the TCP header.  This pseudo header contains the Source
  Address, the Destination Address, the Protocol, and TCP length.
  This gives the TCP protection against misrouted segments.  This
  information is carried in the Internet Protocol and is transferred
  across the TCP/Network interface in the arguments or results of
  calls by the TCP on the IP.

                   +--------+--------+--------+--------+
                   |           Source Address          |
                   +--------+--------+--------+--------+
                   |         Destination Address       |
                   +--------+--------+--------+--------+
                   |  zero  |  PTCL  |    TCP Length   |
                   +--------+--------+--------+--------+

    The TCP Length is the TCP header length plus the data length in
    octets (this is not an explicitly transmitted quantity, but is
    computed), and it does not count the 12 octets of the pseudo
    header.
</code></pre>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/64091/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>22 Oct '17, 07:08</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/55158e2322c4e365a5e0a4a0ac3fbcef?s=32&amp;d=identicon&amp;r=g" alt="cmaynard's gravatar image" />
    <p><a href="/users/402/cmaynard">cmaynard ♦♦</a><br/>
    <span class="score" title="9361 reputation points"><span class="">9.4k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="38 badges"><span class="silver">&#9679;</span><span class="badgecount">38</span></span><span title="142 badges"><span class="bronze">&#9679;</span><span class="badgecount">142</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="cmaynard has 108 accepted answers">20&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-64091">
    
</div>
<div id="comment-tools-64091" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-64091-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/64084/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='PxK7jZMwHJ1uK3XdplK5YCOdrhTU0it7' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/64084/what-is-the-ip-header-checksum-used-for-and-how-to-calculate-it?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/64084/what-is-the-ip-header-checksum-used-for-and-how-to-calculate-it?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/ip/"
            class="tag-link-ip"
            title="see questions tagged'ip'using tags"
            rel="tag">ip</a> <span class="tag-number">&#215;178</span><br/>
        
        <a href="/tags/header/"
            class="tag-link-header"
            title="see questions tagged'header'using tags"
            rel="tag">header</a> <span class="tag-number">&#215;40</span><br/>
        
        <a href="/tags/checksum/"
            class="tag-link-checksum"
            title="see questions tagged'checksum'using tags"
            rel="tag">checksum</a> <span class="tag-number">&#215;36</span><br/>
        
        <a href="/tags/calculate/"
            class="tag-link-calculate"
            title="see questions tagged'calculate'using tags"
            rel="tag">calculate</a> <span class="tag-number">&#215;7</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Oct. 22, 2017, 3 a.m.">22 Oct '17, 03:00</strong>
    </p>
    <p> 
     	question was seen: <strong>7,996 times</strong>
    </p>
    <p> 
        last updated: <strong title="Oct. 22, 2017, 7:08 a.m.">22 Oct '17, 07:08</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/19013/ip-checksum-offload-error">IP checksum offload error</a>
        </p>
        
        <p>
            <a href="/questions/13384/display-http-header">Display HTTP Header</a>
        </p>
        
        <p>
            <a href="/questions/36739/header-checksum-0xdfbb-validation-disabled">Header checksum: 0xdfbb [validation disabled]</a>
        </p>
        
        <p>
            <a href="/questions/19527/rtp-multiplexing-plugin">[closed] RTP Multiplexing Plugin</a>
        </p>
        
        <p>
            <a href="/questions/12958/still-getting-header-checksum-errors-after-disabling">Still getting header checksum errors after disabling</a>
        </p>
        
        <p>
            <a href="/questions/108/checksum-errors-on-windows">Checksum errors on Windows</a>
        </p>
        
        <p>
            <a href="/questions/13962/can-tcp-checksum-be-zero0">Can TCP checksum be ZERO(0)??</a>
        </p>
        
        <p>
            <a href="/questions/61627/what-is-the-reason-for-bad-checksum-should-be-0x55718ef8">what is the reason for Bad checksum [should be 0x55718ef8]</a>
        </p>
        
        <p>
            <a href="/questions/9424/libpcap-format-packet-header-incl_len-orig_len">libpcap format - packet header - incl_len / orig_len</a>
        </p>
        
        <p>
            <a href="/questions/28948/how-to-add-packettime-in-pcap-header">How to add packettime in pcap header ?</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
