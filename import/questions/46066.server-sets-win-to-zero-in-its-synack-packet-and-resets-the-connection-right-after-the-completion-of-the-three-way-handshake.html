<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>server sets win to zero in its syn+ack packet and resets the connection right after the completion of the three-way handshake - Wireshark Q&amp;A</title>
        <meta name="description" content="Hi There, I recently run into the following issue and I hope that someone can shed some light on it. Our monitoring server sends tens of HTTP requests to our Web server every minute to measure its performance. Occasionally, a couple of those requests fail to establish TCP connections. The captured p..." />
        <meta name="keywords" content="rst,syn+ack,zero-window" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/46066/server-sets-win-to-zero-in-its-synack-packet-and-resets-the-connection-right-after-the-completion-of-the-three-way-handshake" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/46066/server-sets-win-to-zero-in-its-synack-packet-and-resets-the-connection-right-after-the-completion-of-the-three-way-handshake?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='y4kliZ345hyQZrJwSVS6Bgh3NwR9VuNj' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/46066/server-sets-win-to-zero-in-its-synack-packet-and-resets-the-connection-right-after-the-completion-of-the-three-way-handshake">server sets win to zero in its syn+ack packet and resets the connection right after the completion of the three-way handshake</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-46066-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/46066/up/" rel="nofollow"> </a>
<div id="post-46066-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-46066-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/46066/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/46066/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hi There,</p>
<p>I recently run into the following issue and I hope that someone can shed some light on it.</p>
<p>Our monitoring server sends tens of HTTP requests to our Web server every minute to measure its performance. Occasionally, a couple of those requests fail to establish TCP connections. The captured packets show that the Web server sets win to zero in its syn+ack packet and resets the connection right after the completion of the three-way handshake.</p>
<p>I would love to know</p>
<p>1) What condition(s) would cause such an issue?</p>
<p>2) If the reason is that the kernel run out of some resource, is there a way to monitor its usage &amp; upper bound?</p>
<p>All comments are welcome. Many thanks in advance!</p>
<p>Below packets were captured on the client (the monitoring server)</p>
<p>15:00:56.810144000            [Cli ---&gt; Svr] SYN Seq=0 Win=8192 Len=0 MSS=1460 WS=256 SACK_PERM=1</p>
<p>15:00:56.874678000            [Svr ---&gt; Cli] SYN, ACK Seq=0 Ack=1 Win=0 Len=0 MSS=1380</p>
<p>15:00:56.874740000            [Cli ---&gt; Svr] ACK Seq=1 Ack=1 Win=64860 Len=0</p>
<p>15:00:56.939406000            [Svr ---&gt; Cli] RST Seq=1 Win=0 Len=0</p>
<p>The CPU utilization of the Web server stays below 50% all the time. According to "netstat -s", TCP CurrEstab never exceeds 80 and there are 0 ListenOverflows, 0 TCPBacklogDrop, 0 PruneCalled, 0 TCPMemoryPressures, and 0 TWRecycled.</p>
<p>The output of "sysctl -a |grep net" is as follows:</p>
<p>net.netfilter.nf_log.0 = NONE</p>
<p>net.netfilter.nf_log.1 = NONE</p>
<p>net.netfilter.nf_log.2 = NONE</p>
<p>net.netfilter.nf_log.3 = NONE</p>
<p>net.netfilter.nf_log.4 = NONE</p>
<p>net.netfilter.nf_log.5 = NONE</p>
<p>net.netfilter.nf_log.6 = NONE</p>
<p>net.netfilter.nf_log.7 = NONE</p>
<p>net.netfilter.nf_log.8 = NONE</p>
<p>net.netfilter.nf_log.9 = NONE</p>
<p>net.netfilter.nf_log.10 = NONE</p>
<p>net.netfilter.nf_log.11 = NONE</p>
<p>net.netfilter.nf_log.12 = NONE</p>
<p>net.core.somaxconn = 4096</p>
<p>net.core.xfrm_aevent_etime = 10</p>
<p>net.core.xfrm_aevent_rseqth = 2</p>
<p>net.core.xfrm_larval_drop = 1</p>
<p>net.core.xfrm_acq_expires = 30</p>
<p>net.core.wmem_max = 4194304</p>
<p>net.core.rmem_max = 4194304</p>
<p>net.core.wmem_default = 124928</p>
<p>net.core.rmem_default = 124928</p>
<p>net.core.dev_weight = 64</p>
<p>net.core.netdev_max_backlog = 1000</p>
<p>net.core.message_cost = 5</p>
<p>net.core.message_burst = 10</p>
<p>net.core.optmem_max = 20480</p>
<p>net.core.rps_sock_flow_entries = 0</p>
<p>net.core.busy_poll = 0</p>
<p>net.core.busy_read = 0</p>
<p>net.core.netdev_budget = 300</p>
<p>net.core.warnings = 1</p>
<p>net.ipv4.route.gc_thresh = 524288</p>
<p>net.ipv4.route.max_size = 8388608</p>
<p>net.ipv4.route.gc_min_interval = 0</p>
<p>net.ipv4.route.gc_min_interval_ms = 500</p>
<p>net.ipv4.route.gc_timeout = 300</p>
<p>net.ipv4.route.gc_interval = 60</p>
<p>net.ipv4.route.redirect_load = 20</p>
<p>net.ipv4.route.redirect_number = 9</p>
<p>net.ipv4.route.redirect_silence = 20480</p>
<p>net.ipv4.route.error_cost = 1000</p>
<p>net.ipv4.route.error_burst = 5000</p>
<p>net.ipv4.route.gc_elasticity = 8</p>
<p>net.ipv4.route.mtu_expires = 600</p>
<p>net.ipv4.route.min_pmtu = 552</p>
<p>net.ipv4.route.min_adv_mss = 256</p>
<p>net.ipv4.route.secret_interval = 600</p>
<p>net.ipv4.neigh.default.mcast_solicit = 3</p>
<p>net.ipv4.neigh.default.ucast_solicit = 3</p>
<p>net.ipv4.neigh.default.app_solicit = 0</p>
<p>net.ipv4.neigh.default.retrans_time = 99</p>
<p>net.ipv4.neigh.default.base_reachable_time = 30</p>
<p>net.ipv4.neigh.default.delay_first_probe_time = 5</p>
<p>net.ipv4.neigh.default.gc_stale_time = 60</p>
<p>net.ipv4.neigh.default.unres_qlen = 3</p>
<p>net.ipv4.neigh.default.proxy_qlen = 64</p>
<p>net.ipv4.neigh.default.anycast_delay = 99</p>
<p>net.ipv4.neigh.default.proxy_delay = 79</p>
<p>net.ipv4.neigh.default.locktime = 99</p>
<p>net.ipv4.neigh.default.retrans_time_ms = 1000</p>
<p>net.ipv4.neigh.default.base_reachable_time_ms = 30000</p>
<p>net.ipv4.neigh.default.gc_interval = 30</p>
<p>net.ipv4.neigh.default.gc_thresh1 = 128</p>
<p>net.ipv4.neigh.default.gc_thresh2 = 512</p>
<p>net.ipv4.neigh.default.gc_thresh3 = 1024</p>
<p>net.ipv4.neigh.lo.mcast_solicit = 3</p>
<p>net.ipv4.neigh.lo.ucast_solicit = 3</p>
<p>net.ipv4.neigh.lo.app_solicit = 0</p>
<p>net.ipv4.neigh.lo.retrans_time = 99</p>
<p>net.ipv4.neigh.lo.base_reachable_time = 30</p>
<p>net.ipv4.neigh.lo.delay_first_probe_time = 5</p>
<p>net.ipv4.neigh.lo.gc_stale_time = 60</p>
<p>net.ipv4.neigh.lo.unres_qlen = 3</p>
<p>net.ipv4.neigh.lo.proxy_qlen = 64</p>
<p>net.ipv4.neigh.lo.anycast_delay = 99</p>
<p>net.ipv4.neigh.lo.proxy_delay = 79</p>
<p>net.ipv4.neigh.lo.locktime = 99</p>
<p>net.ipv4.neigh.lo.retrans_time_ms = 1000</p>
<p>net.ipv4.neigh.lo.base_reachable_time_ms = 30000</p>
<p>net.ipv4.neigh.eth0.mcast_solicit = 3</p>
<p>net.ipv4.neigh.eth0.ucast_solicit = 3</p>
<p>net.ipv4.neigh.eth0.app_solicit = 0</p>
<p>net.ipv4.neigh.eth0.retrans_time = 99</p>
<p>net.ipv4.neigh.eth0.base_reachable_time = 30</p>
<p>net.ipv4.neigh.eth0.delay_first_probe_time = 5</p>
<p>net.ipv4.neigh.eth0.gc_stale_time = 60</p>
<p>net.ipv4.neigh.eth0.unres_qlen = 3</p>
<p>net.ipv4.neigh.eth0.proxy_qlen = 64</p>
<p>net.ipv4.neigh.eth0.anycast_delay = 99</p>
<p>net.ipv4.neigh.eth0.proxy_delay = 79</p>
<p>net.ipv4.neigh.eth0.locktime = 99</p>
<p>net.ipv4.neigh.eth0.retrans_time_ms = 1000</p>
<p>net.ipv4.neigh.eth0.base_reachable_time_ms = 30000</p>
<p>net.ipv4.tcp_timestamps = 1</p>
<p>net.ipv4.tcp_window_scaling = 1</p>
<p>net.ipv4.tcp_sack = 1</p>
<p>net.ipv4.tcp_retrans_collapse = 1</p>
<p>net.ipv4.ip_default_ttl = 64</p>
<p>net.ipv4.ip_no_pmtu_disc = 0</p>
<p>net.ipv4.ip_nonlocal_bind = 0</p>
<p>net.ipv4.tcp_syn_retries = 5</p>
<p>net.ipv4.tcp_synack_retries = 5</p>
<p>net.ipv4.tcp_max_orphans = 262144</p>
<p>net.ipv4.tcp_max_tw_buckets = 1440000</p>
<p>net.ipv4.ip_dynaddr = 0</p>
<p>net.ipv4.tcp_keepalive_time = 1800</p>
<p>net.ipv4.tcp_keepalive_probes = 9</p>
<p>net.ipv4.tcp_keepalive_intvl = 75</p>
<p>net.ipv4.tcp_retries1 = 3</p>
<p>net.ipv4.tcp_retries2 = 15</p>
<p>net.ipv4.tcp_fin_timeout = 15</p>
<p>net.ipv4.tcp_syncookies = 1</p>
<p>net.ipv4.tcp_tw_recycle = 0</p>
<p>net.ipv4.tcp_abort_on_overflow = 0</p>
<p>net.ipv4.tcp_stdurg = 0</p>
<p>net.ipv4.tcp_rfc1337 = 0</p>
<p>net.ipv4.tcp_max_syn_backlog = 4096</p>
<p>net.ipv4.ip_local_port_range = 16384    61000</p>
<p>net.ipv4.ip_local_reserved_ports = </p>
<p>net.ipv4.igmp_max_memberships = 20</p>
<p>net.ipv4.igmp_max_msf = 10</p>
<p>net.ipv4.inet_peer_threshold = 65664</p>
<p>net.ipv4.inet_peer_minttl = 120</p>
<p>net.ipv4.inet_peer_maxttl = 600</p>
<p>net.ipv4.inet_peer_gc_mintime = 10</p>
<p>net.ipv4.inet_peer_gc_maxtime = 120</p>
<p>net.ipv4.tcp_orphan_retries = 0</p>
<p>net.ipv4.tcp_fack = 1</p>
<p>net.ipv4.tcp_reordering = 3</p>
<p>net.ipv4.tcp_ecn = 2</p>
<p>net.ipv4.tcp_dsack = 1</p>
<p>net.ipv4.tcp_mem = 1141728  1522304 2283456</p>
<p>net.ipv4.tcp_wmem = 4096    16384   4194304</p>
<p>net.ipv4.tcp_rmem = 4096    87380   4194304</p>
<p>net.ipv4.tcp_app_win = 31</p>
<p>net.ipv4.tcp_adv_win_scale = 2</p>
<p>net.ipv4.tcp_tw_reuse = 1</p>
<p>net.ipv4.tcp_frto = 2</p>
<p>net.ipv4.tcp_frto_response = 0</p>
<p>net.ipv4.tcp_low_latency = 0</p>
<p>net.ipv4.tcp_no_metrics_save = 0</p>
<p>net.ipv4.tcp_moderate_rcvbuf = 1</p>
<p>net.ipv4.tcp_tso_win_divisor = 3</p>
<p>net.ipv4.tcp_congestion_control = cubic</p>
<p>net.ipv4.tcp_abc = 0</p>
<p>net.ipv4.tcp_mtu_probing = 0</p>
<p>net.ipv4.tcp_base_mss = 512</p>
<p>net.ipv4.tcp_workaround_signed_windows = 0</p>
<p>net.ipv4.tcp_challenge_ack_limit = 100</p>
<p>net.ipv4.tcp_limit_output_bytes = 131072</p>
<p>net.ipv4.tcp_dma_copybreak = 4096</p>
<p>net.ipv4.tcp_slow_start_after_idle = 1</p>
<p>net.ipv4.cipso_cache_enable = 1</p>
<p>net.ipv4.cipso_cache_bucket_size = 10</p>
<p>net.ipv4.cipso_rbm_optfmt = 0</p>
<p>net.ipv4.cipso_rbm_strictvalid = 1</p>
<p>net.ipv4.tcp_available_congestion_control = cubic reno</p>
<p>net.ipv4.tcp_allowed_congestion_control = cubic reno</p>
<p>net.ipv4.tcp_max_ssthresh = 0</p>
<p>net.ipv4.tcp_thin_linear_timeouts = 0</p>
<p>net.ipv4.tcp_thin_dupack = 0</p>
<p>net.ipv4.tcp_min_tso_segs = 2</p>
<p>net.ipv4.udp_mem = 1141728  1522304 2283456</p>
<p>net.ipv4.udp_rmem_min = 4096</p>
<p>net.ipv4.udp_wmem_min = 4096</p>
<p>net.ipv4.conf.all.forwarding = 0</p>
<p>net.ipv4.conf.all.mc_forwarding = 0</p>
<p>net.ipv4.conf.all.accept_redirects = 0</p>
<p>net.ipv4.conf.all.secure_redirects = 0</p>
<p>net.ipv4.conf.all.shared_media = 1</p>
<p>net.ipv4.conf.all.rp_filter = 0</p>
<p>net.ipv4.conf.all.send_redirects = 0</p>
<p>net.ipv4.conf.all.accept_source_route = 0</p>
<p>net.ipv4.conf.all.src_valid_mark = 0</p>
<p>net.ipv4.conf.all.proxy_arp = 0</p>
<p>net.ipv4.conf.all.medium_id = 0</p>
<p>net.ipv4.conf.all.bootp_relay = 0</p>
<p>net.ipv4.conf.all.log_martians = 0</p>
<p>net.ipv4.conf.all.tag = 0</p>
<p>net.ipv4.conf.all.arp_filter = 0</p>
<p>net.ipv4.conf.all.arp_announce = 0</p>
<p>net.ipv4.conf.all.arp_ignore = 0</p>
<p>net.ipv4.conf.all.arp_accept = 0</p>
<p>net.ipv4.conf.all.arp_notify = 0</p>
<p>net.ipv4.conf.all.proxy_arp_pvlan = 0</p>
<p>net.ipv4.conf.all.disable_xfrm = 0</p>
<p>net.ipv4.conf.all.disable_policy = 0</p>
<p>net.ipv4.conf.all.force_igmp_version = 0</p>
<p>net.ipv4.conf.all.promote_secondaries = 0</p>
<p>net.ipv4.conf.all.accept_local = 0</p>
<p>net.ipv4.conf.all.route_localnet = 0</p>
<p>net.ipv4.conf.default.forwarding = 0</p>
<p>net.ipv4.conf.default.mc_forwarding = 0</p>
<p>net.ipv4.conf.default.accept_redirects = 0</p>
<p>net.ipv4.conf.default.secure_redirects = 0</p>
<p>net.ipv4.conf.default.shared_media = 1</p>
<p>net.ipv4.conf.default.rp_filter = 0</p>
<p>net.ipv4.conf.default.send_redirects = 0</p>
<p>net.ipv4.conf.default.accept_source_route = 0</p>
<p>net.ipv4.conf.default.src_valid_mark = 0</p>
<p>net.ipv4.conf.default.proxy_arp = 0</p>
<p>net.ipv4.conf.default.medium_id = 0</p>
<p>net.ipv4.conf.default.bootp_relay = 0</p>
<p>net.ipv4.conf.default.log_martians = 0</p>
<p>net.ipv4.conf.default.tag = 0</p>
<p>net.ipv4.conf.default.arp_filter = 0</p>
<p>net.ipv4.conf.default.arp_announce = 0</p>
<p>net.ipv4.conf.default.arp_ignore = 0</p>
<p>net.ipv4.conf.default.arp_accept = 0</p>
<p>net.ipv4.conf.default.arp_notify = 0</p>
<p>net.ipv4.conf.default.proxy_arp_pvlan = 0</p>
<p>net.ipv4.conf.default.disable_xfrm = 0</p>
<p>net.ipv4.conf.default.disable_policy = 0</p>
<p>net.ipv4.conf.default.force_igmp_version = 0</p>
<p>net.ipv4.conf.default.promote_secondaries = 0</p>
<p>net.ipv4.conf.default.accept_local = 0</p>
<p>net.ipv4.conf.default.route_localnet = 0</p>
<p>net.ipv4.conf.lo.forwarding = 0</p>
<p>net.ipv4.conf.lo.mc_forwarding = 0</p>
<p>net.ipv4.conf.lo.accept_redirects = 0</p>
<p>net.ipv4.conf.lo.secure_redirects = 1</p>
<p>net.ipv4.conf.lo.shared_media = 1</p>
<p>net.ipv4.conf.lo.rp_filter = 1</p>
<p>net.ipv4.conf.lo.send_redirects = 1</p>
<p>net.ipv4.conf.lo.accept_source_route = 0</p>
<p>net.ipv4.conf.lo.src_valid_mark = 0</p>
<p>net.ipv4.conf.lo.proxy_arp = 0</p>
<p>net.ipv4.conf.lo.medium_id = 0</p>
<p>net.ipv4.conf.lo.bootp_relay = 0</p>
<p>net.ipv4.conf.lo.log_martians = 0</p>
<p>net.ipv4.conf.lo.tag = 0</p>
<p>net.ipv4.conf.lo.arp_filter = 0</p>
<p>net.ipv4.conf.lo.arp_announce = 0</p>
<p>net.ipv4.conf.lo.arp_ignore = 0</p>
<p>net.ipv4.conf.lo.arp_accept = 0</p>
<p>net.ipv4.conf.lo.arp_notify = 0</p>
<p>net.ipv4.conf.lo.proxy_arp_pvlan = 0</p>
<p>net.ipv4.conf.lo.disable_xfrm = 1</p>
<p>net.ipv4.conf.lo.disable_policy = 1</p>
<p>net.ipv4.conf.lo.force_igmp_version = 0</p>
<p>net.ipv4.conf.lo.promote_secondaries = 0</p>
<p>net.ipv4.conf.lo.accept_local = 0</p>
<p>net.ipv4.conf.lo.route_localnet = 0</p>
<p>net.ipv4.conf.eth0.forwarding = 0</p>
<p>net.ipv4.conf.eth0.mc_forwarding = 0</p>
<p>net.ipv4.conf.eth0.accept_redirects = 0</p>
<p>net.ipv4.conf.eth0.secure_redirects = 0</p>
<p>net.ipv4.conf.eth0.shared_media = 1</p>
<p>net.ipv4.conf.eth0.rp_filter = 0</p>
<p>net.ipv4.conf.eth0.send_redirects = 0</p>
<p>net.ipv4.conf.eth0.accept_source_route = 0</p>
<p>net.ipv4.conf.eth0.src_valid_mark = 0</p>
<p>net.ipv4.conf.eth0.proxy_arp = 0</p>
<p>net.ipv4.conf.eth0.medium_id = 0</p>
<p>net.ipv4.conf.eth0.bootp_relay = 0</p>
<p>net.ipv4.conf.eth0.log_martians = 0</p>
<p>net.ipv4.conf.eth0.tag = 0</p>
<p>net.ipv4.conf.eth0.arp_filter = 0</p>
<p>net.ipv4.conf.eth0.arp_announce = 0</p>
<p>net.ipv4.conf.eth0.arp_ignore = 0</p>
<p>net.ipv4.conf.eth0.arp_accept = 0</p>
<p>net.ipv4.conf.eth0.arp_notify = 0</p>
<p>net.ipv4.conf.eth0.proxy_arp_pvlan = 0</p>
<p>net.ipv4.conf.eth0.disable_xfrm = 0</p>
<p>net.ipv4.conf.eth0.disable_policy = 0</p>
<p>net.ipv4.conf.eth0.force_igmp_version = 0</p>
<p>net.ipv4.conf.eth0.promote_secondaries = 0</p>
<p>net.ipv4.conf.eth0.accept_local = 0</p>
<p>net.ipv4.conf.eth0.route_localnet = 0</p>
<p>net.ipv4.ip_forward = 0</p>
<p>net.ipv4.xfrm4_gc_thresh = 4194304</p>
<p>net.ipv4.ipfrag_high_thresh = 4194304</p>
<p>net.ipv4.ipfrag_low_thresh = 3145728</p>
<p>net.ipv4.ipfrag_time = 30</p>
<p>net.ipv4.icmp_echo_ignore_all = 0</p>
<p>net.ipv4.icmp_echo_ignore_broadcasts = 1</p>
<p>net.ipv4.icmp_ignore_bogus_error_responses = 1</p>
<p>net.ipv4.icmp_errors_use_inbound_ifaddr = 0</p>
<p>net.ipv4.icmp_ratelimit = 1000</p>
<p>net.ipv4.icmp_ratemask = 6168</p>
<p>net.ipv4.rt_cache_rebuild_count = 4</p>
<p>net.ipv4.ping_group_range = 1   0</p>
<p>net.ipv4.ipfrag_secret_interval = 600</p>
<p>net.ipv4.ipfrag_max_dist = 64</p>
<p>net.unix.max_dgram_qlen = 10</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/rst/" class="post-tag tag-link-rst"
                                        title="see questions tagged 'rst'" rel="tag">rst</a>
                                
                                    <a href="/tags/syn%252Back/" class="post-tag tag-link-syn+ack"
                                        title="see questions tagged 'syn+ack'" rel="tag">syn+ack</a>
                                
                                    <a href="/tags/zero-window/" class="post-tag tag-link-zero-window"
                                        title="see questions tagged 'zero-window'" rel="tag">zero-window</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>22 Sep '15, 12:38</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/083b3e62968211b9f8af32b9431b502a?s=32&amp;d=identicon&amp;r=g" alt="kemaru's gravatar image" />
    <p><a href="/users/19785/kemaru">kemaru</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">&#9679;</span><span class="badgecount">2</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="kemaru has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-46066">
    
</div>
<div id="comment-tools-46066" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-46066-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/46066/server-sets-win-to-zero-in-its-synack-packet-and-resets-the-connection-right-after-the-completion-of-the-three-way-handshake?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/46066/server-sets-win-to-zero-in-its-synack-packet-and-resets-the-connection-right-after-the-completion-of-the-three-way-handshake?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/46066/server-sets-win-to-zero-in-its-synack-packet-and-resets-the-connection-right-after-the-completion-of-the-three-way-handshake?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/46066/server-sets-win-to-zero-in-its-synack-packet-and-resets-the-connection-right-after-the-completion-of-the-three-way-handshake?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="46127"></a>
                    <div id="answer-container-46127" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-46127-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/46127/up/" rel="nofollow"> </a>
<div id="post-46127-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-46127-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/46127/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p><em>Usually</em> if the kernel hits some resource issue, you would see unanswered SYNs (though that is not always true).<br>
</p>
<p>At first glance, it may be that syn cookies are kicking in and the server is not getting a valid response in that ACK packet.</p>
<p>In your netstat -s output, there should be a line item for "invalid SYN cookies received."  You <em>may</em> want to check that as the problem occurs to see if that is what you are hitting.  If you suspect that, you may want to grab another capture and turn of "Relative Sequence Numbers" to aid in analysis of the client response.</p>
<p>If you suspect that invalid syn cookie responses is the issue, another quick way to check for that issue would be to set net.ipv4.tcp_syncookies = 0.  (I don't recall, off-hand, if that requires a system restart)</p>
<p>$0.02</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/46127/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>24 Sep '15, 15:00</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/ad02d2c94bb362339b32ac9e2ca8468e?s=32&amp;d=identicon&amp;r=g" alt="Qwert's gravatar image" />
    <p><a href="/users/5893/qwert">Qwert</a><br/>
    <span class="score" title="16 reputation points">16</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="6 badges"><span class="bronze">&#9679;</span><span class="badgecount">6</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Qwert has no accepted answers">0&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-46127">
    
</div>
<div id="comment-tools-46127" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-46127-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/46066/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='y4kliZ345hyQZrJwSVS6Bgh3NwR9VuNj' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/46066/server-sets-win-to-zero-in-its-synack-packet-and-resets-the-connection-right-after-the-completion-of-the-three-way-handshake?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/46066/server-sets-win-to-zero-in-its-synack-packet-and-resets-the-connection-right-after-the-completion-of-the-three-way-handshake?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/rst/"
            class="tag-link-rst"
            title="see questions tagged'rst'using tags"
            rel="tag">rst</a> <span class="tag-number">&#215;81</span><br/>
        
        <a href="/tags/zero-window/"
            class="tag-link-zero-window"
            title="see questions tagged'zero-window'using tags"
            rel="tag">zero-window</a> <span class="tag-number">&#215;19</span><br/>
        
        <a href="/tags/syn%252Back/"
            class="tag-link-syn+ack"
            title="see questions tagged'syn+ack'using tags"
            rel="tag">syn+ack</a> <span class="tag-number">&#215;10</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Sept. 22, 2015, 12:38 p.m.">22 Sep '15, 12:38</strong>
    </p>
    <p> 
     	question was seen: <strong>2,457 times</strong>
    </p>
    <p> 
        last updated: <strong title="Sept. 24, 2015, 3 p.m.">24 Sep '15, 15:00</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/6872/zero-window-and-rst">Zero window and RST</a>
        </p>
        
        <p>
            <a href="/questions/54348/rst-after-syn-synack">RST after SYN -&gt; SYN/ACK</a>
        </p>
        
        <p>
            <a href="/questions/348/credit-card-transactions-experience-multiple-declines-why">Credit card transactions experience multiple declines. Why?</a>
        </p>
        
        <p>
            <a href="/questions/13461/server-unable-to-access-websites-http-or-https-from-a-windows-server">Server unable to access websites (HTTP or HTTPS) from a windows server</a>
        </p>
        
        <p>
            <a href="/questions/23885/rst-after-syn-ack">RST after SYN-ACK</a>
        </p>
        
        <p>
            <a href="/questions/35478/telnet-to-a-opened-port-get-rst-ack-responce">Telnet to a opened port, get [RST, ACK] responce</a>
        </p>
        
        <p>
            <a href="/questions/55362/remote-desktop-not-connecting">Remote Desktop not connecting</a>
        </p>
        
        <p>
            <a href="/questions/3101/communication-between-two-servers-fails-with-large-data-not-too-large">communication between two servers fails with large data (not too large)</a>
        </p>
        
        <p>
            <a href="/questions/61632/window-size-0-in-tcp-syn">Window Size = 0 in TCP SYN</a>
        </p>
        
        <p>
            <a href="/questions/1408/rst-tracing">RST - tracing</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
