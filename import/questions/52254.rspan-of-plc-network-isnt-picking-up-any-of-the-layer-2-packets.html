<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>RSPAN of PLC network isn&#39;t picking up any of the Layer 2 packets ... - Wireshark Q&amp;A</title>
        <meta name="description" content="I have an RSPAN setup on a network with limited resources on the switches. Monitoring both ports and vlans however I&#39;m only seeing Layer 3 packet info and some Layer 2 Mac,vendor and NIC info. None of the data that has Modbus/TCP,DNP3,Ethernet/IP (not regular IP info) ...etc. Is this because I&#39;m don..." />
        <meta name="keywords" content="span,vlan,plc,capture" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/52254/rspan-of-plc-network-isnt-picking-up-any-of-the-layer-2-packets" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/52254/rspan-of-plc-network-isnt-picking-up-any-of-the-layer-2-packets?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='zhhU5YFrEptyfXD9d8lNUlR6UBYZdcaV' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/52254/rspan-of-plc-network-isnt-picking-up-any-of-the-layer-2-packets">RSPAN of PLC network isn&#39;t picking up any of the Layer 2 packets ...</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-52254-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/52254/up/" rel="nofollow"> </a>
<div id="post-52254-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-52254-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/52254/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/52254/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>I have an RSPAN setup on a network with limited resources on the switches. Monitoring both ports and vlans however I'm only seeing Layer 3 packet info and some Layer 2 Mac,vendor and NIC info. None of the data that has Modbus/TCP,DNP3,Ethernet/IP (not regular IP info) ...etc.</p>
<p>Is this because I'm don't have any sensors on the actual access switch? </p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/span/" class="post-tag tag-link-span"
                                        title="see questions tagged 'span'" rel="tag">span</a>
                                
                                    <a href="/tags/vlan/" class="post-tag tag-link-vlan"
                                        title="see questions tagged 'vlan'" rel="tag">vlan</a>
                                
                                    <a href="/tags/plc/" class="post-tag tag-link-plc"
                                        title="see questions tagged 'plc'" rel="tag">plc</a>
                                
                                    <a href="/tags/capture/" class="post-tag tag-link-capture"
                                        title="see questions tagged 'capture'" rel="tag">capture</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>05 May '16, 10:54</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7dc1fee5b4e29c4e6cc3d5059312aac7?s=32&amp;d=identicon&amp;r=g" alt="msmorten's gravatar image" />
    <p><a href="/users/23174/msmorten">msmorten</a><br/>
    <span class="score" title="4 reputation points">4</span><span title="5 badges"><span class="badge1">&#9679;</span><span class="badgecount">5</span></span><span title="5 badges"><span class="silver">&#9679;</span><span class="badgecount">5</span></span><span title="8 badges"><span class="bronze">&#9679;</span><span class="badgecount">8</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="msmorten has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-52254">
    
        <a name="52257"></a>
        <div class="comment" id="comment-52257">
            <div id="post-52257-score" class="comment-score"></div>
            <div class="comment-text"><p>What does the network equipment supplier say? Does it have any forums?</p></div>
            <div class="comment-info" id="comment-52257-info">
                
                
                
                

                

                <span class="comment-age">(05 May '16, 11:23)</span>
                <a class="comment-user userinfo" href="/users/4/jaap">Jaap ♦</a>
                
            </div>
        </div>
    
        <a name="52259"></a>
        <div class="comment" id="comment-52259">
            <div id="post-52259-score" class="comment-score"></div>
            <div class="comment-text"><p>The network equipment vendor is Cisco. SPAN'ing mostly 2950/2960 switches and the core is a 3850..
Based on this I should be able to get the PLC protocol packets.</p></div>
            <div class="comment-info" id="comment-52259-info">
                
                
                
                

                

                <span class="comment-age">(05 May '16, 11:32)</span>
                <a class="comment-user userinfo" href="/users/23174/msmorten">msmorten</a>
                
            </div>
        </div>
    
        <a name="52262"></a>
        <div class="comment" id="comment-52262">
            <div id="post-52262-score" class="comment-score"></div>
            <div class="comment-text"><p>The "access switch" to which no sensor is connected is Cisco?</p>

<p>The port/VLAN monitoring on a switch will only show you a copy of traffic which passes through that switch. The Modbus/TCP etc. packets can only start to flow after the ARP protocol has done its job, i.e. to inform the sender about the MAC address of the recipient. So if your controller is configured to query some sensors but these sensors aren't connected, it won't send the queries until it learns where it should send them.</p>

<p>Can you be more precise about the overall topology?</p></div>
            <div class="comment-info" id="comment-52262-info">
                
                
                
                

                

                <span class="comment-age">(05 May '16, 11:58)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="52264"></a>
        <div class="comment" id="comment-52264">
            <div id="post-52264-score" class="comment-score"></div>
            <div class="comment-text"><p>cisco core 3560 sw ------ Cisco 2960 Distribution stack ------ Cisco 2950 access switch ( this has the PLCs connected, Sieman and Rockwell).</p>

<p>My sensor is connected to the core and using RSPAN to monitor the ports on the access switch. After getting a longer pcap, i did notice ENIP packets coming from the monitoring on the access switch, but that is all. I expected to see Modbus/TCP and a number of other PLC protocols coming from the ports that I'm monitoring on the access switch, but there aren't any additional portocol. I thought this could be because I don't have my sensor directly connected to the access thus not able to see more detailed, Layer 2 protocols coming from my PLC(s).</p></div>
            <div class="comment-info" id="comment-52264-info">
                
                
                
                

                

                <span class="comment-age">(05 May '16, 12:44)</span>
                <a class="comment-user userinfo" href="/users/23174/msmorten">msmorten</a>
                
            </div>
        </div>
    
        <a name="52265"></a>
        <div class="comment" id="comment-52265">
            <div id="post-52265-score" class="comment-score"></div>
            <div class="comment-text"><p>Off topic: could you spend 5 seconds of your time to finally realize the difference between an Answer to the original Question and an answer to a previous comment, and stop posting the latter as the former?</p>

<p>Sorry, I've misunderstood the role of your "sensor"; I thought the PLC communicates with the sensor using the protocols you hunt for.</p>

<p>As "sensor" means the capturing machine, I'd ask you about your capture settings. While Wireshark captures whole packets by default, e.g. tcpdump doesn't - unless you specify that you want the packets complete (using <code>-s 0</code> command line option, where 0 means "unlimited"), only first 60 bytes or so are captured, which is just enough to see the transport layers. You can set Wireshark to capture only the beginning of packets too, but it is not the default setting.</p>

<p>If you apply a display filter <code>!(frame.cap_len == frame.len)</code> on your existing capture, do any packets remain in the packet list? If yes, it means that this is the reason.</p></div>
            <div class="comment-info" id="comment-52265-info">
                
                
                
                

                

                <span class="comment-age">(05 May '16, 13:02)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="52266"></a>
        <div class="comment not_top_scorer" id="comment-52266">
            <div id="post-52266-score" class="comment-score"></div>
            <div class="comment-text"><p>I am using Wireshark to perform my captures, I am also using a proprietary program that gathers data from the RSPAN on the switch(s). Neither wireshark nor the software analyzing information directly from the RSPAN is picking up any other protocols than ENIP traffic in regards to the PLC(s) conversations. Where the software is looking for various PLC protocols. So this makes me think that the monitored ports at the access switch isn't sending the data back to the core where the sensor (data collecting PC) is setup. I am using RSPAN and a RSPAN vlan to get the mirrored traffic from the access switch to the core switch. I assume that the layer2 information is staying with the access switch and not getting to the sensor being sent over a RSPAN vlan. </p>

<p>I will give the filter a try. does it need to be applied in the desktop program or is this something I can run from the CLI using "tshark" or "tcpdump"?</p>

<p>The PLC doesn't communicate with the Sensor. the Sensor is collecting the mirrored traffic from the SPAN on the access switch. The sensor has discovered the PLC based on its conversation, but the PLC has no knowledge of the sensor. Sensor=Tap in this scenario.</p></div>
            <div class="comment-info" id="comment-52266-info">
                
                
                
                

                

                <span class="comment-age">(05 May '16, 13:15)</span>
                <a class="comment-user userinfo" href="/users/23174/msmorten">msmorten</a>
                
            </div>
        </div>
    
        <a name="52267"></a>
        <div class="comment not_top_scorer" id="comment-52267">
            <div id="post-52267-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>does it need to be applied in the desktop program or is this something I can run from the CLI using "tshark" or "tcpdump"?</p>
</blockquote>

<p>You can run <code>tshark -r your_existing_capture -Y "!(frame.cap_len == frame.len)"</code>, if any packets get printed, the capture size issue exists. </p>

<p>Otherwise:</p>

<p>I don't understand what you mean by "the layer2 information is staying with the access switch"? Does it mean that the part of each frame which contains the L2 information is missing, or that frames which only contain L2 information are not delivered to the sensor?</p>

<p>Normally, you configure the access switch to mirror the source (ports or VLAN) and send a copy of <em>each</em> frame to the RSPAN VLAN, and the monitoring port on the core switch forwards all these frames to the equipment connected to it. So if you can see some unicast frames in the capture, you should see all of them, otherwise it is an issue of the RSPAN implementation (or, less likely, configuration). Is the VLAN in the 2960 configured to RSPAN mode? If not, it may drop the frames, but again - if this should be the reason, I'd expect it to drop <em>all</em> unicast frames, not just some of them.</p>

<p>See requirements on the configuration at the intermediate switch (the 2960 in your case) <a href="http://www.cisco.com/c/en/us/td/docs/switches/lan/catalyst2960/software/release/12-2_40_se/configuration/guide/scg/swspan.pdf#G1200730">here</a>.</p></div>
            <div class="comment-info" id="comment-52267-info">
                
                
                
                

                

                <span class="comment-age">(05 May '16, 13:39)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="52268"></a>
        <div class="comment not_top_scorer" id="comment-52268">
            <div id="post-52268-score" class="comment-score"></div>
            <div class="comment-text"><p>If by "L2 information" you mean the 802.1Q tags, then yes, using RSPAN causes the 802.1Q tags from the source VLAN to be replaced by those of the RSPAN VLAN and later stripped at the RSPAN output port, so your sensor gets the frames without tags. But source and destination MAC addresses must be there.</p></div>
            <div class="comment-info" id="comment-52268-info">
                
                
                
                

                

                <span class="comment-age">(05 May '16, 13:49)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="52269"></a>
        <div class="comment not_top_scorer" id="comment-52269">
            <div id="post-52269-score" class="comment-score"></div>
            <div class="comment-text"><p>The PLC(s) aren't communicating with the sensor. The sensor is a PC I have setup, connected to the core switch. It runs linux and is basically running a proprietary software that analyzes the mirrored traffic. The sensor has discovered the PLC only thru the conversations happening on the mirrored ports or traffic captured on monitored vlan(s). The Sensor I have setup is actually looking for those additional PLC protocols, but if I use tshark to create a pcap of the RSPAN mirrored traffic. The only PLC related protocol is ENIP, where i was really hoping to see more like Modbus or DNP3. I was under the impression that PLC primarily used those protocols and not IP. So, I've come to the conclusion that this lower level data MODBUS, DNP3,...etc must stay on the access switch and isn't carried over the RSPAN VLAN that is analyzed at the core.</p></div>
            <div class="comment-info" id="comment-52269-info">
                
                
                
                

                

                <span class="comment-age">(05 May '16, 14:24)</span>
                <a class="comment-user userinfo" href="/users/23174/msmorten">msmorten</a>
                
            </div>
        </div>
    
        <a name="52273"></a>
        <div class="comment not_top_scorer" id="comment-52273">
            <div id="post-52273-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes, I've already understood the role of the sensor a couple of comments ago :-) What I was trying to say was that both tcpdump and tshark use the same libpcap (on linux) and as such do not themselves filter the received frames by protocols used (unless you ask them to do so, which you hopefully don't) while capturing them.</p>

<p>So if some of the expected frames are missing in the capture, they must</p>

<ul>
<li>
<p>be missing at the source (i.e. the PLCs actually do not use those protocols),</p>
</li>
<li>
<p>be filtered out on their way from the RSPAN source switch (the "access" 2950) to the RSPAN destination (the "core" 3850)</p>
</li>
<li>
<p>be filtered out by the sensor's network card.</p>
</li>
</ul>

<p>Some switches do have the possibility to filter frames by the "type" field of the ethernet header, but such filtering would normally occur regardless the monitoring, so if this would be the cause, the PLCs would not be able to communicate normally. Plus Modbus/TCP uses normal IP ethertype so it is not a likely reason.</p>

<p>To find out what actually happens:</p>

<ul>
<li>
<p>can you temporarily move your sensor machine next to the "access" switch and check what you capture if you set up a plain SPAN on that switch, instead of RSPAN?</p>
</li>
<li>
<p>if the above gives the same results as you get now, can you use two NICs on the sensor PC (i.e. to add one if necessary), set up a software bridge between them, and "insert" the sensor between one of the PLCs and the access switch? This way, you'll be sure that the NIC gets the complete traffic of the PLC. If the NIC (or its driver) blocks some Ethernet types (modbus), the PLC would complain; if it doesn't, you should capture everything that the PLC really sends and receives.</p>
</li>
</ul></div>
            <div class="comment-info" id="comment-52273-info">
                
                
                
                

                

                <span class="comment-age">(05 May '16, 23:43)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="52349"></a>
        <div class="comment not_top_scorer" id="comment-52349">
            <div id="post-52349-score" class="comment-score"></div>
            <div class="comment-text"><p><strong> Awesome I will give this a try. </strong></p></div>
            <div class="comment-info" id="comment-52349-info">
                
                
                
                

                

                <span class="comment-age">(09 May '16, 07:59)</span>
                <a class="comment-user userinfo" href="/users/23174/msmorten">msmorten</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-52254" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 11
        </span>
        <a href="#" class="show-all-comments-link">show 6 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-52254-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
        <form id="fmanswer" action="/questions/52254/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='zhhU5YFrEptyfXD9d8lNUlR6UBYZdcaV' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Be the first one to answer this question!
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/52254/rspan-of-plc-network-isnt-picking-up-any-of-the-layer-2-packets?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/52254/rspan-of-plc-network-isnt-picking-up-any-of-the-layer-2-packets?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/capture/"
            class="tag-link-capture"
            title="see questions tagged'capture'using tags"
            rel="tag">capture</a> <span class="tag-number">&#215;549</span><br/>
        
        <a href="/tags/vlan/"
            class="tag-link-vlan"
            title="see questions tagged'vlan'using tags"
            rel="tag">vlan</a> <span class="tag-number">&#215;66</span><br/>
        
        <a href="/tags/plc/"
            class="tag-link-plc"
            title="see questions tagged'plc'using tags"
            rel="tag">plc</a> <span class="tag-number">&#215;8</span><br/>
        
        <a href="/tags/span/"
            class="tag-link-span"
            title="see questions tagged'span'using tags"
            rel="tag">span</a> <span class="tag-number">&#215;8</span><br/>
        
    </p>
    <p>
        question asked: <strong title="May 5, 2016, 10:54 a.m.">05 May '16, 10:54</strong>
    </p>
    <p> 
     	question was seen: <strong>1,406 times</strong>
    </p>
    <p> 
        last updated: <strong title="May 9, 2016, 7:59 a.m.">09 May '16, 07:59</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/15476/persistently-capturing-vlan-tags-with-intel-pro1000-ct-nic-card-under-centos-63">Persistently Capturing VLAN Tags with Intel Pro/1000 CT NIC Card under CentOS 6.3</a>
        </p>
        
        <p>
            <a href="/questions/2725/how-to-capture-vlan">How to capture vlan</a>
        </p>
        
        <p>
            <a href="/questions/34358/vlan-tags-in-captures">Vlan tags in captures</a>
        </p>
        
        <p>
            <a href="/questions/40638/unable-to-capture-untagged-voice-vlan-packets-on-newer-computers">Unable to capture untagged voice vlan packets on newer computers</a>
        </p>
        
        <p>
            <a href="/questions/2480/vlan-capture-setup-for-intel-network-card-in-windows-7">Vlan capture setup for Intel network card in windows 7</a>
        </p>
        
        <p>
            <a href="/questions/51838/priority-and-vlan-capture-on-windows-10">Priority and VLAN capture on Windows 10</a>
        </p>
        
        <p>
            <a href="/questions/34915/cannot-see-all-traffic-on-a-span-source-vlan">Cannot see all traffic on a span source vlan</a>
        </p>
        
        <p>
            <a href="/questions/41667/qinq-vlan-capture-filter">QinQ VLAN capture filter</a>
        </p>
        
        <p>
            <a href="/questions/45516/how-to-capture-vlan-tag-on-thinkpad-t440p-on-windows-7">How to Capture Vlan tag on Thinkpad T440p on Windows 7</a>
        </p>
        
        <p>
            <a href="/questions/1983/vlan-capture-setup-for-intel-network-card-on-windows">Vlan capture setup for Intel network card on Windows</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
