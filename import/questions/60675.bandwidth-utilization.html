<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Bandwidth utilization - Wireshark Q&amp;A</title>
        <meta name="description" content="Here is my setup - I have one sender, one receiver and one monitor (in between the sender and the receiver - acting as a router ) - the sender and receiver communicate through the monitor.  However, when I measure the throughput at both ends, i am not able to utilize the whole maximum bandwidth (cap..." />
        <meta name="keywords" content="segmentation,bandwidth,tcp,bandwidthutilization" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/60675/bandwidth-utilization" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/60675/bandwidth-utilization?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='bC8cMWmaRjJNtDsQm8HYk10HNBd2J2Pf' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/60675/bandwidth-utilization">Bandwidth utilization</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-60675-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/60675/up/" rel="nofollow"> </a>
<div id="post-60675-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-60675-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/60675/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/60675/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Here is my setup - I have one sender, one receiver and one monitor (in between the sender and the receiver - acting as a router ) - the sender and receiver communicate through the monitor. </p>
<p>However, when I measure the throughput at both ends, i am not able to utilize the whole maximum bandwidth (capacity) available. For example, withe the given bandwidth,delay and loss - we normally expect our throughput to be around 250mbit/s or above. However, I am getting about 124mbits/s at both ends and i don't think this is realistic both theoretically and practically.</p>
<p>How can we maximize the maximum capacity when we turn the segmentation OFF? I would be so much grateful if you could give me some hints on this.</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/segmentation/" class="post-tag tag-link-segmentation"
                                        title="see questions tagged 'segmentation'" rel="tag">segmentation</a>
                                
                                    <a href="/tags/bandwidth/" class="post-tag tag-link-bandwidth"
                                        title="see questions tagged 'bandwidth'" rel="tag">bandwidth</a>
                                
                                    <a href="/tags/tcp/" class="post-tag tag-link-tcp"
                                        title="see questions tagged 'tcp'" rel="tag">tcp</a>
                                
                                    <a href="/tags/bandwidthutilization/" class="post-tag tag-link-bandwidthutilization"
                                        title="see questions tagged 'bandwidthutilization'" rel="tag">bandwidthutilization</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>09 Apr '17, 12:45</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/6dd3e71b974fad46455a71063cb9c319?s=32&amp;d=identicon&amp;r=g" alt="armodes's gravatar image" />
    <p><a href="/users/27831/armodes">armodes</a><br/>
    <span class="score" title="16 reputation points">16</span><span title="18 badges"><span class="badge1">&#9679;</span><span class="badgecount">18</span></span><span title="19 badges"><span class="silver">&#9679;</span><span class="badgecount">19</span></span><span title="23 badges"><span class="bronze">&#9679;</span><span class="badgecount">23</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="armodes has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/60675/">
                edited
                <strong>10 Apr '17, 18:00</strong>
            </a>
        </p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-60675">
    
        <a name="60676"></a>
        <div class="comment" id="comment-60676">
            <div id="post-60676-score" class="comment-score"></div>
            <div class="comment-text"><p>Maybe it's the segmentation that is required to achieve maximum speed - I mean, it's a performance feature, so it's not that surprising that you don't reach max speeds without it...</p></div>
            <div class="comment-info" id="comment-60676-info">
                
                
                
                

                

                <span class="comment-age">(09 Apr '17, 12:57)</span>
                <a class="comment-user userinfo" href="/users/145/jasper">Jasper ♦♦</a>
                
            </div>
        </div>
    
        <a name="60677"></a>
        <div class="comment" id="comment-60677">
            <div id="post-60677-score" class="comment-score"></div>
            <div class="comment-text"><p>Where do capture, inside or outside the offloading machines? From my point of view an internal capture is by far not trustworthy.</p></div>
            <div class="comment-info" id="comment-60677-info">
                
                
                
                

                

                <span class="comment-age">(09 Apr '17, 13:00)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
        <a name="60678"></a>
        <div class="comment" id="comment-60678">
            <div id="post-60678-score" class="comment-score"></div>
            <div class="comment-text"><p>I agree with <a href="/users/16160/christian_r">@Christian_R</a> - when you're investigating issues like this you should go at least for a SPAN port capture. Better would be a full duplex capture using a TAP and a high precision capture card, of course, but that's expensive.</p></div>
            <div class="comment-info" id="comment-60678-info">
                
                
                
                

                

                <span class="comment-age">(09 Apr '17, 13:03)</span>
                <a class="comment-user userinfo" href="/users/145/jasper">Jasper ♦♦</a>
                
            </div>
        </div>
    
        <a name="60679"></a>
        <div class="comment" id="comment-60679">
            <div id="post-60679-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/16160/christian_r">@christian_r</a>, i am turning the offloading OFF on both the sender, receiver and the monitor.</p></div>
            <div class="comment-info" id="comment-60679-info">
                
                
                
                

                

                <span class="comment-age">(09 Apr '17, 13:04)</span>
                <a class="comment-user userinfo" href="/users/27831/armodes">armodes</a>
                
            </div>
        </div>
    
        <a name="60680"></a>
        <div class="comment" id="comment-60680">
            <div id="post-60680-score" class="comment-score"></div>
            <div class="comment-text"><p>You can do this. But then you have manipulated the whole network setup. So best thing is to trace external. If you can't do then disabling offloading maybe a workaround. Can share us the trace? BTW in your example it looks like you have disabled offloading. How did you generate the traffic?</p></div>
            <div class="comment-info" id="comment-60680-info">
                
                
                
                

                

                <span class="comment-age">(09 Apr '17, 13:38)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
        <a name="60681"></a>
        <div class="comment not_top_scorer" id="comment-60681">
            <div id="post-60681-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/16160/christian_r"></a><a href="/users/16160/christian_r">@christian_r</a>, yes I have disabled offloading and I am generating the traffic using iperf and capturing the traffic on the monitor (between the sender and the receiver)</p></div>
            <div class="comment-info" id="comment-60681-info">
                
                
                
                

                

                <span class="comment-age">(09 Apr '17, 13:58)</span>
                <a class="comment-user userinfo" href="/users/27831/armodes">armodes</a>
                
            </div>
        </div>
    
        <a name="60682"></a>
        <div class="comment not_top_scorer" id="comment-60682">
            <div id="post-60682-score" class="comment-score"></div>
            <div class="comment-text"><p>O.k. Do you generate UDP or TCP traffic?</p></div>
            <div class="comment-info" id="comment-60682-info">
                
                
                
                

                

                <span class="comment-age">(09 Apr '17, 14:11)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
        <a name="60684"></a>
        <div class="comment not_top_scorer" id="comment-60684">
            <div id="post-60684-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/16160/christian_r"></a><a href="/users/16160/christian_r">@christian_r</a>, i have tried it with both TCP and UDP. Here is my trace file: </p>

<p><a href="https://drive.google.com/drive/folders/0B4Ajk8jGD1OxbS15amlQZGVFTk0?usp=sharing">https://drive.google.com/drive/folders/0B4Ajk8jGD1OxbS15amlQZGVFTk0?usp=sharing</a></p></div>
            <div class="comment-info" id="comment-60684-info">
                
                
                
                

                

                <span class="comment-age">(09 Apr '17, 14:15)</span>
                <a class="comment-user userinfo" href="/users/27831/armodes">armodes</a>
                
            </div>
        </div>
    
        <a name="60685"></a>
        <div class="comment not_top_scorer" id="comment-60685">
            <div id="post-60685-score" class="comment-score"></div>
            <div class="comment-text"><p>OK: And in TCP and UDP you got the results?</p></div>
            <div class="comment-info" id="comment-60685-info">
                
                
                
                

                

                <span class="comment-age">(09 Apr '17, 14:43)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
        <a name="60687"></a>
        <div class="comment not_top_scorer" id="comment-60687">
            <div id="post-60687-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/16160/christian_r">@christian_r</a>, yes but the problem is the maximum bandwidth utilization is the same with both TCP and UDP.</p></div>
            <div class="comment-info" id="comment-60687-info">
                
                
                
                

                

                <span class="comment-age">(09 Apr '17, 14:46)</span>
                <a class="comment-user userinfo" href="/users/27831/armodes">armodes</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-60675" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 10
        </span>
        <a href="#" class="show-all-comments-link">show 5 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-60675-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/60675/bandwidth-utilization?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/60675/bandwidth-utilization?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/60675/bandwidth-utilization?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/60675/bandwidth-utilization?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="60692"></a>
                    <div id="answer-container-60692" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-60692-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/60692/up/" rel="nofollow"> </a>
<div id="post-60692-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-60692-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/60692/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>I might be wrong but I'm guessing both sender and receiver are running Linux with CONFIG_HZ=250 in a Virtual Box environment.<br>
The MTU size along the path is size is 1500.<br>
The receiver is slow in delivering the acknowledgements compared to the 1 ms that you defined in netem<br>
</p>
<p>My suggestions to get a better throughput would be to<br>
 1. Define  a MTU size of 9000 on all interfaces, sender, bride, receiver<br>
 2. If you can/dare, change the kernel clock rate from 250Hz to 1000Hz to get a better than 4ms granularity </p>
<p>Regards Matthias </p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/60692/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>09 Apr '17, 22:50</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/5500bd1decb766660522dfb347eedc49?s=32&amp;d=identicon&amp;r=g" alt="mrEEde's gravatar image" />
    <p><a href="/users/4668/mreede">mrEEde</a><br/>
    <span class="score" title="3892 reputation points"><span class="">3.9k</span></span><span title="15 badges"><span class="badge1">&#9679;</span><span class="badgecount">15</span></span><span title="22 badges"><span class="silver">&#9679;</span><span class="badgecount">22</span></span><span title="70 badges"><span class="bronze">&#9679;</span><span class="badgecount">70</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="mrEEde has 48 accepted answers">20&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-60692">
    
        <a name="60695"></a>
        <div class="comment" id="comment-60695">
            <div id="post-60695-score" class="comment-score"></div>
            <div class="comment-text"><p>OK i will do that Matthias but the reason why I have MTU size as 1500 is because i turned the TCP segmentation offload OFF.</p></div>
            <div class="comment-info" id="comment-60695-info">
                
                
                
                

                

                <span class="comment-age">(10 Apr '17, 00:45)</span>
                <a class="comment-user userinfo" href="/users/27831/armodes">armodes</a>
                
            </div>
        </div>
    
        <a name="60696"></a>
        <div class="comment" id="comment-60696">
            <div id="post-60696-score" class="comment-score"></div>
            <div class="comment-text"><p>If this is all a virtual environment and you are not going out via real ethernet cards , there is not much benefit in saving the CPU cycles at the sender just to have them burned in the host's operating syxstem. It won't make things faster.</p></div>
            <div class="comment-info" id="comment-60696-info">
                
                
                
                

                

                <span class="comment-age">(10 Apr '17, 00:55)</span>
                <a class="comment-user userinfo" href="/users/4668/mreede">mrEEde</a>
                
            </div>
        </div>
    
        <a name="60706"></a>
        <div class="comment" id="comment-60706">
            <div id="post-60706-score" class="comment-score"></div>
            <div class="comment-text"><p>The main purpose of offloading segmentation is to save CPU cycles at the sender by having the ethernet card do this. </p>

<p>From a performance perspective it is always best to send data in as large segments as possible. So with 1500 MTU you need to send roughly 6 times more packets than with 9000 which puts unnecessary load on the host and on the receiver. 
. 
if you are CPU constrained already in this situation - which is what I think is limiting performanec here - both enabling segmentation offload and using MTU 1500 is detrimental to gaining good performance.</p></div>
            <div class="comment-info" id="comment-60706-info">
                
                
                
                

                

                <span class="comment-age">(10 Apr '17, 08:16)</span>
                <a class="comment-user userinfo" href="/users/4668/mreede">mrEEde</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-60692" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-60692-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="60699"></a>
                    <div id="answer-container-60699" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-60699-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/60699/up/" rel="nofollow"> </a>
<div id="post-60699-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-60699-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/60699/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>The throughput limitation here appears to be due to the sending client.</p>
<p>The server almost constantly advertises a Receive Window of 1.5 MB but the client seems to transmit sometimes in fast bursts (but never filling the 1.5 MB window) but mostly at a slow rate. The Transmit Window never gets above 200-300 KB.  This means that Window Scaling is being used - so we can eliminate the 64 KB per round trip limitation.</p>
<p>Some of this does seem related to transmit window "halving" in response to packet losses, but even without losses, we get a transmitted flow as in the attached TCP Stream diagram.</p>
<p>There are far more "slow" transmissions than "fast" bursts.</p>
<p><img alt="alt text" src="https://osqa-ask.wireshark.org/upfiles/Offloading-Off-300Mb_2ULcAw5.png"></p>
<p>Notice also that the horizontal distance from the data packets to the ACK line indicate varying RTTs. They range from 3 ms to 13 ms.
Actually, looking more deeply, this is due to there being large time gaps between the server's ACKs. There isn't the usual ACK for every two packets.  I'd say that the server's ACKs have been dropped by the sniffer (given that there are lots of missing data packets in this trace file that were also dropped by the capture mechanism).</p>
<p>It would seem to me that there is no TCP level reason for the slow transmit rate. You need to be looking at your client and why it would slow its output in this way.  That is, could there be an application layer bottleneck?</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/60699/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>10 Apr '17, 02:07</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/35a0c1d0cf15b9d54d73bf54ae28abcd?s=32&amp;d=identicon&amp;r=g" alt="Philst's gravatar image" />
    <p><a href="/users/26122/philst">Philst</a><br/>
    <span class="score" title="431 reputation points">431</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="6 badges"><span class="silver">&#9679;</span><span class="badgecount">6</span></span><span title="16 badges"><span class="bronze">&#9679;</span><span class="badgecount">16</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Philst has 6 accepted answers">27&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/60699/">
                edited
                <strong>10 Apr '17, 17:04</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-60699">
    
        <a name="60701"></a>
        <div class="comment" id="comment-60701">
            <div id="post-60701-score" class="comment-score"></div>
            <div class="comment-text"><p>The reason why we get window halving due to the TCP variant i am using (CUBIC). I can't understand why the sending client is behaving that way. Turning the window scaling is also not a good option :( How can i reproduce that graph by the way? Statistics -&gt; TimeSteamGraphs -&gt; TimeSequence (tcptrace) is not giving me the same graph.</p></div>
            <div class="comment-info" id="comment-60701-info">
                
                
                
                

                

                <span class="comment-age">(10 Apr '17, 04:43)</span>
                <a class="comment-user userinfo" href="/users/27831/armodes">armodes</a>
                
            </div>
        </div>
    
        <a name="60723"></a>
        <div class="comment" id="comment-60723">
            <div id="post-60723-score" class="comment-score">1</div>
            <div class="comment-text"><p>I've changed the diagram so that it now contains the Wireshark settings. You have to choose the correct "Stream" and you may also have to "Switch Direction" in order to see the client's packets.</p>

<p>Window Scaling is enabled, so no tuning needed. The "halving" is normal TCP "Congestion Avoidance" behaviour.</p>

<p>The throughput rate appears to be the "fault" of the sending application rather than anything at the TCP/IP or network level.</p>

<p>The reason that the sending client is behaving this way is not apparent from the capture. You're going to have to do some different analysis inside your virtual machine and/or application. Is there a buffer limitation for the application to deliver data to TCP?</p>

<p>Those slow output rates, such as at time 11:38 on the chart, are because the sender is choosing to do that, not because of any network or TCP/IP limitation.</p></div>
            <div class="comment-info" id="comment-60723-info">
                
                
                
                

                

                <span class="comment-age">(10 Apr '17, 17:12)</span>
                <a class="comment-user userinfo" href="/users/26122/philst">Philst</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-60699" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-60699-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/60675/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='bC8cMWmaRjJNtDsQm8HYk10HNBd2J2Pf' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/60675/bandwidth-utilization?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/60675/bandwidth-utilization?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/tcp/"
            class="tag-link-tcp"
            title="see questions tagged'tcp'using tags"
            rel="tag">tcp</a> <span class="tag-number">&#215;752</span><br/>
        
        <a href="/tags/bandwidth/"
            class="tag-link-bandwidth"
            title="see questions tagged'bandwidth'using tags"
            rel="tag">bandwidth</a> <span class="tag-number">&#215;57</span><br/>
        
        <a href="/tags/bandwidthutilization/"
            class="tag-link-bandwidthutilization"
            title="see questions tagged'bandwidthutilization'using tags"
            rel="tag">bandwidthutilization</a> <span class="tag-number">&#215;16</span><br/>
        
        <a href="/tags/segmentation/"
            class="tag-link-segmentation"
            title="see questions tagged'segmentation'using tags"
            rel="tag">segmentation</a> <span class="tag-number">&#215;5</span><br/>
        
    </p>
    <p>
        question asked: <strong title="April 9, 2017, 12:45 p.m.">09 Apr '17, 12:45</strong>
    </p>
    <p> 
     	question was seen: <strong>2,746 times</strong>
    </p>
    <p> 
        last updated: <strong title="April 10, 2017, 6 p.m.">10 Apr '17, 18:00</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/48551/specific-tcp-port-bandwidth">specific tcp port bandwidth</a>
        </p>
        
        <p>
            <a href="/questions/9405/identify-bandwidth-hog">Identify Bandwidth Hog</a>
        </p>
        
        <p>
            <a href="/questions/50649/tshark-meassuring-bandwidth-per-ip">tshark meassuring bandwidth per IP</a>
        </p>
        
        <p>
            <a href="/questions/27979/monitoring-wan-traffic">Monitoring WAN Traffic</a>
        </p>
        
        <p>
            <a href="/questions/17245/tick-interval-question">Tick interval question</a>
        </p>
        
        <p>
            <a href="/questions/172/what-is-using-the-most-bandwidth-on-my-nic">What is using the most bandwidth on my nic?</a>
        </p>
        
        <p>
            <a href="/questions/18789/detecting-bottleneck-devices">detecting bottleneck devices</a>
        </p>
        
        <p>
            <a href="/questions/31621/bandwidth-throttling-emulating">Bandwidth Throttling, Emulating</a>
        </p>
        
        <p>
            <a href="/questions/57415/summarising-network-traffic">Summarising network traffic</a>
        </p>
        
        <p>
            <a href="/questions/1177/getting-more-info-on-tcp-packets">getting more info on TCP packets</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
