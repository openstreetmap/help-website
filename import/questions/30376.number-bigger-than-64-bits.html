<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>number bigger than 64 bits - Wireshark Q&amp;A</title>
        <meta name="description" content="Hi, Just wondering if anyone has to write a dissector in Lua that contains values bigger than 64 bit. How do you do it. Thanks." />
        <meta name="keywords" content="lua,big_number" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/30376/number-bigger-than-64-bits" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/30376/number-bigger-than-64-bits?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='4bCM125ANGMsZyNRaZzheSc89KYmAljg' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/30376/number-bigger-than-64-bits">number bigger than 64 bits</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-30376-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/30376/up/" rel="nofollow"> </a>
<div id="post-30376-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-30376-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/30376/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/30376/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hi,</p>
<p>Just wondering if anyone has to write a dissector in Lua that contains values bigger than 64 bit.  How do you do it.</p>
<p>Thanks.</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/lua/" class="post-tag tag-link-lua"
                                        title="see questions tagged 'lua'" rel="tag">lua</a>
                                
                                    <a href="/tags/big_number/" class="post-tag tag-link-big_number"
                                        title="see questions tagged 'big_number'" rel="tag">big_number</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>03 Mar '14, 18:23</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/b18cada3e3589f311e24f5ffbd1737bc?s=32&amp;d=identicon&amp;r=g" alt="YXI's gravatar image" />
    <p><a href="/users/6804/yxi">YXI</a><br/>
    <span class="score" title="21 reputation points">21</span><span title="18 badges"><span class="badge1">&#9679;</span><span class="badgecount">18</span></span><span title="20 badges"><span class="silver">&#9679;</span><span class="badgecount">20</span></span><span title="23 badges"><span class="bronze">&#9679;</span><span class="badgecount">23</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="YXI has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/30376/">
                retagged
                <strong>04 Mar '14, 04:24</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d02f20c18a7742ec73a666f1974bf6dc?s=32&amp;d=identicon&amp;r=g" alt="Hadriel's gravatar image" />
            <p><a href="/users/4318/hadriel">Hadriel</a><br/>
            <span class="score" title="2652 reputation points"><span class="">2.7k</span></span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="9 badges"><span class="silver">&#9679;</span><span class="badgecount">9</span></span><span title="39 badges"><span class="bronze">&#9679;</span><span class="badgecount">39</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-30376">
    
</div>
<div id="comment-tools-30376" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-30376-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/30376/number-bigger-than-64-bits?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/30376/number-bigger-than-64-bits?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/30376/number-bigger-than-64-bits?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/30376/number-bigger-than-64-bits?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="30391"></a>
                    <div id="answer-container-30391" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-30391-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/30391/up/" rel="nofollow"> </a>
<div id="post-30391-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-30391-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/30391/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>To do what with?  Just to show it in the display tree?  Have it be filterable by value? Or to actually perform some arithmetic on it?</p>
<p>If it's just to display in the tree, I suppose you can treat it as a byte string.  You can even show it's numerical value by processing each byte in Lua and building/concatenating a string representing the numeric value, that you add to the tree item using Lua. (it would take some careful Lua coding to make such a bignum string, but it's possible)</p>
<p>But to have it be filterable by numeric value (i.e., have a display filter like 'myproto.bugnum = 42446744073709551615') isn't possible as far as I know, since there's no filter type for numbers bigger than 64-bit.</p>
<p>There's no way of performing Lua arithmetic (ie, add, subtract, divide) on numbers that big directly as a Lua number, because Lua itself only handles numbers as doubles; and though a double can certainly represent massive numbers, it loses precision above 53-bits (or 52 bits... I always forget which).  As of Wireshark 1.11.3 we now have Lua arithmetic for 64-bit numbers, as Int64/UInt64 userdata objects, but nothing bigger.  So if you need to handle something bigger, you'll have to write the Lua code to do it based on smaller number chunks of the bigger number.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/30391/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>04 Mar '14, 04:23</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d02f20c18a7742ec73a666f1974bf6dc?s=32&amp;d=identicon&amp;r=g" alt="Hadriel's gravatar image" />
    <p><a href="/users/4318/hadriel">Hadriel</a><br/>
    <span class="score" title="2652 reputation points"><span class="">2.7k</span></span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="9 badges"><span class="silver">&#9679;</span><span class="badgecount">9</span></span><span title="39 badges"><span class="bronze">&#9679;</span><span class="badgecount">39</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Hadriel has 30 accepted answers">18&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-30391">
    
        <a name="30400"></a>
        <div class="comment" id="comment-30400">
            <div id="post-30400-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks Hadriel.
I do need to do a lot of stuff on the big numbers (bit operations such as shifting, masking), change endianess, and also type conversion, e.g. interpreting an unsigned long long number as a double.
I think this is definitely beyond the capability of Wireshark Lua even for the newest development version.  I know Lua has libraries that handle numbers to an arbitrary size, but I haven't seen anyone using it writing Wireshark dissectors.
In reality, most of my values are going to be capped at 64 bits, so I will probably ignore the really big numbers for now.
I'm still using wireshark 1.10.2.  I think I will have to move to 1.11.2 to do all the 64 bit stuff.  However, since it's not a stable release, I'm hesitating to do it.  You can probably tell I'm still a novice to the whole thing.  But how stable is the development release?  Any serious risks?</p>

<p>Thanks so much,
YXI</p></div>
            <div class="comment-info" id="comment-30400-info">
                
                
                
                

                

                <span class="comment-age">(04 Mar '14, 08:14)</span>
                <a class="comment-user userinfo" href="/users/6804/yxi">YXI</a>
                
            </div>
        </div>
    
        <a name="30402"></a>
        <div class="comment" id="comment-30402">
            <div id="post-30402-score" class="comment-score"></div>
            <div class="comment-text"><p>Well... it's fairly stable, if you keep to the automated nightly builds instead of just pulling down the latest source code and compiling yourself. But the 64-bit stuff is only in 1.11.3, not 1.11.2, so you can only get it from the nightly builds here:
<a href="http://www.wireshark.org/download/automated/">http://www.wireshark.org/download/automated/</a></p>

<p>Info on the Int64/UInt64 is here:
<a href="http://wiki.wireshark.org/LuaAPI/Int64">http://wiki.wireshark.org/LuaAPI/Int64</a></p>

<p>If you need some new Lua function/class/whatever exposed into Wireshark, just submit a bugzilla enhancement request, or post it in a new question here with the tag 'lua'.  I've been on a kick lately exposing more stuff into Lua.  The changes merged into 1.11.3 so far are documented here:
<a href="http://wiki.wireshark.org/Lua/ApiChanges">http://wiki.wireshark.org/Lua/ApiChanges</a></p>

<p>Which bignum library for Lua would you like to see in Wireshark?</p></div>
            <div class="comment-info" id="comment-30402-info">
                
                
                
                

                

                <span class="comment-age">(04 Mar '14, 08:44)</span>
                <a class="comment-user userinfo" href="/users/4318/hadriel">Hadriel</a>
                
            </div>
        </div>
    
        <a name="30410"></a>
        <div class="comment" id="comment-30410">
            <div id="post-30410-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi Hadriel,</p>

<p>I haven't decided which one I like (I looked at both lbc and lmapm). So you may need to wait for more input from the community on this one.</p>

<p>I saw that you committed changes very recently to add Lua struct (pack, unpack, etc) functionalities to Wireshark.  Are they ready to be used?  will they work on 64 bit numbers?  I do need to do endianness swaps, converting signed to unsigned number, long to double, etc.  I think using the struct library may be the easiest way to go.  Is that true?</p>

<p>Thanks,
YXI</p></div>
            <div class="comment-info" id="comment-30410-info">
                
                
                
                

                

                <span class="comment-age">(04 Mar '14, 09:47)</span>
                <a class="comment-user userinfo" href="/users/6804/yxi">YXI</a>
                
            </div>
        </div>
    
        <a name="30414"></a>
        <div class="comment" id="comment-30414">
            <div id="post-30414-score" class="comment-score"></div>
            <div class="comment-text"><p>I looked into lbc and lmapm (and lbn and lqd and lgmp), and the easiest to include in Wireshark would be lbc, by far.  Unfortunately it's also probably the slowest. :(</p>

<p>I assume though that raw speed isn't that important?</p></div>
            <div class="comment-info" id="comment-30414-info">
                
                
                
                

                

                <span class="comment-age">(04 Mar '14, 11:01)</span>
                <a class="comment-user userinfo" href="/users/4318/hadriel">Hadriel</a>
                
            </div>
        </div>
    
        <a name="30423"></a>
        <div class="comment" id="comment-30423">
            <div id="post-30423-score" class="comment-score"></div>
            <div class="comment-text"><p>Speed is not important to me.  Neither of these two have bit operation APIs though.</p></div>
            <div class="comment-info" id="comment-30423-info">
                
                
                
                

                

                <span class="comment-age">(04 Mar '14, 16:49)</span>
                <a class="comment-user userinfo" href="/users/6804/yxi">YXI</a>
                
            </div>
        </div>
    
        <a name="30425"></a>
        <div class="comment not_top_scorer" id="comment-30425">
            <div id="post-30425-score" class="comment-score"></div>
            <div class="comment-text"><p>No, but I'd add that.  I added it for Int64/UInt64, for example.</p></div>
            <div class="comment-info" id="comment-30425-info">
                
                
                
                

                

                <span class="comment-age">(04 Mar '14, 19:22)</span>
                <a class="comment-user userinfo" href="/users/4318/hadriel">Hadriel</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-30391" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 6
        </span>
        <a href="#" class="show-all-comments-link">show 1 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-30391-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="30411"></a>
                    <div id="answer-container-30411" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-30411-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/30411/up/" rel="nofollow"> </a>
<div id="post-30411-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-30411-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/30411/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Yes, Struct is in the latest nightly builds, and has Int64/UInt64 support by using 'e'/'E' in the pattern.  Note that it's "Struct" not "struct", however - I didn't want to collide with someone's use of the real struct library if they were already using it.  Also, our auto-generated docs for it are <a href="http://www.wireshark.org/docs/wsug_html_chunked/lua_module_Struct.html">here</a>, but it's not very helpful.  I've been hoping to update the doc generator for the API, because we're very limited in the type of documentation that can be generated for the API. (it's auto-generated by a Perl script from source code)</p>
<p>So here are some rough notes from the source file:</p>
<pre><code>** Some changes are based on a patch to struct.h from
** Flemming Madsen, from here:
** <a href="http://lua-users.org/lists/lua-l/2009-10/msg00572.html">http://lua-users.org/lists/lua-l/2009-10/msg00572.html</a>
** In particular, these changes from him:
** -Can handle 'long long' integers (i8 / I8); though they're converted to doubles
** -Can insert/specify padding anywhere in a struct. ('X' eg. when a string is following a union)
** -Can report current offset in both pack and unpack ('=')
** -Can mask out return values when you only want to calculate sizes or unmarshal pascal-style strings. '(' &amp; ')'
**
** Changes I made:
** -Added support for Int64/UIn64 being packed/unpacked, using 'e'/'E'
** -Made it follow Wireshark's conventions so we could get API docs
** =======================================================
*/
/*
** Valid formats:
** &gt; - big endian
** &lt; - little endian
** ![num] - alignment
** x[num]   - pad num bytes, default 1
** X[num]   - pad to num align, default MAXALIGN
**
** Following are system-dependent sizes:
** b/B - signed/unsigned byte
** h/H - signed/unsigned short
** i/I - signed/unsigned int
** l/L - signed/unsigned long
** f - float
** d - double
** T   - size_t
**
** Following are system-independent sizes:
** in/In - signed/unsigned integer of size `n' bytes
          Note: unpack of i/I is done to a Lua_number, typically a double,
          so unpacking a 64-bit field (i8/I8) will lose precision.
          Use e/E to unpack into a Wireshark Int64/UInt64 object/userdata instead.
** e/E - signed/unsigned eight-byte Integer (64bits, long long), to/from Int64/UInt64 object
** cn - sequence of `n' chars (from/to a string); when packing, n==0 means
        the whole string; when unpacking, n==0 means use the previous
        read number as the string length
** s - zero-terminated string
** ' ' - ignored
** '(' ')'  - stop assigning items. ')' start assigning (padding when packing)
** '='      - return current position / offset
*/
</code></pre>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/30411/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>04 Mar '14, 09:58</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d02f20c18a7742ec73a666f1974bf6dc?s=32&amp;d=identicon&amp;r=g" alt="Hadriel's gravatar image" />
    <p><a href="/users/4318/hadriel">Hadriel</a><br/>
    <span class="score" title="2652 reputation points"><span class="">2.7k</span></span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="9 badges"><span class="silver">&#9679;</span><span class="badgecount">9</span></span><span title="39 badges"><span class="bronze">&#9679;</span><span class="badgecount">39</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Hadriel has 30 accepted answers">18&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-30411">
    
        <a name="30412"></a>
        <div class="comment" id="comment-30412">
            <div id="post-30412-score" class="comment-score"></div>
            <div class="comment-text"><p>Oh, and I added a tohex()/fromhex() function, as documented in the API docs.</p></div>
            <div class="comment-info" id="comment-30412-info">
                
                
                
                

                

                <span class="comment-age">(04 Mar '14, 10:01)</span>
                <a class="comment-user userinfo" href="/users/4318/hadriel">Hadriel</a>
                
            </div>
        </div>
    
        <a name="30422"></a>
        <div class="comment" id="comment-30422">
            <div id="post-30422-score" class="comment-score"></div>
            <div class="comment-text"><p>This is great.  I really need it.  Will let you know how it goes.</p></div>
            <div class="comment-info" id="comment-30422-info">
                
                
                
                

                

                <span class="comment-age">(04 Mar '14, 16:48)</span>
                <a class="comment-user userinfo" href="/users/6804/yxi">YXI</a>
                
            </div>
        </div>
    
        <a name="30447"></a>
        <div class="comment" id="comment-30447">
            <div id="post-30447-score" class="comment-score"></div>
            <div class="comment-text"><p>Hadriel and others,</p>

<p>If I simply have these two lines of code: </p>

<p>a = UInt64.new("ff000000")</p>

<p>b = a.rshift(2)</p>

<p>I get:
Lua: Error During execution of dialog callback:
 [string "a = UInt64.new("ff000000")..."]:2: bad argument #2 to 'rshift' (number expected, got no value)</p>

<p>What did I do wrong?</p>

<p>Thanks.</p></div>
            <div class="comment-info" id="comment-30447-info">
                
                
                
                

                

                <span class="comment-age">(05 Mar '14, 14:59)</span>
                <a class="comment-user userinfo" href="/users/6804/yxi">YXI</a>
                
            </div>
        </div>
    
        <a name="30448"></a>
        <div class="comment" id="comment-30448">
            <div id="post-30448-score" class="comment-score"></div>
            <div class="comment-text"><p>You called 'rshift()' with a single argument - a number 2 - instead of with 2 arguments: the 'a' object, and the number 2.  You need to use a <code>:</code> colon instead of <code>.</code> period, because a colon is basically Lua shorthand for <code>a.rshift(a,2)</code>.</p>

<p>So you should do this:</p>

<pre><code>a = UInt64.new(0xff000000)
b = a:rshift(2)
</code></pre>

<p>Note also I didn't put the ff000000 in quotes, as that would make it a string, and although UInt64/Int64 new() accepts a string, it decodes it in base 10, which means it has to be a string of digits, not hex.  Maybe I should change it to decode in base 0, so you could use hex inside (if you prepend with 0x).</p>

<p>Also, you don't need to use the 'new' method - you can just call it like this:</p>

<pre><code>a = UInt64(0xff000000)
b = a:rshift(2)
</code></pre></div>
            <div class="comment-info" id="comment-30448-info">
                
                
                
                

                

                <span class="comment-age">(05 Mar '14, 15:16)</span>
                <a class="comment-user userinfo" href="/users/4318/hadriel">Hadriel</a>
                
            </div>
        </div>
    
        <a name="30449"></a>
        <div class="comment" id="comment-30449">
            <div id="post-30449-score" class="comment-score"></div>
            <div class="comment-text"><p>BTW, I think your post and mine were just changed to comments, because this ask.wireshark.org site isn't really a forum model of topic threads, but instead a question+answer model site.  So each topic is a single question and one or more answers to that question.  So you should ask future questions as new, separate topics, not in this one.</p>

<p>(everyone makes that mistake, but the folks behind ask.wireshark.org are refusing to yield to how everyone else communicates naturally, under the hope that by keeping it a question+answer model then people will search for their question being already answered previously.  It's a nice dream. :)</p></div>
            <div class="comment-info" id="comment-30449-info">
                
                
                
                

                

                <span class="comment-age">(05 Mar '14, 15:36)</span>
                <a class="comment-user userinfo" href="/users/4318/hadriel">Hadriel</a>
                
            </div>
        </div>
    
        <a name="30451"></a>
        <div class="comment not_top_scorer" id="comment-30451">
            <div id="post-30451-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks Hadriel.  Sorry for my mistake.  You can probably tell I'm still new to Lua.  The funny thing was I did not get any error messages using "." instead of ":" on the band() and bor() functions, with only one argument, like b=a.band(0xff).  That's why I didn't even suspect my syntax was wrong for the shift operations.<br>
Anyway, thanks for the explanations.  I will start a new question next time I change the topic.</p></div>
            <div class="comment-info" id="comment-30451-info">
                
                
                
                

                

                <span class="comment-age">(05 Mar '14, 18:20)</span>
                <a class="comment-user userinfo" href="/users/6804/yxi">YXI</a>
                
            </div>
        </div>
    
        <a name="30452"></a>
        <div class="comment not_top_scorer" id="comment-30452">
            <div id="post-30452-score" class="comment-score"></div>
            <div class="comment-text"><p>Hmmm.. well technically that's because they're not errors - you just created a new UInt64 of value 0xff and didn't <code>and</code>/<code>or</code> it with anything.  The and/or/xor functions all take any number of arguments, including only one argument. So when you do <code>b=a.band(0xff)</code>, you're really calling <code>band()</code> with just the 0xff argument, and thus creating a new UInt64 of value 0xff, and assigning it to variable <code>b</code>.  The problem you had before was the <code>rshift()</code> function, which must have two arguments, but you were only giving it one.  For example, you could have done this: <code>b=UInt64.rshift(0xff000000, 2)</code> and it would have worked as well.</p>

<p>I know that's a bit confusing, not being consistent in different functions, but I was trying to mimic exactly what the Lua bitop library does for all of these functions, since Wireshark has the bitop library available in Lua but it only handles up to 32bit integers... and the bitop library does exactly the same thing Int64/UIn64 does for and/or/xor vs. rshift and the others.</p></div>
            <div class="comment-info" id="comment-30452-info">
                
                
                
                

                

                <span class="comment-age">(05 Mar '14, 19:04)</span>
                <a class="comment-user userinfo" href="/users/4318/hadriel">Hadriel</a>
                
            </div>
        </div>
    
        <a name="30471"></a>
        <div class="comment not_top_scorer" id="comment-30471">
            <div id="post-30471-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/4318/hadriel">@Hadriel</a>, <a href="/users/6804/yxi">@YXI</a></p>

<p>Yep, the mods do try to keep things as a Q&amp;A.  User assistance in keeping it that way would be appreciated.  StackOverflow etc. seem to do OK with that model.  I think we need to have a start page that consists of nothing but a search box, then users might actually use it. :-)</p>

<p>It's sometime difficult to determine if a supplementary question should be promoted to its own question, but that's a judgement call.</p></div>
            <div class="comment-info" id="comment-30471-info">
                
                
                
                

                

                <span class="comment-age">(06 Mar '14, 01:42)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb â™¦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-30411" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 8
        </span>
        <a href="#" class="show-all-comments-link">show 3 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-30411-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/30376/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='4bCM125ANGMsZyNRaZzheSc89KYmAljg' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/30376/number-bigger-than-64-bits?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/30376/number-bigger-than-64-bits?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/lua/"
            class="tag-link-lua"
            title="see questions tagged'lua'using tags"
            rel="tag">lua</a> <span class="tag-number">&#215;431</span><br/>
        
        <a href="/tags/big_number/"
            class="tag-link-big_number"
            title="see questions tagged'big_number'using tags"
            rel="tag">big_number</a> <span class="tag-number">&#215;1</span><br/>
        
    </p>
    <p>
        question asked: <strong title="March 3, 2014, 6:23 p.m.">03 Mar '14, 18:23</strong>
    </p>
    <p> 
     	question was seen: <strong>2,929 times</strong>
    </p>
    <p> 
        last updated: <strong title="March 6, 2014, 1:42 a.m.">06 Mar '14, 01:42</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/570/crashing-issue-when-running-lua-dissector-after-upgrading-from-wireshark-100">Crashing issue when running Lua dissector after upgrading from wireshark 1.0.0</a>
        </p>
        
        <p>
            <a href="/questions/4410/create-my-own-dissector">Create my own dissector</a>
        </p>
        
        <p>
            <a href="/questions/5868/how-do-i-setup-wireshark-to-run-luas-clrpackage">How do I setup Wireshark to run Lua&#39;s CLRPackage</a>
        </p>
        
        <p>
            <a href="/questions/8328/order-of-entries-in-dissector-tables-at-startup-and-lua">Order of entries in dissector tables at startup and lua</a>
        </p>
        
        <p>
            <a href="/questions/9353/wireshark-lua-wireshark-version-problem">Wireshark Lua - Wireshark Version problem</a>
        </p>
        
        <p>
            <a href="/questions/11330/lua-binding-integration-documentation">Lua binding / integration - documentation</a>
        </p>
        
        <p>
            <a href="/questions/15776/check-sequentiality-in-destination-addresses-from-a-specific-source-address">check sequentiality in destination addresses from a specific source address</a>
        </p>
        
        <p>
            <a href="/questions/19340/tcpdstat-for-wireshark">TCPdSTAT for Wireshark?</a>
        </p>
        
        <p>
            <a href="/questions/23622/my-lua-dissector-isnt-finding-the-crc32-module">My Lua dissector isn&#39;t finding the CRC32 module</a>
        </p>
        
        <p>
            <a href="/questions/28076/pdu-reassembly-over-udp-within-a-lua-dissector">PDU reassembly over UDP within a lua dissector</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
