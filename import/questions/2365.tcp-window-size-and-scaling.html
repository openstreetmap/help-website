<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>TCP window size and scaling - Wireshark Q&amp;A</title>
        <meta name="description" content="Hi I am trying to troubleshoot speed issues for a customer connecting to a Web Site from abroad. We have carried out testing by asking carrying out downloads of files from our Web site &amp;amp; capturing traffic during this. We can see that once the download commences, after a short amount of packets, ..." />
        <meta name="keywords" content="scaling,window,tcp,size" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/2365/tcp-window-size-and-scaling" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/2365/tcp-window-size-and-scaling?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='6xqSjn4DGNLkuYZvxLvQXEpVZcP9bgtg' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/2365/tcp-window-size-and-scaling">TCP window size and scaling</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-2365-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/2365/up/" rel="nofollow"> </a>
<div id="post-2365-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-2365-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/2365/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/2365/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   2
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hi</p>
<p>I am trying to troubleshoot speed issues for a customer connecting to a Web Site from abroad.
We have carried out testing by asking carrying out downloads of files from our Web site &amp; capturing traffic during this.</p>
<p>We can see that once the download commences, after a short amount of packets, the TCP Window size on the receiving host drops to zero. After a short while this resumes &amp; then does not drop below 40000.</p>
<p>On this machine the Windows Scaling option is set to 3 &amp; the TCP Window size set to 65535.
Even with the scaling option set the TCP Window size never goes above 65535 in the packets (which I am told is normal).</p>
<p>I am surprised that, with the scaling set to 3, the TCP Window size still reduces to zero.</p>
<p>IS this normal behaviour?
I am guessing that the TCP Window reducing to zero is because of some resource limitation on the Receiving host...?</p>
<p>Any assistance would be greatly appreciated.
Thanks
Ian</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/scaling/" class="post-tag tag-link-scaling"
                                        title="see questions tagged 'scaling'" rel="tag">scaling</a>
                                
                                    <a href="/tags/window/" class="post-tag tag-link-window"
                                        title="see questions tagged 'window'" rel="tag">window</a>
                                
                                    <a href="/tags/tcp/" class="post-tag tag-link-tcp"
                                        title="see questions tagged 'tcp'" rel="tag">tcp</a>
                                
                                    <a href="/tags/size/" class="post-tag tag-link-size"
                                        title="see questions tagged 'size'" rel="tag">size</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>16 Feb '11, 05:07</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/4dfdb30f4297c840a2cd7b3b6754fe34?s=32&amp;d=identicon&amp;r=g" alt="ipittam's gravatar image" />
    <p><a href="/users/722/ipittam">ipittam</a><br/>
    <span class="score" title="31 reputation points">31</span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="4 badges"><span class="silver">&#9679;</span><span class="badgecount">4</span></span><span title="6 badges"><span class="bronze">&#9679;</span><span class="badgecount">6</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="ipittam has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-2365">
    
</div>
<div id="comment-tools-2365" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-2365-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    3 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/2365/tcp-window-size-and-scaling?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/2365/tcp-window-size-and-scaling?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/2365/tcp-window-size-and-scaling?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/2365/tcp-window-size-and-scaling?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="2366"></a>
                    <div id="answer-container-2366" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-2366-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/2366/up/" rel="nofollow"> </a>
<div id="post-2366-score" class="post-score"
    title="current number of votes">
    3
</div>
<a id="post-2366-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/2366/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>TCP window dropping to Zero means that the receiving host has trouble processing incoming data fast enough. Even with window scaling it is something that can happen - the larger the window the longer it takes to drop to zero. If the receiving station is too slow to process data and it has to receive more data than the window size is in size it will go down to zero.</p>
<p>You can take a look at the "bytes in flight" value in the sender's tcp header to see how much data has not yet been acknowledged - it ususally shows pretty high numbers if the receiver is too slow to process the incoming flood of packets.</p>
<p>Zero windows very often indicate an overloaded receiving station (either OS or slow application), and is a good indicator that "it is NOT the network" :-) </p>
<p>Exception are Reset-Packet - they usually have a window size of 0 and are not an indication of an overworked station.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/2366/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>16 Feb '11, 05:31</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" alt="Jasper's gravatar image" />
    <p><a href="/users/145/jasper">Jasper ♦♦</a><br/>
    <span class="score" title="23806 reputation points"><span class="">23.8k</span></span><span title="5 badges"><span class="badge1">&#9679;</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">&#9679;</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">&#9679;</span><span class="badgecount">284</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Jasper has 263 accepted answers">18&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/2366/">
                edited
                <strong>16 Feb '11, 05:32</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-2366">
    
        <a name="2367"></a>
        <div class="comment" id="comment-2367">
            <div id="post-2367-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi Jasper,</p>

<p>Thanks for your response.</p>

<p>I was looking at the "bytes in flight" value in the packets (we have a packet capture on the client side for a download). I can see that bytes in flight never goes beyond 2736 (ie 2 packets) at a given time even though the client has been showing a win size of 65535.</p>

<p>Should the server be not sending more data (and hence show more bytes under bytes in flight) and thus make the download faster?</p>

<p>Are we missing something?
Thanks - Ian</p></div>
            <div class="comment-info" id="comment-2367-info">
                
                
                
                

                

                <span class="comment-age">(16 Feb '11, 07:07)</span>
                <a class="comment-user userinfo" href="/users/722/ipittam">ipittam</a>
                
            </div>
        </div>
    
        <a name="2368"></a>
        <div class="comment" id="comment-2368">
            <div id="post-2368-score" class="comment-score"></div>
            <div class="comment-text"><p>For a capture at the client side that is pretty normal as every other packet is acknowledged (thus resulting in 2 packets being "in flight", meaning "not acknowledged"). On the server side you should see higher numbers of bytes in flight though, at least if client and server are not very close to each other. </p>

<p>Regardless of the bytes in flight the important fact is still the Zero Window syndrome - this should not happen in the middle of a transfer because it means the receiver is too slow to process data.</p></div>
            <div class="comment-info" id="comment-2368-info">
                
                
                
                

                

                <span class="comment-age">(16 Feb '11, 07:17)</span>
                <a class="comment-user userinfo" href="/users/145/jasper">Jasper ♦♦</a>
                
            </div>
        </div>
    
        <a name="2369"></a>
        <div class="comment" id="comment-2369">
            <div id="post-2369-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks Jasper</p>

<p>We have looked at the Packet capture from the Server &amp; it is quite different. The bytes in flight reaches up to almost 65535 &amp; then ACKs are received.</p>

<p>If the TCP Windows Scaling setting is enabled, should the bytes in flight be seen to increase above this amount?</p>

<p>Also, am I right in saying that the Window Size setting may be changed by intermediate network devices, as the packets are buffered by these devices in transit?</p>

<p>Thanks
Ian</p></div>
            <div class="comment-info" id="comment-2369-info">
                
                
                
                

                

                <span class="comment-age">(16 Feb '11, 07:53)</span>
                <a class="comment-user userinfo" href="/users/722/ipittam">ipittam</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-2366" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-2366-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="2384"></a>
                    <div id="answer-container-2384" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-2384-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/2384/up/" rel="nofollow"> </a>
<div id="post-2384-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-2384-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/2384/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>When you look at that station communicating - how do you know the Window Scale is in use? </p>
<p>Do you see a "scaled" value in the host's TCP headers? </p>
<p>Here's the deal and it's all over the place these days. 
 - your client can be set to use Window Scaling (TCP options in handshake)
 - if the server doesn't support it, neither side will use it (look at server handshake response)
 - if an intermediary device (such as a "smart firewall" - ugh) doesn't like/support that option for the path, it might strip off your client's TCP option (thinking Cisco ASA here). 
 - if Window Scaling is on and truly in use and your client still hits Window Zero conditions, then what the heck is the application running for that communication? Example: IE being dog slow picking data up out of receive buffer causes Window Zero condition on large file download - update IE or get a better browser. </p>
<p>BTW, the Window Size field can only go to 65,535 as it is a 2-byte field. If Window Scaling is truly in use and you have set the TCP Preferences to show Relative Sequence Numbering and Window Scaling (the default), then you should see a scaled factor after the Window Size field in the communications after the first two packets of the handshake. </p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/2384/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>16 Feb '11, 11:17</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/9b4bb3984350b45aee3eda5cc1c90d36?s=32&amp;d=identicon&amp;r=g" alt="lchappell's gravatar image" />
    <p><a href="/users/7/lchappell">lchappell ♦</a><br/>
    <span class="score" title="1206 reputation points"><span class="">1.2k</span></span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="7 badges"><span class="silver">&#9679;</span><span class="badgecount">7</span></span><span title="30 badges"><span class="bronze">&#9679;</span><span class="badgecount">30</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="lchappell has 6 accepted answers">8&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-2384">
    
        <a name="2417"></a>
        <div class="comment" id="comment-2417">
            <div id="post-2417-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks for your comments - very useful!</p>

<p>We have convinced our Service Provider to enable TCP windows Scaling &amp; Selective Acks.
We now see that the these options are mutually enabled it the SYN / SYN-ACK packets.</p>

<p>A further observation we have is that the when downloading a file from a Web Server behind the Cisco ACE device via a SSL connection (HTTPS URL) we can see that the Cisco is struggling with flow &amp; reducing the TCP Window &amp; also the Server advertising that the TCP Window is full.</p>

<p>Thanks Ian</p></div>
            <div class="comment-info" id="comment-2417-info">
                
                
                
                

                

                <span class="comment-age">(18 Feb '11, 09:27)</span>
                <a class="comment-user userinfo" href="/users/722/ipittam">ipittam</a>
                
            </div>
        </div>
    
        <a name="2418"></a>
        <div class="comment" id="comment-2418">
            <div id="post-2418-score" class="comment-score"></div>
            <div class="comment-text"><p>Am I right in saying that this could be too do with processing delays on the ACE device due to SSL processing?</p>

<p>Could it also be due to a downstream device throttling the connection &amp; this being passed down the stream to the ACE &amp; eventually to the sending Web Server?</p>

<p>(Web Server &gt; Cisco ACE &gt; Intermediate router &gt; ....Client)</p>

<p>Thanks
Ian</p></div>
            <div class="comment-info" id="comment-2418-info">
                
                
                
                

                

                <span class="comment-age">(18 Feb '11, 09:27)</span>
                <a class="comment-user userinfo" href="/users/722/ipittam">ipittam</a>
                
            </div>
        </div>
    
        <a name="2428"></a>
        <div class="comment" id="comment-2428">
            <div id="post-2428-score" class="comment-score"></div>
            <div class="comment-text"><p>SSL processing might be a reason why the window drops to zero since it adds further encryption load on the devices apart from just transfering data. If you still have the zero window problem you should track down the origin of which device advertises that window and performance tune it or (worst case) replace it with a more powerful device.</p></div>
            <div class="comment-info" id="comment-2428-info">
                
                
                
                

                

                <span class="comment-age">(19 Feb '11, 11:19)</span>
                <a class="comment-user userinfo" href="/users/145/jasper">Jasper ♦♦</a>
                
            </div>
        </div>
    
        <a name="2449"></a>
        <div class="comment" id="comment-2449">
            <div id="post-2449-score" class="comment-score"></div>
            <div class="comment-text"><p>Ok... not to cast stones or anything.... but... "the Cisco is struggling with flow &amp; reducing the TCP Window"... that makes me gag. Aren't these guys the gurus of infrastructure and data flow? I'm gonna just say it outright... they stink if they are adjusting the Window Size value - do we have any Cisco folks hanging around here? I've seen Cisco products kill SACK in the handshake too... can you take a trace at both ends of a TCP handshake and see what they are doing to the TCP options fields? ... breathing deeply now... going to my happy place... &lt;g&gt;</p></div>
            <div class="comment-info" id="comment-2449-info">
                
                
                
                

                

                <span class="comment-age">(21 Feb '11, 02:13)</span>
                <a class="comment-user userinfo" href="/users/7/lchappell">lchappell ♦</a>
                
            </div>
        </div>
    
        <a name="2477"></a>
        <div class="comment" id="comment-2477">
            <div id="post-2477-score" class="comment-score"></div>
            <div class="comment-text"><p>I can see you being able to selectively disable SACK in ACE.  Unless the ACE box is being hammered I don't see it being the choke point for the SSL communications, those boxes have ASICs dedicated to crypto.</p></div>
            <div class="comment-info" id="comment-2477-info">
                
                
                
                

                

                <span class="comment-age">(22 Feb '11, 06:26)</span>
                <a class="comment-user userinfo" href="/users/67/geonjay">GeonJay</a>
                
            </div>
        </div>
    
        <a name="2583"></a>
        <div class="comment not_top_scorer" id="comment-2583">
            <div id="post-2583-score" class="comment-score"></div>
            <div class="comment-text"><p>If there IS an ACE module please really be SURE that both ends of the communication really have identical TCP headers + options... We also had issues with cisco devices cutting the options field during transfer which only came out doing a multi-point trace. So like Laura said keep that in mind and because I nearly vomited at that point at a recent project I could not not comment this here :)</p></div>
            <div class="comment-info" id="comment-2583-info">
                
                
                
                

                

                <span class="comment-age">(28 Feb '11, 06:31)</span>
                <a class="comment-user userinfo" href="/users/146/landi">Landi</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-2384" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 6
        </span>
        <a href="#" class="show-all-comments-link">show 1 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-2384-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="2371"></a>
                    <div id="answer-container-2371" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-2371-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/2371/up/" rel="nofollow"> </a>
<div id="post-2371-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-2371-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/2371/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Usually the window scaling should be set to a value high enough to continuously transfer packets without having to stop and wait for an ACK to arrive. The bytes in flight can not exceed the effective window size.</p>
<p>If window scaling is enabled you'll see that both station negotiate the window scale factor in their SYN packets, which is then used to calculate the effective window size as "2 to the power of &lt;scale factor=""&gt; multiplied by the 'normal' 16bit window size". The latest development builds of Wireshark show both values, "normal" window size and scaled window size.</p>
<p>I have seen intermediate devices change the window size, resulting in a very ineffective communication (usually packet shaping or prioritizing devices, layer3 devices usually don't do this). You can check that by comparing window size and scale factors when capturing both at client and server: both should show the same values - if not, an intermediate device fumbles around with your packets. </p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/2371/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>16 Feb '11, 08:33</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" alt="Jasper's gravatar image" />
    <p><a href="/users/145/jasper">Jasper ♦♦</a><br/>
    <span class="score" title="23806 reputation points"><span class="">23.8k</span></span><span title="5 badges"><span class="badge1">&#9679;</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">&#9679;</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">&#9679;</span><span class="badgecount">284</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Jasper has 263 accepted answers">18&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-2371">
    
        <a name="2376"></a>
        <div class="comment" id="comment-2376">
            <div id="post-2376-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks Jasper</p>

<p>So is the fact that we see different communication conversations at each end meaning that the intermediate networks devices are altering the flow.</p>

<p>Am I right in presuming that this flow control would be different for each intermediate hop?</p>

<p>Thanks again!
Ian</p></div>
            <div class="comment-info" id="comment-2376-info">
                
                
                
                

                

                <span class="comment-age">(16 Feb '11, 09:35)</span>
                <a class="comment-user userinfo" href="/users/722/ipittam">ipittam</a>
                
            </div>
        </div>
    
        <a name="2388"></a>
        <div class="comment" id="comment-2388">
            <div id="post-2388-score" class="comment-score"></div>
            <div class="comment-text"><p>What kind of differences do you see? Different window sizes and/or scale factors for the exact same packets? Are there any devices doing NAT?</p>

<p>I'm not sure what you mean with "different flow control for intermediate hops". Usually TCP flows are not modified by network devices except when NATting, or if a traffic shaper/prioritizing device is used.</p></div>
            <div class="comment-info" id="comment-2388-info">
                
                
                
                

                

                <span class="comment-age">(16 Feb '11, 15:33)</span>
                <a class="comment-user userinfo" href="/users/145/jasper">Jasper ♦♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-2371" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-2371-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/2365/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='6xqSjn4DGNLkuYZvxLvQXEpVZcP9bgtg' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/2365/tcp-window-size-and-scaling?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/2365/tcp-window-size-and-scaling?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/tcp/"
            class="tag-link-tcp"
            title="see questions tagged'tcp'using tags"
            rel="tag">tcp</a> <span class="tag-number">&#215;752</span><br/>
        
        <a href="/tags/window/"
            class="tag-link-window"
            title="see questions tagged'window'using tags"
            rel="tag">window</a> <span class="tag-number">&#215;55</span><br/>
        
        <a href="/tags/size/"
            class="tag-link-size"
            title="see questions tagged'size'using tags"
            rel="tag">size</a> <span class="tag-number">&#215;41</span><br/>
        
        <a href="/tags/scaling/"
            class="tag-link-scaling"
            title="see questions tagged'scaling'using tags"
            rel="tag">scaling</a> <span class="tag-number">&#215;10</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Feb. 16, 2011, 5:07 a.m.">16 Feb '11, 05:07</strong>
    </p>
    <p> 
     	question was seen: <strong>138,857 times</strong>
    </p>
    <p> 
        last updated: <strong title="Feb. 28, 2011, 6:31 a.m.">28 Feb '11, 06:31</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/24316/tcp-window-size">TCP window Size</a>
        </p>
        
        <p>
            <a href="/questions/10071/window-size-scaling-factor-1-unknown">[Window size scaling factor: -1 (unknown)]</a>
        </p>
        
        <p>
            <a href="/questions/13660/proxy-and-window-scaling-factor-of-0">Proxy and Window scaling factor of 0</a>
        </p>
        
        <p>
            <a href="/questions/7428/tcp-window-size-and-acknowledgment">Tcp Window Size and acknowledgment</a>
        </p>
        
        <p>
            <a href="/questions/45397/tcp-window-scaling-option">TCP Window Scaling option</a>
        </p>
        
        <p>
            <a href="/questions/26044/tcp-window-sizes">TCP window sizes</a>
        </p>
        
        <p>
            <a href="/questions/36657/tcp-window-scaling-handshake-and-data-traffic-difference">TCP Window Scaling - handshake and data traffic difference?</a>
        </p>
        
        <p>
            <a href="/questions/24978/dependencies-between-throughput-and-tcp-window">Dependencies between throughput and TCP window</a>
        </p>
        
        <p>
            <a href="/questions/20156/windows-size-256">Windows size 256</a>
        </p>
        
        <p>
            <a href="/questions/15885/wireshark-filter-for-window-size">Wireshark filter for window size</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
