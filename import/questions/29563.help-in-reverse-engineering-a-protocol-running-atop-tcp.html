<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Help in reverse-engineering a protocol running atop TCP - Wireshark Q&amp;A</title>
        <meta name="description" content="Hi all, I&#39;m having an issue understanding how a program communicates with a device for sending table entries from a database. It can send thousands of entries but it will send them in blocks containing 16 table entries per block which, right now my data equals about 520 blocks before its done sendin..." />
        <meta name="keywords" content="checksum,packet,crc" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/29563/help-in-reverse-engineering-a-protocol-running-atop-tcp" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/29563/help-in-reverse-engineering-a-protocol-running-atop-tcp?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='7jqc49l2c3WZVGLqLUhcisD1YeegYpmp' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/29563/help-in-reverse-engineering-a-protocol-running-atop-tcp">Help in reverse-engineering a protocol running atop TCP</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-29563-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/29563/up/" rel="nofollow"> </a>
<div id="post-29563-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-29563-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/29563/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/29563/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hi all,</p>
<p>I'm having an issue understanding how a program communicates with a device for sending table entries from a database.  It can send thousands of entries but it will send them in blocks containing 16 table entries per block which, right now my data equals about 520 blocks before its done sending data.<br>
</p>
<p>The problem I'm having is understanding how it verifies that the data in each block is correct (a checksum or crc?).  After the TCP header of each block there's a sequence of bits that are the same in every block and I assume this sequence is telling the device it wants to send another block.  Each block also ends the same, 2 octets that are always the same and then 2 octets that are different.  The octets that are different is what has me stumped.  If these final 16 bits are wrong then the device kills communication.  I haven't been able to find anything on the internet regarding a checksum or crc that is placed at the end of the data section in a packet, all I've found info on is the checksum in the tcp header.  I've ran brute force tools against many captured blocks of data without any luck of finding a crc polynomial.</p>
<p>Would anyone be able to help me out with this problem?  Perhaps I'm missing something or just don't understand how data is sent.  I'm pretty sure this data is being sent using a synchronous socket since it waits for a reply from the device before sending the next block.  But outside of that I'm not sure if there's something in the code of the application and the device that uses a proprietary way of checking the data in the block or if this is something standard with device communication.</p>
<p>I am providing a link to download wireshark file. Each packet (from source IP 192.168.1.115) ends in 10 03 then the 2 octets I'm trying to "crack".  Again, not sure if its some sort of checksum or crc.</p>
<p><a href="http://www.mediafire.com/download/mt3ph1dazlv44gr/help.pcapng">http://www.mediafire.com/download/mt3ph1dazlv44gr/help.pcapng</a></p>
<p>Thank you for any help, its greatly appreciated!</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/checksum/" class="post-tag tag-link-checksum"
                                        title="see questions tagged 'checksum'" rel="tag">checksum</a>
                                
                                    <a href="/tags/packet/" class="post-tag tag-link-packet"
                                        title="see questions tagged 'packet'" rel="tag">packet</a>
                                
                                    <a href="/tags/crc/" class="post-tag tag-link-crc"
                                        title="see questions tagged 'crc'" rel="tag">crc</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>08 Feb '14, 22:53</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/b31f8a25e65b77f3925b1fa825dbe336?s=32&amp;d=identicon&amp;r=g" alt="dirtyrobinson's gravatar image" />
    <p><a href="/users/6641/dirtyrobinson">dirtyrobinson</a><br/>
    <span class="score" title="11 reputation points">11</span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="3 badges"><span class="silver">&#9679;</span><span class="badgecount">3</span></span><span title="5 badges"><span class="bronze">&#9679;</span><span class="badgecount">5</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="dirtyrobinson has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/29563/">
                edited
                <strong>12 Feb '14, 20:22</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" alt="Guy%20Harris's gravatar image" />
            <p><a href="/users/79/guy-harris">Guy Harris ♦♦</a><br/>
            <span class="score" title="17443 reputation points"><span class="">17.4k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">&#9679;</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">&#9679;</span><span class="badgecount">196</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-29563">
    
        <a name="29655"></a>
        <div class="comment" id="comment-29655">
            <div id="post-29655-score" class="comment-score"></div>
            <div class="comment-text"><p>I'll see if the company that made the software would share how to communicate with their device, thanks guys for looking at it.  I appreciate it!</p>

<p>Jason</p></div>
            <div class="comment-info" id="comment-29655-info">
                
                
                
                

                

                <span class="comment-age">(10 Feb '14, 14:44)</span>
                <a class="comment-user userinfo" href="/users/6641/dirtyrobinson">dirtyrobinson</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-29563" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-29563-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    3 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/29563/help-in-reverse-engineering-a-protocol-running-atop-tcp?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/29563/help-in-reverse-engineering-a-protocol-running-atop-tcp?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/29563/help-in-reverse-engineering-a-protocol-running-atop-tcp?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/29563/help-in-reverse-engineering-a-protocol-running-atop-tcp?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="29573"></a>
                    <div id="answer-container-29573" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-29573-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/29573/up/" rel="nofollow"> </a>
<div id="post-29573-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-29573-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/29573/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>TCP has a checksum in the header that is used to verify integrity of the TCP header AND the TCP data section, so TCP itself takes care of the data block being correct (as much as you can do that with a 16 bit CRC, of course). Usually, data transported by TCP does not have an additional checksum in the data itself, because the segmentation process of TCP could cut it from the current packet and transmit it as first part of the next packet. If an application wants to put a specific checksum in a TCP packet data segment it must control the creation of the whole segment, which is a lot more complex than just sending the data and trusting on the CRC of TCP.</p>
<p>Now, if a communication using TCP as a transport protocol implements an additional checksum mechanism (like you assume to be the last 2 bytes of the payload) you need to have the specification of how the checksum is calculated. If you don't have that you can only guess or try to reverse engineer how it is calculated, but that may be a frustrating task. The only good thing is that you think that it is only 2 bytes long, which means that the calculation is probably a pretty simple algorithm. Keep in mind that you'll have to calculate the CRC on the data segment only, not the full packet, so you need to extract the data bytes after the TCP header and run your brute force tools on that.</p>
<p>So you should try to find the protocol specifications for the stuff that is transported after the TCP header. Since you already know some details about it (when you say there are 16 table entries per packet) you seem to have access to that.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/29573/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>09 Feb '14, 03:23</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" alt="Jasper's gravatar image" />
    <p><a href="/users/145/jasper">Jasper ♦♦</a><br/>
    <span class="score" title="23806 reputation points"><span class="">23.8k</span></span><span title="5 badges"><span class="badge1">&#9679;</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">&#9679;</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">&#9679;</span><span class="badgecount">284</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Jasper has 263 accepted answers">18&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-29573">
    
        <a name="29593"></a>
        <div class="comment" id="comment-29593">
            <div id="post-29593-score" class="comment-score"></div>
            <div class="comment-text"><p>What I don't have access to is the source code that explains how it splits everything, I just know that it takes a file in hex then splits it after every 1264 bits, it adds 16 bits of data before each block of the file is transmitted then it adds 4 bits at the end, since I don't have the source I don't know how its determining the final 2 bits.  I can only decompile the app and watch the assembly code.<br>
</p>

<p>Are there any other options as to what those 2 bytes may be?  I only know of 2 options, its either a checksum or a crc. </p></div>
            <div class="comment-info" id="comment-29593-info">
                
                
                
                

                

                <span class="comment-age">(09 Feb '14, 23:00)</span>
                <a class="comment-user userinfo" href="/users/6641/dirtyrobinson">dirtyrobinson</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-29573" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-29573-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="29618"></a>
                    <div id="answer-container-29618" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-29618-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/29618/up/" rel="nofollow"> </a>
<div id="post-29618-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-29618-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/29618/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <blockquote>
<p>Are there any other options as to what those 2 bytes may be? </p>
</blockquote>
<p>could be anything. </p>
<blockquote>
<p>I only know of 2 options, its either a checksum or a crc. </p>
</blockquote>
<p>a crc is just an algorithm to implementat a checksum.</p>
<p>If you look thoroughly at the packets, you'll find a 'clear' structure </p>
<p>There is</p>
<ul>
<li>a record 'magic' number: 10 53 10 50 10 53 (wich is '.S.P.S' in ASCII)</li>
<li>there is (probably) a record start delimiter: 10 02</li>
<li>there is (probably) a record end delimiter: 10 03</li>
<li>there are some bytes that are unclear at the beginning, after the start delimiter</li>
<li>there are those two bytes at the end, probably some form of a checksum</li>
</ul>
<p>To sum it up: It's probably better to ask the vendor of the software about the structure of the data, unless you have much more data and a <strong>lot of time</strong> to analyze the data structure. If that later applies, you could try to 'brute force' the last two bytes, by trying several known checksum algorithms that produce a 16 bit output. <strong>However</strong> keep in mind, that the developer of the software might have created its own checksum algorithm. If that is the case, you will have no chance at all to figure out that algorithm, just by looking at the packet bytes.</p>
<p>So, again: It's probably better to ask the vendor of the software or to reverse engineer the software with a debugger/disassembler.</p>
<p>Regards<br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/29618/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>10 Feb '14, 04:23</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/29618/">
                edited
                <strong>10 Feb '14, 15:09</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-29618">
    
        <a name="29791"></a>
        <div class="comment" id="comment-29791">
            <div id="post-29791-score" class="comment-score"></div>
            <div class="comment-text"><p>The company that made the software is of no help, I was kind of expecting the response I got though.  They would only share the function if there was a sales opportunity for them.</p></div>
            <div class="comment-info" id="comment-29791-info">
                
                
                
                

                

                <span class="comment-age">(12 Feb '14, 13:36)</span>
                <a class="comment-user userinfo" href="/users/6641/dirtyrobinson">dirtyrobinson</a>
                
            </div>
        </div>
    
        <a name="29792"></a>
        <div class="comment" id="comment-29792">
            <div id="post-29792-score" class="comment-score"></div>
            <div class="comment-text"><p>O.K. then tell them you will decide a 10 million deal, but only after you get the information you need :-))</p>

<p>BTW: why do you need that information? What are you trying to do?</p></div>
            <div class="comment-info" id="comment-29792-info">
                
                
                
                

                

                <span class="comment-age">(12 Feb '14, 14:12)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="29793"></a>
        <div class="comment" id="comment-29793">
            <div id="post-29793-score" class="comment-score"></div>
            <div class="comment-text"><p>Its for my cash registers, the programs that can communicate with it lack "customability" when it comes to reports and inventory.  The PC program creates files of the data from the register and the program I created can edit and pull data from the files created by the PC program.  I'm getting tired of having to use the vendor's software to send information back to the register.<br>
</p>

<p>I matched my data with the streams created by the cash register and everything is an exact match except for whatever those final 2 bytes are.</p></div>
            <div class="comment-info" id="comment-29793-info">
                
                
                
                

                

                <span class="comment-age">(12 Feb '14, 15:09)</span>
                <a class="comment-user userinfo" href="/users/6641/dirtyrobinson">dirtyrobinson</a>
                
            </div>
        </div>
    
        <a name="29794"></a>
        <div class="comment" id="comment-29794">
            <div id="post-29794-score" class="comment-score"></div>
            <div class="comment-text"><p>Well, then I would take the debugger/disassembler approach.</p>

<p>What happens if you send data with the wrong 'checksum'?</p></div>
            <div class="comment-info" id="comment-29794-info">
                
                
                
                

                

                <span class="comment-age">(12 Feb '14, 15:16)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="29796"></a>
        <div class="comment" id="comment-29796">
            <div id="post-29796-score" class="comment-score"></div>
            <div class="comment-text"><p>Is the software Java or .net based?</p></div>
            <div class="comment-info" id="comment-29796-info">
                
                
                
                

                

                <span class="comment-age">(12 Feb '14, 15:25)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="29798"></a>
        <div class="comment not_top_scorer" id="comment-29798">
            <div id="post-29798-score" class="comment-score"></div>
            <div class="comment-text"><p>Can you post the software on dropbox?</p></div>
            <div class="comment-info" id="comment-29798-info">
                
                
                
                

                

                <span class="comment-age">(12 Feb '14, 15:30)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="29800"></a>
        <div class="comment not_top_scorer" id="comment-29800">
            <div id="post-29800-score" class="comment-score"></div>
            <div class="comment-text"><p>No PM here, but if you click my name, you'll find my e-mail address.</p></div>
            <div class="comment-info" id="comment-29800-info">
                
                
                
                

                

                <span class="comment-age">(12 Feb '14, 15:54)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="29807"></a>
        <div class="comment not_top_scorer" id="comment-29807">
            <div id="post-29807-score" class="comment-score"></div>
            <div class="comment-text"><p>crc16tbl is odd. That could be a sign for a mapping table for a 'custom' CRC16 code. If that is the case you need to analyze the code to reverse engineer their CRC16 algorithm and the table.</p></div>
            <div class="comment-info" id="comment-29807-info">
                
                
                
                

                

                <span class="comment-age">(12 Feb '14, 17:01)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="29822"></a>
        <div class="comment not_top_scorer" id="comment-29822">
            <div id="post-29822-score" class="comment-score"></div>
            <div class="comment-text"><p>UPDATE: the OP has deleted some of his comments. As a result, my comments cannot be fully understood in the now void context :-(</p></div>
            <div class="comment-info" id="comment-29822-info">
                
                
                
                

                

                <span class="comment-age">(13 Feb '14, 00:17)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-29618" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 9
        </span>
        <a href="#" class="show-all-comments-link">show 4 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-29618-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="29824"></a>
                    <div id="answer-container-29824" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-29824-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/29824/up/" rel="nofollow"> </a>
<div id="post-29824-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-29824-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/29824/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>If it's encrypted you do have a chance (in fact, you have a 100% chance if you handle it right): the key must reside somewhere on your computer. Just pop open your favorite debugger, watch for a bit (err, a hundred bytes or so I'd hope) of data to come in from a socket, set a watchpoint on that data, and look at the stack traces of things that access it. If you're really lucky, you might even see it get decrypted in place. If not, you'll probably pick up on the fact that they're using a standard encryption algorithm (they'd be fools not to from a theoretical security standpoint) either by looking at stack traces (if you're lucky) or by using one of the pf6x9j1 / S-box profilers out there (avoid the academic ones, most of them don't work without a lot of trouble). Many encryption algorithms use blocks of "standard data" that can be detected (these are the IVs / S-boxes), these are what you look for in the absence of other information. Whatever you find, google it, and try to override their encryption library to dump the data that's being encrypted/decrypted. From these dumps, <strong><a href="http://www.please.dont.spam.this.site">(PRODUCT SPAM REMOVED)</a></strong> should be relatively easy to see what's going on.</p>
<p>REing an encrypted session can be a lot of fun, but it requires skill with your debugger and lots of reading. It can be frustrating but you won't be sorry if you spend the time to learn how to do it :)</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/29824/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>13 Feb '14, 00:56</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/c03f8825d72ddaaecb18f8a6762c4207?s=32&amp;d=identicon&amp;r=g" alt="cusabio1's gravatar image" />
    <p><a href="/users/6681/cusabio1">cusabio1</a><br/>
    <span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="bronze">&#9679;</span><span class="badgecount">1</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="cusabio1 has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/29824/">
                edited
                <strong>13 Feb '14, 01:29</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
            <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
            <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span></p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-29824">
    
</div>
<div id="comment-tools-29824" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-29824-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/29563/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='7jqc49l2c3WZVGLqLUhcisD1YeegYpmp' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/29563/help-in-reverse-engineering-a-protocol-running-atop-tcp?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/29563/help-in-reverse-engineering-a-protocol-running-atop-tcp?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/packet/"
            class="tag-link-packet"
            title="see questions tagged'packet'using tags"
            rel="tag">packet</a> <span class="tag-number">&#215;248</span><br/>
        
        <a href="/tags/checksum/"
            class="tag-link-checksum"
            title="see questions tagged'checksum'using tags"
            rel="tag">checksum</a> <span class="tag-number">&#215;36</span><br/>
        
        <a href="/tags/crc/"
            class="tag-link-crc"
            title="see questions tagged'crc'using tags"
            rel="tag">crc</a> <span class="tag-number">&#215;6</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Feb. 8, 2014, 10:53 p.m.">08 Feb '14, 22:53</strong>
    </p>
    <p> 
     	question was seen: <strong>5,982 times</strong>
    </p>
    <p> 
        last updated: <strong title="Feb. 13, 2014, 1:29 a.m.">13 Feb '14, 01:29</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/58985/incoming-udp-only-works-while-capturing-packages-with-wireshark">Incoming UDP only works while capturing packages with Wireshark</a>
        </p>
        
        <p>
            <a href="/questions/62314/crc-calculation-of-fragmented-udp-packet-marked-as-incorrect-even-if-it-is-verified-as-valid">CRC calculation of fragmented UDP packet marked as incorrect. Even if it is verified as valid.</a>
        </p>
        
        <p>
            <a href="/questions/520/is-there-a-way-to-show-all-packet-captures-for-one-site-capture">Is there a way to show all packet captures for one site capture</a>
        </p>
        
        <p>
            <a href="/questions/2255/separating-the-header-from-the-packet">separating the header from the packet</a>
        </p>
        
        <p>
            <a href="/questions/6547/how-to-scrape-packet-data">How to scrape packet data?</a>
        </p>
        
        <p>
            <a href="/questions/10022/making-a-dissector-that-filters-packets">Making a dissector that filters packets</a>
        </p>
        
        <p>
            <a href="/questions/14075/can-not-see-packets-from-local-machine">Can not see packets from local machine</a>
        </p>
        
        <p>
            <a href="/questions/18239/wireshark-packet-forwarding">Wireshark Packet Forwarding</a>
        </p>
        
        <p>
            <a href="/questions/23522/capture-packets-from-my-broadband-modem">Capture packets from my Broadband Modem</a>
        </p>
        
        <p>
            <a href="/questions/27862/extra-octets-in-packets-in-a-capture-file">Extra octets in packets in a capture file</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
