<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Modbus TCP connection drops after 7 hours and 20 minutes - Wireshark Q&amp;A</title>
        <meta name="description" content="VMware ESXi 5.5 Windows Server 2012 connected via VLAN with 3 hops (Cisco switches) to Modbus TCP Devices: Advantech ADAM-5000/TCP (x5) Advantech ADAM-6260 TCP. (x1) The devices can be polled using the Advantech ADAM/Apax.net utility version 2.05.10. I&#39;m running Wonderware System Platform 2014 R2 SP..." />
        <meta name="keywords" content="modbus,ack,fin,tcp,rst" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/60799/modbus-tcp-connection-drops-after-7-hours-and-20-minutes" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/60799/modbus-tcp-connection-drops-after-7-hours-and-20-minutes?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='XjjHnS723p4FqWwqR8mj3c6SxcmJJcQV' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/60799/modbus-tcp-connection-drops-after-7-hours-and-20-minutes">Modbus TCP connection drops after 7 hours and 20 minutes</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-60799-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/60799/up/" rel="nofollow"> </a>
<div id="post-60799-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-60799-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/60799/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/60799/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>VMware ESXi 5.5 Windows Server 2012 connected via VLAN with 3 hops (Cisco switches) to Modbus TCP Devices:</p>
<p>Advantech ADAM-5000/TCP (x5)
Advantech ADAM-6260 TCP. (x1)</p>
<p>The devices can be polled using the Advantech ADAM/Apax.net utility version 2.05.10.</p>
<p>I'm running Wonderware System Platform 2014 R2 SP1 as the SCADA with DASMBTCP Version 3.0.1 Data Acquisition Server.</p>
<p>The ADAM-6260 device is rock solid and never loses connection.</p>
<p>The ADAM-5000/TCP devices all drop connection via port502 after 7 hours 20 minutes of stable operation.</p>
<p>Pinging the devices is always possible, even after the Modbus TCP port closes.</p>
<p>A physical reset of the ADAM5000 brings the device back to life.</p>
<p>If I connect a Win7 laptop to the Server switch and route through the VLAN to the ADAM 5000, connection is rock solid.</p>
<p>If I connect a Win7 laptop to the ADAM 5000 via cross-over cable the connection is rock solid.</p>
<p>As soon as the device is connected and polled from the VMWare Windows Server 2012, the Modbus TCP fails after 7 hours and 20 minutes.</p>
<p>I've tried using a Telnet client but Port 502 is definitely closed.</p>
<p>The Advantech Utility error message is "Connect Module Failed! Reached maximum number of connections"</p>
<p>The issue seems to be independent of the Wonderware DA Server or the Advantech ADAM/Apax.net Utility because when both are disabled / not polling the devices still drop out after the 7hrs20mins.</p>
<p>The ADAM6260 is solid and Advantech support put this down to a function / feature called "Host Idle Timeout". This is not available on the ADAM5000, although I have requested it.</p>
<p>The table below should help guide through the Wireshark log</p>
<ul>
<li>IP Source -  123.111.4.101</li>
<li>IP Dest -    123.111.4.10</li>
<li>Device   ADAM 5000L TCP</li>
<li>Source Port before drop out  53609</li>
<li>Source Port after drop out     61587</li>
<li>
<p>Time in wireshark log    16:04:51</p>
<p>55688   2017-04-12 16:04:01.496375  123.111.4.10    123.111.4.101   Modbus/TCP  79  Response: Trans:  1319; Unit:   1, Func:   3: Read Holding Registers  <br>
55726   2017-04-12 16:04:01.557603  123.111.4.101   123.111.4.10    TCP 54  53609 → 502 [ACK] Seq=469 Ack=976 Win=64867 Len=0 <br>
57140   2017-04-12 16:04:11.495071  123.111.4.101   123.111.4.10    Modbus/TCP  66     Query: Trans:  1320; Unit:   1, Func:   3: Read Holding Registers  <br>
57162   2017-04-12 16:04:11.616774  123.111.4.10    123.111.4.101   TCP 60  502 → 53609 [ACK] Seq=976 Ack=481 Win=2368 Len=0  <br>
62801   2017-04-12 16:04:51.493880  123.111.4.101   123.111.4.10    TCP 54  53609 → 502 [FIN, ACK] Seq=481 Ack=976 Win=64867 Len=0<br>
62802   2017-04-12 16:04:51.494132  123.111.4.101   123.111.4.10    TCP 66  61582 → 502 [SYN, ECN, CWR] Seq=0 Win=8192 Len=0 MSS=1460 WS=256 SACK_PERM=1  <br>
62803   2017-04-12 16:04:51.495346  123.111.4.10    123.111.4.101   TCP 60  502 → 53609 [ACK] Seq=976 Ack=482 Win=2367 Len=0  <br>
62804   2017-04-12 16:04:51.496270  123.111.4.10    123.111.4.101   TCP 60  502 → 61582 [SYN, ACK] Seq=0 Ack=1 Win=2368 Len=0 MSS=528 <br>
62805   2017-04-12 16:04:51.496303  123.111.4.101   123.111.4.10    TCP 54  61582 → 502 [ACK] Seq=1 Ack=1 Win=65392 Len=0 <br>
62806   2017-04-12 16:04:51.496403  123.111.4.101   123.111.4.10    Modbus/TCP  66     Query: Trans:  1321; Unit:   1, Func:   3: Read Holding Registers  <br>
62807   2017-04-12 16:04:51.497312  123.111.4.10    123.111.4.101   TCP 60  502 → 61582 [RST, ACK] Seq=1 Ack=1 Win=2368 Len=0 <br>
62808   2017-04-12 16:04:51.498110  123.111.4.10    123.111.4.101   TCP 60  502 → 61582 [RST, ACK] Seq=1 Ack=13 Win=2368 Len=0<br>
64258   2017-04-12 16:05:01.493965  123.111.4.101   123.111.4.10    TCP 66  61587 → 502 [SYN, ECN, CWR] Seq=0 Win=8192 Len=0 MSS=1460 WS=256 SACK_PERM=1  <br>
64259   2017-04-12 16:05:01.494879  123.111.4.10    123.111.4.101   TCP 60  502 → 61587 [SYN, ACK] Seq=0 Ack=1 Win=2368 Len=0 MSS=528 <br>
</p>
</li>
</ul>
<p>I wanted to attach several screenshot of Packet Captures and upload a capture to Cloudshark but I'm unable to due to company policy and I'm unable to add files directly to this post.</p>
<p>Any Guidance or insights would be very much appreciated, I've been working on this issue for 6 weeks now. Many thanks in advance.</p>
<p>Chris Dell.</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/modbus/" class="post-tag tag-link-modbus"
                                        title="see questions tagged 'modbus'" rel="tag">modbus</a>
                                
                                    <a href="/tags/ack/" class="post-tag tag-link-ack"
                                        title="see questions tagged 'ack'" rel="tag">ack</a>
                                
                                    <a href="/tags/fin/" class="post-tag tag-link-fin"
                                        title="see questions tagged 'fin'" rel="tag">fin</a>
                                
                                    <a href="/tags/tcp/" class="post-tag tag-link-tcp"
                                        title="see questions tagged 'tcp'" rel="tag">tcp</a>
                                
                                    <a href="/tags/rst/" class="post-tag tag-link-rst"
                                        title="see questions tagged 'rst'" rel="tag">rst</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>13 Apr '17, 03:47</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/e68368a38dcd75843db14f9d9e7f6e6b?s=32&amp;d=identicon&amp;r=g" alt="chrisdell's gravatar image" />
    <p><a href="/users/29025/chrisdell">chrisdell</a><br/>
    <span class="score" title="26 reputation points">26</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="6 badges"><span class="bronze">&#9679;</span><span class="badgecount">6</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="chrisdell has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/60799/">
                edited
                <strong>13 Apr '17, 14:51</strong>
            </a>
        </p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-60799">
    
</div>
<div id="comment-tools-60799" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-60799-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/60799/modbus-tcp-connection-drops-after-7-hours-and-20-minutes?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/60799/modbus-tcp-connection-drops-after-7-hours-and-20-minutes?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/60799/modbus-tcp-connection-drops-after-7-hours-and-20-minutes?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/60799/modbus-tcp-connection-drops-after-7-hours-and-20-minutes?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="60800"></a>
                    <div id="answer-container-60800" class="answer accepted-answer">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-60800-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/60800/up/" rel="nofollow"> </a>
<div id="post-60800-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-60800-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/60800/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="chrisdell has selected this answer as the correct answer"
        href="/accept_answer/60800/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Working with the brief text excerpt of the capture I can see the following:</p>
<ul>
<li>In frame 57140 the master makes a slave query (from port 53609)</li>
<li>In frame 57162 the slave sends a TCP ack for the query segment</li>
<li>In frame 62801, 40 seconds after the query, the master closes the connection with a FIN, probably due to timeout for no slave reply.</li>
<li>In frame 62802 the master opens another connection (from port 61582).</li>
<li>In frame 62803 the slave acknowledges the FIN from 62801 but doesn't supply its own FIN keeping the connection alive.</li>
<li>In frame 62804 the slave responds to the SYN in frame 62802 with its own SYN.</li>
<li>In frame 62805 the master completes the 3-way handshake for the connection from port 61582.</li>
<li>In frame 62806 the master sends a query, presumably using the connection just established.</li>
<li>In frames 62807 &amp; 8 the slave sends TCP RST's for port 61582,thus closing the connection.</li>
<li>In frame 64258 the master attempts to open another connection (port 61587).</li>
<li>In frame 64259 the slave responds to the SYN in frame 64258 with its own SYN.</li>
</ul>
<p>In summary, the master sends a requests, the slave fails to respond, the master closes the connection, the slave fails to complete the connection close, the master successfully opens another connection and sends a query to which the slave hard-closes the connection.</p>
<p>Looks to me like an application issue on the slave.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/60800/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>13 Apr '17, 05:22</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" alt="grahamb's gravatar image" />
    <p><a href="/users/1225/grahamb">grahamb ♦</a><br/>
    <span class="score" title="19834 reputation points"><span class="">19.8k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">&#9679;</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">&#9679;</span><span class="badgecount">206</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="grahamb has 274 accepted answers">22&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-60800">
    
        <a name="60803"></a>
        <div class="comment" id="comment-60803">
            <div id="post-60803-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks for your quick response Graham.  I've tried to get the vendor to make a firmware change but so far I've hit resistance.  If you don't mind I'm going to send your explanation to Advantech and see if they can make any firmware change.</p></div>
            <div class="comment-info" id="comment-60803-info">
                
                
                
                

                

                <span class="comment-age">(13 Apr '17, 08:05)</span>
                <a class="comment-user userinfo" href="/users/29025/chrisdell">chrisdell</a>
                
            </div>
        </div>
    
        <a name="60806"></a>
        <div class="comment" id="comment-60806">
            <div id="post-60806-score" class="comment-score"></div>
            <div class="comment-text"><p>Having access to the full capture would also enable analysis of other things such as multiple master connection attempts etc.</p>

<p>Personally I don't think there's any sensitive data in a Modbus capture, it's only register values.  The exception is where multiple registers are used to return such things as strings, then there might be sensitive data. The IP addresses can be anonymized, but you've already shown those (although they might have been fuzzed).</p></div>
            <div class="comment-info" id="comment-60806-info">
                
                
                
                

                

                <span class="comment-age">(13 Apr '17, 08:57)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="60820"></a>
        <div class="comment" id="comment-60820">
            <div id="post-60820-score" class="comment-score"></div>
            <div class="comment-text"><p>This afternoon I tried a Tofino Modbus Firewall between the network and the ADAM5000 and early tests are looking good. The units aren't pingable anymore but the Modbus traffic is steady.  I'll know for sure over the weekend.</p></div>
            <div class="comment-info" id="comment-60820-info">
                
                
                
                

                

                <span class="comment-age">(13 Apr '17, 13:34)</span>
                <a class="comment-user userinfo" href="/users/29025/chrisdell">chrisdell</a>
                
            </div>
        </div>
    
        <a name="60822"></a>
        <div class="comment" id="comment-60822">
            <div id="post-60822-score" class="comment-score"></div>
            <div class="comment-text"><p>I missed the part in your question about it only being a problem when running in VMWare.</p>

<p>This implies that the VMWare solution is doing something different, in which case where are you capturing?  If capturing on the VMWare guest or host you may not be seeing the "real" network traffic.  Ideally capture with a tap or mirror or span port between the slave and it's switch.</p>

<p>As it works other than when under VMWare, it would seem that the different behaviour can only be seen by analysing the full captures.  As your're unable to provide them, then you're on your own there.</p>

<p>The Modbus firewall must be subtly modifying the traffic in some way such that it doesn't trigger the abnormal slave behaviour.  Again you'll need to analyse the captures (again at the slave side of the switch) to try and spot any differences.</p></div>
            <div class="comment-info" id="comment-60822-info">
                
                
                
                

                

                <span class="comment-age">(13 Apr '17, 15:40)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="60829"></a>
        <div class="comment" id="comment-60829">
            <div id="post-60829-score" class="comment-score"></div>
            <div class="comment-text"><p>The unit in between the firewall device has been stable for over 16 hours now. I'm going to implement this as the solution.  Further investigation will have to wait as the project has been on hold since I hit this issue over a month ago.  Thanks for your input.</p></div>
            <div class="comment-info" id="comment-60829-info">
                
                
                
                

                

                <span class="comment-age">(14 Apr '17, 02:49)</span>
                <a class="comment-user userinfo" href="/users/29025/chrisdell">chrisdell</a>
                
            </div>
        </div>
    
        <a name="60832"></a>
        <div class="comment not_top_scorer" id="comment-60832">
            <div id="post-60832-score" class="comment-score"></div>
            <div class="comment-text"><p>I know that sometimes business needs preclude completing an investigation, but I'd still be concerned that the issue has been postponed and not actually fixed.</p></div>
            <div class="comment-info" id="comment-60832-info">
                
                
                
                

                

                <span class="comment-age">(14 Apr '17, 05:32)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-60800" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 6
        </span>
        <a href="#" class="show-all-comments-link">show 1 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-60800-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/60799/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='XjjHnS723p4FqWwqR8mj3c6SxcmJJcQV' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/60799/modbus-tcp-connection-drops-after-7-hours-and-20-minutes?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/60799/modbus-tcp-connection-drops-after-7-hours-and-20-minutes?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/tcp/"
            class="tag-link-tcp"
            title="see questions tagged'tcp'using tags"
            rel="tag">tcp</a> <span class="tag-number">&#215;752</span><br/>
        
        <a href="/tags/ack/"
            class="tag-link-ack"
            title="see questions tagged'ack'using tags"
            rel="tag">ack</a> <span class="tag-number">&#215;139</span><br/>
        
        <a href="/tags/rst/"
            class="tag-link-rst"
            title="see questions tagged'rst'using tags"
            rel="tag">rst</a> <span class="tag-number">&#215;81</span><br/>
        
        <a href="/tags/fin/"
            class="tag-link-fin"
            title="see questions tagged'fin'using tags"
            rel="tag">fin</a> <span class="tag-number">&#215;32</span><br/>
        
        <a href="/tags/modbus/"
            class="tag-link-modbus"
            title="see questions tagged'modbus'using tags"
            rel="tag">modbus</a> <span class="tag-number">&#215;32</span><br/>
        
    </p>
    <p>
        question asked: <strong title="April 13, 2017, 3:47 a.m.">13 Apr '17, 03:47</strong>
    </p>
    <p> 
     	question was seen: <strong>2,453 times</strong>
    </p>
    <p> 
        last updated: <strong title="April 14, 2017, 5:32 a.m.">14 Apr '17, 05:32</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/14212/router-replies-with-rst-after-fin-ack">Router replies with [RST] after [FIN, ACK]</a>
        </p>
        
        <p>
            <a href="/questions/25374/server-sending-rst-message">Server sending RST Message</a>
        </p>
        
        <p>
            <a href="/questions/34810/tcp-retransmission-after-reset-rst-flag">TCP Retransmission after Reset RST flag</a>
        </p>
        
        <p>
            <a href="/questions/55471/syn-no-synacktrying-to-figure-out-whats-wrong-with-the-client-server-tcp-communication">[SYN-&gt;no SYN,ACK]Trying to figure out what&#39;s wrong with the client-server TCP communication.</a>
        </p>
        
        <p>
            <a href="/questions/62153/rstack-client-closing-connection-intermittently">RST/ACK, client closing connection intermittently.</a>
        </p>
        
        <p>
            <a href="/questions/37992/ack-packets-are-getting-dropped-causing-a-ftp-session-reset">Ack packets are getting dropped, causing a FTP session reset</a>
        </p>
        
        <p>
            <a href="/questions/58894/tcp-dup-causing-software-to-crash">TCP DUP causing software to crash?</a>
        </p>
        
        <p>
            <a href="/questions/7915/what-should-the-sequence-number-of-a-tcprst-packet-be-after-a-tcpfin">What should the sequence number of a TCP/RST packet be after a TCP/FIN</a>
        </p>
        
        <p>
            <a href="/questions/15815/all-tcp-connections-end-with-rst">All TCP connections end with RST</a>
        </p>
        
        <p>
            <a href="/questions/18858/router-appears-to-block-proper-tcp-session-teardown-fin-ack-ever-see-this">Router appears to block proper TCP Session Teardown (FIN, ACK), Ever See This?</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
