<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Extracting SOAP XML Payload - Wireshark Q&amp;A</title>
        <meta name="description" content="Using Lua and Tshark I&#39;m attempting to obtain the XML payload from SOAP messages exchanged with my web service. I went with a listener approach (see program below), but it doesn&#39;t appear to be working properly. The s_xml_cdata print statement simply prints &quot;RB14&quot;. I don&#39;t receive the full XML. Admit..." />
        <meta name="keywords" content="xml,lua,extract,tshark,soap" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/4639/extracting-soap-xml-payload" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/4639/extracting-soap-xml-payload?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='lQfn2JJRr3mT6DHaWbLwJ83VfvhFlzwu' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/4639/extracting-soap-xml-payload">Extracting SOAP XML Payload</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-4639-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/4639/up/" rel="nofollow"> </a>
<div id="post-4639-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-4639-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/4639/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/4639/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Using Lua and Tshark I'm attempting to obtain the XML payload from SOAP messages exchanged with my web service.  I went with a listener approach (see program below), but it doesn't appear to be working properly.  The s_xml_cdata print statement simply prints "RB14".  I don't receive the full XML.  Admittedly I'm new to both Tshark and Lua so I may be making some rookie mistakes here.  I scoured the Web for any examples, but I've yet to come up with anything helpful.  My ultimate goal is to save the SOAP XML to a flat file and/or redirect to a named pipe.</p>
<pre><code>xml_cdata_f = Field.new("xml.cdata")
xml_tag_f = Field.new("xml.tag")

local tap = Listener.new(nil, "xml" )

function tap.packet(pinfo, pvb, xml)

  print("\nTap Hit!")

  local s_xml_cdata = tostring(xml_cdata_f())  
  local s_xml_tag = tostring(xml_tag_f())

  print("\n" .. s_xml_cdata)  
  print("\n" .. s_xml_tag)  
end

function tap.draw(xml)
end

function tap.reset(xml)
end
</code></pre>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/xml/" class="post-tag tag-link-xml"
                                        title="see questions tagged 'xml'" rel="tag">xml</a>
                                
                                    <a href="/tags/lua/" class="post-tag tag-link-lua"
                                        title="see questions tagged 'lua'" rel="tag">lua</a>
                                
                                    <a href="/tags/extract/" class="post-tag tag-link-extract"
                                        title="see questions tagged 'extract'" rel="tag">extract</a>
                                
                                    <a href="/tags/tshark/" class="post-tag tag-link-tshark"
                                        title="see questions tagged 'tshark'" rel="tag">tshark</a>
                                
                                    <a href="/tags/soap/" class="post-tag tag-link-soap"
                                        title="see questions tagged 'soap'" rel="tag">soap</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>20 Jun '11, 11:51</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/8eb26411ed8849ab46c314226c598644?s=32&amp;d=identicon&amp;r=g" alt="sethlwilson's gravatar image" />
    <p><a href="/users/1234/sethlwilson">sethlwilson</a><br/>
    <span class="score" title="31 reputation points">31</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="6 badges"><span class="bronze">&#9679;</span><span class="badgecount">6</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="sethlwilson has one accepted answer">12&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/4639/">
                edited
                <strong>20 Jun '11, 12:41</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" alt="Guy%20Harris's gravatar image" />
            <p><a href="/users/79/guy-harris">Guy Harris ‚ô¶‚ô¶</a><br/>
            <span class="score" title="17443 reputation points"><span class="">17.4k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">&#9679;</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">&#9679;</span><span class="badgecount">196</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-4639">
    
        <a name="4648"></a>
        <div class="comment" id="comment-4648">
            <div id="post-4648-score" class="comment-score"></div>
            <div class="comment-text"><p>Essentially, using Lua I want to be able to send to output the re-assembled xml like in the Wireshark GUI.  It seems like this should be possible given the xml protocol exists right?  How else would the GUI do it?</p></div>
            <div class="comment-info" id="comment-4648-info">
                
                
                
                

                

                <span class="comment-age">(21 Jun '11, 09:58)</span>
                <a class="comment-user userinfo" href="/users/1234/sethlwilson">sethlwilson</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-4639" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-4639-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    12 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/4639/extracting-soap-xml-payload?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/4639/extracting-soap-xml-payload?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/4639/extracting-soap-xml-payload?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/4639/extracting-soap-xml-payload?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                <p class="paginator"><span class="curr this_page">1</span><a class="page" href="/questions/4639/extracting-soap-xml-payload?sort=votes&amp;page=2" >2</a><span class="next"><a href="/questions/4639/extracting-soap-xml-payload?sort=votes&amp;page=2" title="next page">next &raquo;</a></span></p>

                
                    <a name="4835"></a>
                    <div id="answer-container-4835" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-4835-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/4835/up/" rel="nofollow"> </a>
<div id="post-4835-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-4835-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/4835/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Here's Lua that extracts the XML fields to a file (with a dotted line in between fields). I tested it against your pcap in tshark and Wireshark. For tshark, run:  <strong><code>tshark -r sethwilson.pcap -R "tcp and data"</code></strong></p>
<p>Note that the file is written in append mode to:</p>
<ul>
<li><strong>UN*X</strong>: <code>~/.wireshark/temp.xml</code></li>
<li><strong>Windows XP</strong>: <code>C:\Documents and Settings\your_username\Application Data\Wireshark\temp.xml</code></li>
</ul>
<hr>
<pre><code>-- tap uses dfilter for tcp data and ignores retransmissions
local tap       = Listener.new(nil, "tcp &amp;&amp; data &amp;&amp; !tcp.analysis.retransmission")
local xml_field = Field.new("data")
local file      = nil

-- #######################################################################
-- # If not already open, this opens a file for writing (append mode)
-- #######################################################################
local function open_file()
    if not file then
        local path = USER_DIR .. "/temp.xml"

        print("opening file:", path)
        file = assert(io.open(path, "a"), 
                    "Can't open file for writing")
    end
end

local HTML_REQ = {
    ["HTTP"] = 1,
    ["GET "] = 1,
    ["PUT "] = 1,
    ["POST"] = 1,
}

-- #######################################################################
-- # Extracts the XML field from the buffer and writes the field to file
-- #######################################################################
local function handle_xml(pinfo, tvb)
    if not file then
        print("no file...ignoring packet")
        return
    end

    local fieldinfo = xml_field()
    local xmldata   = tvb(fieldinfo.offset):string()

    -- some of these packets start w/HTTP header...skip to XML
    local starts = xmldata:sub(1,4)
    if HTML_REQ[starts] ~= nil then
        local pos = string.find(xmldata, "&lt;%?xml version")
        if not pos then
            return
        end

        xmldata = xmldata:sub(pos)
    end

    print(xmldata)
    print("\n\n-- #"..pinfo.number.." ---------------------------------------------------\n\n")

    file:write(xmldata)
    file:write("\n\n-- #"..pinfo.number.." ---------------------------------------------------\n\n")
end

-- #######################################################################
-- # tap.packet() is called to notify the Listener of a packet that
-- # matches its filter rule ("xml" in this case). This can be called
-- # multiple times before tap.draw().
-- #######################################################################
function tap.packet(pinfo, tvb)
    print("tap.packet", "#"..pinfo.number)

    -- XXX: Compensate for no tap.reset() in tshark
    if not gui_enabled() then open_file() end

    -- wrap the handler in a pcall() in case an error occurs
    local ok, msg = pcall(  function() 
                                handle_xml(pinfo,tvb) 
                            end )

    -- print any error and bow out
    if not ok then
        print("wtf!", msg)
    end

end

-- #######################################################################
-- # tap.draw() is called to notify the Listener to "draw" its results
-- # that were accumulated in tap.packet(). This is normally called after
-- # tap.packet(), based on "Preferences &gt; Statistics &gt; Tap update interval".
-- #######################################################################
function tap.draw()
    print("tap.draw")

    -- flush toilet (NOTE: When $file is garbage collected, it's 
    -- automatically flushed and closed...that doesn't mean we
    -- can't do it sooner to free resources.)
    if file then
        print("closing file")
        file:close()
        file = nil
    end
end

-- #######################################################################
-- # tap.reset() is called to notify the Listener to reset any variables
-- # or counters in preparation for a packet (passed to tap.packet()).
-- # This can be called multiple times before a packet is even seen.
-- #
-- # XXX: tshark doesn't call this function, but Wireshark does. Bug?
-- #######################################################################
function tap.reset()
    print("tap.reset")
    open_file()
end
</code></pre>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/4835/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>29 Jun '11, 20:10</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/362ba1008ad9a075d1556d33e97dfed6?s=32&amp;d=identicon&amp;r=g" alt="helloworld's gravatar image" />
    <p><a href="/users/817/helloworld">helloworld</a><br/>
    <span class="score" title="3149 reputation points"><span class="">3.1k</span></span><span title="4 badges"><span class="badge1">&#9679;</span><span class="badgecount">4</span></span><span title="20 badges"><span class="silver">&#9679;</span><span class="badgecount">20</span></span><span title="41 badges"><span class="bronze">&#9679;</span><span class="badgecount">41</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="helloworld has 28 accepted answers">28&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/4835/">
                edited
                <strong>30 Sep '11, 12:40</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-4835">
    
        <a name="18040"></a>
        <div class="comment" id="comment-18040">
            <div id="post-18040-score" class="comment-score"></div>
            <div class="comment-text"><p>Great piece of code but unfortunately it fails to extract SOAP message if it was distributed over several TCP segments. Anyone can help to solve this issue?</p></div>
            <div class="comment-info" id="comment-18040-info">
                
                
                
                

                

                <span class="comment-age">(29 Jan '13, 09:07)</span>
                <a class="comment-user userinfo" href="/users/4281/masgad">masgad</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-4835" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-4835-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="4861"></a>
                    <div id="answer-container-4861" class="answer answered-by-owner">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-4861-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/4861/up/" rel="nofollow"> </a>
<div id="post-4861-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-4861-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/4861/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Well we seem to be getting somewhere now -- the complete XML is printed but by bits and pieces over several packets.  Here's the output - <a href="http://files.me.com/sethlwilson/vlrmhm">files.me.com/sethlwilson/vlrmhm</a>.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/4861/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>30 Jun '11, 11:04</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/8eb26411ed8849ab46c314226c598644?s=32&amp;d=identicon&amp;r=g" alt="sethlwilson's gravatar image" />
    <p><a href="/users/1234/sethlwilson">sethlwilson</a><br/>
    <span class="score" title="31 reputation points">31</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="6 badges"><span class="bronze">&#9679;</span><span class="badgecount">6</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="sethlwilson has one accepted answer">12&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-4861">
    
        <a name="4865"></a>
        <div class="comment" id="comment-4865">
            <div id="post-4865-score" class="comment-score"></div>
            <div class="comment-text"><p>By the way the Web services whose traffic I captured (with filter "tcp port 8280") communicates on port 8280.</p></div>
            <div class="comment-info" id="comment-4865-info">
                
                
                
                

                

                <span class="comment-age">(30 Jun '11, 11:10)</span>
                <a class="comment-user userinfo" href="/users/1234/sethlwilson">sethlwilson</a>
                
            </div>
        </div>
    
        <a name="4866"></a>
        <div class="comment" id="comment-4866">
            <div id="post-4866-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes, exactly. That's the same result I get. We're bypassing TCP reassembly of the HTTP segments, and writing the segments one at a time. If you commented out the dotted lines (debug), you'd get the original payload in the file.</p></div>
            <div class="comment-info" id="comment-4866-info">
                
                
                
                

                

                <span class="comment-age">(30 Jun '11, 11:17)</span>
                <a class="comment-user userinfo" href="/users/817/helloworld">helloworld</a>
                
            </div>
        </div>
    
        <a name="4867"></a>
        <div class="comment" id="comment-4867">
            <div id="post-4867-score" class="comment-score">1</div>
            <div class="comment-text"><p>Please don't add comments as answers; you should comment on specific posts. Otherwise, this answer list becomes unwieldy and difficult to follow.</p></div>
            <div class="comment-info" id="comment-4867-info">
                
                
                
                

                

                <span class="comment-age">(30 Jun '11, 11:20)</span>
                <a class="comment-user userinfo" href="/users/817/helloworld">helloworld</a>
                
            </div>
        </div>
    
        <a name="4869"></a>
        <div class="comment" id="comment-4869">
            <div id="post-4869-score" class="comment-score"></div>
            <div class="comment-text"><p>Sorry, no problem and I agree it looks like spaghetti now.<br>
</p>

<p>So, yes this is now giving me exactly what I've needed!  So, does this mean that there is a bug with the TCP reassembly or is it the Lua API?  Just wondering if I need to open an artifact.</p>

<p>Again, thanks for all your help!  I was almost to the point of dropping the use of Wireshark in our solution.</p></div>
            <div class="comment-info" id="comment-4869-info">
                
                
                
                

                

                <span class="comment-age">(30 Jun '11, 11:28)</span>
                <a class="comment-user userinfo" href="/users/1234/sethlwilson">sethlwilson</a>
                
            </div>
        </div>
    
        <a name="4871"></a>
        <div class="comment" id="comment-4871">
            <div id="post-4871-score" class="comment-score"></div>
            <div class="comment-text"><p>One more question ... when I run this script on a live capture, only the request XML is successfully captured.  The response appears mangled.</p>

<p>...</p>

<p>-- #13 ---------------------------------------------------</p>

<p>¬®:&amp;√≥<em>√Ä?A.¬Åq¬°f¬¶q√Ç¬∂Àú_√∏√ß{√õ√î,¬π√ºz¬π¬£#√°√µ√∫√ß√ç√û√ñ~¬´¬∑√â√∏^</em>DF√∫‚Ä∫¬ê√ÖI¬£√ñ√∞√Æ¬∞‚Ñ¢√ß√π?√ó_√∞√Ä¬™¬ßt√ç
p√éP¬†¬°3√è5r‚Äû"‚Äöb‚Ñ¢g$¬ø¬†√∫X;√é√¶√ºt(U¬´‚Ä∞.‚Ä¶8'Àú/Y≈°√†i√®¬≠3√ë!UA√•x√Æ√Ω=√á¬è¬™≈ìv‚Äù√∑U √ë(qa9p?√Å¬£√°‚Äö+≈∏¬æz‚ÄûUR√í≈æ‚Ñ¢√≠¬•¬¨Tc‚Ä¢‚Äù ¬≥3Q;`
√Ö‚Äù√™√´¬•-¬Æ¬§
‚Ä¶   ≈ΩD√Æ=Fhr‚Ä∞¬≤√§√ëCA&lt;√öF≈ìB√Ø√†√Ø√£o√≥√É&gt;√Ü2√¨  √úq)√á+&amp;q‚Ä°√´¬µ‚Ä∞~Q¬®¬æ,</p>

<p>-- #19 ---------------------------------------------------</p></div>
            <div class="comment-info" id="comment-4871-info">
                
                
                
                

                

                <span class="comment-age">(30 Jun '11, 12:47)</span>
                <a class="comment-user userinfo" href="/users/1234/sethlwilson">sethlwilson</a>
                
            </div>
        </div>
    
        <a name="4872"></a>
        <div class="comment not_top_scorer" id="comment-4872">
            <div id="post-4872-score" class="comment-score"></div>
            <div class="comment-text"><p>OK, I think I understand what's going on here - the data in the variable xmldata is gzip compressed.  I suppose then that's because we're bypassing the html dissector.</p></div>
            <div class="comment-info" id="comment-4872-info">
                
                
                
                

                

                <span class="comment-age">(30 Jun '11, 13:56)</span>
                <a class="comment-user userinfo" href="/users/1234/sethlwilson">sethlwilson</a>
                
            </div>
        </div>
    
        <a name="4874"></a>
        <div class="comment not_top_scorer" id="comment-4874">
            <div id="post-4874-score" class="comment-score"></div>
            <div class="comment-text"><p>I doubt the bug is in TCP reassembly because the GUI has no trouble identifying the HTTP/XML packets. My <em>guess</em> is the bug lies in the Lua API (based on the fact that <code>fieldinfo.value</code> and <code>fieldinfo.len</code> do not always correspond to the actual contents of <code>tvb</code>).</p>

<p>Sure, you're welcome! Helping you only helped me better understand how listeners work, which will help me when I start documenting it the <a href="http://wiki.wireshark.org/LuaAPI">Lua API wiki</a> (an ongoing project).</p></div>
            <div class="comment-info" id="comment-4874-info">
                
                
                
                

                

                <span class="comment-age">(30 Jun '11, 16:31)</span>
                <a class="comment-user userinfo" href="/users/817/helloworld">helloworld</a>
                
            </div>
        </div>
    
        <a name="4875"></a>
        <div class="comment not_top_scorer" id="comment-4875">
            <div id="post-4875-score" class="comment-score"></div>
            <div class="comment-text"><p>If Wireshark can determine that <code>xml.data</code> is GZIP'ed, then I presume you can write it into a <code>.gz</code> file for later decompression. I think you'd have to pay mind to <code>http.content_length_header</code> to determine the full/expected length of the file.</p></div>
            <div class="comment-info" id="comment-4875-info">
                
                
                
                

                

                <span class="comment-age">(30 Jun '11, 16:39)</span>
                <a class="comment-user userinfo" href="/users/817/helloworld">helloworld</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-4861" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 8
        </span>
        <a href="#" class="show-all-comments-link">show 3 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-4861-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="4640"></a>
                    <div id="answer-container-4640" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-4640-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/4640/up/" rel="nofollow"> </a>
<div id="post-4640-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-4640-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/4640/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>For some reason, I had problems combining the proto variable function call along with the tostring() call
So I broke them up and added a check in between.</p>
<pre><code>On your line:
  local s_xml_cdata = tostring(xml_cdata_f())
try changing to
  local l_xml_cdata = f_xml_cdata()
  if l_xml_cdata == nil then return end
  s_xml_cdata = tostring(l_xml_cdata)
</code></pre>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/4640/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>20 Jun '11, 15:56</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/6d70926a09a65b1329fb803549ab7205?s=32&amp;d=identicon&amp;r=g" alt="NewbieBrian's gravatar image" />
    <p><a href="/users/1110/newbiebrian">NewbieBrian</a><br/>
    <span class="score" title="1 reputation points">1</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="4 badges"><span class="bronze">&#9679;</span><span class="badgecount">4</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="NewbieBrian has no accepted answers">0&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-4640">
    
        <a name="4645"></a>
        <div class="comment" id="comment-4645">
            <div id="post-4645-score" class="comment-score"></div>
            <div class="comment-text"><p>I tried what you suggested, but the print function doesn't display all of what should be contained in xml.cdata.  It appears to be truncating the string.</p></div>
            <div class="comment-info" id="comment-4645-info">
                
                
                
                

                

                <span class="comment-age">(21 Jun '11, 07:29)</span>
                <a class="comment-user userinfo" href="/users/1234/sethlwilson">sethlwilson</a>
                
            </div>
        </div>
    
        <a name="4649"></a>
        <div class="comment" id="comment-4649">
            <div id="post-4649-score" class="comment-score"></div>
            <div class="comment-text"><p>The middle display area of Wireshark has about 255 character limit.  Truncation is correct.  I transform the XML entities back to XML characters, then break up the line by carriage return line feeds, returning an array.  I print out the array and I get CDATA files of over 750K pretty printing inside WireShark.  I can post an example later.</p></div>
            <div class="comment-info" id="comment-4649-info">
                
                
                
                

                

                <span class="comment-age">(21 Jun '11, 11:12)</span>
                <a class="comment-user userinfo" href="/users/1110/newbiebrian">NewbieBrian</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-4640" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-4640-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="4650"></a>
                    <div id="answer-container-4650" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-4650-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/4650/up/" rel="nofollow"> </a>
<div id="post-4650-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-4650-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/4650/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>XML CDATA is often encoded with <code>&amp;lt; (&lt;) &amp;gt; (&gt;)</code> and other codes.  There may be a better way to do all that follows with an XML parser, but I spend enough time just getting Wireshark to behave as advertised.  I don't have time to dive into Lua nuances.  So I manually transfer the CDATA to a string as shown above.  Then I use string.gsub() to do searches and replaces:</p>
<pre><code>s_xml_cdata = string.gsub(s_xml_cdata, "&amp;lt;", "&lt;")
s_xml_cdata = string.gsub(s_xml_cdata, "&amp;gt;", "&gt;")
s_xml_cdata = string.gsub(s_xml_cdata, "&amp;#xA;", "")
s_xml_cdata = string.gsub(s_xml_cdata, "&amp;#xD;", "")
s_xml_cdata = string.gsub(s_xml_cdata, "\n", "")
local la_cdata = BreakUpLongLines(s_xml_cdata, "&gt;")
</code></pre>
<p>This last line is a call to my function <code>BreakUpLongLines(string_xml_cdata, string split_character)</code>.  Pass in your string with the reformed XML data, and the character you want to do splits on.  In this case, it's basically the greater than symbol.  Here is the BreakUpLongLines() function.</p>
<pre><code>--utility to break up long lines into smaller ones
function BreakUpLongLines (str, sep)
    --Array to return each of the elements
    vals = {}; valindex = 1; word = ""
    local strSize = #str
    local offset =0
    while strSize &gt; offset do
        svar, evar=string.find(str, sep, offset)
        if evar == nil then return vals end
        if evar &gt; strSize then return vals end
        vals[valindex] = string.sub(str, offset,evar)
        valindex = valindex+1
        offset=evar+1
    end
    return vals
end
</code></pre>
<p>So this function will take any long line and break it by the sep character, which for XML happens to be the greater than symbol. It returns an array of all your lines.  Use a simple For loop to print your lines.</p>
<pre><code>for kvar,vvar in next, la_cdata do
    g2stree:add(kvar, la_cdata[kvar])
end
</code></pre>
<p>Comments and improvements welcome!</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/4650/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>21 Jun '11, 11:28</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/6d70926a09a65b1329fb803549ab7205?s=32&amp;d=identicon&amp;r=g" alt="NewbieBrian's gravatar image" />
    <p><a href="/users/1110/newbiebrian">NewbieBrian</a><br/>
    <span class="score" title="1 reputation points">1</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="4 badges"><span class="bronze">&#9679;</span><span class="badgecount">4</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="NewbieBrian has no accepted answers">0&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-4650">
    
        <a name="4656"></a>
        <div class="comment" id="comment-4656">
            <div id="post-4656-score" class="comment-score"></div>
            <div class="comment-text"><p>Ok, but this doesn't solve the original problem, which is to grab the entire XML document.</p></div>
            <div class="comment-info" id="comment-4656-info">
                
                
                
                

                

                <span class="comment-age">(21 Jun '11, 18:03)</span>
                <a class="comment-user userinfo" href="/users/817/helloworld">helloworld</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-4650" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-4650-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="4651"></a>
                    <div id="answer-container-4651" class="answer answered-by-owner">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-4651-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/4651/up/" rel="nofollow"> </a>
<div id="post-4651-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-4651-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/4651/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>I do appreciate your help.   Here is my latest rendition incorporating your latest suggestion.  The file:write(s_xml_cdata) prints only 4 bytes of the xml, and that data is the value contained in the first set of tags.  I'm running this with tshark using the following command:  tshark -f "tcp port 8280" -X lua_script:C:Userssetwilxml.lua.  My service is going over that port specifically.  I have the following Wireshark packaage installed:</p>
<p>Version 1.6.0 (SVN Rev 37592 from /trunk-1.6)</p>
<p>Copyright 1998-2011 Gerald Combs <a href="/cdn-cgi/l/email-protection#e3848691828f87a3948a9186908b829188cd8c9184"><span class="__cf_email__" data-cfemail="70171502111c143007190215031811021b5e1f0217">[email&#160;protected]</span></a> and contributors.
This is free software; see the source for copying conditions. There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>
<p>Compiled (64-bit) with GTK+ 2.22.1, with GLib 2.26.1, with WinPcap (version
unknown), with libz 1.2.5, without POSIX capabilities, without libpcre, without
SMI, with c-ares 1.7.1, with Lua 5.1, without Python, with GnuTLS 2.10.3, with
Gcrypt 1.4.6, without Kerberos, with GeoIP, with PortAudio V19-devel (built Jun 
7 2011), with AirPcap.</p>
<p>Running on 64-bit Windows 7, build 7600, with WinPcap version 4.1.2 (packet.dll
version 4.1.0.2001), based on libpcap version 1.0 branch 1_0_rel0b (20091008),
GnuTLS 2.10.3, Gcrypt 1.4.6, without AirPcap.</p>
<p>Built using Microsoft Visual C++ 9.0 build 21022</p>
<pre><code>do
  local file = io.open("C:\\Users\\setwil\\xml.out", "w")

  f_xml_cdata = Field.new("xml.cdata")

  --utility to break up long lines into smaller ones
  function BreakUpLongLines (str, sep)
    --Array to return each of the elements
    vals = {}; valindex = 1; word = ""
    local strSize = #str
    local offset =0
    print("\nstrSize=" .. strSize .. "\n")
    while strSize &gt; offset do
        svar, evar=string.find(str, sep, offset)
        if evar == nil then return vals end
        if evar &gt; strSize then return vals end
        vals[valindex] = string.sub(str, offset,evar)
        valindex = valindex+1
        offset=evar+1
    end
    return vals
  end

  local mytap = Listener.new(nil, "xml")

  function mytap.packet(pinfo, tvb, xml)

    local l_xml_cdata = f_xml_cdata()
    local s_xml_cdata = tostring(l_xml_cdata)

    s_xml_cdata = string.gsub(s_xml_cdata, "&amp;lt;", "&lt;")
    s_xml_cdata = string.gsub(s_xml_cdata, "&amp;gt;", "&gt;")
    s_xml_cdata = string.gsub(s_xml_cdata, "&amp;#xA;", "")
    s_xml_cdata = string.gsub(s_xml_cdata, "&amp;#xD;", "")
    s_xml_cdata = string.gsub(s_xml_cdata, "\n", "")

    file:write(s_xml_cdata)

    local la_cdata = BreakUpLongLines(s_xml_cdata, "&gt;")

    file:write("\nBefore loop")
    for i,v in ipairs(la_cdata), la_cdata do
      file:write(v)
    end
    file:write("\nAfter loop")

  end

  function mytap.draw()
  end

  function mytap.reset()
    file:close()
  end
end
</code></pre>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/4651/">permanent link</a></span>
                                            
<div class="community-wiki">
        This answer is marked "community wiki".
        
    </div>
                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>21 Jun '11, 12:37</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/8eb26411ed8849ab46c314226c598644?s=32&amp;d=identicon&amp;r=g" alt="sethlwilson's gravatar image" />
    <p><a href="/users/1234/sethlwilson">sethlwilson</a><br/>
    <span class="score" title="31 reputation points">31</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="6 badges"><span class="bronze">&#9679;</span><span class="badgecount">6</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="sethlwilson has one accepted answer">12&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-4651">
    
</div>
<div id="comment-tools-4651" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-4651-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="4657"></a>
                    <div id="answer-container-4657" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-4657-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/4657/up/" rel="nofollow"> </a>
<div id="post-4657-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-4657-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/4657/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>To dump XML documents from a tap/listener:</p>
<pre><code>local tap = Listener.new(nil, "xml")
local xml_field = Field.new("xml")

function tap.packet (pinfo, tvb)

    -- Extract the XML field (which contains the full XML document).
    --
    -- NOTE: `xml_field()` returns a `FieldInfo` object. See this link for more info:
    -- http://www.wireshark.org/docs/wsug_html_chunked/lua_module_Field.html#lua_class_FieldInfo

    local fieldinfo = xml_field()

    -- `print()` refuses to print the field because it "may contain invalid
    -- characters". The particular subfield that's causing the problem is
    -- `fieldinfo.label` (not sure why). One would think that `fieldinfo.value`
    -- would contain the full XML and `fieldinfo.len` would be the document's
    -- byte length, but not true (bug?).
    -- 
    -- No worries. We can parse the string from the `tvb` ourselves. `fieldinfo.offset`
    -- tells us where in the `tvb` the XML document begins. So, all we need to do
    -- is convert the bytes from the offset to the end of the buffer into a string.
    -- (This assumes that the XML document is the last field in the packet.)
    --
    -- See http://wiki.wireshark.org/LuaAPI/Tvb#tvbrange:string.28.29

    print( tvb(fieldinfo.offset):string() )
end
</code></pre>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/4657/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>21 Jun '11, 18:10</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/362ba1008ad9a075d1556d33e97dfed6?s=32&amp;d=identicon&amp;r=g" alt="helloworld's gravatar image" />
    <p><a href="/users/817/helloworld">helloworld</a><br/>
    <span class="score" title="3149 reputation points"><span class="">3.1k</span></span><span title="4 badges"><span class="badge1">&#9679;</span><span class="badgecount">4</span></span><span title="20 badges"><span class="silver">&#9679;</span><span class="badgecount">20</span></span><span title="41 badges"><span class="bronze">&#9679;</span><span class="badgecount">41</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="helloworld has 28 accepted answers">28&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-4657">
    
</div>
<div id="comment-tools-4657" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-4657-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="4671"></a>
                    <div id="answer-container-4671" class="answer answered-by-owner">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-4671-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/4671/up/" rel="nofollow"> </a>
<div id="post-4671-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-4671-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/4671/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Thanks helloworld, now I'm getting somewhere!  Funny thing though is that using the code below I only get a portion of the xml and the amount differs between the request and the response.  I confirmed though that the offset given by the FieldInfo object is the same as that indicated in the Wireshark GUI.  Do you think that there may be some stray non-printable characters in the tvb that are interfering with string conversion?  Again I'm running this with tshark from cmd.exe.</p>
<pre><code>local tap = Listener.new(nil, "xml")
local xml_field = Field.new("xml")
local file = io.open("C:\\Users\\setwil\\xml.out", "w")

function tap.packet(pinfo, tvb)
  local fieldinfo = xml_field() 
  print("fieldinfo.name=" .. tostring(fieldinfo.name))
  print("fieldinfo.len=" .. tostring(fieldinfo.len))
  print("fieldinfo.offset=" .. tostring(fieldinfo.offset))
  --print("fieldinfo.value=" .. tostring(fieldinfo.value))

  file:write( tvb(fieldinfo.offset):string() )
  file:write("\n------------------------------------------------------------\n\n")

end

function tap.reset()
  file:close()
end
</code></pre>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/4671/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>22 Jun '11, 09:05</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/8eb26411ed8849ab46c314226c598644?s=32&amp;d=identicon&amp;r=g" alt="sethlwilson's gravatar image" />
    <p><a href="/users/1234/sethlwilson">sethlwilson</a><br/>
    <span class="score" title="31 reputation points">31</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="6 badges"><span class="bronze">&#9679;</span><span class="badgecount">6</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="sethlwilson has one accepted answer">12&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-4671">
    
        <a name="4676"></a>
        <div class="comment" id="comment-4676">
            <div id="post-4676-score" class="comment-score"></div>
            <div class="comment-text"><p>Something that I've just discovered is that for one packet that I captured, the fieldinfo.offset is greater than the tvb:len().  Here's the program output:</p>

<p>fieldinfo.name=xml</p>

<p>fieldinfo.len=6068</p>

<p>fieldinfo.offset=257</p>

<p>fieldinfo.range=3c736f6170656e763a456e76656c6f706520786d6c6e733a...</p>

<p>fieldinfo.generated=false</p>

<p>tvb:length=282</p>

<p>So it leaves me wondering to what buffer fieldinfo.offset refers.</p></div>
            <div class="comment-info" id="comment-4676-info">
                
                
                
                

                

                <span class="comment-age">(22 Jun '11, 13:04)</span>
                <a class="comment-user userinfo" href="/users/1234/sethlwilson">sethlwilson</a>
                
            </div>
        </div>
    
        <a name="4680"></a>
        <div class="comment" id="comment-4680">
            <div id="post-4680-score" class="comment-score"></div>
            <div class="comment-text"><p>An additional discovery:  When comparing these results with those of the GUI I discovered that what's contained in tvb are the bytes from the <em>frame</em> and that its contents are what's printing to my file.</p></div>
            <div class="comment-info" id="comment-4680-info">
                
                
                
                

                

                <span class="comment-age">(22 Jun '11, 14:32)</span>
                <a class="comment-user userinfo" href="/users/1234/sethlwilson">sethlwilson</a>
                
            </div>
        </div>
    
        <a name="4713"></a>
        <div class="comment" id="comment-4713">
            <div id="post-4713-score" class="comment-score"></div>
            <div class="comment-text"><p>I guess the non-printable chars theory is plausible. Isn't that discernible from the hexdump in Wireshark/tshark?</p>

<p>The <code>fieldinfo.offset</code> field is the raw offset from the beginning of the frame. I'm not sure why <code>fieldinfo.len</code> and <code>tvb:length</code> are so different.</p>

<p>Do you have a pcap to share (or a way for me to recreate your symptoms)?</p></div>
            <div class="comment-info" id="comment-4713-info">
                
                
                
                

                

                <span class="comment-age">(23 Jun '11, 19:46)</span>
                <a class="comment-user userinfo" href="/users/817/helloworld">helloworld</a>
                
            </div>
        </div>
    
        <a name="4726"></a>
        <div class="comment" id="comment-4726">
            <div id="post-4726-score" class="comment-score"></div>
            <div class="comment-text"><p>Sure I can share the pcap with you.  How can I send it to you?</p></div>
            <div class="comment-info" id="comment-4726-info">
                
                
                
                

                

                <span class="comment-age">(24 Jun '11, 06:42)</span>
                <a class="comment-user userinfo" href="/users/1234/sethlwilson">sethlwilson</a>
                
            </div>
        </div>
    
        <a name="4746"></a>
        <div class="comment" id="comment-4746">
            <div id="post-4746-score" class="comment-score"></div>
            <div class="comment-text"><p>You can share the pcap via <a href="http://min.us/">min.us</a>, and post a link here to it.</p></div>
            <div class="comment-info" id="comment-4746-info">
                
                
                
                

                

                <span class="comment-age">(24 Jun '11, 16:18)</span>
                <a class="comment-user userinfo" href="/users/817/helloworld">helloworld</a>
                
            </div>
        </div>
    
        <a name="4769"></a>
        <div class="comment not_top_scorer" id="comment-4769">
            <div id="post-4769-score" class="comment-score"></div>
            <div class="comment-text"><p>Here is the pcap file in question:  http://files.me.com/sethlwilson/cd4tw7</p></div>
            <div class="comment-info" id="comment-4769-info">
                
                
                
                

                

                <span class="comment-age">(27 Jun '11, 09:02)</span>
                <a class="comment-user userinfo" href="/users/1234/sethlwilson">sethlwilson</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-4671" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 6
        </span>
        <a href="#" class="show-all-comments-link">show 1 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-4671-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="4739"></a>
                    <div id="answer-container-4739" class="answer answered-by-owner">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-4739-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/4739/up/" rel="nofollow"> </a>
<div id="post-4739-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-4739-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/4739/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Well, I finally managed to obtain the XML payload using the below approach which probably isn't too terribly efficient.  During a live capture I capture a single request-response relay and print their soap envelope contents.  As for the request, I get all of the xml, byte for byte; but as for the response, there are some bytes missing at the very end of the xml:</p>
<pre><code>... 
&lt;/Response&gt;
&lt;SubClientID&gt;MAS01&lt;/SubClientID&gt;
&lt;UserID&gt;PSPRPC1&lt;/UserID&gt;
&lt;/APPX&gt;
&lt;/ns:getAPPXResponse&gt;
&lt;/SOAP-ENV:Bod
</code></pre>
<p>The missing bytes are ...</p>
<pre><code>y&gt;
&lt;/SOAP-ENV:Envelope&gt;
</code></pre>
<p>At first I thought I was unintentionally lopping off those bytes in my convoluted algorithm, but in fact those bytes are even missing in xml_fieldinfo.value ( xml_fieldinfo.len / 2 == string.length(xml_string) ).</p>
<p>Why would the value member be truncated?  Do you think that it's a bug, or is it an imposed limit?</p>
<p>Program source:</p>
<pre><code>local tap = Listener.new(nil, "xml")
local xml_field = Field.new("xml")
local file = io.open("C:\\Users\\setwil\\xml.out", "w")

function tap.packet(pinfo, tvb)
  local xml_fieldinfo = xml_field()  
  local xml_hex_string = tostring(xml_fieldinfo.value)
  print("xml_fieldinfo.len" .. xml_fieldinfo.len .. "\n\n")
  file:write("xml_hex_string=" .. "\n" .. xml_hex_string .. "\n\n")
  print("xml_hex_string.length=" .. string.len(xml_hex_string) .. "\n")

  local xml_string

  for i = 1, string.len(xml_hex_string), 2 do
    local hex_byte = string.sub(xml_hex_string, i, (i + 1))

    if( i == 1 ) then
      xml_string = string.char(tonumber(hex_byte, 16))
    else
      xml_string = xml_string .. string.char(tonumber(hex_byte, 16))
    end

  end

  file:write(xml_string .. "\n\n")
  file:write("---------------------------------------------------------------\n\n")  
end

function tap.reset()
  file:close()
end
</code></pre>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/4739/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>24 Jun '11, 12:54</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/8eb26411ed8849ab46c314226c598644?s=32&amp;d=identicon&amp;r=g" alt="sethlwilson's gravatar image" />
    <p><a href="/users/1234/sethlwilson">sethlwilson</a><br/>
    <span class="score" title="31 reputation points">31</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="6 badges"><span class="bronze">&#9679;</span><span class="badgecount">6</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="sethlwilson has one accepted answer">12&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-4739">
    
        <a name="4836"></a>
        <div class="comment" id="comment-4836">
            <div id="post-4836-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes, I think it's a bug that <code>xml_fieldinfo.value</code> is missing bytes (and I had commented that in the example code of my earlier answer). Skimming the internal code, I don't see an imposed limit, so we shouldn't be seeing this.</p></div>
            <div class="comment-info" id="comment-4836-info">
                
                
                
                

                

                <span class="comment-age">(29 Jun '11, 21:16)</span>
                <a class="comment-user userinfo" href="/users/817/helloworld">helloworld</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-4739" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-4739-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="4819"></a>
                    <div id="answer-container-4819" class="answer answered-by-owner">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-4819-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/4819/up/" rel="nofollow"> </a>
<div id="post-4819-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-4819-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/4819/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Here is the pcap file in question: <a href="http://files.me.com/sethlwilson/cd4tw7">http://files.me.com/sethlwilson/cd4tw7</a></p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/4819/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>29 Jun '11, 12:22</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/8eb26411ed8849ab46c314226c598644?s=32&amp;d=identicon&amp;r=g" alt="sethlwilson's gravatar image" />
    <p><a href="/users/1234/sethlwilson">sethlwilson</a><br/>
    <span class="score" title="31 reputation points">31</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="6 badges"><span class="bronze">&#9679;</span><span class="badgecount">6</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="sethlwilson has one accepted answer">12&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-4819">
    
</div>
<div id="comment-tools-4819" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-4819-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="4844"></a>
                    <div id="answer-container-4844" class="answer answered-by-owner">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-4844-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/4844/up/" rel="nofollow"> </a>
<div id="post-4844-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-4844-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/4844/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Hi helloworld, </p>
<p>I tried your Lua program, but I'm not getting any output (temp.xml is never created) when replaying my pcap.  Tap.packet() never fires.</p>
<pre><code>C:\Program Files\Wireshark&gt;tshark -r C:\Users\setwil\sethwilson.pcap -R "tcp and data" -X lua_script:C:\Users\setwil\helloworld_xml_sniff_devl.lua
tap.draw

C:\Program Files\Wireshark&gt;
</code></pre>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/4844/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>30 Jun '11, 07:30</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/8eb26411ed8849ab46c314226c598644?s=32&amp;d=identicon&amp;r=g" alt="sethlwilson's gravatar image" />
    <p><a href="/users/1234/sethlwilson">sethlwilson</a><br/>
    <span class="score" title="31 reputation points">31</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="6 badges"><span class="bronze">&#9679;</span><span class="badgecount">6</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="sethlwilson has one accepted answer">12&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-4844">
    
        <a name="4846"></a>
        <div class="comment" id="comment-4846">
            <div id="post-4846-score" class="comment-score"></div>
            <div class="comment-text"><p>Something is wrong with your cmdline entry (try quotes around the path of -r). It works for me on OSX and XP.</p></div>
            <div class="comment-info" id="comment-4846-info">
                
                
                
                

                

                <span class="comment-age">(30 Jun '11, 08:11)</span>
                <a class="comment-user userinfo" href="/users/817/helloworld">helloworld</a>
                
            </div>
        </div>
    
        <a name="4849"></a>
        <div class="comment" id="comment-4849">
            <div id="post-4849-score" class="comment-score"></div>
            <div class="comment-text"><p>Another possible problem is that a dissector is parsing out your TCP data (as HTTP?), which could cause the tap's filter to miss the packets. If so, you'd have to either change the tap filter or disable the custom dissector. If it's just HTTP, then change both the tap filter and the field name to "xml".</p></div>
            <div class="comment-info" id="comment-4849-info">
                
                
                
                

                

                <span class="comment-age">(30 Jun '11, 08:32)</span>
                <a class="comment-user userinfo" href="/users/817/helloworld">helloworld</a>
                
            </div>
        </div>
    
        <a name="4850"></a>
        <div class="comment" id="comment-4850">
            <div id="post-4850-score" class="comment-score"></div>
            <div class="comment-text"><p>I just reproduced the symptom. In my case, my HTTP prefs did not include 56013 as an HTTP port, so these packets were falling thru as undissected data (allowing for "tcp and data" filter to catch them). Try the filter/fieldname change I previously mentioned.</p></div>
            <div class="comment-info" id="comment-4850-info">
                
                
                
                

                

                <span class="comment-age">(30 Jun '11, 08:43)</span>
                <a class="comment-user userinfo" href="/users/817/helloworld">helloworld</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-4844" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-4844-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    <p class="paginator"><span class="curr this_page">1</span><a class="page" href="/questions/4639/extracting-soap-xml-payload?sort=votes&amp;page=2" >2</a><span class="next"><a href="/questions/4639/extracting-soap-xml-payload?sort=votes&amp;page=2" title="next page">next &raquo;</a></span></p>
                </div>
            
        <form id="fmanswer" action="/questions/4639/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='lQfn2JJRr3mT6DHaWbLwJ83VfvhFlzwu' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/4639/extracting-soap-xml-payload?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/4639/extracting-soap-xml-payload?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/tshark/"
            class="tag-link-tshark"
            title="see questions tagged'tshark'using tags"
            rel="tag">tshark</a> <span class="tag-number">&#215;832</span><br/>
        
        <a href="/tags/lua/"
            class="tag-link-lua"
            title="see questions tagged'lua'using tags"
            rel="tag">lua</a> <span class="tag-number">&#215;431</span><br/>
        
        <a href="/tags/xml/"
            class="tag-link-xml"
            title="see questions tagged'xml'using tags"
            rel="tag">xml</a> <span class="tag-number">&#215;36</span><br/>
        
        <a href="/tags/extract/"
            class="tag-link-extract"
            title="see questions tagged'extract'using tags"
            rel="tag">extract</a> <span class="tag-number">&#215;26</span><br/>
        
        <a href="/tags/soap/"
            class="tag-link-soap"
            title="see questions tagged'soap'using tags"
            rel="tag">soap</a> <span class="tag-number">&#215;13</span><br/>
        
    </p>
    <p>
        question asked: <strong title="June 20, 2011, 11:51 a.m.">20 Jun '11, 11:51</strong>
    </p>
    <p> 
     	question was seen: <strong>19,994 times</strong>
    </p>
    <p> 
        last updated: <strong title="Jan. 29, 2013, 9:07 a.m.">29 Jan '13, 09:07</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/9521/extracting-soap-xml-payload">Extracting SOAP XML Payload</a>
        </p>
        
        <p>
            <a href="/questions/42343/extracting-soap-xml-data-in-live-capture">Extracting SOAP XML data in live capture</a>
        </p>
        
        <p>
            <a href="/questions/55770/why-cant-i-extract-ipv6-fields-by-lua-script">Why can&#39;t I extract ipv6 fields by Lua script?</a>
        </p>
        
        <p>
            <a href="/questions/18046/extracting-segmented-soap-xml-payload">Extracting Segmented SOAP XML Payload</a>
        </p>
        
        <p>
            <a href="/questions/29565/how-to-enable-lua-in-wireshark">How to enable LUA in wireshark ?</a>
        </p>
        
        <p>
            <a href="/questions/48911/how-to-configure-the-output-of-tshark-psml-file">How to configure the output of Tshark .psml file</a>
        </p>
        
        <p>
            <a href="/questions/60902/localized-lua-dissector-tostring-in-tshark-output">Localized LUA Dissector tostring() in TShark Output</a>
        </p>
        
        <p>
            <a href="/questions/8615/inbound-and-outbound-traffic">Inbound and Outbound traffic</a>
        </p>
        
        <p>
            <a href="/questions/4097/dealing-with-html-entities-within-a-soap-envelope">Dealing with HTML entities within a SOAP envelope</a>
        </p>
        
        <p>
            <a href="/questions/50250/how-do-lua-files-get-input-from-wireshark">How do .lua files get input from wireshark?</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
