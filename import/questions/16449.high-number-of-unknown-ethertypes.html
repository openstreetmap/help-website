<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>High Number of Unknown Ethertypes - Wireshark Q&amp;A</title>
        <meta name="description" content="I&#39;m seeing approx 60 different unknown ethertypes from a capture of about 5000 frames. We recently set our switch SPAN ports to trunks to capture dot1Q tags. Jumbo frames were also recently enabled. I&#39;m not sure if these changes could have anything to do with it. Some frames do show vlan tags. The i..." />
        <meta name="keywords" content="ethertypes,unknown" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/16449/high-number-of-unknown-ethertypes" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/16449/high-number-of-unknown-ethertypes?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='SPesqUDBZP3QGwdtverpQsCGYpgGeQAe' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/16449/high-number-of-unknown-ethertypes">High Number of Unknown Ethertypes</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-16449-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/16449/up/" rel="nofollow"> </a>
<div id="post-16449-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-16449-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/16449/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/16449/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>I'm seeing approx 60 different unknown ethertypes from a capture of about 5000 frames.  We recently set our switch SPAN ports to trunks to capture dot1Q tags.  Jumbo frames were also recently enabled.  I'm not sure if these changes could have anything to do with it.  Some frames do show vlan tags.  The interfaces are error free.  There is a SPAN aggregator device between the network switches and linux capture server.  Any ideas why there would be so many of these?  Thanks!</p>
<p>Here's a list of them:
0xfe7f;0xfcfe;0xe741;0xe10e;0xe103;0xdee5;0xc4c2;0xc446;0xc0fe
0xbb2b;0xa477;0x9e11;0x980c;0x8eb6;0x8eb5;0x8ea8;0x85c2;0x8562
0x855f;0x81f9;0x8146;0x7ffe;0x7ffd;0x7d38;0x64c9;0x64a7;0x646a
0x6457;0x5f37;0x5ee9;0x5eb4;0x5d1b;0x5d03;0x5d02;0x5d00;0x5bbe
0x5baf;0x5ba7;0x5b97;0x5aa6;0x557f;0x557e;0x551b;0x50fe;0x504e
0x504a;0x4b01;0x4687;0x39ad;0x38ae;0x35a7;0x29ce;0x290b;0x2909
0x2125;0x0b92;0x0b47;0x0b21;0x0b1f</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/ethertypes/" class="post-tag tag-link-ethertypes"
                                        title="see questions tagged 'ethertypes'" rel="tag">ethertypes</a>
                                
                                    <a href="/tags/unknown/" class="post-tag tag-link-unknown"
                                        title="see questions tagged 'unknown'" rel="tag">unknown</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>29 Nov '12, 19:50</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/1c1917f4335764246c2c90d4d2e8f785?s=32&amp;d=identicon&amp;r=g" alt="ry6's gravatar image" />
    <p><a href="/users/3801/ry6">ry6</a><br/>
    <span class="score" title="0 reputation points">0</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="bronze">&#9679;</span><span class="badgecount">2</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="ry6 has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-16449">
    
        <a name="16454"></a>
        <div class="comment" id="comment-16454">
            <div id="post-16454-score" class="comment-score"></div>
            <div class="comment-text"><p>Some questions about those frames</p>

<ul>
<li>are they all of the same size?</li>
<li>can you detect any known structure in those frames?</li>
<li>can you post a sample pcap with 3-4 of those frames on <a href="http://cloudshark.org">cloudshark.org</a>?</li>
</ul></div>
            <div class="comment-info" id="comment-16454-info">
                
                
                
                

                

                <span class="comment-age">(30 Nov '12, 01:07)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="16472"></a>
        <div class="comment" id="comment-16472">
            <div id="post-16472-score" class="comment-score"></div>
            <div class="comment-text"><p>Kurt,</p>

<p>To answer your questions:</p>

<ul>
<li>They vary in size.</li>
<li>They seem to be carrying IPv4 headers (08 00 45), only shifted a few octets.</li>
<li>See <a href="http://cloudshark.org/captures/092f285e3d0a">http://cloudshark.org/captures/092f285e3d0a</a></li>
</ul>

<p>Thanks.</p></div>
            <div class="comment-info" id="comment-16472-info">
                
                
                
                

                

                <span class="comment-age">(30 Nov '12, 22:30)</span>
                <a class="comment-user userinfo" href="/users/3801/ry6">ry6</a>
                
            </div>
        </div>
    
        <a name="16474"></a>
        <div class="comment" id="comment-16474">
            <div id="post-16474-score" class="comment-score"></div>
            <div class="comment-text"><p>To be precise, there appear to be four octets after the source IP address and before the Ethernet type.</p>

<p>So you have the machine doing the traffic capture (the Linux capture server) plugged into a SPAN aggregator device (who makes it, and what's its product name/module number?) plugged into SPAN ports on some (Cisco?) switches?</p>

<p>And are there any <em>normal</em> Ethernet frames in the capture?</p></div>
            <div class="comment-info" id="comment-16474-info">
                
                
                
                

                

                <span class="comment-age">(30 Nov '12, 23:56)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="16475"></a>
        <div class="comment" id="comment-16475">
            <div id="post-16475-score" class="comment-score"></div>
            <div class="comment-text"><p>The IPv4 total length of frame 2 (94) is consistent with a 112-byte frame with an 18-byte (6 bytes of destination, 6 bytes of source, 4 bytes of ???, 2 bytes of type) header.</p>

<p>What happens if you plug the capture server <em>directly</em> into one of the SPAN ports?  (I.e., does it appear that the switch, or the SPAN aggregator, is inserting those extra 4 bytes?)</p></div>
            <div class="comment-info" id="comment-16475-info">
                
                
                
                

                

                <span class="comment-age">(01 Dec '12, 00:23)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-16449" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-16449-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/16449/high-number-of-unknown-ethertypes?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/16449/high-number-of-unknown-ethertypes?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/16449/high-number-of-unknown-ethertypes?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/16449/high-number-of-unknown-ethertypes?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="16477"></a>
                    <div id="answer-container-16477" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-16477-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/16477/up/" rel="nofollow"> </a>
<div id="post-16477-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-16477-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/16477/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>As <a href="/users/79/guy-harris"><a href="/users/79/guy-harris">@Guy Harris</a></a> already mentioned, there are allways 4 bytes in front of what looks like ethertype + IP header. As you mentioned it's 802.1q I thought it could be the VLAN tag and then I modified the (random) ethertype to 0x8100 (vlan tag). Now it looks reasonable, if those IP addresses are on your network. The whole ethernet frame (strange mac addresses, maybe wrong VLAN ID, etc.) seems to be kind of 'randomized'.</p>
<p><a href="http://cloudshark.org/captures/fee1e5f2926e">http://cloudshark.org/captures/fee1e5f2926e</a></p>
<p>So <strong>something</strong> is consistently modifying (randomizing) the ethernet frame, up to the 802.1q tag. As you mentioned a SPAN aggregator device, it could be that device. What do you see if you capture directly on a SPAN port?</p>
<p>Regards<br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/16477/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>01 Dec '12, 01:54</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/16477/">
                edited
                <strong>01 Dec '12, 02:08</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-16477">
    
        <a name="16481"></a>
        <div class="comment" id="comment-16481">
            <div id="post-16481-score" class="comment-score"></div>
            <div class="comment-text"><p>I'm not able to capture at the SPAN port today.  It looks like 50% or so are normal readable frames.  It looks like the first 4 bytes of these frames are extraneous.  I was able to get the true MACs from IPs in the capture Kurt provided.  The actual frame starts at the 5th octet.  I'm beginning to think its the 10G NIC card.  A filter was used at the Gigamon SPAN aggregator to filter the true source MAC.  tshark included frames matching the true MAC and frames that have 4 unknown bytes at the beginning.  This filter was applied at a second Gigamon port outputting to a different NIC card and the frames looked normal there.  I may try swapping ports at the Gigamon to see what happens.<br>
</p>

<p>Kurt - how did you go about modifying the frames/ethertypes?<br>
</p></div>
            <div class="comment-info" id="comment-16481-info">
                
                
                
                

                

                <span class="comment-age">(01 Dec '12, 14:19)</span>
                <a class="comment-user userinfo" href="/users/3801/ry6">ry6</a>
                
            </div>
        </div>
    
        <a name="16482"></a>
        <div class="comment" id="comment-16482">
            <div id="post-16482-score" class="comment-score">1</div>
            <div class="comment-text"><blockquote>
<p>The actual frame starts at the 5th octet.</p>
</blockquote>

<p>Ah, so <strong>something</strong> just added four bytes at the beginning of each frame. Interesting. But, if those 4 bytes at the beginning are extraneous, then where is the 802.1q tag of your frames?</p>

<blockquote>
<p>Kurt - how did you go about modifying the frames/ethertypes?</p>
</blockquote>

<p>I used a HEX editor.</p>

<p>BTW: I just saw, that you've tried several times to give me extra karma. That's only possible, if you have karma yourself. If you like my answer, you can click on the "thumbs up" icon. If you don't like it, click on the "thumbs down" icon (see FAQ).</p></div>
            <div class="comment-info" id="comment-16482-info">
                
                
                
                

                

                <span class="comment-age">(01 Dec '12, 15:02)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="16483"></a>
        <div class="comment" id="comment-16483">
            <div id="post-16483-score" class="comment-score">1</div>
            <div class="comment-text"><p>The <a href="http://www.gigamon.com">Gigamon</a> devices might also be adding headers, especially if they're <a href="http://www.gigamon.com/gigasmart-line-rate-packet-modification-technology">GigaSMART</a> devices.</p>

<p>The switch <a href="http://www.gigamon.com/vlan-filters">might be stripping VLAN tags</a>.</p></div>
            <div class="comment-info" id="comment-16483-info">
                
                
                
                

                

                <span class="comment-age">(01 Dec '12, 15:47)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="16484"></a>
        <div class="comment" id="comment-16484">
            <div id="post-16484-score" class="comment-score"></div>
            <div class="comment-text"><p>Port Labeling of the GigaSmart devices is a good find! </p>

<p>However, they say, that Wireshark is able to decode their GigaSMART headers !?!</p>

<blockquote>
<p><code><a href="http://www.gigamon.com/wireshark-update-for-gigasmart">http://www.gigamon.com/wireshark-update-for-gigasmart</a></code><br>
</p>
</blockquote>

<p>That's a message from 2010.</p></div>
            <div class="comment-info" id="comment-16484-info">
                
                
                
                

                

                <span class="comment-age">(01 Dec '12, 16:53)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="16485"></a>
        <div class="comment" id="comment-16485">
            <div id="post-16485-score" class="comment-score"></div>
            <div class="comment-text"><p><em>If</em> the GigaSMART devices, when they add their headers to the frame, change the Ethertype to 0x22E5 and put the real Ethertype into the Gigamon header, Wireshark will decode them.  (We also decode <em>trailers</em> that they add to frames, but that doesn't appear to be this issue.)</p>

<p>If, however, they (or the switch into which they're plugged) are just adding 4 extra bytes before the destination MAC address, we won't recognize that.  I don't know whether they would do that, however.</p>

<p>Seeing what happens when bypassing the Gigamon devices would help here.</p></div>
            <div class="comment-info" id="comment-16485-info">
                
                
                
                

                

                <span class="comment-age">(01 Dec '12, 17:40)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="16486"></a>
        <div class="comment not_top_scorer" id="comment-16486">
            <div id="post-16486-score" class="comment-score"></div>
            <div class="comment-text"><p>All but a couple SPAN links are tagged.  I was thinking this may explain where the dot1Q tags went in the posted capture.  However, I've noticed that most of the traffic is untagged (approx 800 of 10,000 frames) with tshark where I'd expect to see most tagged given the setup.  A capture with a different NIC, at the same time and same sources, had mostly tagged frames (7,000 of 10,000).  I suspect the problem is with the NIC card/driver not being able to handle the tags correctly?  I don't recall seeing this problem before using tagged SPAN links.</p>

<p>The Gigamon does have a GigaSMART card.  It is only licensed for de-dup functionality, which afaik does not manipulate packets.  Additionally, I mapped traffic directly from the Gigamon input to the output and bypassed the card completely.  I do plan to capture directly off a SPAN once back in the office. </p></div>
            <div class="comment-info" id="comment-16486-info">
                
                
                
                

                

                <span class="comment-age">(01 Dec '12, 20:32)</span>
                <a class="comment-user userinfo" href="/users/3801/ry6">ry6</a>
                
            </div>
        </div>
    
        <a name="16487"></a>
        <div class="comment not_top_scorer" id="comment-16487">
            <div id="post-16487-score" class="comment-score"></div>
            <div class="comment-text"><p>Hmm.  <em>If</em> the card on the Linux box doing the capturing is stripping out VLAN tags from the raw packet and supplying them out-of-band <em>and</em> the Linux networking stack is providing them to userland in packet metadata <em>and</em> libpcap is using the metadata and attempting to add the VLAN tags back to the raw packet data, there <em>might</em> be an error in the "attempting to add the VLAN tags back" stage.  There was a bug that showed up when capturing in "cooked mode", but this isn't a "cooked mode" capture.  What version of libpcap is the program doing the capturing using?</p></div>
            <div class="comment-info" id="comment-16487-info">
                
                
                
                

                

                <span class="comment-age">(02 Dec '12, 15:11)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="16493"></a>
        <div class="comment not_top_scorer" id="comment-16493">
            <div id="post-16493-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>It looks like the first 4 bytes of these frames are extraneous. 
I was able to get the true MACs from IPs in the capture Kurt provided.</p>
</blockquote>

<p>what are the real MAC addresses? If there are always 4 bytes added in 
front of the frame, I cannot see meaningful MAC addresses if I ignore
those four bytes. There is something that looks like a VRRP address 
(02:00:5e:*) but then there are prefixes, that don't match any vendor 
(d2:4b:81:*, 00:14:81:*).</p></div>
            <div class="comment-info" id="comment-16493-info">
                
                
                
                

                

                <span class="comment-age">(02 Dec '12, 23:33)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="16519"></a>
        <div class="comment not_top_scorer" id="comment-16519">
            <div id="post-16519-score" class="comment-score"></div>
            <div class="comment-text"><p>libpcap version is 1.0.0.</p>

<p>The real MACs are in the original cap ignoring the first 4 octets.  It appears the stated vendor OUIs are from the modified cap.</p></div>
            <div class="comment-info" id="comment-16519-info">
                
                
                
                

                

                <span class="comment-age">(03 Dec '12, 19:22)</span>
                <a class="comment-user userinfo" href="/users/3801/ry6">ry6</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-16477" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 9
        </span>
        <a href="#" class="show-all-comments-link">show 4 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-16477-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/16449/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='SPesqUDBZP3QGwdtverpQsCGYpgGeQAe' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/16449/high-number-of-unknown-ethertypes?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/16449/high-number-of-unknown-ethertypes?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/unknown/"
            class="tag-link-unknown"
            title="see questions tagged'unknown'using tags"
            rel="tag">unknown</a> <span class="tag-number">&#215;29</span><br/>
        
        <a href="/tags/ethertypes/"
            class="tag-link-ethertypes"
            title="see questions tagged'ethertypes'using tags"
            rel="tag">ethertypes</a> <span class="tag-number">&#215;1</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Nov. 29, 2012, 7:50 p.m.">29 Nov '12, 19:50</strong>
    </p>
    <p> 
     	question was seen: <strong>7,887 times</strong>
    </p>
    <p> 
        last updated: <strong title="Dec. 3, 2012, 7:22 p.m.">03 Dec '12, 19:22</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/1080/all-protocols-unknown">All Protocols Unknown</a>
        </p>
        
        <p>
            <a href="/questions/38111/unknown-command-ripv2">Unknown command Ripv2</a>
        </p>
        
        <p>
            <a href="/questions/1501/packet-with-unknown-ethernet-type-0x4d45">Packet with unknown Ethernet type 0x4d45</a>
        </p>
        
        <p>
            <a href="/questions/39776/dont-display-unknown-when-using-protofield-with-partial-valuestring-table">Don&#39;t display Unknown when using ProtoField with partial valuestring table</a>
        </p>
        
        <p>
            <a href="/questions/3235/adding-custom-tcp-options">Adding custom TCP options</a>
        </p>
        
        <p>
            <a href="/questions/41271/how-can-i-replace-unknown-to-other-text-of-valuestring-in-lua-dissector">How can I replace &quot;Unknown&quot; to other text of valuestring in Lua dissector</a>
        </p>
        
        <p>
            <a href="/questions/3883/called-party-unknown">called party unknown</a>
        </p>
        
        <p>
            <a href="/questions/45624/unknown-scsi-exchange-can-not-decode-scsi-data">Unknown SCSI exchange can not decode SCSI data</a>
        </p>
        
        <p>
            <a href="/questions/7469/unknown-inap">unknown inap</a>
        </p>
        
        <p>
            <a href="/questions/48743/mac-address-lookup-says-private-but-appears-on-my-network">MAC address lookup says private but appears on my network</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
