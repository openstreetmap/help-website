<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Gratuitous ARP with Multiple Zero Fields - Wireshark Q&amp;A</title>
        <meta name="description" content="We had an event in our network that generated an ARP storm. There were two contributors to this: 1) Gratuitous ARP Requests from VMware: at 09:35:02, we started seeing Gratuitous ARP&#39;s with Sending Eth MAC of particular VMGuest,  Destination Eth MAC = broadcast (ff&#39;s) In ARP:  Sender MAC all zeros, ..." />
        <meta name="keywords" content="arp,zeros,vmware,gratuitous" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/52295/gratuitous-arp-with-multiple-zero-fields" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/52295/gratuitous-arp-with-multiple-zero-fields?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='ZoVbgaXZrc9y6Kbg9ZfKhA2KH2HXhhsT' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/52295/gratuitous-arp-with-multiple-zero-fields">Gratuitous ARP with Multiple Zero Fields</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-52295-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/52295/up/" rel="nofollow"> </a>
<div id="post-52295-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-52295-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/52295/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/52295/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>We had an event in our network that generated an ARP storm.  There were two contributors to this:
1) Gratuitous ARP Requests from VMware:  at 09:35:02, we started seeing Gratuitous ARP's with
Sending Eth MAC of particular VMGuest, 
Destination Eth MAC = broadcast (ff's)
In ARP:</p>
<ul>
<li>Sender MAC all zeros, </li>
<li>Sender IP all zeros, </li>
<li>Target MAC All FF's, </li>
<li>Target IP all Zeros</li>
</ul>
<p>This gradually increased to a very high level from multiple VM Guests across every VLAN that the ESX host has on its trunk. Trying to understand:</p>
<ul>
<li>Has anyone seen this before?</li>
<li>Why are there All zeros in those ARP fields?</li>
<li>What could generate this traffic?</li>
</ul>
<p>2) Once this hit one of our VLAN's, I had GARP Replies from 5 different hosts with his own MAC in Sender MAC but all zeros in the other Sender/Target fields.  This huge storm led to a collapse of our older core switches because the ARP storm reached &gt;2GBps.  Question on this traffic is:
 - Why would a host reply to the GARP in this way?</p>
<p>Packet dissection below for request and reply.<br>
</p>
<p>Thanks in advance for help.</p>
<p>-Tim
</p><pre>GARP Request:
 No.     RelativeTime   Delta Display  Time                          Source                Src Port Destination           vlan_id    Length Info 
2715936 96.183749      0.001018       2016-05-06 09:36:06.341627    Vmware_ac:00:57                Broadcast             2081,127   68     Gratuitous ARP for 0.0.0.0 (Request)<p></p>
<p>Frame 2715936: 68 bytes on wire (544 bits), 68 bytes captured (544 bits)
    Encapsulation type: Ethernet (1)
    Arrival Time: May  6, 2016 09:36:06.341627000 Eastern Daylight Time
    [Time shift for this packet: 0.000000000 seconds]
    Epoch Time: 1462541766.341627000 seconds
    [Time delta from previous captured frame: 0.000000000 seconds]
    [Time delta from previous displayed frame: 0.001018000 seconds]
    [Time since reference or first frame: 96.183749000 seconds]
    Frame Number: 2715936
    Frame Length: 68 bytes (544 bits)
    Capture Length: 68 bytes (544 bits)
    [Frame is marked: False]
    [Frame is ignored: False]
    [Protocols in frame: eth:ethertype:vlan:ethertype:vlan:ethertype:arp]
    [Coloring Rule Name: ARP]
    [Coloring Rule String: arp]
Ethernet II, Src: Vmware_ac:00:57 (00:50:56:ac:00:57), Dst: Broadcast (ff:ff:ff:ff:ff:ff)
    Destination: Broadcast (ff:ff:ff:ff:ff:ff)
        Address: Broadcast (ff:ff:ff:ff:ff:ff)
        .... ..1. .... .... .... .... = LG bit: Locally administered address (this is NOT the factory default)
        .... ...1 .... .... .... .... = IG bit: Group address (multicast/broadcast)
    Source: Vmware_ac:00:57 (00:50:56:ac:00:57)
        Address: Vmware_ac:00:57 (00:50:56:ac:00:57)
        .... ..0. .... .... .... .... = LG bit: Globally unique address (factory default)
        .... ...0 .... .... .... .... = IG bit: Individual address (unicast)
    Type: 802.1Q Virtual LAN (0x8100)
802.1Q Virtual LAN, PRI: 1, CFI: 0, ID: 2081
    001. .... .... .... = Priority: Background (1)
    ...0 .... .... .... = CFI: Canonical (0)
    .... 1000 0010 0001 = ID: 2081
    Type: 802.1Q Virtual LAN (0x8100)
802.1Q Virtual LAN, PRI: 0, CFI: 0, ID: 127
    000. .... .... .... = Priority: Best Effort (default) (0)
    ...0 .... .... .... = CFI: Canonical (0)
    .... 0000 0111 1111 = ID: 127
    Type: ARP (0x0806)
    Padding: 00000000000000000000
    Trailer: 0000000000000000
Address Resolution Protocol (request/gratuitous ARP)
    Hardware type: Ethernet (1)
    Protocol type: IPv4 (0x0800)
    Hardware size: 6
    Protocol size: 4
    Opcode: request (1)
    [Is gratuitous: True]
    Sender MAC address: 00:00:00_00:00:00 (00:00:00:00:00:00)
    Sender IP address: 0.0.0.0
    Target MAC address: Broadcast (ff:ff:ff:ff:ff:ff)
    Target IP address: 0.0.0.0</p>
<p>GARP Reply:
No.     RelativeTime   Delta Display  Time                          Source                Src Port Destination           Dst Port vlan_id    Length<br>
1571028 0.984442       0.000000       2016-05-06 09:37:23.970442    Netscout_02:ce:e2              00:00:00_00:00:00              2340,228   68     Gratuitous ARP for 0.0.0.0 (Reply)</p>
<p>Frame 1571028: 68 bytes on wire (544 bits), 68 bytes captured (544 bits)
    Encapsulation type: Ethernet (1)
    Arrival Time: May  6, 2016 09:37:23.970442000 Eastern Daylight Time
    [Time shift for this packet: 0.000000000 seconds]
    Epoch Time: 1462541843.970442000 seconds
    [Time delta from previous captured frame: 0.000000000 seconds]
    [Time delta from previous displayed frame: 0.000000000 seconds]
    [Time since reference or first frame: 0.984442000 seconds]
    Frame Number: 1571028
    Frame Length: 68 bytes (544 bits)
    Capture Length: 68 bytes (544 bits)
    [Frame is marked: False]
    [Frame is ignored: False]
    [Protocols in frame: eth:ethertype:vlan:ethertype:vlan:ethertype:arp]
    [Coloring Rule Name: ARP]
    [Coloring Rule String: arp]
Ethernet II, Src: Netscout_02:ce:e2 (00:80:8c:02:ce:e2), Dst: 00:00:00_00:00:00 (00:00:00:00:00:00)
    Destination: 00:00:00_00:00:00 (00:00:00:00:00:00)
        Address: 00:00:00_00:00:00 (00:00:00:00:00:00)
        .... ..0. .... .... .... .... = LG bit: Globally unique address (factory default)
        .... ...0 .... .... .... .... = IG bit: Individual address (unicast)
    Source: Netscout_02:ce:e2 (00:80:8c:02:ce:e2)
        Address: Netscout_02:ce:e2 (00:80:8c:02:ce:e2)
        .... ..0. .... .... .... .... = LG bit: Globally unique address (factory default)
        .... ...0 .... .... .... .... = IG bit: Individual address (unicast)
    Type: 802.1Q Virtual LAN (0x8100)
802.1Q Virtual LAN, PRI: 1, CFI: 0, ID: 2340
    001. .... .... .... = Priority: Background (1)
    ...0 .... .... .... = CFI: Canonical (0)
    .... 1001 0010 0100 = ID: 2340
    Type: 802.1Q Virtual LAN (0x8100)
802.1Q Virtual LAN, PRI: 0, CFI: 0, ID: 228
    000. .... .... .... = Priority: Best Effort (default) (0)
    ...0 .... .... .... = CFI: Canonical (0)
    .... 0000 1110 0100 = ID: 228
    Type: ARP (0x0806)
    Padding: 00000000000000000000
    Trailer: 0000000000000000
Address Resolution Protocol (reply/gratuitous ARP)
    Hardware type: Ethernet (1)
    Protocol type: IPv4 (0x0800)
    Hardware size: 6
    Protocol size: 4
    Opcode: reply (2)
    [Is gratuitous: True]
    Sender MAC address: Netscout_02:ce:e2 (00:80:8c:02:ce:e2)
    Sender IP address: 0.0.0.0
    Target MAC address: 00:00:00_00:00:00 (00:00:00:00:00:00)
    Target IP address: 0.0.0.0
</p></pre><p></p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/arp/" class="post-tag tag-link-arp"
                                        title="see questions tagged 'arp'" rel="tag">arp</a>
                                
                                    <a href="/tags/zeros/" class="post-tag tag-link-zeros"
                                        title="see questions tagged 'zeros'" rel="tag">zeros</a>
                                
                                    <a href="/tags/vmware/" class="post-tag tag-link-vmware"
                                        title="see questions tagged 'vmware'" rel="tag">vmware</a>
                                
                                    <a href="/tags/gratuitous/" class="post-tag tag-link-gratuitous"
                                        title="see questions tagged 'gratuitous'" rel="tag">gratuitous</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>07 May '16, 09:39</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/3f2f87a6a68e4c51c3851c20b6c56a1a?s=32&amp;d=identicon&amp;r=g" alt="CMH_Tim's gravatar image" />
    <p><a href="/users/24085/cmh_tim">CMH_Tim</a><br/>
    <span class="score" title="11 reputation points">11</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="6 badges"><span class="bronze">&#9679;</span><span class="badgecount">6</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="CMH_Tim has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/52295/">
                edited
                <strong>07 May '16, 19:53</strong>
            </a>
        </p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-52295">
    
        <a name="52296"></a>
        <div class="comment" id="comment-52296">
            <div id="post-52296-score" class="comment-score"></div>
            <div class="comment-text"><p>Apologize for poor formatting...first time posting - wasn't sure how to maintain clean view.</p>

<p>PLease advise if repost is needed.</p></div>
            <div class="comment-info" id="comment-52296-info">
                
                
                
                

                

                <span class="comment-age">(07 May '16, 09:40)</span>
                <a class="comment-user userinfo" href="/users/24085/cmh_tim">CMH_Tim</a>
                
            </div>
        </div>
    
        <a name="52302"></a>
        <div class="comment" id="comment-52302">
            <div id="post-52302-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks, Jasper for the formatting assist! What button should I have hit?</p></div>
            <div class="comment-info" id="comment-52302-info">
                
                
                
                

                

                <span class="comment-age">(07 May '16, 19:51)</span>
                <a class="comment-user userinfo" href="/users/24085/cmh_tim">CMH_Tim</a>
                
            </div>
        </div>
    
        <a name="52304"></a>
        <div class="comment" id="comment-52304">
            <div id="post-52304-score" class="comment-score"></div>
            <div class="comment-text"><p>Forget about the buttons as many of the necessary ones are missing. Press "edit" under the Question or Answer post (the page layout is different when editing comments); to the right from the text entry pane with the buttons above, there is another (read-only) one, called "Markdown Basics", with a link to "learn more about Markdown". And look for "code" there.</p>

<p>Or edit your own Question and see what formatting characters Jasper had to add so that the text would look that way.</p></div>
            <div class="comment-info" id="comment-52304-info">
                
                
                
                

                

                <span class="comment-age">(08 May '16, 01:25)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-52295" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-52295-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/52295/gratuitous-arp-with-multiple-zero-fields?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/52295/gratuitous-arp-with-multiple-zero-fields?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/52295/gratuitous-arp-with-multiple-zero-fields?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/52295/gratuitous-arp-with-multiple-zero-fields?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="52298"></a>
                    <div id="answer-container-52298" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-52298-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/52298/up/" rel="nofollow"> </a>
<div id="post-52298-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-52298-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/52298/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>I don't think that the ARP where the root cause.<br>
I think the broadcast storm is more a follow up. I think you had got a looping network.
But some info about that kind of ARP packets can be found here:</p>
<p><a href="https://crnetpackets.com/2015/08/28/special-type-of-arp-packets/">https://crnetpackets.com/2015/08/28/special-type-of-arp-packets/</a></p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/52298/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>07 May '16, 14:10</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/3b24b339fc62fb46dced6a443d3202ea?s=32&amp;d=identicon&amp;r=g" alt="Christian_R's gravatar image" />
    <p><a href="/users/16160/christian_r">Christian_R</a><br/>
    <span class="score" title="1830 reputation points"><span class="">1.8k</span></span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="6 badges"><span class="silver">&#9679;</span><span class="badgecount">6</span></span><span title="25 badges"><span class="bronze">&#9679;</span><span class="badgecount">25</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Christian_R has 25 accepted answers">16&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-52298">
    
        <a name="52301"></a>
        <div class="comment" id="comment-52301">
            <div id="post-52301-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks Christian for the response and the link. My response below:</p>

<p>1) I believe a loop is a possibility, but we've not found proof of it. I'm scrubbing packets to see if there are any spanning tree changes noted. Nothing in our logs so far indicates any network change that would have suddenly caused us to have a loop and triggered this. Regardless of that outcome, I do still believe that VMWare's packets are not properly formatted.</p>

<p>2) Maybe I missed it, but that link doesn't show any packet with an all-zeros sender MAC or all-zeros on sender and target IP address. My understanding is that the sender should always put there own MAC at the very least.</p>

<p>Since posting, I've also confirmed that these packets are NOT actually originating from the guest but are generated by the ESX host (had a local packet capture agent running on some guests during the start of this event that didn't show the GARP packets when my network taps did show them).</p>

<p>I've done some more research and it appears that this behavior may be related to VMWare's "Notify Switch" setting where it sends a RARP packet when a VMGuest joins the network. This RARP has both sender and target MAC set to the Guest MAC. Here's a reference: <a href="http://rickardnobel.se/vswitch-notify-switches-setting/">http://rickardnobel.se/vswitch-notify-switches-setting/</a> Since original post, I've confirmed the RARP's are there and look correct (also not seen on guest VM capture), but the GARP's are not mentioned in that reference and look wrong to me.</p>

<p>So I'm working with our design engineers to figure out how a loop could have occurred, but still need answers to my original questions about why the GARP requests and subsequent GARP replies were generated.</p>

<p>Thanks, Tim</p></div>
            <div class="comment-info" id="comment-52301-info">
                
                
                
                

                

                <span class="comment-age">(07 May '16, 19:51)</span>
                <a class="comment-user userinfo" href="/users/24085/cmh_tim">CMH_Tim</a>
                
            </div>
        </div>
    
        <a name="52305"></a>
        <div class="comment" id="comment-52305">
            <div id="post-52305-score" class="comment-score">1</div>
            <div class="comment-text"><blockquote>
<p>still need answers to my original questions about why the GARP requests and subsequent GARP replies were generated</p>
</blockquote>

<p>While it is hard to say why the original GARP <strong>requests</strong> have been generated (most likely candidates are mere bug and some malware), I'm afraid that many (if not all) implementations would respond to an ARP request containing</p>

<pre><code>Target MAC address: Broadcast (ff:ff:ff:ff:ff:ff)
Target IP address: 0.0.0.0
</code></pre>

<p>regardless whether such request has been sent as gratuitous or not. The reason is that 0.0.0.0 normally means "any of my local IPs" in local context (see section 3.2.1.3 of <a href="https://tools.ietf.org/html/rfc1122">RFC 1122</a>, especially the point "must not be sent except as source under specific circumstances").</p>

<p>So you don't even need a loop, it is enough that all machines on the LAN segment respond to a single broadcast ARP request to have a kind of LAN Smurf Attack.</p></div>
            <div class="comment-info" id="comment-52305-info">
                
                
                
                

                

                <span class="comment-age">(08 May '16, 01:49)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="52320"></a>
        <div class="comment" id="comment-52320">
            <div id="post-52320-score" class="comment-score"></div>
            <div class="comment-text"><p>Well if I were you, I would go with my findings into the lab and try to get a better understanding of this ARPs and their interaction with the network devices. </p>

<p>There are so much ARP implementation out there and everyone is a little bit different.</p>

<p>LetÂ´s assume this is the root cause of your problem! How often can you see these Requests? And does it always tear down the network? And how many hosts will answer? And how long (time) can you see this high BC rate?</p>

<p>Also a loop could occur without some log entrys.
Your link was filled up with &gt;2GBit/s Broadcast -&gt; this is normally done by a loop.
How have you stoped this incident?</p>

<p>But I agree with you and <a href="/users/19586/sindy"></a><a href="/users/19586/sindy">@sindy</a> this ARP packets looks different to the normal GARPs.</p></div>
            <div class="comment-info" id="comment-52320-info">
                
                
                
                

                

                <span class="comment-age">(08 May '16, 12:12)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
        <a name="52346"></a>
        <div class="comment" id="comment-52346">
            <div id="post-52346-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/19586/sindy">@sindy</a> - Thanks about the replies.  That makes sense, although not every device replies like that, of course so I think a lot of implementations are interpreting those as incorrect/not relevant and not responding.<br>
</p>

<p><a href="/users/16160/christian_r">@Christian_R</a> - We are working with the vendor but not had much luck getting them to figure out why they generate these packets.  We do have a low volume still going on without noticeable impact, but I'm concerned that if we hit the VLAN where devices actually respond, we could see minor issues again.</p>

<p>That being said, I'm fairly certain now that those are a symptom - no matter how strange - but not root cause.  As noted below, I'm pretty sure that you were right that the root cause was a loop.</p>

<p>I did go back into our logs from Friday's event and found a 3750 switch stack that logged MAC flapping shortly <em>after</em> the GARP storm started.  The flaps were on its two uplinks to our core switches and contained the MACs of the core switches, so there was some type of loop at that time, just no logs of it before the GARP's.  Switch/router engineers took a look but couldn't find any evidence of a loop so Saturday night, we proceeded to bring redundancy back by restarting and reconnecting all links to the 2nd core switch.</p>

<p>When we brought the 2nd core switch back into the network late Saturday night and began reconnecting the redundant links between the core and edges, all went well until that 3750 stack was connected.  Once that happened, we had another GARP storm and same impact as before.</p>

<p>We have no changes made by anyone on Friday when this happened, but my guess is that something happened that started the loop but nothing got logged.  On Saturday's reconnect, we're certain there was no storm before the MAC flaps started again.<br>
</p>

<p>Thanks again for the help.  Would love to hear from someone who could explain those GARP requests.</p></div>
            <div class="comment-info" id="comment-52346-info">
                
                
                
                

                

                <span class="comment-age">(09 May '16, 06:57)</span>
                <a class="comment-user userinfo" href="/users/24085/cmh_tim">CMH_Tim</a>
                
            </div>
        </div>
    
        <a name="52355"></a>
        <div class="comment" id="comment-52355">
            <div id="post-52355-score" class="comment-score"></div>
            <div class="comment-text"><p>Well here could be found more info for the ARPs:<br>
<a href="https://ask.wireshark.org/questions/5178/why-gratuitous-arps-for-0000">https://ask.wireshark.org/questions/5178/why-gratuitous-arps-for-0000</a>
<br>
<a href="http://www.cisco.com/c/en/us/support/docs/ios-nx-os-software/8021x/116529-problemsolution-product-00.html">http://www.cisco.com/c/en/us/support/docs/ios-nx-os-software/8021x/116529-problemsolution-product-00.html</a>
<br>
<a href="https://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=1028373">https://kb.vmware.com/selfservice/microsites/search.do?language=en_US&amp;cmd=displayKC&amp;externalId=1028373</a>
<br> 
But I have not read them all. And I have no real world experience with those special type of ARPs.</p>

<p>Back to your loop:
 - Sometimes high CPU Load could cause a loop. 
 - Sometimnes this load could be caused by ARP Storms, when you use managed switches.
 - Some Spanning Tree configurations might end in high CPU load, too.</p></div>
            <div class="comment-info" id="comment-52355-info">
                
                
                
                

                

                <span class="comment-age">(09 May '16, 11:24)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-52298" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-52298-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/52295/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='ZoVbgaXZrc9y6Kbg9ZfKhA2KH2HXhhsT' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/52295/gratuitous-arp-with-multiple-zero-fields?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/52295/gratuitous-arp-with-multiple-zero-fields?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/arp/"
            class="tag-link-arp"
            title="see questions tagged'arp'using tags"
            rel="tag">arp</a> <span class="tag-number">&#215;78</span><br/>
        
        <a href="/tags/vmware/"
            class="tag-link-vmware"
            title="see questions tagged'vmware'using tags"
            rel="tag">vmware</a> <span class="tag-number">&#215;23</span><br/>
        
        <a href="/tags/gratuitous/"
            class="tag-link-gratuitous"
            title="see questions tagged'gratuitous'using tags"
            rel="tag">gratuitous</a> <span class="tag-number">&#215;7</span><br/>
        
        <a href="/tags/zeros/"
            class="tag-link-zeros"
            title="see questions tagged'zeros'using tags"
            rel="tag">zeros</a> <span class="tag-number">&#215;1</span><br/>
        
    </p>
    <p>
        question asked: <strong title="May 7, 2016, 9:39 a.m.">07 May '16, 09:39</strong>
    </p>
    <p> 
     	question was seen: <strong>3,777 times</strong>
    </p>
    <p> 
        last updated: <strong title="May 9, 2016, 11:24 a.m.">09 May '16, 11:24</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/5178/why-gratuitous-arps-for-0000">Why gratuitous ARPs for 0.0.0.0?</a>
        </p>
        
        <p>
            <a href="/questions/57839/gratuitous-arp-broadcasts-factory-default-ip">Gratuitous ARP broadcasts factory default IP</a>
        </p>
        
        <p>
            <a href="/questions/58755/exactly-how-does-wireshark-determine-and-label-a-gratuitous-arp-as-gratuitous">Exactly how does Wireshark determine and label a Gratuitous ARP as Gratuitous?</a>
        </p>
        
        <p>
            <a href="/questions/49391/gratuitous-arp">Gratuitous ARP</a>
        </p>
        
        <p>
            <a href="/questions/51195/gratuitous-arp-has-unknown-manufactures-target-mac-address">Gratuitous ARP has unknown manufactures &quot;Target MAC address</a>
        </p>
        
        <p>
            <a href="/questions/41408/gratuitous-arp">Gratuitous ARP</a>
        </p>
        
        <p>
            <a href="/questions/2639/arp-question">ARP Question</a>
        </p>
        
        <p>
            <a href="/questions/15103/why-does-wireshark-show-my-pcs-searching-for-their-default-gateway-address-repeatedly">Why Does Wireshark show my pc&#39;s searching for their default gateway address repeatedly?</a>
        </p>
        
        <p>
            <a href="/questions/35932/help-with-spanning-tree-and-excessive-arp-requests">Help with spanning tree and Excessive ARP requests</a>
        </p>
        
        <p>
            <a href="/questions/45926/trying-to-understand-what-a-specific-arp-request-is-for">Trying to understand what a specific ARP request is for</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
