<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Trying to figure out who is closing these sessions - Wireshark Q&amp;A</title>
        <meta name="description" content="The Server seems to be sending FIN Acks for sessions that aren&#39;t in the trace, goes on for awhile and then the sessions all resume. Thanks in advance. Uploaded here: https://www.cloudshark.org/captures/86369a51b115" />
        <meta name="keywords" content="tls,client,server,sessions" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/62714/trying-to-figure-out-who-is-closing-these-sessions" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/62714/trying-to-figure-out-who-is-closing-these-sessions?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='Samh5w5cGtp9mNoRW1Atqd5bXiSf1KA8' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/62714/trying-to-figure-out-who-is-closing-these-sessions">Trying to figure out who is closing these sessions</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-62714-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/62714/up/" rel="nofollow"> </a>
<div id="post-62714-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-62714-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/62714/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/62714/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>The Server seems to be sending FIN Acks for sessions that aren't in the trace, goes on for awhile and then the sessions all resume.</p>
<p>Thanks in advance.</p>
<p>Uploaded here:
<a href="https://www.cloudshark.org/captures/86369a51b115">https://www.cloudshark.org/captures/86369a51b115</a></p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/tls/" class="post-tag tag-link-tls"
                                        title="see questions tagged 'tls'" rel="tag">tls</a>
                                
                                    <a href="/tags/client/" class="post-tag tag-link-client"
                                        title="see questions tagged 'client'" rel="tag">client</a>
                                
                                    <a href="/tags/server/" class="post-tag tag-link-server"
                                        title="see questions tagged 'server'" rel="tag">server</a>
                                
                                    <a href="/tags/sessions/" class="post-tag tag-link-sessions"
                                        title="see questions tagged 'sessions'" rel="tag">sessions</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>12 Jul '17, 10:31</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/abb4d610318f8a1823c43c659eebdf55?s=32&amp;d=identicon&amp;r=g" alt="wiskydelta's gravatar image" />
    <p><a href="/users/38920/wiskydelta">wiskydelta</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">&#9679;</span><span class="badgecount">2</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="wiskydelta has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-62714">
    
        <a name="62716"></a>
        <div class="comment" id="comment-62716">
            <div id="post-62716-score" class="comment-score"></div>
            <div class="comment-text"><p>Can you make the capture at Cloudshark publicly accessible?</p></div>
            <div class="comment-info" id="comment-62716-info">
                
                
                
                

                

                <span class="comment-age">(12 Jul '17, 10:51)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="62717"></a>
        <div class="comment" id="comment-62717">
            <div id="post-62717-score" class="comment-score"></div>
            <div class="comment-text"><p>Should be accessible now</p></div>
            <div class="comment-info" id="comment-62717-info">
                
                
                
                

                

                <span class="comment-age">(12 Jul '17, 12:00)</span>
                <a class="comment-user userinfo" href="/users/38920/wiskydelta">wiskydelta</a>
                
            </div>
        </div>
    
        <a name="62718"></a>
        <div class="comment" id="comment-62718">
            <div id="post-62718-score" class="comment-score"></div>
            <div class="comment-text"><p>What do you mean by "the sessions all resume"? Strictly speaking, a TCP session cannot "resume" once finished. An application may resume conversation, using a new TCP session.</p>

<p>Other than that, the first FIN seems to always come from the client side, the server only responds to it.</p>

<p>Not knowing the application case, it is hard to say anything more. I could imagine many clients behind the same NAT device, all of which keep TCP sessions alive for a while after the last application request has been responded, and then close them gracefully (using FIN) on timeout (which is quite a rational approach given the overhead of setting up and especially tearing down a TCP session). You would have to capture for much longer to see several TCP sessions to be established and closed to make some more useful conclusions.</p>

<p>I would consider it some kind of attack to the client, where somebody else would send FINs in its name, expecting that the server would respond with its own FIN, but two things contradict that view:</p>

<ul>
<li>new sessions from the same client side IP are successfully established,</li>
<li>there would have to be some specific bug in the TCP stack of the server that it would respond a client's FIN with its own one if the session would not exist.</li>
</ul>

<p>But there is also a possibility that it is some security device which forges a FIN in the name of the client and handles the consequences smoothly. Can you capture also at client side in parallel to the server side to prove or deny this?</p></div>
            <div class="comment-info" id="comment-62718-info">
                
                
                
                

                

                <span class="comment-age">(12 Jul '17, 12:27)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="62722"></a>
        <div class="comment" id="comment-62722">
            <div id="post-62722-score" class="comment-score"></div>
            <div class="comment-text"><p>When I say resume, all communications stops and I see a ton of FIN Acks, when they stop then the sessions start establishing correctly again and working. Working on getting a client capture now.</p></div>
            <div class="comment-info" id="comment-62722-info">
                
                
                
                

                

                <span class="comment-age">(12 Jul '17, 13:24)</span>
                <a class="comment-user userinfo" href="/users/38920/wiskydelta">wiskydelta</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-62714" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-62714-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
        <form id="fmanswer" action="/questions/62714/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='Samh5w5cGtp9mNoRW1Atqd5bXiSf1KA8' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Be the first one to answer this question!
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/62714/trying-to-figure-out-who-is-closing-these-sessions?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/62714/trying-to-figure-out-who-is-closing-these-sessions?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/tls/"
            class="tag-link-tls"
            title="see questions tagged'tls'using tags"
            rel="tag">tls</a> <span class="tag-number">&#215;75</span><br/>
        
        <a href="/tags/server/"
            class="tag-link-server"
            title="see questions tagged'server'using tags"
            rel="tag">server</a> <span class="tag-number">&#215;52</span><br/>
        
        <a href="/tags/client/"
            class="tag-link-client"
            title="see questions tagged'client'using tags"
            rel="tag">client</a> <span class="tag-number">&#215;21</span><br/>
        
        <a href="/tags/sessions/"
            class="tag-link-sessions"
            title="see questions tagged'sessions'using tags"
            rel="tag">sessions</a> <span class="tag-number">&#215;6</span><br/>
        
    </p>
    <p>
        question asked: <strong title="July 12, 2017, 10:31 a.m.">12 Jul '17, 10:31</strong>
    </p>
    <p> 
     	question was seen: <strong>1,313 times</strong>
    </p>
    <p> 
        last updated: <strong title="July 12, 2017, 1:24 p.m.">12 Jul '17, 13:24</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/40565/trying-to-decrypt-messages-to-and-from-my-chat-client">Trying to decrypt messages to and from my chat client</a>
        </p>
        
        <p>
            <a href="/questions/1295/excessive-internet-traffic-eminating-from-sbs-2003-server">Excessive internet traffic eminating from SBS 2003 Server</a>
        </p>
        
        <p>
            <a href="/questions/18825/server-2003-file-listing-problem-part-2">Server 2003 file listing problem Part 2</a>
        </p>
        
        <p>
            <a href="/questions/36479/startup-traffic">Startup Traffic</a>
        </p>
        
        <p>
            <a href="/questions/54941/about-console-games-latencydelayserver-response-times">About Console games Latency/Delay/Server Response times</a>
        </p>
        
        <p>
            <a href="/questions/45567/get-email-content-text-if-using-a-program">Get email content (text) if using a program</a>
        </p>
        
        <p>
            <a href="/questions/21215/rtp-over-tls-connection-cant-be-decrypted-in-wireshark">RTP over TLS connection can&#39;t be decrypted in wireshark?</a>
        </p>
        
        <p>
            <a href="/questions/37383/how-do-i-followdecrypt-a-tlsssl-session-containing-a-tls-ticket-change">How do I follow/decrypt a TLS/SSL session containing a TLS ticket change?</a>
        </p>
        
        <p>
            <a href="/questions/47508/tshark-command-syntax-for-decrypting-tls-traffic-from-2-or-more-servers">tshark: command syntax for decrypting TLS traffic from 2 or more servers</a>
        </p>
        
        <p>
            <a href="/questions/53796/why-is-tls-called-ssl-in-protocol-column">Why is TLS called SSL in protocol column</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
