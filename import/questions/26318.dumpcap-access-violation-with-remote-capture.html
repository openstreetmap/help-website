<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Dumpcap access violation with remote capture - Wireshark Q&amp;A</title>
        <meta name="description" content="Hello everyone, I&#39;ve implemented a remote capture server based on the Remote Packet Capture Protocol v.0 (actually based on the communication supported by the RPCAP daemon from WinPcap) with some virtual interfaces which are specifically managed on the server. The server can communicate with Wiresha..." />
        <meta name="keywords" content="rpcap,remote,dumpcap" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/26318/dumpcap-access-violation-with-remote-capture" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/26318/dumpcap-access-violation-with-remote-capture?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='NTRwUqqw8xuMIDOjotFWIuMTgMvLGPc1' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/26318/dumpcap-access-violation-with-remote-capture">Dumpcap access violation with remote capture</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-26318-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/26318/up/" rel="nofollow"> </a>
<div id="post-26318-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-26318-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/26318/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/26318/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hello everyone,</p>
<p>I've implemented a remote capture server based on the Remote Packet Capture Protocol v.0 (actually based on the communication supported by the RPCAP daemon from WinPcap) with some virtual interfaces which are specifically managed on the server.</p>
<p>The server can communicate with Wireshark and deliver a list of interfaces and start a capture with devices present in the list (no devices are currently delivering data, so the capture is empty). In fact, the capture with multiple interfaces can sometimes be successfully started. However, sometimes the dumpcap process activated by the capture delivers an "Access violation" message.</p>
<p>I'm currently using Wireshark 1.8.3, which is, as far as I know, from late 2011. I've also checked for the error message online and saw a notice related to an access violation in dumpcap from 2012. Do you know if there is a place in dumpcap where the access violation is likely to happen? One important fact is that the implemented server delivers devices with no addresses, as they are irrelevant inside the server. Is it possible that dumpcap accesses a null address structure in the device list and gets the access violation from there?</p>
<p>Thanks!</p>
<p><strong>EDIT</strong>: The error seems to go away if I disable the option "Do not capture own RPCAP traffic" in "Edit Interface Settings"→"Remote Settings".</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/rpcap/" class="post-tag tag-link-rpcap"
                                        title="see questions tagged 'rpcap'" rel="tag">rpcap</a>
                                
                                    <a href="/tags/remote/" class="post-tag tag-link-remote"
                                        title="see questions tagged 'remote'" rel="tag">remote</a>
                                
                                    <a href="/tags/dumpcap/" class="post-tag tag-link-dumpcap"
                                        title="see questions tagged 'dumpcap'" rel="tag">dumpcap</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>23 Oct '13, 04:19</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/b15e02964ce3e65a7e667354809a33e5?s=32&amp;d=identicon&amp;r=g" alt="Matheus%20Priebe%20Bertram's gravatar image" />
    <p><a href="/users/4008/matheus-priebe-bertram">Matheus Prie...</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="3 badges"><span class="silver">&#9679;</span><span class="badgecount">3</span></span><span title="5 badges"><span class="bronze">&#9679;</span><span class="badgecount">5</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Matheus Priebe Bertram has one accepted answer">100&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/26318/">
                edited
                <strong>23 Oct '13, 06:23</strong>
            </a>
        </p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-26318">
    
        <a name="26484"></a>
        <div class="comment" id="comment-26484">
            <div id="post-26484-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>I've implemented a remote capture server based on the Remote Packet Capture Protocol v.0 </p>
</blockquote>

<p>what do you mean by 'implemented'? Did you write your own rpcap daemon or did you use an existing tool? If the later, please tell us:</p>

<ul>
<li>your OS and version of the client (where dumpcap is running)</li>
<li>your OS and version of the server (where the rpcap daemon is running)</li>
</ul></div>
            <div class="comment-info" id="comment-26484-info">
                
                
                
                

                

                <span class="comment-age">(28 Oct '13, 09:30)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="26531"></a>
        <div class="comment" id="comment-26531">
            <div id="post-26531-score" class="comment-score"></div>
            <div class="comment-text"><p>I wrote my own rpcap daemon based on the "standard" rpcap daemon from WinPcap in order to get the communication protocol right.</p>

<p>Client: Windows XP SP3.
Server: openSUSE Linux 11.2.</p>

<p>I've debugged dumpcap and the problem seems to be around a call to pcap_dispatch. The access violation happens after the server has sent a start capture reply. As previously said, the failure does not happen if the option "Do not capture own RPCAP traffic" is turned off.</p>

<p>Thanks for the response.</p></div>
            <div class="comment-info" id="comment-26531-info">
                
                
                
                

                

                <span class="comment-age">(30 Oct '13, 03:17)</span>
                <a class="comment-user userinfo" href="/users/4008/matheus-priebe-bertram">Matheus Prie...</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-26318" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-26318-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/26318/dumpcap-access-violation-with-remote-capture?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/26318/dumpcap-access-violation-with-remote-capture?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/26318/dumpcap-access-violation-with-remote-capture?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/26318/dumpcap-access-violation-with-remote-capture?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="26652"></a>
                    <div id="answer-container-26652" class="answer accepted-answer answered-by-owner">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-26652-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/26652/up/" rel="nofollow"> </a>
<div id="post-26652-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-26652-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/26652/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="Matheus Priebe Bertram has selected this answer as the correct answer"
        href="/accept_answer/26652/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>The problem is solved now. After installing WinPcap 4.1.2 replacing WinPcap 4.0.2 (these modifications take place on the client, the server has used WinPcap 4.1.3 from the beginning) the client dumpcap does not crash anymore (at least statistically :-)). I'm not quite sure, however, about what exactly is the essential difference between both versions. That would require a thorough examination of both source codes.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/26652/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>04 Nov '13, 02:15</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/b15e02964ce3e65a7e667354809a33e5?s=32&amp;d=identicon&amp;r=g" alt="Matheus%20Priebe%20Bertram's gravatar image" />
    <p><a href="/users/4008/matheus-priebe-bertram">Matheus Prie...</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="3 badges"><span class="silver">&#9679;</span><span class="badgecount">3</span></span><span title="5 badges"><span class="bronze">&#9679;</span><span class="badgecount">5</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Matheus Priebe Bertram has one accepted answer">100&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-26652">
    
</div>
<div id="comment-tools-26652" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-26652-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="26537"></a>
                    <div id="answer-container-26537" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-26537-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/26537/up/" rel="nofollow"> </a>
<div id="post-26537-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-26537-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/26537/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <blockquote>
<p>I <strong>wrote my own rpcap daemon</strong> based on the "standard" rpcap daemon from WinPcap in order to get the communication protocol right.</p>
</blockquote>
<p>Hm.. sounds like a bug in your version of the RPCAP protocol 'kills' dumpcap and/or Wireshark.</p>
<blockquote>
<p>I've debugged dumpcap and the problem seems to be around a call to pcap_dispatch. 
The access violation happens after the server has sent a start capture reply. </p>
</blockquote>
<p>hm.. if you provide the wrong data within your version of the RPCAP protocol (too much or not enough data), that could be a problem, although a memory access violation is pretty bad.</p>
<blockquote>
<p>As previously said, the failure <strong>does not happen if the option "Do not capture own RPCAP traffic" is turned off</strong>.</p>
</blockquote>
<p>that's odd and sounds like there might be a bug in the RPCAP dissector that is triggered by a failure in your version of the RPCAP protocol (the dissector kills Wireshark). </p>
<p>However: What I don't understand: You said, <strong>dumpcap</strong> gets killed not Wireshark, in which case it cannot be a dissector bug. </p>
<p>I guess, this is more a problem of (your) code debugging than anything that we can solve within the Wireshark community. </p>
<p>Regards<br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/26537/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>30 Oct '13, 07:16</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-26537">
    
        <a name="26574"></a>
        <div class="comment" id="comment-26574">
            <div id="post-26574-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>Hm.. sounds like a bug in your version of the RPCAP protocol 'kills' dumpcap and/or Wireshark.</p>
</blockquote>

<p>That does not seem to be the case. I've traced the RPCAP communication between client and server with the RPCAP dissector and all packets are well-formed and correctly sent by the latter. I imagine the server could only kill the client's application if it had sent something incorrect, which is not the case.</p>

<blockquote>
<p>hm.. if you provide the wrong data within your version of the RPCAP protocol (too much or not enough data), that could be a problem, although a memory access violation is pretty bad.</p>
</blockquote>

<p>Not enough data, afaik, evokes a different problem on the client: it blocks until it receives at least the intended amount of data. This is also not the case, as the client accepts what it has received from the server and continues to run. Sending too much data seems not to be the case too, as the tracing done showed all packets sent from the server are well-formed. Furthermore, too much data should be treated by the client with a discard.</p>

<blockquote>
<p>that's odd and sounds like there might be a bug in the RPCAP dissector that is triggered by a failure in your version of the RPCAP protocol (the dissector kills Wireshark). </p>
</blockquote>

<p>Wireshak is not killed. Wireshark, when capturing, creates a new process which calls dumpcap. This new instance of dumpcap is killed by itself.</p>

<blockquote>
<p>However: What I don't understand: You said, dumpcap gets killed not Wireshark, in which case it cannot be a dissector bug. </p>
</blockquote>

<p>Correct. The RPCAP dissector seems to be working just fine.</p>

<p>I'll keep on checking and see what I can find. Thanks for the reply.</p></div>
            <div class="comment-info" id="comment-26574-info">
                
                
                
                

                

                <span class="comment-age">(31 Oct '13, 03:54)</span>
                <a class="comment-user userinfo" href="/users/4008/matheus-priebe-bertram">Matheus Prie...</a>
                
            </div>
        </div>
    
        <a name="26575"></a>
        <div class="comment" id="comment-26575">
            <div id="post-26575-score" class="comment-score"></div>
            <div class="comment-text"><p>What you say may or may not be the case. Hard to validate without access to the code of your RPCAP implementation.</p>

<p>BTW: Why did you write your own RPCAP daemon?</p></div>
            <div class="comment-info" id="comment-26575-info">
                
                
                
                

                

                <span class="comment-age">(31 Oct '13, 03:57)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="26576"></a>
        <div class="comment" id="comment-26576">
            <div id="post-26576-score" class="comment-score"></div>
            <div class="comment-text"><p>The standard RPCAP daemon lists all physical interfaces and is able to provide capture data which flows through them. What we are working with are, however, "virtual" interfaces. These are e.g. files or even processes on the server machine which generate their own PCAP data about some internal communication protocols we have. These data should then be sent over the network to the client.</p></div>
            <div class="comment-info" id="comment-26576-info">
                
                
                
                

                

                <span class="comment-age">(31 Oct '13, 04:16)</span>
                <a class="comment-user userinfo" href="/users/4008/matheus-priebe-bertram">Matheus Prie...</a>
                
            </div>
        </div>
    
        <a name="26578"></a>
        <div class="comment" id="comment-26578">
            <div id="post-26578-score" class="comment-score"></div>
            <div class="comment-text"><p>Ah, O.K. something totally different. Will your code be open source? If so, someone here might find some time to check the code and run some tests.</p></div>
            <div class="comment-info" id="comment-26578-info">
                
                
                
                

                

                <span class="comment-age">(31 Oct '13, 04:17)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="26580"></a>
        <div class="comment" id="comment-26580">
            <div id="post-26580-score" class="comment-score"></div>
            <div class="comment-text"><p>I'm not yet sure about that, but I would say it will unfortunately not be open source. It's something internal and I'm not sure there is an intention to publish it in the future.</p></div>
            <div class="comment-info" id="comment-26580-info">
                
                
                
                

                

                <span class="comment-age">(31 Oct '13, 04:26)</span>
                <a class="comment-user userinfo" href="/users/4008/matheus-priebe-bertram">Matheus Prie...</a>
                
            </div>
        </div>
    
        <a name="26581"></a>
        <div class="comment not_top_scorer" id="comment-26581">
            <div id="post-26581-score" class="comment-score"></div>
            <div class="comment-text"><p>O.K. I guess then there is not much we can do for you ;-)</p>

<p>BTW: What happens if you run dumpcap manually (-i rpcap:// ...)? Does it crash as well?</p></div>
            <div class="comment-info" id="comment-26581-info">
                
                
                
                

                

                <span class="comment-age">(31 Oct '13, 04:46)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="26584"></a>
        <div class="comment not_top_scorer" id="comment-26584">
            <div id="post-26584-score" class="comment-score"></div>
            <div class="comment-text"><p>Running dumpcap manually causes the same crash, yes.</p>

<p>I've run it both with "-i rpcap://..." and "-r -i rpcap://...". The first option works always for exactly one interface and sometimes when there is more than one interface. The second option runs always, for any number of interfaces. The same behavior is observed when running Wireshark normally.</p>

<p>Thanks again for the reply.</p></div>
            <div class="comment-info" id="comment-26584-info">
                
                
                
                

                

                <span class="comment-age">(31 Oct '13, 05:05)</span>
                <a class="comment-user userinfo" href="/users/4008/matheus-priebe-bertram">Matheus Prie...</a>
                
            </div>
        </div>
    
        <a name="26585"></a>
        <div class="comment not_top_scorer" id="comment-26585">
            <div id="post-26585-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>I'm currently using Wireshark 1.8.3</p>
</blockquote>

<p>can you please try a later release (1.10.x or 1.11.x)?</p></div>
            <div class="comment-info" id="comment-26585-info">
                
                
                
                

                

                <span class="comment-age">(31 Oct '13, 05:15)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="26586"></a>
        <div class="comment not_top_scorer" id="comment-26586">
            <div id="post-26586-score" class="comment-score"></div>
            <div class="comment-text"><p>I've already tried with the latest release as well and get the same error...</p></div>
            <div class="comment-info" id="comment-26586-info">
                
                
                
                

                

                <span class="comment-age">(31 Oct '13, 05:56)</span>
                <a class="comment-user userinfo" href="/users/4008/matheus-priebe-bertram">Matheus Prie...</a>
                
            </div>
        </div>
    
        <a name="26588"></a>
        <div class="comment not_top_scorer" id="comment-26588">
            <div id="post-26588-score" class="comment-score"></div>
            <div class="comment-text"><p>well, then have fun debugging your RPCAP code (or the code of dumpcap) ;-)</p></div>
            <div class="comment-info" id="comment-26588-info">
                
                
                
                

                

                <span class="comment-age">(31 Oct '13, 06:17)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="26590"></a>
        <div class="comment not_top_scorer" id="comment-26590">
            <div id="post-26590-score" class="comment-score"></div>
            <div class="comment-text"><p>I've got some news: I was running Wireshark with WinPcap 4.0.2 the whole time. Now, I've installed WinPcap 4.1.2 (the Wireshark version still being 1.8.3) and the problem seems to be solved! :-) I'm going to check which are the differences between both releases to see if I can find where the problem could be. Thanks!</p></div>
            <div class="comment-info" id="comment-26590-info">
                
                
                
                

                

                <span class="comment-age">(31 Oct '13, 06:41)</span>
                <a class="comment-user userinfo" href="/users/4008/matheus-priebe-bertram">Matheus Prie...</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-26537" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 11
        </span>
        <a href="#" class="show-all-comments-link">show 6 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-26537-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/26318/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='NTRwUqqw8xuMIDOjotFWIuMTgMvLGPc1' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/26318/dumpcap-access-violation-with-remote-capture?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/26318/dumpcap-access-violation-with-remote-capture?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/dumpcap/"
            class="tag-link-dumpcap"
            title="see questions tagged'dumpcap'using tags"
            rel="tag">dumpcap</a> <span class="tag-number">&#215;89</span><br/>
        
        <a href="/tags/remote/"
            class="tag-link-remote"
            title="see questions tagged'remote'using tags"
            rel="tag">remote</a> <span class="tag-number">&#215;59</span><br/>
        
        <a href="/tags/rpcap/"
            class="tag-link-rpcap"
            title="see questions tagged'rpcap'using tags"
            rel="tag">rpcap</a> <span class="tag-number">&#215;17</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Oct. 23, 2013, 4:19 a.m.">23 Oct '13, 04:19</strong>
    </p>
    <p> 
     	question was seen: <strong>3,231 times</strong>
    </p>
    <p> 
        last updated: <strong title="Nov. 4, 2013, 2:15 a.m.">04 Nov '13, 02:15</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/51978/how-do-you-disable-wireshark-relative-sequence-numbers-with-rpcap-and-udp-encapsulation">How do you disable wireshark relative sequence numbers with RPCAP and UDP encapsulation?</a>
        </p>
        
        <p>
            <a href="/questions/14636/remote-capturing">Remote capturing</a>
        </p>
        
        <p>
            <a href="/questions/13113/gui-of-dumpcap">GUI of dumpcap</a>
        </p>
        
        <p>
            <a href="/questions/12835/how-to-use-dumpcap-to-monitor-winpcap-on-a-remote-machine">how to use dumpcap to monitor winpcap on a remote machine</a>
        </p>
        
        <p>
            <a href="/questions/46/cannot-capture-packets-from-remote-system">Cannot capture packets from remote system.</a>
        </p>
        
        <p>
            <a href="/questions/13352/remote-packet-capture-linux-to-linux">[closed] Remote Packet Capture : Linux to Linux</a>
        </p>
        
        <p>
            <a href="/questions/25088/using-wireshark-over-vpn">Using WireShark over VPN</a>
        </p>
        
        <p>
            <a href="/questions/50804/is-wire-shark-capable-of-seeing-others-peoples-traffic">is wire shark capable of seeing others peoples traffic</a>
        </p>
        
        <p>
            <a href="/questions/2516/tmpdir-ignored-when-setuid-for-dumpcap">TMPDIR ignored when setuid for dumpcap</a>
        </p>
        
        <p>
            <a href="/questions/16849/dumpcap-timestamp-discrepancy">Dumpcap timestamp	discrepancy</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
