<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>[closed] RDP sessions getting intermittent TCP RST+ACK&#39;s - Wireshark Q&amp;A</title>
        <meta name="description" content="Hey guys I&#39;ve got a question. I&#39;ve installed a server 2012 R2 hyper-v with a few VM&#39;s in them. One of them is a TS. My client is having issues with the TS because every now and then they get a popup from RDP that the connection is interrupted and that it will retry to setup the connection. This is v..." />
        <meta name="keywords" content="rdp,rst+ack,packetloss" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/40426/rdp-sessions-getting-intermittent-tcp-rstacks" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/40426/rdp-sessions-getting-intermittent-tcp-rstacks?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='LUVZr8Pmpkjx7KfSr2DME0hEfKau4fqD' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/40426/rdp-sessions-getting-intermittent-tcp-rstacks">[closed] RDP sessions getting intermittent TCP RST+ACK&#39;s</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-40426-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/40426/up/" rel="nofollow"> </a>
<div id="post-40426-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-40426-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/40426/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/40426/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hey guys I've got a question.</p>
<p>I've installed a server 2012 R2  hyper-v with a few VM's in them. One of them is a TS. My client is having issues with the TS because every now and then they get a popup from RDP that the connection is interrupted and that it will retry to setup the connection. This is visible for less then a second, but is very disruptive when working.</p>
<p>I've been doing some captures on the Hypervisor itself and am seeing a lot of RST, ACKs when the interruptions appear. The stream can be going for some time but they all end the same.</p>
<pre><code>212651  2287.339664000  10.0.0.25   10.0.0.110  TPKT    155 Continuation
212693  2287.540852000  10.0.0.110  10.0.0.25   TCP 60  61059â†’3389 [ACK] Seq=76446 Ack=237599 Win=64768 Len=0
213075  2288.339741000  10.0.0.25   10.0.0.110  TPKT    155 Continuation
213292  2288.652196000  10.0.0.25   10.0.0.110  TPKT    155 [TCP Retransmission] Continuation
213319  2289.261509000  10.0.0.25   10.0.0.110  TPKT    155 [TCP Retransmission] Continuation
213334  2289.339681000  10.0.0.25   10.0.0.110  TPKT    155 Continuation
213437  2290.339736000  10.0.0.25   10.0.0.110  TPKT    155 Continuation
213444  2290.464660000  10.0.0.25   10.0.0.110  TPKT    357 [TCP Retransmission] Continuation
213631  2291.339771000  10.0.0.25   10.0.0.110  TPKT    155 Continuation
213709  2292.355402000  10.0.0.25   10.0.0.110  TPKT    155 Continuation
213735  2292.870883000  10.0.0.25   10.0.0.110  TPKT    559 [TCP Retransmission] Continuation
213828  2293.355672000  10.0.0.25   10.0.0.110  TPKT    155 Continuation
214009  2294.355357000  10.0.0.25   10.0.0.110  TPKT    155 Continuation
214204  2295.370990000  10.0.0.25   10.0.0.110  TPKT    155 Continuation
214206  2295.371172000  10.0.0.110  10.0.0.25   TCP 66  [TCP Dup ACK 212693#1] 61059â†’3389 [ACK] Seq=76446 Ack=237599 Win=64768 Len=0 SLE=238306 SRE=238407
214230  2295.465630000  10.0.0.110  10.0.0.25   TCP 60  61059â†’3389 [RST, ACK] Seq=76446 Ack=237599 Win=0 Len=0
214265  2295.538954000  10.0.0.110  10.0.0.25   TCP 66  61214â†’3389 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=256 SACK_PERM=1
214268  2295.539242000  10.0.0.25   10.0.0.110  TCP 66  3389â†’61214 [SYN, ACK] Seq=0 Ack=1 Win=64000 Len=0 MSS=1460 WS=1 SACK_PERM=1
214270  2295.539754000  10.0.0.110  10.0.0.25   TCP 60  61214â†’3389 [ACK] Seq=1 Ack=1 Win=65536 Len=0
</code></pre>
<p>As you can see the connection is happily resumed after the reset.</p>
<p>Any idea what could be causing these resets? The capture is performed on the NIC that handles all VM traffic. The client I've been using to test is connected to the same switch as the Hyper-V server. The Hyper-V isn't using any teaming on the virtual nic.</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/rdp/" class="post-tag tag-link-rdp"
                                        title="see questions tagged 'rdp'" rel="tag">rdp</a>
                                
                                    <a href="/tags/rst%252Back/" class="post-tag tag-link-rst+ack"
                                        title="see questions tagged 'rst+ack'" rel="tag">rst+ack</a>
                                
                                    <a href="/tags/packetloss/" class="post-tag tag-link-packetloss"
                                        title="see questions tagged 'packetloss'" rel="tag">packetloss</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>10 Mar '15, 08:22</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f4ea5ee54323f153bdb5e0378e37f0c6?s=32&amp;d=identicon&amp;r=g" alt="Fraeco's gravatar image" />
    <p><a href="/users/15056/fraeco">Fraeco</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">&#9679;</span><span class="badgecount">2</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Fraeco has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/40426/">
                closed
                <strong>26 Mar '15, 02:46</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/2337f0406681e5c72ea0e6f1f0d6c0b0?s=32&amp;d=identicon&amp;r=g" alt="Jaap's gravatar image" />
            <p><a href="/users/4/jaap">Jaap â™¦</a><br/>
            <span class="score" title="11680 reputation points"><span class="">11.7k</span></span><span title="16 badges"><span class="silver">&#9679;</span><span class="badgecount">16</span></span><span title="101 badges"><span class="bronze">&#9679;</span><span class="badgecount">101</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-40426">
    
        <a name="40860"></a>
        <div class="comment" id="comment-40860">
            <div id="post-40860-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi,</p>

<p>I have same problem but with physical machines (no hyperv). The problem appear when the connection pass by a NetASQ Firewall.
Have you any solution ?</p></div>
            <div class="comment-info" id="comment-40860-info">
                
                
                
                

                

                <span class="comment-age">(25 Mar '15, 15:01)</span>
                <a class="comment-user userinfo" href="/users/15611/jboitel">jboitel</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-40426" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-40426-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            <div class="question-status" style="margin-bottom:15px">
            <h3>
                The question has been closed for the following reason "Question is off-topic or not relevant" by
                <a href="/users/4/jaap">Jaap</a>
                 26 Mar '15, 02:46
            </h3>
            </div>
            
            
        <form id="fmanswer" action="/questions/40426/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='LUVZr8Pmpkjx7KfSr2DME0hEfKau4fqD' />
            <div style="clear:both">
            </div>

            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/40426/rdp-sessions-getting-intermittent-tcp-rstacks?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/40426/rdp-sessions-getting-intermittent-tcp-rstacks?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/packetloss/"
            class="tag-link-packetloss"
            title="see questions tagged'packetloss'using tags"
            rel="tag">packetloss</a> <span class="tag-number">&#215;45</span><br/>
        
        <a href="/tags/rdp/"
            class="tag-link-rdp"
            title="see questions tagged'rdp'using tags"
            rel="tag">rdp</a> <span class="tag-number">&#215;22</span><br/>
        
        <a href="/tags/rst%252Back/"
            class="tag-link-rst+ack"
            title="see questions tagged'rst+ack'using tags"
            rel="tag">rst+ack</a> <span class="tag-number">&#215;17</span><br/>
        
    </p>
    <p>
        question asked: <strong title="March 10, 2015, 8:22 a.m.">10 Mar '15, 08:22</strong>
    </p>
    <p> 
     	question was seen: <strong>3,862 times</strong>
    </p>
    <p> 
        last updated: <strong title="March 26, 2015, 3:33 a.m.">26 Mar '15, 03:33</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/31787/winxp-users-get-disconnections-when-using-remote-desktop-to-win2012-server">Winxp Users get disconnections when using remote desktop to win2012 server</a>
        </p>
        
        <p>
            <a href="/questions/2144/publishing-and-deploying-wireshark-to-users-within-a-rdp-citrix-environment">Publishing and Deploying Wireshark to users Within a RDP / Citrix Environment</a>
        </p>
        
        <p>
            <a href="/questions/55362/remote-desktop-not-connecting">Remote Desktop not connecting</a>
        </p>
        
        <p>
            <a href="/questions/33605/monitor-packet-losses-using-wireshark">Monitor packet losses using Wireshark</a>
        </p>
        
        <p>
            <a href="/questions/45152/no-packets-being-displayed-on-wireshark-however-packets-are-being-transmitted">No packets being displayed on Wireshark however packets are being transmitted.</a>
        </p>
        
        <p>
            <a href="/questions/24870/syn-then-retransmission-then-rstack">SYN, then Retransmission, then RSTACK</a>
        </p>
        
        <p>
            <a href="/questions/3293/rdp-client-sends-2-packet-with-identical-sq-number">RDP client sends 2 packet with identical sq number</a>
        </p>
        
        <p>
            <a href="/questions/55766/troubleshooting-intermittent-rdp-reconnects">Troubleshooting intermittent RDP reconnects</a>
        </p>
        
        <p>
            <a href="/questions/37154/tcp-loss-display-in-column-field">TCP loss display in column field</a>
        </p>
        
        <p>
            <a href="/questions/46783/mysterious-packet-loss">Mysterious Packet Loss</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
