<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Mavericks - can not capture from iPhone using RVI - Wireshark Q&amp;A</title>
        <meta name="description" content="After updating my macbook to Mavericks, Wireshark can still capture data from my iPhone using RVI(remote virtual interface). But it cannot analyze and show packets right. it only tells about packets that they are &quot;User encapsulation not handled: DLT=149, check your Preferences-&amp;gt;Protocols-&amp;gt;DLT_..." />
        <meta name="keywords" content="rvi,iphone,rvictl,mavericks" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/26524/mavericks-can-not-capture-from-iphone-using-rvi" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/26524/mavericks-can-not-capture-from-iphone-using-rvi?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='JEVsTAfX3tTjlxpv9OXIDiypTyXWu5Li' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/26524/mavericks-can-not-capture-from-iphone-using-rvi">Mavericks - can not capture from iPhone using RVI</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-26524-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/26524/up/" rel="nofollow"> </a>
<div id="post-26524-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-26524-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/26524/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/26524/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   1
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>After updating my macbook to Mavericks, Wireshark can still capture data from my iPhone using RVI(remote virtual interface). But it cannot analyze and show packets right. it only tells about packets that they are "User encapsulation not handled: DLT=149, check your Preferences-&gt;Protocols-&gt;DLT_USER".</p>
<p>This problem only occurs when capturing lively.
If I capture and save using tcpdump, Wireshark analyzes them right.
I tried to test using stable version and night builds. but the results were same.</p>
<p>Can anyone tell me how to solve this?
Thanks in advance.</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/rvi/" class="post-tag tag-link-rvi"
                                        title="see questions tagged 'rvi'" rel="tag">rvi</a>
                                
                                    <a href="/tags/iphone/" class="post-tag tag-link-iphone"
                                        title="see questions tagged 'iphone'" rel="tag">iphone</a>
                                
                                    <a href="/tags/rvictl/" class="post-tag tag-link-rvictl"
                                        title="see questions tagged 'rvictl'" rel="tag">rvictl</a>
                                
                                    <a href="/tags/mavericks/" class="post-tag tag-link-mavericks"
                                        title="see questions tagged 'mavericks'" rel="tag">mavericks</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>29 Oct '13, 11:13</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/a57f39c60bd2b8e9474cafc9890d5b88?s=32&amp;d=identicon&amp;r=g" alt="gish's gravatar image" />
    <p><a href="/users/5976/gish">gish</a><br/>
    <span class="score" title="41 reputation points">41</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="5 badges"><span class="bronze">&#9679;</span><span class="badgecount">5</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="gish has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/26524/">
                edited
                <strong>12 Nov '13, 23:56</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" alt="Guy%20Harris's gravatar image" />
            <p><a href="/users/79/guy-harris">Guy Harris ♦♦</a><br/>
            <span class="score" title="17443 reputation points"><span class="">17.4k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">&#9679;</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">&#9679;</span><span class="badgecount">196</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-26524">
    
        <a name="29449"></a>
        <div class="comment" id="comment-29449">
            <div id="post-29449-score" class="comment-score"></div>
            <div class="comment-text"><p>Has anybody had any success on this yet. I am still not able to capture and analyse packets directly in Wireshark.</p></div>
            <div class="comment-info" id="comment-29449-info">
                
                
                
                

                

                <span class="comment-age">(05 Feb '14, 02:49)</span>
                <a class="comment-user userinfo" href="/users/5981/anil-giri">Anil Giri</a>
                
            </div>
        </div>
    
        <a name="29450"></a>
        <div class="comment" id="comment-29450">
            <div id="post-29450-score" class="comment-score"></div>
            <div class="comment-text"><p>I've filed a bug on this with Apple, but they haven't responded.</p>

<p>I haven't had time to dive into the Mavericks source and determine what the header looks like.</p></div>
            <div class="comment-info" id="comment-29450-info">
                
                
                
                

                

                <span class="comment-age">(05 Feb '14, 02:53)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-26524" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-26524-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    4 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/26524/mavericks-can-not-capture-from-iphone-using-rvi?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/26524/mavericks-can-not-capture-from-iphone-using-rvi?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/26524/mavericks-can-not-capture-from-iphone-using-rvi?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/26524/mavericks-can-not-capture-from-iphone-using-rvi?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="26525"></a>
                    <div id="answer-container-26525" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-26525-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/26525/up/" rel="nofollow"> </a>
<div id="post-26525-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-26525-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/26525/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <blockquote>
<p>Can anyone tell me how to solve this?</p>
</blockquote>
<p>Solve this by complaining to Apple, ideally by filing a bug at <a href="http://bugreport.apple.com/">http://bugreport.apple.com/</a>, asking them not to use DLT_USER2 for their own purposes, and asking them instead to request an official DLT_ value from <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="750116051100180558021a071e10070635191c0601065b011605110018055b1a0712">[email&#160;protected]</a>, citing the page at <a href="http://www.tcpdump.org/linktypes.html">http://www.tcpdump.org/linktypes.html</a>.  The more dups, the better.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/26525/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>29 Oct '13, 11:51</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" alt="Guy%20Harris's gravatar image" />
    <p><a href="/users/79/guy-harris">Guy Harris ♦♦</a><br/>
    <span class="score" title="17443 reputation points"><span class="">17.4k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">&#9679;</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">&#9679;</span><span class="badgecount">196</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Guy Harris has 216 accepted answers">19&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-26525">
    
        <a name="29469"></a>
        <div class="comment" id="comment-29469">
            <div id="post-29469-score" class="comment-score"></div>
            <div class="comment-text"><p>Oh, and please attach Mavericks remote virtual interface captures to <a href="https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=9358">bug 9358</a>; that will make it possible to test changes to Wireshark to dissect those packets natively (and develop changes to libpcap and tcpdump to fix this, so that I can yell at Apple to update their libpcap and tcpdump).</p></div>
            <div class="comment-info" id="comment-29469-info">
                
                
                
                

                

                <span class="comment-age">(05 Feb '14, 12:12)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-26525" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-26525-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="27065"></a>
                    <div id="answer-container-27065" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-27065-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/27065/up/" rel="nofollow"> </a>
<div id="post-27065-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-27065-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/27065/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>A better method is to use header size = 108 and payload protocol = eth.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/27065/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>17 Nov '13, 23:14</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/768701f7fe3d49349c810cdf8bda3ab4?s=32&amp;d=identicon&amp;r=g" alt="bennettp123's gravatar image" />
    <p><a href="/users/6091/bennettp123">bennettp123</a><br/>
    <span class="score" title="41 reputation points">41</span><span title="5 badges"><span class="bronze">&#9679;</span><span class="badgecount">5</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="bennettp123 has no accepted answers">0&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-27065">
    
        <a name="27073"></a>
        <div class="comment" id="comment-27073">
            <div id="post-27073-score" class="comment-score"></div>
            <div class="comment-text"><p>This solution works much better for me</p></div>
            <div class="comment-info" id="comment-27073-info">
                
                
                
                

                

                <span class="comment-age">(18 Nov '13, 10:35)</span>
                <a class="comment-user userinfo" href="/users/6094/sboisson">sboisson</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-27065" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-27065-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="29452"></a>
                    <div id="answer-container-29452" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-29452-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/29452/up/" rel="nofollow"> </a>
<div id="post-29452-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-29452-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/29452/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>As others mentioned, the workaround is to enable the DLT_USER protocol #149 in Wireshark.</p>
<p>From my experience the actual header and protocol is different depending wether your device is connected using wifi or radio:</p>
<ul>
<li>when connected with radio (3G): set header length to 112, and protocol to <code>ip</code></li>
<li>when connected with wifi: set header length to 108, and protocol to <code>eth</code></li>
</ul>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/29452/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>05 Feb '14, 03:06</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d3eee7ba9de5d866516e8e0d97d12e5d?s=32&amp;d=identicon&amp;r=g" alt="sboisson's gravatar image" />
    <p><a href="/users/6094/sboisson">sboisson</a><br/>
    <span class="score" title="41 reputation points">41</span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">&#9679;</span><span class="badgecount">4</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="sboisson has no accepted answers">0&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-29452">
    
        <a name="29997"></a>
        <div class="comment" id="comment-29997">
            <div id="post-29997-score" class="comment-score"></div>
            <div class="comment-text"><p>This is just to confirm that the above approach (set header length to 108, and protocol to eth) works for me. I can capture live and see all the info about my SIP packets during capture.</p></div>
            <div class="comment-info" id="comment-29997-info">
                
                
                
                

                

                <span class="comment-age">(19 Feb '14, 01:46)</span>
                <a class="comment-user userinfo" href="/users/5981/anil-giri">Anil Giri</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-29452" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-29452-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="26559"></a>
                    <div id="answer-container-26559" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-26559-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/26559/up/" rel="nofollow"> </a>
<div id="post-26559-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-26559-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/26559/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>A way to get data directly:</p>
<p>Go into Preferences/Protocols/DLT_USER and add an entry for user2, which is DLT=149.  Set the header length to 112, and the protocol value to IP.  This is less robust than #1, because there's plenty of info in that 112 byte header that's being ignored, but it should work for IP traffic.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/26559/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>30 Oct '13, 22:06</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/acc9b06519286e0a5a9b5d6f7d3183a2?s=32&amp;d=identicon&amp;r=g" alt="kjbrock's gravatar image" />
    <p><a href="/users/5980/kjbrock">kjbrock</a><br/>
    <span class="score" title="26 reputation points">26</span><span title="3 badges"><span class="bronze">&#9679;</span><span class="badgecount">3</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="kjbrock has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/26559/">
                edited
                <strong>30 Oct '13, 22:10</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-26559">
    
        <a name="26560"></a>
        <div class="comment" id="comment-26560">
            <div id="post-26560-score" class="comment-score"></div>
            <div class="comment-text"><p>Thank you, kjbrock.
Now I can enjoy live capture :)</p></div>
            <div class="comment-info" id="comment-26560-info">
                
                
                
                

                

                <span class="comment-age">(30 Oct '13, 23:20)</span>
                <a class="comment-user userinfo" href="/users/5976/gish">gish</a>
                
            </div>
        </div>
    
        <a name="26561"></a>
        <div class="comment" id="comment-26561">
            <div id="post-26561-score" class="comment-score"></div>
            <div class="comment-text"><p>This does not help me capture and analyse my SIP message.  Is there a better way to get it working as it was prior to mavericks?</p></div>
            <div class="comment-info" id="comment-26561-info">
                
                
                
                

                

                <span class="comment-age">(31 Oct '13, 00:15)</span>
                <a class="comment-user userinfo" href="/users/5981/anil-giri">Anil Giri</a>
                
            </div>
        </div>
    
        <a name="26593"></a>
        <div class="comment" id="comment-26593">
            <div id="post-26593-score" class="comment-score">1</div>
            <div class="comment-text"><p>Have you tried the "capture with tcpdump and open in WS" solution?  That seems to show me all the packets, not just the IP packets.<br>
</p>

<p>To get general capture working in WS you'd probably need to write something that parses the header and determines the protocol type from that.  So for the truly masochistic, get Apple's tcpdump sources, look at how they're parsing it and integrate that into WS. </p>

<p>I think that Guy Harris is absolutely correct that Apple shouldn't be doing this with User2, so longer term we've got to hope that they'll fix this on their end.</p></div>
            <div class="comment-info" id="comment-26593-info">
                
                
                
                

                

                <span class="comment-age">(31 Oct '13, 08:12)</span>
                <a class="comment-user userinfo" href="/users/5980/kjbrock">kjbrock</a>
                
            </div>
        </div>
    
        <a name="26926"></a>
        <div class="comment" id="comment-26926">
            <div id="post-26926-score" class="comment-score"></div>
            <div class="comment-text"><p>Sorry for replying late. </p>

<p>The capture with tcpdump approach works fine. I can capture and write to a file. Then I am able to analyse the packets in Wireshark.</p>

<p>But this adds an additional step to my workflow. I would definitely want to file a bug with Apple if it is so. Can you please explain to me what exactly it is that appears to be broken on their part. I am not entirely familiar with the whole User2 thing.</p></div>
            <div class="comment-info" id="comment-26926-info">
                
                
                
                

                

                <span class="comment-age">(12 Nov '13, 23:11)</span>
                <a class="comment-user userinfo" href="/users/5981/anil-giri">Anil Giri</a>
                
            </div>
        </div>
    
        <a name="27054"></a>
        <div class="comment" id="comment-27054">
            <div id="post-27054-score" class="comment-score">1</div>
            <div class="comment-text"><p>I had to use header length 122 to get this to work for me.  And for clarification, you need to have payload protocol set to "ip" (as opposed to header protocol or other).</p></div>
            <div class="comment-info" id="comment-27054-info">
                
                
                
                

                

                <span class="comment-age">(16 Nov '13, 13:07)</span>
                <a class="comment-user userinfo" href="/users/6089/sadkinson">sadkinson</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-26559" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-26559-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/26524/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='JEVsTAfX3tTjlxpv9OXIDiypTyXWu5Li' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/26524/mavericks-can-not-capture-from-iphone-using-rvi?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/26524/mavericks-can-not-capture-from-iphone-using-rvi?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/iphone/"
            class="tag-link-iphone"
            title="see questions tagged'iphone'using tags"
            rel="tag">iphone</a> <span class="tag-number">&#215;26</span><br/>
        
        <a href="/tags/mavericks/"
            class="tag-link-mavericks"
            title="see questions tagged'mavericks'using tags"
            rel="tag">mavericks</a> <span class="tag-number">&#215;18</span><br/>
        
        <a href="/tags/rvictl/"
            class="tag-link-rvictl"
            title="see questions tagged'rvictl'using tags"
            rel="tag">rvictl</a> <span class="tag-number">&#215;2</span><br/>
        
        <a href="/tags/rvi/"
            class="tag-link-rvi"
            title="see questions tagged'rvi'using tags"
            rel="tag">rvi</a> <span class="tag-number">&#215;1</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Oct. 29, 2013, 11:13 a.m.">29 Oct '13, 11:13</strong>
    </p>
    <p> 
     	question was seen: <strong>13,472 times</strong>
    </p>
    <p> 
        last updated: <strong title="Feb. 19, 2014, 1:46 a.m.">19 Feb '14, 01:46</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/34521/packet-capturing-iphone-5-from-mac">Packet capturing iPhone 5 from Mac</a>
        </p>
        
        <p>
            <a href="/questions/622/capture-between-iphone-and-linksys-wireless-router">Capture between iPhone and Linksys wireless router??</a>
        </p>
        
        <p>
            <a href="/questions/36918/how-can-i-capture-the-traffic-of-my-iphone">how can i capture the traffic of my iphone</a>
        </p>
        
        <p>
            <a href="/questions/29345/wrong-start-file-chosen-for-x11-on-osx">Wrong start file chosen for X11 on OSX</a>
        </p>
        
        <p>
            <a href="/questions/2242/capture-my-wireless-iphone-ipad-traffic">Capture my wireless (iPhone &amp; iPad) traffic</a>
        </p>
        
        <p>
            <a href="/questions/38524/wireshark-does-not-show-wlan-traffic-of-iosandroid-devices-but-shows-traffic-of-my-others-devices">Wireshark does not show wlan traffic of iOs/Android devices (but shows traffic of my others devices)</a>
        </p>
        
        <p>
            <a href="/questions/30979/can-i-move-the-wireshark-window-in-os-x-mavericks">Can I move the Wireshark window in OS X Mavericks?</a>
        </p>
        
        <p>
            <a href="/questions/2904/wireless-phones-android-devices-iphones-can-wireshark-help">Wireless Phones? Android devices, iPhones can wireshark help?</a>
        </p>
        
        <p>
            <a href="/questions/43149/trying-to-monitor-iphone-traffic">trying to monitor iPhone traffic</a>
        </p>
        
        <p>
            <a href="/questions/31648/tshark-uses-all-memory-on-mavericks-triggering-out-of-application-memory-errors">Tshark Uses All Memory on Mavericks Triggering Out Of Application Memory Errors</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
