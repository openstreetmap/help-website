<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>unable to decode SSL - Wireshark Q&amp;A</title>
        <meta name="description" content="Hi, I have configured preference -&amp;gt;ssl with the private key.But still wireshark is unable to decode ssl.Below is the output from the log file. ssl_association_remove removing TCP 443 - http handle 0000000003D911A0 Private key imported: KeyID 52:53:3d:d3:ce:ce:cd:2e:29:ab:0b:c8:0b:ca:78:ba:... ssl..." />
        <meta name="keywords" content="ssl,decrypt" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/10286/unable-to-decode-ssl" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/10286/unable-to-decode-ssl?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='LJUJNAZKu2n3QJrdPtT3Z0iEpFEAPstm' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/10286/unable-to-decode-ssl">unable to decode SSL</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-10286-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/10286/up/" rel="nofollow"> </a>
<div id="post-10286-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-10286-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/10286/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/10286/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hi,
I have configured preference -&gt;ssl with the private key.But still wireshark is unable to decode ssl.Below is the output from the log file.</p>
<pre><code>ssl_association_remove removing TCP 443 - http handle 0000000003D911A0
Private key imported: KeyID 52:53:3d:d3:ce:ce:cd:2e:29:ab:0b:c8:0b:ca:78:ba:...
ssl_init IPv4 addr 'IPaddressofmyserver' (IPaddressofmyserver) port '443' filename 'c:\\BckUP\\server.pem' password(only for p12 file) ''
ssl_init private key file c:\\BckUP\\server.pem successfully loaded.
association_add TCP port 443 protocol http handle 0000000003D911A0

dissect_ssl enter frame #3 (first time)
ssl_session_init: initializing ptr 0000000005871BC0 size 680
  conversation = 0000000005871880, ssl_session = 0000000005871BC0
  record: offset = 0, reported_length_remaining = 141
packet_from_server: is from server - FALSE
ssl_find_private_key server IPaddressofmyserver:443
client random len: 16 padded to 32
dissect_ssl2_hnd_client_hello found CLIENT RANDOM -&gt; state 0x01

dissect_ssl enter frame #9 (first time)
  conversation = 0000000005871880, ssl_session = 0000000005871BC0
  record: offset = 0, reported_length_remaining = 267
dissect_ssl3_record found version 0x0301 -&gt; state 0x11
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 262, ssl state 0x11
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 16 offset 5 length 258 bytes, remaining 267 
ssl_decrypt_pre_master_secret key exchange 0 different from KEX_RSA (16)
dissect_ssl3_handshake can't decrypt pre master secret

dissect_ssl enter frame #10 (first time)
  conversation = 0000000005871880, ssl_session = 0000000005871BC0
  record: offset = 0, reported_length_remaining = 6
dissect_ssl3_record: content_type 20
dissect_ssl3_change_cipher_spec
packet_from_server: is from server - FALSE
ssl_change_cipher CLIENT

dissect_ssl enter frame #11 (first time)
  conversation = 0000000005871880, ssl_session = 0000000005871BC0
  record: offset = 0, reported_length_remaining = 37
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 32, ssl state 0x11
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 187 offset 5 length 4019139 bytes, remaining 37

dissect_ssl enter frame #13 (first time)
  conversation = 0000000005871880, ssl_session = 0000000005871BC0
  record: offset = 0, reported_length_remaining = 340
dissect_ssl3_record: content_type 23
decrypt_ssl3_record: app_data len 335, ssl state 0x11
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
association_find: TCP port 31891 found 0000000000000000
association_find: TCP port 443 found 00000000057ABA10

dissect_ssl enter frame #14 (first time)
  conversation = 0000000005871880, ssl_session = 0000000005871BC0
  record: offset = 0, reported_length_remaining = 1448
dissect_ssl3_record: content_type 23
decrypt_ssl3_record: app_data len 1565, ssl state 0x11
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder

dissect_ssl enter frame #15 (first time)
  conversation = 0000000005871880, ssl_session = 0000000005871BC0
  record: offset = 0, reported_length_remaining = 122

dissect_ssl enter frame #16 (first time)
  conversation = 0000000005871880, ssl_session = 0000000005871BC0
  record: offset = 0, reported_length_remaining = 29
dissect_ssl3_record: content_type 23
decrypt_ssl3_record: app_data len 24, ssl state 0x11
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
association_find: TCP port 31891 found 0000000000000000
association_find: TCP port 443 found 00000000057ABA10

dissect_ssl enter frame #19 (first time)
  conversation = 0000000005871880, ssl_session = 0000000005871BC0
  record: offset = 0, reported_length_remaining = 23
dissect_ssl3_record: content_type 21
decrypt_ssl3_record: app_data len 18, ssl state 0x11
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available

dissect_ssl enter frame #11 (already visited)
  conversation = 0000000005871880, ssl_session = 0000000000000000
  record: offset = 0, reported_length_remaining = 37
dissect_ssl3_record: content_type 22
dissect_ssl3_handshake iteration 1 type 187 offset 5 length 4019139 bytes, remaining 37

dissect_ssl enter frame #13 (already visited)
  conversation = 0000000005871880, ssl_session = 0000000000000000
  record: offset = 0, reported_length_remaining = 340
dissect_ssl3_record: content_type 23
association_find: TCP port 31891 found 0000000000000000
association_find: TCP port 443 found 00000000057ABA10

dissect_ssl enter frame #14 (already visited)
  conversation = 0000000005871880, ssl_session = 0000000000000000
  record: offset = 0, reported_length_remaining = 1448

dissect_ssl enter frame #15 (already visited)
  conversation = 0000000005871880, ssl_session = 0000000000000000
  record: offset = 0, reported_length_remaining = 122

dissect_ssl enter frame #16 (already visited)
  conversation = 0000000005871880, ssl_session = 0000000000000000
  record: offset = 0, reported_length_remaining = 29
dissect_ssl3_record: content_type 23
association_find: TCP port 31891 found 0000000000000000
association_find: TCP port 443 found 00000000057ABA10

dissect_ssl enter frame #19 (already visited)
  conversation = 0000000005871880, ssl_session = 0000000000000000
  record: offset = 0, reported_length_remaining = 23
dissect_ssl3_record: content_type 21

dissect_ssl enter frame #10 (already visited)
  conversation = 0000000005871880, ssl_session = 0000000000000000
  record: offset = 0, reported_length_remaining = 6
dissect_ssl3_record: content_type 20
dissect_ssl3_change_cipher_spec

dissect_ssl enter frame #9 (already visited)
  conversation = 0000000005871880, ssl_session = 0000000000000000
  record: offset = 0, reported_length_remaining = 267
dissect_ssl3_record: content_type 22
dissect_ssl3_handshake iteration 1 type 16 offset 5 length 258 bytes, remaining 267

dissect_ssl enter frame #3 (already visited)
  conversation = 0000000005871880, ssl_session = 0000000000000000
  record: offset = 0, reported_length_remaining = 141

dissect_ssl enter frame #11 (already visited)
  conversation = 0000000005871880, ssl_session = 0000000000000000
  record: offset = 0, reported_length_remaining = 37
dissect_ssl3_record: content_type 22
dissect_ssl3_handshake iteration 1 type 187 offset 5 length 4019139 bytes, remaining 37

dissect_ssl enter frame #11 (already visited)
  conversation = 0000000005871880, ssl_session = 0000000000000000
  record: offset = 0, reported_length_remaining = 37
dissect_ssl3_record: content_type 22
dissect_ssl3_handshake iteration 1 type 187 offset 5 length 4019139 bytes, remaining 37

dissect_ssl enter frame #11 (already visited)
  conversation = 0000000005871880, ssl_session = 0000000000000000
  record: offset = 0, reported_length_remaining = 37
dissect_ssl3_record: content_type 22
dissect_ssl3_handshake iteration 1 type 187 offset 5 length 4019139 bytes, remaining 37

dissect_ssl enter frame #9 (already visited)
  conversation = 0000000005871880, ssl_session = 0000000000000000
  record: offset = 0, reported_length_remaining = 267
dissect_ssl3_record: content_type 22
dissect_ssl3_handshake iteration 1 type 16 offset 5 length 258 bytes, remaining 267

dissect_ssl enter frame #11 (already visited)
  conversation = 0000000005871880, ssl_session = 0000000000000000
  record: offset = 0, reported_length_remaining = 37
dissect_ssl3_record: content_type 22
dissect_ssl3_handshake iteration 1 type 187 offset 5 length 4019139 bytes, remaining 37
</code></pre>
<p>please help me ,how can i decode the ssl.</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/ssl/" class="post-tag tag-link-ssl"
                                        title="see questions tagged 'ssl'" rel="tag">ssl</a>
                                
                                    <a href="/tags/decrypt/" class="post-tag tag-link-decrypt"
                                        title="see questions tagged 'decrypt'" rel="tag">decrypt</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>19 Apr '12, 08:48</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/54dfb1796a8beedf9843a326d673eaae?s=32&amp;d=identicon&amp;r=g" alt="vikram's gravatar image" />
    <p><a href="/users/2496/vikram">vikram</a><br/>
    <span class="score" title="41 reputation points">41</span><span title="7 badges"><span class="badge1">&#9679;</span><span class="badgecount">7</span></span><span title="8 badges"><span class="silver">&#9679;</span><span class="badgecount">8</span></span><span title="13 badges"><span class="bronze">&#9679;</span><span class="badgecount">13</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="vikram has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/10286/">
                edited
                <strong>19 Apr '12, 08:54</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" alt="grahamb's gravatar image" />
            <p><a href="/users/1225/grahamb">grahamb ♦</a><br/>
            <span class="score" title="19834 reputation points"><span class="">19.8k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">&#9679;</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">&#9679;</span><span class="badgecount">206</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-10286">
    
</div>
<div id="comment-tools-10286" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-10286-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/10286/unable-to-decode-ssl?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/10286/unable-to-decode-ssl?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/10286/unable-to-decode-ssl?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/10286/unable-to-decode-ssl?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="10287"></a>
                    <div id="answer-container-10287" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-10287-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/10287/up/" rel="nofollow"> </a>
<div id="post-10287-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-10287-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/10287/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>There doesn't appear to be any frames that come from the server, at least I can't see any with <code>packet_from_server: is from server - TRUE</code>.  Did you capture both sides of the conversation?</p>
<p>I'm also assuming that the entries such as <code>'IPaddressofmyserver'</code> are a result of you doing a search and replace on the log file for obfuscation purposes.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/10287/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>19 Apr '12, 09:03</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" alt="grahamb's gravatar image" />
    <p><a href="/users/1225/grahamb">grahamb ♦</a><br/>
    <span class="score" title="19834 reputation points"><span class="">19.8k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">&#9679;</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">&#9679;</span><span class="badgecount">206</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="grahamb has 274 accepted answers">22&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-10287">
    
        <a name="10319"></a>
        <div class="comment" id="comment-10319">
            <div id="post-10319-score" class="comment-score"></div>
            <div class="comment-text"><p>No ,as you said i didn't captured both sides <a href="http://conversation.So">conversation.So</a> do i need to capture conversation from both sides,if i do that ,how can we merge the two log files?Can you kindly let me?</p>

<p>'IPaddressofmyserver' is modifed by me..</p></div>
            <div class="comment-info" id="comment-10319-info">
                
                
                
                

                

                <span class="comment-age">(19 Apr '12, 20:00)</span>
                <a class="comment-user userinfo" href="/users/2496/vikram">vikram</a>
                
            </div>
        </div>
    
        <a name="10335"></a>
        <div class="comment not_top_scorer" id="comment-10335">
            <div id="post-10335-score" class="comment-score"></div>
            <div class="comment-text"><p>To decrypt SSL, Wireshark needs to see both sides of the conversation, that is packets from both the client and the server <strong>from the start</strong> of the conversation.</p>

<p>You can try using mergecap to merge the two captures.  See the manual page <a href="http://www.wireshark.org/docs/man-pages/mergecap.html">here</a> and info from the documentation <a href="http://www.wireshark.org/docs/wsug_html_chunked/AppToolsmergecap.html">here</a></p></div>
            <div class="comment-info" id="comment-10335-info">
                
                
                
                

                

                <span class="comment-age">(20 Apr '12, 02:01)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="10348"></a>
        <div class="comment not_top_scorer" id="comment-10348">
            <div id="post-10348-score" class="comment-score"></div>
            <div class="comment-text"><p>Maybe "sides" is a bit misleading. You need both flows (client-&gt;server and server-&gt;cient) of the TCP session in the trace.</p>

<p>It is OK to capture only on one location (at the client, at the server or somewhere in between).</p></div>
            <div class="comment-info" id="comment-10348-info">
                
                
                
                

                

                <span class="comment-age">(20 Apr '12, 05:35)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="10371"></a>
        <div class="comment not_top_scorer" id="comment-10371">
            <div id="post-10371-score" class="comment-score"></div>
            <div class="comment-text"><p>currently i am capturing at one location atclient..i used a command called tcpflow and captured the conversation in a .log <a href="http://file.Is">file.Is</a> there any command line option to do the same in wireshark ?Also after decode of the SSL, will i be albe to see/capture the  atual payload(soap xml in my case) that is getting exchanged between the client and server ?</p></div>
            <div class="comment-info" id="comment-10371-info">
                
                
                
                

                

                <span class="comment-age">(21 Apr '12, 01:45)</span>
                <a class="comment-user userinfo" href="/users/2496/vikram">vikram</a>
                
            </div>
        </div>
    
        <a name="10373"></a>
        <div class="comment not_top_scorer" id="comment-10373">
            <div id="post-10373-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes, in Wireshark you can use "Follow SSL stream" to get a dump of the decrypted data from the SSL session.</p>

<p>You might be able to reconstruct the whole ssl session by merging two matching flows saved by tcpflow. When you loaded x.x.x.x:a-&gt;y.y.y.y:443, you can merge with:</p>

<pre><code>mergecap -w out.pcap x.x.x.x:a-&gt;y.y.y.y:443.pcap y.y.y.y:443-&gt;x.x.x.x:a.pcap
</code></pre>

<p>(or something like that, I don't know how tcpflow names the individual files for each flow)</p></div>
            <div class="comment-info" id="comment-10373-info">
                
                
                
                

                

                <span class="comment-age">(21 Apr '12, 03:27)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="10376"></a>
        <div class="comment not_top_scorer" id="comment-10376">
            <div id="post-10376-score" class="comment-score"></div>
            <div class="comment-text"><p>ok..i am aware of Follow ssl stream(GUI option)..but i wanted to know the command line..please let me know if we have command line option for the same..wat i want is to decode ssl messges(live) and write to a file..</p></div>
            <div class="comment-info" id="comment-10376-info">
                
                
                
                

                

                <span class="comment-age">(21 Apr '12, 08:15)</span>
                <a class="comment-user userinfo" href="/users/2496/vikram">vikram</a>
                
            </div>
        </div>
    
        <a name="10421"></a>
        <div class="comment not_top_scorer" id="comment-10421">
            <div id="post-10421-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi,
I used the tshark command mentioned below and opened the log(vik24_01.log
) using wireshark in GUI.and when i click on Follow SSL stream,new window that comes up is blank and says conversation bytes zero.</p>

<p><code>tshark -o "ssl.desegment_ssl_records: TRUE" -o "ssl.desegment_ssl_application_data: TRUE" -o "ssl.keys_list: MYSERVERIP,443,http,server.pem" -o "ssl.debug_file: wireshark01.log" -i eth1 -R "tcp.port == 443" -w vik24_01.log</code></p>

<p>unable to understand why i am not able to see decrypted (should be a XML message in my case) message.</p></div>
            <div class="comment-info" id="comment-10421-info">
                
                
                
                

                

                <span class="comment-age">(24 Apr '12, 05:49)</span>
                <a class="comment-user userinfo" href="/users/2496/vikram">vikram</a>
                
            </div>
        </div>
    
        <a name="10424"></a>
        <div class="comment not_top_scorer" id="comment-10424">
            <div id="post-10424-score" class="comment-score"></div>
            <div class="comment-text"><p>I see the below output in ssl debug file..it looks like this time..tshark is able to decode the ssl..but still i see the data in some hexdecimal formart (it should be xml in my case after decode)
eg:-
pre master encrypted[256]:
65 8c f3 c2 07 7f ba dc 36 e9 b6 ab ce 37 85 9a 
not sure if the above is the data the is decrypted and exchanged between the applications ?</p>

<pre><code>ssl_init keys string:
MYSERVERIP,443,http,server.pem
ssl_init found host entry MYSERVERIP,443,http,server.pem
ssl_init addr 'MYSERVERIP' port '443' filename 'server.pem' password(only for p12 file) '(null)'
Private key imported: KeyID 9F:15:AA:5E:9F:7E:56:2E:60:DD:9C:49:68:A3:00:CD:...
ssl_init private key file server.pem successfully loaded
association_add TCP port 443 protocol http handle 0x8bdcf50
association_find: TCP port 993 found 0x91e6608
ssl_association_remove removing TCP 993 - imap handle 0x8d5ac78
association_add TCP port 993 protocol imap handle 0x8d5ac78
association_find: TCP port 995 found 0x91e6640
ssl_association_remove removing TCP 995 - pop handle 0x8e18650
association_add TCP port 995 protocol pop handle 0x8e18650

dissect_ssl enter frame #45 (first time)
ssl_session_init: initializing ptr 0xb67ed3d8 size 564
association_find: TCP port 59763 found (nil)
packet_from_server: is from server - FALSE
dissect_ssl server MYSERVERIP:443
  conversation = 0xb67ed200, ssl_session = 0xb67ed3d8
client random len: 16 padded to 32

dissect_ssl enter frame #51 (first time)
  conversation = 0xb67ed200, ssl_session = 0xb67ed3d8
dissect_ssl3_record found version 0x0301 -&gt; state 0x11
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 58 ssl, state 0x11
association_find: TCP port 443 found 0x934b4e8
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 2 offset 5 length 54 bytes, remaining 63 
dissect_ssl3_hnd_hello_common found SERVER RANDOM -&gt; state 0x13
dissect_ssl3_hnd_srv_hello found CIPHER 0x0004 -&gt; state 0x17
dissect_ssl3_hnd_srv_hello not enough data to generate key (required 0x37)

dissect_ssl enter frame #53 (first time)
  conversation = 0xb67ed200, ssl_session = 0xb67ed3d8

dissect_ssl enter frame #55 (first time)
  conversation = 0xb67ed200, ssl_session = 0xb67ed3d8

dissect_ssl enter frame #57 (first time)
  conversation = 0xb67ed200, ssl_session = 0xb67ed3d8
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 3914 ssl, state 0x17
association_find: TCP port 443 found 0x934b4e8
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 11 offset 5 length 3910 bytes, remaining 3919

dissect_ssl enter frame #58 (first time)
  conversation = 0xb67ed200, ssl_session = 0xb67ed3d8
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 4 ssl, state 0x17
association_find: TCP port 443 found 0x934b4e8
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 14 offset 5 length 0 bytes, remaining 9

dissect_ssl enter frame #71 (first time)
  conversation = 0xb67ed200, ssl_session = 0xb67ed3d8
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 262 ssl, state 0x17
association_find: TCP port 59763 found (nil)
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 16 offset 5 length 258 bytes, remaining 267 
dissect_ssl3_handshake found SSL_HND_CLIENT_KEY_EXCHG state 0x17
pre master encrypted[256]:
65 8c f3 c2 07 7f ba dc 36 e9 b6 ab ce 37 85 9a 
1b 74 09 ad b3 85 58 29 90 6b 85 c7 57 77 9b 62 
44 f6 a1 13 f9 d4 cd cf d4 ac cb 6f 9a 85 73 b3 
1b 41 15 1c ec 4d 4f c4 cf 5b df a7 f5 37 68 8f 
9f b0 9e dd 58 86 5d 1e 99 63 d1 17 9c fd 95 c3 
dd 23 2e 36 98 e5 74 66 58 dc 98 35 1a c3 2a 50 
47 61 8f ef db b7 39 2a 6e 22 cf 2c 3b 1b 17 41 
24 ac 68 0e 0a 45 7d 8e 51 7d 0b 3e 80 5b 83 1a 
0b cf 6c 55 1a ce 35 3b 0c d7 54 31 87 56 40 95 
a0 e9 0c 82 97 7e 96 2f 1e ea f7 4a 0f a0 fc d8 
84 c7 f1 92 42 0f a7 c9 8d 26 d3 44 62 70 7a 19 
3a 84 9d 70 ec 9d 37 1d d0 11 73 7b 90 6c a2 85 
d3 7d c7 05 17 42 ea fc cf 89 cf a4 dc 01 1c 6b 
f8 27 7e bd ed 55 6a 84 a9 1b e0 8b ff f2 d6 9a 
87 d3 14 29 01 9a 47 7e fa a4 ba 39 f9 ef 94 b3 
dd 10 c3 4d 04 76 a1 d6 1f f0 6b d8 8f 06 7d 2b 
ssl_decrypt_pre_master_secret:RSA_private_decrypt
pcry_private_decrypt: stripping 34 bytes, decr_len 256
decrypted_unstrip_pre_master[256]:
65 97 fc 2a b6 d6 50 67 de 69 1e 95 62 51 62 3c 
39 ef 7e 47 a4 ee 57 0a 39 84 cf 0b a6 f7 28 b7 
df 00 b1 d6 5a d0 90 4c ae 42 59 e3 89 f2 e9 25 
93 a7 fa b3 d6 70 bb c5 8f fd f2 94 b4 87 45 e7 
05 22 8b d4 86 21 b3 2e 5c 62 85 12 0c 2e 8a 52 
40 ee 66 9c f7 1c 60 8d 85 e3 26 96 d1 a9 f2 d3 
0f 0c 93 66 3c 2e 95 2b c0 4b fa 99 06 fc ad 3d 
33 3a 34 e9 87 08 12 6a 58 f3 c4 8f 16 ff 2d 56 
b2 4d a4 e2 17 23 d7 56 e4 10 52 89 4f b2 f3 58 
68 db a0 fd 30 f2 44 eb dd 26 f6 49 c2 48 5d 1c 
26 c4 0c 43 18 fc b3 50 66 03 b5 3c 17 c7 56 c8 
ba fa 86 f9 99 3b 8c fd 7a 98 47 4a 89 d9 48 dc 
ac c3 d7 ee 3a 1f c4 8f 07 f0 64 e9 95 3c 3c 50 
a5 7c 00 07 26 8d 4e 10 b9 f9 c2 2a 1a f8 d3 1f 
c8 6a 58 d6 5e 72 03 f3 f2 ac 38 85 b3 83 50 24 
a0 72 24 33 0a 05 ba 0b c8 6b 7c d6 34 cb 46 04 
ssl_decrypt_pre_master_secret wrong pre_master_secret length (222, expected 48)
dissect_ssl3_handshake can't decrypt pre master secret

dissect_ssl enter frame #72 (first time)
  conversation = 0xb67ed200, ssl_session = 0xb67ed3d8
dissect_ssl3_record: content_type 20
dissect_ssl3_change_cipher_spec
association_find: TCP port 59763 found (nil)
packet_from_server: is from server - FALSE
ssl_change_cipher CLIENT

dissect_ssl enter frame #73 (first time)
  conversation = 0xb67ed200, ssl_session = 0xb67ed3d8
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 32 ssl, state 0x17
association_find: TCP port 59763 found (nil)
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 1 offset 5 length 7452990 bytes, remaining 37

dissect_ssl enter frame #76 (first time)
  conversation = 0xb67ed200, ssl_session = 0xb67ed3d8
dissect_ssl3_record: content_type 20
dissect_ssl3_change_cipher_spec
association_find: TCP port 443 found 0x934b4e8
packet_from_server: is from server - TRUE
ssl_change_cipher SERVER

dissect_ssl enter frame #77 (first time)
  conversation = 0xb67ed200, ssl_session = 0xb67ed3d8
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 32 ssl, state 0x17
association_find: TCP port 443 found 0x934b4e8
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 118 offset 5 length 10820990 bytes, remaining 37

dissect_ssl enter frame #79 (first time)
  conversation = 0xb67ed200, ssl_session = 0xb67ed3d8
dissect_ssl3_record: content_type 23
decrypt_ssl3_record: app_data len 335 ssl, state 0x17
association_find: TCP port 59763 found (nil)
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
association_find: TCP port 59763 found (nil)
association_find: TCP port 443 found 0x934b4e8

dissect_ssl enter frame #80 (first time)
  conversation = 0xb67ed200, ssl_session = 0xb67ed3d8
dissect_ssl3_record: content_type 23
decrypt_ssl3_record: app_data len 732 ssl, state 0x17
association_find: TCP port 59763 found (nil)
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
association_find: TCP port 59763 found (nil)
association_find: TCP port 443 found 0x934b4e8

dissect_ssl enter frame #81 (first time)
  conversation = 0xb67ed200, ssl_session = 0xb67ed3d8
dissect_ssl3_record: content_type 23
decrypt_ssl3_record: app_data len 24 ssl, state 0x17
association_find: TCP port 59763 found (nil)
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
association_find: TCP port 59763 found (nil)
association_find: TCP port 443 found 0x934b4e8

dissect_ssl enter frame #99 (first time)
  conversation = 0xb67ed200, ssl_session = 0xb67ed3d8
dissect_ssl3_record: content_type 23
decrypt_ssl3_record: app_data len 723 ssl, state 0x17
association_find: TCP port 443 found 0x934b4e8
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available
association_find: TCP port 443 found 0x934b4e8
</code></pre></div>
            <div class="comment-info" id="comment-10424-info">
                
                
                
                

                

                <span class="comment-age">(24 Apr '12, 19:58)</span>
                <a class="comment-user userinfo" href="/users/2496/vikram">vikram</a>
                
            </div>
        </div>
    
        <a name="10428"></a>
        <div class="comment not_top_scorer" id="comment-10428">
            <div id="post-10428-score" class="comment-score"></div>
            <div class="comment-text"><p>From your log:</p>

<p><code>ssl_decrypt_pre_master_secret wrong pre_master_secret length (222, expected 48)
dissect_ssl3_handshake can't decrypt pre master secret</code></p>

<p>There's still something wrong, hence the lack of decryption.</p></div>
            <div class="comment-info" id="comment-10428-info">
                
                
                
                

                

                <span class="comment-age">(25 Apr '12, 01:39)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="10446"></a>
        <div class="comment" id="comment-10446">
            <div id="post-10446-score" class="comment-score">1</div>
            <div class="comment-text"><p>The log message "ssl_decrypt_pre_master_secret wrong pre_master_secret length (222, expected 48)" usually indicates that the private key does not match the certificate. Although recently I have seen it also happening with a specific version of the GnuTLS library. Which Wireshark version are you using and which library versions (see "About Wireshark")</p></div>
            <div class="comment-info" id="comment-10446-info">
                
                
                
                

                

                <span class="comment-age">(25 Apr '12, 13:53)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="10565"></a>
        <div class="comment not_top_scorer" id="comment-10565">
            <div id="post-10565-score" class="comment-score"></div>
            <div class="comment-text"><p>1.) please post the new debug file.</p>

<p>2.) did you capture the WHOLE frame? This is only important if you did not capture with tshark/wireshark. Other sniffers might limit the packet size to 60-100 byte per default. If you don't change that, you'll be unable to decrypt SSL. For tcpdump use -s0.</p>

<p>3.) Is the given private key encrypted? Look for lines with the string "ENCRYPTED" in the pem file.</p>

<p>4.) Just by chance: Can you please verify that your SSL connection is NOT using any DH (Diffie Hellman) algorithms - look for DH or DHE in the cipher suite name (Cipher Suites in Server HELO). If DH is used, there is no (known) way to decrypt the session.</p>

<p>Regards<br>
Kurt</p></div>
            <div class="comment-info" id="comment-10565-info">
                
                
                
                

                

                <span class="comment-age">(01 May '12, 22:49)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="10568"></a>
        <div class="comment not_top_scorer" id="comment-10568">
            <div id="post-10568-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi Kurt,
Please find my asnwers as below</p>

<p>1) debug file </p>

<pre><code>ssl_init keys string:
SERVERIP,443,http,osbserverkeyoutHTB.pem
ssl_init found host entry SERVERIP,443,http,osbserverkeyoutHTB.pem
ssl_init addr 'SERVERIP' port '443' filename 'osbserverkeyoutHTB.pem' password(only for p12 file) '(null)'
Private key imported: KeyID 9F:15:AA:5E:9F:7E:56:2E:60:DD:9C:49:68:A3:00:CD:...
ssl_init private key file osbserverkeyoutHTB.pem successfully loaded
association_add TCP port 443 protocol http handle 0x881ff50
association_find: TCP port 993 found 0x8e29608
ssl_association_remove removing TCP 993 - imap handle 0x899dc78
association_add TCP port 993 protocol imap handle 0x899dc78
association_find: TCP port 995 found 0x8e29640
ssl_association_remove removing TCP 995 - pop handle 0x8a5b650
association_add TCP port 995 protocol pop handle 0x8a5b650

dissect_ssl enter frame #39 (first time)
ssl_session_init: initializing ptr 0xb67f6ed8 size 564
association_find: TCP port 12056 found (nil)
packet_from_server: is from server - FALSE
dissect_ssl server SERVERIP:443
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8
client random len: 16 padded to 32

dissect_ssl enter frame #41 (first time)
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8
dissect_ssl3_record found version 0x0301 -&gt; state 0x11
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 58 ssl, state 0x11
association_find: TCP port 443 found 0x8f8e710
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 2 offset 5 length 54 bytes, remaining 63 
dissect_ssl3_hnd_hello_common found SERVER RANDOM -&gt; state 0x13
dissect_ssl3_hnd_srv_hello found CIPHER 0x0004 -&gt; state 0x17
dissect_ssl3_hnd_srv_hello not enough data to generate key (required 0x37)

dissect_ssl enter frame #43 (first time)
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8

dissect_ssl enter frame #45 (first time)
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8

dissect_ssl enter frame #47 (first time)
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 3914 ssl, state 0x17
association_find: TCP port 443 found 0x8f8e710
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 11 offset 5 length 3910 bytes, remaining 3919

dissect_ssl enter frame #49 (first time)
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 4 ssl, state 0x17
association_find: TCP port 443 found 0x8f8e710
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 14 offset 5 length 0 bytes, remaining 9

dissect_ssl enter frame #51 (first time)
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 262 ssl, state 0x17
association_find: TCP port 12056 found (nil)
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 16 offset 5 length 258 bytes, remaining 267 
dissect_ssl3_handshake found SSL_HND_CLIENT_KEY_EXCHG state 0x17
pre master encrypted[256]:
0a 66 ca bb 03 70 b8 d2 11 47 d5 d5 d9 98 bc b6 
37 52 3a 6a b5 21 d6 63 2e 58 eb bb 7c 83 0e 5c 
31 8d 90 59 9b bc 38 ac 77 88 2f ec e9 4c 10 7f 
be 09 e4 d6 f6 88 54 62 c7 3c 30 c0 5b 4d a3 cf 
24 bd d6 91 40 73 c4 43 77 03 91 f8 d8 e0 91 47 
4f 65 bb 67 ca a0 1a 1b 9e 97 bd 3c 14 97 44 1f 
29 2f 6c de e8 d4 69 1a 85 b2 3e f8 36 8d bf e7 
de 4a 4f 20 b3 1d 25 95 58 55 04 88 86 64 e7 9f 
ac d6 05 16 78 8c ec 48 a0 53 81 e5 3a 64 e0 5e 
e6 05 79 1b 58 30 6d 36 e6 8e ea c6 ba da fe a7 
26 5f 90 2d 38 29 65 9b 45 1e d4 e2 73 84 d0 1a 
dc 96 49 ec 09 6b af 57 b8 ca 45 f5 6c bb ce a4 
db b2 c6 47 59 03 64 5d 4e 7b e5 cf bd 1b 6e 5c 
16 a8 ce 34 73 38 db d1 95 ae 57 6f d8 fa a5 06 
08 73 05 07 9f 96 37 60 a9 5f 9b 10 2f 12 9d b4 
95 05 6c 3e 52 83 6f 61 99 21 38 85 f9 74 09 83 
ssl_decrypt_pre_master_secret:RSA_private_decrypt
pcry_private_decrypt: stripping 0 bytes, decr_len 256
decrypted_unstrip_pre_master[256]:
39 30 71 23 f2 66 4a c6 d4 36 b2 b6 bf e8 b5 0c 
de 0d dc 4f df 7e 72 ac b1 b3 9a b2 dc b7 a4 02 
6c dc 72 0f 79 4a c7 b1 50 d3 d5 95 53 6a 18 1c 
82 44 17 d2 6b 26 20 05 fa d2 02 fc a8 eb 66 b9 
74 a5 35 a1 70 78 ff 97 2f 27 1b 8c db fa 8e 44 
59 23 a3 d3 5a d1 ea dd 6c b1 b8 c6 99 02 c8 bd 
e4 06 ed d5 5d b7 a2 9b 34 28 ff 34 6d a2 bd 10 
a2 a3 c3 46 a5 95 83 52 71 11 0a 7b ab 7e 5d 17 
26 7b aa 0d dc 30 a8 0c f8 0b 8e dd 4e ed fb ab 
aa e6 51 63 c0 a2 5e 67 b4 87 28 22 98 89 e7 6e 
dc 11 6d 91 40 2d aa 48 d5 f1 03 07 cc 10 08 df 
ad e0 96 69 c2 36 19 b8 42 1c eb ea 4e e7 61 72 
07 83 51 80 6b dc 9c f3 47 d3 32 1e d1 b7 f1 05 
9e 10 76 89 5e 41 cb f9 f6 84 c3 c6 33 5c 4e 4f 
02 27 93 ed b0 da 35 44 1f e0 5d 63 85 2c fa 94 
fd 3a f6 5e ee 4e d5 dc ad f5 10 62 9a 7b 0d bf 
ssl_decrypt_pre_master_secret wrong pre_master_secret length (256, expected 48)
dissect_ssl3_handshake can't decrypt pre master secret

dissect_ssl enter frame #52 (first time)
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8
dissect_ssl3_record: content_type 20
dissect_ssl3_change_cipher_spec
association_find: TCP port 12056 found (nil)
packet_from_server: is from server - FALSE
ssl_change_cipher CLIENT

dissect_ssl enter frame #54 (first time)
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 32 ssl, state 0x17
association_find: TCP port 12056 found (nil)
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 71 offset 5 length 13161076 bytes, remaining 37

dissect_ssl enter frame #57 (first time)
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8
dissect_ssl3_record: content_type 20
dissect_ssl3_change_cipher_spec
association_find: TCP port 443 found 0x8f8e710
packet_from_server: is from server - TRUE
ssl_change_cipher SERVER

dissect_ssl enter frame #58 (first time)
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 32 ssl, state 0x17
association_find: TCP port 443 found 0x8f8e710
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 186 offset 5 length 16179502 bytes, remaining 37

dissect_ssl enter frame #60 (first time)
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8
dissect_ssl3_record: content_type 23
decrypt_ssl3_record: app_data len 335 ssl, state 0x17
association_find: TCP port 12056 found (nil)
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
association_find: TCP port 12056 found (nil)
association_find: TCP port 443 found 0x8f8e710

dissect_ssl enter frame #61 (first time)
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8
dissect_ssl3_record: content_type 23
decrypt_ssl3_record: app_data len 726 ssl, state 0x17
association_find: TCP port 12056 found (nil)
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
association_find: TCP port 12056 found (nil)
association_find: TCP port 443 found 0x8f8e710

dissect_ssl enter frame #62 (first time)
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8
dissect_ssl3_record: content_type 23
decrypt_ssl3_record: app_data len 24 ssl, state 0x17
association_find: TCP port 12056 found (nil)
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
association_find: TCP port 12056 found (nil)
association_find: TCP port 443 found 0x8f8e710

dissect_ssl enter frame #67 (first time)
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8
dissect_ssl3_record: content_type 23
decrypt_ssl3_record: app_data len 262 ssl, state 0x17
association_find: TCP port 443 found 0x8f8e710
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available
association_find: TCP port 443 found 0x8f8e710

dissect_ssl enter frame #68 (first time)
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8

dissect_ssl enter frame #70 (first time)
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8

dissect_ssl enter frame #71 (first time)
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8

dissect_ssl enter frame #73 (first time)
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8
dissect_ssl3_record: content_type 23
decrypt_ssl3_record: app_data len 5182 ssl, state 0x17
association_find: TCP port 443 found 0x8f8e710
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available
association_find: TCP port 443 found 0x8f8e710

dissect_ssl enter frame #74 (first time)
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8
dissect_ssl3_record: content_type 21
decrypt_ssl3_record: app_data len 18 ssl, state 0x17
association_find: TCP port 12056 found (nil)
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available

dissect_ssl enter frame #76 (first time)
  conversation = 0xb67f6d00, ssl_session = 0xb67f6ed8
dissect_ssl3_record: content_type 21
decrypt_ssl3_record: app_data len 18 ssl, state 0x17
association_find: TCP port 443 found 0x8f8e710
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available
</code></pre>

<p>2) I used tshark.</p>

<p>3) Private key is not encrypted</p>

<p>4) I see only one Cipher suite used for "server hello" and it is <code>TLS_RSA_WITH_RC4_128_MD5</code></p></div>
            <div class="comment-info" id="comment-10568-info">
                
                
                
                

                

                <span class="comment-age">(01 May '12, 23:13)</span>
                <a class="comment-user userinfo" href="/users/2496/vikram">vikram</a>
                
            </div>
        </div>
    
        <a name="10590"></a>
        <div class="comment not_top_scorer" id="comment-10590">
            <div id="post-10590-score" class="comment-score"></div>
            <div class="comment-text"><p>i am still having the issue with decoding ..in the debug file i see a message "ssl_decrypt_pre_master_secret wrong pre_master_secret length (256, expected 48)
dissect_ssl3_handshake can't decrypt pre master secret"</p>

<p>"decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available"</p>

<p>Does this message means i am using a wrong private key ?To the best of my knowledge i am using the correct key.</p></div>
            <div class="comment-info" id="comment-10590-info">
                
                
                
                

                

                <span class="comment-age">(02 May '12, 04:54)</span>
                <a class="comment-user userinfo" href="/users/2496/vikram">vikram</a>
                
            </div>
        </div>
    
        <a name="10594"></a>
        <div class="comment not_top_scorer" id="comment-10594">
            <div id="post-10594-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi SYN-bit,
I am sorry didn't saw your comment on my issue.I am using Version 1.6.7 (SVN Rev 41973 from /trunk-1.6 of wireshark</p></div>
            <div class="comment-info" id="comment-10594-info">
                
                
                
                

                

                <span class="comment-age">(02 May '12, 05:50)</span>
                <a class="comment-user userinfo" href="/users/2496/vikram">vikram</a>
                
            </div>
        </div>
    
        <a name="10595"></a>
        <div class="comment not_top_scorer" id="comment-10595">
            <div id="post-10595-score" class="comment-score"></div>
            <div class="comment-text"><p>Please find my About Wireshark as below</p>

<p>Version 1.6.7 (SVN Rev 41973 from /trunk-1.6)
Compiled (64-bit) with GTK+ 2.22.1, with GLib 2.26.1, with WinPcap (version
unknown), with libz 1.2.5, without POSIX capabilities, without libpcre, without
SMI, with c-ares 1.7.1, with Lua 5.1, without Python, with GnuTLS 2.12.18, with
Gcrypt 1.4.6, without Kerberos, with GeoIP, with PortAudio V19-devel (built Apr 
6 2012), with AirPcap.version 4.1.0.2001), based on libpcap version 1.0 branch 1_0_rel0b (20091008),
GnuTLS 2.12.18, Gcrypt 1.4.6, without AirPcap</p></div>
            <div class="comment-info" id="comment-10595-info">
                
                
                
                

                

                <span class="comment-age">(02 May '12, 05:51)</span>
                <a class="comment-user userinfo" href="/users/2496/vikram">vikram</a>
                
            </div>
        </div>
    
        <a name="10596"></a>
        <div class="comment not_top_scorer" id="comment-10596">
            <div id="post-10596-score" class="comment-score"></div>
            <div class="comment-text"><p>Running on 64-bit Windows 7, build 7600, with WinPcap version 4.1.2 (packet.dll</p></div>
            <div class="comment-info" id="comment-10596-info">
                
                
                
                

                

                <span class="comment-age">(02 May '12, 05:51)</span>
                <a class="comment-user userinfo" href="/users/2496/vikram">vikram</a>
                
            </div>
        </div>
    
        <a name="10597"></a>
        <div class="comment not_top_scorer" id="comment-10597">
            <div id="post-10597-score" class="comment-score"></div>
            <div class="comment-text"><p>I did some testing. Whenever the key does not match the certificate, I get exactly the same error message (see also comment of SYN-bit). However in my case: WinXP SP3 32-Bit.</p>

<p>Please check your key. How did you get (export) the key?</p></div>
            <div class="comment-info" id="comment-10597-info">
                
                
                
                

                

                <span class="comment-age">(02 May '12, 06:19)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="10599"></a>
        <div class="comment not_top_scorer" id="comment-10599">
            <div id="post-10599-score" class="comment-score"></div>
            <div class="comment-text"><p>Also when we run the tshark command ,do we need to provide the private keys of both client and server ?</p></div>
            <div class="comment-info" id="comment-10599-info">
                
                
                
                

                

                <span class="comment-age">(02 May '12, 06:50)</span>
                <a class="comment-user userinfo" href="/users/2496/vikram">vikram</a>
                
            </div>
        </div>
    
        <a name="10600"></a>
        <div class="comment not_top_scorer" id="comment-10600">
            <div id="post-10600-score" class="comment-score"></div>
            <div class="comment-text"><p>unless you are using client certificates, there is no client private key.</p>

<p>BTW: does the server request a client cert?</p></div>
            <div class="comment-info" id="comment-10600-info">
                
                
                
                

                

                <span class="comment-age">(02 May '12, 06:53)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="10615"></a>
        <div class="comment" id="comment-10615">
            <div id="post-10615-score" class="comment-score">1</div>
            <div class="comment-text"><p>And even if you are using client certificates, you only need the server private key for decryption.</p></div>
            <div class="comment-info" id="comment-10615-info">
                
                
                
                

                

                <span class="comment-age">(02 May '12, 14:27)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="10622"></a>
        <div class="comment not_top_scorer" id="comment-10622">
            <div id="post-10622-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi SYN-bit ..can you please verify the details of the verision of wireshark and GnuTLS library that i am using..I have posted the details of the versions in the previous comments ..please let me know if the issue is with the version's i am using?
Also i have two private keys in the jks keystore at the client side and i tried using both of them for decrypting in the tshark command.I am unable to export the server side private key,unfortunatley i don't remember the password of the p12 wallet  file at the server side.</p></div>
            <div class="comment-info" id="comment-10622-info">
                
                
                
                

                

                <span class="comment-age">(03 May '12, 00:15)</span>
                <a class="comment-user userinfo" href="/users/2496/vikram">vikram</a>
                
            </div>
        </div>
    
        <a name="10625"></a>
        <div class="comment not_top_scorer" id="comment-10625">
            <div id="post-10625-score" class="comment-score"></div>
            <div class="comment-text"><p>You <strong>must</strong> use the server key for decrypting, that is a basic part of ssl.</p></div>
            <div class="comment-info" id="comment-10625-info">
                
                
                
                

                

                <span class="comment-age">(03 May '12, 02:32)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="10626"></a>
        <div class="comment not_top_scorer" id="comment-10626">
            <div id="post-10626-score" class="comment-score"></div>
            <div class="comment-text"><p>If i am not wrong we import the server key into the client keystore as well,as part of enabling SSL between client and server?In our scenario we raised a CSR request and got the digital signed certificates and then we imported them into the client keystore as well.</p></div>
            <div class="comment-info" id="comment-10626-info">
                
                
                
                

                

                <span class="comment-age">(03 May '12, 03:07)</span>
                <a class="comment-user userinfo" href="/users/2496/vikram">vikram</a>
                
            </div>
        </div>
    
        <a name="10628"></a>
        <div class="comment" id="comment-10628">
            <div id="post-10628-score" class="comment-score">1</div>
            <div class="comment-text"><p>Well, I don't have a compatability list, but if you use a Wireshark version downloaded from <a href="http://www.wireshark.org">www.wireshark.org</a>, you should be fine.</p>

<p>When you create a CSR and let the server sign it, the you <em>don't</em> import the servers private key, you import a certificate which has been signed by the servers private key.</p>

<p>If you say "I am unable to export the server side private key,unfortunatley i don't remember the password of the p12 wallet file at the server side", you clearly state where your problem lies... You need this key.</p></div>
            <div class="comment-info" id="comment-10628-info">
                
                
                
                

                

                <span class="comment-age">(03 May '12, 04:10)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="10633"></a>
        <div class="comment not_top_scorer" id="comment-10633">
            <div id="post-10633-score" class="comment-score"></div>
            <div class="comment-text"><p>so ..at the client side ..do we import the certificates which has been signed by the third party or do we export the private key of server and import it at the client side server ?
If my dought is correct and we import the server private key at the client side application server then what i have been using till these will be the correct key(in the tshark command)</p></div>
            <div class="comment-info" id="comment-10633-info">
                
                
                
                

                

                <span class="comment-age">(03 May '12, 05:31)</span>
                <a class="comment-user userinfo" href="/users/2496/vikram">vikram</a>
                
            </div>
        </div>
    
        <a name="10636"></a>
        <div class="comment" id="comment-10636">
            <div id="post-10636-score" class="comment-score">1</div>
            <div class="comment-text"><p>Let's make things easier... forget about whether or not you are using client certificates, they don't play a role in SSL decryption.</p>

<p>When you captured SSL traffic that you want to decrypt, there are TCP sessions initiated by the client with as destination the server. This server presents a certificate back to the client in the TCP session. This certificate corresponds to a private key on the server. It is this private key on the server that you will need to use in wireshark to decrypt the session. </p>

<p>Where the key resides on the server can be found in the configuration of the (web)server.</p></div>
            <div class="comment-info" id="comment-10636-info">
                
                
                
                

                

                <span class="comment-age">(03 May '12, 07:25)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="10638"></a>
        <div class="comment not_top_scorer" id="comment-10638">
            <div id="post-10638-score" class="comment-score"></div>
            <div class="comment-text"><p>if it's a windows HTTP server, go to the server and open certmgr. Select the certificate and export it. If the private key is "exportable", select the option to include the private key. The resulting pcks#12 file will contain the cert and the private key. Use openssl to extract the private key.</p>

<p>if it's a webserver on unix, the private key will be located in a file (PEM/PKCS#12). In case of an encrypted PEM or a PKCS#12, the 'passphrase' to open that file must be part of the webserver configuration. Find that passphrase and decrypt the key.</p>

<p>Use the decrypted key (or PCKS#12) in wireshark!</p></div>
            <div class="comment-info" id="comment-10638-info">
                
                
                
                

                

                <span class="comment-age">(03 May '12, 07:37)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="10659"></a>
        <div class="comment not_top_scorer" id="comment-10659">
            <div id="post-10659-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi,
At the client it is weblogic,and i used keytool commands and found there are two private keys in the keystore(jks file),Which i thoguht one of them to be the server private key (server side it is oracle app server p12 wallet file).SYN-bit please validate my statement "when we enable SSL between two server's,Server private key will not be imported at the client application server" .If this is correct then i need to find a way to get the private key from the server side wallet file(since i dont remember the password).</p></div>
            <div class="comment-info" id="comment-10659-info">
                
                
                
                

                

                <span class="comment-age">(03 May '12, 20:55)</span>
                <a class="comment-user userinfo" href="/users/2496/vikram">vikram</a>
                
            </div>
        </div>
    
        <a name="10662"></a>
        <div class="comment not_top_scorer" id="comment-10662">
            <div id="post-10662-score" class="comment-score"></div>
            <div class="comment-text"><p>there is no reason to import the server key at the 'client' and apparently the key you are using in wireshark is not the right one. BTW: Have you tried to use ONLY the key, you believe to be the server key, in wirehark? If that all does not help, you'll need the passphrase for the p12 file of the oracle app server. The admin of that server should have the passphrase.</p></div>
            <div class="comment-info" id="comment-10662-info">
                
                
                
                

                

                <span class="comment-age">(03 May '12, 22:53)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="10663"></a>
        <div class="comment not_top_scorer" id="comment-10663">
            <div id="post-10663-score" class="comment-score"></div>
            <div class="comment-text"><p>yes..i used the private key..which i belived was the servers private key.with tshark and the output of the debug file i have posted..above..</p></div>
            <div class="comment-info" id="comment-10663-info">
                
                
                
                

                

                <span class="comment-age">(04 May '12, 01:15)</span>
                <a class="comment-user userinfo" href="/users/2496/vikram">vikram</a>
                
            </div>
        </div>
    
        <a name="10666"></a>
        <div class="comment not_top_scorer" id="comment-10666">
            <div id="post-10666-score" class="comment-score"></div>
            <div class="comment-text"><p>O.K. then it's the wrong key. Get the p12 file and the passphrase from the oracle wallet.</p></div>
            <div class="comment-info" id="comment-10666-info">
                
                
                
                

                

                <span class="comment-age">(04 May '12, 01:57)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="11416"></a>
        <div class="comment not_top_scorer" id="comment-11416">
            <div id="post-11416-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi all,
I am able to decrypt the ssl ,after i regenerated the certificates and used the servers private key.
I am intrested in reading the xml payload and writing it to file(planing to use a java code) .In the ssl debug file generated by the tshark i can see the payload ,however the problem here that payload is broken into parts ,which is making it difficult to read and get the full payload with out decryption related.
So is there any way to read only the payload from the catptured ssl dump file or ssl debug file using tshark or any other command line tool?</p></div>
            <div class="comment-info" id="comment-11416-info">
                
                
                
                

                

                <span class="comment-age">(27 May '12, 23:53)</span>
                <a class="comment-user userinfo" href="/users/2496/vikram">vikram</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-10287" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 32
        </span>
        <a href="#" class="show-all-comments-link">show 27 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-10287-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/10286/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='LJUJNAZKu2n3QJrdPtT3Z0iEpFEAPstm' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/10286/unable-to-decode-ssl?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/10286/unable-to-decode-ssl?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/ssl/"
            class="tag-link-ssl"
            title="see questions tagged'ssl'using tags"
            rel="tag">ssl</a> <span class="tag-number">&#215;319</span><br/>
        
        <a href="/tags/decrypt/"
            class="tag-link-decrypt"
            title="see questions tagged'decrypt'using tags"
            rel="tag">decrypt</a> <span class="tag-number">&#215;62</span><br/>
        
    </p>
    <p>
        question asked: <strong title="April 19, 2012, 8:48 a.m.">19 Apr '12, 08:48</strong>
    </p>
    <p> 
     	question was seen: <strong>15,514 times</strong>
    </p>
    <p> 
        last updated: <strong title="May 28, 2012, 4:03 a.m.">28 May '12, 04:03</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/4303/decrypt-ssl-traffic-destined-for-squid-proxy-server">Decrypt SSL Traffic destined for Squid Proxy Server</a>
        </p>
        
        <p>
            <a href="/questions/10184/ssl-descrypt-_without_-specifying-a-protocol">SSL Descrypt _without_ specifying a protocol?</a>
        </p>
        
        <p>
            <a href="/questions/4320/strange-ssl-capture-ignored-unknown-record-instead-of-serverhello">Strange SSL capture: &quot;Ignored Unknown Record&quot; instead of ServerHello</a>
        </p>
        
        <p>
            <a href="/questions/16597/help-looking-at-a-specific-https-tcp-stream-1936-packets-i-start-to-get-malformed-packet-ssl-after-packet-782">HELP! Looking at a specific (HTTPS) TCP stream (1936 packets) I start to get Malformed Packet: SSL after packet 782</a>
        </p>
        
        <p>
            <a href="/questions/13721/decrypt-ssl-traffic-problem-because-of-dhe-cipher">Decrypt SSL traffic problem because of DHE Cipher</a>
        </p>
        
        <p>
            <a href="/questions/6584/decrypt-ssl-to-pcap">decrypt ssl to pcap</a>
        </p>
        
        <p>
            <a href="/questions/9071/unable-to-view-https-stream-using-ssl-decryption-follow-ssl-stream-is-greyed-out">Unable to view HTTPS stream using SSL decryption (&quot;Follow SSL Stream&quot; is greyed out.)</a>
        </p>
        
        <p>
            <a href="/questions/13874/ssl-decrypt-works-depending-on-the-used-browser">SSL Decrypt works depending on the used browser</a>
        </p>
        
        <p>
            <a href="/questions/14142/cannot-successfully-supply-master-secret-and-session-id-for-ssl-decryption">Cannot successfully supply Master Secret and Session ID for SSL Decryption?</a>
        </p>
        
        <p>
            <a href="/questions/37383/how-do-i-followdecrypt-a-tlsssl-session-containing-a-tls-ticket-change">How do I follow/decrypt a TLS/SSL session containing a TLS ticket change?</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
