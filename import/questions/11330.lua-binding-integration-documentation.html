<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Lua binding / integration - documentation - Wireshark Q&amp;A</title>
        <meta name="description" content="Hi, I&#39;m fascinated about Lua, after I had some time to learn a bit of Lua, on a longer travel by train yesterday (also inspired by this question and the code provided by @helloworld). The language is pretty simple but powerful and apparently (sometimes) faster than other scripting languages (I use P..." />
        <meta name="keywords" content="lua,documentation" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/11330/lua-binding-integration-documentation" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/11330/lua-binding-integration-documentation?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='EvdLHUJgTh2qsf9xLAceIuvfzHnwKO8w' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/11330/lua-binding-integration-documentation">Lua binding / integration - documentation</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-11330-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/11330/up/" rel="nofollow"> </a>
<div id="post-11330-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-11330-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/11330/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/11330/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hi,</p>
<p>I'm fascinated about Lua, after I had some time to learn a bit of Lua, on a longer travel by train yesterday (also inspired by this <a href="http://ask.wireshark.org/questions/11265/tshark-e-occurrencea">question</a> and the code provided by <a href="/users/817/helloworld"><a href="/users/817/helloworld">@helloworld</a></a>). The language is pretty simple but powerful and apparently (sometimes) faster than other scripting languages (I use Perl a lot).</p>
<p>Now my question: Is there a detailed description available about the Lua integration into wireshark? I know the wiki articles, the API documentation (merely a documentation of the function calling interface, which is O.K. as a reference) and some sharkfest presentations. However that does not fully explain all the details, necessary to write a dissector or a listener. The available sample code does help a bit, however (currently) it is not enough for me to fully understand the integration.</p>
<p>Sample code of a large (real world) dissector or listener would be really helpful. Can anyone here provide such an example?</p>
<p>Regards<br>
Kurt</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/lua/" class="post-tag tag-link-lua"
                                        title="see questions tagged 'lua'" rel="tag">lua</a>
                                
                                    <a href="/tags/documentation/" class="post-tag tag-link-documentation"
                                        title="see questions tagged 'documentation'" rel="tag">documentation</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>25 May '12, 04:20</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/11330/">
                edited
                <strong>29 May '12, 05:32</strong>
            </a>
        </p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-11330">
    
        <a name="11344"></a>
        <div class="comment" id="comment-11344">
            <div id="post-11344-score" class="comment-score"></div>
            <div class="comment-text"><p>I don't have enough uninterrupted time to formulate a decent answer, but I'll get back to you later. I hope someone beats me to it though. :)</p></div>
            <div class="comment-info" id="comment-11344-info">
                
                
                
                

                

                <span class="comment-age">(25 May '12, 11:13)</span>
                <a class="comment-user userinfo" href="/users/817/helloworld">helloworld</a>
                
            </div>
        </div>
    
        <a name="11346"></a>
        <div class="comment" id="comment-11346">
            <div id="post-11346-score" class="comment-score"></div>
            <div class="comment-text"><p>O.K. I'm looking forward to it. </p>

<p>BTW: Who has implemented the Lua integration?</p></div>
            <div class="comment-info" id="comment-11346-info">
                
                
                
                

                

                <span class="comment-age">(25 May '12, 11:23)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="11355"></a>
        <div class="comment" id="comment-11355">
            <div id="post-11355-score" class="comment-score"></div>
            <div class="comment-text"><p>I'm not sure I understand the context of "Lua integration". Are you asking who originally implemented the Wireshark Lua bindings? I believe it was <a href="http://wiki.wireshark.org/LuisOntanon">Luis Ontanon</a> and <a href="http://wiki.wireshark.org/UlfLamping">Ulf Lamping</a>.</p></div>
            <div class="comment-info" id="comment-11355-info">
                
                
                
                

                

                <span class="comment-age">(25 May '12, 14:28)</span>
                <a class="comment-user userinfo" href="/users/817/helloworld">helloworld</a>
                
            </div>
        </div>
    
        <a name="11361"></a>
        <div class="comment" id="comment-11361">
            <div id="post-11361-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes I mean the Lua binding.</p></div>
            <div class="comment-info" id="comment-11361-info">
                
                
                
                

                

                <span class="comment-age">(25 May '12, 15:37)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="11438"></a>
        <div class="comment" id="comment-11438">
            <div id="post-11438-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>I hope someone beats me to it though. :)</p>
</blockquote>

<p>beat/bump ;-)</p></div>
            <div class="comment-info" id="comment-11438-info">
                
                
                
                

                

                <span class="comment-age">(29 May '12, 05:31)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-11330" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-11330-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/11330/lua-binding-integration-documentation?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/11330/lua-binding-integration-documentation?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/11330/lua-binding-integration-documentation?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/11330/lua-binding-integration-documentation?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="11688"></a>
                    <div id="answer-container-11688" class="answer accepted-answer">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-11688-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/11688/up/" rel="nofollow"> </a>
<div id="post-11688-score" class="post-score"
    title="current number of votes">
    8
</div>
<a id="post-11688-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/11688/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="Kurt Knochner has selected this answer as the correct answer"
        href="/accept_answer/11688/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <h1>Introduction</h1>
<p>In Wireshark Lua, there are two types of packet processors: dissectors and listeners.
<br>
</p><br><table border="1" cellpadding="5">
    <tbody><tr>
        <th>Dissector</th>
        <th>Listener</th>
    </tr>
    <tr>
        <td><li>called for each frame that occurs at a particular dissector table (e.g., UDP port 5000)</li></td>
        <td><li>called for each frame that matches a particular <a href="http://wiki.wireshark.org/DisplayFilters">display filter</a></li></td>
    </tr>
    <tr>
        <td><li>used to parse raw frame data into human-friendly named fields</li></td>
        <td><li>useful for extracting information from a capture file (including the named fields)</li></td>
    </tr>
    <tr>
        <td><li>can be invoked <a href="http://ask.wireshark.org/questions/7341/why-does-wireshark-make-multiple-passes-during-dissection">multiple times</a> per frame</li></td>
        <td><li>invoked only once per frame</li></td>
    </tr>
    <tr>
        <td><li>optionally adds protocol fields as tree items (in the Packet Details Pane)</li></td>      
        <td><li>cannot add protocol fields</li></td>
    </tr>
</tbody></table>
<br><p></p>
<p>There are also <strong>post-dissectors</strong>:</p>
<ul>
<li>a special type of Dissector that is called for every frame and runs after all other non-post-dissectors</li>
<li>useful for adding tree items that assist in traffic analysis (e.g., using an <a href="http://wiki.wireshark.org/LuaAPI/TreeItem#treeitem:add_expert_info.28.5Bgroup_.5B.2Cseverity_.5B.2Ctext.5D_.5D_.5D.29">expert-info</a> tree item to flag high traffic volume between two endpoints)</li>
<li><a href="http://wiki.wireshark.org/Lua/Examples/PostDissector">example post-dissector</a></li>
</ul>
<hr>
<h2>How to write a Lua dissector</h2>
<ol>
<li><p>Create a Lua file (named <code>proto_foo.lua</code>) at one of the following directories:</p>

<ul><li><code>C:\Program Files\Wireshark\plugins\1.6.8\</code> (<strong>Windows</strong>)</li>
<li><code>C:\Users\johndoe\AppData\Roaming\Wireshark\plugins\</code> (<strong>Windows</strong>)</li>
<li><code>$HOME/.wireshark/plugins/</code> (<strong>UN*X</strong>)</li></ul></li>
<li><p>In <code>proto_foo.lua</code>, do the following:</p>

<ul><li>Declare the protocol with <a href="http://www.wireshark.org/docs/wsug_html_chunked/lua_module_Proto.html#lua_fn_Proto_new_name__desc_"><code>Proto()</code></a>.</li>
<li>Declare the protocol's fields with <a href="http://www.wireshark.org/docs/wsug_html_chunked/lua_module_Proto.html#lua_class_ProtoField"><code>ProtoField.XXX()</code></a>.</li>
<li><em>(OPTIONAL)</em> Declare the protocol's preferences with <a href="http://wiki.wireshark.org/LuaAPI/Pref#Pref"><code>Pref.XXX()</code></a>.</li>
<li>Declare the protocol's <code>dissector(Tvb, Pinfo, TreeItem)</code> function (called for each frame).</li>
<li><em>(OPTIONAL)</em> Declare the protocol's <code>init()</code> function (called whenever prefs are set or a pcap is loaded)</li>
<li>Register the protocol with a <a href="http://wiki.wireshark.org/LuaAPI/Dissector#DissectorTable"><code>DissectorTable</code></a> (inside <code>init()</code> if it exists).</li></ul>

<p>See example implementation of <a href="http://pastebin.com/Ladd847i"><code>proto_foo.lua</code></a></p></li>
<li><p>Start <code>tshark</code> or <code>Wireshark</code>. If the Lua script contained any syntax errors, an error message appears, and you'll have to edit the file and restart the program.</p></li>
<li><p>To quickly verify whether <em>Foo</em> was properly registered, enter <code>foo</code> in Wireshark's Display Filter Textbox, and confirm that it turns green.</p></li>
<li><p>To test your <em>Foo</em> dissector, start a Wireshark capture session, and generate traffic on the corresponding network interface. If using the example implementation of <em>Foo</em>, you can use <a href="http://en.wikipedia.org/wiki/Netcat">netcat</a> to generate a 21-byte UDP payload on port 3456 (assumes default network interface):</p></li>
</ol>

<blockquote>
<p><code>$ echo "123456789012345678901" | nc -w 1 -u 1.1.1.1 3456</code></p>
</blockquote>
<h2>How to write a Lua listener</h2>
<ol>
<li><p>Create a Lua file (named <code>tap_foo.lua</code>) at one of the following directories:</p>

<ul><li><code>C:\Program Files\Wireshark\plugins\1.6.8\</code> (<strong>Windows</strong>)</li>
<li><code>C:\Users\johndoe\AppData\Roaming\Wireshark\plugins\</code> (<strong>Windows</strong>)</li>
<li><code>$HOME/.wireshark/plugins/</code> (<strong>UN*X</strong>)</li></ul></li>
<li><p>In <code>tap_foo.lua</code>, do the following:</p>

<ul><li><p>Declare the tap with the <code>Listener(BuiltInTapName, DisplayFilter)</code> function.
You can use one of the built-in taps or create a new one that uses the specified display filter. The names of the built-in taps are: <code>ip</code>, <code>udp</code>, <code>http</code>, <code>bacapp</code>, <code>h225</code>, <code>actrace</code>, <code>ansi_a</code>, <code>ansi_map</code>, <code>eth</code>, <code>tcp</code>, <code>wlan</code>, <code>frame</code></p></li>
<li><p><em>(OPTIONAL)</em> Declare field extractors (with the <code>Field.new(FieldName)</code> function) to pull values of named fields from the current packet. These cannot be declared inside the packet function.</p></li>
<li><p>Declare the tap's <code>packet(Pinfo, Tvb, BuiltInTapData)</code> function.
This function is notified with every packet that matches the tap's filter. The function is passed the packet info (<code>pinfo</code>), buffer (<code>Tvb</code>), and built-in tap data (only if a built-in tap was specified during tap declaration).
For better performance, avoid any calls that would cause GUI repainting (e.g., adding items to a listview) in this function; reserve those for the draw function.</p></li>
<li><p><em>(OPTIONAL)</em> Declare the tap's <code>draw()</code> function.
This function is called periodically to notify any external GUI programs to draw the results (which were accumulated in the packet function). This is where you would do any fancy GUI stuff with Wireshark's <a href="http://wiki.wireshark.org/LuaAPI/GUI">GUI calls</a> or with, e.g., wxWidgets (via <a href="http://wxlua.sourceforge.net/">wxLua</a>) or Qt (via <a href="https://github.com/mkottman/lqt">lqt</a>).</p></li>
<li><p><em>(OPTIONAL)</em> Declare the tap's <code>reset()</code> function.
This function is called at the beginning and end of a capture run, where any initialization should be done if necessary to prepare for a new session. If your tap doesn't have any local state, then you don't need to implement this function.</p></li></ul>

<p>See example implementation of <a href="http://pastebin.com/2hLLMSq3"><code>tap_foo.lua</code></a> (requires <code>proto_foo.lua</code> above).</p></li>
<li><p>Start <code>tshark</code> or <code>Wireshark</code>. If the Lua script contained any syntax errors, an error message appears, and you'll have to edit the file and restart the program.</p></li>
<li><p>To test your <em>Foo</em> listener, start a Wireshark capture session, and generate traffic on the corresponding network interface. Alternatively, open a <code>pcap</code> file that contains packets of interest. If using the example implementation of <em>Foo</em>, you can use <code>tshark</code> as follows:</p></li>
</ol>

<blockquote>
<p><code>$ tshark -q -r foo.pcap -R foo</code></p>
</blockquote>
<p>This opens the file <code>foo.pcap</code> and filters for <em>Foo</em> packets. Assuming <code>tap_foo.lua</code> exists in one of the directories from Step 1, <code>tshark</code> automatically loads the listener, which processes the <code>foo</code> packets from <code>foo.pcap</code>. The example listener prints the value(s) of a specific field for each packet, so you can easily confirm that from the Wireshark Lua console (<strong>Tools &gt; Lua &gt; Console</strong>).</p>
<hr>
<h1>Loading a Lua script</h1>
<p>There are actually multiple ways to load a Wireshark Lua script. In the steps above, we used Option 2 described below (mostly because it's convenient).</p>
<h2>Option 1: Use <code>-Xlua_script:filename</code></h2>
<p>You can use the <code>-X</code> command-line parameter, specifying <code>lua_script</code> as the variable name and the path to the script as the variable value. For example, the following command loads the Lua script <code>foo.lua</code> from the current directory. Note that path can be relative or absolute, and the filename does not need to have the .lua extension.</p>
<pre><code>$ wireshark -X lua_script:foo.lua
</code></pre>
<h2>Option 2: Put the Lua script in the Lua initialization path</h2>
<p>You can put the Lua file in one of the directories that Wireshark/TShark scans at startup, and restart Wireshark/TShark.</p>
<p><strong>UN*X</strong></p>
<ul>
<li><code>/share/wireshark/plugins/foo.lua</code> (global)</li>
<li><code>$HOME/.wireshark/plugins/foo.lua</code> (user-specific)</li>
</ul>
<p><strong>Windows</strong></p>
<ul>
<li><code>%PROGRAMFILES%\Wireshark\plugins\%WIRESHARK_VERSION%\foo.lua</code> (global)</li>
<li><code>%APPDATA%\Roaming\Wireshark\plugins\foo.lua</code> (user-specific)</li>
</ul>
<h2>Option 3: Modify <code>init.lua</code> to load the file</h2>
<p>You can edit the global <a href="http://ask.wireshark.org/questions/10681/missing-basehex-definition-in-lua/10904"><code>init.lua</code></a> or the user-specific <code>$HOME/.wireshark/init.lua</code>.</p>
<p>For example, add the following to the end of <code>init.lua</code>: </p>
<pre><code>-- load the Foo module
dofile('/path/to/foo.lua')
</code></pre>
<p>This method allows the highest control during initialization (in case you need to control the load order); and allows putting the Lua files anywhere in the system. However, these files must not be in the Lua initialization path (where they'd automatically be loaded) or else you may encounter a registration error (e.g., from registering a protocol dissector with the same name twice).</p>
<hr>
<h1>Debugging a Lua script</h1>
<p>It's mostly a trial-and-error process: You edit the Lua script, load it in Wireshark/TShark, and troubleshoot any errors with print-outs or with Lua <code>debug</code>. The print-outs can be seen either from the Lua console in Wireshark (<strong>Tools &gt; Lua &gt; Console</strong>) or  from the terminal that started Wireshark/TShark.</p>
<p>The Lua <a href="http://www.lua.org/pil/23.html"><code>debug</code> library</a> provides an <a href="http://www.lua.org/manual/5.1/manual.html#pdf-debug.debug">API</a> that can be helpful. WSLua actually hides the <code>debug</code> symbol (likely unintentionally) with its own <a href="http://wiki.wireshark.org/LuaAPI/Utils#debug.28text.29"><code>debug()</code></a> function that prints to the Lua console (or <em>stdout</em>) at the <code>DEBUG</code> level. However, you can still access Lua <code>debug</code> by using the <code>require</code> keyword:</p>
<pre><code>local d = require 'debug'

-- print our traceback (like a stacktrace)
print(d.traceback())

-- enter the Lua debugger, which has this prompt:  lua_debug&gt;
-- (to exit, type 'cont')
d.debug()
</code></pre>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/11688/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>05 Jun '12, 14:51</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/362ba1008ad9a075d1556d33e97dfed6?s=32&amp;d=identicon&amp;r=g" alt="helloworld's gravatar image" />
    <p><a href="/users/817/helloworld">helloworld</a><br/>
    <span class="score" title="3149 reputation points"><span class="">3.1k</span></span><span title="4 badges"><span class="badge1">&#9679;</span><span class="badgecount">4</span></span><span title="20 badges"><span class="silver">&#9679;</span><span class="badgecount">20</span></span><span title="41 badges"><span class="bronze">&#9679;</span><span class="badgecount">41</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="helloworld has 28 accepted answers">28&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/11688/">
                edited
                <strong>05 Jun '12, 15:28</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-11688">
    
        <a name="11753"></a>
        <div class="comment" id="comment-11753">
            <div id="post-11753-score" class="comment-score"></div>
            <div class="comment-text"><p>VERY nice !! Thank you.</p></div>
            <div class="comment-info" id="comment-11753-info">
                
                
                
                

                

                <span class="comment-age">(08 Jun '12, 03:28)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-11688" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-11688-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="11365"></a>
                    <div id="answer-container-11365" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-11365-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/11365/up/" rel="nofollow"> </a>
<div id="post-11365-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-11365-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/11365/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>To me Lua in wireshark is one of it's most powerful features yet it's feels like best kept secret. 
It's difficult to find useful working samples </p>
<p>Here are some links I've found online overtime</p>
<p><a href="http://paperlined.org/apps/wireshark/ArchivedLuaExamples/">http://paperlined.org/apps/wireshark/ArchivedLuaExamples/</a></p>
<p><a href="http://code.google.com/p/lua-bitstring/wiki/ExplainFastDissect">http://code.google.com/p/lua-bitstring/wiki/ExplainFastDissect</a></p>
<p>I also thinks helloworld's code snippets on this portal are little gems that tought me quite a bit.</p>
<p>Checkout posts with lua tags on them.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/11365/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>25 May '12, 16:53</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/96df873546556d82f89c599816554877?s=32&amp;d=identicon&amp;r=g" alt="izopizo's gravatar image" />
    <p><a href="/users/370/izopizo">izopizo</a><br/>
    <span class="score" title="202 reputation points">202</span><span title="4 badges"><span class="badge1">&#9679;</span><span class="badgecount">4</span></span><span title="7 badges"><span class="silver">&#9679;</span><span class="badgecount">7</span></span><span title="14 badges"><span class="bronze">&#9679;</span><span class="badgecount">14</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="izopizo has no accepted answers">0&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-11365">
    
        <a name="11393"></a>
        <div class="comment" id="comment-11393">
            <div id="post-11393-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>I also thinks helloworld's code snippets on this portal are little gems that tought me quite a bit.</p>
</blockquote>

<p>I agree and I'm waiting for some "uninterrupted time to formulate a decent answer" :-)</p></div>
            <div class="comment-info" id="comment-11393-info">
                
                
                
                

                

                <span class="comment-age">(27 May '12, 02:02)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-11365" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-11365-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/11330/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='EvdLHUJgTh2qsf9xLAceIuvfzHnwKO8w' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/11330/lua-binding-integration-documentation?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/11330/lua-binding-integration-documentation?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/lua/"
            class="tag-link-lua"
            title="see questions tagged'lua'using tags"
            rel="tag">lua</a> <span class="tag-number">&#215;431</span><br/>
        
        <a href="/tags/documentation/"
            class="tag-link-documentation"
            title="see questions tagged'documentation'using tags"
            rel="tag">documentation</a> <span class="tag-number">&#215;5</span><br/>
        
    </p>
    <p>
        question asked: <strong title="May 25, 2012, 4:20 a.m.">25 May '12, 04:20</strong>
    </p>
    <p> 
     	question was seen: <strong>13,838 times</strong>
    </p>
    <p> 
        last updated: <strong title="Oct. 24, 2012, 9:15 p.m.">24 Oct '12, 21:15</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/570/crashing-issue-when-running-lua-dissector-after-upgrading-from-wireshark-100">Crashing issue when running Lua dissector after upgrading from wireshark 1.0.0</a>
        </p>
        
        <p>
            <a href="/questions/4410/create-my-own-dissector">Create my own dissector</a>
        </p>
        
        <p>
            <a href="/questions/5868/how-do-i-setup-wireshark-to-run-luas-clrpackage">How do I setup Wireshark to run Lua&#39;s CLRPackage</a>
        </p>
        
        <p>
            <a href="/questions/8328/order-of-entries-in-dissector-tables-at-startup-and-lua">Order of entries in dissector tables at startup and lua</a>
        </p>
        
        <p>
            <a href="/questions/9353/wireshark-lua-wireshark-version-problem">Wireshark Lua - Wireshark Version problem</a>
        </p>
        
        <p>
            <a href="/questions/11653/add-valuestring-value-to-column">add valuestring value to column</a>
        </p>
        
        <p>
            <a href="/questions/15933/lua-code-broke-after-update-to-wireshark-183">Lua code broke after update to wireshark 1.8.3</a>
        </p>
        
        <p>
            <a href="/questions/19865/how-do-i-run-a-lua-script-with-tshark">How do I run a Lua script with tshark?</a>
        </p>
        
        <p>
            <a href="/questions/23969/lua-api-packet-payload-info-column">LUA API packet payload (info column)</a>
        </p>
        
        <p>
            <a href="/questions/28507/how-to-install-wireshark-in-linux-to-support-lua">How to install wireshark in linux to support lua?</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
