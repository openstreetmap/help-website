<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Select ways with circular shape in PostGIS (roundabouts)? - OSM Help</title>
        <meta name="description" content="Hello. I need to create a PostGIS query that outputs roundabouts from OSM that have no &quot;junction&quot;=&quot;roundabout&quot; tag. Is there a function that returns true if a geometry has a circular shape? I have tried ST_HasArc but it doesn&#39;t seem to be working. Any other suggestion on how to find roundabouts with..." />
        <meta name="keywords" content="postgresql,roundabout,postgis" />
        
        <link rel="canonical" href="/questions/51440/select-ways-with-circular-shape-in-postgis-roundabouts" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/51440/select-ways-with-circular-shape-in-postgis-roundabouts?type=rss">

        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <link rel="shortcut icon" href="/upfiles/favicon_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.8.24/themes/base/jquery-ui.min.css" integrity="sha512-Lzjd1ELD6YCIwIU5uaJldvbibV5Fi7HThNZjrwJHALBJRT6q2a6ndgi8TNgcKcUqGsH6bpT7xyTEi8qRzN1ASg==" crossorigin="anonymous" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.4.4/jquery.min.js" integrity="sha512-tcexmm0PBc+jOn9UwbgHVpjZIleEKXif1MCkzgNfVjhXKDxwYumrCOxhZ5tIaXHz2DpEE14hfjFn5J+tpaFSCg==" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.8.24/jquery-ui.min.js" integrity="sha512-leN1LJ2B5s9cBINeKL5bbT3cQvOebXsezoYGyuMq9oaytpFJgJ1uBOU86lJZObKTFLbMHqP0zFXR/1N6Nnlskw==" crossorigin="anonymous"></script>
        <script type="text/javascript">
        /*<![CDATA[*/
            var i18nLang = 'en';
            var appUrl = 'https://help.openstreetmap.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="OSM Help Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/osm_help_logo_6.png" title="back to home page" alt="OpenStreetMap Help Forum logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        <!-- <a id="nav_ask" href="/questions/ask/" class="special">ask a question</a> -->
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <iframe src="https://duckduckgo.com/search.html?site=help.openstreetmap.org&prefill=Search questions using DuckDuckGo&focus=yes" style="overflow:hidden;margin:0;padding:0;width:408px;height:40px;" frameborder="0"></iframe>
    <!--
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='PTzjtVRDXSBdMSxl6ypMGzz74FS35SW3' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
    -->
	</div>

	
  <div id="announcement">
      <p>NOTICE: <a href="https://community.openstreetmap.org/t/archiving-of-help-openstreetmap-org-1st-march-2024/108483">help.openstreetmap.org is no longer in use from 1st March 2024</a>. Please use the <a href="https://community.openstreetmap.org/">OpenStreetMap Community Forum</a></p>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/51440/select-ways-with-circular-shape-in-postgis-roundabouts">Select ways with circular shape in PostGIS (roundabouts)?</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-51440-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/51440/up/" rel="nofollow"> </a>
<div id="post-51440-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-51440-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/51440/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/51440/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hello. I need to create a PostGIS query that outputs roundabouts from OSM that have no "junction"="roundabout" tag. Is there a function that returns true if a geometry has a circular shape? I have tried <a href="http://postgis.net/docs/ST_HasArc.html">ST_HasArc</a> but it doesn't seem to be working. Any other suggestion on how to find roundabouts with missing "junction"="roundabout" tag is welcomed. </p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/postgresql/" class="post-tag tag-link-postgresql"
                                        title="see questions tagged 'postgresql'" rel="tag">postgresql</a>
                                
                                    <a href="/tags/roundabout/" class="post-tag tag-link-roundabout"
                                        title="see questions tagged 'roundabout'" rel="tag">roundabout</a>
                                
                                    <a href="/tags/postgis/" class="post-tag tag-link-postgis"
                                        title="see questions tagged 'postgis'" rel="tag">postgis</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>16 Aug '16, 11:58</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/0464ec5533673976b9a83b8bfaab3c03?s=32&amp;d=identicon&amp;r=g" alt="manuela_butuc's gravatar image" />
    <p><a href="/users/12617/manuela_butuc">manuela_butuc</a><br/>
    <span class="score" title="156 reputation points">156</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="5 badges"><span class="silver">&#9679;</span><span class="badgecount">5</span></span><span title="9 badges"><span class="bronze">&#9679;</span><span class="badgecount">9</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="manuela_butuc has one accepted answer">100&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/51440/">
                edited
                <strong>16 Aug '16, 13:33</strong>
            </a>
        </p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-51440">
    
        <a name="51442"></a>
        <div class="comment" id="comment-51442">
            <div id="post-51442-score" class="comment-score"></div>
            <div class="comment-text"><p>You could try to search for ways that have a highway tag and the same first and last node. Won't work for roundabouts that consist of multiple ways though.</p></div>
            <div class="comment-info" id="comment-51442-info">
                
                
                
                

                

                <span class="comment-age">(16 Aug '16, 14:29)</span>
                <a class="comment-user userinfo" href="/users/158/scai">scai ♦</a>
                
            </div>
        </div>
    
        <a name="51444"></a>
        <div class="comment" id="comment-51444">
            <div id="post-51444-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes, i did that already, using ST_IsClosed function, but it's still not enough. I need something that goes more into detail</p></div>
            <div class="comment-info" id="comment-51444-info">
                
                
                
                

                

                <span class="comment-age">(16 Aug '16, 15:11)</span>
                <a class="comment-user userinfo" href="/users/12617/manuela_butuc">manuela_butuc</a>
                
            </div>
        </div>
    
        <a name="51454"></a>
        <div class="comment" id="comment-51454">
            <div id="post-51454-score" class="comment-score"></div>
            <div class="comment-text"><p>I suspect that this is very hard: there will be far too many edge cases to manage (for instance roundabout entrances &amp; exits mapped to the same node; non-round roundabouts etc.)</p></div>
            <div class="comment-info" id="comment-51454-info">
                
                
                
                

                

                <span class="comment-age">(16 Aug '16, 19:01)</span>
                <a class="comment-user userinfo" href="/users/647/sk53">SK53 ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-51440" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-51440-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    3 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/51440/select-ways-with-circular-shape-in-postgis-roundabouts?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/51440/select-ways-with-circular-shape-in-postgis-roundabouts?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/51440/select-ways-with-circular-shape-in-postgis-roundabouts?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/51440/select-ways-with-circular-shape-in-postgis-roundabouts?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="51490"></a>
                    <div id="answer-container-51490" class="answer accepted-answer answered-by-owner">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-51490-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/51490/up/" rel="nofollow"> </a>
<div id="post-51490-score" class="post-score"
    title="current number of votes">
    5
</div>
<a id="post-51490-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/51490/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="SomeoneElse has selected this answer as the correct answer"
        href="/accept_answer/51490/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>After 2 days of trials, I think I have found a way around this problem. 
This is what I did:</p>
<ul>
<li>
<p>selected only navigable roads (highways without pedestrian,
   footway, etc)</p>
</li>
<li>
<p>used the ST_IsClosed function to find only closed ways</p>
</li>
<li>
<p>selected only those ways that have between 7 and 40 nodes</p>
</li>
<li>
<p>selected only ways that have less than 500 m in length (could have gone lower, probably)</p>
</li>
<li>
<p>I created a centroid for each of the remaining ways with ST_Centroid function</p>
</li>
<li>
<p>I calculated the distance between each centroid and the nodes on the corresponding way</p>
</li>
<li>
<p>I calculated the standard deviation for the distances (centroid-&gt;nodes) and got numbers between 0.0001 and 0.267</p>
</li>
<li>
<p>I chose only the ways that have a standard deviation of maximum 0.08 (this is just a number I came up with after surveying the results)</p>
</li>
</ul>
<p>I don't have a clean script to post right now, as I used many intermediate tables, but I plan to make one and post it on Github if anyone else is interested in finding roundabouts :)
If you have suggestion of any other filters I could use to make the output even more accurate, i'm happy to read them!</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/51490/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>17 Aug '16, 13:18</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/0464ec5533673976b9a83b8bfaab3c03?s=32&amp;d=identicon&amp;r=g" alt="manuela_butuc's gravatar image" />
    <p><a href="/users/12617/manuela_butuc">manuela_butuc</a><br/>
    <span class="score" title="156 reputation points">156</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="5 badges"><span class="silver">&#9679;</span><span class="badgecount">5</span></span><span title="9 badges"><span class="bronze">&#9679;</span><span class="badgecount">9</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="manuela_butuc has one accepted answer">100&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/51490/">
                edited
                <strong>17 Aug '16, 13:21</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-51490">
    
        <a name="51495"></a>
        <div class="comment not_top_scorer" id="comment-51495">
            <div id="post-51495-score" class="comment-score"></div>
            <div class="comment-text"><p>I will also calculate the distance between nodes of the way to see if they are similar, because the standard deviation for the distance between centroid&amp;nodes is not enough to find roundabouts, it outputs ways like this one: <a href="https://postimg.org/image/l9ncwfo2x/">https://postimg.org/image/l9ncwfo2x/</a></p></div>
            <div class="comment-info" id="comment-51495-info">
                
                
                
                

                

                <span class="comment-age">(17 Aug '16, 14:26)</span>
                <a class="comment-user userinfo" href="/users/12617/manuela_butuc">manuela_butuc</a>
                
            </div>
        </div>
    
        <a name="51500"></a>
        <div class="comment" id="comment-51500">
            <div id="post-51500-score" class="comment-score">5</div>
            <div class="comment-text"><p>Impressed with the ingenuity!</p>

<p>I wonder if <a href="http://postgis.net/docs/ST_MinimumBoundingCircle.html">http://postgis.net/docs/ST_MinimumBoundingCircle.html</a> might be useful as well.</p></div>
            <div class="comment-info" id="comment-51500-info">
                
                
                
                

                

                <span class="comment-age">(17 Aug '16, 17:24)</span>
                <a class="comment-user userinfo" href="/users/5/richard">Richard ♦</a>
                
            </div>
        </div>
    
        <a name="51501"></a>
        <div class="comment" id="comment-51501">
            <div id="post-51501-score" class="comment-score">2</div>
            <div class="comment-text"><p>Years ago, I played with ST_Azimuth to find the maximum angle between three points. Underlying assumption was that roundabouts shouldn't have e.g. 90 degree angles in there. The idea is to choose some cut off maximum angle when querying data. Code is here: <a href="http://pastebin.com/nvZ3YrEF">http://pastebin.com/nvZ3YrEF</a></p></div>
            <div class="comment-info" id="comment-51501-info">
                
                
                
                

                

                <span class="comment-age">(17 Aug '16, 18:53)</span>
                <a class="comment-user userinfo" href="/users/8708/mmd">mmd</a>
                
            </div>
        </div>
    
        <a name="51503"></a>
        <div class="comment" id="comment-51503">
            <div id="post-51503-score" class="comment-score">1</div>
            <div class="comment-text"><p><a href="https://help.openstreetmap.org/users/12617/manuela_butuc">@manuela_butuc</a> I've accepted this as an answer on your behalf (since you can't accept your own answers).  Hope this is OK...</p></div>
            <div class="comment-info" id="comment-51503-info">
                
                
                
                

                

                <span class="comment-age">(17 Aug '16, 19:26)</span>
                <a class="comment-user userinfo" href="/users/387/someoneelse">SomeoneElse ♦</a>
                
            </div>
        </div>
    
        <a name="51513"></a>
        <div class="comment" id="comment-51513">
            <div id="post-51513-score" class="comment-score">2</div>
            <div class="comment-text"><p><a href="https://help.openstreetmap.org/users/5/richard">@Richard</a> ♦ I read what that function does but I don't think it can help me with the roundabouts. Anyways, good to know it exists!</p>

<p><a href="https://help.openstreetmap.org/users/8708/mmd">@mmd</a> Thanks for the code snippet, it actually helped a lot!</p></div>
            <div class="comment-info" id="comment-51513-info">
                
                
                
                

                

                <span class="comment-age">(18 Aug '16, 08:59)</span>
                <a class="comment-user userinfo" href="/users/12617/manuela_butuc">manuela_butuc</a>
                
            </div>
        </div>
    
        <a name="51517"></a>
        <div class="comment" id="comment-51517">
            <div id="post-51517-score" class="comment-score">1</div>
            <div class="comment-text"><p>Great piece of work. Would love to see it written up in a bit more detail (specifically with images of what gets selected &amp; what gets rejected).</p></div>
            <div class="comment-info" id="comment-51517-info">
                
                
                
                

                

                <span class="comment-age">(18 Aug '16, 10:17)</span>
                <a class="comment-user userinfo" href="/users/647/sk53">SK53 ♦</a>
                
            </div>
        </div>
    
        <a name="51661"></a>
        <div class="comment not_top_scorer" id="comment-51661">
            <div id="post-51661-score" class="comment-score"></div>
            <div class="comment-text"><p>Wouldn't it make more sense to just treat it as a polygon and then calculate perimeter/sqrt(area) ratio? If it's close to minimal theoretical value (and has &gt;=6 nodes), then you probably have a circle.</p>

<p>Consider also, that roundabouts may get divided into multiple ways for route relations.</p></div>
            <div class="comment-info" id="comment-51661-info">
                
                
                
                

                

                <span class="comment-age">(23 Aug '16, 00:29)</span>
                <a class="comment-user userinfo" href="/users/7562/ricoelectrico">RicoElectrico</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-51490" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 7
        </span>
        <a href="#" class="show-all-comments-link">show 2 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-51490-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="55568"></a>
                    <div id="answer-container-55568" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-55568-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/55568/up/" rel="nofollow"> </a>
<div id="post-55568-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-55568-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/55568/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Here's a PostGIS script doing just that: <a href="https://github.com/TelenavMapping/useful-postgis-queries/blob/master/sql-queries/detect_possible_roundabouts.sql">https://github.com/TelenavMapping/useful-postgis-queries/blob/master/sql-queries/detect_possible_roundabouts.sql</a>
Enjoy!</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/55568/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>11 Apr '17, 18:07</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/e26832004245996d0586eb01f4716fdc?s=32&amp;d=identicon&amp;r=g" alt="manuelab_telenav's gravatar image" />
    <p><a href="/users/13583/manuelab_telenav">manuelab_tel...</a><br/>
    <span class="score" title="31 reputation points">31</span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="bronze">&#9679;</span><span class="badgecount">1</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="manuelab_telenav has no accepted answers">0&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-55568">
    
</div>
<div id="comment-tools-55568" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-55568-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="51653"></a>
                    <div id="answer-container-51653" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-51653-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/51653/up/" rel="nofollow"> </a>
<div id="post-51653-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-51653-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/51653/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Many of us, vector map-makers, do this roundabout recognition, and we do it from the times even before the OSM has been born. There are at least two basic reasons to that: </p>
<ul>
<li>to provide more complete and safer turn-by-turn navigation network; and</li>
<li>when creating the vector scale levels, roundabouts quickly transform to ordinary nodes.   </li>
</ul>
<p>In addition to the answer and comments already provided I would rather add some hints/suggestions based on experience running data-preparation on OSM dumps though the numbers are some months old (I do not register them for every run/OSM dump). </p>
<p>The preparation-tool runs separately on any of the road classes (motorway, trunk, primary, secondary, tertiary, living-street and street) and detects way classes RAC (ways tagged as roundabout) and ORC (the rest or the ordinary roads, not tagged as roundabouts). </p>
<p>Within RAC, we create the roundabout (RA) class (single circular ways or end-to-end connected ways creating circular ways). Now, for the RA class we detect some 5-7 (average/statistical) parameters like the number of edges, the length of the edge, the convexity, the diameter and so on. Finally, within the RAC we detect:    </p>
<ul>
<li>The safe roundabout (SRA) class (253480 objects for all road classes). These are elements of RA having parameters close to the average values;    </li>
<li>The unsafe roundabout (URA) class (6875), those from RA having at least one parameter far from the average value (outside the tolerance). This unsafe class of RA contains roundabouts wit anomalies as well (with self-crossings, more than one round between the start and end nodes, isolated, having more than one section between two nodes, zig-zag consecutive edges and so on);    </li>
<li>The geo-rec based (GRA) class (708). This are created from the incomplete roundabouts where adding one or two short poly-line sections we create a safe roundabout; finally</li>
<li>The erroneous objects in RAC (2195). These are ways recognized as ordinary/feeding roads obviously tagged as roundabouts by mistake. This road segments are missing sections in ORC and therefor they are added to the ORC before further processing.  <br>
-Within the ORC we detect circular single ways that closely (perfectly) match the corresponding safe SRA parameters. There were totally 101803 such cases, let us say, ordinary road roundabouts (ORRA).  <br>
-Finally, in a similar way as for GRA we detect some 19547 geo-rec based roundabouts (GORRA) from the ORC class (with high probability also roundabouts).    </li>
</ul>
<p>Within any of the mentioned road types, we merge the described five roundabout classes to a final set of roundabouts. These are the input to further preparation, data generalisation, rooting …    </p>
<p>Note that the last two roundabout sets (ORRA and GORRA) contain large number of turning-circles. Visual inspection on a large sample shows that mappers are having dilemma how to tag/upload these kinds of objects. At the same time qualifying turning-circles as roundabouts should not confuse robust line-following/rooting systems.    </p>
<p>If interested, some more details can be found from my earlier OSM-dev and OSM-rooting forum discussions/posts here <a href="https://drive.google.com/open?id=0B6qGm3k2qWHqRVVXVVFwbVdtN1E">https://drive.google.com/open?id=0B6qGm3k2qWHqRVVXVVFwbVdtN1E</a></p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/51653/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>22 Aug '16, 20:27</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/03cd9ea0efd97a7040fda0d6a76aba8e?s=32&amp;d=identicon&amp;r=g" alt="sanser's gravatar image" />
    <p><a href="/users/3194/sanser">sanser</a><br/>
    <span class="score" title="695 reputation points">695</span><span title="38 badges"><span class="badge1">&#9679;</span><span class="badgecount">38</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="55 badges"><span class="bronze">&#9679;</span><span class="badgecount">55</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="sanser has 2 accepted answers">5&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/51653/">
                edited
                <strong>23 Aug '16, 08:31</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/06cd84075f1adc2870ad102c7233e661?s=32&amp;d=identicon&amp;r=g" alt="SK53's gravatar image" />
            <p><a href="/users/647/sk53">SK53 ♦</a><br/>
            <span class="score" title="28084 reputation points"><span class="">28.1k</span></span><span title="48 badges"><span class="badge1">&#9679;</span><span class="badgecount">48</span></span><span title="268 badges"><span class="silver">&#9679;</span><span class="badgecount">268</span></span><span title="433 badges"><span class="bronze">&#9679;</span><span class="badgecount">433</span></span></p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-51653">
    
</div>
<div id="comment-tools-51653" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-51653-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/51440/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='PTzjtVRDXSBdMSxl6ypMGzz74FS35SW3' />
            <div style="clear:both">
            </div>

            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/51440/select-ways-with-circular-shape-in-postgis-roundabouts?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/51440/select-ways-with-circular-shape-in-postgis-roundabouts?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <p>This was the support site for <a href="https://www.openstreetmap.org/">OpenStreetMap</a>. It has now been replaced by <a href="https://community.openstreetmap.org/">community.osm.org</a>.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/postgresql/"
            class="tag-link-postgresql"
            title="see questions tagged'postgresql'using tags"
            rel="tag">postgresql</a> <span class="tag-number">&#215;165</span><br/>
        
        <a href="/tags/postgis/"
            class="tag-link-postgis"
            title="see questions tagged'postgis'using tags"
            rel="tag">postgis</a> <span class="tag-number">&#215;134</span><br/>
        
        <a href="/tags/roundabout/"
            class="tag-link-roundabout"
            title="see questions tagged'roundabout'using tags"
            rel="tag">roundabout</a> <span class="tag-number">&#215;36</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Aug. 16, 2016, 11:58 a.m.">16 Aug '16, 11:58</strong>
    </p>
    <p> 
     	question was seen: <strong>4,427 times</strong>
    </p>
    <p> 
        last updated: <strong title="April 11, 2017, 6:07 p.m.">11 Apr '17, 18:07</strong>
    </p>
</div>



<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/12318/why-is-my-import-of-planet-latestosm-killed">Why is my import of planet-latest.osm KILLED?</a>
        </p>
        
        <p>
            <a href="/questions/13124/how-to-find-the-polygon">How to find the polygon?</a>
        </p>
        
        <p>
            <a href="/questions/10677/setting-postgis-as-a-datasource">Setting PostGIS as a datasource</a>
        </p>
        
        <p>
            <a href="/questions/11405/xmlpostgresql-rendering">XML/Postgresql Rendering</a>
        </p>
        
        <p>
            <a href="/questions/12388/best-way-to-get-all-cities-of-a-specific-area">Best way to get all cities of a specific area?</a>
        </p>
        
        <p>
            <a href="/questions/3988/speeding-up-openstreetmap-postgis-querying">Speeding up OpenStreetMap PostGIS querying</a>
        </p>
        
        <p>
            <a href="/questions/7179/how-can-i-extract-some-linestring-consisted-of-3-or-more-points-to-several-linestrings-each-by-2-points-in-postgis">[closed] How can I extract some LINESTRING consisted of 3 or more POINTs to several LINESTRINGs each by 2 POINTs in PostGIS</a>
        </p>
        
        <p>
            <a href="/questions/10671/osm-postgis-mapnik-problem">OSM – PostGIS – Mapnik problem!</a>
        </p>
        
        <p>
            <a href="/questions/11357/rendering-imagesmaps-from-postgresqlpostgis-database">Rendering images/maps from Postgresql/PostGIS Database</a>
        </p>
        
        <p>
            <a href="/questions/15926/compile-errors-installing-nominatim">Compile errors installing Nominatim</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            
            <div id="ground">
                
                    <p>NOTICE: <a href="https://community.openstreetmap.org/t/archiving-of-help-openstreetmap-org-1st-march-2024/108483">help.openstreetmap.org is no longer in use from 1st March 2024</a>. Please use the <a href="https://community.openstreetmap.org/">OpenStreetMap Community Forum</a></p>
                
            </div>
            
        
        

        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
