<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Detect which user is making requests - Wireshark Q&amp;A</title>
        <meta name="description" content="Hello, I have an Ubuntu virtual machine where my developers are logging in to connect. I am using WireShark to be able to monitor if they are trying to upload/send the code somewhere else, as it is forbidden. Having more than one users on the same servers, how could i detect which one is trying to u..." />
        <meta name="keywords" content="detect,traffic,user,network" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/55279/detect-which-user-is-making-requests" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/55279/detect-which-user-is-making-requests?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='bE31oDGNUoGULIIUVKbg0ZYy7JTwNb0h' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/55279/detect-which-user-is-making-requests">Detect which user is making requests</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-55279-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/55279/up/" rel="nofollow"> </a>
<div id="post-55279-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-55279-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/55279/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/55279/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hello,</p>
<p>I have an Ubuntu virtual machine where my developers are logging in to connect. I am using WireShark to be able to monitor if they are trying to upload/send the code somewhere else, as it is forbidden.</p>
<p>Having more than one users on the same servers, how could i detect which one is trying to upload the file? I am looking in the traffic log and i cannot see anything about the system user.</p>
<p>Is that possible?</p>
<p>Thanks</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/detect/" class="post-tag tag-link-detect"
                                        title="see questions tagged 'detect'" rel="tag">detect</a>
                                
                                    <a href="/tags/traffic/" class="post-tag tag-link-traffic"
                                        title="see questions tagged 'traffic'" rel="tag">traffic</a>
                                
                                    <a href="/tags/user/" class="post-tag tag-link-user"
                                        title="see questions tagged 'user'" rel="tag">user</a>
                                
                                    <a href="/tags/network/" class="post-tag tag-link-network"
                                        title="see questions tagged 'network'" rel="tag">network</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>02 Sep '16, 03:52</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/1b7877c3f563ce8aaa31cbef15456c81?s=32&amp;d=identicon&amp;r=g" alt="alexsmith's gravatar image" />
    <p><a href="/users/25217/alexsmith">alexsmith</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="4 badges"><span class="bronze">&#9679;</span><span class="badgecount">4</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="alexsmith has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-55279">
    
        <a name="55291"></a>
        <div class="comment" id="comment-55291">
            <div id="post-55291-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<blockquote>
<p>how could i detect which one is trying to upload the file?</p>
</blockquote>
</blockquote>

<p>It's not obvious that you can without adding things to the system.  If I understand correctly, you want to link a user to some information in some network traffic.  If the user just executes a command to move data, not sure that link exists.  Maybe you could detect that a specific command was invoked in the Linux system logs by a user, but not sure that would catch everything.  If they used a different command that you are not aware of yet, you might miss it.</p>

<p>What I could imagine adding to your network is an authenticated outbound proxy.  This way, if that VM wants to access the Internet, the only way to do so is through a proxy which authenticates the user.  This would force a link between a user - assuming all your users have unique usernames/passwords and good security practice says they do - and network traffic outbound.</p></div>
            <div class="comment-info" id="comment-55291-info">
                
                
                
                

                

                <span class="comment-age">(02 Sep '16, 06:12)</span>
                <a class="comment-user userinfo" href="/users/112/bob-jones">Bob Jones</a>
                
            </div>
        </div>
    
        <a name="55293"></a>
        <div class="comment" id="comment-55293">
            <div id="post-55293-score" class="comment-score"></div>
            <div class="comment-text"><p>I already have that. All users connect through a VNC and they have a different port.</p></div>
            <div class="comment-info" id="comment-55293-info">
                
                
                
                

                

                <span class="comment-age">(02 Sep '16, 06:42)</span>
                <a class="comment-user userinfo" href="/users/25217/alexsmith">alexsmith</a>
                
            </div>
        </div>
    
        <a name="55301"></a>
        <div class="comment" id="comment-55301">
            <div id="post-55301-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<blockquote>
<p>I already have that. All users connect through a VNC and they have a different port.</p>
</blockquote>
</blockquote>

<p>But this inbound.  You can identify a user coming in, then, I guess.  What if they try to use someone else's port?  Do you link entered credentials, per user, to a specific port?  Or are you depending on the user obeying your precise instructions to use only a certain port?  As you probably know, expecting malicious users to obey your instructions all the time is not a good assumption.  Sounds like some companies I know and their approach to Cybersecurity - we told people not to hack us in our user guide, so we must be secure!</p>

<p>Anyway I am not sure that is your issue.  You need to track outbound traffic if you are worried about someone pushing data out of the system.  How about just blocking all outbound traffic not related to VNC?  I don't know what access they need otherwise, so this may not be a valid solution.  <br>
</p>

<p>Does VNC allow copy/paste from remote to local (I think so, but don't really use it)?  If it does, then is there really anything you can do about this?  I would just copy the content out of the remote system you want protected and paste locally, then upload wherever I want.  No amount of access control at your secure end will prevent that.</p></div>
            <div class="comment-info" id="comment-55301-info">
                
                
                
                

                

                <span class="comment-age">(02 Sep '16, 09:17)</span>
                <a class="comment-user userinfo" href="/users/112/bob-jones">Bob Jones</a>
                
            </div>
        </div>
    
        <a name="55302"></a>
        <div class="comment" id="comment-55302">
            <div id="post-55302-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes, user credentials are linked to a specific port. They cannot use their credentials to connect to a different user's port, only if the other users shares their credentials with them, which is forbidden. Now we are only depending on them to not share their credentials, or they will be fired if they do that.</p>

<p>Yes, exactly, i need to track outbound traffic. It's not a good choice to block all outbound traffic because they are web developers and they need to be able to access a browser on their virtual machine for development purposes. Also they need to be able to commit their code to our Git server.</p>

<p>Yes, some VNC clients allow copy/paste, but only text, not files. Which is fine because we have thousands and thousands of files, so they won't go and copy/paste the contents of each file one by one.. They'd have to be insane lol.</p></div>
            <div class="comment-info" id="comment-55302-info">
                
                
                
                

                

                <span class="comment-age">(02 Sep '16, 09:23)</span>
                <a class="comment-user userinfo" href="/users/25217/alexsmith">alexsmith</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-55279" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-55279-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
        <form id="fmanswer" action="/questions/55279/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='bE31oDGNUoGULIIUVKbg0ZYy7JTwNb0h' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Be the first one to answer this question!
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/55279/detect-which-user-is-making-requests?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/55279/detect-which-user-is-making-requests?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/network/"
            class="tag-link-network"
            title="see questions tagged'network'using tags"
            rel="tag">network</a> <span class="tag-number">&#215;146</span><br/>
        
        <a href="/tags/traffic/"
            class="tag-link-traffic"
            title="see questions tagged'traffic'using tags"
            rel="tag">traffic</a> <span class="tag-number">&#215;115</span><br/>
        
        <a href="/tags/user/"
            class="tag-link-user"
            title="see questions tagged'user'using tags"
            rel="tag">user</a> <span class="tag-number">&#215;10</span><br/>
        
        <a href="/tags/detect/"
            class="tag-link-detect"
            title="see questions tagged'detect'using tags"
            rel="tag">detect</a> <span class="tag-number">&#215;4</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Sept. 2, 2016, 3:52 a.m.">02 Sep '16, 03:52</strong>
    </p>
    <p> 
     	question was seen: <strong>1,875 times</strong>
    </p>
    <p> 
        last updated: <strong title="Sept. 2, 2016, 9:25 a.m.">02 Sep '16, 09:25</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/38204/how-to-identify-des-traffic">How to Identify DES traffic?</a>
        </p>
        
        <p>
            <a href="/questions/32753/help-summarising-server-network-traffic">help summarising server network traffic</a>
        </p>
        
        <p>
            <a href="/questions/41371/what-kind-of-traffic-is-bad-trafficuseless">What kind of traffic is bad traffic(Useless)?</a>
        </p>
        
        <p>
            <a href="/questions/55969/any-recomendation-for-a-monitor-port-forwading-switch">any recomendation for a monitor port forwading switch</a>
        </p>
        
        <p>
            <a href="/questions/16169/need-help-decoding-network-traffic">Need help decoding network traffic.</a>
        </p>
        
        <p>
            <a href="/questions/16495/which-is-best-tool-for-network-traffic-dumping-reading-the-same-and-again-sending-it-back-to-the-network">Which is best tool for network traffic dumping, reading the same and again sending it back to the network</a>
        </p>
        
        <p>
            <a href="/questions/8975/seeing-traffic-from-other-machines-on-a-switched-network">Seeing traffic from other machines on a switched network</a>
        </p>
        
        <p>
            <a href="/questions/27519/capture-traffic-on-iphone-connected-to-pc-thru-usb-hotspot-interface">Capture traffic on iPhone connected to PC thru USB hotspot interface</a>
        </p>
        
        <p>
            <a href="/questions/5270/can-i-see-where-traffic-is-coming-from">Can I see where traffic is coming from</a>
        </p>
        
        <p>
            <a href="/questions/37390/traffic-analysis-using-wireshark">Traffic analysis using wireshark</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
