<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Displaying gaps or drops in private UDP sequence numbers - Wireshark Q&amp;A</title>
        <meta name="description" content="I&#39;ve seen several topics here that relate to this issue, but none of the solutions have worked for me so far, so hopefully someone can point out where I&#39;m going wrong. I have a capture with 4 separate UDP streams being received on 4 well known ports, 30300 - 30303. The UDP packets have a private &quot;se..." />
        <meta name="keywords" content="lua,udp,dissector,tap,sequence" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/24594/displaying-gaps-or-drops-in-private-udp-sequence-numbers" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/24594/displaying-gaps-or-drops-in-private-udp-sequence-numbers?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='0PNR7HvkQBNWILv0lAi4FLduJVzPHqXm' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/24594/displaying-gaps-or-drops-in-private-udp-sequence-numbers">Displaying gaps or drops in private UDP sequence numbers</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-24594-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/24594/up/" rel="nofollow"> </a>
<div id="post-24594-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-24594-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/24594/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/24594/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>I've seen several topics here that relate to this issue, but none of the solutions have worked for me so far, so hopefully someone can point out where I'm going wrong.</p>
<p>I have a capture with 4 separate UDP streams being received on 4 well known ports, 30300 - 30303.</p>
<p>The UDP packets have a private "sequence number" that increments monotonically for each port.</p>
<p>I've been able to write a dissector in Lua that highlights that sequence number, but want to go to the next step: highlighting or somehow calling out packets just after a packet drop has been detected, indicated by a break in the sequence.</p>
<p>Here's my attempt so far: <a href="http://pastebin.com/nL9TCPWq">http://pastebin.com/nL9TCPWq</a></p>
<p>I've seen discussions indicating a Tap may be more appropriate for this purpose, but haven't found any Lua examples as yet.</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/lua/" class="post-tag tag-link-lua"
                                        title="see questions tagged 'lua'" rel="tag">lua</a>
                                
                                    <a href="/tags/udp/" class="post-tag tag-link-udp"
                                        title="see questions tagged 'udp'" rel="tag">udp</a>
                                
                                    <a href="/tags/dissector/" class="post-tag tag-link-dissector"
                                        title="see questions tagged 'dissector'" rel="tag">dissector</a>
                                
                                    <a href="/tags/tap/" class="post-tag tag-link-tap"
                                        title="see questions tagged 'tap'" rel="tag">tap</a>
                                
                                    <a href="/tags/sequence/" class="post-tag tag-link-sequence"
                                        title="see questions tagged 'sequence'" rel="tag">sequence</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>11 Sep '13, 16:09</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/c24f943b37470fb3c3ad80d4cbb1a919?s=32&amp;d=identicon&amp;r=g" alt="Gordon%20Marler's gravatar image" />
    <p><a href="/users/5637/gordon-marler">Gordon Marler</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">&#9679;</span><span class="badgecount">3</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Gordon Marler has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-24594">
    
</div>
<div id="comment-tools-24594" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-24594-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/24594/displaying-gaps-or-drops-in-private-udp-sequence-numbers?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/24594/displaying-gaps-or-drops-in-private-udp-sequence-numbers?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/24594/displaying-gaps-or-drops-in-private-udp-sequence-numbers?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/24594/displaying-gaps-or-drops-in-private-udp-sequence-numbers?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="24617"></a>
                    <div id="answer-container-24617" class="answer accepted-answer">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-24617-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/24617/up/" rel="nofollow"> </a>
<div id="post-24617-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-24617-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/24617/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="Gordon Marler has selected this answer as the correct answer"
        href="/accept_answer/24617/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>The code looks like it could work. So, what is your question?</p>
<p>BTW: why </p>
<blockquote>
<p>port_seq[port_str] = { seq }</p>
</blockquote>
<p>instead of </p>
<blockquote>
<p>port_seq[port_str] = seq</p>
</blockquote>
<p>??</p>
<p>Regards<br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/24617/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>12 Sep '13, 14:15</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-24617">
    
        <a name="24660"></a>
        <div class="comment" id="comment-24660">
            <div id="post-24660-score" class="comment-score"></div>
            <div class="comment-text"><p>That was a mistake, probably an attempt to build a nested table initially, which wasn't necessary.  I've corrected it as you've shown.</p>

<p>As to my question, through various trial and error, the script seems to just stop at this line, where I try to increment the last sequence number and store it in expected:</p>

<blockquote>
local expected = port_seq[port_str] + 1
</blockquote>

<p>I'm wondering if the value I extracted from the packet with buffer(8,8) as the sequence number is actually being interpreted as an integer.</p></div>
            <div class="comment-info" id="comment-24660-info">
                
                
                
                

                

                <span class="comment-age">(13 Sep '13, 15:35)</span>
                <a class="comment-user userinfo" href="/users/5637/gordon-marler">Gordon Marler</a>
                
            </div>
        </div>
    
        <a name="24671"></a>
        <div class="comment" id="comment-24671">
            <div id="post-24671-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>as the sequence number is actually being interpreted as an integer.</p>
</blockquote>

<p>good question. Impossible to answer without a sample capture file ;-) Can you please post one on google drive, dropbox or cloudshark?</p></div>
            <div class="comment-info" id="comment-24671-info">
                
                
                
                

                

                <span class="comment-age">(14 Sep '13, 04:20)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="24809"></a>
        <div class="comment" id="comment-24809">
            <div id="post-24809-score" class="comment-score"></div>
            <div class="comment-text"><p>That makes sense - here's a sample capture:</p>

<p><a href="http://www.cloudshark.org/captures/78f060054941">dropped-test.pcapng</a></p></div>
            <div class="comment-info" id="comment-24809-info">
                
                
                
                

                

                <span class="comment-age">(17 Sep '13, 04:26)</span>
                <a class="comment-user userinfo" href="/users/5637/gordon-marler">Gordon Marler</a>
                
            </div>
        </div>
    
        <a name="24812"></a>
        <div class="comment not_top_scorer" id="comment-24812">
            <div id="post-24812-score" class="comment-score"></div>
            <div class="comment-text"><p>The first 8 bytes are not a counter in any way, as the bytes are the same for every frame, and I can't see any other byte sequence that increments in a detectable/predictable way. </p>

<p>So, where exactly is that sequence number within the frame?</p></div>
            <div class="comment-info" id="comment-24812-info">
                
                
                
                

                

                <span class="comment-age">(17 Sep '13, 05:22)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="24822"></a>
        <div class="comment" id="comment-24822">
            <div id="post-24822-score" class="comment-score">1</div>
            <div class="comment-text"><p>hold on. My mistake. I was looking at the beginning of the UDP payload, whereas in the code it says: at byte 8. O.K. then there is an increasing seq number. I'll have to check how that gets read by the lua code.</p></div>
            <div class="comment-info" id="comment-24822-info">
                
                
                
                

                

                <span class="comment-age">(17 Sep '13, 07:17)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="24826"></a>
        <div class="comment not_top_scorer" id="comment-24826">
            <div id="post-24826-score" class="comment-score"></div>
            <div class="comment-text"><p>strange thing.</p>

<p>If you change the code to this:</p>

<pre>                    warn("P#1")
                local expected = port_seq[port_str] + 1;
                warn("P#2")
</pre>

<p>and then run tshark like this:</p>

<blockquote>
<p>tshark -nr input.pcap -Xlua_script:udprecv-info.lua</p>
</blockquote>

<p>The output look like this:</p>

<pre>  1 0.000000000 10.126.45.147 -&gt; 239.255.6.82 UDP 1066 0x0000 (0) Source port: 53486  Destination port: 30301
P#1
  2 0.000275000 10.126.45.147 -&gt; 239.255.6.82 UDP 1066 0x0000 (0) Source port: 53486  Destination port: 30301
P#1
  3 0.000277000 10.126.45.147 -&gt; 239.255.6.82 UDP 1066 0x0000 (0) Source port: 53486  Destination port: 30301
P#1
  4 0.000278000 10.126.45.147 -&gt; 239.255.6.82 UDP 1066 0x0000 (0) Source port: 53486  Destination port: 30301
</pre>

<p>So, P#1 gets printed, but not P#2, as if code execution stops after (or with) the declaration of <strong>local expected</strong>. Currently I have no idea what's going wrong (maybe a bug), but if code execution really stops there, your code to analyze the sequence number will not be executed either!</p>

<p>If you remove the declaration of <strong>local expected</strong>, the output looks like this.</p>

<pre>  1 0.000000000 10.126.45.147 -&gt; 239.255.6.82 UDP 1066 0x0000 (0) Source port: 53486  Destination port: 30301
P#1
P#2
not sequential
  2 0.000275000 10.126.45.147 -&gt; 239.255.6.82 UDP 1066 0x0000 (0) Source port: 53486  Destination port: 30301
P#1
P#2
not sequential
</pre>

<p>So, now P#2 gets printed and the rest of the code gets executed as well, although with wrong result, due to the missing variable.</p>

<p>Looks like a strange bug to me. </p>

<p>BTW: The <strong>seq</strong> is extracted correctly by the code.</p></div>
            <div class="comment-info" id="comment-24826-info">
                
                
                
                

                

                <span class="comment-age">(17 Sep '13, 07:38)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="24831"></a>
        <div class="comment not_top_scorer" id="comment-24831">
            <div id="post-24831-score" class="comment-score"></div>
            <div class="comment-text"><p>O.K. the problem is the data type of seq. It gets extracted as type <strong>userdata</strong> (see: warn("Seq type: " .. type(seq)). Even if you make it a uint64, it's type is still <strong>userdata</strong> </p>

<blockquote>
<p>local seq = buffer(8, 8):uint64()</p>
</blockquote>

<p>Apparently there is no + operator defined for that data type and thus the code</p>

<blockquote>
<p>local expected = port_seq[port_str] + 1 </p>
</blockquote>

<p>fails. </p>

<p>So, we need to find a way to make <strong>seq</strong> a number object. Unfortunately I have not found a way to do that yet. tonumber() does not work.</p></div>
            <div class="comment-info" id="comment-24831-info">
                
                
                
                

                

                <span class="comment-age">(17 Sep '13, 08:06)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="24832"></a>
        <div class="comment" id="comment-24832">
            <div id="post-24832-score" class="comment-score">1</div>
            <div class="comment-text"><p>well, there seems to be a problem with unit64(). If I change the code to this</p>

<blockquote>
<p>local seq = buffer(12, 4):uint()</p>
</blockquote>

<p>it works well, as the data type of <strong>seq</strong> is then a <strong>number</strong> instead of <strong>userdata</strong> (with uint64())</p>

<p>HOWEVER: That's just 4 bytes of your sequence!!</p>

<p>Test:</p>

<blockquote>
<p>tshark -nr input.pcap -Xlua_script:udprecv-info.lua</p>
</blockquote>

<p>Output:</p>

<pre>  1 0.000000000 10.126.45.147 -&gt; 239.255.6.82 UDP 1066 0x0000 (0) Source port: 53486  Destination port: 30301
<b>not sequential</b>
  2 0.000275000 10.126.45.147 -&gt; 239.255.6.82 UDP 1066 0x0000 (0) Source port: 53486  Destination port: 30301
it was equal
  3 0.000277000 10.126.45.147 -&gt; 239.255.6.82 UDP 1066 0x0000 (0) Source port: 53486  Destination port: 30301
it was equal
  4 0.000278000 10.126.45.147 -&gt; 239.255.6.82 UDP 1066 0x0000 (0) Source port: 53486  Destination port: 30301
it was equal
  5 0.000279000 10.126.45.147 -&gt; 239.255.6.82 UDP 1066 0x0000 (0) Source port: 53486  Destination port: 30301
<b>not sequential</b>
  6 0.000281000 10.126.45.147 -&gt; 239.255.6.82 UDP 1066 0x0000 (0) Source port: 53486  Destination port: 30301
it was equal
  7 0.000282000 10.126.45.147 -&gt; 239.255.6.82 UDP 1066 0x0000 (0) Source port: 53486  Destination port: 30301
it was equal
  8 0.000283000 10.126.45.147 -&gt; 239.255.6.82 UDP 1066 0x0000 (0) Source port: 53486  Destination port: 30301

</pre>

<p>I don't know if this is a bug or if there are internal representation problems with 64 bit values in Lua !?! Please file a bug report at <a href="https://bugs.wireshark.org">https://bugs.wireshark.org</a> with a reference to this question and my 'findings'.</p></div>
            <div class="comment-info" id="comment-24832-info">
                
                
                
                

                

                <span class="comment-age">(17 Sep '13, 08:19)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="24871"></a>
        <div class="comment not_top_scorer" id="comment-24871">
            <div id="post-24871-score" class="comment-score"></div>
            <div class="comment-text"><p>Excellent troubleshooting!  Thanks for taking the time.</p>

<p>I've submitted <a href="https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=9162">Bug ID 9162</a></p></div>
            <div class="comment-info" id="comment-24871-info">
                
                
                
                

                

                <span class="comment-age">(17 Sep '13, 17:51)</span>
                <a class="comment-user userinfo" href="/users/5637/gordon-marler">Gordon Marler</a>
                
            </div>
        </div>
    
        <a name="24881"></a>
        <div class="comment not_top_scorer" id="comment-24881">
            <div id="post-24881-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks for submitting the bug.</p>

<p>Hint: If a supplied answer resolves your question can you please "accept" it by clicking the checkmark icon next to it. This highlights good answers for the benefit of subsequent users with the same or similar questions.</p></div>
            <div class="comment-info" id="comment-24881-info">
                
                
                
                

                

                <span class="comment-age">(18 Sep '13, 00:25)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-24617" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 10
        </span>
        <a href="#" class="show-all-comments-link">show 5 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-24617-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="29491"></a>
                    <div id="answer-container-29491" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-29491-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/29491/up/" rel="nofollow"> </a>
<div id="post-29491-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-29491-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/29491/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Support for 64-bt integers in Lua has now been added in Wireshark 1.11.3, and should be in the latest <a href="http://www.wireshark.org/download/automated/">nightly builds</a>.  It provides Int64/UInt64 objects with abilities to use math and comparison operators and such. See <a href="http://wiki.wireshark.org/LuaAPI/Int64">wiki.wireshark.org/LuaAPI/Int64</a> for details.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/29491/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>06 Feb '14, 07:57</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d02f20c18a7742ec73a666f1974bf6dc?s=32&amp;d=identicon&amp;r=g" alt="Hadriel's gravatar image" />
    <p><a href="/users/4318/hadriel">Hadriel</a><br/>
    <span class="score" title="2652 reputation points"><span class="">2.7k</span></span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="9 badges"><span class="silver">&#9679;</span><span class="badgecount">9</span></span><span title="39 badges"><span class="bronze">&#9679;</span><span class="badgecount">39</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Hadriel has 30 accepted answers">18&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-29491">
    
</div>
<div id="comment-tools-29491" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-29491-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/24594/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='0PNR7HvkQBNWILv0lAi4FLduJVzPHqXm' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/24594/displaying-gaps-or-drops-in-private-udp-sequence-numbers?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/24594/displaying-gaps-or-drops-in-private-udp-sequence-numbers?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/dissector/"
            class="tag-link-dissector"
            title="see questions tagged'dissector'using tags"
            rel="tag">dissector</a> <span class="tag-number">&#215;637</span><br/>
        
        <a href="/tags/lua/"
            class="tag-link-lua"
            title="see questions tagged'lua'using tags"
            rel="tag">lua</a> <span class="tag-number">&#215;431</span><br/>
        
        <a href="/tags/udp/"
            class="tag-link-udp"
            title="see questions tagged'udp'using tags"
            rel="tag">udp</a> <span class="tag-number">&#215;166</span><br/>
        
        <a href="/tags/tap/"
            class="tag-link-tap"
            title="see questions tagged'tap'using tags"
            rel="tag">tap</a> <span class="tag-number">&#215;40</span><br/>
        
        <a href="/tags/sequence/"
            class="tag-link-sequence"
            title="see questions tagged'sequence'using tags"
            rel="tag">sequence</a> <span class="tag-number">&#215;39</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Sept. 11, 2013, 4:09 p.m.">11 Sep '13, 16:09</strong>
    </p>
    <p> 
     	question was seen: <strong>4,825 times</strong>
    </p>
    <p> 
        last updated: <strong title="Feb. 6, 2014, 7:57 a.m.">06 Feb '14, 07:57</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/4718/help-with-field-extractor-bad-argument-1-to-new">Help with field extractor - bad argument #1 to &#39;new&#39;</a>
        </p>
        
        <p>
            <a href="/questions/8629/rtp-header-extension-in-lua">RTP Header extension in Lua</a>
        </p>
        
        <p>
            <a href="/questions/23519/ipv6-dissecting-throws-lua-ft-not-yet-supported-error-why">IPv6 Dissecting throws Lua FT not yet supported error! Why?</a>
        </p>
        
        <p>
            <a href="/questions/27868/are-lua-dissector-fields-filterable">Are Lua dissector fields filterable?</a>
        </p>
        
        <p>
            <a href="/questions/29841/lua-dissectorget-cant-find-an-existing-dissector">Lua Dissector.get can&#39;t find an existing dissector.</a>
        </p>
        
        <p>
            <a href="/questions/40023/how-can-i-dump-fragmented-packets-to-multiple-files">How can I dump fragmented packets to multiple files?</a>
        </p>
        
        <p>
            <a href="/questions/41570/how-to-switch-protocol-on-the-same-conversation">how to switch protocol on the same conversation</a>
        </p>
        
        <p>
            <a href="/questions/43484/calling-lua-from-c-dissector">Calling Lua from C Dissector</a>
        </p>
        
        <p>
            <a href="/questions/54672/is-there-any-way-to-optimize-lua-dissectors">Is there any way to optimize lua dissectors</a>
        </p>
        
        <p>
            <a href="/questions/59326/custom-dissector-for-llc-payload-in-lua">Custom dissector for LLC Payload in Lua</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
