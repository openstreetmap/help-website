<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Why some packets dropped by tshark without &quot;-s&quot; option ? - Wireshark Q&amp;A</title>
        <meta name="description" content="I use tshark to capture IPFIX packets on Ubuntu. When using the tshark commands without &quot;-s&quot; option, some expected packets are dropped incorrectly. But when the &quot;-s 1500&quot; option is added, it works well. E.g: I run the tshark with different options on the same interface at almost same time. root@debi..." />
        <meta name="keywords" content="tshark,dropped" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/42119/why-some-packets-dropped-by-tshark-without-s-option" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/42119/why-some-packets-dropped-by-tshark-without-s-option?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='DlNkfsW61YFdGHqfG6nCyIzzHTIaMVYE' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/42119/why-some-packets-dropped-by-tshark-without-s-option">Why some packets dropped by tshark without &quot;-s&quot; option ?</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-42119-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/42119/up/" rel="nofollow"> </a>
<div id="post-42119-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-42119-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/42119/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/42119/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>I use tshark to capture IPFIX packets on Ubuntu.
When using the tshark commands without "-s" option, some expected packets are dropped incorrectly. But when the "-s 1500" option is added, it works well.</p>
<p>E.g: I run the tshark with different options on the same interface at almost same time.</p>
<pre><code><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="c0b2afafb480a4a5a2a9a1ae">[email&#160;protected]</a>:/# tshark -i eth0 -w /tmp/tshark_tmp.cap -n -f "dst port 9999"
Running as user "root" and group "root". This could be dangerous.
Capturing on 'eth0'
890 ^C
90 packets dropped                    &lt;== Why this info?

<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="b5c7dadac1f5d1d0d7dcd4db">[email&#160;protected]</a>:~#  tshark -i eth0 -w /tmp/tshark_tmp_1500.cap -s 1500 -n -f "dst port 9999"
Running as user "root" and group "root". This could be dangerous.
Capturing on 'eth0'
1022 ^C
</code></pre>
<p>And I find there are several packets are missing in the <code>/tmp/tshark_tmp.cap</code>. With the same filter, some packets in <code>/tmp/tshark_tmp_1500.ca</code>p cannot be found in <code>/tmp/tshark_tmp.cap</code>.</p>
<pre><code><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="d1a3bebea591b5b4b3b8b0bf">[email&#160;protected]</a>:/# tshark -r /tmp/tshark_tmp.cap -n -d udp.port==9999,cflow  -T fields -E header=y -e cflow.packets64 -e ip.src -e cflow.flowset_id -e cflow.direction -e udp.srcport -e cflow.enterprise_private_entry -R "cflow.srcaddr==192.168.110.46 &amp;&amp; cflow.dstaddr==192.168.102.199" -2
Running as user "root" and group "root". This could be dangerous.
cflow.packets64 ip.src  cflow.flowset_id        cflow.direction udp.srcport     cflow.enterprise_private_entry
29      10.146.108.72   267     0       34193   ac:15:91:cb,ac:15:91:ca,06,ce:2c,1d:2f,04,00:b3:88:00:e9:80:00:00,00:00:00:00:00:00:0b:1a
29      10.146.108.72   266     1       34193   00:00:00:00:00:00:0b:1a

<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ea9885859eaa8e8f88838b84">[email&#160;protected]</a>:/# tshark -r /tmp/tshark_tmp_1500.cap -n -d udp.port==9999,cflow  -T fields -E header=y -e cflow.packets64 -e ip.src -e cflow.flowset_id -e cflow.direction -e udp.srcport -e cflow.enterprise_private_entry -R "cflow.srcaddr==192.168.110.46 &amp;&amp; cflow.dstaddr==192.168.102.199" -2
Running as user "root" and group "root". This could be dangerous.
cflow.packets64 ip.src  cflow.flowset_id        cflow.direction udp.srcport     cflow.enterprise_private_entry
61      10.146.108.72   267     0       34193   ac:15:91:cb,ac:15:91:ca,06,ce:2c,1d:2f,04,00:b3:88:00:e9:80:00:00,00:00:00:00:00:00:17:5a
61      10.146.108.72   266     1       34193   00:00:00:00:00:00:17:5a
61      10.146.108.86   266     0       43549   00:00:00:00:00:00:17:5a
32      10.146.108.86   267     1       43549   ac:15:91:cb,ac:15:91:ca,06,a9:07,1d:2f,04,00:b3:88:00:e9:80:00:00,00:00:00:00:00:00:0c:40
29      10.146.108.86   267     1       43549   ac:15:91:cb,ac:15:91:ca,06,ce:2c,1d:2f,04,00:b3:88:00:e9:80:00:00,00:00:00:00:00:00:0b:1a
29      10.146.108.72   267     0       34193   ac:15:91:cb,ac:15:91:ca,06,ce:2c,1d:2f,04,00:b3:88:00:e9:80:00:00,00:00:00:00:00:00:0b:1a
29      10.146.108.72   266     1       34193   00:00:00:00:00:00:0b:1a
29      10.146.108.86   266     0       43549   00:00:00:00:00:00:0b:1a
14      10.146.108.86   267     1       43549   ac:15:91:cb,ac:15:91:ca,06,a9:07,1d:2f,04,00:b3:88:00:e9:80:00:00,00:00:00:00:00:00:05:5c
15      10.146.108.86   267     1       43549   ac:15:91:cb,ac:15:91:ca,06,ce:2c,1d:2f,04,00:b3:88:00:e9:80:00:00,00:00:00:00:00:00:05:be
</code></pre>
<p>It confused me very much.</p>
<p>What is the default capture snaplen when without "-s" option? </p>
<p>All the packets I expected is less than 1500 bytes. But the dropped packets seems not related to packet length: only part of the packets with the same length are dropped. Why the packets are dropped? </p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/tshark/" class="post-tag tag-link-tshark"
                                        title="see questions tagged 'tshark'" rel="tag">tshark</a>
                                
                                    <a href="/tags/dropped/" class="post-tag tag-link-dropped"
                                        title="see questions tagged 'dropped'" rel="tag">dropped</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>06 May '15, 02:56</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/dafdd67f1d97351e53091d2a3e62e43b?s=32&amp;d=identicon&amp;r=g" alt="Cathy's gravatar image" />
    <p><a href="/users/16761/cathy">Cathy</a><br/>
    <span class="score" title="5 reputation points">5</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">&#9679;</span><span class="badgecount">2</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Cathy has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/42119/">
                edited
                <strong>06 May '15, 03:49</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" alt="grahamb's gravatar image" />
            <p><a href="/users/1225/grahamb">grahamb ♦</a><br/>
            <span class="score" title="19834 reputation points"><span class="">19.8k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">&#9679;</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">&#9679;</span><span class="badgecount">206</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-42119">
    
        <a name="42164"></a>
        <div class="comment" id="comment-42164">
            <div id="post-42164-score" class="comment-score"></div>
            <div class="comment-text"><p>The tshark version info is:
<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="98eaf7f7ecd8fcfdfaf1f9f6">[email&#160;protected]</a>:~# tshark -v
TShark 1.12.2 (Git Rev Unknown from unknown)</p>

<p>Copyright 1998-2014 Gerald Combs <a href="/cdn-cgi/l/email-protection#accbc9decdc0c8ecdbc5dec9dfc4cddec782c3decb"><span class="__cf_email__" data-cfemail="a4c3c1d6c5c8c0e4d3cdd6c1d7ccc5d6cf8acbd6c3">[email&#160;protected]</span></a> and contributors.
This is free software; see the source for copying conditions. There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>

<p>Compiled (32-bit) with GLib 2.34.0, with libpcap, with libz 1.2.3, without POSIX
capabilities, without libnl, without SMI, without c-ares, without ADNS, without
Lua, without Python, without GnuTLS, with Gcrypt 1.4.6, with MIT Kerberos,
without GeoIP.</p>

<p>Running on Linux 2.6.32-5-686, with locale en_US.UTF-8, with libpcap version
1.5.3, with libz 1.2.7.</p>

<p>Built using gcc 4.1.2 20080704 (Red Hat 4.1.2-55).</p></div>
            <div class="comment-info" id="comment-42164-info">
                
                
                
                

                

                <span class="comment-age">(06 May '15, 20:16)</span>
                <a class="comment-user userinfo" href="/users/16761/cathy">Cathy</a>
                
            </div>
        </div>
    
        <a name="42167"></a>
        <div class="comment" id="comment-42167">
            <div id="post-42167-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>Why the packets are dropped?</p>
</blockquote>

<p>Is this a virtual machine or real hardware?</p></div>
            <div class="comment-info" id="comment-42167-info">
                
                
                
                

                

                <span class="comment-age">(06 May '15, 22:01)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="42168"></a>
        <div class="comment" id="comment-42168">
            <div id="post-42168-score" class="comment-score"></div>
            <div class="comment-text"><p>A virtual machine on KVM.</p></div>
            <div class="comment-info" id="comment-42168-info">
                
                
                
                

                

                <span class="comment-age">(06 May '15, 22:03)</span>
                <a class="comment-user userinfo" href="/users/16761/cathy">Cathy</a>
                
            </div>
        </div>
    
        <a name="42169"></a>
        <div class="comment" id="comment-42169">
            <div id="post-42169-score" class="comment-score"></div>
            <div class="comment-text"><p>well, could that be the problem? </p>

<p>Do you see packet drops if you run both tcpdump commands separately? If so, is the packet drop rate the same, higher or lower if you run both captures at the same time? </p>

<p>What happens if you run both tcpdump commands with -s 1500? Still missing packets? If so, what is the number of dropped frames for each tcpdump command? Try to start them "almost" at the same time (through a script) or start sending traffic only after you've successfully started both capture commands.</p></div>
            <div class="comment-info" id="comment-42169-info">
                
                
                
                

                

                <span class="comment-age">(06 May '15, 22:13)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="42170"></a>
        <div class="comment" id="comment-42170">
            <div id="post-42170-score" class="comment-score"></div>
            <div class="comment-text"><p>I haven't run tcpdump, but only run tshark.</p>

<p>In fact, I met the packet dropped issue when one of the tshark command is running. When I run the tshark command without "-s" option, I can see packet drops. And when the "-s 1500" option is added, the results are always OK in several runs. And then I run the two tshark commands, with "-s 1500" and without the option, at the same time to check what is the difference between the two results.
The packet dropped issue only happens in the result of tshark without "-s 1500". </p>

<p>About the packet drop rate, it varies in several runs without "-s" option.</p></div>
            <div class="comment-info" id="comment-42170-info">
                
                
                
                

                

                <span class="comment-age">(06 May '15, 23:21)</span>
                <a class="comment-user userinfo" href="/users/16761/cathy">Cathy</a>
                
            </div>
        </div>
    
        <a name="42172"></a>
        <div class="comment not_top_scorer" id="comment-42172">
            <div id="post-42172-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>I haven't run tcpdump, but only run tshark.</p>
</blockquote>

<p>can you please try tcpdump or dumpcap instead of tshark for the capturing process?</p></div>
            <div class="comment-info" id="comment-42172-info">
                
                
                
                

                

                <span class="comment-age">(07 May '15, 01:20)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-42119" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 6
        </span>
        <a href="#" class="show-all-comments-link">show 1 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-42119-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/42119/why-some-packets-dropped-by-tshark-without-s-option?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/42119/why-some-packets-dropped-by-tshark-without-s-option?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/42119/why-some-packets-dropped-by-tshark-without-s-option?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/42119/why-some-packets-dropped-by-tshark-without-s-option?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="42124"></a>
                    <div id="answer-container-42124" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-42124-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/42124/up/" rel="nofollow"> </a>
<div id="post-42124-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-42124-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/42124/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>You are not specifying which version of Ubuntu you are using, 14.04 with libpcap &gt;=1.5.3 performs better when it comes to packet drops. I think the difference you are seeing is that without -s
the packet size is estimated at 65535 which allows fewer packets per capture buffer, by specifying -s 1500
more packets fits in the buffer and there is less packet drops. This may have been a bug in some libpcap version.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/42124/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>06 May '15, 04:01</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/2d3d425a7a829209431fb38d326b53af?s=32&amp;d=identicon&amp;r=g" alt="Anders's gravatar image" />
    <p><a href="/users/42/anders">Anders ♦</a><br/>
    <span class="score" title="4578 reputation points"><span class="">4.6k</span></span><span title="9 badges"><span class="silver">&#9679;</span><span class="badgecount">9</span></span><span title="52 badges"><span class="bronze">&#9679;</span><span class="badgecount">52</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Anders has 56 accepted answers">17&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-42124">
    
        <a name="42126"></a>
        <div class="comment" id="comment-42126">
            <div id="post-42126-score" class="comment-score"></div>
            <div class="comment-text"><p>Is this really true?  I find it highly doubtful that there would be packets bigger than 1500 bytes (well OK, 1514 bytes), even if the snaplen was set to 65535.  Could this simply be due to higher packet rates/bursts at the time the capturing was done and have nothing really to do with the snaplen?  I suppose one could run 2 simultaneous captures, one with the default snaplen and one with a smaller snaplen to compare apples-to-apples.</p></div>
            <div class="comment-info" id="comment-42126-info">
                
                
                
                

                

                <span class="comment-age">(06 May '15, 07:02)</span>
                <a class="comment-user userinfo" href="/users/402/cmaynard">cmaynard ♦♦</a>
                
            </div>
        </div>
    
        <a name="42127"></a>
        <div class="comment" id="comment-42127">
            <div id="post-42127-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="http://unix.stackexchange.com/questions/18311/buffer-size-for-capturing-packets-in-kernel-space">http://unix.stackexchange.com/questions/18311/buffer-size-for-capturing-packets-in-kernel-space</a></p></div>
            <div class="comment-info" id="comment-42127-info">
                
                
                
                

                

                <span class="comment-age">(06 May '15, 07:04)</span>
                <a class="comment-user userinfo" href="/users/42/anders">Anders ♦</a>
                
            </div>
        </div>
    
        <a name="42129"></a>
        <div class="comment" id="comment-42129">
            <div id="post-42129-score" class="comment-score"></div>
            <div class="comment-text"><p>OK, but the maximum number of packets that would fit into the same buffer size would only be reduced if there were packets that were bigger than 1500 bytes, as compared to limiting the packets to that size, correct?  If you set a snaplen of 1514 bytes, there really shouldn't be any difference as compared to leaving the snaplen at 65535 when capturing on standard Ethernet (assuming no jumbo frames) ... should there?</p></div>
            <div class="comment-info" id="comment-42129-info">
                
                
                
                

                

                <span class="comment-age">(06 May '15, 07:21)</span>
                <a class="comment-user userinfo" href="/users/402/cmaynard">cmaynard ♦♦</a>
                
            </div>
        </div>
    
        <a name="42130"></a>
        <div class="comment" id="comment-42130">
            <div id="post-42130-score" class="comment-score"></div>
            <div class="comment-text"><p>If I remember correctly the lengt is reserved before the packet is seen.</p></div>
            <div class="comment-info" id="comment-42130-info">
                
                
                
                

                

                <span class="comment-age">(06 May '15, 07:51)</span>
                <a class="comment-user userinfo" href="/users/42/anders">Anders ♦</a>
                
            </div>
        </div>
    
        <a name="42131"></a>
        <div class="comment" id="comment-42131">
            <div id="post-42131-score" class="comment-score"></div>
            <div class="comment-text"><p>OH!  If that's the case, maybe the default snaplen should be set much lower!?</p></div>
            <div class="comment-info" id="comment-42131-info">
                
                
                
                

                

                <span class="comment-age">(06 May '15, 08:00)</span>
                <a class="comment-user userinfo" href="/users/402/cmaynard">cmaynard ♦♦</a>
                
            </div>
        </div>
    
        <a name="42138"></a>
        <div class="comment not_top_scorer" id="comment-42138">
            <div id="post-42138-score" class="comment-score"></div>
            <div class="comment-text"><p>I think libpcap was patched to use MTU if that was possible to determine or something like that.</p></div>
            <div class="comment-info" id="comment-42138-info">
                
                
                
                

                

                <span class="comment-age">(06 May '15, 08:24)</span>
                <a class="comment-user userinfo" href="/users/42/anders">Anders ♦</a>
                
            </div>
        </div>
    
        <a name="42140"></a>
        <div class="comment not_top_scorer" id="comment-42140">
            <div id="post-42140-score" class="comment-score"></div>
            <div class="comment-text"><p>Guy provides more details here (and probably other places too): <a href="http://stackoverflow.com/questions/9351664/optimal-snaplen-for-pcap-live-capture">http://stackoverflow.com/questions/9351664/optimal-snaplen-for-pcap-live-capture</a>.</p>

<p>I guess I'll have to read up more on the differences between TPACKET_V1, V2, and V3.  Seems like <a href="https://www.kernel.org/doc/Documentation/networking/packet_mmap.txt">https://www.kernel.org/doc/Documentation/networking/packet_mmap.txt</a> is the place to do that.</p></div>
            <div class="comment-info" id="comment-42140-info">
                
                
                
                

                

                <span class="comment-age">(06 May '15, 08:39)</span>
                <a class="comment-user userinfo" href="/users/402/cmaynard">cmaynard ♦♦</a>
                
            </div>
        </div>
    
        <a name="42165"></a>
        <div class="comment not_top_scorer" id="comment-42165">
            <div id="post-42165-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks for your help. It sounds reasonable and helpful.</p>

<p>But the count of the packets that match the filter "dst port 9999" is not very big, only about 1000 pkts in 3 minutes, and the burst is not more than 100 pkts/sec. Is it so easy to make the capture buffer full?</p></div>
            <div class="comment-info" id="comment-42165-info">
                
                
                
                

                

                <span class="comment-age">(06 May '15, 20:23)</span>
                <a class="comment-user userinfo" href="/users/16761/cathy">Cathy</a>
                
            </div>
        </div>
    
        <a name="42166"></a>
        <div class="comment not_top_scorer" id="comment-42166">
            <div id="post-42166-score" class="comment-score"></div>
            <div class="comment-text"><p>Just out of curiosity, what version of libpcap and tshark are you using?</p></div>
            <div class="comment-info" id="comment-42166-info">
                
                
                
                

                

                <span class="comment-age">(06 May '15, 20:35)</span>
                <a class="comment-user userinfo" href="/users/42/anders">Anders ♦</a>
                
            </div>
        </div>
    
        <a name="42171"></a>
        <div class="comment not_top_scorer" id="comment-42171">
            <div id="post-42171-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="63110c0c17230706010a020d">[email&#160;protected]</a>:~# tshark -v</p>

<p>TShark 1.12.2 (Git Rev Unknown from unknown)</p>

<p>Copyright 1998-2014 Gerald Combs <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="f5929087949991b5829c8790869d94879edb9a8792">[email&#160;protected]</a> and contributors. This is free software; see the source for copying conditions. There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>

<p>Compiled (32-bit) with GLib 2.34.0, with libpcap, with libz 1.2.3, without POSIX capabilities, without libnl, without SMI, without c-ares, without ADNS, without Lua, without Python, without GnuTLS, with Gcrypt 1.4.6, with MIT Kerberos, without GeoIP.</p>

<p>Running on Linux 2.6.32-5-686, with locale en_US.UTF-8, with libpcap version 1.5.3, with libz 1.2.7.</p>

<p>Built using gcc 4.1.2 20080704 (Red Hat 4.1.2-55).</p></div>
            <div class="comment-info" id="comment-42171-info">
                
                
                
                

                

                <span class="comment-age">(06 May '15, 23:22)</span>
                <a class="comment-user userinfo" href="/users/16761/cathy">Cathy</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-42124" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 10
        </span>
        <a href="#" class="show-all-comments-link">show 5 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-42124-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/42119/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='DlNkfsW61YFdGHqfG6nCyIzzHTIaMVYE' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/42119/why-some-packets-dropped-by-tshark-without-s-option?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/42119/why-some-packets-dropped-by-tshark-without-s-option?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/tshark/"
            class="tag-link-tshark"
            title="see questions tagged'tshark'using tags"
            rel="tag">tshark</a> <span class="tag-number">&#215;832</span><br/>
        
        <a href="/tags/dropped/"
            class="tag-link-dropped"
            title="see questions tagged'dropped'using tags"
            rel="tag">dropped</a> <span class="tag-number">&#215;23</span><br/>
        
    </p>
    <p>
        question asked: <strong title="May 6, 2015, 2:56 a.m.">06 May '15, 02:56</strong>
    </p>
    <p> 
     	question was seen: <strong>5,120 times</strong>
    </p>
    <p> 
        last updated: <strong title="May 7, 2015, 1:20 a.m.">07 May '15, 01:20</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/9827/tshark-reporting-packet-loss">tshark reporting packet loss</a>
        </p>
        
        <p>
            <a href="/questions/41951/use-capture-filter-on-tshark-when-reading-a-file">Use capture filter on tshark when reading a file</a>
        </p>
        
        <p>
            <a href="/questions/43408/tshark-packet-comments">Tshark Packet Comments</a>
        </p>
        
        <p>
            <a href="/questions/44430/how-to-dump-sip-traces-according-to-ip-in-separate-files">How to dump sip traces according to ip in separate files?</a>
        </p>
        
        <p>
            <a href="/questions/45430/capture-performance-centos-6-vs-centos-7">Capture performance CentOS 6 vs CentOS 7</a>
        </p>
        
        <p>
            <a href="/questions/46214/add-sipvoip-calls-to-stats-output-on-tshark">Add sip,voip-calls to stats output on tshark</a>
        </p>
        
        <p>
            <a href="/questions/47705/extract-packet-arrival-time-and-capture-length-of-bytes-at-that-instant">Extract Packet arrival time and capture length of bytes at that instant</a>
        </p>
        
        <p>
            <a href="/questions/48911/how-to-configure-the-output-of-tshark-psml-file">How to configure the output of Tshark .psml file</a>
        </p>
        
        <p>
            <a href="/questions/50146/how-to-include-frame-time-in-tshark-when-o-is-used">how to include frame time in tshark when -O is used</a>
        </p>
        
        <p>
            <a href="/questions/50948/automate-network-performance-data-collection">automate network performance data collection</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
