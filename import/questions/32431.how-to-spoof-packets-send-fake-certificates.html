<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>How to spoof packets / send fake certificates? - Wireshark Q&amp;A</title>
        <meta name="description" content="Just for the curiosity really. I am sure you can send http requests from a computer. How can I do that? Let&#39;s say I visit google.com from my smartphone, it automatically returns https version instead of http. Is it possible that when my laptop sees that my smartphone uses https somehow, it would sen..." />
        <meta name="keywords" content="security" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/32431/how-to-spoof-packets-send-fake-certificates" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/32431/how-to-spoof-packets-send-fake-certificates?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='DIOmJcZC5ko1HuxCgIOgonD2RS1Bk1dB' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/32431/how-to-spoof-packets-send-fake-certificates">How to spoof packets / send fake certificates?</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-32431-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/32431/up/" rel="nofollow"> </a>
<div id="post-32431-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-32431-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/32431/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/32431/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   1
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Just for the curiosity really. I am sure you can send http requests from a computer. How can I do that?</p>
<p>Let's say I visit google.com from my smartphone, it automatically returns https version instead of http. Is it possible that when my laptop sees that my smartphone uses https somehow, it would send a fake certificate or something, and if smartphone accepts that, there would no longer be a secure connection between google and smartphone?</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/security/" class="post-tag tag-link-security"
                                        title="see questions tagged 'security'" rel="tag">security</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>02 May '14, 10:55</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/eeca75356089d0569c63dfc514d7f19d?s=32&amp;d=identicon&amp;r=g" alt="tttttttttttt2's gravatar image" />
    <p><a href="/users/5670/tttttttttttt2">tttttttttttt2</a><br/>
    <span class="score" title="34 reputation points">34</span><span title="7 badges"><span class="badge1">&#9679;</span><span class="badgecount">7</span></span><span title="9 badges"><span class="silver">&#9679;</span><span class="badgecount">9</span></span><span title="12 badges"><span class="bronze">&#9679;</span><span class="badgecount">12</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="tttttttttttt2 has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-32431">
    
</div>
<div id="comment-tools-32431" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-32431-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/32431/how-to-spoof-packets-send-fake-certificates?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/32431/how-to-spoof-packets-send-fake-certificates?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/32431/how-to-spoof-packets-send-fake-certificates?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/32431/how-to-spoof-packets-send-fake-certificates?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="32445"></a>
                    <div id="answer-container-32445" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-32445-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/32445/up/" rel="nofollow"> </a>
<div id="post-32445-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-32445-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/32445/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>As <a href="/users/145/jasper"><a href="/users/145/jasper">@Jasper</a></a> mentioned, you can do a SSL man in the middle attack. Besides the tools he mentioned, there are some other interesting tools for Linux to intercept HTTPS connections and send fake certs.</p>
<blockquote>
<p><a href="http://mitmproxy.org/">http://mitmproxy.org/</a> <br>
<a href="http://honeyproxy.org/">http://honeyproxy.org/</a> <br>
</p>
</blockquote>
<p>Furthermore you can try to 'downgrade' https to http. This will work well in some cases (especially SSL secured form based authentication) and it won't work in other cases (if the server requires SSL and it won't accept HTTP anymore).</p>
<blockquote>
<p><a href="http://wroot.org/posts/downgrade-https-connections-to-http-using-ettercap-filters/">http://wroot.org/posts/downgrade-https-connections-to-http-using-ettercap-filters/</a> <br>
</p>
</blockquote>
<p>Finally you could also try to play HTTP-to-HTTPS proxy. If your client tries to access a site with HTTP, and if the server sends a redirect to the HTTPS URL, you could intercept that redirect (with a MIM) and then simply talk HTTPS to the server and HTTP to the client. In that case you even don't have to fake cert. Neither of them will realize you are in between. Take a look at the 'Reverse proxy mode' of <a href="http://mitmproxy.org/">mitmproxy</a> (mentioned above) or <a href="http://www.thoughtcrime.org/software/sslstrip/">sslstrip</a>.</p>
<p>Regards <br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/32445/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>03 May '14, 02:24</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/32445/">
                edited
                <strong>04 May '14, 08:38</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-32445">
    
        <a name="32449"></a>
        <div class="comment" id="comment-32449">
            <div id="post-32449-score" class="comment-score"></div>
            <div class="comment-text"><p>@KurtKnocher What if the network is protected by wpa/wpa2 and a preshared key (which I have)? Will this software work?</p></div>
            <div class="comment-info" id="comment-32449-info">
                
                
                
                

                

                <span class="comment-age">(03 May '14, 06:07)</span>
                <a class="comment-user userinfo" href="/users/5670/tttttttttttt2">tttttttttttt2</a>
                
            </div>
        </div>
    
        <a name="32457"></a>
        <div class="comment" id="comment-32457">
            <div id="post-32457-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes it will. WPA2 will not protect against these kinds of attacks between two clients in the same wireless LAN.</p></div>
            <div class="comment-info" id="comment-32457-info">
                
                
                
                

                

                <span class="comment-age">(03 May '14, 15:42)</span>
                <a class="comment-user userinfo" href="/users/4985/quadratic">Quadratic</a>
                
            </div>
        </div>
    
        <a name="32482"></a>
        <div class="comment" id="comment-32482">
            <div id="post-32482-score" class="comment-score"></div>
            <div class="comment-text"><p>@KurtKnocher: " If your client tries to access a site with HTTP, and if the server sends a redirect to the HTTPS URL, you could intercept that redirect (with a MIM) and then simply talk HTTPS to the server and HTTP to the client" - I made that work. But what if client tries to access https website? Why doesn't it redirect to http? What could I do to make it redirect?</p></div>
            <div class="comment-info" id="comment-32482-info">
                
                
                
                

                

                <span class="comment-age">(04 May '14, 08:49)</span>
                <a class="comment-user userinfo" href="/users/5670/tttttttttttt2">tttttttttttt2</a>
                
            </div>
        </div>
    
        <a name="32485"></a>
        <div class="comment" id="comment-32485">
            <div id="post-32485-score" class="comment-score">1</div>
            <div class="comment-text"><blockquote>
<p>But what if client tries to access https website? </p>
</blockquote>

<p>Then it does not work (one of the cases I mentioned above), because in that case the client expects to receive <strong>valid</strong> from the target server. <strong>Valid</strong> means, a cert signed by one of the CA certs the client knows (usually built into the OS and/or client software).</p>

<blockquote>
<p>Why doesn't it redirect to http? </p>
</blockquote>

<p>Because you can't. The connection between the client and the server is encrypted and the client won't accept a simple <strong>HTTP</strong> redirect for this <strong>encrypted HTTPS</strong> connection.</p>

<blockquote>
<p>What could I do to make it redirect?</p>
</blockquote>

<p><strong>Nothing</strong>, as that's not possible without <strong>intercepting</strong> the SSL connection (means doing a mitm attack) by sending a fake cert to the client, which will pop-up a warning in the client, as the cert is signed by a CA that is unknown the the client.</p>

<p>That's a major part of the SSL/TLS security story/concept!!</p>

<p>If you could subvert that in any way, SSL/TLS would be totally pointless ;-))</p>

<p><strong>However</strong> there have been implementation bugs in SSL/TLS that <strong>did allow</strong> bad things. Just search for 'ssl vulnerabilities' in your preferred search engine.</p></div>
            <div class="comment-info" id="comment-32485-info">
                
                
                
                

                

                <span class="comment-age">(04 May '14, 09:09)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="32487"></a>
        <div class="comment" id="comment-32487">
            <div id="post-32487-score" class="comment-score"></div>
            <div class="comment-text"><p>@KurtKnochner: Thank you so much. What about sending fake certificates? I am trying ettercap and it works if client accepts bad certificate, however, it shows only form submissions, but I want to see all the traffic (for example what if user is already logged in). I think it really should be possible with a fake certificate, but I can't figure out how.</p></div>
            <div class="comment-info" id="comment-32487-info">
                
                
                
                

                

                <span class="comment-age">(04 May '14, 09:18)</span>
                <a class="comment-user userinfo" href="/users/5670/tttttttttttt2">tttttttttttt2</a>
                
            </div>
        </div>
    
        <a name="32488"></a>
        <div class="comment not_top_scorer" id="comment-32488">
            <div id="post-32488-score" class="comment-score"></div>
            <div class="comment-text"><p>My guess is to use etter.ssl.crt in wireshark somehow, because that is a certificate client accepts. What do you think?</p></div>
            <div class="comment-info" id="comment-32488-info">
                
                
                
                

                

                <span class="comment-age">(04 May '14, 09:22)</span>
                <a class="comment-user userinfo" href="/users/5670/tttttttttttt2">tttttttttttt2</a>
                
            </div>
        </div>
    
        <a name="32489"></a>
        <div class="comment not_top_scorer" id="comment-32489">
            <div id="post-32489-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>I think it really should be possible with a fake certificate, but I can't figure out how.</p>
</blockquote>

<p>Yes, that's possible, but kind of beyond the socpe of this site (ask <strong>Wireshark</strong> related questions). </p>

<p>Please take a look at the docs of mitmproxy or search for 'mitmproxy tutorial'. That should bring up the necessary information.</p></div>
            <div class="comment-info" id="comment-32489-info">
                
                
                
                

                

                <span class="comment-age">(04 May '14, 09:22)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="32490"></a>
        <div class="comment not_top_scorer" id="comment-32490">
            <div id="post-32490-score" class="comment-score"></div>
            <div class="comment-text"><p>@KurtKnochner: I think it could be related to wireshark? Because etter.ssl.crt is a certificate that client accepts and maybe it's possible to use it in wireshark, then it could decrypt ssl traffic (just my guesses).</p></div>
            <div class="comment-info" id="comment-32490-info">
                
                
                
                

                

                <span class="comment-age">(04 May '14, 09:23)</span>
                <a class="comment-user userinfo" href="/users/5670/tttttttttttt2">tttttttttttt2</a>
                
            </div>
        </div>
    
        <a name="32491"></a>
        <div class="comment not_top_scorer" id="comment-32491">
            <div id="post-32491-score" class="comment-score"></div>
            <div class="comment-text"><p>Also, for mitmproxy it seems ssl certificate has to be installed in the device first.</p></div>
            <div class="comment-info" id="comment-32491-info">
                
                
                
                

                

                <span class="comment-age">(04 May '14, 09:44)</span>
                <a class="comment-user userinfo" href="/users/5670/tttttttttttt2">tttttttttttt2</a>
                
            </div>
        </div>
    
        <a name="32495"></a>
        <div class="comment not_top_scorer" id="comment-32495">
            <div id="post-32495-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>Also, for mitmproxy it seems <strong>ssl certificate has to be installed in the device first</strong>.</p>
</blockquote>

<p>Sure! </p>

<p>And that's the same for <strong>all SSL interception solutions</strong>!! You'll have to add the CA cert that issues the fake certs to the <strong>trusted issuer certificate store</strong> of the client, otherwise the client will warn the user about the fake cert. If you issue self signed certs, you will have to add them to the cert store, instead of the <strong>interception CA cert</strong>.</p>

<p>As I said: That's a fundamental part of the SSL/TLS security. If you could subvert that with any way, using SSL/TLS would be totally pointless!!</p>

<p>Please read more about how SSL/TLS works (google it), as some aspects of SSL interception will be much clearer for you then.</p>

<p>Maybe, the following paper helps to better understand SSL interception and what's possible and what not</p>

<blockquote>
<p><a href="https://media.blackhat.com/bh-eu-12/Jarmoc/bh-eu-12-Jarmoc-SSL_TLS_Interception-Slides.pdf">https://media.blackhat.com/bh-eu-12/Jarmoc/bh-eu-12-Jarmoc-SSL_TLS_Interception-Slides.pdf</a></p>
</blockquote></div>
            <div class="comment-info" id="comment-32495-info">
                
                
                
                

                

                <span class="comment-age">(04 May '14, 10:47)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="32498"></a>
        <div class="comment not_top_scorer" id="comment-32498">
            <div id="post-32498-score" class="comment-score"></div>
            <div class="comment-text"><p>I understand that client will be warned, that's fine by me.</p></div>
            <div class="comment-info" id="comment-32498-info">
                
                
                
                

                

                <span class="comment-age">(04 May '14, 11:04)</span>
                <a class="comment-user userinfo" href="/users/5670/tttttttttttt2">tttttttttttt2</a>
                
            </div>
        </div>
    
        <a name="32499"></a>
        <div class="comment not_top_scorer" id="comment-32499">
            <div id="post-32499-score" class="comment-score"></div>
            <div class="comment-text"><p>Also, what if user is logged in, I want him to be logged out or accept a new certificate. Again, I understand that the client will have to accept this fake certificate and he'll be warned.</p></div>
            <div class="comment-info" id="comment-32499-info">
                
                
                
                

                

                <span class="comment-age">(04 May '14, 11:06)</span>
                <a class="comment-user userinfo" href="/users/5670/tttttttttttt2">tttttttttttt2</a>
                
            </div>
        </div>
    
        <a name="32500"></a>
        <div class="comment not_top_scorer" id="comment-32500">
            <div id="post-32500-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>Also, what if user is logged in, I want him to be logged out or accept a new certificate</p>
</blockquote>

<p>it does not make a difference if the client is <strong>logged in</strong> or not (at the application on the target server).</p>

<p>All that matters is, if you are able to force the client to establish a <strong>new SSL/TLS session</strong>. Only then you will be able to intercept the handshake and send back the fake cert. So, if the client has already established a TLS connection, you can try to RESET the TCP connection (send a faked TCP RESET). </p>

<p>BTW: Wireshark won't be able to send that TCP RESET. Please google other tools that can do it.</p>

<p>BTW#2: While this is an interesting discussion (and I'm willing to continue it for a while), it kind of gets 'out of control' regarding the purpose of this site (<strong>Wireshark</strong> questions and answers). Maybe you're better off asking these kind of questions in another site/forum, like the Kali Linux Forum ;-))</p></div>
            <div class="comment-info" id="comment-32500-info">
                
                
                
                

                

                <span class="comment-age">(04 May '14, 11:12)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="32504"></a>
        <div class="comment not_top_scorer" id="comment-32504">
            <div id="post-32504-score" class="comment-score"></div>
            <div class="comment-text"><p>Thank you Kurt :) I posted a question there. Basically I just have 2 questions remaining: how to use a certificate that is applied in victim's browser from ettercap in wireshark and how to send a tcp reset.</p></div>
            <div class="comment-info" id="comment-32504-info">
                
                
                
                

                

                <span class="comment-age">(04 May '14, 12:19)</span>
                <a class="comment-user userinfo" href="/users/5670/tttttttttttt2">tttttttttttt2</a>
                
            </div>
        </div>
    
        <a name="32507"></a>
        <div class="comment not_top_scorer" id="comment-32507">
            <div id="post-32507-score" class="comment-score"></div>
            <div class="comment-text"><p>Strangely I can't find how to sent tcp rst request... :/</p></div>
            <div class="comment-info" id="comment-32507-info">
                
                
                
                

                

                <span class="comment-age">(04 May '14, 14:06)</span>
                <a class="comment-user userinfo" href="/users/5670/tttttttttttt2">tttttttttttt2</a>
                
            </div>
        </div>
    
        <a name="32510"></a>
        <div class="comment not_top_scorer" id="comment-32510">
            <div id="post-32510-score" class="comment-score"></div>
            <div class="comment-text"><p>hm....</p>

<blockquote>
<p><a href="https://www.google.com/?q=linux+send+tcp+reset">https://www.google.com/?q=linux+send+tcp+reset</a></p>
</blockquote>

<p>and tcpkill</p>

<blockquote>
<p><a href="http://en.m.wikipedia.org/wiki/Tcpkill">http://en.m.wikipedia.org/wiki/Tcpkill</a></p>
</blockquote></div>
            <div class="comment-info" id="comment-32510-info">
                
                
                
                

                

                <span class="comment-age">(04 May '14, 15:45)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="32515"></a>
        <div class="comment not_top_scorer" id="comment-32515">
            <div id="post-32515-score" class="comment-score"></div>
            <div class="comment-text"><p>Oh, and ettercap stops working after an hour or so... :|
Also, why ip_forward is not set 1 by default at all times? Damn it, I know so little and I wish I had a job related to cyber security or something like that.</p></div>
            <div class="comment-info" id="comment-32515-info">
                
                
                
                

                

                <span class="comment-age">(04 May '14, 17:21)</span>
                <a class="comment-user userinfo" href="/users/5670/tttttttttttt2">tttttttttttt2</a>
                
            </div>
        </div>
    
        <a name="32516"></a>
        <div class="comment not_top_scorer" id="comment-32516">
            <div id="post-32516-score" class="comment-score"></div>
            <div class="comment-text"><p>btw, using ettercap+sslstrip means that sslstrip will try to use http if client requested it (https will be between my pc and server then), and if it's not possible, ettercap will be used by sending a fake cert that user has to accept, right?</p></div>
            <div class="comment-info" id="comment-32516-info">
                
                
                
                

                

                <span class="comment-age">(04 May '14, 17:30)</span>
                <a class="comment-user userinfo" href="/users/5670/tttttttttttt2">tttttttttttt2</a>
                
            </div>
        </div>
    
        <a name="32534"></a>
        <div class="comment not_top_scorer" id="comment-32534">
            <div id="post-32534-score" class="comment-score"></div>
            <div class="comment-text"><p>I made it all work, I've figured out how to apply ethercap certificate in wireshark and it shows decrypted ssl traffic. Finally. :) Is it possible to dump packets to file with ethercap -w file only of particular ip? Kali linux doesn't approve my question for some reason...</p></div>
            <div class="comment-info" id="comment-32534-info">
                
                
                
                

                

                <span class="comment-age">(05 May '14, 05:41)</span>
                <a class="comment-user userinfo" href="/users/5670/tttttttttttt2">tttttttttttt2</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-32445" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 19
        </span>
        <a href="#" class="show-all-comments-link">show 14 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-32445-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="32433"></a>
                    <div id="answer-container-32433" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-32433-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/32433/up/" rel="nofollow"> </a>
<div id="post-32433-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-32433-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/32433/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>No, because the fake certificate would be invalid and the user gets a big red warning (otherwise there would be no point in using certificates if they could be falsified). But if you can get the guy using the smartphone to accept bad certificates you could. Easiest way to do this is to use a proxy, like <a href="http://www.portswigger.net/burp/">Burp</a> or <a href="http://www.telerik.com/fiddler">Fiddler</a>.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/32433/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>02 May '14, 11:32</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" alt="Jasper's gravatar image" />
    <p><a href="/users/145/jasper">Jasper ♦♦</a><br/>
    <span class="score" title="23806 reputation points"><span class="">23.8k</span></span><span title="5 badges"><span class="badge1">&#9679;</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">&#9679;</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">&#9679;</span><span class="badgecount">284</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Jasper has 263 accepted answers">18&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-32433">
    
        <a name="32440"></a>
        <div class="comment" id="comment-32440">
            <div id="post-32440-score" class="comment-score"></div>
            <div class="comment-text"><p>Anything on Linux?</p></div>
            <div class="comment-info" id="comment-32440-info">
                
                
                
                

                

                <span class="comment-age">(02 May '14, 15:17)</span>
                <a class="comment-user userinfo" href="/users/5670/tttttttttttt2">tttttttttttt2</a>
                
            </div>
        </div>
    
        <a name="32444"></a>
        <div class="comment" id="comment-32444">
            <div id="post-32444-score" class="comment-score"></div>
            <div class="comment-text"><p>Burp works on all plattforms.</p></div>
            <div class="comment-info" id="comment-32444-info">
                
                
                
                

                

                <span class="comment-age">(02 May '14, 17:47)</span>
                <a class="comment-user userinfo" href="/users/145/jasper">Jasper ♦♦</a>
                
            </div>
        </div>
    
        <a name="32451"></a>
        <div class="comment" id="comment-32451">
            <div id="post-32451-score" class="comment-score"></div>
            <div class="comment-text"><p>Also, shouldn't ARP poisoning be enough? Why use Burp?</p></div>
            <div class="comment-info" id="comment-32451-info">
                
                
                
                

                

                <span class="comment-age">(03 May '14, 07:22)</span>
                <a class="comment-user userinfo" href="/users/5670/tttttttttttt2">tttttttttttt2</a>
                
            </div>
        </div>
    
        <a name="32452"></a>
        <div class="comment" id="comment-32452">
            <div id="post-32452-score" class="comment-score"></div>
            <div class="comment-text"><p>Also, what if I change my MAC address on laptop to the same as Smartphone's MAC, will I then be able to see HTTPS requests' content in wireshark? I think it makes sense if both smartphone and laptop are on the same network.</p></div>
            <div class="comment-info" id="comment-32452-info">
                
                
                
                

                

                <span class="comment-age">(03 May '14, 07:27)</span>
                <a class="comment-user userinfo" href="/users/5670/tttttttttttt2">tttttttttttt2</a>
                
            </div>
        </div>
    
        <a name="32520"></a>
        <div class="comment" id="comment-32520">
            <div id="post-32520-score" class="comment-score"></div>
            <div class="comment-text"><p>ARP poisoning only forces the packets to use your node as "gateway" on a layer2/3 basis. You cannot modify or exchange certificates on those layers, you need some software to do that. Which is where the proxies or MITM tools come in.</p>

<p>If you create a duplicate MAC on the network you might actually see some of the packets, yes, but that is not a predictable or stable way to do things. You'll most likely confuse your switch by telling it that the same destination exists in two physical locations, which will lead to MAC address flapping (which is not good).</p></div>
            <div class="comment-info" id="comment-32520-info">
                
                
                
                

                

                <span class="comment-age">(04 May '14, 20:26)</span>
                <a class="comment-user userinfo" href="/users/145/jasper">Jasper ♦♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-32433" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-32433-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/32431/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='DIOmJcZC5ko1HuxCgIOgonD2RS1Bk1dB' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/32431/how-to-spoof-packets-send-fake-certificates?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/32431/how-to-spoof-packets-send-fake-certificates?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/security/"
            class="tag-link-security"
            title="see questions tagged'security'using tags"
            rel="tag">security</a> <span class="tag-number">&#215;36</span><br/>
        
    </p>
    <p>
        question asked: <strong title="May 2, 2014, 10:55 a.m.">02 May '14, 10:55</strong>
    </p>
    <p> 
     	question was seen: <strong>9,200 times</strong>
    </p>
    <p> 
        last updated: <strong title="May 5, 2014, 5:43 a.m.">05 May '14, 05:43</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/827/how-do-i-justify-shutting-down-skype">How do I justify shutting down Skype?</a>
        </p>
        
        <p>
            <a href="/questions/18406/risk-assessment-issues">Risk assessment issues</a>
        </p>
        
        <p>
            <a href="/questions/61744/how-to-find-out-if-my-computer-is-hacked-or-not-using-wireshark">How to find out if my computer is hacked or not using Wireshark?</a>
        </p>
        
        <p>
            <a href="/questions/4270/cookie-injection">cookie injection</a>
        </p>
        
        <p>
            <a href="/questions/21872/wireshark-auditing">wireshark auditing</a>
        </p>
        
        <p>
            <a href="/questions/62352/wireshark-api-to-handle-in-a-application-an-intercepted-packet">WireShark API to handle in a application an intercepted packet ?</a>
        </p>
        
        <p>
            <a href="/questions/5065/i-am-looking-for-a-capture-file-of-8021x-handshake-and-eap-can-anyone-help">I am looking for a Capture file of 802.1X handshake and EAP Can anyone help??</a>
        </p>
        
        <p>
            <a href="/questions/26628/can-i-use-this-to-detect-if-i-have-spyware-on-my-pc">Can I use this to detect if I have spyware on my PC?</a>
        </p>
        
        <p>
            <a href="/questions/63932/illegal-meta-character-in-http-response-headers">Illegal meta character in http response headers</a>
        </p>
        
        <p>
            <a href="/questions/5155/wave-short-message-p16093">Wave Short Message P1609.3</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
