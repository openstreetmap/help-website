<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>802.11 decryption doesn&#39;t always work, even with the full EAPOL handshake - Wireshark Q&amp;A</title>
        <meta name="description" content="This is a complex question and I don&#39;t expect an answer, but I thought I&#39;d throw it out there for ideas. I live in a fairly dense wifi area (7-12 APs visible). I&#39;m using a TP-Link TL-WN722N USB plug in monitor mode. I am using a capture-filter on only my BSSID which reduces the capture by more than ..." />
        <meta name="keywords" content="decoded,eapol,802.11,deauthentication" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/41945/80211-decryption-doesnt-always-work-even-with-the-full-eapol-handshake" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/41945/80211-decryption-doesnt-always-work-even-with-the-full-eapol-handshake?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='Mg8wzdL2MwQw1EkBDlY0G9fWYHk1ACdA' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/41945/80211-decryption-doesnt-always-work-even-with-the-full-eapol-handshake">802.11 decryption doesn&#39;t always work, even with the full EAPOL handshake</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-41945-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/41945/up/" rel="nofollow"> </a>
<div id="post-41945-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-41945-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/41945/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/41945/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>This is a complex question and I don't expect an answer, but I thought I'd throw it out there for ideas.</p>
<p>I live in a fairly dense wifi area (7-12 APs visible).  I'm using a TP-Link TL-WN722N USB plug in monitor mode. I am using a capture-filter on only my BSSID which reduces the capture by more than an order of magnitude:</p>
<pre><code>dumpcap -i $IF -f "(wlan addr1 $BSS_LQ63F &amp;&amp; dir tods) || (wlan addr2 $BSS_LQ63F &amp;&amp; dir fromds)" -w bssid.cap
</code></pre>
<p>This works fine and I hope to add to it for more filtering.  Note that I do not filter frames with no tods/fromds bits (capture keyword "nods") because that increases the traffic considerably (probe, beacon, etc.)  802.11 is fairly noisy.</p>
<p>I'm testing WPA password recovery by injecting deauth packets (5 at a time) to a STA and collecting the 4-way EAPOL handshake.  I do this until the entire EAPOL handshake is captured.  After this I can decode the STA-AP session (using the WPA PSK.) Usually. </p>
<p>But sometimes when I capture the entire handshake, I cannot decode the session.  I compare the frames with a successful decode and there is no significant difference.</p>
<p>I notice this occurs generally at night when there's more streaming traffic so I suspect the card is dropping something.  But if I capture all four messages in the EAPOL handshake and it looks similar to a handshake for a successful decode, it SHOULD decode.  Is there something more?</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/decoded/" class="post-tag tag-link-decoded"
                                        title="see questions tagged 'decoded'" rel="tag">decoded</a>
                                
                                    <a href="/tags/eapol/" class="post-tag tag-link-eapol"
                                        title="see questions tagged 'eapol'" rel="tag">eapol</a>
                                
                                    <a href="/tags/802.11/" class="post-tag tag-link-802.11"
                                        title="see questions tagged '802.11'" rel="tag">802.11</a>
                                
                                    <a href="/tags/deauthentication/" class="post-tag tag-link-deauthentication"
                                        title="see questions tagged 'deauthentication'" rel="tag">deauthentication</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>29 Apr '15, 09:48</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/0f45aaab03d5fe3baeae1fe049869203?s=32&amp;d=identicon&amp;r=g" alt="dturvene's gravatar image" />
    <p><a href="/users/16543/dturvene">dturvene</a><br/>
    <span class="score" title="5 reputation points">5</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="5 badges"><span class="bronze">&#9679;</span><span class="badgecount">5</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="dturvene has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/41945/">
                edited
                <strong>29 Apr '15, 18:52</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" alt="Guy%20Harris's gravatar image" />
            <p><a href="/users/79/guy-harris">Guy Harris ♦♦</a><br/>
            <span class="score" title="17443 reputation points"><span class="">17.4k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">&#9679;</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">&#9679;</span><span class="badgecount">196</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-41945">
    
        <a name="41946"></a>
        <div class="comment" id="comment-41946">
            <div id="post-41946-score" class="comment-score"></div>
            <div class="comment-text"><p>Is it possible to post a capture that you were unable to decrypt?  Could you please post it to Google Drive or some other cloud service so others could download and view the file.</p></div>
            <div class="comment-info" id="comment-41946-info">
                
                
                
                

                

                <span class="comment-age">(29 Apr '15, 10:31)</span>
                <a class="comment-user userinfo" href="/users/3386/amato_c">Amato_C</a>
                
            </div>
        </div>
    
        <a name="42006"></a>
        <div class="comment" id="comment-42006">
            <div id="post-42006-score" class="comment-score"></div>
            <div class="comment-text"><p>I just uploaded a capture that has the data decoded with my WPA2 key after the 4-way eapol, a capture that does not have data decoded after what appears to me the same 4-way eapol handshake, and a README.txt describing what MACs to look for.</p>

<p>I uploaded to google drive URL:</p>

<p><a href="https://drive.google.com/open?id=0B-UqcU04ccFdfl80dlA5SHh3aDJSRzN3MEE2NkxLQUdTZ3RGWWNqZzRqMFNzbllEbW1Pc2M&amp;authuser=0">https://drive.google.com/open?id=0B-UqcU04ccFdfl80dlA5SHh3aDJSRzN3MEE2NkxLQUdTZ3RGWWNqZzRqMFNzbllEbW1Pc2M&amp;authuser=0</a></p></div>
            <div class="comment-info" id="comment-42006-info">
                
                
                
                

                

                <span class="comment-age">(01 May '15, 13:47)</span>
                <a class="comment-user userinfo" href="/users/16543/dturvene">dturvene</a>
                
            </div>
        </div>
    
        <a name="42010"></a>
        <div class="comment" id="comment-42010">
            <div id="post-42010-score" class="comment-score">1</div>
            <div class="comment-text"><p>I can see only one diefference.
There is a retransmitted frame in the EAPOL sequence. 
Maybe it is not allowed to have a retransmitted frame in EAPOL message, if you want to decrypt the traffic.</p></div>
            <div class="comment-info" id="comment-42010-info">
                
                
                
                

                

                <span class="comment-age">(01 May '15, 15:27)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
        <a name="42013"></a>
        <div class="comment" id="comment-42013">
            <div id="post-42013-score" class="comment-score"></div>
            <div class="comment-text"><p>Excellent!  It makes sense, sort of (I guess). Thanks so much for the answer.</p></div>
            <div class="comment-info" id="comment-42013-info">
                
                
                
                

                

                <span class="comment-age">(01 May '15, 16:40)</span>
                <a class="comment-user userinfo" href="/users/16543/dturvene">dturvene</a>
                
            </div>
        </div>
    
        <a name="42014"></a>
        <div class="comment not_top_scorer" id="comment-42014">
            <div id="post-42014-score" class="comment-score"></div>
            <div class="comment-text"><p>Now I'm wondering.  Is the "no retransmission of eapol frames" a 802.1x requirement or a wireshark requirement?  I don't see a specific passage in 802.1x.  Frame retrans are alluded to in Clause 8.  So I think it may be a wireshark constraint.</p></div>
            <div class="comment-info" id="comment-42014-info">
                
                
                
                

                

                <span class="comment-age">(01 May '15, 17:03)</span>
                <a class="comment-user userinfo" href="/users/16543/dturvene">dturvene</a>
                
            </div>
        </div>
    
        <a name="42016"></a>
        <div class="comment not_top_scorer" id="comment-42016">
            <div id="post-42016-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi Christian and dturvene - the retransmitted EAPOL message is not the cause of the decryption problem.  I have numerous captures that decrypt correctly when EAPOL messages are retransmitted.  I have also been able to decrypt WiFi captures when the first EAPOL message is retransmitted one time - similar to the capture provided by Christian.</p>

<p>This appears to be a driver issue.  You might want to update your driver and try again.  I say that out of experience.  I had a similar experience and updating the driver fixed the issue.</p></div>
            <div class="comment-info" id="comment-42016-info">
                
                
                
                

                

                <span class="comment-age">(01 May '15, 18:29)</span>
                <a class="comment-user userinfo" href="/users/3386/amato_c">Amato_C</a>
                
            </div>
        </div>
    
        <a name="42020"></a>
        <div class="comment" id="comment-42020">
            <div id="post-42020-score" class="comment-score">1</div>
            <div class="comment-text"><p>Then try this file.
<a href="https://drive.google.com/file/d/0B80gG9wZvGF0Qm9vd09OXzUxVWs/view?usp=sharing">https://drive.google.com/file/d/0B80gG9wZvGF0Qm9vd09OXzUxVWs/view?usp=sharing</a></p>

<ol>
<li>In Wireshark, make sure you have the Wireless toolbar selected. View / Wireless Toolbar</li>
<li>Download file from Google drive</li>
<li>Open the file.  Enter the display filter "eapol" - do not enter quotes.  You should see EAP message #1 repeated.  Also, the file should not be decrypted.</li>
<li>In Wireshark, press the Decryption Keys button on the Wireless toolbar.</li>
<li>Enter a new decryption key:
Type = WPA-PWD
SSID = D-Link_DIR-820L_5G
Passphrase = nac-1234</li>
<li>Press OK and then Apply</li>
<li>If decryption does not occur, go to the Wireless toolbar.  Look for the drop-down menu that says Wireshark.  Change that to None.  Change it back to Wireshark.</li>
</ol></div>
            <div class="comment-info" id="comment-42020-info">
                
                
                
                

                

                <span class="comment-age">(02 May '15, 04:54)</span>
                <a class="comment-user userinfo" href="/users/3386/amato_c">Amato_C</a>
                
            </div>
        </div>
    
        <a name="42021"></a>
        <div class="comment not_top_scorer" id="comment-42021">
            <div id="post-42021-score" class="comment-score"></div>
            <div class="comment-text"><p>Forgot one step.  After performing step #3 (eapol display filter), make sure you clear the filter field so you can see the entire capture again.</p></div>
            <div class="comment-info" id="comment-42021-info">
                
                
                
                

                

                <span class="comment-age">(02 May '15, 04:59)</span>
                <a class="comment-user userinfo" href="/users/3386/amato_c">Amato_C</a>
                
            </div>
        </div>
    
        <a name="42027"></a>
        <div class="comment not_top_scorer" id="comment-42027">
            <div id="post-42027-score" class="comment-score"></div>
            <div class="comment-text"><p>Amato you are right it worked fine.</p></div>
            <div class="comment-info" id="comment-42027-info">
                
                
                
                

                

                <span class="comment-age">(02 May '15, 23:27)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
        <a name="42034"></a>
        <div class="comment not_top_scorer" id="comment-42034">
            <div id="post-42034-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/16543/dturvene">@dturvene</a>: What is the WPA passphrase for the posted capture files?</p></div>
            <div class="comment-info" id="comment-42034-info">
                
                
                
                

                

                <span class="comment-age">(03 May '15, 14:13)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="42041"></a>
        <div class="comment not_top_scorer" id="comment-42041">
            <div id="post-42041-score" class="comment-score"></div>
            <div class="comment-text"><p>Ugg.  I hate myself but I don't see a "Decryption Key button on the Wireless toolbar".  I just built wireshark from source on my Ubuntu 14.04.2 LTS - See the about page below. I still have the same decode problem.  I cross-verified that the good capture still decodes.  I tried the Wireshark/None/Wireshark toggle.  I searched for a way to modify the toolbars.  I don't <em>think</em> I need libnl.  I'm sure I'm missing something obvious.</p>

<p>Here's the wireshark about page:</p>

<pre><code>Version 1.12.4 (Git Rev Unknown from unknown)

Copyright 1998-2015 Gerald Combs &lt;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ddbab8afbcb1b99daab4afb8aeb5bcafb6f3b2afba">[email&#160;protected]</a>&gt; and contributors.
This is free software; see the source for copying conditions. There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

Compiled (64-bit) with GTK+ 3.10.8, with Cairo 1.13.1, with Pango 1.36.3, with
GLib 2.40.2, with libpcap, with libz 1.2.8, with POSIX capabilities (Linux),
without libnl, without SMI, without c-ares, without ADNS, without Lua, without
Python, with GnuTLS 2.12.23, with Gcrypt 1.5.3, with MIT Kerberos, without
GeoIP, without PortAudio, with AirPcap.

Running on Linux 3.13.0-49-generic, with locale en_US.UTF-8, with libpcap
version 1.5.3, with libz 1.2.8, GnuTLS 2.12.23, Gcrypt 1.5.3, without AirPcap.
      Intel(R) Core(TM) i7-2670QM CPU @ 2.20GHz

Built using gcc 4.8.2.
</code></pre></div>
            <div class="comment-info" id="comment-42041-info">
                
                
                
                

                

                <span class="comment-age">(03 May '15, 15:38)</span>
                <a class="comment-user userinfo" href="/users/16543/dturvene">dturvene</a>
                
            </div>
        </div>
    
        <a name="42043"></a>
        <div class="comment not_top_scorer" id="comment-42043">
            <div id="post-42043-score" class="comment-score"></div>
            <div class="comment-text"><p>The "Decryption Key button on the Wireless toolbar" is an AirPcap-only, and thus Windows-specific, feature.  On UN*Xes, you would enter the keys as a preference for the 802.11 protocol, as per the <a href="https://wiki.wireshark.org/HowToDecrypt802.11">"How to decrypt 802.11" page in the Wireshark Wiki</a>.</p></div>
            <div class="comment-info" id="comment-42043-info">
                
                
                
                

                

                <span class="comment-age">(03 May '15, 15:49)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="42056"></a>
        <div class="comment not_top_scorer" id="comment-42056">
            <div id="post-42056-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/16160/christian_r">@Christian_R</a> - did you try the following in your capture that did not decrypt in Wireshark?
1. Clear all the previous saved decryption keys
2. Enter the SSID and passphrase for the file you would like to decrypt
3. Select Apply.
4. In the Wireless toolbar, look for the drop-down menu that says Wireshark. Change that to None. Change it back to Wireshark</p></div>
            <div class="comment-info" id="comment-42056-info">
                
                
                
                

                

                <span class="comment-age">(04 May '15, 05:50)</span>
                <a class="comment-user userinfo" href="/users/3386/amato_c">Amato_C</a>
                
            </div>
        </div>
    
        <a name="42057"></a>
        <div class="comment not_top_scorer" id="comment-42057">
            <div id="post-42057-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/3386/amato_c">@Amato_C</a> 
Everything went fine with your description. See my comment above.</p></div>
            <div class="comment-info" id="comment-42057-info">
                
                
                
                

                

                <span class="comment-age">(04 May '15, 06:21)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
        <a name="42062"></a>
        <div class="comment not_top_scorer" id="comment-42062">
            <div id="post-42062-score" class="comment-score"></div>
            <div class="comment-text"><p>I successfully decoded Amato_C's Decrypt.pcap file using the given wpa-pwd phrase.  I can USUALLY do this with my captures but once in a while it just does not decode.  I tried resetting my wpa-pwd, toggling the wireshark/none button, hand-building the latest wireshark.</p>

<p>Thanks for all the advice but I need to move on.  I'm going to put this down as a driver issue for the TP-LINK TL-WN722n usb ath9k chipset I'm using.</p></div>
            <div class="comment-info" id="comment-42062-info">
                
                
                
                

                

                <span class="comment-age">(04 May '15, 11:11)</span>
                <a class="comment-user userinfo" href="/users/16543/dturvene">dturvene</a>
                
            </div>
        </div>
    
        <a name="42133"></a>
        <div class="comment not_top_scorer" id="comment-42133">
            <div id="post-42133-score" class="comment-score"></div>
            <div class="comment-text"><p>An additional point-of-interest.  I'm doing large scale captures and using the same deauth/eapol mechanism to get the keys for the device-under-test. Sometimes (again, not always) the original capture file DOES NOT decode the stream to a device.  BUT, the stream is always decoded if I do a post-processing display filter on either the device MAC ("wlan.addr eq $MAC_DUT") or on the BSSID ("wlan.bssid eq $BSSID").</p>

<p>So this seems to be a good work-around for me.  It also suggest it is not a driver problem.</p></div>
            <div class="comment-info" id="comment-42133-info">
                
                
                
                

                

                <span class="comment-age">(06 May '15, 08:03)</span>
                <a class="comment-user userinfo" href="/users/16543/dturvene">dturvene</a>
                
            </div>
        </div>
    
        <a name="42137"></a>
        <div class="comment not_top_scorer" id="comment-42137">
            <div id="post-42137-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/16543/dturvene">@dturvene</a>, as requested by <a href="/users/2593/kurt-knochner">@Kurt</a> Kochner above, can you post the WPA passphrase and SSID for the files you posted above so that Wireshark devs can look at them and fix the issue you see?</p></div>
            <div class="comment-info" id="comment-42137-info">
                
                
                
                

                

                <span class="comment-age">(06 May '15, 08:23)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="42144"></a>
        <div class="comment not_top_scorer" id="comment-42144">
            <div id="post-42144-score" class="comment-score"></div>
            <div class="comment-text"><p>The WPA passphrase is 0ctOpu$7PTN ("num 0" "c" "t" "cap-O" "p" "u" "$" "7" "cap-P" "cap-T" "cap-N").  The SSID is LQ63F.</p></div>
            <div class="comment-info" id="comment-42144-info">
                
                
                
                

                

                <span class="comment-age">(06 May '15, 09:23)</span>
                <a class="comment-user userinfo" href="/users/16543/dturvene">dturvene</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-41945" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 18
        </span>
        <a href="#" class="show-all-comments-link">show 13 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-41945-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    3 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/41945/80211-decryption-doesnt-always-work-even-with-the-full-eapol-handshake?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/41945/80211-decryption-doesnt-always-work-even-with-the-full-eapol-handshake?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/41945/80211-decryption-doesnt-always-work-even-with-the-full-eapol-handshake?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/41945/80211-decryption-doesnt-always-work-even-with-the-full-eapol-handshake?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="42220"></a>
                    <div id="answer-container-42220" class="answer accepted-answer">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-42220-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/42220/up/" rel="nofollow"> </a>
<div id="post-42220-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-42220-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/42220/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="dturvene has selected this answer as the correct answer"
        href="/accept_answer/42220/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>I downloaded both files that <a href="/users/16543/dturvene">@dturvene</a> posted on Google drive. When comparing the WPA Key Nonce field between EAP message #1 and EAP message #3, the following is observed: </p>
<ol>
<li>bssid-tofrom-good.cap = both WPA Key Nonce values are the same between EAPOL message #1 and message #3, as expected</li>
<li>bssid-tofrom-nodecode.cap = the WPA Key Nonce values differ in the last byte between EAPOL message #1 and EAPOL message #3. In message #1, the last byte is b5, but in message #3 the last byte is b6.</li>
</ol>
<p>Since the AP is acting as the Authenticator, the WPA Key Nonce is referred to as the Authenticator Nonce (ANonce for short) when the AP sends an EAPOL frame. For EAPOL message #1 and #3, the AP is sending these frames and the WPA Key Nonce is therefore referred to as ANonce. In IEEE-2012 specification, sections 11.6.6.2 and 11.6.6.4 provide the expected values of each field. The ANonce value must be the same between EAP message #1 and EAP message #3. Also the Nonce value is used to generate the encryption keys! Since the ANonce differs within the same capture, decryption fails.</p>
<p>Also, it is interesting to note that the ANonce is the same in message #1 for both files. This is highly unusually since the AP will generate a new Nonce value for each 4-Way Handshake instance.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/42220/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>08 May '15, 10:16</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d9cf592a79eafbc3b2a8b3f38cf38362?s=32&amp;d=identicon&amp;r=g" alt="Amato_C's gravatar image" />
    <p><a href="/users/3386/amato_c">Amato_C</a><br/>
    <span class="score" title="1098 reputation points"><span class="">1.1k</span></span><span title="14 badges"><span class="badge1">&#9679;</span><span class="badgecount">14</span></span><span title="20 badges"><span class="silver">&#9679;</span><span class="badgecount">20</span></span><span title="32 badges"><span class="bronze">&#9679;</span><span class="badgecount">32</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Amato_C has 15 accepted answers">14&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-42220">
    
        <a name="42223"></a>
        <div class="comment" id="comment-42223">
            <div id="post-42223-score" class="comment-score">1</div>
            <div class="comment-text"><p>To prove that the mismatching ANonce value between EAP message #1 and EAP message #3 was the cause of the decryption issue, the following was performed:</p>

<ol>
<li>Modified the ANonce value in EAP message #1 in the "bssid-tofrom-nodecode.cap".  The last byte of the ANonce was changed from B5 to B6</li>
<li>Performed Wireshark decryption</li>
</ol>

<p>The file was properly decrypted.</p>

<p>Files:</p>

<p>Original file with No-Decryption = <a href="https://drive.google.com/file/d/0B80gG9wZvGF0ZHNRS1ozelhNaW8/view?usp=sharing">https://drive.google.com/file/d/0B80gG9wZvGF0ZHNRS1ozelhNaW8/view?usp=sharing</a></p>

<p>Modified file with Decryption = <a href="https://drive.google.com/file/d/0B80gG9wZvGF0T2VsN3pRRHcxZDg/view?usp=sharing">https://drive.google.com/file/d/0B80gG9wZvGF0T2VsN3pRRHcxZDg/view?usp=sharing</a></p></div>
            <div class="comment-info" id="comment-42223-info">
                
                
                
                

                

                <span class="comment-age">(08 May '15, 10:28)</span>
                <a class="comment-user userinfo" href="/users/3386/amato_c">Amato_C</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-42220" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-42220-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="42158"></a>
                    <div id="answer-container-42158" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-42158-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/42158/up/" rel="nofollow"> </a>
<div id="post-42158-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-42158-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/42158/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>In the nodecode trace I can see a different WPA Key Nonce between EAPOL Message (1 of 4) and (3 of 4).</p>
<p>In the other traces I can see, that this information is always the same. </p>
<p>But I do not know if this information is important for this question.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/42158/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>06 May '15, 15:32</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/3b24b339fc62fb46dced6a443d3202ea?s=32&amp;d=identicon&amp;r=g" alt="Christian_R's gravatar image" />
    <p><a href="/users/16160/christian_r">Christian_R</a><br/>
    <span class="score" title="1830 reputation points"><span class="">1.8k</span></span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="6 badges"><span class="silver">&#9679;</span><span class="badgecount">6</span></span><span title="25 badges"><span class="bronze">&#9679;</span><span class="badgecount">25</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Christian_R has 25 accepted answers">16&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-42158">
    
        <a name="42218"></a>
        <div class="comment" id="comment-42218">
            <div id="post-42218-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes, that seems to be the smoking gun: last octet of the nonce are different.  I would have never caught that.  Additionally, tshark decodes only the first 24 octets of the 32 octet nonce so I wouldn't have seen it anyway (I prefer not to use the wireshark GUI.)</p>

<p>Having said that, I cannot recreate the inter-handshake nonce problem at this time.  I think I need to wait until there's more traffic on my net.  But I will more thoroughly set up injection tests for the AP and see how it handles the nonces.</p>

<p><a href="/users/3386/amato_c"></a><a href="/users/3386/amato_c">@Amato_C</a>: thanks for the clarification in your comment below!  I suggest you move it to an "answer" and I will upgrade and add points.</p></div>
            <div class="comment-info" id="comment-42218-info">
                
                
                
                

                

                <span class="comment-age">(08 May '15, 08:20)</span>
                <a class="comment-user userinfo" href="/users/16543/dturvene">dturvene</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-42158" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-42158-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="42136"></a>
                    <div id="answer-container-42136" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-42136-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/42136/up/" rel="nofollow"> </a>
<div id="post-42136-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-42136-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/42136/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>The problem was that the capture probably contained EAPOL messages from other WLAN's on the same channel.  Wireshark will use the first EAP message to try to decode.  So if the EAP message does not belong to the capture of interest, it will not decode.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/42136/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>06 May '15, 08:22</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d9cf592a79eafbc3b2a8b3f38cf38362?s=32&amp;d=identicon&amp;r=g" alt="Amato_C's gravatar image" />
    <p><a href="/users/3386/amato_c">Amato_C</a><br/>
    <span class="score" title="1098 reputation points"><span class="">1.1k</span></span><span title="14 badges"><span class="badge1">&#9679;</span><span class="badgecount">14</span></span><span title="20 badges"><span class="silver">&#9679;</span><span class="badgecount">20</span></span><span title="32 badges"><span class="bronze">&#9679;</span><span class="badgecount">32</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Amato_C has 15 accepted answers">14&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-42136">
    
        <a name="42145"></a>
        <div class="comment" id="comment-42145">
            <div id="post-42145-score" class="comment-score"></div>
            <div class="comment-text"><p>I send a series of five deauth frames to the device MAC every minute until I see the auth handshake, associate handshake and the four-way eapol handshake.  The auth handshake, association handshake and eapol handshake have the MAC of the router, MAC of the device and BSSID of the router.</p></div>
            <div class="comment-info" id="comment-42145-info">
                
                
                
                

                

                <span class="comment-age">(06 May '15, 09:44)</span>
                <a class="comment-user userinfo" href="/users/16543/dturvene">dturvene</a>
                
            </div>
        </div>
    
        <a name="42159"></a>
        <div class="comment" id="comment-42159">
            <div id="post-42159-score" class="comment-score"></div>
            <div class="comment-text"><p>And another great catch by <a href="/users/16160/christian_r">@Christian_R</a>!  I downloaded both files that <a href="/users/16543/dturvene">@dturvene</a> posted on Google drive.  When comparing the WPA Key Nonce field between EAP message #1 and EAP message #3, the following is observed:
1) bssid_tofrom_good.cap = both WPA Key Nonce values are the same between EAPOL message #1 and message #3, as expected
2) bssid_tofrom_nodecode.cap = the WPA Key Nonce values differ in the last byte between EAPOL message #1 and EAPOL message #3.  In message #1, the last byte is b5, but in message #3 the last byte is b6.</p>

<p>Since the AP is acting as the Authenticator, the WPA Key Nonce is referred to as the Authenticator Nonce (ANonce for short) when the AP sends an EAPOL frame.  Since the AP is sending EAPOL message #1 and #3, the WPA Key Nonce is the ANonce.  Referring to IEEE-2012 specification, section 11.6.6.2 and section 11.6.6.4 provide the expected values of each field.  The ANonce value must be the same between EAP message #1 and EAP message #3.  Also the Nonce value is used to generate the keys!  Since the ANonce differs within the same capture, decryption fails.</p>

<p>Also, it is interesting the ANonce is the same in message #1 for both files.  This is highly unusually since the AP will generate a new Nonce value for each 4-Way Handshake instance.</p>

<p>It appears to the ActionTec wireless router is using the same Nonce value between different 4-Way Handshake instances.  But then changes that value in the middle of the handshake.  Strange behavior from the AP.</p></div>
            <div class="comment-info" id="comment-42159-info">
                
                
                
                

                

                <span class="comment-age">(06 May '15, 16:10)</span>
                <a class="comment-user userinfo" href="/users/3386/amato_c">Amato_C</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-42136" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-42136-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/41945/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='Mg8wzdL2MwQw1EkBDlY0G9fWYHk1ACdA' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/41945/80211-decryption-doesnt-always-work-even-with-the-full-eapol-handshake?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/41945/80211-decryption-doesnt-always-work-even-with-the-full-eapol-handshake?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/802.11/"
            class="tag-link-802.11"
            title="see questions tagged'802.11'using tags"
            rel="tag">802.11</a> <span class="tag-number">&#215;114</span><br/>
        
        <a href="/tags/eapol/"
            class="tag-link-eapol"
            title="see questions tagged'eapol'using tags"
            rel="tag">eapol</a> <span class="tag-number">&#215;38</span><br/>
        
        <a href="/tags/deauthentication/"
            class="tag-link-deauthentication"
            title="see questions tagged'deauthentication'using tags"
            rel="tag">deauthentication</a> <span class="tag-number">&#215;6</span><br/>
        
        <a href="/tags/decoded/"
            class="tag-link-decoded"
            title="see questions tagged'decoded'using tags"
            rel="tag">decoded</a> <span class="tag-number">&#215;4</span><br/>
        
    </p>
    <p>
        question asked: <strong title="April 29, 2015, 9:48 a.m.">29 Apr '15, 09:48</strong>
    </p>
    <p> 
     	question was seen: <strong>6,470 times</strong>
    </p>
    <p> 
        last updated: <strong title="May 8, 2015, 10:28 a.m.">08 May '15, 10:28</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/6554/ieee-80211-deauth-packet-reason-codes-and-their-meanings">IEEE 802.11 deauth packet reason codes and their meanings</a>
        </p>
        
        <p>
            <a href="/questions/23489/wireshark-doesnt-capture-80211-data-packets">Wireshark doesn&#39;t capture 802.11 data packets</a>
        </p>
        
        <p>
            <a href="/questions/1508/wireshark-doesnt-decode-esp-encrypted-responses">Wireshark doesn&#39;t decode ESP encrypted responses</a>
        </p>
        
        <p>
            <a href="/questions/26700/dont-receive-eapol-handshakes-from-other-computers">Don&#39;t receive eapol handshakes from other computers</a>
        </p>
        
        <p>
            <a href="/questions/57093/dumpcap-losing-eapol-when-creating-multiple-files">Dumpcap losing eapol when creating multiple files</a>
        </p>
        
        <p>
            <a href="/questions/6210/can-not-capture-data-packets-in-monitor-mode-with-rt61">can not capture data packets in monitor mode with rt61</a>
        </p>
        
        <p>
            <a href="/questions/15421/every-packet-has-80211-protocol">Every Packet has 802.11 Protocol</a>
        </p>
        
        <p>
            <a href="/questions/22022/decrypt-80211-data-inside-peekremote-capture">Decrypt 802.11 data inside peekremote capture</a>
        </p>
        
        <p>
            <a href="/questions/31164/wlan-card-details-to-sniff-pkts">WLAN card details to sniff pkts</a>
        </p>
        
        <p>
            <a href="/questions/41062/can-python-show-if-a-pcapng-trace-file-came-from-80211n-or-80211ac">Can Python show if a PcapNG trace file came from 802.11n or 802.11ac?</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
