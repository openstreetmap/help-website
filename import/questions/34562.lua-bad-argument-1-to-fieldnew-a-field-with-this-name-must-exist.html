<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>[Lua] Bad argument #1 to Field.new (a field with this name must exist) - Wireshark Q&amp;A</title>
        <meta name="description" content="Recently I created a few ProtoFields in a Lua file that contains a dissector. The ProtoFields seem to work great when I test the dissector, and I can even use them as a display filter. The file looks like this: proto_name = Proto(&quot;foo&quot;,&quot;FOO PROTOCOL&quot;) msg_id = ProtoField.uint16 (&quot;foo.msg_id&quot;, &quot;msg_i..." />
        <meta name="keywords" content="listener,lua,dissector,fields,wireshark" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/34562/lua-bad-argument-1-to-fieldnew-a-field-with-this-name-must-exist" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/34562/lua-bad-argument-1-to-fieldnew-a-field-with-this-name-must-exist?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='zd7FSYj6WM9FG956QopZt3bqd82OTCOZ' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/34562/lua-bad-argument-1-to-fieldnew-a-field-with-this-name-must-exist">[Lua] Bad argument #1 to Field.new (a field with this name must exist)</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-34562-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/34562/up/" rel="nofollow"> </a>
<div id="post-34562-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-34562-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/34562/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/34562/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Recently I created a few ProtoFields in a Lua file that contains a dissector. The ProtoFields seem to work great when I test the dissector, and I can even use them as a display filter. The file looks like this:</p>
<pre><code>proto_name = Proto("foo","FOO PROTOCOL")
msg_id = ProtoField.uint16 ("foo.msg_id", "msg_id", base.DEC, table_of_stuff)
msg_sub_id = ProtoField.uint16 ("foo.msg_sub_id", "msg_sub_id_unused")
msg_size = ProtoField.uint32 ("foo.msg_size", "msg_size")
proto_name.fields = {msg_id, msg_sub_id, msg_size}

function proto_name.dissector (buffer, pinfo, tree)
   --fields are added to treeitems
end

tcp_table = DissectorTable.get("tcp.port")
tcp_table:add(&lt;port number&gt;, proto_name)
</code></pre>
<p>The problem occurs in a separate file, where I want to create a Listener to gather some statistics for the protocol. In this file I have</p>
<pre><code>get_msg_id = Field.new("foo.msg_id")
--code below is never reached
--Listener function
</code></pre>
<p>I'm aware that Field objects have to be created outside of the callback functions of dissectors, post-dissectors, heuristic-dissectors, and taps, which is why I did so in my code. </p>
<p>My questions and concerns are:</p>
<p>Why are my fields in the Listener file not recognized, when they are clearly recognized in the dissector?</p>
<p>Are they instantly destroyed after they're used in the dissector?</p>
<p>Do the Field extractors have to be created in the same file that the Protofields were created in? </p>
<p>Does the Listener have to be created in the same file as the Dissector for this particular scenario?</p>
<p>I really appreciate the help and advice!</p>
<p>Thanks,</p>
<p>Jeffrey</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/listener/" class="post-tag tag-link-listener"
                                        title="see questions tagged 'listener'" rel="tag">listener</a>
                                
                                    <a href="/tags/lua/" class="post-tag tag-link-lua"
                                        title="see questions tagged 'lua'" rel="tag">lua</a>
                                
                                    <a href="/tags/dissector/" class="post-tag tag-link-dissector"
                                        title="see questions tagged 'dissector'" rel="tag">dissector</a>
                                
                                    <a href="/tags/fields/" class="post-tag tag-link-fields"
                                        title="see questions tagged 'fields'" rel="tag">fields</a>
                                
                                    <a href="/tags/wireshark/" class="post-tag tag-link-wireshark"
                                        title="see questions tagged 'wireshark'" rel="tag">wireshark</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>10 Jul '14, 07:23</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/e66163b53ebae2cb35d621d806073ea2?s=32&amp;d=identicon&amp;r=g" alt="jphmiller's gravatar image" />
    <p><a href="/users/7529/jphmiller">jphmiller</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="5 badges"><span class="bronze">&#9679;</span><span class="badgecount">5</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="jphmiller has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/34562/">
                edited
                <strong>10 Jul '14, 12:22</strong>
            </a>
        </p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-34562">
    
        <a name="34563"></a>
        <div class="comment" id="comment-34563">
            <div id="post-34563-score" class="comment-score"></div>
            <div class="comment-text"><p>Oh also,</p>

<p>Wireshark Version 1.10.8
Windows 7</p></div>
            <div class="comment-info" id="comment-34563-info">
                
                
                
                

                

                <span class="comment-age">(10 Jul '14, 07:38)</span>
                <a class="comment-user userinfo" href="/users/7529/jphmiller">jphmiller</a>
                
            </div>
        </div>
    
        <a name="34584"></a>
        <div class="comment" id="comment-34584">
            <div id="post-34584-score" class="comment-score"></div>
            <div class="comment-text"><p>I just did some more research, I found that there was a bug [3513] that prevented Field.new from retrieving a previously defined custom fields. The fix was back in October... could anyone give me a confirmation that this fix was back ported to version 1.10.8?</p></div>
            <div class="comment-info" id="comment-34584-info">
                
                
                
                

                

                <span class="comment-age">(10 Jul '14, 14:28)</span>
                <a class="comment-user userinfo" href="/users/7529/jphmiller">jphmiller</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-34562" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-34562-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/34562/lua-bad-argument-1-to-fieldnew-a-field-with-this-name-must-exist?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/34562/lua-bad-argument-1-to-fieldnew-a-field-with-this-name-must-exist?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/34562/lua-bad-argument-1-to-fieldnew-a-field-with-this-name-must-exist?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/34562/lua-bad-argument-1-to-fieldnew-a-field-with-this-name-must-exist?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="34565"></a>
                    <div id="answer-container-34565" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-34565-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/34565/up/" rel="nofollow"> </a>
<div id="post-34565-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-34565-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/34565/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Well, first you have this:</p>
<pre><code>get_msg_id = Field.new("proto_name.msg_id")
</code></pre>
<p>...but "<code>proto_name</code>" isn't the string name of your protocol - it's the name of a Lua variable that represents a <code>Proto</code> object.  There is no protocol named "<code>proto_name</code>" in your example, but there is one named "<code>foo</code>".  So the line should be:</p>
<pre><code>get_msg_id = Field.new("foo.msg_id")
</code></pre>
<p>Also, you need to make sure the file that defines the new protocol (the one with the code at the beginning of your question) is loaded before the file with the <code>Field.new()</code> call.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/34565/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>10 Jul '14, 09:06</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d02f20c18a7742ec73a666f1974bf6dc?s=32&amp;d=identicon&amp;r=g" alt="Hadriel's gravatar image" />
    <p><a href="/users/4318/hadriel">Hadriel</a><br/>
    <span class="score" title="2652 reputation points"><span class="">2.7k</span></span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="9 badges"><span class="silver">&#9679;</span><span class="badgecount">9</span></span><span title="39 badges"><span class="bronze">&#9679;</span><span class="badgecount">39</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Hadriel has 30 accepted answers">18&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-34565">
    
        <a name="34570"></a>
        <div class="comment" id="comment-34570">
            <div id="post-34570-score" class="comment-score"></div>
            <div class="comment-text"><p>I'm sorry I copied line of code incorrectly. I fixed the original post.</p>

<p>I have: get_msg_id = Field.new("foo.msg_id")</p>

<p>How is the load priority in \Wireshark\plugins\&lt;version&gt; decided for 2 lua source files?</p>

<p>I also placed both files in \Wireshark and tried at the bottom of the init.lua</p>

<p>dofile("dissector.lua")</p>

<p>dofile("listener.lua")</p>

<p>and received the same error. I figured Wireshark started with loading init.lua, and so before it did anything else I thought I could load them in here, where I can specify which loads before the other. Perhaps it's not doing what I think it's doing?</p></div>
            <div class="comment-info" id="comment-34570-info">
                
                
                
                

                

                <span class="comment-age">(10 Jul '14, 11:24)</span>
                <a class="comment-user userinfo" href="/users/7529/jphmiller">jphmiller</a>
                
            </div>
        </div>
    
        <a name="34572"></a>
        <div class="comment" id="comment-34572">
            <div id="post-34572-score" class="comment-score">1</div>
            <div class="comment-text"><p>Sadly there is no specific order for files loaded from the plugin directory - the code relies on another library function to do it, which is known to not provide any specific ordering guarantee, and might be different on different operating systems or even disk formats.</p>

<p>Since your two files are not really independent, you could name the first one <code>myproto.lua</code> and the second one <code>myproto.txt</code>, so that wireshark only auto-loads the first one (it only auto-loads files with <code>.lua</code> extension<code>), and then at the bottom of your</code>myproto.lua<code>file call</code>dofile()` using the second file's name to load it.  Or just combine the two files into one bigger file.</p></div>
            <div class="comment-info" id="comment-34572-info">
                
                
                
                

                

                <span class="comment-age">(10 Jul '14, 11:44)</span>
                <a class="comment-user userinfo" href="/users/4318/hadriel">Hadriel</a>
                
            </div>
        </div>
    
        <a name="34573"></a>
        <div class="comment" id="comment-34573">
            <div id="post-34573-score" class="comment-score"></div>
            <div class="comment-text"><p>I tried both of those ideas and continued to receive:</p>

<p>bad argument #1 to 'new' (Field_new: a field with this name must exist)</p>

<p>Did I not register my protocol fields properly or something?</p></div>
            <div class="comment-info" id="comment-34573-info">
                
                
                
                

                

                <span class="comment-age">(10 Jul '14, 11:53)</span>
                <a class="comment-user userinfo" href="/users/7529/jphmiller">jphmiller</a>
                
            </div>
        </div>
    
        <a name="34585"></a>
        <div class="comment" id="comment-34585">
            <div id="post-34585-score" class="comment-score">1</div>
            <div class="comment-text"><p>No you did register them, with this line:</p>

<pre><code>proto_name.fields = {msg_id, msg_sub_id, msg_size}
</code></pre>

<p>... so long as the <code>Field.new()</code> is after that, it should work.</p>

<p>Oh... wait a minute... you're on 1.10.8 - try it on 1.12.0 instead.  There was a bug that prevented a Lua-created ProtoField from being used by a Lua-based Field.  It was fixed late last year, but my guess is not in 1.10.x.</p></div>
            <div class="comment-info" id="comment-34585-info">
                
                
                
                

                

                <span class="comment-age">(10 Jul '14, 14:38)</span>
                <a class="comment-user userinfo" href="/users/4318/hadriel">Hadriel</a>
                
            </div>
        </div>
    
        <a name="34597"></a>
        <div class="comment" id="comment-34597">
            <div id="post-34597-score" class="comment-score"></div>
            <div class="comment-text"><p>Yep, that was it. I installed 1.12.0, plunked everything in and was good to go.</p>

<p>For anybody experiencing this same problem with the current stable version (1.10.8). The fix for this Field.new() bug (3513) was implemented in 1.11.2. You'll have to upgrade.</p>

<p><a href="https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3513">https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=3513</a></p></div>
            <div class="comment-info" id="comment-34597-info">
                
                
                
                

                

                <span class="comment-age">(11 Jul '14, 05:31)</span>
                <a class="comment-user userinfo" href="/users/7529/jphmiller">jphmiller</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-34565" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-34565-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/34562/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='zd7FSYj6WM9FG956QopZt3bqd82OTCOZ' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/34562/lua-bad-argument-1-to-fieldnew-a-field-with-this-name-must-exist?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/34562/lua-bad-argument-1-to-fieldnew-a-field-with-this-name-must-exist?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/wireshark/"
            class="tag-link-wireshark"
            title="see questions tagged'wireshark'using tags"
            rel="tag">wireshark</a> <span class="tag-number">&#215;1,620</span><br/>
        
        <a href="/tags/dissector/"
            class="tag-link-dissector"
            title="see questions tagged'dissector'using tags"
            rel="tag">dissector</a> <span class="tag-number">&#215;637</span><br/>
        
        <a href="/tags/lua/"
            class="tag-link-lua"
            title="see questions tagged'lua'using tags"
            rel="tag">lua</a> <span class="tag-number">&#215;431</span><br/>
        
        <a href="/tags/fields/"
            class="tag-link-fields"
            title="see questions tagged'fields'using tags"
            rel="tag">fields</a> <span class="tag-number">&#215;33</span><br/>
        
        <a href="/tags/listener/"
            class="tag-link-listener"
            title="see questions tagged'listener'using tags"
            rel="tag">listener</a> <span class="tag-number">&#215;16</span><br/>
        
    </p>
    <p>
        question asked: <strong title="July 10, 2014, 7:23 a.m.">10 Jul '14, 07:23</strong>
    </p>
    <p> 
     	question was seen: <strong>5,886 times</strong>
    </p>
    <p> 
        last updated: <strong title="July 11, 2014, 5:31 a.m.">11 Jul '14, 05:31</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/4718/help-with-field-extractor-bad-argument-1-to-new">Help with field extractor - bad argument #1 to &#39;new&#39;</a>
        </p>
        
        <p>
            <a href="/questions/60101/is-it-possible-to-make-a-listener-in-c">Is it possible to make a listener in C++?</a>
        </p>
        
        <p>
            <a href="/questions/54042/how-to-create-multiple-dissectors-for-same-port-number">How to create multiple dissectors for same port number</a>
        </p>
        
        <p>
            <a href="/questions/54672/is-there-any-way-to-optimize-lua-dissectors">Is there any way to optimize lua dissectors</a>
        </p>
        
        <p>
            <a href="/questions/4678/lua-listener-dynamic-fields">Lua listener, dynamic fields</a>
        </p>
        
        <p>
            <a href="/questions/54776/what-happens-to-the-old-port-numbers-when-we-change-the-port-numbers-from-the-protocol-preferences">What happens to the old port numbers when we change the port numbers from the protocol preferences</a>
        </p>
        
        <p>
            <a href="/questions/27868/are-lua-dissector-fields-filterable">Are Lua dissector fields filterable?</a>
        </p>
        
        <p>
            <a href="/questions/10120/give-a-name-to-an-ip-in-lua-wireshark">Give a name to an ip in lua wireshark</a>
        </p>
        
        <p>
            <a href="/questions/60476/related-packet-symbols-in-lua-dissector">Related packet symbols in Lua dissector</a>
        </p>
        
        <p>
            <a href="/questions/34663/listening-twice-lua-to-the-same-log-on-tshark">listening twice ( lua) to the same log on tshark</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
