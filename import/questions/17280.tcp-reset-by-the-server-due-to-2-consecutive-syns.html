<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>tcp reset by the server due to 2 consecutive SYNs - Wireshark Q&amp;A</title>
        <meta name="description" content="Hi, I have a sequence of tcp connection establishment as follows:  client sends a syn to server client do not hear a response within 2.996seconds client initiates a second syn to server server acknowledges for the syn. not sure if its for the first syn or second syn. but looking at the timestamp its..." />
        <meta name="keywords" content="consecutive,two,syns" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/17280/tcp-reset-by-the-server-due-to-2-consecutive-syns" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/17280/tcp-reset-by-the-server-due-to-2-consecutive-syns?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='4qEm72GtpVA6tXNHIbYS0MiYF9NWFxuW' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/17280/tcp-reset-by-the-server-due-to-2-consecutive-syns">tcp reset by the server due to 2 consecutive SYNs</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-17280-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/17280/up/" rel="nofollow"> </a>
<div id="post-17280-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-17280-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/17280/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/17280/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hi,</p>
<p>I have a sequence of tcp connection establishment as follows:</p>
<ol>
<li>client sends a syn to server</li>
<li>client do not hear a response within 2.996seconds</li>
<li>client initiates a second syn to server</li>
<li>server acknowledges for the syn. not sure if its for the first syn or second syn. but looking at the timestamp its matching with the second syn</li>
<li>client receives a RST,ACK.</li>
</ol>
<p>I am not sure why i receive a TCP reset.
Is there a problem in client or server ? is the server recognizing it as a syn flood ? destination is a VIP (might be a loadbalancer cum firewall). I am actually an application's guy with very limited knowledge on tcp/networking stuff. Could you pls  help me out here as i have no clue of whether its an issue with client or server. </p>
<p>SYN goes with flags SYN, ECN, CWR for both SYNs.</p>
<p>Thanks,
resolver</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/consecutive/" class="post-tag tag-link-consecutive"
                                        title="see questions tagged 'consecutive'" rel="tag">consecutive</a>
                                
                                    <a href="/tags/two/" class="post-tag tag-link-two"
                                        title="see questions tagged 'two'" rel="tag">two</a>
                                
                                    <a href="/tags/syns/" class="post-tag tag-link-syns"
                                        title="see questions tagged 'syns'" rel="tag">syns</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>27 Dec '12, 13:07</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/1fde3199bc6f991fdda6ed413c404050?s=32&amp;d=identicon&amp;r=g" alt="synresolver's gravatar image" />
    <p><a href="/users/4131/synresolver">synresolver</a><br/>
    <span class="score" title="0 reputation points">0</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">&#9679;</span><span class="badgecount">2</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="synresolver has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-17280">
    
        <a name="17283"></a>
        <div class="comment" id="comment-17283">
            <div id="post-17283-score" class="comment-score">1</div>
            <div class="comment-text"><p>can you post a capture file somewhere? It's hard to do any troubleshooting based on a text description of what you (believe to) have seen ;-)</p></div>
            <div class="comment-info" id="comment-17283-info">
                
                
                
                

                

                <span class="comment-age">(27 Dec '12, 14:44)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-17280" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-17280-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/17280/tcp-reset-by-the-server-due-to-2-consecutive-syns?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/17280/tcp-reset-by-the-server-due-to-2-consecutive-syns?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/17280/tcp-reset-by-the-server-due-to-2-consecutive-syns?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/17280/tcp-reset-by-the-server-due-to-2-consecutive-syns?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="17295"></a>
                    <div id="answer-container-17295" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-17295-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/17295/up/" rel="nofollow"> </a>
<div id="post-17295-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-17295-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/17295/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <blockquote>
<p>SYN goes with flags SYN, <strong>ECN</strong>, CWR for both SYNs.</p>
</blockquote>
<p>from <a href="http://tools.ietf.org/html/rfc3360">RFC 3360</a>: </p>
<pre>   
   <b>Unfortunately, a number of firewalls and load-balancers in the
   current Internet send a reset in response to a TCP SYN packet that
   use flags from the Reserved field in the TCP header</b>.  Section 3 below
   discusses the specific example of firewalls <b>that send resets in
   response to TCP SYN packets from ECN-capable hosts</b>.
</pre>

<p>well, that was in 2002. Anyway, as you mentioned a loadbalancer and/or a firewall, I would try to check that with the device admins in charge.</p>
<p>Can you disable the use of ECN on your client (just for a test)?</p>
<blockquote>
<p><code><a href="http://en.wikipedia.org/wiki/Explicit_Congestion_Notification#ECN_support_in_TCP_by_hosts">http://en.wikipedia.org/wiki/Explicit_Congestion_Notification#ECN_support_in_TCP_by_hosts</a></code><br>
</p>
</blockquote>
<p>Regards<br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/17295/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>27 Dec '12, 23:09</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/17295/">
                edited
                <strong>27 Dec '12, 23:19</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-17295">
    
        <a name="17302"></a>
        <div class="comment" id="comment-17302">
            <div id="post-17302-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi Kurt,</p>

<p>Thanks a lot for your response. I will disable the ECN and test it. </p>

<p>Is there a way that i can  post the pcap file to you. if you dont mind pls share your email id. Following is the sequence for one of the resets.</p>

<pre>No.       Time         Source      Destination           Protocol Length Info

11931 6218.308766      SrcHst        DstHost           TCP      74     13358 &gt; https [SYN, ECN, CWR] Seq=0 Win=5840 Len=0 MSS=1460 SACK_PERM=1 TSval=145993636 TSecr=0 WS=256

11972 6221.305267      SrcHst        DstHost           TCP      74     13358 &gt; https [SYN, ECN, CWR] Seq=0 Win=5840 Len=0 MSS=1460 SACK_PERM=1 TSval=145994386 TSecr=0 WS=256

11973 6221.328336      DstHost       SrcHst            TCP      60     https &gt; 13358 [ACK] Seq=1 Ack=1 Win=12288 Len=0

11974 6225.741699       DstHost       SrcHst            TCP      60     https &gt; 13358 [RST, ACK] Seq=1 Ack=1 Win=12288 Len=0

</pre>

<p>I will go through the links you have shared. What are the consequences of disabling the ECN at the device level ? </p>

<p>Not able to post the above details via "add new comment" button hence posting in the Your answer text area.  if you would like to move to my comment in any way pls do so. </p>

<p>Thanks a lot again.</p></div>
            <div class="comment-info" id="comment-17302-info">
                
                
                
                

                

                <span class="comment-age">(28 Dec '12, 02:27)</span>
                <a class="comment-user userinfo" href="/users/4131/synresolver">synresolver</a>
                
            </div>
        </div>
    
        <a name="17303"></a>
        <div class="comment" id="comment-17303">
            <div id="post-17303-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>Thanks a lot for your response. I will disable the ECN and test it. </p>
</blockquote>

<p>O.K. what is your client OS?</p>

<blockquote>
<p>Is there a way that i can post the pcap file to you. if you dont mind pls share your email id. Following is the sequence for one of the resets.</p>
</blockquote>

<p>If you can upload it somewhere (google docs, one-click filehoster) I would prefer that. Otherwise you can find my e-mail address in my profile (just click on my name).</p>

<blockquote>
<p>I will go through the links you have shared. What are the consequences of disabling the ECN at the device level ?</p>
</blockquote>

<p>If ECN causes the problem, then the 'consequence' would be that it works ;-) </p>

<p>The 'bad' consequences are minimal (or none), if your network connection is otherwise stable (not too much packet loss).</p></div>
            <div class="comment-info" id="comment-17303-info">
                
                
                
                

                

                <span class="comment-age">(28 Dec '12, 03:01)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="17304"></a>
        <div class="comment" id="comment-17304">
            <div id="post-17304-score" class="comment-score"></div>
            <div class="comment-text"><p>You can post capture files to <a href="http://www.cloudshark.org">www.cloudshark.org</a>, but beware that you don't publicly share capture files with sensitive data in it (you can change IP addresses with <a href="http://bittwist.sourceforge.net/">bittwist</a> or <a href="http://tcpreplay.synfin.net/wiki/tcprewrite">tcprewrite</a>).</p></div>
            <div class="comment-info" id="comment-17304-info">
                
                
                
                

                

                <span class="comment-age">(28 Dec '12, 03:01)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="17380"></a>
        <div class="comment" id="comment-17380">
            <div id="post-17380-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi Kurt,</p>

<p>Sorry for delayed response due to the holdiays. I have sent you the pcap file. If you filter with ip.addr == 20.20.20.20 &amp;&amp; tcp.port == 53810 you can see the SYN, ECN, CWR are being set but at the IP level the differentiated services flag states that its not ECN-Capable support. So, not sure if this is completely because of ECN flag. </p>

<p>OS - is IBM's DataPower XI 50 server.</p>

<p>For the other successful tcp connections, i can see these so network team is ruling out this is the root cause, hence we are not able to disable the ECN and test.</p>

<p>synbit- thanks for suggesting the tools and i modified the capture files to certain extent so that the data is being scrambled.</p>

<p>thanks again.</p></div>
            <div class="comment-info" id="comment-17380-info">
                
                
                
                

                

                <span class="comment-age">(02 Jan '13, 05:24)</span>
                <a class="comment-user userinfo" href="/users/4131/synresolver">synresolver</a>
                
            </div>
        </div>
    
        <a name="17384"></a>
        <div class="comment" id="comment-17384">
            <div id="post-17384-score" class="comment-score"></div>
            <div class="comment-text"><p>O.K. I checked the pcap file you sent me via email. Please apply the following filter:</p>

<blockquote>
<p><code>tcp.flags.syn eq 1 and (tcp.stream eq 16 or tcp.stream eq 632)</code> <br>
</p>
</blockquote>

<p>As you can see, there are HTTPS connections that do work with ECN (and CWR) set. Stream #16 works, whereas stream #632 (similar connection parameters) does <strong>not work</strong>. </p>

<p>Then please apply this filter:</p>

<blockquote>
<p><code>ip.addr eq 20.20.20.20 and ((tcp.flags.syn eq 1 and  tcp.flags.ecn eq 1) or tcp.flags.reset eq 1)</code> <br>
</p>
</blockquote>

<p>As you can see, most (similar) connections do work, just a few show that 'silly' behavior.</p>

<p>So, I don't think that ECN (and CWR) is the problem. Now I believe it might be a bug/problem with the device between 10.10.10.10 and 20.20.20.20 (if there is one) or the server 20.20.20.20 itself. However, with just a capture from 10.10.10.10, it is hard to make any assumption.</p>

<p><strong>Recommendation</strong>: Please try to capture at two points in parallel. One at 10.10.10.10 and one one 20.20.20.20 (if that is the sever), or <strong>after</strong> 20.20.20.20 if that is the firewall/loadbalancer you mentioned.</p>

<p>BTW: do you know what type of firewall/loadbalancer is in use?</p></div>
            <div class="comment-info" id="comment-17384-info">
                
                
                
                

                

                <span class="comment-age">(02 Jan '13, 06:26)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="17396"></a>
        <div class="comment not_top_scorer" id="comment-17396">
            <div id="post-17396-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p><strong>server acknowledges for the syn</strong>. not sure if its for the first syn or second syn. but looking at the timestamp its matching with the second syn</p>
</blockquote>

<p>That's not quite correct, which also make me believe it's a bug as mentioned above.</p>

<p>I think I can post the following output, as its totally anonymous.</p>

<pre>   No.     Time        Source                Destination           Protocol Length Info
   7113 3677.285242 10.10.10.10           20.20.20.20           TCP      74     53810 &gt; https [SYN, ECN, CWR] Seq=0 Win=5840 Len=0 MSS=1460 SACK_PERM=1 TSval=145592423 TSecr=0 WS=256

   7151 3680.281717 10.10.10.10           20.20.20.20           TCP      74     53810 &gt; https [SYN, ECN, CWR] Seq=0 Win=5840 Len=0 MSS=1460 SACK_PERM=1 TSval=145593173 TSecr=0 WS=256

   7152 3680.312861 20.20.20.20           10.10.10.10           TCP      60     https &gt; 53810 [ACK] Seq=1 Ack=1 Win=12288 Len=0

   7153 3684.553901 20.20.20.20           10.10.10.10           TCP      60     https &gt; 53810 [RST, ACK] Seq=1 Ack=1 Win=12288 Len=0
</pre>

<p>As you can see:</p>

<blockquote>
<p>Frame #7113: 10.10.10.10 -&gt; 20.20.20.20 SYN,ECN,CWR<br>
Frame #7151: 10.10.10.10 -&gt; 20.20.20.20 SYN,ECN,CWR<br>
</p>
</blockquote>

<p>then </p>

<blockquote>
<p>Frame #7152: 20.20.20.20 -&gt; 10.10.10.10 <strong>only</strong> ACK, no SYN/ACK. So this is not a valid reply.<br>
Frame #7153: 20.20.20.20 -&gt; 10.10.10.10 RST<br>
</p>
</blockquote>

<p>very strange and possibly a bug in the firmware of the firewall/loadbalancer (or server). See my previous comment.</p></div>
            <div class="comment-info" id="comment-17396-info">
                
                
                
                

                

                <span class="comment-age">(02 Jan '13, 13:06)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-17295" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 6
        </span>
        <a href="#" class="show-all-comments-link">show 1 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-17295-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="17382"></a>
                    <div id="answer-container-17382" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-17382-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/17382/up/" rel="nofollow"> </a>
<div id="post-17382-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-17382-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/17382/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>is there a way to adjust your tcp settings so that it doesn't send the second SYN until more time has passed?  If it's consistently taking ~2 seconds to respond to SYN, wait 3 before you retransmit, etc...  likewise, you might be able to use HPing or SCAPY to send a single SYN packet on it's own and just see what happens.  If you still get no reply or an RST, then it's an issue at/past whatever loadbalancer/firewall is in place.  I've only rarely used those programs, so I can't remember the relevent commands, but there's plenty of info online.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/17382/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>02 Jan '13, 05:38</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/8c8bb4331d25d8ed8241358cecc41b39?s=32&amp;d=identicon&amp;r=g" alt="W-George's gravatar image" />
    <p><a href="/users/4146/w-george">W-George</a><br/>
    <span class="score" title="20 reputation points">20</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="6 badges"><span class="bronze">&#9679;</span><span class="badgecount">6</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="W-George has no accepted answers">0&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-17382">
    
        <a name="17391"></a>
        <div class="comment" id="comment-17391">
            <div id="post-17391-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi George, I dont see a provision to edit this. The retry was almost 3secs i.e. 2.996 seconds. I will need to check with IBM if there is any issue in the firmware. Before that i wanted to make sure thats the reason.</p>

<p>Thanks</p></div>
            <div class="comment-info" id="comment-17391-info">
                
                
                
                

                

                <span class="comment-age">(02 Jan '13, 08:25)</span>
                <a class="comment-user userinfo" href="/users/4131/synresolver">synresolver</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-17382" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-17382-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/17280/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='4qEm72GtpVA6tXNHIbYS0MiYF9NWFxuW' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/17280/tcp-reset-by-the-server-due-to-2-consecutive-syns?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/17280/tcp-reset-by-the-server-due-to-2-consecutive-syns?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/consecutive/"
            class="tag-link-consecutive"
            title="see questions tagged'consecutive'using tags"
            rel="tag">consecutive</a> <span class="tag-number">&#215;2</span><br/>
        
        <a href="/tags/two/"
            class="tag-link-two"
            title="see questions tagged'two'using tags"
            rel="tag">two</a> <span class="tag-number">&#215;2</span><br/>
        
        <a href="/tags/syns/"
            class="tag-link-syns"
            title="see questions tagged'syns'using tags"
            rel="tag">syns</a> <span class="tag-number">&#215;1</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Dec. 27, 2012, 1:07 p.m.">27 Dec '12, 13:07</strong>
    </p>
    <p> 
     	question was seen: <strong>8,994 times</strong>
    </p>
    <p> 
        last updated: <strong title="Jan. 2, 2013, 1:07 p.m.">02 Jan '13, 13:07</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/49682/search-for-a-pattern-of-consecutive-packets">search for a pattern of consecutive packets</a>
        </p>
        
        <p>
            <a href="/questions/31803/pcapsipdump-synchronized-two-channel-audio">pcapsipdump synchronized two channel audio</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
