<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Split bundled packets into single - Wireshark Q&amp;A</title>
        <meta name="description" content="Hi,  I am wondering if there is an easy way to split bundled packets into separate. For example, I have a file which looks like this :  [IP][UDP][Header][Payload][Header2][Payloa2][Header3][Payload3][Header4][Payload4] So it is one IP packet which has 4 smaller packets bundled into one, on one row i..." />
        <meta name="keywords" content="lua,script,editcap,scripting,unbundle" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/20264/split-bundled-packets-into-single" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/20264/split-bundled-packets-into-single?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='m8bTGPZvgEcLJuicfdzwErP3j2dEDemH' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/20264/split-bundled-packets-into-single">Split bundled packets into single</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-20264-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/20264/up/" rel="nofollow"> </a>
<div id="post-20264-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-20264-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/20264/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/20264/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hi, </p>
<p>I am wondering if there is an easy way to split bundled packets into separate. For example, I have a file which looks like this : </p>
<p>[IP][UDP][Header][Payload][Header2][Payloa2][Header3][Payload3][Header4][Payload4]</p>
<p>So it is one IP packet which has 4 smaller packets bundled into one, on one row in wireshark. I would like to put each individual packet on a separate line. So that the file looks like this : </p>
<ul>
<li>[IP][UDP][Header][Payload] </li>
<li>[Header2][Payloa2]</li>
<li>[Header3][Payload3]</li>
<li>[Header4][Payload4]</li>
</ul>
<p>Is there a simple way of doing this? Using editcap, lua, some script etc? </p>
<p>Very grateful for help.</p>
<p>BR
Harkap</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/lua/" class="post-tag tag-link-lua"
                                        title="see questions tagged 'lua'" rel="tag">lua</a>
                                
                                    <a href="/tags/script/" class="post-tag tag-link-script"
                                        title="see questions tagged 'script'" rel="tag">script</a>
                                
                                    <a href="/tags/editcap/" class="post-tag tag-link-editcap"
                                        title="see questions tagged 'editcap'" rel="tag">editcap</a>
                                
                                    <a href="/tags/scripting/" class="post-tag tag-link-scripting"
                                        title="see questions tagged 'scripting'" rel="tag">scripting</a>
                                
                                    <a href="/tags/unbundle/" class="post-tag tag-link-unbundle"
                                        title="see questions tagged 'unbundle'" rel="tag">unbundle</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>10 Apr '13, 01:08</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7709c0c87ed4ba426f119187d3f0c705?s=32&amp;d=identicon&amp;r=g" alt="harkap's gravatar image" />
    <p><a href="/users/3782/harkap">harkap</a><br/>
    <span class="score" title="5 reputation points">5</span><span title="8 badges"><span class="badge1">&#9679;</span><span class="badgecount">8</span></span><span title="8 badges"><span class="silver">&#9679;</span><span class="badgecount">8</span></span><span title="11 badges"><span class="bronze">&#9679;</span><span class="badgecount">11</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="harkap has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/20264/">
                edited
                <strong>10 Apr '13, 01:08</strong>
            </a>
        </p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-20264">
    
        <a name="20281"></a>
        <div class="comment" id="comment-20281">
            <div id="post-20281-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>on one row in wireshark
I would like to put each individual packet on a separate line. </p>
</blockquote>

<p>What exactly do you mean by that? 
What kind of wireshark output do mean? GUI, text? How did you generate that output?</p></div>
            <div class="comment-info" id="comment-20281-info">
                
                
                
                

                

                <span class="comment-age">(10 Apr '13, 06:16)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="20286"></a>
        <div class="comment" id="comment-20286">
            <div id="post-20286-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi, </p>

<p><strong>What exactly do you mean by that?</strong></p>

<p>One line in the wireshark packet list pane : <a href="http://www.wireshark.org/docs/wsug_html_chunked/ChUsePacketListPaneSection.html">http://www.wireshark.org/docs/wsug_html_chunked/ChUsePacketListPaneSection.html</a></p>

<p><strong>What kind of wireshark output do mean?</strong></p>

<p>Save it as another .pcap file. </p>

<p><strong>How did you generate that output?</strong></p>

<p>What output do you mean? I have an .pcap file where I have captured packets.</p>

<p><strong>With "on one row in wireshark. I would like to put each individual packet on a separate line." I assumed the OP wants to have a new row in the packet list for each header/payload combo and not in the packet details</strong></p>

<p>Exactly</p>

<p>The background to this problem is that it is difficult to find an packet, that is an Header + Payload combination, that fulfills certain criteria (one field in the header = x and another field in the payload = y) When I put on this filter (header.1 = x &amp;&amp; payload.3 = y) wireshark gives me all the rows (lines) in the packet list where one packet has either header.1 = x or payload.3 = y. In this way it is very hard to find the specific packets that I am looking for. </p>

<p>Thats why I thought that splitting the bundled packets into smaller packets on each row would make this search work good. </p>

<p>Thanks so far.</p>

<p>BR
Harkap</p></div>
            <div class="comment-info" id="comment-20286-info">
                
                
                
                

                

                <span class="comment-age">(10 Apr '13, 07:42)</span>
                <a class="comment-user userinfo" href="/users/3782/harkap">harkap</a>
                
            </div>
        </div>
    
        <a name="20290"></a>
        <div class="comment" id="comment-20290">
            <div id="post-20290-score" class="comment-score"></div>
            <div class="comment-text"><p>That seems like a display-filter problem to me. What is the exact protocol you're working with? and what is the filter you're trying? Can you post a sample pcap on <a href="http://cloudshark.org">http://cloudshark.org</a> (and link it here)?</p></div>
            <div class="comment-info" id="comment-20290-info">
                
                
                
                

                

                <span class="comment-age">(10 Apr '13, 08:48)</span>
                <a class="comment-user userinfo" href="/users/817/helloworld">helloworld</a>
                
            </div>
        </div>
    
        <a name="20292"></a>
        <div class="comment" id="comment-20292">
            <div id="post-20292-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi, </p>

<p><strong>What is the exact protocol you're working with? and what is the filter you're trying?</strong></p>

<p>Unfortunately I cannot paste it here since it is work related data. But the appearence is similar. An Header with three data variables all one byte each x1, x2, x3. And Payload part has 5 data variables y1 3 bits y2 2 bits y3 3 bits y4 4 bits y5 4 bits. The filter I am using is (header.x3 == 4 &amp;&amp; payload.y2 == 2)</p>

<p>And, as mentioned, this expression displays all the rows in which at least one of the packets in the bundle has either header.x3 = 4 or payload.y2 = 2.</p>

<p>BR
Harkap</p></div>
            <div class="comment-info" id="comment-20292-info">
                
                
                
                

                

                <span class="comment-age">(10 Apr '13, 09:02)</span>
                <a class="comment-user userinfo" href="/users/3782/harkap">harkap</a>
                
            </div>
        </div>
    
        <a name="20295"></a>
        <div class="comment" id="comment-20295">
            <div id="post-20295-score" class="comment-score"></div>
            <div class="comment-text"><p>It could be a bug in your dissector -- particularly, in the way you're adding the fields (e.g., the bitmask or byte offset is wrong). Can you show the line of code from your dissector that adds the <code>header.x3</code> and <code>payload.y2</code> fields?</p></div>
            <div class="comment-info" id="comment-20295-info">
                
                
                
                

                

                <span class="comment-age">(10 Apr '13, 10:16)</span>
                <a class="comment-user userinfo" href="/users/817/helloworld">helloworld</a>
                
            </div>
        </div>
    
        <a name="20304"></a>
        <div class="comment not_top_scorer" id="comment-20304">
            <div id="post-20304-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi,</p>

<p><strong>Can you show the line of code from your dissector that adds the header.x3 and payload.y2 fields?</strong></p>

<p>This is not my dissector, its a built in dissector, somewhat changed for company modification. I am rather certain that it is no bug since the packet is a bundled packet, it is supposed to show all packets in the bundle on one line. </p>

<p>But perhaps you mean that something in the dissector implementation makes the filtering not work correctly? </p>

<p>BR
Harkap</p></div>
            <div class="comment-info" id="comment-20304-info">
                
                
                
                

                

                <span class="comment-age">(10 Apr '13, 23:12)</span>
                <a class="comment-user userinfo" href="/users/3782/harkap">harkap</a>
                
            </div>
        </div>
    
        <a name="20334"></a>
        <div class="comment not_top_scorer" id="comment-20334">
            <div id="post-20334-score" class="comment-score"></div>
            <div class="comment-text"><p>Right, that's what I meant. Which built-in dissector is it? We might be able to craft our own packet to troubleshoot this.</p></div>
            <div class="comment-info" id="comment-20334-info">
                
                
                
                

                

                <span class="comment-age">(11 Apr '13, 06:35)</span>
                <a class="comment-user userinfo" href="/users/817/helloworld">helloworld</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-20264" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 7
        </span>
        <a href="#" class="show-all-comments-link">show 2 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-20264-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/20264/split-bundled-packets-into-single?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/20264/split-bundled-packets-into-single?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/20264/split-bundled-packets-into-single?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/20264/split-bundled-packets-into-single?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="20265"></a>
                    <div id="answer-container-20265" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-20265-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/20265/up/" rel="nofollow"> </a>
<div id="post-20265-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-20265-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/20265/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>There is no (easy) way of doing that with wireshark as this is not how wireshark has been designed. The packet list is exactly that, it lists packets as they were seen on the network. However, with reassembly enabled, some data from packet X might be shown in packet Y as the payload had to be reassembled.</p>
<p>There is no way to split a packet into multiple entries in the packet list.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/20265/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>10 Apr '13, 01:46</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7901a94d8fdd1f9f47cda9a32fcfa177?s=32&amp;d=identicon&amp;r=g" alt="SYN-bit's gravatar image" />
    <p><a href="/users/5/syn-bit">SYN-bit ♦♦</a><br/>
    <span class="score" title="17094 reputation points"><span class="">17.1k</span></span><span title="9 badges"><span class="badge1">&#9679;</span><span class="badgecount">9</span></span><span title="57 badges"><span class="silver">&#9679;</span><span class="badgecount">57</span></span><span title="245 badges"><span class="bronze">&#9679;</span><span class="badgecount">245</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="SYN-bit has 174 accepted answers">20&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-20265">
    
        <a name="20279"></a>
        <div class="comment" id="comment-20279">
            <div id="post-20279-score" class="comment-score"></div>
            <div class="comment-text"><p>I think the OP is asking for dissectors for each payload in the packet. Depending on the protocol (and how much of the payload he/she wants dissected), that's relatively easy to do in C or Lua (Lua being simpler IMO).</p></div>
            <div class="comment-info" id="comment-20279-info">
                
                
                
                

                

                <span class="comment-age">(10 Apr '13, 06:12)</span>
                <a class="comment-user userinfo" href="/users/817/helloworld">helloworld</a>
                
            </div>
        </div>
    
        <a name="20282"></a>
        <div class="comment" id="comment-20282">
            <div id="post-20282-score" class="comment-score"></div>
            <div class="comment-text"><p>With "on one row in wireshark. I would like to put each individual packet on a separate line." I assumed the OP wants to have a new row in the packet list for each header/payload combo and not in the packet details (which as you say is very easy to implement).</p></div>
            <div class="comment-info" id="comment-20282-info">
                
                
                
                

                

                <span class="comment-age">(10 Apr '13, 06:18)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-20265" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-20265-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="20307"></a>
                    <div id="answer-container-20307" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-20307-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/20307/up/" rel="nofollow"> </a>
<div id="post-20307-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-20307-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/20307/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <blockquote>
<p>An Header with three data variables all one byte each x1, x2, x3. And Payload part has 5 
data variables y1 3 bits y2 2 bits y3 3 bits y4 4 bits y5 4 bits. The filter I am using 
is (header.x3 == 4 &amp;&amp; payload.y2 == 2)</p>
</blockquote>
<p>This filter will show all packets where: </p>
<ul>
<li>there is at least one header with an x3 field that has the value 4 <strong>AND</strong></li>
<li>there is at least one payload with an y2 field that has the value 2</li>
</ul>
<p><strong>BUT</strong> there is no guarantee that these fields are present in matching header/payload combinations.</p>
<blockquote>
<p>And, as mentioned, this expression displays all the rows in which at least one of
the packets in the bundle has either header.x3 = 4 or payload.y2 = 2</p>
</blockquote>
<p>Are you saying that there can be packets displayed where there is a header where field x3 has the value 4 but there is no payload in the packet that has a field y2 with the value 2 (or visa versa)? In that case there is indeed a bug in the filtering engine... </p>
<p>But my bet is that it's just showing packets where bot fields are present with the selected values, but just not in corresponding header/payload pairs.</p>
<p>Possible solutions:</p>
<ul>
<li>use <a href="http://wiki.wireshark.org/MATE">MATE</a> (but I'm not 100% sure it can do the trick)</li>
<li>Write a <a href="http://wiki.wireshark.org/Lua">LUA</a> tap to process your packets and do the matching</li>
<li>Use a script to create dummy packets for each header/payload combination as is done <a href="https://ask.wireshark.org/questions/12845/sctp-unbundle">here</a> for SCTP (you already found that question yourself)</li>
</ul>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/20307/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>11 Apr '13, 01:29</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7901a94d8fdd1f9f47cda9a32fcfa177?s=32&amp;d=identicon&amp;r=g" alt="SYN-bit's gravatar image" />
    <p><a href="/users/5/syn-bit">SYN-bit ♦♦</a><br/>
    <span class="score" title="17094 reputation points"><span class="">17.1k</span></span><span title="9 badges"><span class="badge1">&#9679;</span><span class="badgecount">9</span></span><span title="57 badges"><span class="silver">&#9679;</span><span class="badgecount">57</span></span><span title="245 badges"><span class="bronze">&#9679;</span><span class="badgecount">245</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="SYN-bit has 174 accepted answers">20&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-20307">
    
        <a name="20308"></a>
        <div class="comment" id="comment-20308">
            <div id="post-20308-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi,</p>

<p><strong>But my bet is that it's just showing packets where bot fields are present with the selected values, but just not in corresponding header/payload pairs.</strong></p>

<p>Correct. </p>

<p>I will look int MATE to see if I find it possible. I looked at the script for SCTP, but unfortunately understand very little about it, and how to apply it to my situation. By using LUA, do you mean that I create a script in which the input commands are what I am searching for, and then it searches the file and displays the lines?</p>

<p>Any suggestions of a clever high level way of implementing this would be highly appreciative.</p>

<p>BR
Harkap</p></div>
            <div class="comment-info" id="comment-20308-info">
                
                
                
                

                

                <span class="comment-age">(11 Apr '13, 01:46)</span>
                <a class="comment-user userinfo" href="/users/3782/harkap">harkap</a>
                
            </div>
        </div>
    
        <a name="20309"></a>
        <div class="comment" id="comment-20309">
            <div id="post-20309-score" class="comment-score"></div>
            <div class="comment-text"><p>(please use "add a comment" to respond to given answers, see the FAQ for details)</p>

<p>By creating a LUA TAP, you can examine the packet in full detail within the script, but I have no experience doing so, so I can't draw a high level design for you nor can I indicate how much work it would be.</p>

<p>As for the <a href="http://frox25.no-ip.org/~mtve/wiki/SctpDechunk.html">SCTP unbundle script</a>, you would need to alter/add the following:</p>

<ul>
<li>Alter parse_ip to look for udp data for your protocol and then call...</li>
<li>parse_udp routine to parse the UDP headers</li>
<li>parse_your_proto routine, this routine needs to detect where the bounderies are between the header/payload instances and then call put_pkt to write a packet for each header/payload combination</li>
<li>put_pkt needs to be altered so it knows how to write proper packets for your protocol (it is now focused on writing SCTP packets</li>
</ul>

<p>If you're unable to alter the script yourself or find someone to do it for you, you can contact me (address is in my user profile) on altering the script for you on a consultancy basis...</p></div>
            <div class="comment-info" id="comment-20309-info">
                
                
                
                

                

                <span class="comment-age">(11 Apr '13, 02:05)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="20453"></a>
        <div class="comment" id="comment-20453">
            <div id="post-20453-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi, </p>

<p>As for the LUA tap. I found the example and am wondering how it can be modified, see comment below. I have found that the tap works well in choosing the right packets, that is, where the combination of header and payload is correct. </p>

<p>-- simple_http.lua
-- implements a very simple tap in Lua</p>

<p>-- this is going to be our counter</p>

<p>http_packets = 0</p>

<p>-- this is going to be our tap</p>

<p>tap_http = nil</p>

<p>-- first we declare the tap called "http tap" with the filter it is going to use</p>

<p>tap_http = Listener.new(nil,"header.x1 == 2 &amp;&amp; payload.y3 == 7")</p>

<p>-- this function will get called at the end(3) of the capture to print the summary</p>

<p>function tap_http.draw()
    debug("http packets:" .. http_packets)
end</p>

<p>-- this function is going to be called once each time the filter of the tap matches</p>

<p>function tap_http.packet()
    <strong>-- Here I would like to print out the packet to a new pcap file, or new window or perhaps just the line (packet number ) where this packet can be found --</strong>
end</p>

<p>-- this function will be called at the end of the capture run</p>

<p>function tap_http.reset()
    http_packets = 0
end</p>

<p>Any Ideas? </p>

<p>Thank you 
/Harkap</p></div>
            <div class="comment-info" id="comment-20453-info">
                
                
                
                

                

                <span class="comment-age">(16 Apr '13, 00:48)</span>
                <a class="comment-user userinfo" href="/users/3782/harkap">harkap</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-20307" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-20307-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/20264/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='m8bTGPZvgEcLJuicfdzwErP3j2dEDemH' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/20264/split-bundled-packets-into-single?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/20264/split-bundled-packets-into-single?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/lua/"
            class="tag-link-lua"
            title="see questions tagged'lua'using tags"
            rel="tag">lua</a> <span class="tag-number">&#215;431</span><br/>
        
        <a href="/tags/editcap/"
            class="tag-link-editcap"
            title="see questions tagged'editcap'using tags"
            rel="tag">editcap</a> <span class="tag-number">&#215;33</span><br/>
        
        <a href="/tags/script/"
            class="tag-link-script"
            title="see questions tagged'script'using tags"
            rel="tag">script</a> <span class="tag-number">&#215;31</span><br/>
        
        <a href="/tags/scripting/"
            class="tag-link-scripting"
            title="see questions tagged'scripting'using tags"
            rel="tag">scripting</a> <span class="tag-number">&#215;8</span><br/>
        
        <a href="/tags/unbundle/"
            class="tag-link-unbundle"
            title="see questions tagged'unbundle'using tags"
            rel="tag">unbundle</a> <span class="tag-number">&#215;4</span><br/>
        
    </p>
    <p>
        question asked: <strong title="April 10, 2013, 1:08 a.m.">10 Apr '13, 01:08</strong>
    </p>
    <p> 
     	question was seen: <strong>8,107 times</strong>
    </p>
    <p> 
        last updated: <strong title="April 16, 2013, 1:40 a.m.">16 Apr '13, 01:40</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/36252/lua-script-for-wireshark">lua script for wireshark</a>
        </p>
        
        <p>
            <a href="/questions/20340/using-a-lua-script-to-unbundle-sctp-multi-chunk-packets-and-generate-custom-one-line-summaries-for-each-chunk">Using a Lua Script to Unbundle SCTP Multi-Chunk Packets and Generate Custom One-Line Summaries for Each Chunk</a>
        </p>
        
        <p>
            <a href="/questions/41697/automatically-exporting-csv-info">Automatically exporting csv info</a>
        </p>
        
        <p>
            <a href="/questions/20696/lua-tap-for-bundled-packets">lua tap for bundled packets</a>
        </p>
        
        <p>
            <a href="/questions/51581/isupbicc-filtering-by-field-in-a-lua-script">ISUP/BICC filtering by field in a Lua script</a>
        </p>
        
        <p>
            <a href="/questions/52324/addingappending-packet-comments-in-pcapng-file-with-the-lua-api">Adding/appending packet comments in pcapng file with the Lua API</a>
        </p>
        
        <p>
            <a href="/questions/10664/using-tshark-to-get-all-avaya-telephones-sorted">Using Tshark to get all Avaya telephones sorted..</a>
        </p>
        
        <p>
            <a href="/questions/52453/filtering-packets-in-lua">Filtering packets in LUA</a>
        </p>
        
        <p>
            <a href="/questions/12845/sctp-unbundle">SCTP unbundle</a>
        </p>
        
        <p>
            <a href="/questions/53283/tshark-script-to-capture-for-5-minutes">tshark script to capture for 5 minutes?</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
