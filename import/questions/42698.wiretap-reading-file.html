<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>WIRETAP Reading file? - Wireshark Q&amp;A</title>
        <meta name="description" content="Hi I am trying to find the packet filled file(which libpcap format packet finally dumped for wiretap) from where wiretap is taking and giving to wireshark but didint found, can you guys help me to find out but didnt find it,can you guys help me to get me out. I found the wtap_open_offline(where wire..." />
        <meta name="keywords" content="wiretap,feeding" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/42698/wiretap-reading-file" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/42698/wiretap-reading-file?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='EYXCQEeXPV8cbU2aMLH04RblfLoYa63s' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/42698/wiretap-reading-file">WIRETAP Reading file?</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-42698-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/42698/up/" rel="nofollow"> </a>
<div id="post-42698-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-42698-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/42698/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/42698/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hi I am trying to find the packet filled file(which libpcap format packet finally dumped for wiretap) from where wiretap is taking and giving to wireshark but didint found, can you guys help me to find out but didnt find it,can you guys help me to get me out.</p>
<p>I found the wtap_open_offline(where wiretap is opening the file and doing some wiretap reading ops).But not able to find the file.</p>
<p>Thanks,
Karun.</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/wiretap/" class="post-tag tag-link-wiretap"
                                        title="see questions tagged 'wiretap'" rel="tag">wiretap</a>
                                
                                    <a href="/tags/feeding/" class="post-tag tag-link-feeding"
                                        title="see questions tagged 'feeding'" rel="tag">feeding</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>27 May '15, 06:36</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/50c4b78862c6ca806916c3a71498cdf3?s=32&amp;d=identicon&amp;r=g" alt="karun256's gravatar image" />
    <p><a href="/users/17320/karun256">karun256</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="5 badges"><span class="badge1">&#9679;</span><span class="badgecount">5</span></span><span title="5 badges"><span class="silver">&#9679;</span><span class="badgecount">5</span></span><span title="7 badges"><span class="bronze">&#9679;</span><span class="badgecount">7</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="karun256 has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/42698/">
                edited
                <strong>27 May '15, 06:43</strong>
            </a>
        </p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-42698">
    
</div>
<div id="comment-tools-42698" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-42698-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/42698/wiretap-reading-file?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/42698/wiretap-reading-file?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/42698/wiretap-reading-file?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/42698/wiretap-reading-file?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="42707"></a>
                    <div id="answer-container-42707" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-42707-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/42707/up/" rel="nofollow"> </a>
<div id="post-42707-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-42707-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/42707/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>libpcap.c for libpcap files and pcapng.c for pcap-ng files</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/42707/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>27 May '15, 08:33</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/2d3d425a7a829209431fb38d326b53af?s=32&amp;d=identicon&amp;r=g" alt="Anders's gravatar image" />
    <p><a href="/users/42/anders">Anders ♦</a><br/>
    <span class="score" title="4578 reputation points"><span class="">4.6k</span></span><span title="9 badges"><span class="silver">&#9679;</span><span class="badgecount">9</span></span><span title="52 badges"><span class="bronze">&#9679;</span><span class="badgecount">52</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Anders has 56 accepted answers">17&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-42707">
    
        <a name="42715"></a>
        <div class="comment" id="comment-42715">
            <div id="post-42715-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks Anders,in text2pcap.c we are preparing the libpcap format(Global header,Record header,data,Record header,data ...) right? In that line 1854 we are opening a file in read mode,from where we are getting this file to read and from where this argc &amp; argv are coming(who is running this .c file with command line arguments).Actually i want to see that file by opening it.</p>

<p>Similarly in capinfos.c we are opening that file and preparing wtap structure by reading that file in function wtap_open_offline() in which first argument is file.I want to know where its taking that file</p>

<p>Actually i want to create packet to display on wireshark,so my plan is that i want to mimic my packet as it is like libpcap format and want to give to wiretap so that wiretap will display the packet in wireshark.So i want to see the packet that libpcap is preparing for wiretap.</p>

<p>Exactly i want to know where we are feeding this packet to wiretap.</p>

<pre><code>    Correct me if am wrong.
</code></pre>

<p>Thanks,
Karun.</p></div>
            <div class="comment-info" id="comment-42715-info">
                
                
                
                

                

                <span class="comment-age">(27 May '15, 21:54)</span>
                <a class="comment-user userinfo" href="/users/17320/karun256">karun256</a>
                
            </div>
        </div>
    
        <a name="42717"></a>
        <div class="comment" id="comment-42717">
            <div id="post-42717-score" class="comment-score"></div>
            <div class="comment-text"><p>This might be better to discuss on the dev mailing list rather tha on a Q&amp;A site...</p>

<p>I think we need to understand what you are trying to do on a higer level to be able to asnswer your questions better.</p>

<blockquote>
<p>Actually i want to create packet to display on wireshark</p>
</blockquote>

<p>What do you mean by this? Fire up wireshark from within your application and feed it the data? Create a pcap(ng) file and read that
into wireshark afterwards? Perhaps you could feed the data to wireshak trough a pipe or have tshark deissect it and present the text output? Create a packet from what? If you are processing a log file with mixed text and packet hexdata you could perhaps write code to have Wireshark read the file directly.</p></div>
            <div class="comment-info" id="comment-42717-info">
                
                
                
                

                

                <span class="comment-age">(28 May '15, 00:56)</span>
                <a class="comment-user userinfo" href="/users/42/anders">Anders ♦</a>
                
            </div>
        </div>
    
        <a name="42720"></a>
        <div class="comment" id="comment-42720">
            <div id="post-42720-score" class="comment-score"></div>
            <div class="comment-text"><p>Exactly i want to create packet from my application and feed the data inorder to display in wireshark.I had taken development release 1.99.5 for windows 7.
 My intension is to prepare my packet and keep it in winpcap format and feed it to wiretap(rest will take care by wiretap right?).</p></div>
            <div class="comment-info" id="comment-42720-info">
                
                
                
                

                

                <span class="comment-age">(28 May '15, 02:58)</span>
                <a class="comment-user userinfo" href="/users/17320/karun256">karun256</a>
                
            </div>
        </div>
    
        <a name="42721"></a>
        <div class="comment" id="comment-42721">
            <div id="post-42721-score" class="comment-score"></div>
            <div class="comment-text"><p>You should maybe look into extcap.  That allows applications that aren't a "network interface" to send data to Wireshark.</p>

<p>Unfortunately extcap is very poorly documented at the moment.  There should be a man page (extcap.html) for it in an installed copy of the dev release and an example application in source doc\extcap_example.py.  There is als an older SharkFest presentation <a href="https://sharkfest.wireshark.org/sharkfest.13/presentations/NAP-11_Expanding-Wireshark-Beyond-Ethernet-and-Network-Interfaces_Kershaw-Ryan.pdf">here</a>.</p>

<p>If you need more info about extcap the best place to ask would be on the Wireshark developers mailing list.</p></div>
            <div class="comment-info" id="comment-42721-info">
                
                
                
                

                

                <span class="comment-age">(28 May '15, 03:44)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="42725"></a>
        <div class="comment" id="comment-42725">
            <div id="post-42725-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks grahamb, can you share me the developers mailing list.Actually is it possible as i discussed in my previous mail,will it works? other than extcap.</p></div>
            <div class="comment-info" id="comment-42725-info">
                
                
                
                

                

                <span class="comment-age">(28 May '15, 03:54)</span>
                <a class="comment-user userinfo" href="/users/17320/karun256">karun256</a>
                
            </div>
        </div>
    
        <a name="42727"></a>
        <div class="comment not_top_scorer" id="comment-42727">
            <div id="post-42727-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="https://www.wireshark.org/lists/">https://www.wireshark.org/lists/</a></p>

<p>Wireshark can read from pipes, so it might be possible for your application to create a pipe that Wireshark can read from, but there are difficulties in the Wireshark UI for selecting the pipe.  This is what extcap is designed to overcome.</p></div>
            <div class="comment-info" id="comment-42727-info">
                
                
                
                

                

                <span class="comment-age">(28 May '15, 04:53)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="42729"></a>
        <div class="comment not_top_scorer" id="comment-42729">
            <div id="post-42729-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>...feed it to wiretap(rest will take care by wiretap right?).</p>
</blockquote>

<p>No, Wireshark uses wiretap to read from files as I understand your idea you need to invoke Wireshark to read your packet somehow or at least invoke the dissection engine from your program which may not de so easy as it's not designed to work that way.</p></div>
            <div class="comment-info" id="comment-42729-info">
                
                
                
                

                

                <span class="comment-age">(28 May '15, 05:04)</span>
                <a class="comment-user userinfo" href="/users/42/anders">Anders ♦</a>
                
            </div>
        </div>
    
        <a name="42771"></a>
        <div class="comment not_top_scorer" id="comment-42771">
            <div id="post-42771-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks Anders,Dumpcap.c is n/w traffic dump tool which will capture packets form real interface and keep it in some output file stream(ASCII hex form).text2pcap.c is the file which converts the ascii hex into winpcap(windows)/libpcap(Linux) format.wireshark uses wiretap to read the above prepared winpcap format file.correct me if my understanding is wrong.</p>

<p>wireshark&lt;---wiretap&lt;---libpcap/winpcap(text2pcap.c)&lt;---dumpcap.c&lt;---n/w intf.</p>

<pre><code>  Is my above understanding is right?
</code></pre>

<p>Whats the functionality of capinfos.c and who is giving argv,argc to that file,as its using argc ,argv and preparing wtap structure.</p></div>
            <div class="comment-info" id="comment-42771-info">
                
                
                
                

                

                <span class="comment-age">(31 May '15, 02:47)</span>
                <a class="comment-user userinfo" href="/users/17320/karun256">karun256</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-42707" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 8
        </span>
        <a href="#" class="show-all-comments-link">show 3 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-42707-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="42777"></a>
                    <div id="answer-container-42777" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-42777-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/42777/up/" rel="nofollow"> </a>
<div id="post-42777-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-42777-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/42777/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <blockquote>
<p>Dumpcap.c is n/w traffic dump tool which will capture packets form real interface and keep it in some output file stream(ASCII hex form).text2pcap.c is the file which converts the ascii hex into winpcap(windows)/libpcap(Linux) format.wireshark uses wiretap to read the above prepared winpcap format file.correct me if my understanding is wrong.
wireshark&lt;---wiretap&lt;---libpcap/winpcap(text2pcap.c)&lt;---dumpcap.c&lt;---n/w intf.</p>
</blockquote>
<p>Your understanding is wrong.</p>
<p>Dumpcap uses libpcap to capture packets, meaning that the packets are read from the network interface by libpcap and handed to dumpcap,</p>
<p>Those packets are in <em>binary</em> form, not text form.</p>
<p>Dumpcap then writes the packets to a pcap or pcap-ng file, in <em>binary</em> format; it's all binary, so text2pcap is not involved <em>at all</em>.  It writes them out using Wireshark's own code, not libpcap/WinPcap (which currently can't write pcap-ng files).  That code is in pcapio.c</p>
<p>Wireshark (or TShark) then reads from the same file, using Wiretap.</p>
<p>So it's more like</p>
<p>Network interface ---&gt;dumpcap---&gt;pcapio.c---&gt;{the capture file}---&gt;wiretap---&gt;Wireshark</p>
<p>text2pcap is a <em>separate</em> program, which is used to turn ASCII hex dump files, which usually come from sources <em>other</em> than Wireshark, into pcap files.  It is <em>not at all</em> involved in the packet capture process.</p>
<blockquote>
<p>Whats the functionality of capinfos.c </p>
</blockquote>
<p>It reads capture files and prints some summary data for it.</p>
<blockquote>
<p>who is giving argv,argc to that file</p>
</blockquote>
<p>The program that runs it, whether it's the command-line interpreter (shell, cmd.exe, whatever) or some other program.  It's no different from any <em>other</em> C program in that regard; you <em>are</em> familiar with how UN*X and Windows command-line programs are written in C, right?  If not, you're going to have difficulty understanding the code in Wireshark programs that processes argc and argv, so you should probably make sure you're familiar with that before doing any more work on this.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/42777/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>31 May '15, 14:30</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" alt="Guy%20Harris's gravatar image" />
    <p><a href="/users/79/guy-harris">Guy Harris ♦♦</a><br/>
    <span class="score" title="17443 reputation points"><span class="">17.4k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">&#9679;</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">&#9679;</span><span class="badgecount">196</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Guy Harris has 216 accepted answers">19&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-42777">
    
        <a name="42779"></a>
        <div class="comment" id="comment-42779">
            <div id="post-42779-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks Harris,you kept me in write path.Dumpcap then writes the packets to a pcap or pcap-ng file?. Where is this file? whats the name? </p>

<p>Network interface ---&gt;dumpcap---&gt;pcapio.c---&gt;{the capture file}---&gt;wiretap---&gt;Wireshark<br>
</p>

<p>In above scenario where i can find the capture file.</p>

<p>Once capture file is created capinfos.c reads it and print some summary data for it right? then its followed by wireshark reading that file using wiretap and make it display to end user right?</p>

<p>Once every thing is ready How &amp; where wiretap is using that file meaning that  <br>
     capture file---&gt;(?)---&gt;wiretap---&gt;(?)---&gt;wireshark.
 Where we are feeding the packet to wiretap and how wireshark is using the file(or something) to display that packet from wiretap.</p>

<p>Can you give me the clear idea(file names will be more appreciated with functionalities) about capture file to wiretap &amp; to wireshark(end user display).</p></div>
            <div class="comment-info" id="comment-42779-info">
                
                
                
                

                

                <span class="comment-age">(31 May '15, 21:55)</span>
                <a class="comment-user userinfo" href="/users/17320/karun256">karun256</a>
                
            </div>
        </div>
    
        <a name="42780"></a>
        <div class="comment" id="comment-42780">
            <div id="post-42780-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks for your patience answering.</p>

<p>Actually i want to create one packet(By some application) inorder to display in wireshark with out having any n/w device.can you suggest me best method to do that?.</p>

<p>My plan is like to prepare my packet in specified(winpcap) format by using functions of pcapio.c and prepare one capture file then wireshark reads that packet using wiretap to display is it ok?</p>

<p><strong><em>***I am working on windows platform</em></strong>**</p></div>
            <div class="comment-info" id="comment-42780-info">
                
                
                
                

                

                <span class="comment-age">(31 May '15, 22:01)</span>
                <a class="comment-user userinfo" href="/users/17320/karun256">karun256</a>
                
            </div>
        </div>
    
        <a name="42783"></a>
        <div class="comment" id="comment-42783">
            <div id="post-42783-score" class="comment-score"></div>
            <div class="comment-text"><p>As I mentioned earlier, I think extcap is the solution for you.  It allows non-network devices to pass data into Wireshark for dissection and display.</p></div>
            <div class="comment-info" id="comment-42783-info">
                
                
                
                

                

                <span class="comment-age">(01 Jun '15, 01:54)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="42813"></a>
        <div class="comment" id="comment-42813">
            <div id="post-42813-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>Actually i want to create one packet(By some application) inorder to display in wireshark with out having any n/w device.can you suggest me best method to do that?</p>
</blockquote>

<p>Use <a href="http://www.winpcap.org">WinPcap</a>.  Have your application call <code>pcap_open_dead()</code> with whatever link-layer header format you want (for example, Ethernet, or "raw IP" with no link-layer headers), and then use the resulting <code>pcap_t</code> to open an output file with <code>pcap_dump_open()</code>.  Then have it construct the packet, with <em>all</em> the protocol layers - including the link-layer header you want, if there is one - and write it out with <code>pcap_dump()</code>, and then call <code>pcap_dump_close()</code>.  When your application finishes, it will have written out the file. Open that file in Wireshark.</p>

<blockquote>
<p>My plan is like to prepare my packet in specified(winpcap) format by using functions of pcapio.c and prepare one capture file then wireshark reads that packet using wiretap to display is it ok?</p>
</blockquote>

<p>"WinPcap format" is pcap format; WinPcap will write out files in that format.  libpcap/WinPcap was <em>designed</em> to be used as a library by applications; the pcapio.c code was written solely for use within Wireshark and really isn't designed for somebody else to use in their own program.</p></div>
            <div class="comment-info" id="comment-42813-info">
                
                
                
                

                

                <span class="comment-age">(01 Jun '15, 12:13)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="42822"></a>
        <div class="comment" id="comment-42822">
            <div id="post-42822-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks Harris,I will try to follow your suggestion.I want to conform one thing,I had taken winpcap latest source code by going through the code from pcap_open_live i encountered probe function where i found  PktReceive function(as mentioned below), in that copying actual data into buf from &amp;head-&gt;destin,Where we are filling this destin?.
  PUBLIC int PktReceive (BYTE <em>buf, int max)
  {
    WORD inOfs  = </em>rxInOfsFp;
    WORD outOfs = *rxOutOfsFp;</p>

<pre><code>if (outOfs != inOfs)
{
  RX_ELEMENT _far *head = (RX_ELEMENT _far*)(protBase+outOfs);
  int size, len = max;

  if (CheckElement(head))
  {
    size = min (head-&gt;firstCount, sizeof(RX_ELEMENT));
    len  = min (size, max);
    _fmemcpy (buf, &amp;head-&gt;destin, len);
  }
  else
    size = -1;

  outOfs += sizeof (RX_ELEMENT);
  if (outOfs &gt; LAST_RX_BUF)
      outOfs = FIRST_RX_BUF;
  *rxOutOfsFp = outOfs;
  return (size);
}
return (0);
</code></pre>

<p>}</p></div>
            <div class="comment-info" id="comment-42822-info">
                
                
                
                

                

                <span class="comment-age">(02 Jun '15, 01:03)</span>
                <a class="comment-user userinfo" href="/users/17320/karun256">karun256</a>
                
            </div>
        </div>
    
        <a name="42833"></a>
        <div class="comment not_top_scorer" id="comment-42833">
            <div id="post-42833-score" class="comment-score"></div>
            <div class="comment-text"><p>That's a separate issue, and it's probably best to ask questions about WinPcap's internals on the <a href="https://www.winpcap.org/mailman/listinfo/winpcap-users">WinPcap mailing list</a>.  I don't have time to go through the entire packet capture code path in WinPcap, and that's not relevant to what you're trying to do in any case.</p></div>
            <div class="comment-info" id="comment-42833-info">
                
                
                
                

                

                <span class="comment-age">(02 Jun '15, 12:37)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-42777" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 6
        </span>
        <a href="#" class="show-all-comments-link">show 1 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-42777-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/42698/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='EYXCQEeXPV8cbU2aMLH04RblfLoYa63s' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/42698/wiretap-reading-file?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/42698/wiretap-reading-file?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/wiretap/"
            class="tag-link-wiretap"
            title="see questions tagged'wiretap'using tags"
            rel="tag">wiretap</a> <span class="tag-number">&#215;7</span><br/>
        
        <a href="/tags/feeding/"
            class="tag-link-feeding"
            title="see questions tagged'feeding'using tags"
            rel="tag">feeding</a> <span class="tag-number">&#215;1</span><br/>
        
    </p>
    <p>
        question asked: <strong title="May 27, 2015, 6:36 a.m.">27 May '15, 06:36</strong>
    </p>
    <p> 
     	question was seen: <strong>2,100 times</strong>
    </p>
    <p> 
        last updated: <strong title="June 2, 2015, 12:37 p.m.">02 Jun '15, 12:37</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/3753/reading-cap-file-network-associates-sniffer-v-200x-with-wiretap">reading .cap file (Network Associates Sniffer v 2.00x) with wiretap</a>
        </p>
        
        <p>
            <a href="/questions/5244/what-functions-is-used-in-wiretap-to-readwrite-packet-files">What function(s) is used in wiretap to read/write packet files?</a>
        </p>
        
        <p>
            <a href="/questions/39222/looking-for-a-wiretap-device">looking for a wiretap device</a>
        </p>
        
        <p>
            <a href="/questions/39939/how-can-i-create-pcap-ng-files-using-the-wiretap-library">How can I create pcap-ng files using the wiretap library</a>
        </p>
        
        <p>
            <a href="/questions/40249/using-wiretap-to-write-a-pcapng-file">Using Wiretap to write a pcapng file</a>
        </p>
        
        <p>
            <a href="/questions/41571/cant-find-wiretap-1990dll">can&#39;t find wiretap-1.99.0.dll</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
