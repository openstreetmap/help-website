<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Problems with capturing other device WLAN traffic - Wireshark Q&amp;A</title>
        <meta name="description" content="Hey,  I know this question gets asked a lot but im lost and I need it for a presentation tomorrow so I have to ask. Im trying to capture the traffic of my phone on my laptop which runs Linux Mint, both are in the WLAN network. I&#39;ve already have monitor mode enabled, according to the wiki page: I ran..." />
        <meta name="keywords" content="wlan,wireshark" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/49288/problems-with-capturing-other-device-wlan-traffic" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/49288/problems-with-capturing-other-device-wlan-traffic?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='0ZzuCgUkOGLnRhUiuiK2yzvB1zjTgQgX' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/49288/problems-with-capturing-other-device-wlan-traffic">Problems with capturing other device WLAN traffic</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-49288-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/49288/up/" rel="nofollow"> </a>
<div id="post-49288-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-49288-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/49288/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/49288/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hey,<br>
</p>
<p>I know this question gets asked a lot but im lost and I need it for a presentation tomorrow so I have to ask.<br>
Im trying to capture the traffic of my phone on my laptop which runs Linux Mint, both are in the WLAN network.<br>
I've already have monitor mode enabled, according to the wiki page: I ran <code>sudo airmon-ng start wlan0</code> which worked (it showed a table with the message "monitor mode enabled on mon0"). I've also entered my WLAN key (mykey-myssid) in the IEEE preferences field as a WPA2-PWD key. Then I started to capture mon0. It didn't work, I filtered "http" and nothing showed up when I browsed the net with my phone. I also started wireshark with sudo.</p>
<p>Help is really appreciated, thanks for your time! I hope this question wasnt too dumb</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/wlan/" class="post-tag tag-link-wlan"
                                        title="see questions tagged 'wlan'" rel="tag">wlan</a>
                                
                                    <a href="/tags/wireshark/" class="post-tag tag-link-wireshark"
                                        title="see questions tagged 'wireshark'" rel="tag">wireshark</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>17 Jan '16, 10:11</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/233514f4b7a24c2e61f040d0a0b9d456?s=32&amp;d=identicon&amp;r=g" alt="Nakroma's gravatar image" />
    <p><a href="/users/22526/nakroma">Nakroma</a><br/>
    <span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="5 badges"><span class="bronze">&#9679;</span><span class="badgecount">5</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Nakroma has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-49288">
    
        <a name="49289"></a>
        <div class="comment" id="comment-49289">
            <div id="post-49289-score" class="comment-score"></div>
            <div class="comment-text"><ul>
<li>Have you captured any packets at all?</li>
<li>Have you used <code>http</code> as capture filter or as display filter?</li>
<li>Have you restarted the phone (or logged it off the WiFi and on again) before starting the capture?</li>
</ul></div>
            <div class="comment-info" id="comment-49289-info">
                
                
                
                

                

                <span class="comment-age">(17 Jan '16, 10:21)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="49290"></a>
        <div class="comment" id="comment-49290">
            <div id="post-49290-score" class="comment-score"></div>
            <div class="comment-text"><p>sindy Yes, I capture a lot of packets. I used as a display filter (the one above the packet list). And I just relogged the phone into the wifi and tried again, but no http packets are being captured.</p></div>
            <div class="comment-info" id="comment-49290-info">
                
                
                
                

                

                <span class="comment-age">(17 Jan '16, 10:25)</span>
                <a class="comment-user userinfo" href="/users/22526/nakroma">Nakroma</a>
                
            </div>
        </div>
    
        <a name="49291"></a>
        <div class="comment" id="comment-49291">
            <div id="post-49291-score" class="comment-score"></div>
            <div class="comment-text"><p>In that case, either something is wrong with the way you've configured the WPA password in Wireshark, or the web page you've visited from the phone was not plain http but https, so there was double encryption, one for the wireless transmission (between the phone and the AP) and one for the phone to web server transmission. Can you see any packets if you apply a display filter <code>tcp.dstport == 443</code> instead of <code>http</code> on the capture?</p>

<p>If you want more help, you have to post your capture file somewhere, provide a link to it here, and give the WPA password here as well. To do so, you'll probably prefer to change the WPA password before capturing, so that you wouldn't publish the one you use normally.</p></div>
            <div class="comment-info" id="comment-49291-info">
                
                
                
                

                

                <span class="comment-age">(17 Jan '16, 10:40)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="49293"></a>
        <div class="comment" id="comment-49293">
            <div id="post-49293-score" class="comment-score"></div>
            <div class="comment-text"><p>sindy That could be possible. Nothing shows up with tcp.dstport either. The site I visited is not https (just checked). Here the capture file: www.filedropper.com/capture_6
My WPA password is YJHGBQXC and my SSID is UPC2323467</p></div>
            <div class="comment-info" id="comment-49293-info">
                
                
                
                

                

                <span class="comment-age">(17 Jan '16, 10:54)</span>
                <a class="comment-user userinfo" href="/users/22526/nakroma">Nakroma</a>
                
            </div>
        </div>
    
        <a name="49295"></a>
        <div class="comment" id="comment-49295">
            <div id="post-49295-score" class="comment-score"></div>
            <div class="comment-text"><p>Are you really sure you have logged off and on the WiFi network from the Samsung phone after starting the capture? The easiest and most reliable way to do so is to disable the WiFi completely and then enable it again. As <a href="/users/16160/christian_r">@Christian_R</a> has pointed out, the EAPOL handshake (which happens when the phone is logging in to the WiFi) is missing in your capture.</p></div>
            <div class="comment-info" id="comment-49295-info">
                
                
                
                

                

                <span class="comment-age">(17 Jan '16, 11:12)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="49297"></a>
        <div class="comment not_top_scorer" id="comment-49297">
            <div id="post-49297-score" class="comment-score"></div>
            <div class="comment-text"><p>Ah I misread, I restarted it before the capture. I tried it again, going into the wifi after starting the capture. I checked, the EAPOL packets are there, but still no WiFi/TCP.dstport stuff. Heres the new capture file: www.filedropper.com/capture_7</p></div>
            <div class="comment-info" id="comment-49297-info">
                
                
                
                

                

                <span class="comment-age">(17 Jan '16, 11:20)</span>
                <a class="comment-user userinfo" href="/users/22526/nakroma">Nakroma</a>
                
            </div>
        </div>
    
        <a name="49298"></a>
        <div class="comment not_top_scorer" id="comment-49298">
            <div id="post-49298-score" class="comment-score"></div>
            <div class="comment-text"><p>This time it works for me... have you added the <code>PASSWORD:KEY</code> as <code>wpa-psk</code> or <code>wpa-pwd</code> type to the IEEE80211 key list? <code>wpa-pwd</code> is correct, with contents <code>YJHGBQXC:UPC2323467</code>. If you did it wrong, don't forget to remove the previous item, and better save the capture file, exit Wireshark and open the capture file again. The key list is saved automatically between Wireshark runs, to the profile, no need to care about it.</p></div>
            <div class="comment-info" id="comment-49298-info">
                
                
                
                

                

                <span class="comment-age">(17 Jan '16, 11:40)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="49299"></a>
        <div class="comment not_top_scorer" id="comment-49299">
            <div id="post-49299-score" class="comment-score"></div>
            <div class="comment-text"><p>It works for you? Thats weird. Heres a screenshot of my key list: <a href="http://epvpimg.com/0D6Ae.png">http://epvpimg.com/0D6Ae.png</a></p></div>
            <div class="comment-info" id="comment-49299-info">
                
                
                
                

                

                <span class="comment-age">(17 Jan '16, 11:52)</span>
                <a class="comment-user userinfo" href="/users/22526/nakroma">Nakroma</a>
                
            </div>
        </div>
    
        <a name="49300"></a>
        <div class="comment not_top_scorer" id="comment-49300">
            <div id="post-49300-score" class="comment-score"></div>
            <div class="comment-text"><p>Lol never mind, I missed the enable decryption field. I feel retarded. It actually works now! Thanks a lot :)</p></div>
            <div class="comment-info" id="comment-49300-info">
                
                
                
                

                

                <span class="comment-age">(17 Jan '16, 11:55)</span>
                <a class="comment-user userinfo" href="/users/22526/nakroma">Nakroma</a>
                
            </div>
        </div>
    
        <a name="49301"></a>
        <div class="comment not_top_scorer" id="comment-49301">
            <div id="post-49301-score" class="comment-score"></div>
            <div class="comment-text"><p>Could you please check "enable decryption" in the window from which you open the key list (seen at your screenshot above the key list window).</p></div>
            <div class="comment-info" id="comment-49301-info">
                
                
                
                

                

                <span class="comment-age">(17 Jan '16, 11:55)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="49302"></a>
        <div class="comment not_top_scorer" id="comment-49302">
            <div id="post-49302-score" class="comment-score"></div>
            <div class="comment-text"><p>Yeah I just noticed it too lol. Thank you very much, works perfectly</p></div>
            <div class="comment-info" id="comment-49302-info">
                
                
                
                

                

                <span class="comment-age">(17 Jan '16, 12:05)</span>
                <a class="comment-user userinfo" href="/users/22526/nakroma">Nakroma</a>
                
            </div>
        </div>
    
        <a name="49303"></a>
        <div class="comment not_top_scorer" id="comment-49303">
            <div id="post-49303-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes, that was it. However, what I don't like are two points:</p>

<ul>
<li>while the packets <em>from</em> the Samsung to the Technicolor (UPC) box are just fine and now as you've enabled the decryption, you can see the http requests and other stuff in that direction, the packets from the Technicolor box to the Samsung have a wrong Frame Check Sequence and so Wireshark does not decode them. I assume the phone was normally showing the web pages, so either the FCS is actually correct and Wireshark doesn't calculate it properly, or the Samsung (and all of your other equipment connected to the AP) ignores the wrong FCS. Worse than that for the moment, no combination of <code>Assume packets have FCS</code> and <code>Validate the FCS checksum if possible</code> protocol preferences makes Wireshark decrypt those packets.</li>
</ul>

<p>Therefore I hereby ask whether I may use the capture &amp; the password:ssid information to file a bug at Wireshark? Because it is hard to believe that this error would be outside Wireshark.</p>

<ul>
<li>the password and SSID you've given seem to be the default ones from the sticker on the box. If this is your usual setting, then any of your neighbours can use your internet connection, because someone has published a software enabling to determine the password from the SSID for these Technicolor boxes which use <code>UPCddddddd</code> (seven digits) as default SSID.</li>
</ul></div>
            <div class="comment-info" id="comment-49303-info">
                
                
                
                

                

                <span class="comment-age">(17 Jan '16, 12:14)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="49304"></a>
        <div class="comment not_top_scorer" id="comment-49304">
            <div id="post-49304-score" class="comment-score"></div>
            <div class="comment-text"><p>Yeah you can. And thanks for making me aware of that security leak</p></div>
            <div class="comment-info" id="comment-49304-info">
                
                
                
                

                

                <span class="comment-age">(17 Jan '16, 12:16)</span>
                <a class="comment-user userinfo" href="/users/22526/nakroma">Nakroma</a>
                
            </div>
        </div>
    
        <a name="49305"></a>
        <div class="comment not_top_scorer" id="comment-49305">
            <div id="post-49305-score" class="comment-score"></div>
            <div class="comment-text"><p>Done... and my apologies, I really wrote you should restart the WiFi connection <em>before</em> starting the capture in my very first comment, which was of course wrong. The reason why it is necessary to capture the EAPOL handshake is that the WPA password is not used to encrypt the complete traffic but only to encrypt the EAPOL handshake, which is an exchange of the actual session keys which are randomly generated for each new session.</p></div>
            <div class="comment-info" id="comment-49305-info">
                
                
                
                

                

                <span class="comment-age">(17 Jan '16, 13:30)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="49328"></a>
        <div class="comment not_top_scorer" id="comment-49328">
            <div id="post-49328-score" class="comment-score"></div>
            <div class="comment-text"><p>Hey sindy, I researched a bit about the UPC thing. Are you sure theres actually a whole program to do that? Any article I found said you'd have to brutforce the password</p></div>
            <div class="comment-info" id="comment-49328-info">
                
                
                
                

                

                <span class="comment-age">(18 Jan '16, 09:02)</span>
                <a class="comment-user userinfo" href="/users/22526/nakroma">Nakroma</a>
                
            </div>
        </div>
    
        <a name="49334"></a>
        <div class="comment not_top_scorer" id="comment-49334">
            <div id="post-49334-score" class="comment-score"></div>
            <div class="comment-text"><p>I hope I won't get a ban for life for posting such a thing here, but the source code of that SSID-&gt;default password converter was still available at <code><a href="http://haxx.in/upc_keys.c">http://haxx.in/upc_keys.c</a></code> five minutes ago (and called "password recovery tool").</p>

<p>Up to the local (Czech) online media, which have drawn my attention to the issue, two device types are affected: TC7200 (Technicolor) and UbeeEVW3226. The MAC address prefix in your capture indicates that yours is Technicolor, but not necessarily a 7200.</p>

<p>If you call trying out which of the 8 generated passwords is the correct one a "brute force attack", then OK, you need brute force :)</p></div>
            <div class="comment-info" id="comment-49334-info">
                
                
                
                

                

                <span class="comment-age">(18 Jan '16, 13:44)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="49368"></a>
        <div class="comment not_top_scorer" id="comment-49368">
            <div id="post-49368-score" class="comment-score"></div>
            <div class="comment-text"><p>Someone has even taken the effort to make it a web application...</p>

<p><a href="https://upc.michalspacek.cz/UPC2323467">https://upc.michalspacek.cz/UPC2323467</a></p>

<p>And OK, it is not 8 candidate passwords - depending on the frequency band you've activated at the AP, it is 18 passwords to try for 2.4 GHz and 27 for 5 GHz, because it seems that the manufacturing series (which the attacker cannot find from the SSID) also plays a role.</p></div>
            <div class="comment-info" id="comment-49368-info">
                
                
                
                

                

                <span class="comment-age">(19 Jan '16, 06:08)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="49373"></a>
        <div class="comment not_top_scorer" id="comment-49373">
            <div id="post-49373-score" class="comment-score"></div>
            <div class="comment-text"><p>Alright, thanks for your help :)</p></div>
            <div class="comment-info" id="comment-49373-info">
                
                
                
                

                

                <span class="comment-age">(19 Jan '16, 07:28)</span>
                <a class="comment-user userinfo" href="/users/22526/nakroma">Nakroma</a>
                
            </div>
        </div>
    
        <a name="50079"></a>
        <div class="comment not_top_scorer" id="comment-50079">
            <div id="post-50079-score" class="comment-score"></div>
            <div class="comment-text"><p>Coming back for details about your laptop, because the core developer of the wlan dissector says that it looks as if the packets from the router were really corrupt. As the phone obviously liked them, the only place other than Wireshark itself where they could be corrupt is the wireless card and its driver used in monitoring mode.</p>

<p>So can you please state what vendor and model it is, and if you know that, what wireless adapter it uses and what driver for the wireless adapter you have used?</p></div>
            <div class="comment-info" id="comment-50079-info">
                
                
                
                

                

                <span class="comment-age">(10 Feb '16, 15:11)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="50080"></a>
        <div class="comment not_top_scorer" id="comment-50080">
            <div id="post-50080-score" class="comment-score"></div>
            <div class="comment-text"><p>Sure! Its a Samsung NP300E5C. The network adapter is Qualcomm Atheros AR9485. No idea what my driver is tho, it only shows my graphics driver in the manager.</p></div>
            <div class="comment-info" id="comment-50080-info">
                
                
                
                

                

                <span class="comment-age">(10 Feb '16, 15:48)</span>
                <a class="comment-user userinfo" href="/users/22526/nakroma">Nakroma</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-49288" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 20
        </span>
        <a href="#" class="show-all-comments-link">show 15 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-49288-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/49288/problems-with-capturing-other-device-wlan-traffic?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/49288/problems-with-capturing-other-device-wlan-traffic?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/49288/problems-with-capturing-other-device-wlan-traffic?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/49288/problems-with-capturing-other-device-wlan-traffic?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="49369"></a>
                    <div id="answer-container-49369" class="answer accepted-answer">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-49369-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/49369/up/" rel="nofollow"> </a>
<div id="post-49369-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-49369-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/49369/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="Nakroma has selected this answer as the correct answer"
        href="/accept_answer/49369/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>To lift the plain answer up from the chain of comments:</p>
<p>It is not enough to configure the table of decryption keys properly and to capture also the EAPOL handshake, it is also necessary to make sure that the "enable decryption" checkbox in the IEEE 802.11 protocol settings is ticked.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/49369/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>19 Jan '16, 06:39</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/00fc6e2633725bd871ff636f0175eabc?s=32&amp;d=identicon&amp;r=g" alt="sindy's gravatar image" />
    <p><a href="/users/19586/sindy">sindy</a><br/>
    <span class="score" title="6049 reputation points"><span class="">6.0k</span></span><span title="4 badges"><span class="badge1">&#9679;</span><span class="badgecount">4</span></span><span title="8 badges"><span class="silver">&#9679;</span><span class="badgecount">8</span></span><span title="51 badges"><span class="bronze">&#9679;</span><span class="badgecount">51</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="sindy has 110 accepted answers">24&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-49369">
    
</div>
<div id="comment-tools-49369" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-49369-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="49294"></a>
                    <div id="answer-container-49294" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-49294-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/49294/up/" rel="nofollow"> </a>
<div id="post-49294-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-49294-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/49294/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>You have to capture the four EAPOL packets, before you can decrypt the WLAN traffic.</p>
<p>As it is described here: <a href="https://wiki.wireshark.org/HowToDecrypt802.11">https://wiki.wireshark.org/HowToDecrypt802.11</a></p>
<pre><code>WPA and WPA2 use keys derived from an EAPOL handshake, which occurs when a machine joins a Wi-Fi network, to encrypt traffic. Unless all four handshake packets are present for the session you're trying to decrypt, Wireshark won't be able to decrypt the traffic. You can use the display filter eapol to locate EAPOL packets in your capture.

In order to capture the handshake for a machine, you will need to force the machine to (re-)join the network while the capture is in progress. One way to do this is to put the machine to sleep (for smartphones and tablets, "turning off" the machine puts it to sleep) before you start the capture, start the capture, and then wake the machine up. You will need to do this for all machines whose traffic you want to see.
</code></pre>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/49294/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>17 Jan '16, 11:03</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/3b24b339fc62fb46dced6a443d3202ea?s=32&amp;d=identicon&amp;r=g" alt="Christian_R's gravatar image" />
    <p><a href="/users/16160/christian_r">Christian_R</a><br/>
    <span class="score" title="1830 reputation points"><span class="">1.8k</span></span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="6 badges"><span class="silver">&#9679;</span><span class="badgecount">6</span></span><span title="25 badges"><span class="bronze">&#9679;</span><span class="badgecount">25</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Christian_R has 25 accepted answers">16&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/49294/">
                edited
                <strong>17 Jan '16, 11:07</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-49294">
    
</div>
<div id="comment-tools-49294" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-49294-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/49288/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='0ZzuCgUkOGLnRhUiuiK2yzvB1zjTgQgX' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/49288/problems-with-capturing-other-device-wlan-traffic?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/49288/problems-with-capturing-other-device-wlan-traffic?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/wireshark/"
            class="tag-link-wireshark"
            title="see questions tagged'wireshark'using tags"
            rel="tag">wireshark</a> <span class="tag-number">&#215;1,620</span><br/>
        
        <a href="/tags/wlan/"
            class="tag-link-wlan"
            title="see questions tagged'wlan'using tags"
            rel="tag">wlan</a> <span class="tag-number">&#215;76</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Jan. 17, 2016, 10:11 a.m.">17 Jan '16, 10:11</strong>
    </p>
    <p> 
     	question was seen: <strong>2,962 times</strong>
    </p>
    <p> 
        last updated: <strong title="Feb. 10, 2016, 3:48 p.m.">10 Feb '16, 15:48</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/38741/decrypt-only-outgoing-packets-promiscuous-mode">Decrypt only outgoing packets - promiscuous mode.</a>
        </p>
        
        <p>
            <a href="/questions/30227/catch-all-packets-going-over-windows-hosted-virtual-adapter">Catch all packets going over Windows Hosted Virtual Adapter</a>
        </p>
        
        <p>
            <a href="/questions/52286/unable-to-capture-unicast-packets-in-monitor-mode-on-wireshark">Unable to capture unicast packets in monitor mode on wireshark</a>
        </p>
        
        <p>
            <a href="/questions/56070/sniffing-telnet-packets-on-lan">Sniffing telnet packets on LAN</a>
        </p>
        
        <p>
            <a href="/questions/51221/i-can-see-only-broadcast-packages-in-wlan-capture">I can see only BROADCAST packages in WLAN CAPTURE</a>
        </p>
        
        <p>
            <a href="/questions/25490/using-wireshark-1102-with-wifi-or-wlan">using wireshark 1.10.2 with wifi or wlan</a>
        </p>
        
        <p>
            <a href="/questions/27/are-this-questions-for-users-or-developers">Are this questions for Users or Developers?</a>
        </p>
        
        <p>
            <a href="/questions/1230/after-updating-mac-ports-wireshark-is-dead">after updating mac ports wireshark is dead!</a>
        </p>
        
        <p>
            <a href="/questions/2091/wireshark-built-in-dissector-needs-to-be-changed-to-a-plugin">Wireshark built in dissector needs to be changed to a plugin??</a>
        </p>
        
        <p>
            <a href="/questions/2360/difference-between-cap-and-pcap-formats">difference between cap and pcap formats??</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
