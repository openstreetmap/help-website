<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Error: Unhandled Exception (group=1, code=6) - Wireshark Q&amp;A</title>
        <meta name="description" content="hi, when i use tshark to sniffer, it always appear error:Unhandled Exception (group=1, code=6) My cmd is &quot;tshark -nn -i eth1 -t ad -R &#39;(tcp.flags.syn == 1 and tcp.flags.ack == 0 and ip.dst&amp;lt;192.168.0.0 or ip.dst&amp;gt;192.168.255.255)&#39;&quot; Firstly, i thought maybe the memory isn`t enough, but after i fr..." />
        <meta name="keywords" content="tshark" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/11088/error-unhandled-exception-group1-code6" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/11088/error-unhandled-exception-group1-code6?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='vkdtTO4RB37QkHpaVbTlo24bH4elrcPl' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/11088/error-unhandled-exception-group1-code6">Error: Unhandled Exception (group=1, code=6)</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-11088-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/11088/up/" rel="nofollow"> </a>
<div id="post-11088-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-11088-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/11088/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/11088/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>hi, when i use tshark to sniffer, it always appear error:Unhandled Exception (group=1, code=6)</p>
<p>My cmd is "tshark -nn -i eth1 -t ad -R '(tcp.flags.syn == 1 and tcp.flags.ack == 0 and ip.dst&lt;192.168.0.0 or ip.dst&gt;192.168.255.255)'"</p>
<p>Firstly, i thought maybe the memory isn`t enough, but after i freed memory,i found it still error
and now the free memory have 4G,</p>
<p>Can you tell me how to solve?</p>
<p>Thank you.</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/tshark/" class="post-tag tag-link-tshark"
                                        title="see questions tagged 'tshark'" rel="tag">tshark</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>17 May '12, 01:00</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/861497af4aeeedc11c382438bcaa9005?s=32&amp;d=identicon&amp;r=g" alt="mastertu's gravatar image" />
    <p><a href="/users/2697/mastertu">mastertu</a><br/>
    <span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">&#9679;</span><span class="badgecount">2</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="mastertu has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-11088">
    
        <a name="11089"></a>
        <div class="comment" id="comment-11089">
            <div id="post-11089-score" class="comment-score"></div>
            <div class="comment-text"><ol>
<li>what is your OS</li>
<li>what is the version of tshark</li>
<li>do you run the command as root</li>
</ol>

<p>Regards<br>
Kurt</p></div>
            <div class="comment-info" id="comment-11089-info">
                
                
                
                

                

                <span class="comment-age">(17 May '12, 01:14)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="11090"></a>
        <div class="comment" id="comment-11090">
            <div id="post-11090-score" class="comment-score"></div>
            <div class="comment-text"><ol>
<li>my os is centos 6.2</li>
<li>the version of tshark is TShark 1.2.15</li>
<li>yes, i run the command as root.</li>
</ol></div>
            <div class="comment-info" id="comment-11090-info">
                
                
                
                

                

                <span class="comment-age">(17 May '12, 01:17)</span>
                <a class="comment-user userinfo" href="/users/2697/mastertu">mastertu</a>
                
            </div>
        </div>
    
        <a name="11091"></a>
        <div class="comment" id="comment-11091">
            <div id="post-11091-score" class="comment-score"></div>
            <div class="comment-text"><pre><code>[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="62100d0d16221a1a1a">[email&#160;protected]</a> ~]# tshark -v
TShark 1.2.15

Copyright 1998-2011 Gerald Combs &lt;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="4f282a3d2e232b0f">[email&#160;protected]</a><a href="http://wireshark.org">wireshark.org</a>&gt; and contributors.
This is free software; see the source for copying conditions. There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

Compiled (32-bit) with GLib 2.22.5, with libpcap 1.0.0, with libz 1.2.3, without
POSIX capabilities, with libpcre 7.8, with SMI 0.4.8, without c-ares, without
ADNS, without Lua, with GnuTLS 2.8.5, with Gcrypt 1.4.5, with MIT Kerberos,
without GeoIP.

Running on Linux 2.6.32-220.7.1.el6.i686, with libpcap version 1.0.0, GnuTLS
2.8.5, Gcrypt 1.4.5.

Built using gcc 4.4.6 20110731 (Red Hat 4.4.6-3).
</code></pre></div>
            <div class="comment-info" id="comment-11091-info">
                
                
                
                

                

                <span class="comment-age">(17 May '12, 01:20)</span>
                <a class="comment-user userinfo" href="/users/2697/mastertu">mastertu</a>
                
            </div>
        </div>
    
        <a name="11092"></a>
        <div class="comment" id="comment-11092">
            <div id="post-11092-score" class="comment-score"></div>
            <div class="comment-text"><p>my sniffer data is very much, wheather it caused this errror?</p></div>
            <div class="comment-info" id="comment-11092-info">
                
                
                
                

                

                <span class="comment-age">(17 May '12, 01:32)</span>
                <a class="comment-user userinfo" href="/users/2697/mastertu">mastertu</a>
                
            </div>
        </div>
    
        <a name="11093"></a>
        <div class="comment" id="comment-11093">
            <div id="post-11093-score" class="comment-score"></div>
            <div class="comment-text"><p>maybe. When does the error occur. Right at the beginning?</p>

<p>BTW: before we are looking for possible errors in an older version of tshark, can you please upgrade to tshark 1.6? As CentOS 6.2 only provides wireshark 1.2, I suggest to look for a 1.6 rpm elsewhere or compile it yourself.</p></div>
            <div class="comment-info" id="comment-11093-info">
                
                
                
                

                

                <span class="comment-age">(17 May '12, 01:37)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="11095"></a>
        <div class="comment not_top_scorer" id="comment-11095">
            <div id="post-11095-score" class="comment-score"></div>
            <div class="comment-text"><p>not right at the beginning, it after six or seven minutes.</p>

<p>Ok, i will upgrade it and try again</p></div>
            <div class="comment-info" id="comment-11095-info">
                
                
                
                

                

                <span class="comment-age">(17 May '12, 02:19)</span>
                <a class="comment-user userinfo" href="/users/2697/mastertu">mastertu</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-11088" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 6
        </span>
        <a href="#" class="show-all-comments-link">show 1 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-11088-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/11088/error-unhandled-exception-group1-code6?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/11088/error-unhandled-exception-group1-code6?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/11088/error-unhandled-exception-group1-code6?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/11088/error-unhandled-exception-group1-code6?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="11097"></a>
                    <div id="answer-container-11097" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-11097-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/11097/up/" rel="nofollow"> </a>
<div id="post-11097-score" class="post-score"
    title="current number of votes">
    3
</div>
<a id="post-11097-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/11097/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>This may very well be caused by running <a href="http://wiki.wireshark.org/KnownBugs/OutOfMemory">out-of-memory</a>. Especially since you say you are on a high bandwidth network and using display filters instead of capture filters. </p>
<p>Tshark is a statefull analyzer which means it does keep state of all kinds of sessions. It also does reassembly of higher layer protocols. All of this will increase its memory footprint while capturing. So it is best to present tshark as little data as possible to reduce the memory footprint while capturing. This can be done by using capture filters.</p>
<p>The equivalent capture filter for your display filter would be:</p>
<pre><code>tcp[13]&amp;18=2 and not (dst net 192.168.0.0 mask 255.255.0.0)
</code></pre>
<p><em>(tcp[13] points to the TCP flags in the TCP header, the SYN bit has value 2, he ACK bit has value 16, so to only select SYN packets without SYN/ACK packets anding with 16+2 should result in 2. Then your not interested in TCP SYN's to systems in 192.168.0.0/16, so exclude those destinations with the "dst net" filter)</em></p>
<p>So you could use the command:</p>
<pre><code>tshark -nn -i eth1 -t ad -f "tcp[13]&amp;18=2 and not (dst net 192.168.0.0 mask 255.255.0.0)"
</code></pre>
<p>Which should make it possible to run tshark for much longer periods than with your previous command. However, it will not run forever.</p>
<p>Please also note that using display filters in recent versions of tshark is not possible anymore while capturing as the capture engine has been moved to a separate process for <a href="http://wiki.wireshark.org/Development/PrivilegeSeparation">privilege separation</a>.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/11097/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>17 May '12, 02:49</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7901a94d8fdd1f9f47cda9a32fcfa177?s=32&amp;d=identicon&amp;r=g" alt="SYN-bit's gravatar image" />
    <p><a href="/users/5/syn-bit">SYN-bit ♦♦</a><br/>
    <span class="score" title="17094 reputation points"><span class="">17.1k</span></span><span title="9 badges"><span class="badge1">&#9679;</span><span class="badgecount">9</span></span><span title="57 badges"><span class="silver">&#9679;</span><span class="badgecount">57</span></span><span title="245 badges"><span class="bronze">&#9679;</span><span class="badgecount">245</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="SYN-bit has 174 accepted answers">20&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/11097/">
                edited
                <strong>17 May '12, 06:19</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-11097">
    
        <a name="11101"></a>
        <div class="comment" id="comment-11101">
            <div id="post-11101-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes, he's running out of memory.  Unfortunately tshark didn't catch the OutOfMemory exception until r39798.  (After that rev tshark will tell you what the problem is rather than just failing to catch the exception.)</p></div>
            <div class="comment-info" id="comment-11101-info">
                
                
                
                

                

                <span class="comment-age">(17 May '12, 05:54)</span>
                <a class="comment-user userinfo" href="/users/655/jeffmorriss">JeffMorriss ♦</a>
                
            </div>
        </div>
    
        <a name="11129"></a>
        <div class="comment" id="comment-11129">
            <div id="post-11129-score" class="comment-score"></div>
            <div class="comment-text"><p>when i use "tshark -nn -i eth1 -t ad -f "tcp[13]&amp;18=2 and not (dst net 192.168.0.0 mask 255.255.0.0)""<br>
I found a lot of packets didn`t caught</p></div>
            <div class="comment-info" id="comment-11129-info">
                
                
                
                

                

                <span class="comment-age">(18 May '12, 02:33)</span>
                <a class="comment-user userinfo" href="/users/2697/mastertu">mastertu</a>
                
            </div>
        </div>
    
        <a name="11130"></a>
        <div class="comment" id="comment-11130">
            <div id="post-11130-score" class="comment-score"></div>
            <div class="comment-text"><p>What do you mean by "caught"? This capture filter does the same as your display filter. The output on screen should be the same (which I just verified myself with some test traffic).</p>

<p>Which traffic do you suspect is not caught?</p></div>
            <div class="comment-info" id="comment-11130-info">
                
                
                
                

                

                <span class="comment-age">(18 May '12, 02:50)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="11132"></a>
        <div class="comment" id="comment-11132">
            <div id="post-11132-score" class="comment-score"></div>
            <div class="comment-text"><p>Sorry,please forgive my english.
I mean that when i use cmd"tshark -nn -i eth1 -t ad -R '(tcp.flags.syn == 1 and tcp.flags.ack == 0 and ip.dst&lt;192.168.0.0 or ip.dst&gt;192.168.255.255)'"
The sniffer result is right.
But when i use cmd"tshark -nn -i eth1 -t ad -f "tcp[13]&amp;18=2 and not (dst net 192.168.0.0 mask 255.255.0.0)"
I found the result is very less.
I found the reson maybe caused by this capture "tcp[13]&amp;18=2",
can you tell me why?
Thany you.</p></div>
            <div class="comment-info" id="comment-11132-info">
                
                
                
                

                

                <span class="comment-age">(18 May '12, 03:01)</span>
                <a class="comment-user userinfo" href="/users/2697/mastertu">mastertu</a>
                
            </div>
        </div>
    
        <a name="11133"></a>
        <div class="comment" id="comment-11133">
            <div id="post-11133-score" class="comment-score"></div>
            <div class="comment-text"><p>As the filters should work the same (and they seem to do on my system), I'm very curious to see how the output differs. Can you start both commands and send me the some output that is missing from my command? Please also supply the exact commands that you used in the test.</p></div>
            <div class="comment-info" id="comment-11133-info">
                
                
                
                

                

                <span class="comment-age">(18 May '12, 03:12)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="11134"></a>
        <div class="comment not_top_scorer" id="comment-11134">
            <div id="post-11134-score" class="comment-score"></div>
            <div class="comment-text"><pre><code>[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="c2b0adadb682818086">[email&#160;protected]</a> data]# tshark -nn -i eth1 -t ad -R '(tcp.flags.syn == 1 and tcp.flags.ack == 0 and ip.dst&lt;192.168.0.0 or ip.dst&gt;192.168.255.255)'
Running as user "root" and group "root". This could be dangerous.
Capturing on eth1
2012-05-18 18:15:59.024477 192.168.50.111 -&gt; 1.2.3.4      TCP 28728 &gt; 82 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=8 TSV=3171436 TSER=0
2012-05-18 18:15:59.090329 192.168.15.15 -&gt; 119.147.113.43 TCP 57546 &gt; 80 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=8
2012-05-18 18:15:59.123530 192.168.0.141 -&gt; 74.125.71.157 TCP 52304 &gt; 80 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 WS=4 TSV=186171229 TSER=0
2012-05-18 18:15:59.125058 192.168.0.112 -&gt; 220.181.112.34 TCP 61277 &gt; 80 [SYN] Seq=0 Win=8192 Len=0 MSS=1460
2012-05-18 18:15:59.125632 192.168.0.112 -&gt; 220.181.112.34 TCP 61278 &gt; 80 [SYN] Seq=0 Win=8192 Len=0 MSS=1460
2012-05-18 18:15:59.377753 192.168.0.141 -&gt; 74.125.71.157 TCP 52305 &gt; 80 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 WS=4 TSV=186171485 TSER=0
2012-05-18 18:15:59.474241 192.168.0.141 -&gt; 23.21.171.71 TCP 52306 &gt; 80 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 WS=4 TSV=186171576 TSER=0
2012-05-18 18:15:59.483072 192.168.0.141 -&gt; 107.22.194.172 TCP 52307 &gt; 80 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 WS=4 TSV=186171584 TSER=0
2012-05-18 18:15:59.529752 192.168.13.111 -&gt; 119.147.113.117 TCP 54843 &gt; 80 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=2
2012-05-18 18:15:59.531222 192.168.0.170 -&gt; 218.30.111.182 TCP 38563 &gt; 25 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=8
2012-05-18 18:15:59.601367 192.168.50.118 -&gt; 1.2.3.4      TCP 49536 &gt; 82 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 WS=2
2012-05-18 18:15:59.640381 192.168.13.137 -&gt; 119.147.113.98 TCP 51584 &gt; 80 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=2
2012-05-18 18:15:59.661852 192.168.0.186 -&gt; 125.64.93.204 TCP 50175 &gt; 65532 [SYN] Seq=0 Win=14600 Len=0 MSS=1460 TSV=3053589858 TSER=0 WS=6
2012-05-18 18:15:59.779664 192.168.15.140 -&gt; 119.147.113.105 TCP 59062 &gt; 80 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=8
2012-05-18 18:15:59.785710 192.168.11.22 -&gt; 1.2.3.4      TCP 55089 &gt; 82 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=8
2012-05-18 18:15:59.869167 192.168.50.111 -&gt; 119.147.113.104 TCP 28729 &gt; 80 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=2 TSV=3171520 TSER=0
2012-05-18 18:16:00.004662 192.168.50.119 -&gt; 119.147.113.104 TCP 2729 &gt; 80 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 WS=0
2012-05-18 18:16:00.095211 192.168.18.12 -&gt; 119.147.113.98 TCP 62265 &gt; 80 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=2
2012-05-18 18:16:00.148128 192.168.0.141 -&gt; 58.83.170.244 TCP 52308 &gt; 80 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 WS=4 TSV=186172241 TSER=0
2012-05-18 18:16:00.152433 192.168.0.141 -&gt; 58.83.170.244 TCP 52309 &gt; 80 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 WS=4 TSV=186172245 TSER=0
2012-05-18 18:16:00.323979 192.168.15.15 -&gt; 119.147.113.43 TCP 57547 &gt; 80 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=8
2012-05-18 18:16:00.375384 192.168.12.103 -&gt; 183.60.136.64 TCP 52733 &gt; 80 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=8
2012-05-18 18:16:00.490977 192.168.50.124 -&gt; 183.60.9.160 TCP 56100 &gt; 80 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=8
2012-05-18 18:16:00.508177 192.168.90.18 -&gt; 58.58.58.58  TCP 2020 &gt; 1604 [SYN] Seq=0 Win=64240 Len=0 MSS=1460
2012-05-18 18:16:00.618612 192.168.0.141 -&gt; 63.141.192.120 TCP 52310 &gt; 80 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 WS=4 TSV=186172698 TSER=0
2012-05-18 18:16:00.631318 192.168.0.141 -&gt; 63.141.192.120 TCP 52311 &gt; 80 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 WS=4 TSV=186172707 TSER=0
2012-05-18 18:16:00.650815 192.168.0.141 -&gt; 63.141.192.120 TCP 52312 &gt; 80 [SYN] Seq=0 Win=65535 Len=0 MSS=1460 WS=4 TSV=186172726 TSER=0
2012-05-18 18:16:00.770647 192.168.0.232 -&gt; 121.14.110.44 TCP 47859 &gt; 80 [SYN] Seq=0 Win=5840 Len=0 MSS=1460 TSV=890135769 TSER=0 WS=6
2012-05-18 18:16:00.782544 192.168.18.14 -&gt; 119.147.113.25 TCP 57899 &gt; 80 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=2
2012-05-18 18:16:00.824439 192.168.30.142 -&gt; 220.181.111.148 TCP 60162 &gt; 80 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=8
2012-05-18 18:16:00.852977 192.168.15.15 -&gt; 119.147.113.43 TCP 57548 &gt; 80 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=8
2012-05-18 18:16:00.883222 192.168.12.113 -&gt; 183.60.58.88 TCP 56490 &gt; 80 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=2
2012-05-18 18:16:00.883225 192.168.12.113 -&gt; 183.60.58.88 TCP 56489 &gt; 80 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=2
2012-05-18 18:16:00.933774 192.168.0.78 -&gt; 221.123.176.120 TCP 4984 &gt; 80 [SYN] Seq=0 Win=16384 Len=0 MSS=1460
2012-05-18 18:16:00.962308 192.168.15.15 -&gt; 119.147.113.43 TCP 57549 &gt; 80 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=8
2012-05-18 18:16:00.982045 192.168.50.124 -&gt; 220.181.181.223 TCP 56101 &gt; 80 [SYN] Seq=0 Win=8192 Len=0 MSS=1460 WS=2

[<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="0e7c61617a4e4d4c4a">[email&#160;protected]</a> data]# tshark -nn -i eth1 -t ad -f "tcp[13]&amp;18=2 and not (dst net 192.168.0.0 mask 255.255.0.0)"
Running as user "root" and group "root". This could be dangerous.
Capturing on eth1
2012-05-18 18:17:16.180467 192.168.90.18 -&gt; 58.58.58.58  TCP 2024 &gt; 1604 [SYN] Seq=0 Win=64240 Len=0 MSS=1460
2012-05-18 18:17:17.649489 192.168.90.14 -&gt; 58.58.58.58  TCP 1073 &gt; 80 [SYN] Seq=0 Win=64240 Len=0 MSS=1460
2012-05-18 18:17:19.148456 192.168.90.18 -&gt; 58.58.58.58  TCP 2024 &gt; 1604 [SYN] Seq=0 Win=64240 Len=0 MSS=1460
2012-05-18 18:17:20.554775 192.168.90.14 -&gt; 58.58.58.58  TCP 1073 &gt; 80 [SYN] Seq=0 Win=64240 Len=0 MSS=1460
2012-05-18 18:17:25.164211 192.168.90.18 -&gt; 58.58.58.58  TCP 2024 &gt; 1604 [SYN] Seq=0 Win=64240 Len=0 MSS=1460
2012-05-18 18:17:26.570437 192.168.90.14 -&gt; 58.58.58.58  TCP 1073 &gt; 80 [SYN] Seq=0 Win=64240 Len=0 MSS=1460
2012-05-18 18:17:37.399896 192.168.90.18 -&gt; 58.58.58.58  TCP 2025 &gt; 1604 [SYN] Seq=0 Win=64240 Len=0 MSS=1460
2012-05-18 18:17:40.257794 192.168.90.18 -&gt; 58.58.58.58  TCP 2025 &gt; 1604 [SYN] Seq=0 Win=64240 Len=0 MSS=1460
</code></pre></div>
            <div class="comment-info" id="comment-11134-info">
                
                
                
                

                

                <span class="comment-age">(18 May '12, 03:18)</span>
                <a class="comment-user userinfo" href="/users/2697/mastertu">mastertu</a>
                
            </div>
        </div>
    
        <a name="11135"></a>
        <div class="comment not_top_scorer" id="comment-11135">
            <div id="post-11135-score" class="comment-score"></div>
            <div class="comment-text"><p>sorry,the format hasn`t tab, can you give your email?
I will send to your email,thans.</p></div>
            <div class="comment-info" id="comment-11135-info">
                
                
                
                

                

                <span class="comment-age">(18 May '12, 03:20)</span>
                <a class="comment-user userinfo" href="/users/2697/mastertu">mastertu</a>
                
            </div>
        </div>
    
        <a name="11136"></a>
        <div class="comment not_top_scorer" id="comment-11136">
            <div id="post-11136-score" class="comment-score"></div>
            <div class="comment-text"><p>I just updated the format, no worries :-)</p>

<p>I think I know the problem, are there any vlan tagged frames? The capture filter only shows non-tagged frames. To include vlan-tagged frames, you can use:</p>

<pre><code>tshark -nn -i eth1 -t ad -f "(tcp[13]&amp;18=2 and not (dst net 192.168.0.0 mask 255.255.0.0)) or (vlan and (tcp[13]&amp;18=2 and not (dst net 192.168.0.0 mask 255.255.0.0)))"
</code></pre></div>
            <div class="comment-info" id="comment-11136-info">
                
                
                
                

                

                <span class="comment-age">(18 May '12, 03:25)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="11138"></a>
        <div class="comment not_top_scorer" id="comment-11138">
            <div id="post-11138-score" class="comment-score"></div>
            <div class="comment-text"><p>yes, i have solve my question,
thank you very much</p></div>
            <div class="comment-info" id="comment-11138-info">
                
                
                
                

                

                <span class="comment-age">(18 May '12, 10:11)</span>
                <a class="comment-user userinfo" href="/users/2697/mastertu">mastertu</a>
                
            </div>
        </div>
    
        <a name="11143"></a>
        <div class="comment not_top_scorer" id="comment-11143">
            <div id="post-11143-score" class="comment-score"></div>
            <div class="comment-text"><p>hi，this time， the tshark crashed agfer 18 hours.
whether the memory inns`t enough?
my host has 8G memory</p></div>
            <div class="comment-info" id="comment-11143-info">
                
                
                
                

                

                <span class="comment-age">(19 May '12, 11:26)</span>
                <a class="comment-user userinfo" href="/users/2697/mastertu">mastertu</a>
                
            </div>
        </div>
    
        <a name="11144"></a>
        <div class="comment not_top_scorer" id="comment-11144">
            <div id="post-11144-score" class="comment-score"></div>
            <div class="comment-text"><p>Running out of memory is inevitable as <code>tshark</code> accumulates information on each packet. You should instead be using <a href="http://www.wireshark.org/docs/man-pages/dumpcap.html"><code>dumpcap</code></a> for long-running captures...</p></div>
            <div class="comment-info" id="comment-11144-info">
                
                
                
                

                

                <span class="comment-age">(19 May '12, 15:03)</span>
                <a class="comment-user userinfo" href="/users/817/helloworld">helloworld</a>
                
            </div>
        </div>
    
        <a name="11145"></a>
        <div class="comment not_top_scorer" id="comment-11145">
            <div id="post-11145-score" class="comment-score"></div>
            <div class="comment-text"><p>...as described in the <a href="http://wiki.wireshark.org/KnownBugs/OutOfMemory#Work_Around.28s.29">OutOfMemory wiki</a>:</p>

<blockquote>
<h3>Other tools</h3>
<p><br>
If Wireshark is running out of memory, that probably means that you're letting it run for a very long time or you're analyzing very large capture files. You may find that another tool does what you want better than Wireshark. Use <a href="http://www.wireshark.org/docs/man-pages/dumpcap.html">dumpcap</a> for long term capturing, it's intended for this purpose, or see <a href="http://wiki.wireshark.org/Tools">Tools</a> for other tools which may be more suitable for the task.</p>
</blockquote></div>
            <div class="comment-info" id="comment-11145-info">
                
                
                
                

                

                <span class="comment-age">(19 May '12, 15:04)</span>
                <a class="comment-user userinfo" href="/users/817/helloworld">helloworld</a>
                
            </div>
        </div>
    
        <a name="11165"></a>
        <div class="comment not_top_scorer" id="comment-11165">
            <div id="post-11165-score" class="comment-score"></div>
            <div class="comment-text"><p>hi,i found another question,
Please see the data,between 58.58.58.58 and TCP,there is two space
But between the other dstip and TCP only has one space.
I want make all of them one space, can you help me?
Thank you.</p></div>
            <div class="comment-info" id="comment-11165-info">
                
                
                
                

                

                <span class="comment-age">(20 May '12, 20:30)</span>
                <a class="comment-user userinfo" href="/users/2697/mastertu">mastertu</a>
                
            </div>
        </div>
    
        <a name="11166"></a>
        <div class="comment not_top_scorer" id="comment-11166">
            <div id="post-11166-score" class="comment-score"></div>
            <div class="comment-text"><p>i delete the space by tr -s ' '</p></div>
            <div class="comment-info" id="comment-11166-info">
                
                
                
                

                

                <span class="comment-age">(20 May '12, 21:07)</span>
                <a class="comment-user userinfo" href="/users/2697/mastertu">mastertu</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-11097" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 14
        </span>
        <a href="#" class="show-all-comments-link">show 9 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-11097-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/11088/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='vkdtTO4RB37QkHpaVbTlo24bH4elrcPl' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/11088/error-unhandled-exception-group1-code6?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/11088/error-unhandled-exception-group1-code6?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/tshark/"
            class="tag-link-tshark"
            title="see questions tagged'tshark'using tags"
            rel="tag">tshark</a> <span class="tag-number">&#215;832</span><br/>
        
    </p>
    <p>
        question asked: <strong title="May 17, 2012, 1 a.m.">17 May '12, 01:00</strong>
    </p>
    <p> 
     	question was seen: <strong>3,833 times</strong>
    </p>
    <p> 
        last updated: <strong title="May 20, 2012, 9:07 p.m.">20 May '12, 21:07</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/62/static-tshark-builds-for-linux-andor-solaris-sparcx64">static tshark builds for linux and/or solaris sparc/x64</a>
        </p>
        
        <p>
            <a href="/questions/1670/tshark-hex-dump">tshark hex dump</a>
        </p>
        
        <p>
            <a href="/questions/3479/could-the-file-name-parameter-in-tshark-be-chinese-characters">could the file name parameter in tshark be chinese characters?</a>
        </p>
        
        <p>
            <a href="/questions/5132/write-gzip-encoded-http-as-inflated-in-pcap-file">Write Gzip Encoded HTTP as Inflated in PCAP File</a>
        </p>
        
        <p>
            <a href="/questions/6488/use-tshark-to-analyze-source-and-destination-ips-from-dumpfile">Use tshark to analyze source and destination IPs from dumpfile?</a>
        </p>
        
        <p>
            <a href="/questions/8324/difference-tshark-wireshark-when-load-a-pcap">Difference TShark / Wireshark when load a pcap</a>
        </p>
        
        <p>
            <a href="/questions/9303/how-to-retrieve-packet-information-using-wireshark-commands">how to retrieve packet information using wireshark commands</a>
        </p>
        
        <p>
            <a href="/questions/10173/covert-the-pcap-file-to-a-csv-file-using-tshark">Covert the .pcap file to a .csv file using tshark</a>
        </p>
        
        <p>
            <a href="/questions/10605/tshark-commands-e-and-t">tshark commands -e and -T</a>
        </p>
        
        <p>
            <a href="/questions/12382/pcapng-timestamps-get-changed-when-tshark-reads-and-saves-a-pcang-file">PCAPNG: timestamps get changed when tshark reads and saves a pcang file</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
