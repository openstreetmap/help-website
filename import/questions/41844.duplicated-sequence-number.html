<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Duplicated Sequence Number - Wireshark Q&amp;A</title>
        <meta name="description" content="Hello, I&#39;m capturing TCP traffic from one port mirroring to analyze the traffic. I found one duplicated sequence number but i dont have duplicated ack or retransmission and i have the message TCP Acked unseen seqment. Also the repeated sequence number have a new ack but i dont have this nextseq befo..." />
        <meta name="keywords" content="ack,duplicated,segment,unseen,sequence" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/41844/duplicated-sequence-number" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/41844/duplicated-sequence-number?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='KV10mrzlMjQNQ896PQpk7JO2ZhwQ0EKh' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/41844/duplicated-sequence-number">Duplicated Sequence Number</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-41844-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/41844/up/" rel="nofollow"> </a>
<div id="post-41844-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-41844-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/41844/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/41844/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hello,</p>
<p>I'm capturing TCP traffic from one port mirroring to analyze the traffic. I found one duplicated sequence number but i dont have duplicated ack or retransmission and i have the message TCP Acked unseen seqment.</p>
<p>Also the repeated sequence number have a new ack but i dont have this nextseq before</p>
<p>I dont understand what is the problem. how to work tcp in this case?</p>
<p>Thanks</p>
<p><img alt="alt text" src="https://osqa-ask.wireshark.org/upfiles/repeated_secuence.png"></p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/ack/" class="post-tag tag-link-ack"
                                        title="see questions tagged 'ack'" rel="tag">ack</a>
                                
                                    <a href="/tags/duplicated/" class="post-tag tag-link-duplicated"
                                        title="see questions tagged 'duplicated'" rel="tag">duplicated</a>
                                
                                    <a href="/tags/segment/" class="post-tag tag-link-segment"
                                        title="see questions tagged 'segment'" rel="tag">segment</a>
                                
                                    <a href="/tags/unseen/" class="post-tag tag-link-unseen"
                                        title="see questions tagged 'unseen'" rel="tag">unseen</a>
                                
                                    <a href="/tags/sequence/" class="post-tag tag-link-sequence"
                                        title="see questions tagged 'sequence'" rel="tag">sequence</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>25 Apr '15, 18:35</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/45742f4f53842c3730512f7ec0274214?s=32&amp;d=identicon&amp;r=g" alt="potter_mani's gravatar image" />
    <p><a href="/users/16434/potter_mani">potter_mani</a><br/>
    <span class="score" title="0 reputation points">0</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">&#9679;</span><span class="badgecount">4</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="potter_mani has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/41844/">
                edited
                <strong>25 Apr '15, 18:38</strong>
            </a>
        </p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-41844">
    
</div>
<div id="comment-tools-41844" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-41844-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/41844/duplicated-sequence-number?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/41844/duplicated-sequence-number?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/41844/duplicated-sequence-number?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/41844/duplicated-sequence-number?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="41845"></a>
                    <div id="answer-container-41845" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-41845-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/41845/up/" rel="nofollow"> </a>
<div id="post-41845-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-41845-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/41845/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>There is one segment tcp.seq==1246034247 tcp.len==369 that is missing in the trace even though it must have arrived at the receiver 50526.<br>
So there was no real packet loss that would cause a duplicate ack or retransmission.
The problem is that the missing segment might have taken another route or the trace capturing tool just missed to record it.<br>
</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/41845/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>25 Apr '15, 21:58</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/5500bd1decb766660522dfb347eedc49?s=32&amp;d=identicon&amp;r=g" alt="mrEEde's gravatar image" />
    <p><a href="/users/4668/mreede">mrEEde</a><br/>
    <span class="score" title="3892 reputation points"><span class="">3.9k</span></span><span title="15 badges"><span class="badge1">&#9679;</span><span class="badgecount">15</span></span><span title="22 badges"><span class="silver">&#9679;</span><span class="badgecount">22</span></span><span title="70 badges"><span class="bronze">&#9679;</span><span class="badgecount">70</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="mrEEde has 48 accepted answers">20&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-41845">
    
        <a name="41853"></a>
        <div class="comment" id="comment-41853">
            <div id="post-41853-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks you for your time mrEEde</p>

<p>1) I'm thinking that the original interface not lost the packet and so the port mirroring port   by one reason (example performance) not send the packet. Can be the other reason? </p>

<p>2) I mention this because the switch is having problems, but I need to show evidence the capture, there are some filters that allow me to do that?  I am very complicated</p>

<p>3) And my other question if the ACK is = Number Segment + Packet lenght in bytes why is the reason for duplicated Number segment? i'm confusing how to work tcp</p></div>
            <div class="comment-info" id="comment-41853-info">
                
                
                
                

                

                <span class="comment-age">(26 Apr '15, 06:15)</span>
                <a class="comment-user userinfo" href="/users/16434/potter_mani">potter_mani</a>
                
            </div>
        </div>
    
        <a name="41863"></a>
        <div class="comment" id="comment-41863">
            <div id="post-41863-score" class="comment-score">1</div>
            <div class="comment-text"><p>"1) I'm thinking that the original interface not lost the packet and so the port mirroring port by one reason (example performance) not send the packet."</p>

<p>The receiver ACKs the missing packet, so it was never discarded anywhere. </p>

<p>"Can be the other reason?"
Maybe the tracing tool could not keep up with the high packet rate tracing unfiltered packets.<br>
</p>

<p>2) I mention this because the switch is having problems, but I need to show evidence the capture, there are some filters that allow me to do that? I am very complicated</p>

<p>Real retransmissions can be found using tcp.analyis.retransmission </p>

<p>3) And my other question if the ACK is = Number Segment + Packet lenght in bytes why is the reason for duplicated Number segment? </p>

<p>Only the last segment with sequence number 216888789 is carrying payload. The first 2 have a tcp.len==0 so they are just ACKing incoming packets.</p></div>
            <div class="comment-info" id="comment-41863-info">
                
                
                
                

                

                <span class="comment-age">(26 Apr '15, 11:16)</span>
                <a class="comment-user userinfo" href="/users/4668/mreede">mrEEde</a>
                
            </div>
        </div>
    
        <a name="41864"></a>
        <div class="comment" id="comment-41864">
            <div id="post-41864-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks you mrEEde.</p>

<p>1) About "The receiver ACKs the missing packet, so it was never discarded anywhere" is it possible the switch device dropped this packet on port mirroring interface? my company said the switch device have dropped packets in the counter but i need to stay sure that is my wireshark or can be the port mirroring</p>

<p>3) "Can be the other reason?" Maybe the tracing tool could not keep up with the high packet rate tracing unfiltered packets." I have filters to capture all packets, i have a tuning on my S.O (Linux) for the buffer on network cards and i have a raid 10. Are there other tuning for wireshark?</p>

<p>3) What about of the last tcp acked unseen segment? i can't understand that case</p>

<p>Thanks again for your time i'm very complicated with this case because I need to know all for notify to my company</p></div>
            <div class="comment-info" id="comment-41864-info">
                
                
                
                

                

                <span class="comment-age">(26 Apr '15, 13:30)</span>
                <a class="comment-user userinfo" href="/users/16434/potter_mani">potter_mani</a>
                
            </div>
        </div>
    
        <a name="41866"></a>
        <div class="comment" id="comment-41866">
            <div id="post-41866-score" class="comment-score">1</div>
            <div class="comment-text"><p>"my company said the switch device have dropped packets in the counter" </p>

<p>Well, if the switch is known to drop packets, chances are that it also drops packet on the mirroring port which would then explain why they don't show up in the trace causing 'tcp acked unseen segment' messages.</p>

<p>So the first goal would be to fix the 'increasing dropped packets counters'.</p></div>
            <div class="comment-info" id="comment-41866-info">
                
                
                
                

                

                <span class="comment-age">(26 Apr '15, 13:46)</span>
                <a class="comment-user userinfo" href="/users/4668/mreede">mrEEde</a>
                
            </div>
        </div>
    
        <a name="41868"></a>
        <div class="comment not_top_scorer" id="comment-41868">
            <div id="post-41868-score" class="comment-score"></div>
            <div class="comment-text"><p>In the last "tcp acked unseen segment" in the image i dont understand the reason, because before have the packet. It's my las question</p></div>
            <div class="comment-info" id="comment-41868-info">
                
                
                
                

                

                <span class="comment-age">(26 Apr '15, 14:16)</span>
                <a class="comment-user userinfo" href="/users/16434/potter_mani">potter_mani</a>
                
            </div>
        </div>
    
        <a name="41869"></a>
        <div class="comment" id="comment-41869">
            <div id="post-41869-score" class="comment-score">1</div>
            <div class="comment-text"><p>It has the same reason as the "tcp acked unseen segment" before. (mEEde told you)
Because the first packet was an ACK only and this one contains data. 
The packet between this two packets belongs to anaother session.</p></div>
            <div class="comment-info" id="comment-41869-info">
                
                
                
                

                

                <span class="comment-age">(26 Apr '15, 14:23)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
        <a name="41873"></a>
        <div class="comment not_top_scorer" id="comment-41873">
            <div id="post-41873-score" class="comment-score"></div>
            <div class="comment-text"><p>ok. The first packet marked for me (blue) is ok
    The second packet (black) it's for missing segment tcp.seq==1246034247 tcp.len==369
    The third packet (black) i don't see the problem because the second packet (black) have the ACK only for this packet</p>

<p>Thanks a lot</p></div>
            <div class="comment-info" id="comment-41873-info">
                
                
                
                

                

                <span class="comment-age">(26 Apr '15, 15:30)</span>
                <a class="comment-user userinfo" href="/users/16434/potter_mani">potter_mani</a>
                
            </div>
        </div>
    
        <a name="41874"></a>
        <div class="comment not_top_scorer" id="comment-41874">
            <div id="post-41874-score" class="comment-score"></div>
            <div class="comment-text"><p>Ok. Of course there is no reason. But the second has the same ACK Number as the first black packet, which is correct, because ACK number says what you want to hear next. 
And because the two packets have the same ACK number Wireshark marks the packets for the same reason. In other words both packets points to the same missing Segment.</p></div>
            <div class="comment-info" id="comment-41874-info">
                
                
                
                

                

                <span class="comment-age">(26 Apr '15, 16:25)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
        <a name="41876"></a>
        <div class="comment not_top_scorer" id="comment-41876">
            <div id="post-41876-score" class="comment-score"></div>
            <div class="comment-text"><p>"The third packet (black) i don't see the problem because the second packet (black) have the ACK only for this packet" 
The third packet carries 513 bytes of payload in the reverse direction so it's the first time in this trace snippet that port 50526 is actually sending data.</p></div>
            <div class="comment-info" id="comment-41876-info">
                
                
                
                

                

                <span class="comment-age">(26 Apr '15, 20:47)</span>
                <a class="comment-user userinfo" href="/users/4668/mreede">mrEEde</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-41845" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 9
        </span>
        <a href="#" class="show-all-comments-link">show 4 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-41845-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="41877"></a>
                    <div id="answer-container-41877" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-41877-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/41877/up/" rel="nofollow"> </a>
<div id="post-41877-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-41877-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/41877/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Just answering your question on Wireshark tuning to prevent packets not being captured in another answer thread, so it will not interfere with the interpretation of the packets in the other answer thread.</p>
<blockquote>
<p>"Can be the other reason?" Maybe the tracing tool could not keep up with the high packet rate tracing unfiltered packets." I have filters to capture all packets, i have a tuning on my S.O (Linux) for the buffer on network cards and i have a raid 10. Are there other tuning for wireshark?</p>
</blockquote>
<p>There is no one-size-fits-all-answer to tuning your capture setup. But in general, you will need to follow the path from the source to the disk on which the packets will be saved. Any resource in between can be a bottleneck. So check all involved resources...</p>
<ol>
<li><strong>The mirror port.</strong> When doing a monitor session to a mirror port, make sure the (combined) traffic of the sources does not overload the monitor port. Spanning a 1 Gbit/s interface both RX and TX can create 2 Gbit/s of traffic is it is fully utilized in both directions. Many switches report this in the interface statistics, so you can clear the counters before starting your capture and then read the discards after finishing the capture. Experiment in a test setup first to get to know your switch statistics in different scenarios.</li>
<li><strong>The capturing NIC and CPU.</strong> Does you Capturing NIC have enough buffer space for spikes in traffic. If the CPU is overloaded and can not respond to the IRQs of the NIC, the NIC must drop packets. So monitor your CPU usage and the counters of your NIC (if available under the OS being used).</li>
<li><strong>The disks.</strong> When libpcap/winpcap receives the frames, it needs to write them to disk. If your disk is not fast enough, packets will be dropped. If there are packets bursts, increasing the buffer size in dumpcap/tshark/wireshark might help but if there is a custant flow of traffic that the disks can't keep up with, then increasing the buffer size will not matter. You will need to filter more or slice packets (if you don't care about higher layer protocol data). Or you need to stripe disks (as you are already doing, but why RAID10, why not use RAID0 with 4 disks so you have quadrupple write speeds whicl capturing). The dropped packets counter in pcapng formatted files indicate the amount of packets libpcap/winpcap was not able to save to disk.</li>
</ol>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/41877/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>27 Apr '15, 01:32</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7901a94d8fdd1f9f47cda9a32fcfa177?s=32&amp;d=identicon&amp;r=g" alt="SYN-bit's gravatar image" />
    <p><a href="/users/5/syn-bit">SYN-bit ♦♦</a><br/>
    <span class="score" title="17094 reputation points"><span class="">17.1k</span></span><span title="9 badges"><span class="badge1">&#9679;</span><span class="badgecount">9</span></span><span title="57 badges"><span class="silver">&#9679;</span><span class="badgecount">57</span></span><span title="245 badges"><span class="bronze">&#9679;</span><span class="badgecount">245</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="SYN-bit has 174 accepted answers">20&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-41877">
    
</div>
<div id="comment-tools-41877" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-41877-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/41844/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='KV10mrzlMjQNQ896PQpk7JO2ZhwQ0EKh' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/41844/duplicated-sequence-number?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/41844/duplicated-sequence-number?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/ack/"
            class="tag-link-ack"
            title="see questions tagged'ack'using tags"
            rel="tag">ack</a> <span class="tag-number">&#215;139</span><br/>
        
        <a href="/tags/sequence/"
            class="tag-link-sequence"
            title="see questions tagged'sequence'using tags"
            rel="tag">sequence</a> <span class="tag-number">&#215;39</span><br/>
        
        <a href="/tags/segment/"
            class="tag-link-segment"
            title="see questions tagged'segment'using tags"
            rel="tag">segment</a> <span class="tag-number">&#215;26</span><br/>
        
        <a href="/tags/unseen/"
            class="tag-link-unseen"
            title="see questions tagged'unseen'using tags"
            rel="tag">unseen</a> <span class="tag-number">&#215;10</span><br/>
        
        <a href="/tags/duplicated/"
            class="tag-link-duplicated"
            title="see questions tagged'duplicated'using tags"
            rel="tag">duplicated</a> <span class="tag-number">&#215;3</span><br/>
        
    </p>
    <p>
        question asked: <strong title="April 25, 2015, 6:35 p.m.">25 Apr '15, 18:35</strong>
    </p>
    <p> 
     	question was seen: <strong>6,317 times</strong>
    </p>
    <p> 
        last updated: <strong title="April 27, 2015, 1:32 a.m.">27 Apr '15, 01:32</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/47016/ack-seq-number-and-number-of-retransmission">ACK seq number and number of retransmission</a>
        </p>
        
        <p>
            <a href="/questions/48342/second-frame-payload-unseen-segment">Second frame payload unseen segment</a>
        </p>
        
        <p>
            <a href="/questions/2145/how-do-tcp-sequence-and-acknowledgement-numbers-work">How do TCP sequence and acknowledgement numbers work</a>
        </p>
        
        <p>
            <a href="/questions/7595/connections-to-remote-server-just-stall-seq-mismatch">Connections to remote server just stall - Seq mismatch?</a>
        </p>
        
        <p>
            <a href="/questions/31011/interpret-packet-captures-data">Interpret Packet Captures Data</a>
        </p>
        
        <p>
            <a href="/questions/6871/server-sends-a-strange-ack-during-three-way-handshake">Server sends a strange ACK during three-way handshake</a>
        </p>
        
        <p>
            <a href="/questions/38611/nfs-and-tcp-acked-unseen-segment">NFS and TCP ACKed Unseen Segment</a>
        </p>
        
        <p>
            <a href="/questions/792/esp-sequence-check-for-lost-packets">ESP sequence check for lost packets ?</a>
        </p>
        
        <p>
            <a href="/questions/22052/how-to-filter-for-out-of-sequence-packets-based-on-ip-identification-number">How to filter for Out of Sequence packets based on IP Identification number?</a>
        </p>
        
        <p>
            <a href="/questions/7418/tcp-acking-every-other-segment">tcp acking every other segment?</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
