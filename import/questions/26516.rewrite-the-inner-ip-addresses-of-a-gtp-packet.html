<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Rewrite the inner IP addresses of a GTP packet - Wireshark Q&amp;A</title>
        <meta name="description" content="I have a capture (pcap) file with GTP-C and GTP-U traffic. I need to edit the inner source and destination IP address of the GTP packet. These would be the IP addresses related the actual subscriber&#39;s traffic flow. I was trying to achieve this using tcpprep and tcprewrite, but I am only able rewrite..." />
        <meta name="keywords" content="gtp,ip,pcap" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/26516/rewrite-the-inner-ip-addresses-of-a-gtp-packet" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/26516/rewrite-the-inner-ip-addresses-of-a-gtp-packet?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='AOefBdzk12DFQPiun958HTSJm1k33dcm' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/26516/rewrite-the-inner-ip-addresses-of-a-gtp-packet">Rewrite the inner IP addresses of a GTP packet</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-26516-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/26516/up/" rel="nofollow"> </a>
<div id="post-26516-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-26516-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/26516/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/26516/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>I have a capture (pcap) file with GTP-C and GTP-U traffic. I need to edit the inner source and destination IP address of the GTP packet. These would be the IP addresses related the actual subscriber's traffic flow. I was trying to achieve this using tcpprep and tcprewrite, but I am only able rewrite the outer (GGSN and SGSN) IP addresses. I want to keep the outer IP addresses as is, and only change the inner IP addresses. So, is it still possible to achieve what I want using tcpreqrite or do I have to take some other approach? Thanks.</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/gtp/" class="post-tag tag-link-gtp"
                                        title="see questions tagged 'gtp'" rel="tag">gtp</a>
                                
                                    <a href="/tags/ip/" class="post-tag tag-link-ip"
                                        title="see questions tagged 'ip'" rel="tag">ip</a>
                                
                                    <a href="/tags/pcap/" class="post-tag tag-link-pcap"
                                        title="see questions tagged 'pcap'" rel="tag">pcap</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>29 Oct '13, 09:08</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f06228c3ce6d7a0b36c09417311ff2bb?s=32&amp;d=identicon&amp;r=g" alt="waqasamin's gravatar image" />
    <p><a href="/users/5974/waqasamin">waqasamin</a><br/>
    <span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="bronze">&#9679;</span><span class="badgecount">1</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="waqasamin has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-26516">
    
        <a name="26521"></a>
        <div class="comment" id="comment-26521">
            <div id="post-26521-score" class="comment-score"></div>
            <div class="comment-text"><p>I'm not certain if it works on GTP traffic, but you might take a look at Bittwist <a href="http://bittwist.sourceforge.net/">http://bittwist.sourceforge.net/</a>  It has a packet editor that may do what you need.</p></div>
            <div class="comment-info" id="comment-26521-info">
                
                
                
                

                

                <span class="comment-age">(29 Oct '13, 10:36)</span>
                <a class="comment-user userinfo" href="/users/931/kpalmgren">kpalmgren</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-26516" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-26516-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/26516/rewrite-the-inner-ip-addresses-of-a-gtp-packet?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/26516/rewrite-the-inner-ip-addresses-of-a-gtp-packet?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/26516/rewrite-the-inner-ip-addresses-of-a-gtp-packet?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/26516/rewrite-the-inner-ip-addresses-of-a-gtp-packet?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="26529"></a>
                    <div id="answer-container-26529" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-26529-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/26529/up/" rel="nofollow"> </a>
<div id="post-26529-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-26529-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/26529/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p><a href="http://www.tracewrangler.com">TraceWrangler</a> can parse GTP-U packets and allows removing the outer layer, basically stripping the packet down to the inner IP and payload layers. It does not (yet) offer annonymization/modification of GTP-U or GTP-C packets, but maybe I can add that functionality at some point. </p>
<p>The problem is that it is quite hard to find adequate samples to do the tests while implementing features like that, because of the sensitive nature of the details found inside. Sort of a Catch-22: I need to see a sample to be able to implement anonymization but I can't get the sample because it is not anonymized yet :-)</p>
<p>But back to your question: I doubt that there are any tools that can do what you need, because both tcprewrite and bittwiste cannot deal with tunneled layers. I guess you'll have to do it the hard way in the meantime: using a hex editor (I can recommend the "010 Editor" which has templates that makes it easier to parse pcap files).</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/26529/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>30 Oct '13, 00:33</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" alt="Jasper's gravatar image" />
    <p><a href="/users/145/jasper">Jasper ♦♦</a><br/>
    <span class="score" title="23806 reputation points"><span class="">23.8k</span></span><span title="5 badges"><span class="badge1">&#9679;</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">&#9679;</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">&#9679;</span><span class="badgecount">284</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Jasper has 263 accepted answers">18&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/26529/">
                edited
                <strong>30 Oct '13, 00:34</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-26529">
    
        <a name="26538"></a>
        <div class="comment" id="comment-26538">
            <div id="post-26538-score" class="comment-score"></div>
            <div class="comment-text"><p>Removing the outer layer is not difficult, but that is not what I need. I do have a very good sample, but for understandable reasons I cannot share that :). I think the hex editor approach won't work because the file is over 1GB, though I will still give it a go. Thanks.</p></div>
            <div class="comment-info" id="comment-26538-info">
                
                
                
                

                

                <span class="comment-age">(30 Oct '13, 07:22)</span>
                <a class="comment-user userinfo" href="/users/5974/waqasamin">waqasamin</a>
                
            </div>
        </div>
    
        <a name="26556"></a>
        <div class="comment" id="comment-26556">
            <div id="post-26556-score" class="comment-score"></div>
            <div class="comment-text"><p>Some sample files:</p>

<blockquote>
<p><a href="http://cloudshark.org/captures/374cf36574b6">http://cloudshark.org/captures/374cf36574b6</a> <br>
<a href="https://bro-tracker.atlassian.net/browse/BIT-934">https://bro-tracker.atlassian.net/browse/BIT-934</a></p>
</blockquote>

<p>Have fun coding that stuff ;-))</p></div>
            <div class="comment-info" id="comment-26556-info">
                
                
                
                

                

                <span class="comment-age">(30 Oct '13, 15:20)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="26558"></a>
        <div class="comment" id="comment-26558">
            <div id="post-26558-score" class="comment-score"></div>
            <div class="comment-text"><p>GTPv1 especially has some stuff out there, mostly as it relates to openGGSN, but even then it's darn-near impossible to get full mobility call flows in a trace file outside of tight NDAs.</p>

<p>I'm trying to get permission from a carrier to allow public distribution of 3GPP call flow traces that can be generated in a lab environment (a mini but working cell network, simulator-free and with support for the major EPS, GPRS and traditional CS call flows). With a test network number and non-confidential media payload, I think I could reliably reproduce and capture snapshot examples of most 3GPP-defined call flows including all protocols involved, and comment every packet in the flow citing the 3GPP TS and section number that defines why it's there.</p>

<p>Getting that approved might be difficult but since I need to lobby for it anyway to complete a publicly-distributable project I'm trying to get off the ground, if I'm successful I'll get you the trace files if it helps you with your sanitizer. Can't make any promises though.</p></div>
            <div class="comment-info" id="comment-26558-info">
                
                
                
                

                

                <span class="comment-age">(30 Oct '13, 20:38)</span>
                <a class="comment-user userinfo" href="/users/4985/quadratic">Quadratic</a>
                
            </div>
        </div>
    
        <a name="26564"></a>
        <div class="comment" id="comment-26564">
            <div id="post-26564-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/2593/kurt-knochner">@Kurt</a>: thanks, I already have some of them, but I'll take a closer look to see if I can improve my decodes.</p>

<p><a href="/users/4985/quadratic">@Quadratic</a>: thanks for your efforts, it would be cool to see something like that. I can understand the sensitive nature of such traces, so if you can provide some that are not violating any NDAs and do not expose any critical data I would love to take a look.</p>

<p>If not, that's fine too - there are so many other protocols that I can work on instead... :-)</p></div>
            <div class="comment-info" id="comment-26564-info">
                
                
                
                

                

                <span class="comment-age">(31 Oct '13, 01:23)</span>
                <a class="comment-user userinfo" href="/users/145/jasper">Jasper ♦♦</a>
                
            </div>
        </div>
    
        <a name="26570"></a>
        <div class="comment" id="comment-26570">
            <div id="post-26570-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>but even then it's darn-near impossible to get full mobility call flows in a trace file outside of tight NDAs.</p>
</blockquote>

<p>I always wondered what kind of secret byte string could be part of a capture file that requires an NDA? Aren't there test environments where one can generate 'non real world' traffic?</p></div>
            <div class="comment-info" id="comment-26570-info">
                
                
                
                

                

                <span class="comment-age">(31 Oct '13, 02:59)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="26644"></a>
        <div class="comment not_top_scorer" id="comment-26644">
            <div id="post-26644-score" class="comment-score"></div>
            <div class="comment-text"><p>There are a few things that contribute to the secrecy:</p>

<p>Even though a protocol might be standardized, many mobile signaling protocols will reveal engineering decisions made by that vendor or by that operator. If you're a competing operator or vendor, there are a few ways you could take advantage of that. For example a vendor might lobby the 3GPP to make a section mandatory if they knew another vendor chose not to support it in their traces yet, or an operator might leverage design decisions made by another operator in their own decision-making process.</p>

<p>And it's not just optional fields, or in some cases literally per-feature booleaan flags indicating support, either. The presence of some optional messages in a call flow would tell you whether that network was using real-time policy/QoS control, real-time credit control, checks against IMEI black list registries, etc. It would reveal whether they had deployed Diameter routing which is a hot topic in the industry right now. Even in a development environment, it would suggest a lot about their plans or the state of their production environment.</p>

<p>Even to take something as standard as DNS, due to the 3GPP's extensive use of NAPTR and SRV records to convey service information, a full DNS trace would practically serve as an NMAP protocol scan in the core of a carrier's network, providing a list of logical systems, their IPs and what protocols and protocol versions they support. In general, since mobile networks have so many small parts communicating so verbosely to each  other, a packet capture of all the signaling flows is revealing on many levels.</p>

<p>Some vendors also have proprietary versions or extensions to standards, where the messages themselves (unlike something like EIGRP) could actually be under NDA as well. And for exchanges in the SS7 stack, the equivalent of public IP info (public point code and GT information) would be revealed as well.</p>

<p>You'll notice that most traces that have been made public have been GTP or MTP3-related, which are sent between carriers and can't really be "protected" in this way from untrusted peers. Rarely will you see radio network exchanges (NBAP, RANAP, S1AP) or intra-core exchanges (SGsAP, Diameter policy/credit/authentication for the time being) in the wild right now.</p>

<p>Anyway, my plan is to use a minimalist lab environment to demonstrate the simplest, standards-based flows possible, then request NDA exemption for them. I honestly don't think I will succeed, but we shall see</p></div>
            <div class="comment-info" id="comment-26644-info">
                
                
                
                

                

                <span class="comment-age">(03 Nov '13, 13:14)</span>
                <a class="comment-user userinfo" href="/users/4985/quadratic">Quadratic</a>
                
            </div>
        </div>
    
        <a name="26645"></a>
        <div class="comment not_top_scorer" id="comment-26645">
            <div id="post-26645-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/4985/quadratic"></a><a href="/users/4985/quadratic">@Quadratic</a>: thanks for elaborating, this was a really interesting explanation. It also means that I probably shouldn't spend too much time on thinking about sanitization for these kind of traces, since you made it clear that even features being present/not present can be a problem - and I just really don't know enough of these protocol families to be able to do a good job in that regard.</p>

<p>So dear network carrier engineers, I'm sorry, but unless I change jobs and become really familiar with your network protocols I will spend my time sanitizing others that I know better ;-)</p>

<p>Of course, if there is a good lab trace and someone tells me what to focus on / what makes sense to sanitize I could try ;-)</p></div>
            <div class="comment-info" id="comment-26645-info">
                
                
                
                

                

                <span class="comment-age">(03 Nov '13, 13:25)</span>
                <a class="comment-user userinfo" href="/users/145/jasper">Jasper ♦♦</a>
                
            </div>
        </div>
    
        <a name="26659"></a>
        <div class="comment not_top_scorer" id="comment-26659">
            <div id="post-26659-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>There are a few things that contribute to the secrecy:</p>
</blockquote>

<p>Jesus, that sounds like 3GPP environments are more like a secret society than an 'open' protocol standard ;-)</p>

<p>O.K. I see, there is obviously no simple way to generate meaningful traces, except by capturing them in a live environment and that would contain too much about internal structures.</p>

<p>In that respect, I wish you good luck with your endeavor :-)</p>

<p>Thanks  <br>
Kurt</p></div>
            <div class="comment-info" id="comment-26659-info">
                
                
                
                

                

                <span class="comment-age">(04 Nov '13, 05:24)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-26529" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 8
        </span>
        <a href="#" class="show-all-comments-link">show 3 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-26529-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="26557"></a>
                    <div id="answer-container-26557" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-26557-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/26557/up/" rel="nofollow"> </a>
<div id="post-26557-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-26557-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/26557/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>See my answer to a similar question:</p>
<blockquote>
<p><a href="http://ask.wireshark.org/questions/25437/field-obfuscation">http://ask.wireshark.org/questions/25437/field-obfuscation</a></p>
</blockquote>
<p>Basically you can use a hex editor (as <a href="/users/145/jasper"><a href="/users/145/jasper">@Jasper</a></a> said), or you can use <strong>sed</strong> on Linux.</p>
<p>The IP header in the GTP encapsulated frame should be pretty unique in the capture file, so if you just replace the byte string that contains the IP addresses, it should work (in most of the cases).</p>
<p>Sample gtp-u file: </p>
<blockquote>
<p><a href="http://cloudshark.org/captures/374cf36574b6">http://cloudshark.org/captures/374cf36574b6</a></p>
</blockquote>
<p>Now, run <strong>sed</strong> on Linux (<strong>tested</strong> and <strong>works!</strong>)</p>
<p>One direction of communication:</p>
<blockquote>
<p>sed -i 's/\xca\x0b\x28\x9e\xc0\xa8\x28\xb2/\x0a\x01\x01\x01\x0a\x01\x01\x02/g' gtp-u.pcap</p>
</blockquote>
<p>Other (reverse) direction of communication:</p>
<blockquote>
<p>sed -i 's/\xc0\xa8\x28\xb2\xca\x0b\x28\x9e/\x0a\x01\x01\x02\x0a\x01\x01\x01/g' gtp-u.pcap</p>
</blockquote>
<p>This will change the IP addresses </p>
<p>from: 202.11.40.158, 192.168.40.178 <br>
to: 10.1.1.1, 10.1.1.2 </p>
<p>This is <strong>not</strong> perfect, as you may hit false positives in your pcap file, but it's better than nothing ;-))</p>
<p><strong>Hint:</strong> The IP checksum will be wrong after that change, but there is no simple solution for this. Sorry.</p>
<p>Regards <br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/26557/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>30 Oct '13, 15:32</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/26557/">
                edited
                <strong>31 Oct '13, 03:29</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-26557">
    
</div>
<div id="comment-tools-26557" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-26557-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/26516/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='AOefBdzk12DFQPiun958HTSJm1k33dcm' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/26516/rewrite-the-inner-ip-addresses-of-a-gtp-packet?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/26516/rewrite-the-inner-ip-addresses-of-a-gtp-packet?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/pcap/"
            class="tag-link-pcap"
            title="see questions tagged'pcap'using tags"
            rel="tag">pcap</a> <span class="tag-number">&#215;238</span><br/>
        
        <a href="/tags/ip/"
            class="tag-link-ip"
            title="see questions tagged'ip'using tags"
            rel="tag">ip</a> <span class="tag-number">&#215;178</span><br/>
        
        <a href="/tags/gtp/"
            class="tag-link-gtp"
            title="see questions tagged'gtp'using tags"
            rel="tag">gtp</a> <span class="tag-number">&#215;13</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Oct. 29, 2013, 9:08 a.m.">29 Oct '13, 09:08</strong>
    </p>
    <p> 
     	question was seen: <strong>5,687 times</strong>
    </p>
    <p> 
        last updated: <strong title="Nov. 4, 2013, 5:24 a.m.">04 Nov '13, 05:24</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/54881/rebuilding-pcap-without-ip-fragmentation">Rebuilding PCAP without IP Fragmentation</a>
        </p>
        
        <p>
            <a href="/questions/13023/filter-multiple-ips">Filter multiple IPs</a>
        </p>
        
        <p>
            <a href="/questions/169/gtp-ipsrc-displays-only-encapsulated-ip-address">GTP: ip.src displays only encapsulated IP address</a>
        </p>
        
        <p>
            <a href="/questions/2968/using-multiple-ip-ranges-in-one-capture">Using Multiple IP ranges in one capture</a>
        </p>
        
        <p>
            <a href="/questions/8353/missing-ip">Missing IP</a>
        </p>
        
        <p>
            <a href="/questions/11547/capture-ip-filter">Capture IP filter</a>
        </p>
        
        <p>
            <a href="/questions/16365/get-most-common-sender-of-packets-in-a-trace-file">get most common sender of packets in a trace file</a>
        </p>
        
        <p>
            <a href="/questions/20889/checking-of-open-ports-of-a-remote-ip">Checking of open ports of a remote IP .</a>
        </p>
        
        <p>
            <a href="/questions/25554/duplicate-ip-address-detected-but-mac-doesnt-exist">Duplicate IP address detected but mac doesn&#39;t exist</a>
        </p>
        
        <p>
            <a href="/questions/33140/capturing-all-traffic-from-one-ip">Capturing all traffic from one IP</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
