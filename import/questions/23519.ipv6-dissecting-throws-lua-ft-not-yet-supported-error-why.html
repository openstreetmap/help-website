<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>IPv6 Dissecting throws Lua FT not yet supported error! Why? - Wireshark Q&amp;A</title>
        <meta name="description" content="I am using  field.IPV6 = ProtoField.ipv6 (&quot;IPv6&quot;, &quot;IPv6 Address&quot;)  subtree:add(IPv6, buffer(offset, 16) it throws LUA: FT not supported yet error. why do they then have in in the API reference? what&#39;s going on?" />
        <meta name="keywords" content="lua,dissector,error,ipv6" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/23519/ipv6-dissecting-throws-lua-ft-not-yet-supported-error-why" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/23519/ipv6-dissecting-throws-lua-ft-not-yet-supported-error-why?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='x6cuGYZ8No71HwnbClmDN1NOBLnazwm7' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/23519/ipv6-dissecting-throws-lua-ft-not-yet-supported-error-why">IPv6 Dissecting throws Lua FT not yet supported error! Why?</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-23519-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/23519/up/" rel="nofollow"> </a>
<div id="post-23519-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-23519-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/23519/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/23519/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>I am using 
field.IPV6 = ProtoField.ipv6 ("IPv6", "IPv6 Address") </p>
<p>subtree:add(IPv6, buffer(offset, 16)</p>
<p>it throws LUA: FT not supported yet error.
why do they then have in in the API reference?
what's going on?</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/lua/" class="post-tag tag-link-lua"
                                        title="see questions tagged 'lua'" rel="tag">lua</a>
                                
                                    <a href="/tags/dissector/" class="post-tag tag-link-dissector"
                                        title="see questions tagged 'dissector'" rel="tag">dissector</a>
                                
                                    <a href="/tags/error/" class="post-tag tag-link-error"
                                        title="see questions tagged 'error'" rel="tag">error</a>
                                
                                    <a href="/tags/ipv6/" class="post-tag tag-link-ipv6"
                                        title="see questions tagged 'ipv6'" rel="tag">ipv6</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>02 Aug '13, 09:19</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/2ddc382640d092aeeba4db7267099715?s=32&amp;d=identicon&amp;r=g" alt="adityashankar's gravatar image" />
    <p><a href="/users/5392/adityashankar">adityashankar</a><br/>
    <span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="bronze">&#9679;</span><span class="badgecount">1</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="adityashankar has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-23519">
    
</div>
<div id="comment-tools-23519" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-23519-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    3 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/23519/ipv6-dissecting-throws-lua-ft-not-yet-supported-error-why?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/23519/ipv6-dissecting-throws-lua-ft-not-yet-supported-error-why?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/23519/ipv6-dissecting-throws-lua-ft-not-yet-supported-error-why?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/23519/ipv6-dissecting-throws-lua-ft-not-yet-supported-error-why?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="25104"></a>
                    <div id="answer-container-25104" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-25104-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/25104/up/" rel="nofollow"> </a>
<div id="post-25104-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-25104-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/25104/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>From <a href="http://anonsvn.wireshark.org/wireshark/trunk/epan/wslua/wslua_tree.c">wslua_tree.c</a></p>
<pre>static int TreeItem_add_item_any(lua_State *L, gboolean little_endian) {
...
            switch(type) {               
                case FT_IPv4:
                    item = proto_tree_add_ipv4(tree_item-&gt;tree,hfid,tvbr-&gt;tvb-&gt;ws_tvb,tvbr-&gt;offset,tvbr-&gt;len,*((guint32*)(checkAddress(L,1)-&gt;data)));
                    break;
                <b>case FT_IPv6:</b>
                case FT_IPXNET:
                case FT_GUID:
                case FT_OID:
                default:
                    <b>luaL_error(L,"FT_ not yet supported");</b>

</pre>

<p>So, adding IPv6 items to the tree is not yet implemented, whereas it is for IPv4.</p>
<p><a href="/users/5392/adityashankar"><a href="/users/5392/adityashankar">@adityashankar</a></a>: If you need that, please file an enhancement bug at <a href="https://bugs.wireshark.org">https://bugs.wireshark.org</a></p>
<p>Regards<br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/25104/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>23 Sep '13, 01:24</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-25104">
    
</div>
<div id="comment-tools-25104" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-25104-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="25167"></a>
                    <div id="answer-container-25167" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-25167-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/25167/up/" rel="nofollow"> </a>
<div id="post-25167-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-25167-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/25167/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>I don't think this is correct.  I finally decided to write a quick Lua dissector to test this, and I was able to successfully add an IPv6 address.</p>
<p>Anyway, I deleted my original answer, and I'm too lazy to retype it, but I think it might have been the correct answer after all, or closer to it anyway.</p>
<p>In a nutshell though, try something along the lines of the following:</p>
<pre><code>local field_ipv6 = ProtoField.ipv6("foo.IPv6", "IPv6 Address")

foo.fields = { ..., field_ipv6, ... }

subtree:add(field_ipv6, buffer(offset, 16)
</code></pre>
<p>Refer to the <a href="http://www.wireshark.org/docs/wsug_html_chunked/wslua_dissector_example.html">User Guide</a> for more help.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/25167/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>24 Sep '13, 12:13</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/55158e2322c4e365a5e0a4a0ac3fbcef?s=32&amp;d=identicon&amp;r=g" alt="cmaynard's gravatar image" />
    <p><a href="/users/402/cmaynard">cmaynard ♦♦</a><br/>
    <span class="score" title="9361 reputation points"><span class="">9.4k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="38 badges"><span class="silver">&#9679;</span><span class="badgecount">38</span></span><span title="142 badges"><span class="bronze">&#9679;</span><span class="badgecount">142</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="cmaynard has 108 accepted answers">20&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-25167">
    
        <a name="25170"></a>
        <div class="comment" id="comment-25170">
            <div id="post-25170-score" class="comment-score"></div>
            <div class="comment-text"><p>let's make this your answer ;-)</p>

<p>I admit I did not check very thoroughly if that's the reason, although it looked reasonable to me. Do you mind to post the 'IPv6 dissector'? I would like to do some tests myself.</p>

<p>Regards<br>
Kurt</p></div>
            <div class="comment-info" id="comment-25170-info">
                
                
                
                

                

                <span class="comment-age">(24 Sep '13, 13:06)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="25172"></a>
        <div class="comment" id="comment-25172">
            <div id="post-25172-score" class="comment-score"></div>
            <div class="comment-text"><p>Here is a <strong>VERY</strong> basic Lua dissector that you can start with.  You will need to replace <code>FOO_PORT</code> with some port number of your choice and then run: <code>wireshark -X lua_script:foo.lua</code>.</p>

<pre><code>do
    -- Protocol
    local p_foo = Proto("foo", "FOO Protocol")

    -- Fields
    local f_foo_val8 = ProtoField.uint8("foo.val8", "Value 8", base.OCT)
    local f_foo_val16 = ProtoField.uint16("foo.val16", "Value 16", base.DEC)
    local f_foo_val32 = ProtoField.uint32("foo.val32", "Value 32", base.HEX)
    local f_foo_ipv4 = ProtoField.ipv4("foo.ipv4", "IPv4 Address")
    local f_foo_ipv6 = ProtoField.ipv6("foo.ipv6", "IPv6 Address")

    p_foo.fields = { f_foo_val8, f_foo_val16, f_foo_val32, f_foo_ipv4, f_foo_ipv6 }

    -- Dissection
    function p_foo.dissector(buf, pinfo, tree)
        local foo_tree = tree:add(p_foo, buf(0,-1))

        pinfo.cols.protocol:set("FOO")
        foo_tree:add(f_foo_val8, buf(0, 1))
        foo_tree:add(f_foo_val16, buf(1, 2))
        foo_tree:add(f_foo_val32, buf(3, 4))
        foo_tree:add(f_foo_ipv4, buf(7, 4))
        foo_tree:add(f_foo_ipv6, buf(11, 16))
    end

    -- Registration
    local udp_table = DissectorTable.get("udp.port")
    udp_table:add(FOO_PORT, p_foo)

end
</code></pre></div>
            <div class="comment-info" id="comment-25172-info">
                
                
                
                

                

                <span class="comment-age">(24 Sep '13, 13:21)</span>
                <a class="comment-user userinfo" href="/users/402/cmaynard">cmaynard ♦♦</a>
                
            </div>
        </div>
    
        <a name="25182"></a>
        <div class="comment" id="comment-25182">
            <div id="post-25182-score" class="comment-score"></div>
            <div class="comment-text"><p>I uploaded a sample capture file to cloudshark that this lua dissector will be able to dissect.  See <a href="http://cloudshark.org/captures/965bd39c6694">http://cloudshark.org/captures/965bd39c6694</a> if you're interested.  (If you decide to download it, you might want to download the original file, as there's a capture file comment in it that references this question to let you know how it was intended to be dissected.)</p>

<p>That aside, after thinking about this some more, I think we're missing some information, because the question clearly indicates, <em>it throws LUA: FT not supported yet error.</em>, so if that's the case, then it certainly does seem that Kurt's answer is the correct one.<br>
</p>

<p>However, I know for certain that <code>ProtoField.ipv6</code> works because I tested it.  So, looking back at the question again (and after experimenting with Lua a bit), I now see:</p>

<pre><code>field.IPV6 = ProtoField.ipv6 ("IPv6", "IPv6 Address")
subtree:add(IPv6, buffer(offset, 16)
</code></pre>

<p>Besides the poor naming convention of the filter (which isn't actually a problem in itself), there are a couple of syntax errors, the first of which is <code>field.IPV6</code>.  This is an invalid name yielding an error dialog box that reads something along the lines of:</p>

<pre><code>Lua: syntax error during precompilation of 'foo.lua':
[string "foo.lua"]:11: unexpected symbol near '.' [OK]
</code></pre>

<p>So let's assume <code>field_IPV6</code> was intended, but then the next line should be:</p>

<pre><code>subtree:add(field_IPV6, buffer(offset, 16)
</code></pre>

<p>So I tested this too, passing the invalid original <code>IPv6</code> instead of <code>field_IPV6</code>, but Wireshark seems to start up just fine without any indications of any errors.  The field doesn't get added to the tree of course, but there's no error message either.  So basically I can't reproduce what <a href="/users/5392/adityashankar"></a><a href="/users/5392/adityashankar">@adityashankar</a> reported given only the information provided.  Maybe someone else can or maybe <a href="/users/5392/adityashankar"></a><a href="/users/5392/adityashankar">@adityashankar</a> can provide some additional information.</p></div>
            <div class="comment-info" id="comment-25182-info">
                
                
                
                

                

                <span class="comment-age">(24 Sep '13, 18:07)</span>
                <a class="comment-user userinfo" href="/users/402/cmaynard">cmaynard ♦♦</a>
                
            </div>
        </div>
    
        <a name="25203"></a>
        <div class="comment" id="comment-25203">
            <div id="post-25203-score" class="comment-score"></div>
            <div class="comment-text"><p>thanks for the code and the capture file. I'll have a look.</p>

<blockquote>
<p>maybe <a href="/users/5392/adityashankar">@adityashankar</a> can provide some additional information.</p>
</blockquote>

<p>I think we need the original code that caused the error message to understand what's going on.</p></div>
            <div class="comment-info" id="comment-25203-info">
                
                
                
                

                

                <span class="comment-age">(25 Sep '13, 04:11)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-25167" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-25167-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="30587"></a>
                    <div id="answer-container-30587" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-30587-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/30587/up/" rel="nofollow"> </a>
<div id="post-30587-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-30587-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/30587/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>This question is old, but since I know the answer I figured I'd answer it in case someone finds this Q&amp;A topic through the much-maligned ask.wireshark.org search algorithm (or just via google):</p>
<p>The reason the original ask'er would get that error, but not in cmaynard's script, is because the treeitem:add() method does different things depending on the number of arguments and argument types it gets. (in other words it has multiple function prototypes/signatures)  In fact one might say it has <em>too many</em> possible signatures, because it's really confusing.</p>
<p>When it's called with a first argument of a Proto or ProtoField, and a second argument of a TvbRange, and no more arguments than that, then it adds the given field type to the tree based on the given tvbrange.  In that case, using an IPv6-based field is fine.</p>
<p>That's what happens in cmaynard's script when it does this:</p>
<pre><code>foo_tree:add(f_foo_ipv6, buf(11, 16))
</code></pre>
<p>Since that has only two arguments, and the first one is a ProtoField and the second is a TvbRange, it'll add the TVB's bytes starting at offset 11 for length 16, as an IPv6 address into the tree.</p>
<p>But if there were a <em>third</em> argument to treeitem:add(), then the third argument is a <strong>value</strong>, to be used for the field in the tree display.  The TvbRange (second argument) would still be used, to highlight in the bytes window pane where the value is, but the value third argument is used for the value shown in the details pane and filters and such.  Unfortunately, in that model, one cannot use an IPv6 field type for the first argument. (probably because it would be a pain to handle a value being passed in from Lua for that, since an IPv6 value can't be represented by a number or boolean)</p>
<p>The reason I say the function is too confusing, however, is because it also has other signatures: if the first argument is a Proto or ProtoField and the second argument is <strong>not</strong> a TvbRange, but is instead something else, then that <em>second</em> argument is treated as the <strong>value</strong> to be set, and again if the first argument is a IPv6 field type, then again you can't do it and will hit this error.</p>
<p>But wait, don't act yet!  We'll also throw in a free steak knife set... because the treeitem:add() has other signatures too, including ones where there are neither Proto/ProtoField nor TvbRange, and one where the first argument is a TvbRange and the second is a string, and another where there's only a TvbRange argument.</p>
<p>So I guess one could say the function is very flexible and accommodating. :)</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/30587/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>07 Mar '14, 16:21</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d02f20c18a7742ec73a666f1974bf6dc?s=32&amp;d=identicon&amp;r=g" alt="Hadriel's gravatar image" />
    <p><a href="/users/4318/hadriel">Hadriel</a><br/>
    <span class="score" title="2652 reputation points"><span class="">2.7k</span></span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="9 badges"><span class="silver">&#9679;</span><span class="badgecount">9</span></span><span title="39 badges"><span class="bronze">&#9679;</span><span class="badgecount">39</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Hadriel has 30 accepted answers">18&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-30587">
    
</div>
<div id="comment-tools-30587" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-30587-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/23519/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='x6cuGYZ8No71HwnbClmDN1NOBLnazwm7' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/23519/ipv6-dissecting-throws-lua-ft-not-yet-supported-error-why?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/23519/ipv6-dissecting-throws-lua-ft-not-yet-supported-error-why?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/dissector/"
            class="tag-link-dissector"
            title="see questions tagged'dissector'using tags"
            rel="tag">dissector</a> <span class="tag-number">&#215;637</span><br/>
        
        <a href="/tags/lua/"
            class="tag-link-lua"
            title="see questions tagged'lua'using tags"
            rel="tag">lua</a> <span class="tag-number">&#215;431</span><br/>
        
        <a href="/tags/error/"
            class="tag-link-error"
            title="see questions tagged'error'using tags"
            rel="tag">error</a> <span class="tag-number">&#215;193</span><br/>
        
        <a href="/tags/ipv6/"
            class="tag-link-ipv6"
            title="see questions tagged'ipv6'using tags"
            rel="tag">ipv6</a> <span class="tag-number">&#215;51</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Aug. 2, 2013, 9:19 a.m.">02 Aug '13, 09:19</strong>
    </p>
    <p> 
     	question was seen: <strong>5,580 times</strong>
    </p>
    <p> 
        last updated: <strong title="March 7, 2014, 4:21 p.m.">07 Mar '14, 16:21</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/32754/nested-lua-dissector-with-cigi">Nested LUA Dissector with CIGI</a>
        </p>
        
        <p>
            <a href="/questions/40250/how-to-get-the-captures-path">How to get the capture&#39;s path?</a>
        </p>
        
        <p>
            <a href="/questions/53802/how-dissect-two-segments-of-one-protocol-in-the-same-packet-in-the-same-tcp-segment-lua">How dissect two segments of one protocol in the same packet , in the same TCP segment (LUA)?</a>
        </p>
        
        <p>
            <a href="/questions/54834/how-to-install-lua-in-wireshark-running-on-linux-fedora-22">How to install LUA in Wireshark running on Linux (Fedora 22)?</a>
        </p>
        
        <p>
            <a href="/questions/56135/how-to-call-my-dissector-on-usb-payload-leftover-capture-data">How to call my dissector on USB payload (leftover capture data)</a>
        </p>
        
        <p>
            <a href="/questions/58607/how-can-i-set-proto-hierarchy-response-times-in-a-lua-dissector">How can I set proto hierarchy &amp; response times in a lua dissector?</a>
        </p>
        
        <p>
            <a href="/questions/60879/lua-dissector-preferences-scope">Lua dissector preferences scope?</a>
        </p>
        
        <p>
            <a href="/questions/41614/converting-userdata-to-number">converting userdata to number</a>
        </p>
        
        <p>
            <a href="/questions/5746/tcp-dissector-detect-which-endpoint-opened-the-connection">TCP Dissector, detect which endpoint opened the connection?</a>
        </p>
        
        <p>
            <a href="/questions/6769/access-to-decrypted-wpawpa2-data-for-lua-dissector">Access to decrypted WPA/WPA2 data for lua dissector</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
