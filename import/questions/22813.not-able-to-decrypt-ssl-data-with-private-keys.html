<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Not able to decrypt SSL data with Private Keys - Wireshark Q&amp;A</title>
        <meta name="description" content="Hi there, I m trying to decrypt SSL encrypted data using wireshark, but i m not able to do so. I have provided the RSA keys and the key location in the wireshark, also i m using TLS_RSA_WITH_RC4_128_SHA, so typically Diffie Helmann concept is outta context here. The following is the snap from the de..." />
        <meta name="keywords" content="ssl,decryption" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/22813/not-able-to-decrypt-ssl-data-with-private-keys" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/22813/not-able-to-decrypt-ssl-data-with-private-keys?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='MdXZ9jg6dXrlcFxZbO201Q6JDOTijOPR' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/22813/not-able-to-decrypt-ssl-data-with-private-keys">Not able to decrypt SSL data with Private Keys</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-22813-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/22813/up/" rel="nofollow"> </a>
<div id="post-22813-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-22813-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/22813/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/22813/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hi there,</p>
<p>I m trying to decrypt SSL encrypted data using wireshark, but i m not able to do so. I have provided the RSA keys and the key location in the wireshark, also i m using TLS_RSA_WITH_RC4_128_SHA, so typically Diffie Helmann concept is outta context here. The following is the snap from the debug,</p>
<pre>ssl_association_remove removing TCP 443 - http handle 04453A50
Private key imported: KeyID 5d:bf:fb:fa:7f:5a:a7:57:7f:30:80:36:39:15:d5:1a:...

ssl_init IPv4 addr '2.56.4.2' (2.56.4.2) port '443' filename 'C:\Documents and Settings\Administrator\Desktop\latest_server.key' password(only for p12 file) ''
ssl_init private key file C:\Documents and Settings\Administrator\Desktop\latest_server.key successfully loaded.
association_add TCP port 443 protocol http handle 04453A50

dissect_ssl enter frame #22 (first time)
ssl_session_init: initializing ptr 0566222C size 588
  conversation = 05661DF4, ssl_session = 0566222C
  record: offset = 0, reported_length_remaining = 94
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 89, ssl state 0x00
association_find: TCP port 1479 found 00000000
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 1 offset 5 length 85 bytes, remaining 94 
packet_from_server: is from server - FALSE
ssl_find_private_key server 2.56.4.2:443
dissect_ssl3_hnd_hello_common found CLIENT RANDOM -&gt; state 0x01

dissect_ssl enter frame #24 (first time)
  conversation = 05661DF4, ssl_session = 0566222C
  record: offset = 0, reported_length_remaining = 1145
dissect_ssl3_record found version 0x0301 -&gt; state 0x11
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 74, ssl state 0x11
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 2 offset 5 length 70 bytes, remaining 79 
dissect_ssl3_hnd_hello_common found SERVER RANDOM -&gt; state 0x13
dissect_ssl3_hnd_srv_hello found CIPHER 0x0005 -&gt; state 0x17
dissect_ssl3_hnd_srv_hello trying to generate keys
ssl_generate_keyring_material not enough data to generate key (0x17 required 0x37 or 0x57)
dissect_ssl3_hnd_srv_hello can't generate keyring material
  record: offset = 79, reported_length_remaining = 1066
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 1052, ssl state 0x17
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 11 offset 84 length 1048 bytes, remaining 1136 
  record: offset = 1136, reported_length_remaining = 9
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 4, ssl state 0x17
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 14 offset 1141 length 0 bytes, remaining 1145 

dissect_ssl enter frame #25 (first time)
  conversation = 05661DF4, ssl_session = 0566222C
  record: offset = 0, reported_length_remaining = 186
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 134, ssl state 0x17
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 16 offset 5 length 130 bytes, remaining 139 
pre master encrypted[128]:
71 de ea fa d9 77 eb f9 36 dc 59 30 4d 64 71 79 
c6 31 a4 13 e8 cc cc 8e 45 0e 08 e4 c7 e7 b6 50 
54 e9 80 f1 eb 3e 7d 4a 68 e2 1f f5 e6 ca 84 ec 
33 39 9e 4a f8 fa ff 35 a8 a2 e9 4a 88 aa 46 77 
16 46 52 06 89 56 57 31 7b d5 b2 41 d6 2b c6 95 
21 cb 8a 71 cb e2 1f 05 c1 a9 bd 52 43 d0 d7 6b 
b5 75 00 1a ca 1a 4f 47 b1 38 91 5d 3f 22 8c f8 
af ec 07 7c be 64 08 a5 ae 63 32 04 56 62 3f d7 
ssl_decrypt_pre_master_secret:RSA_private_decrypt
pcry_private_decrypt: stripping 0 bytes, decr_len 128
decrypted_unstrip_pre_master[128]:
81 e2 42 e6 47 c6 f7 a1 cf f5 65 c5 e6 09 b4 7a 
d9 ed 35 60 a4 d0 71 b3 29 ca 96 c4 cc fc ec b9 
6c cb 19 50 91 a8 83 92 93 20 7d 3c 2d 34 82 f5 
b8 fe 3d 2c 27 2f 6b 6d 13 3a f8 16 8f c9 d4 75 
d8 85 64 7b b9 8e 4d 4d 11 e6 5c bb 69 0f 01 b8 
ab 0e db 7b 1f 76 a9 0f f5 57 a5 65 ae 5a 59 2e 
58 19 0b f4 bc 40 4b e6 4a db 33 27 9b a6 1c a3 
57 3d 8e 3f 10 9e 1e ae f5 d2 39 26 25 7e b5 cf 
ssl_decrypt_pre_master_secret wrong pre_master_secret length (128, expected 48)
dissect_ssl3_handshake can't decrypt pre master secret
  record: offset = 139, reported_length_remaining = 47
dissect_ssl3_record: content_type 20
dissect_ssl3_change_cipher_spec
packet_from_server: is from server - FALSE
ssl_change_cipher CLIENT
  record: offset = 145, reported_length_remaining = 41
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 36, ssl state 0x17
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 250 offset 150 length 1576909 bytes, remaining 186 

dissect_ssl enter frame #26 (first time)
  conversation = 05661DF4, ssl_session = 0566222C
  record: offset = 0, reported_length_remaining = 47
dissect_ssl3_record: content_type 20
dissect_ssl3_change_cipher_spec
packet_from_server: is from server - TRUE
ssl_change_cipher SERVER
  record: offset = 6, reported_length_remaining = 41
dissect_ssl3_record: content_type 22
decrypt_ssl3_record: app_data len 36, ssl state 0x17
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 187 offset 11 length 2702752 bytes, remaining 47 

dissect_ssl enter frame #27 (first time)
  conversation = 05661DF4, ssl_session = 0566222C
  record: offset = 0, reported_length_remaining = 322
dissect_ssl3_record: content_type 23
decrypt_ssl3_record: app_data len 317, ssl state 0x17
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
association_find: TCP port 1479 found 00000000
association_find: TCP port 443 found 04B14C48

dissect_ssl enter frame #28 (first time)
  conversation = 05661DF4, ssl_session = 0566222C
  record: offset = 0, reported_length_remaining = 320
dissect_ssl3_record: content_type 23
decrypt_ssl3_record: app_data len 315, ssl state 0x17
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available
association_find: TCP port 443 found 04B14C48

dissect_ssl enter frame #29 (first time)
  conversation = 05661DF4, ssl_session = 0566222C
  record: offset = 0, reported_length_remaining = 1460
  need_desegmentation: offset = 0, reported_length_remaining = 1460

dissect_ssl enter frame #31 (first time)
  conversation = 05661DF4, ssl_session = 0566222C
  record: offset = 0, reported_length_remaining = 2920
  need_desegmentation: offset = 0, reported_length_remaining = 2920

dissect_ssl enter frame #32 (first time)
  conversation = 05661DF4, ssl_session = 0566222C
  record: offset = 0, reported_length_remaining = 4380
  need_desegmentation: offset = 0, reported_length_remaining = 4380

dissect_ssl enter frame #33 (first time)
  conversation = 05661DF4, ssl_session = 0566222C
  record: offset = 0, reported_length_remaining = 5840
  need_desegmentation: offset = 0, reported_length_remaining = 5840

dissect_ssl enter frame #35 (first time)
  conversation = 05661DF4, ssl_session = 0566222C
  record: offset = 0, reported_length_remaining = 7300
  need_desegmentation: offset = 0, reported_length_remaining = 7300

dissect_ssl enter frame #36 (first time)
  conversation = 05661DF4, ssl_session = 0566222C
  record: offset = 0, reported_length_remaining = 8214
dissect_ssl3_record: content_type 23
decrypt_ssl3_record: app_data len 8182, ssl state 0x17
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available
association_find: TCP port 443 found 04B14C48
  record: offset = 8187, reported_length_remaining = 27
dissect_ssl3_record: content_type 21
decrypt_ssl3_record: app_data len 22, ssl state 0x17
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available

</pre>

<p>I am using my servers (Apache) keys to decrypt the data. </p>
<p>Please let me know what needs to be done in this context.</p>
<p>Thanks,</p>
<p>Ananth !! </p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/ssl/" class="post-tag tag-link-ssl"
                                        title="see questions tagged 'ssl'" rel="tag">ssl</a>
                                
                                    <a href="/tags/decryption/" class="post-tag tag-link-decryption"
                                        title="see questions tagged 'decryption'" rel="tag">decryption</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>10 Jul '13, 08:01</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/1a002d088b2603e068102c1fea7e7d7e?s=32&amp;d=identicon&amp;r=g" alt="Ananth's gravatar image" />
    <p><a href="/users/5265/ananth">Ananth</a><br/>
    <span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">&#9679;</span><span class="badgecount">2</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Ananth has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/22813/">
                edited
                <strong>10 Jul '13, 12:40</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
            <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
            <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-22813">
    
</div>
<div id="comment-tools-22813" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-22813-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/22813/not-able-to-decrypt-ssl-data-with-private-keys?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/22813/not-able-to-decrypt-ssl-data-with-private-keys?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/22813/not-able-to-decrypt-ssl-data-with-private-keys?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/22813/not-able-to-decrypt-ssl-data-with-private-keys?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="22827"></a>
                    <div id="answer-container-22827" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-22827-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/22827/up/" rel="nofollow"> </a>
<div id="post-22827-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-22827-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/22827/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>The debug data:</p>
<pre><code>ssl_decrypt_pre_master_secret wrong pre_master_secret length (128, expected 48)
dissect_ssl3_handshake can't decrypt pre master secret
</code></pre>
<p>Usually indicate that the provided private key does not correspond to the certificate in that particular SSL session. Are you sure you provided the right key?</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/22827/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>10 Jul '13, 13:42</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7901a94d8fdd1f9f47cda9a32fcfa177?s=32&amp;d=identicon&amp;r=g" alt="SYN-bit's gravatar image" />
    <p><a href="/users/5/syn-bit">SYN-bit ♦♦</a><br/>
    <span class="score" title="17094 reputation points"><span class="">17.1k</span></span><span title="9 badges"><span class="badge1">&#9679;</span><span class="badgecount">9</span></span><span title="57 badges"><span class="silver">&#9679;</span><span class="badgecount">57</span></span><span title="245 badges"><span class="bronze">&#9679;</span><span class="badgecount">245</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="SYN-bit has 174 accepted answers">20&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-22827">
    
        <a name="22829"></a>
        <div class="comment" id="comment-22829">
            <div id="post-22829-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes. The key which was used in Apache servers SSL session ( in httpd.conf) was copied and placed in this wire shark</p>

<p>Thanks, 
Ananth !!</p></div>
            <div class="comment-info" id="comment-22829-info">
                
                
                
                

                

                <span class="comment-age">(10 Jul '13, 21:04)</span>
                <a class="comment-user userinfo" href="/users/5265/ananth">Ananth</a>
                
            </div>
        </div>
    
        <a name="22831"></a>
        <div class="comment" id="comment-22831">
            <div id="post-22831-score" class="comment-score"></div>
            <div class="comment-text"><p>Since your filename is "latest_server.key", could it be that between making the packet capture and copying the key, the key could have been changed on the server?</p>

<p>Here is how you can check whether the certificate and key really match. First extract the certificate from the packet capture. Go to the "Certificate" SSL handshake message (of the session you wish to decrypt). Expand the subtrees until you see a line like this:</p>

<pre><code>Certificate (<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="98e8f3fbebb5a1b5f9ecb5fdf5f9f1f4d9fcfceafdebeba5fbf7d8ebf0f9eaf3fefdebecb6f4f7fbf9f4">[email&#160;protected]</a>,id-at-commonName=public.sharkfest.local,id-at-organizationName=Sharkfest Lab,id-at-stateOrProvinceName=Noord-Holland,id-at-countryName=NL)
</code></pre>

<p>If there are more lines like that, then the CA chain is sent by the server too. Click on the first certificate (this will be the certificate with the common name of the server in it).</p>

<p>Now rightclick on the certificate and choose "Export Selected Packet Bytes..." and save the certificate to a file.</p>

<p>Now check whether the output of the following two cammands is the same:</p>

<pre><code>openssl x509 -noout -modulus -inform DER -in certfile.cert
openssl rsa -noout -modulus -in privatekey.key
</code></pre>

<p>Or in a oneliner:</p>

<pre><code>(openssl x509 -noout -modulus -inform DER -in certfile.cert ; openssl rsa -noout -modulus -in privatekey.key) | uniq | wc -l
</code></pre>

<p>If the key matches the certificate, the output will be "1", if it doesn't the output will be "2"</p></div>
            <div class="comment-info" id="comment-22831-info">
                
                
                
                

                

                <span class="comment-age">(11 Jul '13, 00:02)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="22832"></a>
        <div class="comment" id="comment-22832">
            <div id="post-22832-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>Now check whether the output of the following two cammands is the same:<br>
openssl x509 -noout -modulus -inform DER -in certfile.cert<br>
openssl rsa -noout -modulus -in privatekey.key</p>
</blockquote>

<p>wouldn't that be a great extension for Wireshark to identify wrong keys during SSL decryption?</p></div>
            <div class="comment-info" id="comment-22832-info">
                
                
                
                

                

                <span class="comment-age">(11 Jul '13, 00:59)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="22833"></a>
        <div class="comment" id="comment-22833">
            <div id="post-22833-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes it would <a href="/users/2593/kurt-knochner">@Kurt</a>, it's been on my mind to add it... but time is not on my side unfortunately...</p></div>
            <div class="comment-info" id="comment-22833-info">
                
                
                
                

                

                <span class="comment-age">(11 Jul '13, 01:04)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="22834"></a>
        <div class="comment not_top_scorer" id="comment-22834">
            <div id="post-22834-score" class="comment-score"></div>
            <div class="comment-text"><p>Is there already an enhancement request for this?</p></div>
            <div class="comment-info" id="comment-22834-info">
                
                
                
                

                

                <span class="comment-age">(11 Jul '13, 01:30)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="46574"></a>
        <div class="comment" id="comment-46574">
            <div id="post-46574-score" class="comment-score">1</div>
            <div class="comment-text"><p>In Wireshark 2.0 (<a href="https://code.wireshark.org/review/10766),">https://code.wireshark.org/review/10766),</a> SSL keys will be matched by their public key instead of by a user-supplied address. Thus, the wrong key problem is solved.</p></div>
            <div class="comment-info" id="comment-46574-info">
                
                
                
                

                

                <span class="comment-age">(15 Oct '15, 10:37)</span>
                <a class="comment-user userinfo" href="/users/5644/lekensteyn">Lekensteyn</a>
                
            </div>
        </div>
    
        <a name="46863"></a>
        <div class="comment not_top_scorer" id="comment-46863">
            <div id="post-46863-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>Thus, the wrong key problem is solved.</p>
</blockquote>

<p>perfect. +1 for that!</p></div>
            <div class="comment-info" id="comment-46863-info">
                
                
                
                

                

                <span class="comment-age">(22 Oct '15, 15:27)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-22827" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 7
        </span>
        <a href="#" class="show-all-comments-link">show 2 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-22827-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/22813/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='MdXZ9jg6dXrlcFxZbO201Q6JDOTijOPR' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/22813/not-able-to-decrypt-ssl-data-with-private-keys?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/22813/not-able-to-decrypt-ssl-data-with-private-keys?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/ssl/"
            class="tag-link-ssl"
            title="see questions tagged'ssl'using tags"
            rel="tag">ssl</a> <span class="tag-number">&#215;319</span><br/>
        
        <a href="/tags/decryption/"
            class="tag-link-decryption"
            title="see questions tagged'decryption'using tags"
            rel="tag">decryption</a> <span class="tag-number">&#215;165</span><br/>
        
    </p>
    <p>
        question asked: <strong title="July 10, 2013, 8:01 a.m.">10 Jul '13, 08:01</strong>
    </p>
    <p> 
     	question was seen: <strong>17,658 times</strong>
    </p>
    <p> 
        last updated: <strong title="Oct. 22, 2015, 3:27 p.m.">22 Oct '15, 15:27</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/28145/cant-decrypt-ssl-in-capture-from-windump">Can&#39;t decrypt ssl in capture from windump</a>
        </p>
        
        <p>
            <a href="/questions/36524/unable-to-decrypt-ssl-traffic-in-wireshark">unable to decrypt ssl traffic in wireshark</a>
        </p>
        
        <p>
            <a href="/questions/54975/issues-decrypting-ssl-traffic">issues decrypting SSL Traffic</a>
        </p>
        
        <p>
            <a href="/questions/6426/ssl-decryption-problems">SSL Decryption Problems</a>
        </p>
        
        <p>
            <a href="/questions/8373/dtls-decryption-not-working-on-wireshark-165-even-for-sample-capture">DTLS decryption not working on Wireshark 1.6.5, even for sample capture</a>
        </p>
        
        <p>
            <a href="/questions/50305/how-does-wireshark-decrypt-ssltls-with-only-clientrandom">How does Wireshark decrypt SSL/TLS with only ClientRandom</a>
        </p>
        
        <p>
            <a href="/questions/28503/decrypt-ssl-using-wildcard-ip-address">Decrypt SSL using wildcard IP address</a>
        </p>
        
        <p>
            <a href="/questions/32292/ssltls-decrypt-doesnt-work-if-capture-started-mid-session">SSL/TLS decrypt doesn&#39;t work if capture started mid-session</a>
        </p>
        
        <p>
            <a href="/questions/50584/not-decrypting-all-http2-traffic-in-session">Not Decrypting all HTTP/2 traffic in session.</a>
        </p>
        
        <p>
            <a href="/questions/55099/tshark-decrypts-only-firsts-https-packets">Tshark decrypts only firsts https packets</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
