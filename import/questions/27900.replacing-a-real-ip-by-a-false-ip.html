<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>replacing a real IP by a false IP - Wireshark Q&amp;A</title>
        <meta name="description" content="Hello, Thank you all first for this good job. I wan to make Wireshark showing and saving a false IP address in a replacement in a real one. In some words, we assume that Wireshark is sniffing traffic between my PC (IP1) and a server (IP2). So is there a manner, in a low level file for example (winpc..." />
        <meta name="keywords" content="ip,replace,swap,change,address" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/27900/replacing-a-real-ip-by-a-false-ip" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/27900/replacing-a-real-ip-by-a-false-ip?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='5Cvg8U0hZuGq1ARSwQ20Few0NnCc5RMZ' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/27900/replacing-a-real-ip-by-a-false-ip">replacing a real IP by a false IP</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-27900-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/27900/up/" rel="nofollow"> </a>
<div id="post-27900-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-27900-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/27900/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/27900/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hello,</p>
<p>Thank you all first for this good job.</p>
<p>I wan to make Wireshark showing and saving a false IP address in a replacement in a real one.
In some words, we assume that Wireshark is sniffing traffic between my PC (IP1) and a server (IP2).</p>
<p>So is there a manner, in a low level file for example  (winpcap? because I'm on Windows bad thinks...) where we can add some thing like this:</p>
<ul>
<li>
<p>capture source IP, let it = to <em>SourceIP</em></p>
</li>
<li>
<p>capture dest IP, let it = to <em>DestIP</em></p>
</li>
<li>
<p>Let <em>RealIP</em>=192.168.0.10</p>
</li>
<li>
<p>Let <em>FalseIP</em>=192.168.10.10</p>
</li>
<li>
<p>If (<em>SourceIP</em>=<em>RealIP</em>) than let <em>SourceIP</em>=<em>FalseIP</em></p>
</li>
<li>
<p>If (<em>destIP</em>=<em>RealIP</em>) than let <em>SourceIP</em>=<em>FalseIP</em></p>
</li>
</ul>
<p>By this way, all the IP shown on the GUI interfaces, all the stored files, and all the filters, will work on the new IP (the <em>FalseIP</em>) each time the <em>RealIP</em> is detected.</p>
<p>The problem is to know where to make this changes.</p>
<p>If some one can help me by sending me the file to change (or the files to change) it will be very hopeful and helpful.</p>
<p>Good Christmas to every body.</p>
<p>Thank you.</p>
<p>Mustapha.</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/ip/" class="post-tag tag-link-ip"
                                        title="see questions tagged 'ip'" rel="tag">ip</a>
                                
                                    <a href="/tags/replace/" class="post-tag tag-link-replace"
                                        title="see questions tagged 'replace'" rel="tag">replace</a>
                                
                                    <a href="/tags/swap/" class="post-tag tag-link-swap"
                                        title="see questions tagged 'swap'" rel="tag">swap</a>
                                
                                    <a href="/tags/change/" class="post-tag tag-link-change"
                                        title="see questions tagged 'change'" rel="tag">change</a>
                                
                                    <a href="/tags/address/" class="post-tag tag-link-address"
                                        title="see questions tagged 'address'" rel="tag">address</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>07 Dec '13, 16:01</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/88db27df52a7ef76bffb1d43184dfc78?s=32&amp;d=identicon&amp;r=g" alt="Mustapha's gravatar image" />
    <p><a href="/users/6255/mustapha">Mustapha</a><br/>
    <span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">&#9679;</span><span class="badgecount">4</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Mustapha has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/27900/">
                edited
                <strong>08 Dec '13, 05:08</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" alt="grahamb's gravatar image" />
            <p><a href="/users/1225/grahamb">grahamb ♦</a><br/>
            <span class="score" title="19834 reputation points"><span class="">19.8k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">&#9679;</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">&#9679;</span><span class="badgecount">206</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-27900">
    
        <a name="28148"></a>
        <div class="comment" id="comment-28148">
            <div id="post-28148-score" class="comment-score"></div>
            <div class="comment-text"><p>Hello Jasper and Kurt,</p>

<p>I'm very happy to know that some one had already meet this need. I saw Jasper's presentation (SHARKFEST ‘11 | Stanford University | June 13–16, 201) and he said exactly what I'm looking for:</p>

<p>--------------Start of page 6-----------------</p>

<p>• On-the-fly anonymization</p>

<p>– Anonymize tracefiles while they‘re captured</p>

<p>– Modification is done between capturing the 
packets and writing them to disk</p>

<p>• Challenges</p>

<p>– Anonymization process must be fast enough to 
avoid drops</p>

<p>– Original data can‘t be examined as it is never 
written to disk </p>

<p>----------------End of page 6---------------</p>

<p>But some issues still pending:</p>

<p>1- To use <strong>PktAnon</strong> piping, Wireshark should be run like this:</p>

<p>Wireshark -i eth0 -s 0 -w - | pktanon ./settings.xml       Right??</p>

<p>In this case, a false executable file (on windows) having the same icon as Wiershark, should run the command Wireshark -i eth0 -s 0 -w - | pktanon ./settings.xml.</p>

<p>The question her is: did all the Wireshark GUI features will respect the anonymity PktAnon on the fly? in real time?</p>

<p>2- make changes on <strong>dumpcap.c</strong> is may be the better solution if it concern all the features Wireshark GUI propose. But the question her to: where and how can I add the static mapping? For information her is the code line (approximately) to add:</p>

<pre><code>capture source IP, let it = to SourceIP
capture dest IP, let it = to DestIP
Let IPToHide=192.168.0.10
Let FalseIP=192.168.10.10
If (SourceIP=IPToHide) than let SourceIP=FalseIP
If (destIP=IPToHide) than let SourceIP=FalseIP
</code></pre>

<p>By this way, all the IP shown on the GUI interfaces, all the stored files on Hard Disc, and all the filters, will work on the new IP (the FalseIP) each time the IPToHide is detected.</p>

<p>Could some one post the <strong>dumpcap.c</strong> modified with the right code to do this static change?</p>

<p>Thank you in advance.</p>

<p>Regards</p>

<p>Mustapha</p></div>
            <div class="comment-info" id="comment-28148-info">
                
                
                
                

                

                <span class="comment-age">(16 Dec '13, 04:52)</span>
                <a class="comment-user userinfo" href="/users/6255/mustapha">Mustapha</a>
                
            </div>
        </div>
    
        <a name="28150"></a>
        <div class="comment" id="comment-28150">
            <div id="post-28150-score" class="comment-score"></div>
            <div class="comment-text"><p>I think, some body didn't understand yet my request. SO i did this picture and hope I will be more explicit and more clear :)</p>

<p>So her is the need:</p>

<p><img alt="alt text" src="https://osqa-ask.wireshark.org/upfiles/Presentation.jpg"></p></div>
            <div class="comment-info" id="comment-28150-info">
                
                
                
                

                

                <span class="comment-age">(16 Dec '13, 05:28)</span>
                <a class="comment-user userinfo" href="/users/6255/mustapha">Mustapha</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-27900" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-27900-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    4 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/27900/replacing-a-real-ip-by-a-false-ip?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/27900/replacing-a-real-ip-by-a-false-ip?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/27900/replacing-a-real-ip-by-a-false-ip?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/27900/replacing-a-real-ip-by-a-false-ip?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="27901"></a>
                    <div id="answer-container-27901" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-27901-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/27901/up/" rel="nofollow"> </a>
<div id="post-27901-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-27901-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/27901/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Sounds like you just need a tool to change IP addresses in a capture file. If so, please check tracewrangler, a tool of <a href="/users/145/jasper">@Jasper</a>.</p>
<blockquote>
<p><a href="http://www.tracewrangler.com">http://www.tracewrangler.com</a></p>
</blockquote>
<p>IP address changes can be done with an anonymization task (see the docs).</p>
<p>Regards<br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/27901/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>07 Dec '13, 16:58</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-27901">
    
        <a name="27905"></a>
        <div class="comment not_top_scorer" id="comment-27905">
            <div id="post-27905-score" class="comment-score"></div>
            <div class="comment-text"><p>Hello Kurt,</p>

<p>thank you for your quick and prompt reply.
It's not exactly  what I'm looking for. I knew such tool, like bittwist and bittwiste (<a href="http://bittwist.sourceforge.net/news.html)">http://bittwist.sourceforge.net/news.html)</a> Those tools can change sensitive informations in log files.</p>

<p>But what I'm looking for is to change the information on the fly: I mean, just after the capture, Wireshark change it before writing to HD or to show it on screen.
I think it could be possible by one of those solutions:</p>

<p>1- a modified source code of Wireshark (or modified part/file of it) I can compile to generate a new executable Wireshark I can install, urn, and never see to sensitive informations (neither on screen, nor in files) Change should be done on the fly in real time.</p>

<p>2- a patch I can apply to installed Wireshark to force it to change sensitive informations on the fly also (before showing live capture or writing it to HD)</p>

<p>Any idea? or ready patch or source code?</p>

<p>:)</p>

<p>Mustapha</p></div>
            <div class="comment-info" id="comment-27905-info">
                
                
                
                

                

                <span class="comment-age">(07 Dec '13, 18:18)</span>
                <a class="comment-user userinfo" href="/users/6255/mustapha">Mustapha</a>
                
            </div>
        </div>
    
        <a name="27909"></a>
        <div class="comment" id="comment-27909">
            <div id="post-27909-score" class="comment-score">1</div>
            <div class="comment-text"><p>What is the purpose of such a modification? If the static mapping between 'false' and real IP is known, everybody can reverse that information and get the real IP back!?! Sounds a bit like 'security by obscurity'... ;-)</p></div>
            <div class="comment-info" id="comment-27909-info">
                
                
                
                

                

                <span class="comment-age">(07 Dec '13, 23:33)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="27982"></a>
        <div class="comment not_top_scorer" id="comment-27982">
            <div id="post-27982-score" class="comment-score"></div>
            <div class="comment-text"><p>The final users of such modified or patched Wireshark should not know the static mapping.
The goal her is to let some body to " catch" traffic and give it to an engineer, without see reality of the network. Just the engineer is a ware of the mapping.
I hope that my explanation was clear. But don't hesitate to ask me more questions if it's not clear yet. 
Thank you.
Regards.</p></div>
            <div class="comment-info" id="comment-27982-info">
                
                
                
                

                

                <span class="comment-age">(10 Dec '13, 16:10)</span>
                <a class="comment-user userinfo" href="/users/6255/mustapha">Mustapha</a>
                
            </div>
        </div>
    
        <a name="27999"></a>
        <div class="comment" id="comment-27999">
            <div id="post-27999-score" class="comment-score">1</div>
            <div class="comment-text"><p>O.K. let me ask the other way round: What are you afraid of? That the 'sniffing user' sees the real IP addresses in the network he attaches a capture device? Well, if that is your concern, then you have a bigger problem than you might think ;-))</p>

<p>I think we need to know more about your 'workflow' regarding the capture and analysis phase and why you want to hide the IP addresses from the person that does the capturing part. Maybe someone can then suggest a solution that actually works :-)</p></div>
            <div class="comment-info" id="comment-27999-info">
                
                
                
                

                

                <span class="comment-age">(11 Dec '13, 05:43)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="28027"></a>
        <div class="comment not_top_scorer" id="comment-28027">
            <div id="post-28027-score" class="comment-score"></div>
            <div class="comment-text"><p>I think I already explain the context where this wil be used.
So the goal now is to find where in source code we must make required changes, or what is the patch to apply.
Any ideas?
Regards.</p></div>
            <div class="comment-info" id="comment-28027-info">
                
                
                
                

                

                <span class="comment-age">(11 Dec '13, 16:33)</span>
                <a class="comment-user userinfo" href="/users/6255/mustapha">Mustapha</a>
                
            </div>
        </div>
    
        <a name="28033"></a>
        <div class="comment" id="comment-28033">
            <div id="post-28033-score" class="comment-score">1</div>
            <div class="comment-text"><p>well.... </p>

<p>I think you don't understand what I'm trying to say. So, let me rephrase it.</p>

<p>You want to hide the real IP addresses from users who are allowed to capture network traffic, by using <strong><a href="http://en.wikipedia.org/wiki/Security_through_obscurity">Security through obscurity</a></strong> - in your case, by changing the IP addresses in the capture file to prevent those users to see the real ones.</p>

<p>That's not going to work very well, because you will only stop stupid users with that kind of tactics. Reasons are:</p>

<ul>
<li>If you have a static mapping between the IP addresses, this mapping will be in the code and thus also in the binary. Everybody (with a little bit intelligence and know-how) would be able to figure that out, if there is enough 'energy/interest' to do it.</li>
<li>Everybody would be able to download an <strong>unmodified</strong> version of Wireshark and use that instead of your IP mapping version. You can't stop users from doing that, as there is a portable version of Wireshark, that does not need to be installed.</li>
<li>Everybody would be able to boot the capture PC with a Linux CD and do the capturing there with either tcpdump or Wireshark.</li>
</ul>

<p>So, as you can see, it's utterly simple to undermine your IP hiding strategy. That's why I asked for the workflow and what you are really trying to do. Changing the Wireshark source code, to hide IP addresses from those who are allowed to take a network capture, simply does not make any sense, as it's too easy to undermine. </p>

<p>I can imagine a solution that might work. But then I need more information about your 'workflow' and your goals (why do you want to hide the IP addresses).</p></div>
            <div class="comment-info" id="comment-28033-info">
                
                
                
                

                

                <span class="comment-age">(11 Dec '13, 22:52)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="28092"></a>
        <div class="comment not_top_scorer" id="comment-28092">
            <div id="post-28092-score" class="comment-score"></div>
            <div class="comment-text"><p>No solution or idea?</p></div>
            <div class="comment-info" id="comment-28092-info">
                
                
                
                

                

                <span class="comment-age">(13 Dec '13, 16:11)</span>
                <a class="comment-user userinfo" href="/users/6255/mustapha">Mustapha</a>
                
            </div>
        </div>
    
        <a name="28094"></a>
        <div class="comment" id="comment-28094">
            <div id="post-28094-score" class="comment-score">1</div>
            <div class="comment-text"><p>I think Kurt made all the points I'd make on this one. The functionality that you are looking for doesn't exist right now, and while in concept I can see how it might exist I'm not sure where in the source you'd need to look at making modifications.</p>

<p>Rather than ask how to accomplish this though, can you confirm your reason for wanting this functionality? There might be a better solution for you. Wireshark's development efforts are usually (I hope) based on need, but I honestly don't understand how this kind of mechanism can give any value, other than the illusion of IP addressing confidentiality. Even if it existed I honestly don't think Wireshark should support it, if for no other reason than that it could give a false sense of security.</p></div>
            <div class="comment-info" id="comment-28094-info">
                
                
                
                

                

                <span class="comment-age">(13 Dec '13, 22:09)</span>
                <a class="comment-user userinfo" href="/users/4985/quadratic">Quadratic</a>
                
            </div>
        </div>
    
        <a name="28099"></a>
        <div class="comment not_top_scorer" id="comment-28099">
            <div id="post-28099-score" class="comment-score"></div>
            <div class="comment-text"><p>Concerning security, we all know that actually, we hide just keys, and show publicly used algorithm (RSA, AES, etc.) It means and proof the robustness of this kind of security.
But tell me why you will show the algorithm you are using if you can hide it too? You/we are free in private use to show or hide the name or kind of algorithm you are using.</p>

<p>So it's the same for the need of hide some IP address for the user supervising the computer doing the capture. FYI, the user can't install any think on this pc,  and doesn't have any privilege on it.
I still think that a simple code (like lines I described in my first post) added in the right file of wireshark code source will do this perfectly. I need just to know what is this file...</p>

<p>I agree with you that this static mapping (and why not dynamic??) Will not interest thousands of users. But it will be very helpful for those who one day will need it.</p>

<p>Thank you for your interest and hope you'll tell me which file should I modify.</p>

<p>Regards.</p></div>
            <div class="comment-info" id="comment-28099-info">
                
                
                
                

                

                <span class="comment-age">(13 Dec '13, 23:58)</span>
                <a class="comment-user userinfo" href="/users/6255/mustapha">Mustapha</a>
                
            </div>
        </div>
    
        <a name="28125"></a>
        <div class="comment" id="comment-28125">
            <div id="post-28125-score" class="comment-score">1</div>
            <div class="comment-text"><blockquote>
<p>hope you'll tell me which file should I modify.</p>
</blockquote>

<p><strong>dumpcap.c</strong></p>

<p>However, there is no protocol intelligence in dumpcap.c and therefore you'll have to write the code yourself to find and replace the IP addresses in the data stream. Maybe you can use the code of bittwiste and/or pktanon.</p>

<p>Anyway, I still believe this does not make sense at all, because your users will be able to undermine any change to dumpcap.</p>

<blockquote>
<p>FYI, the <strong>user can't install any think</strong> on this pc, and doesn't have any privilege on it. </p>
</blockquote>

<p>They don't need to <strong>install</strong> Wireshark at all. As I said, there is a portable version. Just unzip it to a temp directory and your done. How do you stop your users from doing that? How do you stop your users from booting the PC with a Linux CD or from a USB drive? You can't, and thus you changes to Wireshark/dumpcap sound like a waste of time for me  ;-)) </p>

<p>Anyway, it's your environment and if you believe that's a clever solution go ahead and change dumpcap.</p></div>
            <div class="comment-info" id="comment-28125-info">
                
                
                
                

                

                <span class="comment-age">(15 Dec '13, 11:07)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="28130"></a>
        <div class="comment not_top_scorer" id="comment-28130">
            <div id="post-28130-score" class="comment-score"></div>
            <div class="comment-text"><p>Tank you Kurt for your replay and idea.
The PC used for the capture has no USB Port (or can be deactivated from BIOS with secure password) SO the user CAN NOT install or UNISTALL or PLAY any other thinks than it should play/run.</p></div>
            <div class="comment-info" id="comment-28130-info">
                
                
                
                

                

                <span class="comment-age">(15 Dec '13, 13:01)</span>
                <a class="comment-user userinfo" href="/users/6255/mustapha">Mustapha</a>
                
            </div>
        </div>
    
        <a name="28154"></a>
        <div class="comment not_top_scorer" id="comment-28154">
            <div id="post-28154-score" class="comment-score">1</div>
            <div class="comment-text"><blockquote>
<p>I think, some body didn't understand yet my request. SO i did this picture and hope I will be more explicit and more clear :)</p>
</blockquote>

<p>well, I believe I understood your basic requirement, but I was not convinced (nor am I now), that changing the code of Wireshark will be a clever solution. Nevertheless, as I said: If you still want to do it, you'll have to change dumpcap.c. See my comment regarding this.</p>

<p>As I also said: I might have a better solution, but then I still need more information about your workflow. Maybe you don't understand what I mean by this, so let me ask a few simple questions</p>

<ul>
<li>Will the capture PC be used for regular traffic (according to your picture, I guess the answer is yes)?</li>
<li>Would it be an option to capture traffic off-box, meaning on a dedicated system that gets the traffic from a mirror/monitor port of the switch?</li>
<li>Why do you want to hide the real IP addresses from those people that are starting Wireshark? Wouldn't they know the real IP addresses anyway, or get them pretty easily (netstat -na)???</li>
<li>Do those people need GUI access to the capturing system, i.e. log in via RDP for other tasks, besides taking a capture file?</li>
</ul>

<p>Do you think you can answer these questions?</p></div>
            <div class="comment-info" id="comment-28154-info">
                
                
                
                

                

                <span class="comment-age">(16 Dec '13, 06:20)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="28164"></a>
        <div class="comment not_top_scorer" id="comment-28164">
            <div id="post-28164-score" class="comment-score"></div>
            <div class="comment-text"><p>Thank you Kurth, Yes I can answer.</p>

<p>"as I said: If you still want to do it, you'll have to change dumpcap.c. See my comment regarding this."</p>

<p>I noted it, But it's too hard for me to add this code in dumpcap.c. I'm no more strong in C/C++ developpement...</p>

<p>My reply to the questions is:</p>

<p>1- Yes, the computer will be used for regular trafic (HTTP only)</p>

<p>2- No, the user should see all details of what his PC is capturing. All details but not one IP (may be some IPs) in the network. I don't have any interest the user access any port mirror/monitor. So it's prohibited. And also, he must view the traffic on HIS pc in real time to check other thinks (other users, protocols, etc.)</p>

<p>3- All tools like netstat, ping, tracert, etc. are suppressed. Don't worry about this.</p>

<p>4- Yes they need GUI because it's easy for them.</p>

<p>I put the same question in Libpcap forum. May be by modifying this library it's more easiest?</p>

<p>Do you think you can post a new dumpcap.c modified? Is it too hard to make?</p>

<p>Regards.</p>

<p>Mustapha</p></div>
            <div class="comment-info" id="comment-28164-info">
                
                
                
                

                

                <span class="comment-age">(16 Dec '13, 09:13)</span>
                <a class="comment-user userinfo" href="/users/6255/mustapha">Mustapha</a>
                
            </div>
        </div>
    
        <a name="28173"></a>
        <div class="comment not_top_scorer" id="comment-28173">
            <div id="post-28173-score" class="comment-score">1</div>
            <div class="comment-text"><blockquote>
<p>I noted it, But it's too hard for me to add this code in dumpcap.c. I'm no more strong in C/C++ developpement...</p>
</blockquote>

<p>well.. but how are you going to implement the changes we are talking about for quite some time now !?!? You specifically asked for some information <strong>which code to change</strong> !?!</p>

<blockquote>
<p>All details but not one IP (may be some IPs) in the network. </p>
</blockquote>

<p>What kind of users are these? One-legged and one-eyed? They shall <strong>see the network traffic</strong>, but <strong>not</strong> the IP addresses? Sorry, I really don't get it and you're still not offering a plausible explanation.</p>

<blockquote>
<p>I put the same question in Libpcap forum. May be by modifying this library it's more easiest?</p>
</blockquote>

<p>erm... no, I don't think so...</p>

<blockquote>
<p>Do you think you can post a new dumpcap.c modified? Is it too hard to make?</p>
</blockquote>

<p>erm.... no. As I said: I'm not convinced that it is a good idea anyway. It's not too hard to do. It just takes time. But why invest time into something that does not make sense (for me, and some others here). I'm sorry, but I don't think I can help you with that. </p>

<p><strong>However</strong>, I will tell you my idea, to help to end a discussion, that leads to nowhere.</p>

<p>I would do it the following way, and yes I know it's <strong>not</strong> what you want (based on your answers to my question), but maybe you rethink your endeavor, after you've read my suggestion.</p>

<ul>
<li>Build a special purpose capturing PC based on Linux (or perhaps Windows if you Like that more)</li>
<li>let the switch mirror/monitor the traffic of your web server port (or whatever it might be)</li>
<li>Write a Web interface to access the system</li>
<li>restrict any other access to the system (ssh, telnet, RDP, console login, etc.)</li>
<li>Through the Web interfaces allow: start capture, stop capture, download capture. Nothing more!</li>
<li>Do the capturing with an unmodified version of tcpdump and/or dumpcap. </li>
<li>Save the capture file to disk</li>
<li>Anonymize the file with whatever tool is best for you (pktanon, bittwiste, etc.)</li>
<li>Don't use a static mapping! Instead, choose random values for every file and record the mapping into a database on the same system.</li>
<li>Download the modified capture file and provide it to whomever it may interest.</li>
<li>Allow access to the database with the random mapping to a group of advanced users, if they ever need to reverse the mapping, or give them direct access to the original (unmodified) files.</li>
</ul>

<p>That's what I meant by a <strong>workflow</strong>. Unfortunately you did not answer that question, although I asked several times. </p>

<p>As I said, that's (most certainly) not what you want to hear. But as you still did not give any reason (I understand) for your IP changing plans, that's the best I can offer to you. And, you don't have to change anything in Wireshark. However, you'll have to create the web interface with the functionality I described. Maybe that's easier for you, if you are a web designer or 'web programmer'. </p>

<p>Good luck.</p></div>
            <div class="comment-info" id="comment-28173-info">
                
                
                
                

                

                <span class="comment-age">(16 Dec '13, 11:19)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="28175"></a>
        <div class="comment not_top_scorer" id="comment-28175">
            <div id="post-28175-score" class="comment-score">1</div>
            <div class="comment-text"><p>BTW: If you think there is a <strong>strong need</strong> for that code change (and you already know hundreds of other people that need exactly the same feature), you are free to file an enhancement request at <a href="https://bugs.wireshark.org">https://bugs.wireshark.org</a> </p>

<p>If you're lucky, someone likes the idea as well, picks it up and implements the feature for you.</p></div>
            <div class="comment-info" id="comment-28175-info">
                
                
                
                

                

                <span class="comment-age">(16 Dec '13, 11:45)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="28179"></a>
        <div class="comment not_top_scorer" id="comment-28179">
            <div id="post-28179-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes, it's a strong need.
Tahnk you for the help and suggestions you proposed Kurt.</p>

<p>Regards.</p></div>
            <div class="comment-info" id="comment-28179-info">
                
                
                
                

                

                <span class="comment-age">(16 Dec '13, 12:23)</span>
                <a class="comment-user userinfo" href="/users/6255/mustapha">Mustapha</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-27901" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 16
        </span>
        <a href="#" class="show-all-comments-link">show 11 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-27901-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="28108"></a>
                    <div id="answer-container-28108" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-28108-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/28108/up/" rel="nofollow"> </a>
<div id="post-28108-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-28108-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/28108/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>You could take a look at <a href="http://www.tm.kit.edu/software/pktanon/download/index.html">pktanon</a>. It uses XML files to set the replacement directives, and it is possible to pipe captured traffic from tcpdump through pktanon to disk. I've tried that for my 2011 <a href="http://sharkfest.wireshark.org/sharkfest.11/presentations/A-11_Bongertz-Trace_File_Anonymization.pdf">Sharkfest talk</a>. One of the last slides shows an example of how to do this.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/28108/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>14 Dec '13, 11:21</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" alt="Jasper's gravatar image" />
    <p><a href="/users/145/jasper">Jasper ♦♦</a><br/>
    <span class="score" title="23806 reputation points"><span class="">23.8k</span></span><span title="5 badges"><span class="badge1">&#9679;</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">&#9679;</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">&#9679;</span><span class="badgecount">284</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Jasper has 263 accepted answers">18&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-28108">
    
        <a name="28117"></a>
        <div class="comment" id="comment-28117">
            <div id="post-28117-score" class="comment-score"></div>
            <div class="comment-text"><p>Thank you Jasper. I will see and test it tonight or tomorrow and be back to you.
Regards.
Mustapha.</p></div>
            <div class="comment-info" id="comment-28117-info">
                
                
                
                

                

                <span class="comment-age">(15 Dec '13, 04:53)</span>
                <a class="comment-user userinfo" href="/users/6255/mustapha">Mustapha</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-28108" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-28108-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="28146"></a>
                    <div id="answer-container-28146" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-28146-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/28146/up/" rel="nofollow"> </a>
<div id="post-28146-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-28146-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/28146/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <blockquote>
<p>Sounds like you just need a tool to
change IP addresses in a capture file.
If so, please check tracewrangler, a
tool of <a href="/users/145/jasper">@Jasper</a>.</p>
<pre><code><a href="http://www.tracewrangler.com">http://www.tracewrangler.com</a>
</code></pre>
<p>IP address changes can be done with an
anonymization task (see the docs).</p>
<p>Regards Kurt</p>
</blockquote>
<p>I agree with you kurt . To change your ip address, you need to contact your ISP . You can't replace your real ip to false ip without your ISP knowledge . After changing your ip address, use <a href="http://www.ip-details.com/">Ip-details.com</a>  to check whether it gets modified or not<br>
</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/28146/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>16 Dec '13, 04:26</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/aefeac3f0ca9b48f55fe362b062a70fe?s=32&amp;d=identicon&amp;r=g" alt="creamusers's gravatar image" />
    <p><a href="/users/6307/creamusers">creamusers</a><br/>
    <span class="score" title="16 reputation points">16</span><span title="1 badges"><span class="bronze">&#9679;</span><span class="badgecount">1</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="creamusers has no accepted answers">0&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-28146">
    
        <a name="28151"></a>
        <div class="comment" id="comment-28151">
            <div id="post-28151-score" class="comment-score"></div>
            <div class="comment-text"><p>The IP address will not be changed in reality (for exchange on the network) It should be altered just between the NIC and wireshark.
Please see the picture bellow.</p></div>
            <div class="comment-info" id="comment-28151-info">
                
                
                
                

                

                <span class="comment-age">(16 Dec '13, 05:31)</span>
                <a class="comment-user userinfo" href="/users/6255/mustapha">Mustapha</a>
                
            </div>
        </div>
    
        <a name="28170"></a>
        <div class="comment" id="comment-28170">
            <div id="post-28170-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>To change your ip address, you need to contact your ISP .</p>
</blockquote>

<p>erm... no! Did you read the question? The IP addresses are in the range of private use addresses. While those can also be provided by an ISP, the whole story is <strong>not</strong> about changing the IP address of the system, but to replace some addresses in a capture file!! I'm pretty sure, your ISP does not care about that at all ;-))</p>

<p>BTW: this answer should not have gotten an up vote, as it's completely off the problem.</p></div>
            <div class="comment-info" id="comment-28170-info">
                
                
                
                

                

                <span class="comment-age">(16 Dec '13, 10:54)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-28146" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-28146-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="28152"></a>
                    <div id="answer-container-28152" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-28152-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/28152/up/" rel="nofollow"> </a>
<div id="post-28152-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-28152-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/28152/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>"Could some one post the dumpcap.c modified with the right code to do this static change?"</p>
<p>Dumpcaps receives the entire packet from Libpcap and just adds pcap(ng) block headers and possibly trailers, it does not parse the packet data at all before writing it to file or a pipe to be read by wireshark or tshark, so you'd have to invent the code you want from scratch e.g read and modify the packet data before writing it out - the performance penalty is probabaly big and dumpcap is supposed to be slim as it runs with privileges. As pointed out to you, you should probably try other
security measures than trying to change IP addresses on the fly.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/28152/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>16 Dec '13, 06:03</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/2d3d425a7a829209431fb38d326b53af?s=32&amp;d=identicon&amp;r=g" alt="Anders's gravatar image" />
    <p><a href="/users/42/anders">Anders ♦</a><br/>
    <span class="score" title="4578 reputation points"><span class="">4.6k</span></span><span title="9 badges"><span class="silver">&#9679;</span><span class="badgecount">9</span></span><span title="52 badges"><span class="bronze">&#9679;</span><span class="badgecount">52</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Anders has 56 accepted answers">17&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-28152">
    
        <a name="28161"></a>
        <div class="comment not_top_scorer" id="comment-28161">
            <div id="post-28161-score" class="comment-score"></div>
            <div class="comment-text"><p>So, should I look around libpcap, to modify it to do this task?</p></div>
            <div class="comment-info" id="comment-28161-info">
                
                
                
                

                

                <span class="comment-age">(16 Dec '13, 07:45)</span>
                <a class="comment-user userinfo" href="/users/6255/mustapha">Mustapha</a>
                
            </div>
        </div>
    
        <a name="28162"></a>
        <div class="comment" id="comment-28162">
            <div id="post-28162-score" class="comment-score">1</div>
            <div class="comment-text"><p>Well I don't think you should do it! </p>

<p>But in dumpcap in the routine
capture_loop_write_packet_cb() you could parse the raw packet and try to find the IP addresses and change them, pd is the raw bytes of the packet. You probably have to check the link layer and "parse" up to the IP layer if it's an IP packet. Note that this will only chnage the addresses in the IP layer if the real addresses are mentioned in ICMP or SIP messages or something like that the'd still will not be obscured. (VRRP, OSPF....?)</p></div>
            <div class="comment-info" id="comment-28162-info">
                
                
                
                

                

                <span class="comment-age">(16 Dec '13, 08:06)</span>
                <a class="comment-user userinfo" href="/users/42/anders">Anders ♦</a>
                
            </div>
        </div>
    
        <a name="28165"></a>
        <div class="comment not_top_scorer" id="comment-28165">
            <div id="post-28165-score" class="comment-score"></div>
            <div class="comment-text"><p>Thank you Andres for your reply.</p>

<p>The "capture_loop_write_packet_cb()" appear 9 times in dumpcap.c. So I don't know how to proceed. I'm not a C programmer (no more...)</p>

<p>By the way, the checksums will not be corrects I suppose, no? so this will be my next task if we succeed this first step.</p>

<p>Could you please post a dumpcap.c modified ready to compilation?</p></div>
            <div class="comment-info" id="comment-28165-info">
                
                
                
                

                

                <span class="comment-age">(16 Dec '13, 09:28)</span>
                <a class="comment-user userinfo" href="/users/6255/mustapha">Mustapha</a>
                
            </div>
        </div>
    
        <a name="28189"></a>
        <div class="comment" id="comment-28189">
            <div id="post-28189-score" class="comment-score">1</div>
            <div class="comment-text"><p>"The "capture_loop_write_packet_cb()" appear 9 times in dumpcap.c. So I don't know how to proceed. I'm not a C programmer (no more...)"
Do the canges in that function, not where it's called.</p>

<p>"Could you please post a dumpcap.c modified ready to compilation"
No, as I don't agree with the idea and it's a bigger job than you might think, &gt;100 lines of code I'd imagine.</p></div>
            <div class="comment-info" id="comment-28189-info">
                
                
                
                

                

                <span class="comment-age">(16 Dec '13, 21:45)</span>
                <a class="comment-user userinfo" href="/users/42/anders">Anders ♦</a>
                
            </div>
        </div>
    
        <a name="28193"></a>
        <div class="comment not_top_scorer" id="comment-28193">
            <div id="post-28193-score" class="comment-score"></div>
            <div class="comment-text"><p>I still believe it could be done with less than 100 code lines.
We have just to find the right place in source code and the efficient code lines to add.
Any way, thank you evry body for this interesting exchange.</p>

<p>Regards.</p></div>
            <div class="comment-info" id="comment-28193-info">
                
                
                
                

                

                <span class="comment-age">(17 Dec '13, 00:23)</span>
                <a class="comment-user userinfo" href="/users/6255/mustapha">Mustapha</a>
                
            </div>
        </div>
    
        <a name="28194"></a>
        <div class="comment" id="comment-28194">
            <div id="post-28194-score" class="comment-score">1</div>
            <div class="comment-text"><p>Just for calibrating expectations: the code in TraceWrangler doing IP address replacements is, as a rough estimate, about 500-1500 lines of code, and that is not including the SQLite engine code to store replacements to keep the consistent. IP addresses can appear in so many places its crazy.</p></div>
            <div class="comment-info" id="comment-28194-info">
                
                
                
                

                

                <span class="comment-age">(17 Dec '13, 00:48)</span>
                <a class="comment-user userinfo" href="/users/145/jasper">Jasper ♦♦</a>
                
            </div>
        </div>
    
        <a name="28195"></a>
        <div class="comment" id="comment-28195">
            <div id="post-28195-score" class="comment-score">1</div>
            <div class="comment-text"><blockquote>
<p>I still believe it could be done with less than 100 code lines.</p>
</blockquote>

<p>You said you're not a C programmer and apparently you don't know Wireshark. So, <strong>how</strong> do you estimate the effort to be less than 100 lines???</p></div>
            <div class="comment-info" id="comment-28195-info">
                
                
                
                

                

                <span class="comment-age">(17 Dec '13, 00:58)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="28202"></a>
        <div class="comment not_top_scorer" id="comment-28202">
            <div id="post-28202-score" class="comment-score"></div>
            <div class="comment-text"><p>Because, in 1986, when I was in telecommunication engineering school, I played with programming.
Of course at this time hwas no C or C++, and Internet and RFCs were unknown. But I still remember that in 1986 too, I resolved the Hanoï tours problem in less than 10 code lines (with Basic programming language) in a moment where other students made it in hundreds...
Now I'm forced to take what you said in consideration as I have no more any idea...
But I repeat that I'm sure we can always find good idea to implement any think with less programming effort.</p></div>
            <div class="comment-info" id="comment-28202-info">
                
                
                
                

                

                <span class="comment-age">(17 Dec '13, 02:15)</span>
                <a class="comment-user userinfo" href="/users/6255/mustapha">Mustapha</a>
                
            </div>
        </div>
    
        <a name="28203"></a>
        <div class="comment" id="comment-28203">
            <div id="post-28203-score" class="comment-score">1</div>
            <div class="comment-text"><p>My 2p worth:</p>

<p><a href="/users/6255/mustapha"></a><a href="/users/6255/mustapha">@Mustapha</a>, I think that you have 3 options:</p>

<ol>
<li>Modify the code yourself to do exactly what you want.</li>
<li>Pay someone else to modify the code to do exactly what you want.</li>
<li>Add an enhancement request to the Wireshark Bugzilla and hope that someone else sees the utility in your proposal and implements the required changes in their own free time.</li>
</ol>

<p>Personally, I think that #3 is unlikely to lead to your required changes happening, so your best options are #1 or #2.</p></div>
            <div class="comment-info" id="comment-28203-info">
                
                
                
                

                

                <span class="comment-age">(17 Dec '13, 02:17)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="28204"></a>
        <div class="comment not_top_scorer" id="comment-28204">
            <div id="post-28204-score" class="comment-score">1</div>
            <div class="comment-text"><blockquote>
<p>I resolved the Hanoï tours problem in less than 10 code lines (with Basic programming language) </p>
</blockquote>

<p>Well, the towers of hanoi problem can be solved in ~ about 10 lines of code, but this problem is not the towers of hanoi, right?</p>

<p>I guess the best option would be: </p>

<ul>
<li><strong>you</strong> implement the feature, maybe in less then 100 lines (C is pretty easy to learn if you know Basic - there are lots of tutorials at Youtube) and then you <strong>submit</strong> the patch to the community, so everybody can benefit from that cool new feature. </li>
</ul>

<p>How does that sound? It sounds perfect to me.</p></div>
            <div class="comment-info" id="comment-28204-info">
                
                
                
                

                

                <span class="comment-age">(17 Dec '13, 02:35)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-28152" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 10
        </span>
        <a href="#" class="show-all-comments-link">show 5 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-28152-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/27900/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='5Cvg8U0hZuGq1ARSwQ20Few0NnCc5RMZ' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/27900/replacing-a-real-ip-by-a-false-ip?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/27900/replacing-a-real-ip-by-a-false-ip?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/ip/"
            class="tag-link-ip"
            title="see questions tagged'ip'using tags"
            rel="tag">ip</a> <span class="tag-number">&#215;178</span><br/>
        
        <a href="/tags/address/"
            class="tag-link-address"
            title="see questions tagged'address'using tags"
            rel="tag">address</a> <span class="tag-number">&#215;48</span><br/>
        
        <a href="/tags/change/"
            class="tag-link-change"
            title="see questions tagged'change'using tags"
            rel="tag">change</a> <span class="tag-number">&#215;5</span><br/>
        
        <a href="/tags/replace/"
            class="tag-link-replace"
            title="see questions tagged'replace'using tags"
            rel="tag">replace</a> <span class="tag-number">&#215;1</span><br/>
        
        <a href="/tags/swap/"
            class="tag-link-swap"
            title="see questions tagged'swap'using tags"
            rel="tag">swap</a> <span class="tag-number">&#215;1</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Dec. 7, 2013, 4:01 p.m.">07 Dec '13, 16:01</strong>
    </p>
    <p> 
     	question was seen: <strong>16,265 times</strong>
    </p>
    <p> 
        last updated: <strong title="Dec. 17, 2013, 2:35 a.m.">17 Dec '13, 02:35</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/31218/finding-an-rogue-ip-address">Finding an rogue IP address</a>
        </p>
        
        <p>
            <a href="/questions/37680/can-wireshark-automatically-resolve-the-ip-address-into-host-names">Can Wireshark automatically resolve the IP address into host names?</a>
        </p>
        
        <p>
            <a href="/questions/10355/why-do-my-captures-never-show-my-client-as-the-source-ip-address-only-responsedestination">Why do my captures NEVER show my client as the Source IP address?  (only response/destination)</a>
        </p>
        
        <p>
            <a href="/questions/24547/text2pcap-addmodify-ip-address-by-default-it-keeps-dummy-headerexisting-ip-address">text2Pcap :- add/modify ip address. by default it keeps dummy header/existing ip address.</a>
        </p>
        
        <p>
            <a href="/questions/58651/someone-found-my-public-ip-and-i-think-is-ddosing-me">Someone found my public IP, and I think is DDOSing me?</a>
        </p>
        
        <p>
            <a href="/questions/8051/verifying-ips">Verifying IP&#39;s</a>
        </p>
        
        <p>
            <a href="/questions/11984/find-an-ip-address">Find an IP address</a>
        </p>
        
        <p>
            <a href="/questions/39228/how-do-i-change-the-iep-address">How do I change the IEP address?</a>
        </p>
        
        <p>
            <a href="/questions/12921/how-to-get-source-ip-address">How to get source IP address?</a>
        </p>
        
        <p>
            <a href="/questions/17749/dec-to-ip-address">DEC to IP Address</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
