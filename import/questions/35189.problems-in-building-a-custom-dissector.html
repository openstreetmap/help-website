<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Problems in building a custom dissector - Wireshark Q&amp;A</title>
        <meta name="description" content="I have just built Wireshark, without modifying it, and now I&#39;m trying to add a custom dissector as a plugin (64bit with Windows 7). I have followed the instruction provided by README.plugins, but there are some steps that are not so clear to me, so I hope someone could help me here! Firstly I have c..." />
        <meta name="keywords" content="dissector,build,plugin" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/35189/problems-in-building-a-custom-dissector" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/35189/problems-in-building-a-custom-dissector?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='Ofl2CeVeQygHJkrezDPeQM3lj6DUIwm2' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/35189/problems-in-building-a-custom-dissector">Problems in building a custom dissector</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-35189-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/35189/up/" rel="nofollow"> </a>
<div id="post-35189-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-35189-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/35189/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/35189/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>I have just built Wireshark, without modifying it, and now I'm trying to add a custom dissector as a plugin (64bit with Windows 7).
I have followed the instruction provided by README.plugins, but there are some steps that are not so clear to me, so I hope someone could help me here!</p>
<p>Firstly I have created a folder for my files: plugins\MyProtocol (where MyProtocol is the short name of the protocol I'm trying to implement). I've added there all the files listed on README.plugins, by copying (and modifying, when needed) them from the Development\wireshark\plugins\gryphon but: </p>
<p><strong>Makefile.common</strong>= I should list here some files (e.g. the source file) in some variables, but in the copied makefile there isn't any of the variables described by README.plugins (e.g.DISSECTOR___SRC or DISSECTOR_SUPPORT_SRC). I post here the content of Makefile.common</p>
<p><code>  # Makefile.common for Gryphon plugin
 #     Contains the stuff from Makefile.am and Makefile.nmake that is
 #     a) common to both files and
 #     b) portable between both files
 ...
 # the name of the plugin
 PLUGIN_NAME = gryphon
 # Non-generated sources to be scanned for registration routines
 NONGENERATED_REGISTER_C_FILES = \
    packet-gryphon.c
 # Non-generated sources
 NONGENERATED_C_FILES = \
    $(NONGENERATED_REGISTER_C_FILES)
 # Headers.
CLEAN_HEADER_FILES = \
    packet-gryphon.h
HEADER_FILES = \
    $(CLEAN_HEADER_FILES)
include ../Makefile.common.inc
&lt;\code&gt;</code></p><code>
<p>Did I take the wrong file? If yes, what one should I have taken? If not, do I have to add these variables myself? Can you give me some sample code performing this task? I'm not able to write this kind of code...</p>
<p><strong>Compiling</strong>= once I have the plugins\MyProtocol folder ready, what do I have to do in order to compile my plugin as a dll? I can't find a real description on README.plugin: point 3 is just a description of the differences between custom and permanent addition; point 3.1 should explain my task, but apart from copying those Custom.*.example, and modifying the installer (which, for now, is not interesting to me), there is no explanation about the building itself. Do I have to use the same procedure to compile Wireshark? Or something different? Do I have to copy my MyProtocol folder to Development\wireshark\plugins, and recompile Wireshark? Maybe before doing that, I need to modify something in order to "tell" WS that I have added something; how can I achieve that?</p>
<p>Thanks in avance</p></code>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/dissector/" class="post-tag tag-link-dissector"
                                        title="see questions tagged 'dissector'" rel="tag">dissector</a>
                                
                                    <a href="/tags/build/" class="post-tag tag-link-build"
                                        title="see questions tagged 'build'" rel="tag">build</a>
                                
                                    <a href="/tags/plugin/" class="post-tag tag-link-plugin"
                                        title="see questions tagged 'plugin'" rel="tag">plugin</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>05 Aug '14, 02:40</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/e1fba327ed394306c1606291dedfd698?s=32&amp;d=identicon&amp;r=g" alt="francesco_bigotto's gravatar image" />
    <p><a href="/users/8114/francesco_bigotto">francesco_bi...</a><br/>
    <span class="score" title="21 reputation points">21</span><span title="4 badges"><span class="badge1">&#9679;</span><span class="badgecount">4</span></span><span title="5 badges"><span class="silver">&#9679;</span><span class="badgecount">5</span></span><span title="9 badges"><span class="bronze">&#9679;</span><span class="badgecount">9</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="francesco_bigotto has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-35189">
    
</div>
<div id="comment-tools-35189" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-35189-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/35189/problems-in-building-a-custom-dissector?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/35189/problems-in-building-a-custom-dissector?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/35189/problems-in-building-a-custom-dissector?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/35189/problems-in-building-a-custom-dissector?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="35194"></a>
                    <div id="answer-container-35194" class="answer accepted-answer">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-35194-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/35194/up/" rel="nofollow"> </a>
<div id="post-35194-score" class="post-score"
    title="current number of votes">
    3
</div>
<a id="post-35194-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/35194/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="francesco_bigotto has selected this answer as the correct answer"
        href="/accept_answer/35194/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>The instructions appear to be a little off-mark.  DISSECTOR_SRC is used in CMakeLists.txt for CMake builds and isn't used for nmake builds.</p>
<p>AFAICT you need to modify Makefile.common, changing "gryphon" to "MyProtocol", and also modify moduleinfo.h and moduleinfo.nmake with names and version numbers.</p>
<p>To build your plugin you have the two options shown in Sect 3.  A custom plugin, which is used if you aren't going to contribute your dissector back to the Wireshark community (why not?), requires you to copy <code>plugins\Custom.nmake.example</code> to <code>plugins\Custom.nmake</code> and modify to suit, i.e. replace "foo" with "MyProtocol", the other option, generally used when you do plan to contribute the dissector back to the community, requires changes to all the files listed.</p>
<p>Whichever method you use, just start the build again from the top-level source directory as you did for the plain vanilla build.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/35194/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>05 Aug '14, 03:11</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" alt="grahamb's gravatar image" />
    <p><a href="/users/1225/grahamb">grahamb ♦</a><br/>
    <span class="score" title="19834 reputation points"><span class="">19.8k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">&#9679;</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">&#9679;</span><span class="badgecount">206</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="grahamb has 274 accepted answers">22&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-35194">
    
        <a name="35201"></a>
        <div class="comment" id="comment-35201">
            <div id="post-35201-score" class="comment-score"></div>
            <div class="comment-text"><p>Since there were already a Custom.nmake.example file in ...\wireshark\plugins, I modified that file replacing all occurences of "foo".
Then I copied the folder "MyProtocol" to development\wireshark\plugins.
Finally I also modified Makefile.nmake, adding "MyProtocol" to the PLUGIN_LIST at the beginning.</p>

<p>When I tried to compile, after a while, this was the output:</p>

<p><code>Microsoft (R) Program Maintenance Utility Version 10.00.40219.01
Copyright (C) Microsoft Corporation.  All rights reserved.</code></p>

<p><code>
</code></p><p><code>NMAKE : fatal error U1073: don't know how to make 'packet-gryphon.obj'
Stop.
NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe"' : re
turn code '0x2'
Stop.
NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe"' : re
turn code '0x2'
Stop.
NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe"' : re
turn code '0x2'
Stop.</code></p><code>
<p>C:\Development\wireshark&gt;</p></code><p></p></div>
            <div class="comment-info" id="comment-35201-info">
                
                
                
                

                

                <span class="comment-age">(05 Aug '14, 03:55)</span>
                <a class="comment-user userinfo" href="/users/8114/francesco_bigotto">francesco_bi...</a>
                
            </div>
        </div>
    
        <a name="35203"></a>
        <div class="comment" id="comment-35203">
            <div id="post-35203-score" class="comment-score"></div>
            <div class="comment-text"><p>Nope, as per README.plugins and my answer above you MUST copy <code>Custom.nmake.example</code> to <code>Custom.nmake</code> and modify the copy.</p>

<p>If you have a <code>plugins\Custom.nmake</code>, then do NOT modify <code>plugin\Makefile.nmake</code>, that is for the alternative build procedure.</p></div>
            <div class="comment-info" id="comment-35203-info">
                
                
                
                

                

                <span class="comment-age">(05 Aug '14, 04:17)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="35206"></a>
        <div class="comment" id="comment-35206">
            <div id="post-35206-score" class="comment-score"></div>
            <div class="comment-text"><p>Wait, I'm a bit confused.</p>

<p>In C:\Developement\wireshark\plugins I have (apart from some folders containing data of other plugins, such as gryphon)Custom.m4.example, Custom.make.example, Custom.nmake.example, Makefile.am, Makefile.nmake and Makefile.common.inc. So I don't have a custom.nmake!</p>

<p>Now, what do you (and README.plugin) mean with "copy Custom.nmake.example to Custom.nmake"? Do I have to copy the fileCustom.nmake.example, paste it in the same folder(windows prompt me that that file already exists in that folder, so I should chose to keep al the 2 files), rename it (as Custom.nmake), then open the just-created Custom.nmake, and modify it replacing "foo" with "MyProtocol"? Am I right??</p>

<p>Don't the other 2 Custom.*.example need modifying?</p>

<p>Sorry for these stupid question!</p></div>
            <div class="comment-info" id="comment-35206-info">
                
                
                
                

                

                <span class="comment-age">(05 Aug '14, 05:14)</span>
                <a class="comment-user userinfo" href="/users/8114/francesco_bigotto">francesco_bi...</a>
                
            </div>
        </div>
    
        <a name="35207"></a>
        <div class="comment" id="comment-35207">
            <div id="post-35207-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes, as I've tried to explain twice previously.</p>

<p><code>Custom.*.example</code> are example files, you MUST copy the example to another file and remove the <code>.example</code> extension.  In your case, as you're building with nmake, at the cmd prompt:</p>

<p><code>
cd plugins
copy Custom.nmake.example Custom.nmake
</code></p>

<p>and modify the new file.  The build process is all setup to locate <code>Custom.nmake</code> and use it if it exists.</p>

<p>The other <code>Custom.*.example</code> files are for other build systems.</p></div>
            <div class="comment-info" id="comment-35207-info">
                
                
                
                

                

                <span class="comment-age">(05 Aug '14, 05:40)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="35209"></a>
        <div class="comment not_top_scorer" id="comment-35209">
            <div id="post-35209-score" class="comment-score"></div>
            <div class="comment-text"><p>ok sorry again!
BTW I have copied Custom.nmake.example to Custom.nmake, and modified it as suggested. Then I have just copied the "MyProtocol" folder (containing AUTHORS, ChangeLog, CMakeList.txt, COPYING, Makefile.am, Makefile.common, Makefile.nmake, moduleinfo.h, moduleinfo.nmake, plugin.rc.in, MyProtocol.c)to the plugins directory.</p>

<p>Unfortunately, the output of the build is pretty much the same as before:</p>

<p><code>Microsoft (R) Program Maintenance Utility Version 10.00.40219.01
Copyright (C) Microsoft Corporation.  All rights reserved.</code></p>

<p><code>
</code></p><p><code>NMAKE : fatal error U1073: don't know how to make 'packet-gryphon.obj'
Stop.
NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe"' : re
turn code '0x2'
Stop.
NMAKE : fatal error U1077: 'if' : return code '0x2'
Stop.
NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe"' : re
turn code '0x2'
Stop.
NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe"' : re
turn code '0x2'
Stop.</code></p><p></p></div>
            <div class="comment-info" id="comment-35209-info">
                
                
                
                

                

                <span class="comment-age">(05 Aug '14, 06:11)</span>
                <a class="comment-user userinfo" href="/users/8114/francesco_bigotto">francesco_bi...</a>
                
            </div>
        </div>
    
        <a name="35210"></a>
        <div class="comment not_top_scorer" id="comment-35210">
            <div id="post-35210-score" class="comment-score"></div>
            <div class="comment-text"><p>The first line of output indicates something in the makefiles is still expecting packet-gryphon.c.</p>

<p>You must have missed modifying something, probably in Makefile.common, i.e. changing <code>packet-gryphon.c</code> to <code>MyProtcol.c</code>.  Did you make the other required modifications I mentioned in my answer?</p></div>
            <div class="comment-info" id="comment-35210-info">
                
                
                
                

                

                <span class="comment-age">(05 Aug '14, 06:18)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="35211"></a>
        <div class="comment not_top_scorer" id="comment-35211">
            <div id="post-35211-score" class="comment-score"></div>
            <div class="comment-text"><p>Well, I hadn't modified Makefile.nmake, because in the README.plugins I read "No modifications are needed here", but there still was a gryphon.obj and things like that, so I tried to replace there too MyProtocol.</p>

<p>With the nmake -f Makefile.nmake distclean command I got this</p>

<p><code>Microsoft (R) Program Maintenance Utility Version 10.00.40219.01
Copyright (C) Microsoft Corporation.  All rights reserved.</code></p>

<p><code>
</code></p><pre><code><code>    cd MyProtocol
    "c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe" /                   -f Ma
</code></code></pre><code>
<p>kefile.nmake clean</p>
<p>Microsoft (R) Program Maintenance Utility Version 10.00.40219.01
Copyright (C) Microsoft Corporation.  All rights reserved.</p>
<pre><code>    rm -f packet-MyProtocol.obj MyProtocol.dll MyProtocol.exp MyProtocol.lib
    cd ..
    cd MyProtocol
    "c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe" /                   -f Ma
</code></pre>
<p>kefile.nmake distclean</p>
<p>Microsoft (R) Program Maintenance Utility Version 10.00.40219.01
Copyright (C) Microsoft Corporation.  All rights reserved.</p>
<p>NMAKE : fatal error U1073: don't know how to make 'distclean'
Stop.
NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe"' : re
turn code '0x2'
Stop.
NMAKE : fatal error U1077: 'if' : return code '0x2'
Stop.
NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe"' : re
turn code '0x2'
Stop.
NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe"' : re
turn code '0x2'
Stop.</p></code><p></p></div>
            <div class="comment-info" id="comment-35211-info">
                
                
                
                

                

                <span class="comment-age">(05 Aug '14, 06:42)</span>
                <a class="comment-user userinfo" href="/users/8114/francesco_bigotto">francesco_bi...</a>
                
            </div>
        </div>
    
        <a name="35212"></a>
        <div class="comment not_top_scorer" id="comment-35212">
            <div id="post-35212-score" class="comment-score"></div>
            <div class="comment-text"><p>while with nmake -f Makefile.nmake all</p>

<p><code>Microsoft (R) Windows (R) Resource Compiler Version 6.1.7600.16385
Copyright (C) Microsoft Corporation.  All rights reserved.</code></p>

<p><code>
</code></p><pre><code><code>    cl -WX /DWINPCAP_VERSION=4_1_3 /Zi /W3 /MD /O2 /DWIN32_LEAN_AND_MEAN /DMSC_VER_REQUIRED=1600  /D_CRT_S
</code></code></pre><code>
<p>ECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE -DPSAPI_VERSION=1 /MP /w34295  /I../.. /IC:\Development\wiresha
rk\Wireshark-win64-libs\gtk2\include\glib-2.0  /IC:\Development\wireshark\Wireshark-win64-libs\gtk2\lib\glib-2
.0\include  -DG_DISABLE_DEPRECATED  -DG_DISABLE_SINGLE_INCLUDES  /IC:\Development\wireshark\Wireshark-win64-li
bs\WPdpack\include -Fd.\ -c packet-wimaxmacphy.c plugin.c
Microsoft (R) C/C++ Optimizing Compiler Version 16.00.40219.01 for x64
Copyright (C) Microsoft Corporation.  All rights reserved.</p>
<p>packet-wimaxmacphy.c
plugin.c
        link -dll /out:wimaxmacphy.dll /NOLOGO /INCREMENTAL:no /DEBUG /MACHINE:x64 /DYNAMICBASE /FIXED:no
 packet-wimaxmacphy.obj      plugin.obj ....\epan\libwireshark.lib  C:\Development\wireshark\Wireshark-win64-
libs\gtk2\lib\glib-2.0.lib  C:\Development\wireshark\Wireshark-win64-libs\gtk2\lib\gmodule-2.0.lib  C:\Develop
ment\wireshark\Wireshark-win64-libs\gtk2\lib\gobject-2.0.lib wimaxmacphy.res
   Creating library wimaxmacphy.lib and object wimaxmacphy.exp
        cd ..
        if exist Custom.nmake "c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe" /
                 -f Custom.nmake</p>
<p>Microsoft (R) Program Maintenance Utility Version 10.00.40219.01
Copyright (C) Microsoft Corporation.  All rights reserved.</p>
<pre><code>    cd MyProtocol
    "c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe" /                   -f Ma
</code></pre>
<p>kefile.nmake</p>
<p>Microsoft (R) Program Maintenance Utility Version 10.00.40219.01
Copyright (C) Microsoft Corporation.  All rights reserved.</p>
<p>NMAKE : fatal error U1073: don't know how to make '..\plugin_api.obj'
Stop.
NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe"' : re
turn code '0x2'
Stop.
NMAKE : fatal error U1077: 'if' : return code '0x2'
Stop.
NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe"' : re
turn code '0x2'
Stop.
NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe"' : re
turn code '0x2'
Stop.</p></code><p></p></div>
            <div class="comment-info" id="comment-35212-info">
                
                
                
                

                

                <span class="comment-age">(05 Aug '14, 06:42)</span>
                <a class="comment-user userinfo" href="/users/8114/francesco_bigotto">francesco_bi...</a>
                
            </div>
        </div>
    
        <a name="35213"></a>
        <div class="comment not_top_scorer" id="comment-35213">
            <div id="post-35213-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
Well, I hadn't modified Makefile.nmake, because in the README.plugins I read "No modifications are needed here", but there still was a gryphon.obj and things like that, so I tried to replace there too MyProtocol.
</blockquote>

<p>Please read the documentation and answers carefully.  You should be modifying Makefile.common, not Makefile.nmake.  There is nothing about gryphon in Makefile.nmake (apart from a comment which you can modify if you wish), hence nothing to change.</p>

<p>To reiterate, the files to modify in your plugin directory are Makefile.common, moduleinfo.h and moduleinfo.nmake</p></div>
            <div class="comment-info" id="comment-35213-info">
                
                
                
                

                

                <span class="comment-age">(05 Aug '14, 06:54)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="35215"></a>
        <div class="comment not_top_scorer" id="comment-35215">
            <div id="post-35215-score" class="comment-score"></div>
            <div class="comment-text"><p>Clear, I probably had taken a wrong file, that's why I could see different things.
I checked all the files to modify, and I've done what was needed.
I got a very long list of Compiling error, that I will post in the next comment.
Are they related to the MyProtocol.c code or not? It seems there are errors in some library source, but they were directly downloaded from the internet...
Can you figure out what is going on?</p></div>
            <div class="comment-info" id="comment-35215-info">
                
                
                
                

                

                <span class="comment-age">(05 Aug '14, 07:19)</span>
                <a class="comment-user userinfo" href="/users/8114/francesco_bigotto">francesco_bi...</a>
                
            </div>
        </div>
    
        <a name="35216"></a>
        <div class="comment not_top_scorer" id="comment-35216">
            <div id="post-35216-score" class="comment-score"></div>
            <div class="comment-text"><p>Microsoft (R) Program Maintenance Utility Version 10.00.40219.01
Copyright (C) Microsoft Corporation.  All rights reserved.</p>

<pre><code>    cd MyProtocol
    "c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe" /                   -f Ma
</code></pre>

<p>kefile.nmake</p>

<p>Microsoft (R) Program Maintenance Utility Version 10.00.40219.01
Copyright (C) Microsoft Corporation.  All rights reserved.</p>

<p>Making plugin.c (using python)
Updating plugin.c
        sed -e s/@<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="ce9e829b89878091808f838b8e">[email&#160;protected]</a>/MyProtocol/  -e s/@<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3b69786476747f6e777e646d7e69687274757b">[email&#160;protected]</a>/0,0,2,0/  -e s/@<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="90c2d3cfc6d5c2c3d9dfded0">[email&#160;protected]</a>/1,99,0,0/  -e s
/@<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="feb3b1baabb2bba1a8bbacadb7b1b0be">[email&#160;protected]</a>/0.0.2.0/  -e s/@<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="aefeefede5efe9ebee">[email&#160;protected]</a>/MyProtocol/  -e s/@<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="6e382b3c3d2721202e">[email&#160;protected]</a>/1.99.0-FBG/  -e s/@<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="eea3bdb8adb1b8afbca7afa0baae">[email&#160;protected]</a>/MSVC2010
EE/  &lt; plugin.rc.in &gt; MyProtocol.rc
        rc  /r MyProtocol.rc
Microsoft (R) Windows (R) Resource Compiler Version 6.1.7600.16385
Copyright (C) Microsoft Corporation.  All rights reserved.</p>

<pre><code>    cl -WX /DWINPCAP_VERSION=4_1_3 /Zi /W3 /MD /O2 /DWIN32_LEAN_AND_MEAN /DMSC_VER_REQUIRED=1600  /D_CRT_S
</code></pre>

<p>ECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE -DPSAPI_VERSION=1 /MP /w34295  /I../.. /IC:\Development\wiresha
rk\Wireshark-win64-libs\gtk2\include\glib-2.0  /IC:\Development\wireshark\Wireshark-win64-libs\gtk2\lib\glib-2
.0\include  -DG_DISABLE_DEPRECATED  -DG_DISABLE_SINGLE_INCLUDES  /IC:\Development\wireshark\Wireshark-win64-li
bs\WPdpack\include -Fd.\ -c packet-MyProtocol.c plugin.c
Microsoft (R) C/C++ Optimizing Compiler Version 16.00.40219.01 for x64
Copyright (C) Microsoft Corporation.  All rights reserved.</p>

<p>packet-MyProtocol.c
plugin.c
c:\development\wireshark\epan\proto.h(113) : error C2054: expected '(' to follow 'WS_MSVC_NORETURN'
c:\development\wireshark\epan\proto.h(113) : error C2085: 'proto_report_dissector_bug' : not in formal paramet
er list
c:\development\wireshark\epan\proto.h(434) : error C2057: expected constant expression
c:\development\wireshark\epan\proto.h(435) : error C2057: expected constant expression
c:\development\wireshark\epan\proto.h(436) : error C2057: expected constant expression
c:\development\wireshark\epan\proto.h(437) : error C2057: expected constant expression
c:\development\wireshark\epan\proto.h(438) : error C2057: expected constant expression
c:\development\wireshark\epan\proto.h(439) : error C2057: expected constant expression</p></div>
            <div class="comment-info" id="comment-35216-info">
                
                
                
                

                

                <span class="comment-age">(05 Aug '14, 07:20)</span>
                <a class="comment-user userinfo" href="/users/8114/francesco_bigotto">francesco_bi...</a>
                
            </div>
        </div>
    
        <a name="35217"></a>
        <div class="comment not_top_scorer" id="comment-35217">
            <div id="post-35217-score" class="comment-score"></div>
            <div class="comment-text"><p>c:\development\wireshark\epan\proto.h(440) : error C2057: expected constant expression
c:\development\wireshark\epan\proto.h(446) : error C2057: expected constant expression
c:\development\wireshark\epan\proto.h(446) : error C2085: 'field_display_e' : not in formal parameter list
c:\development\wireshark\epan\proto.h(464) : error C2085: 'hf_ref_type' : not in formal parameter list
c:\development\wireshark\epan\proto.h(467) : error C2085: 'header_field_info' : not in formal parameter list
c:\development\wireshark\epan\proto.h(486) : error C2061: syntax error : identifier 'hf_ref_type'
c:\development\wireshark\epan\proto.h(488) : error C2143: syntax error : missing '{' before '<em>'
c:\development\wireshark\epan\proto.h(489) : error C2059: syntax error : '}'
c:\development\wireshark\epan\proto.h(508) : error C2061: syntax error : identifier 'header_field_info'
c:\development\wireshark\epan\proto.h(509) : error C2059: syntax error : '}'
c:\development\wireshark\epan\proto.h(522) : error C2016: C requires that a struct or union has at least one m
ember
c:\development\wireshark\epan\proto.h(522) : error C2061: syntax error : identifier 'header_field_info'
c:\development\wireshark\epan\proto.h(532) : error C2059: syntax error : '}'
c:\development\wireshark\epan\proto.h(610) : error C2061: syntax error : identifier 'field_info'
c:\development\wireshark\epan\proto.h(612) : error C2059: syntax error : '}'
c:\development\wireshark\epan\proto.h(615) : error C2061: syntax error : identifier 'proto_tree'
c:\development\wireshark\epan\proto.h(615) : error C2059: syntax error : ';'
c:\development\wireshark\epan\proto.h(617) : error C2061: syntax error : identifier 'proto_item'
c:\development\wireshark\epan\proto.h(617) : error C2059: syntax error : ';'
c:\development\wireshark\epan\proto.h(706) : error C2143: syntax error : missing ')' before '</em>'
c:\development\wireshark\epan\proto.h(706) : error C2143: syntax error : missing '{' before '<em>'
c:\development\wireshark\epan\proto.h(706) : error C2059: syntax error : ','
c:\development\wireshark\epan\proto.h(706) : error C2059: syntax error : ')'
c:\development\wireshark\epan\proto.h(707) : error C2143: syntax error : missing ')' before '</em>'
c:\development\wireshark\epan\proto.h(707) : error C2143: syntax error : missing '{' before '*'
c:\development\wireshark\epan\proto.h(707) : error C2059: syntax error : ','
c:\development\wireshark\epan\proto.h(707) : error C2059: syntax error : ')'</p></div>
            <div class="comment-info" id="comment-35217-info">
                
                
                
                

                

                <span class="comment-age">(05 Aug '14, 07:20)</span>
                <a class="comment-user userinfo" href="/users/8114/francesco_bigotto">francesco_bi...</a>
                
            </div>
        </div>
    
        <a name="35218"></a>
        <div class="comment not_top_scorer" id="comment-35218">
            <div id="post-35218-score" class="comment-score"></div>
            <div class="comment-text"><p>I can't post any more code because it's considered spam, btw there are lots of other errors similar to these</p></div>
            <div class="comment-info" id="comment-35218-info">
                
                
                
                

                

                <span class="comment-age">(05 Aug '14, 07:22)</span>
                <a class="comment-user userinfo" href="/users/8114/francesco_bigotto">francesco_bi...</a>
                
            </div>
        </div>
    
        <a name="35219"></a>
        <div class="comment not_top_scorer" id="comment-35219">
            <div id="post-35219-score" class="comment-score"></div>
            <div class="comment-text"><p>I suspect this is caused by your dissectors code.  The errors are indicating the compiler has a problem with epan\proto.h, which, unless you have modified it will be perfectly OK and is used all over the place, so I think it more likely that your dissector isn't including the correct preamble.  Can you show the start of the includes in your dissector, it should have <code>#include "config.h"</code> as the first include.</p></div>
            <div class="comment-info" id="comment-35219-info">
                
                
                
                

                

                <span class="comment-age">(05 Aug '14, 07:43)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="35250"></a>
        <div class="comment not_top_scorer" id="comment-35250">
            <div id="post-35250-score" class="comment-score"></div>
            <div class="comment-text"><p>Here's the code. There is a conditional include for config.h</p>

<p><code>
 # ifdef HAVE_CONFIG_H
 # include "config.h"
 # endif</code></p>

<p><code>
</code></p><p><code># include &lt;stdio.h&gt;
 #include &lt;glib.h&gt;
 #include &lt;epan packet.h=""&gt;</code></p><code>
<p>#include &lt;string.h&gt;</p>
</code><p><code>#define PROTO_TAG_MYPROTOCOL "MyProtocol"
</code></p><p></p></div>
            <div class="comment-info" id="comment-35250-info">
                
                
                
                

                

                <span class="comment-age">(06 Aug '14, 01:31)</span>
                <a class="comment-user userinfo" href="/users/8114/francesco_bigotto">francesco_bi...</a>
                
            </div>
        </div>
    
        <a name="35256"></a>
        <div class="comment not_top_scorer" id="comment-35256">
            <div id="post-35256-score" class="comment-score"></div>
            <div class="comment-text"><p>Remove the conditional around the include of config.h.</p>

<p>I presume that the odd code for the epan/packet.h include is caused by the sites markup. Edit, yes it is.</p></div>
            <div class="comment-info" id="comment-35256-info">
                
                
                
                

                

                <span class="comment-age">(06 Aug '14, 02:41)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="35258"></a>
        <div class="comment not_top_scorer" id="comment-35258">
            <div id="post-35258-score" class="comment-score"></div>
            <div class="comment-text"><p>Condition removed. Now I have the following problem. It seems that some declaration is missing, but I don't know which one.</p>

<p><code>
packet-MyProtocol.c
plugin.c
packet-MyProtocol.c(376) : error C2220: warning treated as error - no 'object' file generated
packet-MyProtocol.c(376) : warning C4013: 'dissector_add' undefined; assuming extern returning int
packet-MyProtocol.c(501) : warning C4013: 'check_col' undefined; assuming extern returning int
packet-MyProtocol.c(561) : warning C4013: 'tvb_bytes_to_str_punct' undefined; assuming extern returning int
NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\cl.EXE"' : retur
n code '0x2'
Stop.
NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe"' : re
turn code '0x2'
Stop.
NMAKE : fatal error U1077: 'if' : return code '0x2'
Stop.
NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe"' : re
turn code '0x2'
Stop.
NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe"' : re
turn code '0x2'
Stop.</code></p></div>
            <div class="comment-info" id="comment-35258-info">
                
                
                
                

                

                <span class="comment-age">(06 Aug '14, 02:54)</span>
                <a class="comment-user userinfo" href="/users/8114/francesco_bigotto">francesco_bi...</a>
                
            </div>
        </div>
    
        <a name="35259"></a>
        <div class="comment not_top_scorer" id="comment-35259">
            <div id="post-35259-score" class="comment-score"></div>
            <div class="comment-text"><p>Is the dissector source originally from an older version of Wireshark?</p>

<p>If so, the Wireshark API has changed a bit and the dissector will have to be fixed up.  You might look at the Gryphon plugin dissector source as a reference, e.g. <code>dissector_add</code> is now <code>dissector_add_xxx</code>, as declared in epan\packet.h.</p>

<p>There was another set of questions recently where another user was trying to bring an old plugin up to date, hopefully search will find it (some time in early June 2014).</p></div>
            <div class="comment-info" id="comment-35259-info">
                
                
                
                

                

                <span class="comment-age">(06 Aug '14, 03:07)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="35260"></a>
        <div class="comment not_top_scorer" id="comment-35260">
            <div id="post-35260-score" class="comment-score"></div>
            <div class="comment-text"><p>It might be! To be honest I didn't write this code myself, it was given to me in order to build it, so I just assumed it was OK...
However thanks a lot, I will read those documents and if I have still questions, I'll ask you again</p></div>
            <div class="comment-info" id="comment-35260-info">
                
                
                
                

                

                <span class="comment-age">(06 Aug '14, 03:11)</span>
                <a class="comment-user userinfo" href="/users/8114/francesco_bigotto">francesco_bi...</a>
                
            </div>
        </div>
    
        <a name="35285"></a>
        <div class="comment not_top_scorer" id="comment-35285">
            <div id="post-35285-score" class="comment-score"></div>
            <div class="comment-text"><p>I'm working on the code, and I have a short question: is it normal that plugins dissector aren't shown in Edit-&gt;Preferences-&gt;Protocols, but just in Help-&gt;About Wireshark-&gt;Plugins?</p></div>
            <div class="comment-info" id="comment-35285-info">
                
                
                
                

                

                <span class="comment-age">(07 Aug '14, 01:32)</span>
                <a class="comment-user userinfo" href="/users/8114/francesco_bigotto">francesco_bi...</a>
                
            </div>
        </div>
    
        <a name="35286"></a>
        <div class="comment not_top_scorer" id="comment-35286">
            <div id="post-35286-score" class="comment-score"></div>
            <div class="comment-text"><p>A protocol will only show up in Edit | Preferences | Protocols if it has preference settings.</p></div>
            <div class="comment-info" id="comment-35286-info">
                
                
                
                

                

                <span class="comment-age">(07 Aug '14, 02:07)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="35295"></a>
        <div class="comment not_top_scorer" id="comment-35295">
            <div id="post-35295-score" class="comment-score"></div>
            <div class="comment-text"><p>And is it possible to implement 2 dissector as Plugins at the same time? Because I tried to put another dissector (MyProtocol2) in the Plugins directory, but I didn't know what to do with the Custom.nmake file. I tried to copy it again, with another name, but it didn't work, then I leave just one, with all occurences of MyProtocol1 modified to MyProtocol2, but at the end of the building I only had MyProtocol1 and not MyProtocol2.</p></div>
            <div class="comment-info" id="comment-35295-info">
                
                
                
                

                

                <span class="comment-age">(07 Aug '14, 05:22)</span>
                <a class="comment-user userinfo" href="/users/8114/francesco_bigotto">francesco_bi...</a>
                
            </div>
        </div>
    
        <a name="35296"></a>
        <div class="comment" id="comment-35296">
            <div id="post-35296-score" class="comment-score">1</div>
            <div class="comment-text"><p>You can only have a single Custom.nmake. so if you have two plugins to build you need to add the second one as an additional target in Custom.nmake, add replicate the entries in all the other targets, adjusting for the second plugin.</p></div>
            <div class="comment-info" id="comment-35296-info">
                
                
                
                

                

                <span class="comment-age">(07 Aug '14, 05:33)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-35194" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 23
        </span>
        <a href="#" class="show-all-comments-link">show 18 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-35194-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/35189/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='Ofl2CeVeQygHJkrezDPeQM3lj6DUIwm2' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/35189/problems-in-building-a-custom-dissector?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/35189/problems-in-building-a-custom-dissector?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/dissector/"
            class="tag-link-dissector"
            title="see questions tagged'dissector'using tags"
            rel="tag">dissector</a> <span class="tag-number">&#215;637</span><br/>
        
        <a href="/tags/plugin/"
            class="tag-link-plugin"
            title="see questions tagged'plugin'using tags"
            rel="tag">plugin</a> <span class="tag-number">&#215;173</span><br/>
        
        <a href="/tags/build/"
            class="tag-link-build"
            title="see questions tagged'build'using tags"
            rel="tag">build</a> <span class="tag-number">&#215;110</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Aug. 5, 2014, 2:40 a.m.">05 Aug '14, 02:40</strong>
    </p>
    <p> 
     	question was seen: <strong>3,793 times</strong>
    </p>
    <p> 
        last updated: <strong title="Aug. 7, 2014, 5:33 a.m.">07 Aug '14, 05:33</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/34966/migration-of-a-plugin-dissector-to-64-bit">Migration of a plugin dissector to 64-bit</a>
        </p>
        
        <p>
            <a href="/questions/37648/link-dissector-plugin-to-shared-library">Link dissector plugin to shared library.</a>
        </p>
        
        <p>
            <a href="/questions/59828/build-with-dissector-plugin-fails-in-windows">build with dissector plugin fails in Windows</a>
        </p>
        
        <p>
            <a href="/questions/28843/wireshark-build-fails-when-trying-to-compile-plugin">Wireshark build fails when trying to compile plugin</a>
        </p>
        
        <p>
            <a href="/questions/7386/how-to-compile-dissector-to-dll-or-shared-library">How to compile dissector to DLL or shared library?</a>
        </p>
        
        <p>
            <a href="/questions/24176/g_close-not-being-recognized-as-available-function-in-plugin-dissector">g_close not being recognized as available function in plugin dissector</a>
        </p>
        
        <p>
            <a href="/questions/27091/c-dissector-plugin">C# Dissector Plugin</a>
        </p>
        
        <p>
            <a href="/questions/28038/how-to-create-a-protofield-sub-array-in-lua">How to create a Protofield sub array in Lua</a>
        </p>
        
        <p>
            <a href="/questions/42379/data-parameter-and-private_data">Data Parameter and Private_Data</a>
        </p>
        
        <p>
            <a href="/questions/46137/structure-for-dissector-plugin">Structure for dissector plugin</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
