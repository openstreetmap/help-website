<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Capture or Filter only sent (TX) traffic - Wireshark Q&amp;A</title>
        <meta name="description" content="Is it possible to use capture filters to capture only traffic sent from a device running Wireshark and ignore any packets received? Also when viewing a capture file from another device - it is possible to use display filters for the same purpose?" />
        <meta name="keywords" content="traffic,tx,filters" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/18300/capture-or-filter-only-sent-tx-traffic" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/18300/capture-or-filter-only-sent-tx-traffic?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='gCvIfSv8Bw2N6zMBND5kkh3KKFx1kByD' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/18300/capture-or-filter-only-sent-tx-traffic">Capture or Filter only sent (TX) traffic</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-18300-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/18300/up/" rel="nofollow"> </a>
<div id="post-18300-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-18300-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/18300/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/18300/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Is it possible to use capture filters to capture only traffic sent from a device running Wireshark and ignore any packets received?</p>
<p>Also when viewing a capture file from another device - it is possible to use display filters for the same purpose?</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/traffic/" class="post-tag tag-link-traffic"
                                        title="see questions tagged 'traffic'" rel="tag">traffic</a>
                                
                                    <a href="/tags/tx/" class="post-tag tag-link-tx"
                                        title="see questions tagged 'tx'" rel="tag">tx</a>
                                
                                    <a href="/tags/filters/" class="post-tag tag-link-filters"
                                        title="see questions tagged 'filters'" rel="tag">filters</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>04 Feb '13, 18:55</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/a469905bad08fb7ba61689029318d6ee?s=32&amp;d=identicon&amp;r=g" alt="rocket72's gravatar image" />
    <p><a href="/users/4334/rocket72">rocket72</a><br/>
    <span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">&#9679;</span><span class="badgecount">2</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="rocket72 has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-18300">
    
</div>
<div id="comment-tools-18300" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-18300-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/18300/capture-or-filter-only-sent-tx-traffic?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/18300/capture-or-filter-only-sent-tx-traffic?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/18300/capture-or-filter-only-sent-tx-traffic?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/18300/capture-or-filter-only-sent-tx-traffic?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="18302"></a>
                    <div id="answer-container-18302" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-18302-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/18302/up/" rel="nofollow"> </a>
<div id="post-18302-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-18302-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/18302/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p><em>Is it possible to use capture filters to capture only traffic sent from a device running Wireshark and ignore any packets received?</em></p>
<p>Yes, this is possible.  Assuming the host running Wireshark has an IP address of 192.168.1.1, an appropriate capture filter to use to capture only outbound traffic from that host would be: "<code>src host 192.168.1.1</code>".  Refer to the <a href="http://www.manpagez.com/man/7/pcap-filter/">pcap-filter man page</a> for more information on capture filters.</p>
<p><em>Also when viewing a capture file from another device - it is possible to use display filters for the same purpose?</em></p>
<p>Yes, this is also possible.  After loading a capture file, if you want to filter that capture file to only display packets sent from a particular host (again, I'll assume the host of interest is 192.168.1.1), then an appropriate Wireshark display filter would be: "<code>ip.src == 192.168.1.1</code>".  Refer to the <a href="http://wiki.wireshark.org/DisplayFilters">Wireshark display filter wiki page</a> and the various links on that page for more information.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/18302/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>04 Feb '13, 19:47</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/55158e2322c4e365a5e0a4a0ac3fbcef?s=32&amp;d=identicon&amp;r=g" alt="cmaynard's gravatar image" />
    <p><a href="/users/402/cmaynard">cmaynard ♦♦</a><br/>
    <span class="score" title="9361 reputation points"><span class="">9.4k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="38 badges"><span class="silver">&#9679;</span><span class="badgecount">38</span></span><span title="142 badges"><span class="bronze">&#9679;</span><span class="badgecount">142</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="cmaynard has 108 accepted answers">20&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-18302">
    
        <a name="18303"></a>
        <div class="comment" id="comment-18303">
            <div id="post-18303-score" class="comment-score"></div>
            <div class="comment-text"><p>I am trying to troubleshoot an issue with possible suspect ARP's where a device may be spoofing MAC addresses, for this I am not able to filter based on IP or even MAC as I cant be sure which MAC the device may be using - if I can filter based on only sent traffic then I can be sure all packets I see are generated by the device in question, otherwise in the case of ARP packets I can not know if they are generated by this device or another device on the network.</p>

<p>Is there any known way to do this?</p></div>
            <div class="comment-info" id="comment-18303-info">
                
                
                
                

                

                <span class="comment-age">(04 Feb '13, 19:54)</span>
                <a class="comment-user userinfo" href="/users/4334/rocket72">rocket72</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-18302" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-18302-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="18316"></a>
                    <div id="answer-container-18316" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-18316-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/18316/up/" rel="nofollow"> </a>
<div id="post-18316-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-18316-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/18316/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>At the moment, this can not be done with wireshark on the host itself, as the direction of the traffic is not recorded. However, pcap-ng can record this info if someone implements it.</p>
<p>An alternative would be to use a switch that can do port mirroring and is able to select the direction of traffic. Like on a cisco switch you can do the following:</p>
<pre><code>c2950#sh run | incl mon
monitor session 1 source interface Fa0/24 rx
monitor session 1 destination interface Fa0/10
c2950#
</code></pre>
<p>It will copy only the packets received on interface Fa0/24 to port Fa0/10. You can then attach a laptop with wireshark on interface Fa0/10.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/18316/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>05 Feb '13, 02:39</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7901a94d8fdd1f9f47cda9a32fcfa177?s=32&amp;d=identicon&amp;r=g" alt="SYN-bit's gravatar image" />
    <p><a href="/users/5/syn-bit">SYN-bit ♦♦</a><br/>
    <span class="score" title="17094 reputation points"><span class="">17.1k</span></span><span title="9 badges"><span class="badge1">&#9679;</span><span class="badgecount">9</span></span><span title="57 badges"><span class="silver">&#9679;</span><span class="badgecount">57</span></span><span title="245 badges"><span class="bronze">&#9679;</span><span class="badgecount">245</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="SYN-bit has 174 accepted answers">20&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-18316">
    
        <a name="18322"></a>
        <div class="comment" id="comment-18322">
            <div id="post-18322-score" class="comment-score"></div>
            <div class="comment-text"><p>If someone implements it, <em>including</em> getting the packet direction when capturing (a problem that pcap-ng, by itself, won't solve; there are some platforms where that would require OS kernel changes, for example.)</p></div>
            <div class="comment-info" id="comment-18322-info">
                
                
                
                

                

                <span class="comment-age">(05 Feb '13, 10:00)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="18326"></a>
        <div class="comment" id="comment-18326">
            <div id="post-18326-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>there are some platforms where that would require OS kernel changes, for example</p>
</blockquote>

<p>why is that? As I see it, there are there possible options:</p>

<p>1.) Sniffing traffic that does <strong>not</strong> belong to the capturing machine, so there is no traffic direction.</p>

<p>2.) TX: Sniffing traffic that was sent from the capturing machine. In that case the SRC MAC and/or SRC IP address of the packet will be one of the machine address, maybe except for some L2 broadcast traffic (but then, what kind of protocol would that be, if it's impossible to answer the request !?!).</p>

<p>3.) RX: Sniffing traffic that was directed to capturing machine. In that case the DST MAC and/or DST IP address of the packet will be one of the machine address, maybe except for some L2 broadcast traffic, in which it would be counted as "INCOMING" (depending on the broadcast address).</p>

<p>For 1.) there is nothing to do/change. <br>
For 2./3. there is only a comparison of addresses required. packet address versus system address. </p>

<p>I did not really think this through, but for what case do you think there is a kernel change required?</p>

<p>Regards<br>
Kurt</p></div>
            <div class="comment-info" id="comment-18326-info">
                
                
                
                

                

                <span class="comment-age">(05 Feb '13, 13:32)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="18331"></a>
        <div class="comment" id="comment-18331">
            <div id="post-18331-score" class="comment-score"></div>
            <div class="comment-text"><p>For 3), there's also multicast traffic.  For 2) and 3), there's no guarantee that there <em>is</em> an IP address, so it'd be based purely on the MAC address.</p>

<p>There's also PPP, where you don't <em>have</em> a MAC address.</p>

<p>If you want the direction supplied by libpcap to reflect whether the machine sent or received the packet, that would require kernel changes in BPF, for example.  If you want a mechanism <em>separate</em> from a capture filter, newer versions of BPF have APIs that let you control whether you want sent, received, or both packets, but not all options are supported on all OSes.</p></div>
            <div class="comment-info" id="comment-18331-info">
                
                
                
                

                

                <span class="comment-age">(05 Feb '13, 13:56)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="18334"></a>
        <div class="comment" id="comment-18334">
            <div id="post-18334-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>For 3), there's also multicast traffic. </p>
</blockquote>

<p>Yes, that's traffic that you can't distinguish from case 1.). And that's also true for broadcast traffic. But then, how do you make that decision even with a kernel change? How do you know <strong>why</strong> the packet entered the machine? How do you decide if it was INCOMING traffic or just traffic that entered the machine due to promiscuous mode? </p>

<blockquote>
<p>For 2) and 3), there's no guarantee that there is an IP address, so it'd be based purely on the MAC address.</p>
</blockquote>

<p>Yes, as I said: MAC <strong>or</strong> IP address. Good enough for a simple approach, that might work on every platform without any changes to the kernel.</p>

<blockquote>
<p>There's also PPP, where you don't have a MAC address.</p>
</blockquote>

<p>yes that's a problem. As I said, I did not really think it through. How do you solve that with a kernel change?</p></div>
            <div class="comment-info" id="comment-18334-info">
                
                
                
                

                

                <span class="comment-age">(05 Feb '13, 14:06)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="18335"></a>
        <div class="comment" id="comment-18335">
            <div id="post-18335-score" class="comment-score"></div>
            <div class="comment-text"><p>The OP has a valid case. What if the system spoofs the IP and MacAddresses, but you still want to know if it was sent by the host. Information in the packet will not help you there, you need to know from the OS whether the packet was received by the system or sent by the system.</p></div>
            <div class="comment-info" id="comment-18335-info">
                
                
                
                

                

                <span class="comment-age">(05 Feb '13, 14:54)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="18338"></a>
        <div class="comment not_top_scorer" id="comment-18338">
            <div id="post-18338-score" class="comment-score"></div>
            <div class="comment-text"><p>address spoofing is a good point. I did not see the OPs comment on that. In that case only the kernel will be able to tell if the packet was sent (with a spoofed address) or received (due to promiscuous mode). That's a real benefit for <strong>outgoing</strong> traffic. </p>

<p>Now let's look at <strong>incoming</strong> traffic. How much value does it add to write that information into a pcap-ng if you are <strong>capturing</strong> traffic. Are all packets that enter the machine (<strong>promiscuous mode</strong>, multicast, broadcast, directed) <strong>incoming</strong> traffic or just those packets that are destined for the machine (dst mac/ip of the machine)? How do you handle multicast + broadcast? Is that also <strong>incoming</strong> traffic or <strong>flow by and captured</strong> traffic?</p></div>
            <div class="comment-info" id="comment-18338-info">
                
                
                
                

                

                <span class="comment-age">(05 Feb '13, 15:26)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="18346"></a>
        <div class="comment not_top_scorer" id="comment-18346">
            <div id="post-18346-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>How much value does it add to write that information into a pcap-ng if you are capturing traffic.</p>
</blockquote>

<p>Well, if incoming packets include an FCS, then knowing whether the packet is incoming or outgoing could let Wireshark not have to use the current heuristic to determine whether an Ethernet packet has an FCS or not - outgoing packets won't have it, as it's added by the hardware, and outgoing packets are captured by being wrapped around.</p>

<p>Similarly, if we know that an interface is doing IP/TCP/UDP/etc. checksum offloading, Wireshark could disable the checksum check for outgoing packets.</p></div>
            <div class="comment-info" id="comment-18346-info">
                
                
                
                

                

                <span class="comment-age">(05 Feb '13, 19:49)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="18347"></a>
        <div class="comment not_top_scorer" id="comment-18347">
            <div id="post-18347-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>Are all packets that enter the machine (promiscuous mode, multicast, broadcast, directed) incoming traffic</p>
</blockquote>

<p>Yes.</p>

<blockquote>
<p>or just those packets that are destined for the machine (dst mac/ip of the machine)?</p>
</blockquote>

<p>No.</p>

<blockquote>
<p>How do you handle multicast + broadcast? Is that also incoming traffic</p>
</blockquote>

<p>Yes.</p>

<blockquote>
<p>or flow by and captured traffic?</p>
</blockquote>

<p>No.</p>

<p>A packet is incoming if the network adapter received it.  A packet is outgoing if it was handed to the network adapter driver to transmit on that adapter.</p>

<p>"Received unicast" vs. "received multicast/broadcast" vs. "received promiscuously" is a subdivision of "incoming".</p></div>
            <div class="comment-info" id="comment-18347-info">
                
                
                
                

                

                <span class="comment-age">(05 Feb '13, 19:51)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="18351"></a>
        <div class="comment not_top_scorer" id="comment-18351">
            <div id="post-18351-score" class="comment-score"></div>
            <div class="comment-text"><p>O.K. now I see the value of direction information if you capture data on a system itself. </p>

<p>So, how would you treat traffic captured on a tap or on a mirror port? Would that be '(fake) incoming' traffic as well, as there is no method to detect the tap and/or mirror port, except maybe by looking at the capture file at the end, and if there is only incoming traffic, chances are good that you were capturing on a tap/mirror port, or would you make it a user configurable option (record traffic direction)?</p></div>
            <div class="comment-info" id="comment-18351-info">
                
                
                
                

                

                <span class="comment-age">(05 Feb '13, 22:09)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="18354"></a>
        <div class="comment not_top_scorer" id="comment-18354">
            <div id="post-18354-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>So, how would you treat traffic captured on a tap or on a mirror port? Would that be '(fake) incoming' traffic as well</p>
</blockquote>

<p>Yes.</p>

<p>If you're passively capturing on a non-broadcast medium, such as a PPP link or a connection to an X.25 network or an ISDN connection, there should perhaps be a separate direction indicator in a pseudo-header - some of the non-pcap/pcap-ng formats have that, and there are some LINKTYPE_XXX_WITH_DIR link-layer header types for pcap/pcap-ng that have such a pseudo-header.</p></div>
            <div class="comment-info" id="comment-18354-info">
                
                
                
                

                

                <span class="comment-age">(06 Feb '13, 00:33)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="18373"></a>
        <div class="comment not_top_scorer" id="comment-18373">
            <div id="post-18373-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks for the clarification.</p></div>
            <div class="comment-info" id="comment-18373-info">
                
                
                
                

                

                <span class="comment-age">(06 Feb '13, 12:06)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-18316" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 11
        </span>
        <a href="#" class="show-all-comments-link">show 6 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-18316-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/18300/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='gCvIfSv8Bw2N6zMBND5kkh3KKFx1kByD' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/18300/capture-or-filter-only-sent-tx-traffic?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/18300/capture-or-filter-only-sent-tx-traffic?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/traffic/"
            class="tag-link-traffic"
            title="see questions tagged'traffic'using tags"
            rel="tag">traffic</a> <span class="tag-number">&#215;115</span><br/>
        
        <a href="/tags/filters/"
            class="tag-link-filters"
            title="see questions tagged'filters'using tags"
            rel="tag">filters</a> <span class="tag-number">&#215;40</span><br/>
        
        <a href="/tags/tx/"
            class="tag-link-tx"
            title="see questions tagged'tx'using tags"
            rel="tag">tx</a> <span class="tag-number">&#215;3</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Feb. 4, 2013, 6:55 p.m.">04 Feb '13, 18:55</strong>
    </p>
    <p> 
     	question was seen: <strong>42,255 times</strong>
    </p>
    <p> 
        last updated: <strong title="Feb. 6, 2013, 12:06 p.m.">06 Feb '13, 12:06</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/41371/what-kind-of-traffic-is-bad-trafficuseless">What kind of traffic is bad traffic(Useless)?</a>
        </p>
        
        <p>
            <a href="/questions/55527/traffic-aggregation">Traffic aggregation</a>
        </p>
        
        <p>
            <a href="/questions/82/can-wireshark-monitor-bandwidth-usage-per-applicationprocess">Can Wireshark monitor bandwidth usage per application/process?</a>
        </p>
        
        <p>
            <a href="/questions/6047/capturing-download-size">Capturing download size</a>
        </p>
        
        <p>
            <a href="/questions/13804/how-to-capture-linksys-wrt320n-to-arris-tm722-home-network-http-and-other-traffic">HOW TO capture linksys wrt320n to arris tm722 home network HTTP and other traffic</a>
        </p>
        
        <p>
            <a href="/questions/20937/wireshark-capturing-only-incoming-traffic-on-windows-7">Wireshark capturing only incoming traffic on Windows 7</a>
        </p>
        
        <p>
            <a href="/questions/32227/how-to-capture-lan-traffic">how to capture LAN traffic</a>
        </p>
        
        <p>
            <a href="/questions/39934/hidden-traffic">Hidden Traffic</a>
        </p>
        
        <p>
            <a href="/questions/53497/check-bidirectional-traffic">check bidirectional traffic</a>
        </p>
        
        <p>
            <a href="/questions/59987/voicedata-traffic-question">Voice/Data Traffic Question</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
