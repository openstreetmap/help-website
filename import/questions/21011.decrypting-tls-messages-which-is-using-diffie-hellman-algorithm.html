<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Decrypting TLS messages which is using Diffie hellman algorithm - Wireshark Q&amp;A</title>
        <meta name="description" content="From the Client I am logging all the master secret key for all the sessions.Using that key how to generate the .key file and is that be possible to decrypt the DHE messages in wireshark using Master secret key? Wireshark will be able to understand the way of decrypting DHE?" />
        <meta name="keywords" content="decryption,openssl,diffie-hellman" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/21011/decrypting-tls-messages-which-is-using-diffie-hellman-algorithm" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/21011/decrypting-tls-messages-which-is-using-diffie-hellman-algorithm?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='JtrBQO2xvIzRFQ81QIIiUOZHO61bNGPY' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/21011/decrypting-tls-messages-which-is-using-diffie-hellman-algorithm">Decrypting TLS messages which is using Diffie hellman algorithm</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-21011-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/21011/up/" rel="nofollow"> </a>
<div id="post-21011-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-21011-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/21011/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/21011/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>From the Client I am logging all the master secret key for all the sessions.Using that key how to generate the .key file and is that be possible to decrypt the DHE messages in wireshark using Master secret key? Wireshark will be able to understand the way of decrypting DHE?</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/decryption/" class="post-tag tag-link-decryption"
                                        title="see questions tagged 'decryption'" rel="tag">decryption</a>
                                
                                    <a href="/tags/openssl/" class="post-tag tag-link-openssl"
                                        title="see questions tagged 'openssl'" rel="tag">openssl</a>
                                
                                    <a href="/tags/diffie-hellman/" class="post-tag tag-link-diffie-hellman"
                                        title="see questions tagged 'diffie-hellman'" rel="tag">diffie-hellman</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                
<div class="community-wiki">
        This question is marked "community wiki".
        
    </div>
                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>07 May '13, 21:28</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/3606fb2f161676306a345c0e2809e550?s=32&amp;d=identicon&amp;r=g" alt="Kalai's gravatar image" />
    <p><a href="/users/4907/kalai">Kalai</a><br/>
    <span class="score" title="16 reputation points">16</span><span title="5 badges"><span class="badge1">&#9679;</span><span class="badgecount">5</span></span><span title="5 badges"><span class="silver">&#9679;</span><span class="badgecount">5</span></span><span title="10 badges"><span class="bronze">&#9679;</span><span class="badgecount">10</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kalai has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-21011">
    
</div>
<div id="comment-tools-21011" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-21011-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/21011/decrypting-tls-messages-which-is-using-diffie-hellman-algorithm?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/21011/decrypting-tls-messages-which-is-using-diffie-hellman-algorithm?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/21011/decrypting-tls-messages-which-is-using-diffie-hellman-algorithm?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/21011/decrypting-tls-messages-which-is-using-diffie-hellman-algorithm?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="21012"></a>
                    <div id="answer-container-21012" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-21012-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/21012/up/" rel="nofollow"> </a>
<div id="post-21012-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-21012-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/21012/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>While it is not possible to create the private key of the server from the master keys, you will be able to decrypt the sessions in the tracefile that correspond to the logged master keys.</p>
<p>You will need to put the master keys in a file as follows (from the source code):</p>
<pre><code>         "RSA &lt;EPMS&gt; &lt;PMS&gt;\n"
         "RSA Session-ID:&lt;SSLID&gt; Master-Key:&lt;MS&gt;\n"
         "\n"
         "Where:\n"
         "&lt;EPMS&gt; = First 8 bytes of the Encrypted PMS\n"
         "&lt;PMS&gt; = The Pre-Master-Secret (PMS)\n"
         "&lt;SSLID&gt; = The SSL Session ID\n"
         "&lt;MS&gt; = The Master-Secret (MS)\n"
         "\n"
         "(All fields are in hex notation)",
</code></pre>
<p>So for example:</p>
<pre><code>RSA Session-ID:fbcf322128ed0a00b272d6ac85843f50deccdd94ac33261523189639f5ba189a Master-Key:bda6ea472f6c39a9fcfd5dc79eb161d1a4cae5d924fdde800f276263fd6df1ee8ed246b5a6412e328eb85744c9bf7cf2
RSA Session-ID:db00c2aad79cfda109ce4f65a9801aa8d5f1bbeb9e1f848f6a2f7551f9de7577 Master-Key:92cdc769c670ba6f48cfe756992ad435401a26d0235900c0f67c846b5f360c108df167ca6b6f443f4d2b118de0ccadb8
</code></pre>
<p>You then point to the file in the SSL protocol preferences by using the "(Pre-)Master-secret log filename" setting.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/21012/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>07 May '13, 22:34</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7901a94d8fdd1f9f47cda9a32fcfa177?s=32&amp;d=identicon&amp;r=g" alt="SYN-bit's gravatar image" />
    <p><a href="/users/5/syn-bit">SYN-bit ♦♦</a><br/>
    <span class="score" title="17094 reputation points"><span class="">17.1k</span></span><span title="9 badges"><span class="badge1">&#9679;</span><span class="badgecount">9</span></span><span title="57 badges"><span class="silver">&#9679;</span><span class="badgecount">57</span></span><span title="245 badges"><span class="bronze">&#9679;</span><span class="badgecount">245</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="SYN-bit has 174 accepted answers">20&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/21012/">
                edited
                <strong>07 May '13, 22:37</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-21012">
    
        <a name="21014"></a>
        <div class="comment" id="comment-21014">
            <div id="post-21014-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi.Thanks for the reply.Do I need Encrypted PMS and PMS keys? If so What are those keys? As Master secret is used to encrypt and decrypt the messages in DHE, only master secret and session Id's are not enough like in your example?</p></div>
            <div class="comment-info" id="comment-21014-info">
                
                
                
                

                

                <span class="comment-age">(08 May '13, 00:11)</span>
                <a class="comment-user userinfo" href="/users/4907/kalai">Kalai</a>
                
            </div>
        </div>
    
        <a name="21015"></a>
        <div class="comment" id="comment-21015">
            <div id="post-21015-score" class="comment-score"></div>
            <div class="comment-text"><p>And also I used %02x format to print Master secret. Should I have to use the same format for session Id's also?</p></div>
            <div class="comment-info" id="comment-21015-info">
                
                
                
                

                

                <span class="comment-age">(08 May '13, 00:57)</span>
                <a class="comment-user userinfo" href="/users/4907/kalai">Kalai</a>
                
            </div>
        </div>
    
        <a name="21016"></a>
        <div class="comment" id="comment-21016">
            <div id="post-21016-score" class="comment-score"></div>
            <div class="comment-text"><p>You will only need the SessionID/Master Secret combinations. The other format is for the export that Chrome/Firefox can make when compiled with a debug option.</p>

<p>Yes, the sessionID should also be in hexformat.</p></div>
            <div class="comment-info" id="comment-21016-info">
                
                
                
                

                

                <span class="comment-age">(08 May '13, 01:02)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="21020"></a>
        <div class="comment" id="comment-21020">
            <div id="post-21020-score" class="comment-score"></div>
            <div class="comment-text"><p>I provided the log file in Edit&gt;preference&gt;pre-master key log file tab (RSA Session-ID:9835348
Master-Key:EC6B8B3131B3842CCFB47308B73B31BB9F870E43B1FA26098064B2C724FA14E910D8F509676BA37D74F15AA6351EDBC0)
But nothing is happening ...
The ssl debug file is showing the following:</p>

<p><code>
dissect_ssl enter frame #1 (first time)
ssl_session_init: initializing ptr 056610A4 size 588
  conversation = 05660E64, ssl_session = 056610A4
  record: offset = 0, reported_length_remaining = 437
dissect_ssl3_record found version 0x0301(TLS 1.0) -&gt; state 0x10
dissect_ssl3_record: content_type 23 Application Data
decrypt_ssl3_record: app_data len 432, ssl state 0x10
association_find: TCP port 9970 found 00000000
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
association_find: TCP port 9970 found 00000000
association_find: TCP port 3456 found 00000000
association_find: TCP port 0 found 00000000
</code></p>

<p>What could be the issue?</p></div>
            <div class="comment-info" id="comment-21020-info">
                
                
                
                

                

                <span class="comment-age">(08 May '13, 03:47)</span>
                <a class="comment-user userinfo" href="/users/4907/kalai">Kalai</a>
                
            </div>
        </div>
    
        <a name="21028"></a>
        <div class="comment" id="comment-21028">
            <div id="post-21028-score" class="comment-score"></div>
            <div class="comment-text"><p>The SSL SessionID is usually a 32 octet value. It's best to take it from the ServerHello:</p>

<pre><code>Session ID Length: 32
Session ID: db00c2aad79cfda109ce4f65a9801aa8d5f1bbeb9e1f848f...
</code></pre>

<p>The value listed by wireshark is truncated, but can be capied by rightclick -&gt; copy -&gt; bytes -&gt; hex stream. This will result in:</p>

<pre><code>db00c2aad79cfda109ce4f65a9801aa8d5f1bbeb9e1f848f6a2f7551f9de7577
</code></pre></div>
            <div class="comment-info" id="comment-21028-info">
                
                
                
                

                

                <span class="comment-age">(08 May '13, 07:17)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="21036"></a>
        <div class="comment not_top_scorer" id="comment-21036">
            <div id="post-21036-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi in the server hello the session ID length is 0, and also am getting the following lines in the debug file 
checking keylog line: RSA Session-ID:9E7D348s3
    line does not match encrypted pre-master secret    line does not match
  checking keylog line: Master-Key:530BAAC26D6D57CE75B1DF8284EA57291882F46BD337DC72171BFBC3201F8B263B0E98607C1F4F673E39052AC70FC23F
    line does not match</p>

<p>Is that the problem with the session-ID?</p></div>
            <div class="comment-info" id="comment-21036-info">
                
                
                
                

                

                <span class="comment-age">(08 May '13, 08:56)</span>
                <a class="comment-user userinfo" href="/users/4907/kalai">Kalai</a>
                
            </div>
        </div>
    
        <a name="21040"></a>
        <div class="comment not_top_scorer" id="comment-21040">
            <div id="post-21040-score" class="comment-score"></div>
            <div class="comment-text"><p>OK, if there is no session id, you will need to revert to the first method of logging the first 8 octets of the encrypted Pre-Mastersecret together with the Pre-Mastersecret. Both in hex notation.</p>

<p>This will need to look like this:</p>

<pre><code>RSA 46BD337DC72171BF \
  B1DF8284EA57291882F46BD337DC72171BFBC3201F8B263B0E98607C1FB1DF8284EA57291882F46BD337DC72171BFBC3
</code></pre></div>
            <div class="comment-info" id="comment-21040-info">
                
                
                
                

                

                <span class="comment-age">(08 May '13, 14:28)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="21055"></a>
        <div class="comment not_top_scorer" id="comment-21055">
            <div id="post-21055-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi my keylog file is looking like this:</p>

<pre><code>RSA D0135C1A76C9857E C80D3BC9FD3654BC95A3E68124B747C6B581FD06EC427AEFAD871104F5C42DCFBBF237067FAABF11266A0D76B049CBC3CB68DFC3659736DABEE5CA092B5D05831498F6354EDE3A0CD65DFDA7701C1F4600834FFDE9AA9B5848437255F4391A78E779084ADD5D5F5FEA8E05E8E97F02BC5613C1B73082AF6EB3A0B52BDACBEBC8
RSA Session-ID:8C8C348
Master-Key:3FB3843CDD2DC0FB7AD4C81B75A19C4434AEA0A5B977EB562BB2B099A180B0884CBFC380A03FA767AF01032601703C6B
</code></pre>

<p>Still I am getting,</p>

<pre><code>trying to use SSL keylog in C:\keylog.txt
  checking keylog line: RSA D0135C1A76C9857E C80D3BC9FD3654BC95A3E68124B747C6B581FD06EC427AEFAD871104F5C42DCFBBF237067FAABF11266A0D76B049CBC3CB68DFC3659736DABEE5CA092B5D05831498F6354EDE3A0CD65DFDA7701C1F4600834FFDE9AA9B5848437255F4391A78E779084ADD5D5F5FEA8E05E8E97F02BC5613C1B73082AF6EB3A0B52BDACBEBC8
    line does not match encrypted pre-master secret    line does not match
  checking keylog line: RSA Session-ID:8C8C348
    line does not match encrypted pre-master secret    line does not match
  checking keylog line: Master-Key:3FB3843CDD2DC0FB7AD4C81B75A19C4434AEA0A5B977EB562BB2B099A180B0884CBFC380A03FA767AF01032601703C6
    line does not match
  record: offset = 139, reported_length_remaining = 59
dissect_ssl3_record: content_type 20 Change Cipher Spec
dissect_ssl3_change_cipher_spec
packet_from_server: is from server - FALSE
ssl_change_cipher CLIENT
  record: offset = 145, reported_length_remaining = 53
dissect_ssl3_record: content_type 22 Handshake
decrypt_ssl3_record: app_data len 48, ssl state 0x17
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 85 offset 150 length 7676257 bytes, remaining 198
</code></pre></div>
            <div class="comment-info" id="comment-21055-info">
                
                
                
                

                

                <span class="comment-age">(09 May '13, 07:18)</span>
                <a class="comment-user userinfo" href="/users/4907/kalai">Kalai</a>
                
            </div>
        </div>
    
        <a name="21061"></a>
        <div class="comment not_top_scorer" id="comment-21061">
            <div id="post-21061-score" class="comment-score"></div>
            <div class="comment-text"><p>Are you able to post the tracefile on www.cloudshark.org? If you are worried about the application data, only the SSL handshake is needed.</p></div>
            <div class="comment-info" id="comment-21061-info">
                
                
                
                

                

                <span class="comment-age">(09 May '13, 09:44)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="21077"></a>
        <div class="comment not_top_scorer" id="comment-21077">
            <div id="post-21077-score" class="comment-score"></div>
            <div class="comment-text"><p>I have added the file in the link: <a href="http://cloudshark.org/captures/4161807df249">http://cloudshark.org/captures/4161807df249</a>
RSA Session-ID:8C8C348
Master-Key:3FB3843CDD2DC0FB7AD4C81B75A19C4434AEA0A5B977EB562BB2B099A180B0884CBFC380A03FA767AF01032601703C6B
PreMaster key-C80D3BC9FD3654BC95A3E68124B747C6B581FD06EC427AEFAD871104F5C42DCFBBF237067FAABF11266A0D76B049CBC3CB68DFC3659736DABEE5CA092B5D05831498F6354EDE3A0CD65DFDA7701C1F4600834FFDE9AA9B5848437255F4391A78E779084ADD5D5F5FEA8E05E8E97F02BC5613C1B73082AF6EB3A0B52BDACBEBC8</p></div>
            <div class="comment-info" id="comment-21077-info">
                
                
                
                

                

                <span class="comment-age">(09 May '13, 22:21)</span>
                <a class="comment-user userinfo" href="/users/4907/kalai">Kalai</a>
                
            </div>
        </div>
    
        <a name="21110"></a>
        <div class="comment not_top_scorer" id="comment-21110">
            <div id="post-21110-score" class="comment-score"></div>
            <div class="comment-text"><p>I am having access to the client completely.Any other workaround which will decrypt the application data in wireshark?</p></div>
            <div class="comment-info" id="comment-21110-info">
                
                
                
                

                

                <span class="comment-age">(13 May '13, 03:11)</span>
                <a class="comment-user userinfo" href="/users/4907/kalai">Kalai</a>
                
            </div>
        </div>
    
        <a name="21111"></a>
        <div class="comment not_top_scorer" id="comment-21111">
            <div id="post-21111-score" class="comment-score"></div>
            <div class="comment-text"><p>I was looking at your trace and made a trace myself, but I need to look into the source code to see if it is a simple fix to be able to decrypt SSL sessions for which the key has been exchanged by DH. It does not seem to do that now, even though I believe that logging the (pre-)master secret would be enough to go on (as long as it can be indexed in some way to identify the session).</p>

<p>Unfortunately, I do not have the time at the moment to dive some deeper. So for now I'm afraid there is no decryption possible for DH sessions, not even with the session keys logged.</p></div>
            <div class="comment-info" id="comment-21111-info">
                
                
                
                

                

                <span class="comment-age">(13 May '13, 04:47)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="21145"></a>
        <div class="comment not_top_scorer" id="comment-21145">
            <div id="post-21145-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi The decryption of DHE session is working when I used CLIENT_RANDOM &lt;hex clientrandom=""&gt; &lt;hex masterkey=""&gt;. When I used capital letters for hex it was not working and its working fine when I use small letters.Thanks for your help...</p></div>
            <div class="comment-info" id="comment-21145-info">
                
                
                
                

                

                <span class="comment-age">(15 May '13, 03:02)</span>
                <a class="comment-user userinfo" href="/users/4907/kalai">Kalai</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-21012" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 13
        </span>
        <a href="#" class="show-all-comments-link">show 8 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-21012-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/21011/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='JtrBQO2xvIzRFQ81QIIiUOZHO61bNGPY' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/21011/decrypting-tls-messages-which-is-using-diffie-hellman-algorithm?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/21011/decrypting-tls-messages-which-is-using-diffie-hellman-algorithm?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/decryption/"
            class="tag-link-decryption"
            title="see questions tagged'decryption'using tags"
            rel="tag">decryption</a> <span class="tag-number">&#215;165</span><br/>
        
        <a href="/tags/openssl/"
            class="tag-link-openssl"
            title="see questions tagged'openssl'using tags"
            rel="tag">openssl</a> <span class="tag-number">&#215;7</span><br/>
        
        <a href="/tags/diffie-hellman/"
            class="tag-link-diffie-hellman"
            title="see questions tagged'diffie-hellman'using tags"
            rel="tag">diffie-hellman</a> <span class="tag-number">&#215;2</span><br/>
        
    </p>
    <p>
        question asked: <strong title="May 7, 2013, 9:28 p.m.">07 May '13, 21:28</strong>
    </p>
    <p> 
     	question was seen: <strong>15,078 times</strong>
    </p>
    <p> 
        last updated: <strong title="May 15, 2013, 3:02 a.m.">15 May '13, 03:02</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/21699/decrypting-the-encrypted-data-taken-from-wireshark">Decrypting the Encrypted Data taken from wireshark</a>
        </p>
        
        <p>
            <a href="/questions/61343/is-the-decryption-of-tls_rsa_with_aes_256_gcm_sha384-cipher-suite-supported">is the decryption of TLS_RSA_WITH_AES_256_GCM_SHA384 cipher suite supported?</a>
        </p>
        
        <p>
            <a href="/questions/1038/decrypting-ssl-packets-on-chromium-or-opera-does-not-work">decrypting SSL packets on Chromium or Opera does not work?</a>
        </p>
        
        <p>
            <a href="/questions/7886/ssl-decrypting-problem">SSL decrypting problem</a>
        </p>
        
        <p>
            <a href="/questions/14805/ssl-decryption-error">SSL Decryption Error</a>
        </p>
        
        <p>
            <a href="/questions/21392/couldnt-extract-encrypted-application-data-from-pcap-using-perl-netpacket-module">Couldn&#39;t extract encrypted Application data from pcap using Perl Netpacket module</a>
        </p>
        
        <p>
            <a href="/questions/25803/decrypt-ssl-with-exported-ssl-session-keys">Decrypt SSL with exported SSL Session Keys</a>
        </p>
        
        <p>
            <a href="/questions/34945/decrypt-out-of-order-ssl-trace">Decrypt out of order SSL trace</a>
        </p>
        
        <p>
            <a href="/questions/41925/decrypting-wifi-packets-captured-in-monitor-mode-on-mac">Decrypting WiFi packets captured in monitor mode on Mac</a>
        </p>
        
        <p>
            <a href="/questions/47508/tshark-command-syntax-for-decrypting-tls-traffic-from-2-or-more-servers">tshark: command syntax for decrypting TLS traffic from 2 or more servers</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
