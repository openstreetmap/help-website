<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>TTL (Time To Live) - Wireshark Q&amp;A</title>
        <meta name="description" content="Dear all, what is the purpose of TTL on the Internet Protocol message? it live which conversation. regards, Hafiz!" />
        <meta name="keywords" content="ip,ttl" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/22337/ttl-time-to-live" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/22337/ttl-time-to-live?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='mHMg5WKF7M4JBASCAlJSONB0vbHAZTsq' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/22337/ttl-time-to-live">TTL (Time To Live)</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-22337-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/22337/up/" rel="nofollow"> </a>
<div id="post-22337-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-22337-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/22337/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/22337/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Dear all,</p>
<p>what is the purpose of TTL on the Internet Protocol message? it live which conversation.</p>
<p>regards,</p>
<p>Hafiz!</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/ip/" class="post-tag tag-link-ip"
                                        title="see questions tagged 'ip'" rel="tag">ip</a>
                                
                                    <a href="/tags/ttl/" class="post-tag tag-link-ttl"
                                        title="see questions tagged 'ttl'" rel="tag">ttl</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>25 Jun '13, 20:24</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/3758b972d853e9581da61ce3f7ae12bf?s=32&amp;d=identicon&amp;r=g" alt="Hafiz's gravatar image" />
    <p><a href="/users/5176/hafiz">Hafiz</a><br/>
    <span class="score" title="26 reputation points">26</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="4 badges"><span class="bronze">&#9679;</span><span class="badgecount">4</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Hafiz has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/22337/">
                edited
                <strong>27 Jun '13, 02:31</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" alt="grahamb's gravatar image" />
            <p><a href="/users/1225/grahamb">grahamb ♦</a><br/>
            <span class="score" title="19834 reputation points"><span class="">19.8k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">&#9679;</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">&#9679;</span><span class="badgecount">206</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-22337">
    
        <a name="22354"></a>
        <div class="comment" id="comment-22354">
            <div id="post-22354-score" class="comment-score"></div>
            <div class="comment-text"><p>Hafiz, can you explain what is the flow/test that you are performing, and the error generated to your HS and ussd app? Also, transaction id's would be appreciated (related to the trace you have provided).</p></div>
            <div class="comment-info" id="comment-22354-info">
                
                
                
                

                

                <span class="comment-age">(26 Jun '13, 05:20)</span>
                <a class="comment-user userinfo" href="/users/5036/edmond">Edmond</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-22337" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-22337-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    3 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/22337/ttl-time-to-live?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/22337/ttl-time-to-live?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/22337/ttl-time-to-live?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/22337/ttl-time-to-live?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="22338"></a>
                    <div id="answer-container-22338" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-22338-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/22338/up/" rel="nofollow"> </a>
<div id="post-22338-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-22338-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/22338/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>TTL indicates the remaining life time of a packet when it is floating on a network.</p>
<p>If a packet arrives at a router with TTL Value 1 then that router should discard(as TTL becomes 0) it and send back ICMP Type 11 and Code 0 message(Time to live exceeded).</p>
<p>One advantage/purpose i can think of is to avoid Looping at Layer3 .If there is any packet loop in the network and each time it hits a routing interface it's value will be decremented and eventually this unhealthy packet perishes.</p>
<p>Moreover TraceRoute make use of this TTL mechanism.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/22338/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>25 Jun '13, 20:53</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/2b038237e64839261fcc88e9fdef2b68?s=32&amp;d=identicon&amp;r=g" alt="krishnayeddula's gravatar image" />
    <p><a href="/users/4450/krishnayeddula">krishnayeddula</a><br/>
    <span class="score" title="629 reputation points">629</span><span title="35 badges"><span class="badge1">&#9679;</span><span class="badgecount">35</span></span><span title="41 badges"><span class="silver">&#9679;</span><span class="badgecount">41</span></span><span title="48 badges"><span class="bronze">&#9679;</span><span class="badgecount">48</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="krishnayeddula has 3 accepted answers">6&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/22338/">
                edited
                <strong>25 Jun '13, 21:25</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-22338">
    
        <a name="22341"></a>
        <div class="comment" id="comment-22341">
            <div id="post-22341-score" class="comment-score"></div>
            <div class="comment-text"><p>Dear Krishnayeddula,</p>

<p>thanks from your support and help.</p>

<p>my issue is in a GSM network and below is my scenario.</p>

<p>{{{{{{Mobile Station====&gt; (MSC=TTL=63)====&gt;(STP=TTL=255)====&gt;(HLR=TTL=62)====&gt;(STP=TTL=255)====&gt;USSD}}}}}}</p>

<pre><code>                                   on the revert path
</code></pre>

<p>{{{{{(USSD=TTL=62)====&gt;(STP=TTL=255)====&gt;(HLR=TTL=62)====&gt;STP=TTL=255)====&gt;MSC=-------===&gt;Mobile Station}}}}}}</p>

<p>MS send *303# to USSD
USSD send back to MS please enter you facebook ID/// while i am typing my facebook on the screen of mobile my transection disconnecting.
as i check on the trace release is coming from Mobile side. but i don't know to blame which platform.</p>

<p>best Regards,</p>

<p>Hafiz
AWCC Afghanistan</p>

<p>i don't know how to attached my trace.</p></div>
            <div class="comment-info" id="comment-22341-info">
                
                
                
                

                

                <span class="comment-age">(25 Jun '13, 23:51)</span>
                <a class="comment-user userinfo" href="/users/5176/hafiz">Hafiz</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-22338" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-22338-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="22342"></a>
                    <div id="answer-container-22342" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-22342-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/22342/up/" rel="nofollow"> </a>
<div id="post-22342-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-22342-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/22342/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>The IP TTL is a time-to-live at the IP layer to prevent packet destined for an undeliverable address from looping through the network forever. It is defined as:</p>
<pre><code>Time to Live:  8 bits

This field indicates the maximum time the datagram is allowed to
remain in the internet system.  If this field contains the value
zero, then the datagram must be destroyed.  This field is modified
in internet header processing.  The time is measured in units of
seconds, but since every module that processes a datagram must
decrease the TTL by at least one even if it process the datagram in
less than a second, the TTL must be thought of only as an upper
bound on the time a datagram may exist.  The intention is to cause
undeliverable datagrams to be discarded, and to bound the maximum
datagram lifetime.
</code></pre>
<p>(see: <a href="http://tools.ietf.org/html/rfc791#page-14">RFC 791 page 14</a>)</p>
<p>I believe the hops you are drawing in your response to <a href="/users/4450/krishnayeddula">@krishnayeddula</a> are hop at the application layer and not at the IP layer. Between these application layer hops are routers to get the IP packet from one server to the other. Each of these routers will decrement the IP TTL, but each server will create a new IP packet, with a new TTL value.</p>
<p>(You can share traces by uploading the trace to www.cloudshark.org and then paste the link to the trace here)</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/22342/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>26 Jun '13, 00:02</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7901a94d8fdd1f9f47cda9a32fcfa177?s=32&amp;d=identicon&amp;r=g" alt="SYN-bit's gravatar image" />
    <p><a href="/users/5/syn-bit">SYN-bit ♦♦</a><br/>
    <span class="score" title="17094 reputation points"><span class="">17.1k</span></span><span title="9 badges"><span class="badge1">&#9679;</span><span class="badgecount">9</span></span><span title="57 badges"><span class="silver">&#9679;</span><span class="badgecount">57</span></span><span title="245 badges"><span class="bronze">&#9679;</span><span class="badgecount">245</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="SYN-bit has 174 accepted answers">20&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-22342">
    
        <a name="22350"></a>
        <div class="comment" id="comment-22350">
            <div id="post-22350-score" class="comment-score"></div>
            <div class="comment-text"><p>thanks Mr. SYN,</p>

<p><a href="http://www.cloudshark.org/captures/96a78386e75a">http://www.cloudshark.org/captures/96a78386e75a</a></p></div>
            <div class="comment-info" id="comment-22350-info">
                
                
                
                

                

                <span class="comment-age">(26 Jun '13, 02:13)</span>
                <a class="comment-user userinfo" href="/users/5176/hafiz">Hafiz</a>
                
            </div>
        </div>
    
        <a name="22351"></a>
        <div class="comment" id="comment-22351">
            <div id="post-22351-score" class="comment-score"></div>
            <div class="comment-text"><p>kindly please put some more light on:(each server will create a new IP packet, with a new TTL value)in my network</p></div>
            <div class="comment-info" id="comment-22351-info">
                
                
                
                

                

                <span class="comment-age">(26 Jun '13, 02:16)</span>
                <a class="comment-user userinfo" href="/users/5176/hafiz">Hafiz</a>
                
            </div>
        </div>
    
        <a name="22352"></a>
        <div class="comment" id="comment-22352">
            <div id="post-22352-score" class="comment-score">2</div>
            <div class="comment-text"><p>Consider the following setup:</p>

<p>srvA -&gt; rtr1 -&gt; rtr2 -&gt; srvB -&gt; rtr3 -&gt; srvC</p>

<p>Different systems use different initial TTL values (mostly 64, 128 or 255), for now, assume they all use 64.</p>

<p>A message from srvA to srvB will have the following headers:</p>

<pre><code>mac-srvA -&gt; mac-rtr1, ip-srvA -&gt; ip-srvB, TTL=64 (arriving at rtr1)
mac-rtr1 -&gt; mac-rtr2, ip-srvA -&gt; ip-srvB, TTL=63 (arriving at rtr2)
mac-rtr2 -&gt; mac-srvB, ip-srvA -&gt; ip-srvB, TTL=62 (arriving at srvB)
</code></pre>

<p>Then if srvA has an application that somehow forwards the message to srvC, the following headers can be seen:</p>

<pre><code>mac-srvB -&gt; mac-rtr3, ip-srvB -&gt; ip-srvC, TTL=64 (arriving at rtr3)
mac-rtr3 -&gt; mac-srvC, ip-srvB -&gt; ip-srvC, TTL=63 (arriving at srvC)
</code></pre>

<p>So you need to make a distinction in your analysis between routing hops and application hops. I believe you were mentioning application hops in your example.</p>

<p>In your example capture, made on 172.18.8.69 you can see that it communicates with 3 other systems:</p>

<p>Packets from 172.21.40.31 have a TTL of 63, which means there is one router in between 172.21.40.31 and 172.18.8.69 (assuming the 64 start value of the IP TTL).</p>

<p>Packets from 172.17.90.5 have a TTL of 62, which means there are two routers in between 172.17.90.5 and 172.18.8.69 (assuming the 64 start value of the IP TTL).</p>

<p>Packets from 192.168.236.5 have a TTL of 62, which means there are two routers in between 192.168.236.5 and 172.18.8.69 (assuming the 64 start value of the IP TTL).</p>

<p>The problem you are researching is not at the IP layer but in one of your application layers. I have very little knowledge of the mobile networking protocols. But I see an error in frame 17 with a 60 second delta, this looks like a timeout on that server to me. Could that be your problem source?</p></div>
            <div class="comment-info" id="comment-22352-info">
                
                
                
                

                

                <span class="comment-age">(26 Jun '13, 03:10)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="22356"></a>
        <div class="comment" id="comment-22356">
            <div id="post-22356-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks Mr. SYN,</p>

<p>TTL is now cleared for me. appreciate for your support.</p>

<p>I looking to the other part of trace if faced any confusion i will come to you.</p>

<p>Regards,</p>

<p>Hafiz
AWCC Afghanistan</p></div>
            <div class="comment-info" id="comment-22356-info">
                
                
                
                

                

                <span class="comment-age">(26 Jun '13, 06:21)</span>
                <a class="comment-user userinfo" href="/users/5176/hafiz">Hafiz</a>
                
            </div>
        </div>
    
        <a name="22360"></a>
        <div class="comment" id="comment-22360">
            <div id="post-22360-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks Mr. Edmond,</p>

<p>my test scenario is:</p>

<p>from MS i am sending *303# toward USSD getway
USSD getway replaying press 1 to confirm
from MS i press 1 and send to USSD
USSD replay enter you Facebook ID
while i am typing my Facebook ID its not waiting for some more secounds its disconnecting after 45 secound before i complete my ID.</p>

<p>our USSD team is saying that they have increased this time to 2 minutes. our HLR/MSC and STP teams are saying we don't have timer for this. </p>

<p>{{{{{{Mobile Station====&gt; ((MSC=TTL=63)SPC=5300)====&gt;((STP=TTL=255)SPC=7100 or 7200)====&gt;((HLR=TTL=62)SPC=5001)====&gt;((STP=TTL=255)====&gt;(USSD=SPC=5252)}}}}}}</p>

<pre><code>                               on the revert path
</code></pre>

<p>{{{{{(USSD=TTL=62)====&gt;(STP=TTL=255)====&gt;(HLR=TTL=62)====&gt;STP=TTL=255)====&gt;MSC=-------===&gt;Mobile </p>

<p>there are many different packets in one transaction
i don't know how to describe it, i attached an snapshoot of sorting the trace by time on the image place of YOUR ANSWER box.</p></div>
            <div class="comment-info" id="comment-22360-info">
                
                
                
                

                

                <span class="comment-age">(26 Jun '13, 07:25)</span>
                <a class="comment-user userinfo" href="/users/5176/hafiz">Hafiz</a>
                
            </div>
        </div>
    
        <a name="22382"></a>
        <div class="comment not_top_scorer" id="comment-22382">
            <div id="post-22382-score" class="comment-score"></div>
            <div class="comment-text"><p>also, note that ICMP embeds the original packet <em>inside</em> the ICMP data.  So the IP address that you see in Wireshark is the actual device that sent you the ICMP type 11 code 0 (TTL Exceeded) message.  So it's pretty easy to figure out who sent you the error message and why.  It has nothing to do with your problem, and Sake (syn-bit) already explained some of this for you.  But in case others are wondering, ICMP's ability to embed the original pkt header can be quite useful.</p></div>
            <div class="comment-info" id="comment-22382-info">
                
                
                
                

                

                <span class="comment-age">(26 Jun '13, 19:21)</span>
                <a class="comment-user userinfo" href="/users/255/hansangb">hansangb</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-22342" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 6
        </span>
        <a href="#" class="show-all-comments-link">show 1 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-22342-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="22383"></a>
                    <div id="answer-container-22383" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-22383-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/22383/up/" rel="nofollow"> </a>
<div id="post-22383-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-22383-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/22383/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>National laws may vary, but those are public point codes in that trace file and you have subscriber IMSIs in there, including their mobility procedures and an SMS delivery. That includes SMS text payload, which looks like it might be clear-text though it doesn't decode well into this alphabet. I just want you to be very aware of that before proceeding further  - Since you're including all TCAP transactions within a given IP packet toward an STP in that trace (even if you're just searching for the one subscriber), you are including all of your IN traffic, your SMSC signaling and potentially sensitive/compromising data for the carrier and subscribers.</p>
<p>Having said that, a couple things to be clarified:
The path you have drawn is not the path of any single routed IP packet, but rather they are paths that individual signaling messages in a call flow will take between the systems you are talking about, as SYN-Bit correctly surmised. Since this is SS7 over IP, you may be routing at a point code or GT level but the SS7 messages that the STP is routing are going to get their own separate IP packets. Between end points in each M3UA association there is a new IP packet, from this perspective. Also there is a separate IP packet between RNC/BSC and MSC  (RANAP packet), and between base station and RNC/BSC (NBAP packet), each carrying this same USSD/NAS message along its way. Different IP packet, different TTL.</p>
<p>So now, finally, for your actual signaling problem :)</p>
<p>We can see in the trace that the USSD message got routed across the STP just fine and got sent to HLR. The invoke goes through and gets a response. The problem is that the return at packet 17 for TCAP transaction 0003bc30 (this USSD invoke) is a return error, with code 34 (System Failure). Therefor the question is:</p>
<ul>
<li>Why does the HLR with point code 5001 return the USSD invoke with error 34 (System Failure)? I'm guessing the 60 seconds it takes between invoke and return has something to do with it (timeout between HLR and USSD system)? The problem seems to be between HLR and USSD which doesn't appear in that trace file as far as I can tell.</li>
</ul>
<p>My suggestion is to step back from the noise in that trace file and focus here on packets 14 and 17, where the invoke is sent to HLR, it receives it, waits 60 seconds, then returns the error. So, focus on the content of TCAP transaction 0003bc30 ("tcap.tid == 00:03:bc:30" filter in Wireshark) and why it failed.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/22383/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>26 Jun '13, 20:46</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f533c5f20f9c9afbf4b03de08a100e11?s=32&amp;d=identicon&amp;r=g" alt="Quadratic's gravatar image" />
    <p><a href="/users/4985/quadratic">Quadratic</a><br/>
    <span class="score" title="1885 reputation points"><span class="">1.9k</span></span><span title="6 badges"><span class="badge1">&#9679;</span><span class="badgecount">6</span></span><span title="9 badges"><span class="silver">&#9679;</span><span class="badgecount">9</span></span><span title="28 badges"><span class="bronze">&#9679;</span><span class="badgecount">28</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Quadratic has 23 accepted answers">13&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/22383/">
                edited
                <strong>26 Jun '13, 21:03</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-22383">
    
        <a name="22392"></a>
        <div class="comment" id="comment-22392">
            <div id="post-22392-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks Sir Quadratic and All,</p>

<p>actually the packet follows are correct i don't have complain.the issue is that while i am typing my Facebook ID on the screen of phone the connection shuld waite utill to i sumit my Facebook ID, but my connection intrupting after 45 second before to i submit my Facebook ID.</p>

<p>And as i check on the trace the release starting from Mobile phone not any other network node.</p>

<p>if you kindly tell me that do we can change TTL value in any kindly of Platforms?</p>

<p>Best Regards,</p>

<p>Hafiz</p></div>
            <div class="comment-info" id="comment-22392-info">
                
                
                
                

                

                <span class="comment-age">(26 Jun '13, 23:51)</span>
                <a class="comment-user userinfo" href="/users/5176/hafiz">Hafiz</a>
                
            </div>
        </div>
    
        <a name="22400"></a>
        <div class="comment" id="comment-22400">
            <div id="post-22400-score" class="comment-score"></div>
            <div class="comment-text"><p>Look at TCAP transaction 0003BC30 in packet number 17 in the trace file. In that message, we see a return on the USSD transaction after 60 seconds with a return error for system failure. Compare with the transaction of the same number in packet 14 and see that the error was indeed a response for the USSD invoke, so in my mind you have a clear error returned by HLR after a 60 second timeout. In that call flow, HLR should be sending to your USSD system at that point but tht is not in the trace file.</p>

<p>For TTL, I really think you're looking at the wrong thing here. If there was an issue with IP TTL, you'd see it decrement down to 1 and you would not see a return message sent in response to your invokes between MSC and HLR. The fact that you see the SS7 routing between point codes proves that each IP packet is being sent and received correctly between MsC and zsTP, and between STP and HLR.</p>

<p>For the MS-initiated release you're talking about, what protocol are you referring to? For sure the user device will eventually release RRC control and time out at the NAS layer if it has to (in this case) wait a whole minute and not see anything, but the question at hand is why you see a 60-second delay between invoke and return, why the return is system failure and really what is happening between HLR and USSD system. Why do you believe there is any TTL problem, or IP level problem at all? Is there any request not responded to at MAP level? It does not appear so in that trace.</p></div>
            <div class="comment-info" id="comment-22400-info">
                
                
                
                

                

                <span class="comment-age">(27 Jun '13, 03:41)</span>
                <a class="comment-user userinfo" href="/users/4985/quadratic">Quadratic</a>
                
            </div>
        </div>
    
        <a name="22479"></a>
        <div class="comment" id="comment-22479">
            <div id="post-22479-score" class="comment-score"></div>
            <div class="comment-text"><p>I am very sorry, that i did not provide all details at first. On the previous trace it was really correct that HLR send Error 
toward USSD and we took a wireshark trace from HLR there we saw that error is coming from MS and we took a trace from MSC
its format is different i couldn’t attached it to cloudshark there the error is coming from BSS side with 
(Radio Interface Failure)</p>

<p>At this point USSD team expanded the time to 2 minutes but NSS STP and HLR teams are not accepting the error on there side 
According to the traces as far as i know on BSS there is no timer. so i was thinking that TTL is any kind of timer which is 
Releasing the connection, thanks to all that cleared my mind about it specially Mr.Quadratic last comment.<br>
</p>

<p>new attached trace details</p>

<p>At packet number 10 on the TCAP message Transaction ID=08240705 show an (abort by user) from MSC while you can see the 
MSC GT (93702993007) at SCCP message above the mentioned TCAP message.</p>

<p>And on packet 3 we can see the HLR-GT(93702980007) forward the error message which is coming from MSC side toward 
USSD-GT(93702992006) and we took a trace from MSC its format is different i couldn't attached it to cloudshark. there 
Mentioned that the error is coming from BSS side with (Radio Interface Failure) Error.</p>

<p>at this point if anyone have idea about timer expansion on NSN MSC, Hwawei STP, and NSN HLR or BSS kindly help and comment.</p>

<p><a href="http://www.cloudshark.org/captures/da0a025d550d">http://www.cloudshark.org/captures/da0a025d550d</a></p>

<p>Best Regards,</p>

<p>Hafiz</p></div>
            <div class="comment-info" id="comment-22479-info">
                
                
                
                

                

                <span class="comment-age">(29 Jun '13, 22:52)</span>
                <a class="comment-user userinfo" href="/users/5176/hafiz">Hafiz</a>
                
            </div>
        </div>
    
        <a name="22489"></a>
        <div class="comment" id="comment-22489">
            <div id="post-22489-score" class="comment-score"></div>
            <div class="comment-text"><p>Ah, I see thanks for clearing that up. If the system failure in the trace is being caused by MS-initiated abort then it sounds to me like something that needs to be handled at the USSD application level. While the systems in this call flow can have timeout timers at a TCAP transaction level, and at a MAP level for invoke/return exchanges, the end-to-end session would be controlled by the USSD application at the MS and USSD gateway.</p>

<p>Is the device timing out at a USSD level? The RRC connection on the radio side is also stateful (thus could potentially time out), as would the MS' mobility state with the serving MSC technically, but really this sounds like a USSD, application-specific timer problem.</p>

<p>Also for the final question on TTL, the IP protocol itself is stateless. There is no "session" at an IP level and no timer that can expire.</p></div>
            <div class="comment-info" id="comment-22489-info">
                
                
                
                

                

                <span class="comment-age">(30 Jun '13, 13:03)</span>
                <a class="comment-user userinfo" href="/users/4985/quadratic">Quadratic</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-22383" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-22383-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/22337/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='mHMg5WKF7M4JBASCAlJSONB0vbHAZTsq' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/22337/ttl-time-to-live?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/22337/ttl-time-to-live?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/ip/"
            class="tag-link-ip"
            title="see questions tagged'ip'using tags"
            rel="tag">ip</a> <span class="tag-number">&#215;178</span><br/>
        
        <a href="/tags/ttl/"
            class="tag-link-ttl"
            title="see questions tagged'ttl'using tags"
            rel="tag">ttl</a> <span class="tag-number">&#215;7</span><br/>
        
    </p>
    <p>
        question asked: <strong title="June 25, 2013, 8:24 p.m.">25 Jun '13, 20:24</strong>
    </p>
    <p> 
     	question was seen: <strong>65,662 times</strong>
    </p>
    <p> 
        last updated: <strong title="June 30, 2013, 1:03 p.m.">30 Jun '13, 13:03</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/18176/how-routers-handle-ipv4-ttl-value-0">How routers handle IPv4 TTL value 0</a>
        </p>
        
        <p>
            <a href="/questions/1194/scan-certain-network-or-ip">Scan certain network or IP</a>
        </p>
        
        <p>
            <a href="/questions/7822/i-can-only-see-limited-ip-addresses">I can only see limited IP addresses</a>
        </p>
        
        <p>
            <a href="/questions/9723/capture-an-ip-inside-a-gre-packet">Capture an IP inside a GRE packet</a>
        </p>
        
        <p>
            <a href="/questions/15106/how-do-i-see-traffic-to-and-from-a-machine">How do I see traffic to and from a machine?</a>
        </p>
        
        <p>
            <a href="/questions/20151/view-menu-name-resolution-resolve-name-doesnt-seem-to-work">&quot;View Menu &gt; Name Resolution &gt; Resolve Name&quot; doesn&#39;t seem to work</a>
        </p>
        
        <p>
            <a href="/questions/24547/text2pcap-addmodify-ip-address-by-default-it-keeps-dummy-headerexisting-ip-address">text2Pcap :- add/modify ip address. by default it keeps dummy header/existing ip address.</a>
        </p>
        
        <p>
            <a href="/questions/31218/finding-an-rogue-ip-address">Finding an rogue IP address</a>
        </p>
        
        <p>
            <a href="/questions/37680/can-wireshark-automatically-resolve-the-ip-address-into-host-names">Can Wireshark automatically resolve the IP address into host names?</a>
        </p>
        
        <p>
            <a href="/questions/45795/attedance-machine">attedance machine</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
