<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Live capture Using pipes - Wireshark Q&amp;A</title>
        <meta name="description" content="How to setup Wireshark to capture Live packets thrown to Pipe. Currently Only once packet can be captured on Wireshark using Named Pipes. I want to setup like Whenever I through Packets to Pipe, it should be shown in queue in Wireshark. So that it feels like Live capturing from Pipes. -Ankit" />
        <meta name="keywords" content="pipe,pcapng,pcap,pcap_open_live,wireshark" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/45693/live-capture-using-pipes" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/45693/live-capture-using-pipes?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='HN19QjduBaJeSgTLLHAgZwkjFmhmLSYy' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/45693/live-capture-using-pipes">Live capture Using pipes</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-45693-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/45693/up/" rel="nofollow"> </a>
<div id="post-45693-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-45693-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/45693/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/45693/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   1
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>How to setup Wireshark to capture Live packets thrown to Pipe. Currently Only once packet can be captured on Wireshark using Named Pipes. I want to setup like Whenever I through Packets to Pipe, it should be shown in queue in Wireshark. So that it feels like Live capturing from Pipes.</p>
<p>-Ankit</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/pipe/" class="post-tag tag-link-pipe"
                                        title="see questions tagged 'pipe'" rel="tag">pipe</a>
                                
                                    <a href="/tags/pcapng/" class="post-tag tag-link-pcapng"
                                        title="see questions tagged 'pcapng'" rel="tag">pcapng</a>
                                
                                    <a href="/tags/pcap/" class="post-tag tag-link-pcap"
                                        title="see questions tagged 'pcap'" rel="tag">pcap</a>
                                
                                    <a href="/tags/pcap_open_live/" class="post-tag tag-link-pcap_open_live"
                                        title="see questions tagged 'pcap_open_live'" rel="tag">pcap_open_live</a>
                                
                                    <a href="/tags/wireshark/" class="post-tag tag-link-wireshark"
                                        title="see questions tagged 'wireshark'" rel="tag">wireshark</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>07 Sep '15, 23:42</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/e172d561cbb66f3dbeb3ed34d6bbf694?s=32&amp;d=identicon&amp;r=g" alt="Ankit%20Patel's gravatar image" />
    <p><a href="/users/19507/ankit-patel">Ankit Patel</a><br/>
    <span class="score" title="36 reputation points">36</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="5 badges"><span class="bronze">&#9679;</span><span class="badgecount">5</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Ankit Patel has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-45693">
    
        <a name="45697"></a>
        <div class="comment" id="comment-45697">
            <div id="post-45697-score" class="comment-score"></div>
            <div class="comment-text"><p>sounds like named pipes are not what you want. Can you please add your definition of "pipe" and how you would like to start Wireshark (CLI example)?</p></div>
            <div class="comment-info" id="comment-45697-info">
                
                
                
                

                

                <span class="comment-age">(08 Sep '15, 05:08)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="45720"></a>
        <div class="comment" id="comment-45720">
            <div id="post-45720-score" class="comment-score"></div>
            <div class="comment-text"><p>On Manage Interface selection I am creating new pipe @ /tmp/myfifo and then start capture on that.
Meanwhile throwing .pcap file onto that Pipe i.e. cat ip_packet.pcap &gt; /tmp/myfifo</p>

<p>Now Wireshark captures this file and shows onto GUI. </p>

<p>If I send another .pcap file onto that pipe then it won't show on GUI. I have to restart capture then only it displays received packet on pipe. </p>

<p>I have to create one application which throws packets and Wireshark captures packets and monitors continuously. Is this Possible?</p>

<p>-Ankit</p></div>
            <div class="comment-info" id="comment-45720-info">
                
                
                
                

                

                <span class="comment-age">(08 Sep '15, 21:29)</span>
                <a class="comment-user userinfo" href="/users/19507/ankit-patel">Ankit Patel</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-45693" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-45693-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/45693/live-capture-using-pipes?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/45693/live-capture-using-pipes?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/45693/live-capture-using-pipes?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/45693/live-capture-using-pipes?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="45722"></a>
                    <div id="answer-container-45722" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-45722-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/45722/up/" rel="nofollow"> </a>
<div id="post-45722-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-45722-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/45722/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <blockquote>
<p>If I send another .pcap file onto that pipe then it won't show on GUI. </p>
</blockquote>
<p>If Wireshark reads from a named pipe, it expects the same file structure as it would find in a pcap file, meaning pcap header, then captured frames. So, if you write the pcap file to the named pipe in the first step, it will work. When you cat another pcap file to the named pipe, it won't work as Wireshark does not expect to see a second pcap file header.</p>
<p>So, if you want to 'throw' several pcap files at Wireshark through a named pipe, your program needs to read the pcap files and 'throw' only the captured frames to the named pipe together with a valid pcap file header in the first step.</p>
<p>Regards <br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/45722/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>08 Sep '15, 22:25</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-45722">
    
        <a name="45723"></a>
        <div class="comment" id="comment-45723">
            <div id="post-45723-score" class="comment-score"></div>
            <div class="comment-text"><p>So in Live Capture mode, if 1000 packets received from LAN then Wireshark creates 1000 times pcap file with modified Header?</p></div>
            <div class="comment-info" id="comment-45723-info">
                
                
                
                

                

                <span class="comment-age">(08 Sep '15, 22:32)</span>
                <a class="comment-user userinfo" href="/users/19507/ankit-patel">Ankit Patel</a>
                
            </div>
        </div>
    
        <a name="45724"></a>
        <div class="comment" id="comment-45724">
            <div id="post-45724-score" class="comment-score"></div>
            <div class="comment-text"><p>No. If Wireshark captures from a network interface it does <em>not<strong> expect a pcap </strong>file structure</em>* as there won't be one. Instead it reads the frames from the network interface and stores it in memory and/or a temp file. As soon as you tell Wireshark to save the captured frames, it will write a pcap file with the appropriate file structure to store the captured frames.</p></div>
            <div class="comment-info" id="comment-45724-info">
                
                
                
                

                

                <span class="comment-age">(08 Sep '15, 22:36)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="45726"></a>
        <div class="comment" id="comment-45726">
            <div id="post-45726-score" class="comment-score">1</div>
            <div class="comment-text"><p>But How Wireshark shows live capture? Previously you mentioned that Wireshark expects pcap files to display onto GUI</p></div>
            <div class="comment-info" id="comment-45726-info">
                
                
                
                

                

                <span class="comment-age">(08 Sep '15, 22:42)</span>
                <a class="comment-user userinfo" href="/users/19507/ankit-patel">Ankit Patel</a>
                
            </div>
        </div>
    
        <a name="45727"></a>
        <div class="comment not_top_scorer" id="comment-45727">
            <div id="post-45727-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>But How Wireshark shows live capture?</p>
</blockquote>

<p>??? Please elaborate! </p>

<p>If Wireshark captures the frames, where would you see a problem to show them in the GUI?</p></div>
            <div class="comment-info" id="comment-45727-info">
                
                
                
                

                

                <span class="comment-age">(08 Sep '15, 23:07)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="45729"></a>
        <div class="comment not_top_scorer" id="comment-45729">
            <div id="post-45729-score" class="comment-score"></div>
            <div class="comment-text"><p>While capturing from eth0. Wireshark shows live packet capture.As it receives packet it displays it. 
I need to create same scenario using pipe. As it captures packet it should be appended in display in Wireshark.</p></div>
            <div class="comment-info" id="comment-45729-info">
                
                
                
                

                

                <span class="comment-age">(08 Sep '15, 23:58)</span>
                <a class="comment-user userinfo" href="/users/19507/ankit-patel">Ankit Patel</a>
                
            </div>
        </div>
    
        <a name="45730"></a>
        <div class="comment not_top_scorer" id="comment-45730">
            <div id="post-45730-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>As it captures packet it should be appended in display in Wireshark</p>
</blockquote>

<p>if you want to <strong>capture</strong> from a named pipe, run:</p>

<blockquote>
<p>wireshark -ni /tmp/pipe -k </p>
</blockquote>

<p>Then write a <strong>valid</strong> data structure to /tmp/pipe, meaning only frames as they would appear on eth0</p>

<p>if you want to <strong>read</strong> a capture file from a named pipe, run:</p>

<blockquote>
<p>wireshark -nr /tmp/pipe</p>
</blockquote>

<p>Then write a <strong>valid</strong> data structure to /tmp/pipe, meaning a valid pcap file.</p></div>
            <div class="comment-info" id="comment-45730-info">
                
                
                
                

                

                <span class="comment-age">(09 Sep '15, 00:31)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="45734"></a>
        <div class="comment not_top_scorer" id="comment-45734">
            <div id="post-45734-score" class="comment-score"></div>
            <div class="comment-text"><p>So here is the question,</p>

<p>I need to create one application which sends IP packets with some time interval. Wireshark should be able to capture IP packets and display it. Wireshark displays one packet as it received and poll for another packet as it receives another packet, it displays in second raw and then third and so on. </p>

<p>Now Wireshark only accepts pcap formats onto pipe I need to generate pcap of first IP packet and send it to created PIPE. After that I need to create another pcap file with two IP packets(One previous and one current) and send it to wireshark. </p>

<p>What I am facing is Wireshark reads first pcap file but then for second file, I need to restart the capture manually. Is it possible to set autorestart after receiving packets from pipe?</p></div>
            <div class="comment-info" id="comment-45734-info">
                
                
                
                

                

                <span class="comment-age">(09 Sep '15, 02:44)</span>
                <a class="comment-user userinfo" href="/users/19507/ankit-patel">Ankit Patel</a>
                
            </div>
        </div>
    
        <a name="45737"></a>
        <div class="comment not_top_scorer" id="comment-45737">
            <div id="post-45737-score" class="comment-score"></div>
            <div class="comment-text"><p>Have you tried sending the libpcap global header first and then each packet independently with its own packet header (as seen in <a href="https://wiki.wireshark.org/Development/LibpcapFileFormat).">https://wiki.wireshark.org/Development/LibpcapFileFormat).</a>
I do not understand why you claim that you would need to create new pcap files for each dumped packet (containing previous an new packets).
To summarize: when creating the pipe, try sending once the global header and then send each packet with its own packet header. It should work fine.</p></div>
            <div class="comment-info" id="comment-45737-info">
                
                
                
                

                

                <span class="comment-age">(09 Sep '15, 06:16)</span>
                <a class="comment-user userinfo" href="/users/1538/pascal-quantin">Pascal Quantin</a>
                
            </div>
        </div>
    
        <a name="45745"></a>
        <div class="comment not_top_scorer" id="comment-45745">
            <div id="post-45745-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes I tried to send Global header using Pipe. It shows error message like "No packets captured! As no data was captured, closing the temporary capture file!" </p>

<p>If I send file which includes Global header and 1 packet header followed by data then it works. But another packets it won't capture.</p>

<p>I think Wireshark close the pipe as soon as something has captured.
Wireshark dosen't continuously polls for the next packet from the Pipe.</p></div>
            <div class="comment-info" id="comment-45745-info">
                
                
                
                

                

                <span class="comment-age">(10 Sep '15, 01:27)</span>
                <a class="comment-user userinfo" href="/users/19507/ankit-patel">Ankit Patel</a>
                
            </div>
        </div>
    
        <a name="45772"></a>
        <div class="comment not_top_scorer" id="comment-45772">
            <div id="post-45772-score" class="comment-score"></div>
            <div class="comment-text"><p>can you please post some information about your code or the way you tried to write the pcap header to the pipe and <strong>how</strong> you started Wireshark (with -r or -i)!?!</p></div>
            <div class="comment-info" id="comment-45772-info">
                
                
                
                

                

                <span class="comment-age">(10 Sep '15, 18:33)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="45774"></a>
        <div class="comment not_top_scorer" id="comment-45774">
            <div id="post-45774-score" class="comment-score"></div>
            <div class="comment-text"><p>Using below command to start capturing from Pipe
wireshark -ni /tmp/myfifo -k</p>

<p>Sending pcap header to the pipe using below command
cat global_header.pcap &gt; /tmp/myfifo</p>

<p>Wireshark gives error on receiving Global Header file</p>

<p>If I send pcap file which contains Global Header + Packet Header + Packet data then it captures properly.
cat packet_with_global_header.pcap &gt; /tmp/myfifo</p>

<p>But I want to send another packet without restarting wireshark capture
i.e. cat another_packet.pcap &gt; /tmp/myfifo
and wireshark should capture another packet and displays in the packet queue. but wireshark dosen't do anything. It requires start new capture.</p></div>
            <div class="comment-info" id="comment-45774-info">
                
                
                
                

                

                <span class="comment-age">(10 Sep '15, 21:53)</span>
                <a class="comment-user userinfo" href="/users/19507/ankit-patel">Ankit Patel</a>
                
            </div>
        </div>
    
        <a name="45798"></a>
        <div class="comment not_top_scorer" id="comment-45798">
            <div id="post-45798-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>But I want to send another packet without restarting wireshark capture i.e. cat another_packet.pcap</p>
</blockquote>

<p>O.K. again, as you might have missed the point. If you <strong>cat</strong> another pcap to the same named pipe, you are <strong>NOT</strong> just sending another packet, you are sending <strong>another pcap</strong> file, including headers, etc. This will not work!</p></div>
            <div class="comment-info" id="comment-45798-info">
                
                
                
                

                

                <span class="comment-age">(11 Sep '15, 14:05)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="45822"></a>
        <div class="comment" id="comment-45822">
            <div id="post-45822-score" class="comment-score">3</div>
            <div class="comment-text"><p>Ankit,</p>

<p>for continuous run, your application must not use "cat" to send packets to the pipe (regardless whether the Global Header would be sent before the packet), it must act as a pipe server completely.</p>

<p>Wireshark does not close (or, better, does not stop reading) the pipe as soon as it receives something; it stops reading the pipe as soon as the sending side disconnects from the pipe, which is what happens when the "cat" finishes sending the file.</p>

<p>With each press of "start capture", Wireshark connects to the named pipe as its client and expects to receive the Global Header first of all and only once. Next, it processes all the packets (Packet Header followed by Packet data) as they come and appends them to the running capture, until:</p>

<p>a) the server disconnects from the pipe,<br>
b) you press the "stop capture" button - in this case, Wireshark disconnects from the pipe.</p>

<p>So for continuous run of the capture, your application must:<br>
1) create the pipe (or connect to existing one as server),<br>
2) wait (and trash eventual packets to be sent) until the pipe indicates that a client is connected (using some pipe-&gt;State function),<br>
3) send the Global Header once (using some pipe-&gt;Write function, NOT using cat)<br>
4) send packets (Packet Header followed by Packet data) using pipe-&gt;Write<br>
</p>

<p>Unless you expect all that to run forever, the application should check that a client is still connected before sending each packet. When a client disconnects (because you have stopped the capture), the application may either end or get back to step 2).</p>

<p>HTH,
Pavel</p></div>
            <div class="comment-info" id="comment-45822-info">
                
                
                
                

                

                <span class="comment-age">(13 Sep '15, 04:49)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="45844"></a>
        <div class="comment not_top_scorer" id="comment-45844">
            <div id="post-45844-score" class="comment-score"></div>
            <div class="comment-text"><p>Sindy,</p>

<p><strong>3) send the Global Header once (using some pipe-&gt;Write function, NOT using cat)</strong></p>

<p>Folllowed steps as suggested by you but as soon as I wrote Global Header onto that pipe using pipe write method, Wireshark stops capturing of packet and shows
"No packets captured! As no data was captured, closing the temporary capture file"</p></div>
            <div class="comment-info" id="comment-45844-info">
                
                
                
                

                

                <span class="comment-age">(15 Sep '15, 02:18)</span>
                <a class="comment-user userinfo" href="/users/19507/ankit-patel">Ankit Patel</a>
                
            </div>
        </div>
    
        <a name="45858"></a>
        <div class="comment not_top_scorer" id="comment-45858">
            <div id="post-45858-score" class="comment-score"></div>
            <div class="comment-text"><p>If not done yet, I suggest you to have a look at <a href="https://wiki.wireshark.org/CaptureSetup/Pipes">https://wiki.wireshark.org/CaptureSetup/Pipes</a></p>

<p>Given what you describe, it gives the feeling that you are closing the pipe after writing the global header. But without knowing more about what you are really doing, it's hard to tell more.</p></div>
            <div class="comment-info" id="comment-45858-info">
                
                
                
                

                

                <span class="comment-age">(15 Sep '15, 09:26)</span>
                <a class="comment-user userinfo" href="/users/1538/pascal-quantin">Pascal Quantin</a>
                
            </div>
        </div>
    
        <a name="45860"></a>
        <div class="comment" id="comment-45860">
            <div id="post-45860-score" class="comment-score">1</div>
            <div class="comment-text"><p>Ankit,</p>

<p>not knowing the OS &amp; programming language you use but using my own (fresh and limited) experience with the subject, and after reading again what you wrote so far, I dare to follow Pascal's general suspicion to a more specific one - that you use pipe-&gt;Write function but terminate the application after sending the Global Header (and possibly the first packet). And when the time comes to forge the next packet, you run your application again. However, an inevitable consequence of termination of the application is its disconnection from the pipe, as the application's next run will be a new process with a new PID. Am I right?</p>

<p>If I am wrong and your application runs continuously but despite that Wireshark stops capturing after receiving the first packet, could you post the code (maybe leaving out the packet contents construction but definitely including the startup and shutdown of the application)?</p>

<p>Pascal,</p>

<p>the wiki page you've suggested is misleading in one significant point - if I get it right, as of now Wireshark does NOT accept pcap-ng through a pipe. I've crashed my mouth on that a few days ago (using last stable which is 1.12.7), as I was looking for other cause of the trouble until I've found somewhere else that still only pcap is accepted.</p>

<p>Also the example with cat of a pcap file into the pipe may be misleading for people (like me and possibly Ankit) who are not aware of the fact that Wireshark watches the state of the sending end of the pipe and stops capturing when the source application disconnects from or even deletes the pipe. I too have expected that the pipe exists independently of the sender application and that Wireshark would keep listening to the pipe until manual stop of the capture, regardless what happens on the sending end.</p>

<p>I don't feel qualified enough to edit that page, but if you do, could you make it more correct (pcap-ng) and more detailed (pipe tracking), please?</p>

<p>Merci
P.</p></div>
            <div class="comment-info" id="comment-45860-info">
                
                
                
                

                

                <span class="comment-age">(15 Sep '15, 13:30)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="45870"></a>
        <div class="comment not_top_scorer" id="comment-45870">
            <div id="post-45870-score" class="comment-score"></div>
            <div class="comment-text"><p>Sindy,</p>

<p>Yes you are correct. I am terminating my code and that was the reason of pipe disconnection. Now I am able to send continuously Packets using pipe.</p>

<p>Thanks..</p></div>
            <div class="comment-info" id="comment-45870-info">
                
                
                
                

                

                <span class="comment-age">(15 Sep '15, 22:14)</span>
                <a class="comment-user userinfo" href="/users/19507/ankit-patel">Ankit Patel</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-45722" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 17
        </span>
        <a href="#" class="show-all-comments-link">show 12 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-45722-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/45693/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='HN19QjduBaJeSgTLLHAgZwkjFmhmLSYy' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/45693/live-capture-using-pipes?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/45693/live-capture-using-pipes?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/wireshark/"
            class="tag-link-wireshark"
            title="see questions tagged'wireshark'using tags"
            rel="tag">wireshark</a> <span class="tag-number">&#215;1,620</span><br/>
        
        <a href="/tags/pcap/"
            class="tag-link-pcap"
            title="see questions tagged'pcap'using tags"
            rel="tag">pcap</a> <span class="tag-number">&#215;238</span><br/>
        
        <a href="/tags/pipe/"
            class="tag-link-pipe"
            title="see questions tagged'pipe'using tags"
            rel="tag">pipe</a> <span class="tag-number">&#215;37</span><br/>
        
        <a href="/tags/pcapng/"
            class="tag-link-pcapng"
            title="see questions tagged'pcapng'using tags"
            rel="tag">pcapng</a> <span class="tag-number">&#215;36</span><br/>
        
        <a href="/tags/pcap_open_live/"
            class="tag-link-pcap_open_live"
            title="see questions tagged'pcap_open_live'using tags"
            rel="tag">pcap_open_live</a> <span class="tag-number">&#215;2</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Sept. 7, 2015, 11:42 p.m.">07 Sep '15, 23:42</strong>
    </p>
    <p> 
     	question was seen: <strong>6,950 times</strong>
    </p>
    <p> 
        last updated: <strong title="Sept. 15, 2015, 10:14 p.m.">15 Sep '15, 22:14</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/41197/how-to-analyze-pcap-files-for-slow-internet-communication">How to analyze pcap files for slow internet communication</a>
        </p>
        
        <p>
            <a href="/questions/35581/unexpected-error-while-starting-traces">Unexpected error while starting traces</a>
        </p>
        
        <p>
            <a href="/questions/43194/how-to-output-wireshark-captures-to-a-new-file">how to output wireshark captures to a new file ?</a>
        </p>
        
        <p>
            <a href="/questions/52573/pipe-tcpdump-from-two-machines-to-wireshark-in-my-local-machine">Pipe tcpdump from two machines to wireshark in my local machine</a>
        </p>
        
        <p>
            <a href="/questions/9080/implementing-autostop-condition-on-packet-capture">implementing autostop condition on packet capture!</a>
        </p>
        
        <p>
            <a href="/questions/13023/filter-multiple-ips">Filter multiple IPs</a>
        </p>
        
        <p>
            <a href="/questions/31378/sniffing-packets-from-mobile-devices-what-wifi-card-to-use">Sniffing packets from mobile devices, what wifi card to use?</a>
        </p>
        
        <p>
            <a href="/questions/32357/difference-between-ppp-pcap-files">Difference between .PPP &amp; .PCAP files ?</a>
        </p>
        
        <p>
            <a href="/questions/40989/after-converting-pcap-to-text-i-want-only-data-part-in-text-file-how-can-i-do-that">After converting pcap to text , I want only data part in text file how can i do that?</a>
        </p>
        
        <p>
            <a href="/questions/54152/how-do-i-create-a-pcap-file-where-the-mac-appears">¿How do I create a PCAP file where the MAC appears?</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
