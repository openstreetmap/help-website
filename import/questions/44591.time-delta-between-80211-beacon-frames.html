<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Time delta between 802.11 beacon frames - Wireshark Q&amp;A</title>
        <meta name="description" content="Hi, I am currently inspecting 802.11 beacon frames captured by tcpdump. There are two timestamps associated with each beacon frame. The first one is the timestamp embedded in the beacon frame which represents the time the beacon was sent. The second one is the local timestamp that tcpdump tags the r..." />
        <meta name="keywords" content="timestamp,beacon,802.11,radiotap" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/44591/time-delta-between-80211-beacon-frames" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/44591/time-delta-between-80211-beacon-frames?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='iJJt5QHJ9GPh6FzdBiu74GdfeAUzpU4c' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/44591/time-delta-between-80211-beacon-frames">Time delta between 802.11 beacon frames</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-44591-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/44591/up/" rel="nofollow"> </a>
<div id="post-44591-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-44591-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/44591/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/44591/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hi,</p>
<p>I am currently inspecting 802.11 beacon frames captured by tcpdump.
There are two timestamps associated with each beacon frame.
The first one is the timestamp embedded in the beacon frame which represents the time the beacon was sent.
The second one is the local timestamp that tcpdump tags the received beacon with.</p>
<p>Now if I examine two consecutive beacons, and subtract each of the timestamps types from each other, I see a slight difference in the results.
For example, the difference between the timestamps embedded into the beacon might be 100.123 milliseconds, while the difference between the receiving sides stamps might be 100.323 milliseconds.
I am now wondering where this difference of a couple of hundred microseconds may result from.
Could it simply be the inaccuracy/drift of the two clocks at sender and receiver side?</p>
<p>Note that for capturing the packets using tcpdump, I realize there is a <strong>-j</strong> to choose timestamps generated by the host or the network adapter. I noticed this deviation in times with both <strong>-j host</strong> as well as <strong>-j adapter</strong>.</p>
<p>Thanks a lot for your help.</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/timestamp/" class="post-tag tag-link-timestamp"
                                        title="see questions tagged 'timestamp'" rel="tag">timestamp</a>
                                
                                    <a href="/tags/beacon/" class="post-tag tag-link-beacon"
                                        title="see questions tagged 'beacon'" rel="tag">beacon</a>
                                
                                    <a href="/tags/802.11/" class="post-tag tag-link-802.11"
                                        title="see questions tagged '802.11'" rel="tag">802.11</a>
                                
                                    <a href="/tags/radiotap/" class="post-tag tag-link-radiotap"
                                        title="see questions tagged 'radiotap'" rel="tag">radiotap</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>29 Jul '15, 06:51</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/8adb0a75e65ea9009dc62fe19691a03e?s=32&amp;d=identicon&amp;r=g" alt="madmax1's gravatar image" />
    <p><a href="/users/18808/madmax1">madmax1</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">&#9679;</span><span class="badgecount">4</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="madmax1 has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-44591">
    
</div>
<div id="comment-tools-44591" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-44591-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/44591/time-delta-between-80211-beacon-frames?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/44591/time-delta-between-80211-beacon-frames?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/44591/time-delta-between-80211-beacon-frames?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/44591/time-delta-between-80211-beacon-frames?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="44592"></a>
                    <div id="answer-container-44592" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-44592-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/44592/up/" rel="nofollow"> </a>
<div id="post-44592-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-44592-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/44592/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Read the following link:</p>
<p><a href="https://www.wireshark.org/lists/wireshark-dev/201203/msg00168.html">https://www.wireshark.org/lists/wireshark-dev/201203/msg00168.html</a></p>
<p>Basically you are looking at 2 different timestamps:</p>
<ol>
<li>the TSF timer value is assigned at the point "when the first bit of the MPDU [arrives] at the MAC".</li>
<li>packet time stamp is assigned to the packet at some arbitrary point between the point when it arrives at the network adapter and the point at which it's queued up for userland to read</li>
</ol>
<p>Make sense?</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/44592/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>29 Jul '15, 07:19</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d9cf592a79eafbc3b2a8b3f38cf38362?s=32&amp;d=identicon&amp;r=g" alt="Amato_C's gravatar image" />
    <p><a href="/users/3386/amato_c">Amato_C</a><br/>
    <span class="score" title="1098 reputation points"><span class="">1.1k</span></span><span title="14 badges"><span class="badge1">&#9679;</span><span class="badgecount">14</span></span><span title="20 badges"><span class="silver">&#9679;</span><span class="badgecount">20</span></span><span title="32 badges"><span class="bronze">&#9679;</span><span class="badgecount">32</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Amato_C has 15 accepted answers">14&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-44592">
    
        <a name="44593"></a>
        <div class="comment" id="comment-44593">
            <div id="post-44593-score" class="comment-score"></div>
            <div class="comment-text"><p>Hello Amato, thank you for your answer.
I realize that the values of the timestamps are not related in any way.
This is why I examine only differences between two timestamps for each type.
I am trying to figure out the reason for the deviations between those differences.
According to the tcpdump documentation, the receiver's timestamp is the time the "first bit of the packet was received", and should be highly accurate.
Do you by chance know if there might be (non-deterministic) delays between the time "first bit of the MPDU [arrives] at the MAC" and the time "the first bit of the packet enters the air"?
Thanks a lot</p></div>
            <div class="comment-info" id="comment-44593-info">
                
                
                
                

                

                <span class="comment-age">(29 Jul '15, 07:37)</span>
                <a class="comment-user userinfo" href="/users/18808/madmax1">madmax1</a>
                
            </div>
        </div>
    
        <a name="44594"></a>
        <div class="comment" id="comment-44594">
            <div id="post-44594-score" class="comment-score"></div>
            <div class="comment-text"><p>Which 2 time stamps are you examining in the packet?  Can you provide the field name, or even better, provide a sample capture?</p>

<p>You can post your sample capture on Cloudshark or Google drive.  Then we can examine the fields together.</p></div>
            <div class="comment-info" id="comment-44594-info">
                
                
                
                

                

                <span class="comment-age">(29 Jul '15, 07:58)</span>
                <a class="comment-user userinfo" href="/users/3386/amato_c">Amato_C</a>
                
            </div>
        </div>
    
        <a name="44595"></a>
        <div class="comment" id="comment-44595">
            <div id="post-44595-score" class="comment-score"></div>
            <div class="comment-text"><p>Unfortunately, I cannot share the captures files, however I uploaded screenshots of two sample packets: <a href="https://drive.google.com/folderview?id=0B_QzbEVR4w8_fmZKUzdjSWV4eDJHSGI4aDdFNWVyOF84bzJRU05qek1OblhBdGRXd3pxQTA">https://drive.google.com/folderview?id=0B_QzbEVR4w8_fmZKUzdjSWV4eDJHSGI4aDdFNWVyOF84bzJRU05qek1OblhBdGRXd3pxQTA</a>
The first two stamps I examine are the ones in wireshark's Time column, generated by "tcpdump -j adapter". the difference is 102.437 milliseconds.
The second set is the Timestamp field in the 802.11 management frame header. The difference calculates to 102.417 milliseconds.
In total, there is a 20 microseconds deviation which I am trying to find the reason for. Note that this deviation varies for different pairs of consecutive packets. Thanks!</p></div>
            <div class="comment-info" id="comment-44595-info">
                
                
                
                

                

                <span class="comment-age">(29 Jul '15, 08:33)</span>
                <a class="comment-user userinfo" href="/users/18808/madmax1">madmax1</a>
                
            </div>
        </div>
    
        <a name="44599"></a>
        <div class="comment" id="comment-44599">
            <div id="post-44599-score" class="comment-score"></div>
            <div class="comment-text"><p>The difference between the time stamps you are comparing should never be the same.  And in fact will probably always deviate between consecutive packets.  Why?  Let's examine how the time is generated for each field.</p>

<ol>
<li>
<p>Time stamp from Wireshark's time column = This time can be viewed under Frame, Epoch Time.  As stated in the link I provided above: "pcap gets the time stamp of a packet by mechanisms that return the time in UN*X format i.e. seconds and fractions of a second since January 1, 1970, 00:00:00 UTC, and the packets are, in most cases, time-stamped by the operating system's networking stack at some point in the packet's path up to userland, which could be a point after the packet arrives at the networking adapter."  So this time is the arrival time of the packet at the adapter plus the additional time to process the packet.</p>
</li>
<li>
<p>Time stamp from the 802.11 management header = This time is defined in the IEEE 802.11-2012 specification, section 10.1.3.1: "A STA sending a Beacon frame shall set the value of the Beacon frame’s timestamp so that it equals the value of the STA’s TSF timer at the time that the data symbol
containing the first bit of the timestamp is transmitted to the PHY plus the transmitting STA’s delays through its local PHY from the MAC-PHY interface to its interface with the wireless medium. So consider this the time the instance when the data hits with wireless medium (air).</p>
</li>
</ol>

<p>So why don't they equal? It takes time for the data to traverse across the air.  Remember one is the arrival time and the other is the transmitted time.</p>

<p>So why are there deviations between the consecutive packets? This could be due to a number of factors including how long it takes the receiver to process the data, if the medium was busy at the expected time of a Beacon transmission then the Beacon will be delayed (i.e., CSMA deferral)</p></div>
            <div class="comment-info" id="comment-44599-info">
                
                
                
                

                

                <span class="comment-age">(29 Jul '15, 11:06)</span>
                <a class="comment-user userinfo" href="/users/3386/amato_c">Amato_C</a>
                
            </div>
        </div>
    
        <a name="44623"></a>
        <div class="comment" id="comment-44623">
            <div id="post-44623-score" class="comment-score"></div>
            <div class="comment-text"><p>Referring to the stamp in Wireshark's time column, I don't think they are generated by the OS in my case, since I use tcpdump's '-j adapter' flag. The packets should actually be stamped by the adapter before any processing is done on the receiver's end.
I realize the stamps are still not equal, but I assume the packet's propagation time as well as PHY delays should not deviate between consecutive packets.
I also considered CSMA deferral to be the reason for the deviations, but following 802.11's definition that you gave in 2., the stamp should be done "at the time that the data symbol containing the first bit of the timestamp is transmitted to the PHY [..]", so any deferrals should already be considered in the embedded TSF value.</p></div>
            <div class="comment-info" id="comment-44623-info">
                
                
                
                

                

                <span class="comment-age">(30 Jul '15, 01:31)</span>
                <a class="comment-user userinfo" href="/users/18808/madmax1">madmax1</a>
                
            </div>
        </div>
    
        <a name="44628"></a>
        <div class="comment not_top_scorer" id="comment-44628">
            <div id="post-44628-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/18808/madmax1">@madmax1</a> = Before moving forward, I would like to have some agreement on certain points.  Please tell me if you agree.
1. The "tcpdump -j" timestamp occurs when the WiFi frame is immediately received (i.e., no processing) at the adapter.
2. The timestamp in the 802.11 management header occurs when the WiFi frame is being transmitted on the PHY.
3. The tcpdump and management header timestamps should not equal due to propagation delay.
4. The timestamp in the 802.11 management header only occurs in the following WiFi frames: Beacons, Probe Responses and Time Advertisements frames (per the 802.11 specification).
5. Neither the tcpdump timestamp nor the 802.11 management timestamp are generated by Wireshark.  The tcpdump timestamp is generated by the adapter, driver or kernel.  The 802.11 management timestamp is part of the IEEE 802.11 specification and is generated by the WiFi adapter.</p></div>
            <div class="comment-info" id="comment-44628-info">
                
                
                
                

                

                <span class="comment-age">(30 Jul '15, 05:35)</span>
                <a class="comment-user userinfo" href="/users/3386/amato_c">Amato_C</a>
                
            </div>
        </div>
    
        <a name="44642"></a>
        <div class="comment not_top_scorer" id="comment-44642">
            <div id="post-44642-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<ol>
<li>The "tcpdump -j" timestamp occurs when the WiFi frame is immediately received (i.e., no processing) at the adapter.</li>
</ol>
</blockquote>

<p>Depends on the value of the <code>-j</code> argument and whether it actually takes effect. Note that failure to take effect is a <em>warning</em>, not an <em>error</em>, so do <em>not</em> use the fact that the capture starts as an indication that the <code>-j</code> argument applies to the capture.</p></div>
            <div class="comment-info" id="comment-44642-info">
                
                
                
                

                

                <span class="comment-age">(30 Jul '15, 11:26)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-44592" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 7
        </span>
        <a href="#" class="show-all-comments-link">show 2 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-44592-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="44596"></a>
                    <div id="answer-container-44596" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-44596-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/44596/up/" rel="nofollow"> </a>
<div id="post-44596-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-44596-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/44596/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <blockquote>
<p>According to the tcpdump documentation, the receiver's timestamp is the time the "first bit of the packet was received", and should be highly accurate.</p>
</blockquote>
<p>To which tcpdump documentation are you referring here?</p>
<p>The tcpdump man page on my machine says</p>
<pre><code>   Timestamps

   By default, all output lines are preceded by a  timestamp.   The  time-
   stamp is the current clock time in the form
          hh:mm:ss.frac
   and  is  as accurate as the kernel's clock.  The timestamp reflects the
   time the kernel first saw the packet.  No attempt is  made  to  account
   for the time lag between when the Ethernet interface removed the packet
   from the wire and when the kernel serviced the `new packet'  interrupt.
</code></pre>
<p>which says nothing about it being the time the first bit of the packet was received" - it says it was "the time the kernel first saw the packet", which could be an arbitrary amount of time after the point at which the first bit of the packet was received by the hardware - as it <em>also</em> explicitly says, "No attempt is made to account for the time lag between when the Ethernet interface removed the packet from the wire and when the kernel serviced the 'new packet' interrupt." (because there's no way that tcpdump or libpcap <em>can</em> make such an attempt - the duration of that time lag simply isn't available to it!).</p>
<p>And even that's not 100% accurate - the kernel might execute some code after it sees the packet but before it applies the time stamp.</p>
<p>And, yes, there will definitely be non-deterministic delays between the time "first bit of the MPDU [arrives] at the MAC" and the time the kernel time-stamps the packet.</p>
<p>So, if you want time stamps more closely tied to the time at which the packet arrived at the adapter, you would want <code>-j adapter</code> <em>if</em> that's actually supported.  It's <em>not</em> currently supported on OSes other than Linux and, even on Linux, <code>-j adapter</code> might not be supported by the adapter if, for example, the adapter doesn't actually have a clock of its own that it can use to time-stamp packets.</p>
<p>If I run tcpdump with <code>-j adapter</code> on my Ubuntu 15.04 virtual machine, it prints:</p>
<pre><code>$ sudo tcpdump -j adapter
tcpdump: WARNING: eth0: That type of time stamp is not supported by that device

    ...
</code></pre>
<p>so the capture succeeds, <em>but</em> the time stamps are coming from the Linux kernel, not the adapter.  Make sure that, when you use <code>-j adapter</code>, you don't get a warning such as that.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/44596/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>29 Jul '15, 09:09</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" alt="Guy%20Harris's gravatar image" />
    <p><a href="/users/79/guy-harris">Guy Harris ♦♦</a><br/>
    <span class="score" title="17443 reputation points"><span class="">17.4k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">&#9679;</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">&#9679;</span><span class="badgecount">196</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Guy Harris has 216 accepted answers">19&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/44596/">
                edited
                <strong>29 Jul '15, 09:43</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-44596">
    
        <a name="44622"></a>
        <div class="comment" id="comment-44622">
            <div id="post-44622-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi Guy Harris, thanks for your answer.
I was actually referring to the pcap-tstamp(7) man page, which is referred to in the tcpdump man page. It can be found here: <a href="http://www.tcpdump.org/manpages/pcap-tstamp.7.html">http://www.tcpdump.org/manpages/pcap-tstamp.7.html</a>
It says "Some capture devices on some platforms can provide time stamps for packets; those time stamps are usually high-resolution [..] and are usually applied to the packet when the first or last bit of the packet arrives"
I also checked for the warning that you described, however my adapter seems to support providing timestamps, I am not getting this warning. It is also listed as supported timestamp type when checking for it with tcpdump -J</p></div>
            <div class="comment-info" id="comment-44622-info">
                
                
                
                

                

                <span class="comment-age">(30 Jul '15, 01:19)</span>
                <a class="comment-user userinfo" href="/users/18808/madmax1">madmax1</a>
                
            </div>
        </div>
    
        <a name="44644"></a>
        <div class="comment" id="comment-44644">
            <div id="post-44644-score" class="comment-score"></div>
            <div class="comment-text"><p>What version of the Linux kernel do you have, what version of libpcap is tcpdump using, and what type of Wi-Fi adapter are you capturing with and what driver does it use?  Older versions of the Linux kernel didn't allow userland to inquire what types of time stamping is available, so libpcap punts and says that host and adapter timestamps are available and relies on the kernel and driver to report errors - which they might not do.</p></div>
            <div class="comment-info" id="comment-44644-info">
                
                
                
                

                

                <span class="comment-age">(30 Jul '15, 12:19)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-44596" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-44596-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/44591/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='iJJt5QHJ9GPh6FzdBiu74GdfeAUzpU4c' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/44591/time-delta-between-80211-beacon-frames?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/44591/time-delta-between-80211-beacon-frames?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/802.11/"
            class="tag-link-802.11"
            title="see questions tagged'802.11'using tags"
            rel="tag">802.11</a> <span class="tag-number">&#215;114</span><br/>
        
        <a href="/tags/timestamp/"
            class="tag-link-timestamp"
            title="see questions tagged'timestamp'using tags"
            rel="tag">timestamp</a> <span class="tag-number">&#215;62</span><br/>
        
        <a href="/tags/radiotap/"
            class="tag-link-radiotap"
            title="see questions tagged'radiotap'using tags"
            rel="tag">radiotap</a> <span class="tag-number">&#215;19</span><br/>
        
        <a href="/tags/beacon/"
            class="tag-link-beacon"
            title="see questions tagged'beacon'using tags"
            rel="tag">beacon</a> <span class="tag-number">&#215;6</span><br/>
        
    </p>
    <p>
        question asked: <strong title="July 29, 2015, 6:51 a.m.">29 Jul '15, 06:51</strong>
    </p>
    <p> 
     	question was seen: <strong>5,868 times</strong>
    </p>
    <p> 
        last updated: <strong title="July 30, 2015, 12:19 p.m.">30 Jul '15, 12:19</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/1737/interpreting-channel-frequency-field-in-radiotap-header-of-80211-capture">Interpreting channel frequency field in Radiotap header of 802.11 capture</a>
        </p>
        
        <p>
            <a href="/questions/44543/how-do-i-convert-the-mac-timestamp-of-an-80211-packet-to-a-date-and-time">How do I convert the MAC timestamp of an 802.11 packet to a date and time?</a>
        </p>
        
        <p>
            <a href="/questions/45927/80211-ppi-headers-so-bad-on-os-x">802.11 PPI headers so bad on OS X</a>
        </p>
        
        <p>
            <a href="/questions/43112/link-layer-header-types-for-80211">Link Layer Header Types for 802.11</a>
        </p>
        
        <p>
            <a href="/questions/3330/get-snr-from-wlan-capture">Get SNR from WLAN capture.</a>
        </p>
        
        <p>
            <a href="/questions/18762/can-wireshark-decode-frame-type-0x2d-reserved">Can Wireshark decode frame type 0x2d (reserved)</a>
        </p>
        
        <p>
            <a href="/questions/24966/80211-channel-grayed-out-on-wireshark-1101-for-os-x">802.11 Channel grayed out on Wireshark 1.10.1 for OS X</a>
        </p>
        
        <p>
            <a href="/questions/34699/does-wireshark-support-80211v">Does Wireshark support 802.11v?</a>
        </p>
        
        <p>
            <a href="/questions/43187/wlan-throughput-analyze-using-wireshark">WLAN throughput analyze using wireshark</a>
        </p>
        
        <p>
            <a href="/questions/53562/wireshark-isnt-decrypting-my-80211-traffic">Wireshark isn&#39;t decrypting my 802.11 traffic</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
