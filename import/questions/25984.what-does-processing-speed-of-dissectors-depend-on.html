<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>What does processing speed of Dissectors depend on? - Wireshark Q&amp;A</title>
        <meta name="description" content="Hi guys, I&#39;m analyzing the processing speed of incoming data and dissector in order to know how they are different. I use the tshark command on Windows and surf Youtube to increase network speed rate : tshark -i 1 -P -w D:/sonnh.pcap -b filesize:1000 -b files:4  I change the code to print out the nu..." />
        <meta name="keywords" content="dumpcap,dissector.speed" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/25984/what-does-processing-speed-of-dissectors-depend-on" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/25984/what-does-processing-speed-of-dissectors-depend-on?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='ztONbDUWsp2d3lPB9jNJkb1XFfIDeZwk' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/25984/what-does-processing-speed-of-dissectors-depend-on">What does processing speed of Dissectors depend on?</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-25984-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/25984/up/" rel="nofollow"> </a>
<div id="post-25984-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-25984-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/25984/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/25984/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hi guys, I'm analyzing the processing speed of incoming data and dissector in order to know how they are different. I use the tshark command on Windows and surf Youtube to increase network speed rate :</p>
<pre><code>tshark -i 1 -P -w D:/sonnh.pcap -b filesize:1000 -b files:4
</code></pre>
<p>I change the code to print out the number of incoming packet (which are written to .pcap file by dumpcap) and the number of outgoing packets (which are dissected by dissector together). Note that: dumpcap doesn't write packets one by one, it captures a group of packet (e.g: 10 packet a time) and then write this group to a .pcap file, then Dissector also take a group of packet from file to dissect. As I saw in the log, the number of packet in Dumpcap group and Dissector group are different:</p>
<pre><code>    Line    Number of Incoming - Dissected packets
     1.     17:16
     2.     11:12
     3.     7:7
     4.     19:17
     5.     17:14
     6.     230:235
     7.     2012:637
     8.     89:839
     9.     2444:37
     10.        1:500
     11.        92:55
     12.        21:16
     13.        0:18
</code></pre>
<p>In theory, if tshark works well, the sum of the number of incoming and dissected packets should be identical (100% dissected, drop 0%). The difference of number of incoming packets is because of the speed of network, that is ok, nothing wrong. But I wonder why the number of dissected packets are so different from the number of incoming. As can be seen in line 1:</p>
<pre><code> Line   Number of Incoming - Dissected packets
  1.        17:16
</code></pre>
<p>There is 1 packet left are waiting for dissector and this one is dissected in the line 2:</p>
<pre><code>Line    Number of Incoming - Dissected packets
  2.        11:12
</code></pre>
<p>so, totally,the sums are identical. But in the line 9:</p>
<pre><code>Line    Number of Incoming - Dissected packets
9.              2444:37
</code></pre>
<p>The number of dissected packs is only 37 vs 2444 of incoming. It is not a real capability of Dissector because in the line 8:</p>
<pre><code>Line    Number of Incoming - Dissected packets
    8.      89:839
</code></pre>
<p>The dissector can handle 839 packets vs 89 packets of Incoming. So it means dissector is able to handle a large number of packets but why it only dissect only 37 packets in line 9. From that point, I have some questions:</p>
<ol>
<li>Why does the number of dissected packets vary in every time?</li>
<li>What does the number of dissected packets depend on? (What make the difference of number of dissected packets)</li>
<li>Why doesn't it take all incoming packets ?</li>
<li>Does this mean the processing speed of Dissectors is less than Dumpcap (i don't think so because we don't have enough evidence)? If Yes, <strong>is there any way to increase the number of dissector corresponding to the number of incoming</strong>. Sorry for asking too deep in code detail but I hope there 's someone in this forum who work as developer can help me with their experience. </li>
</ol>
<p>Please, if you are expert or just have any idea, suggestion, or experience on that, please help me to answer. Thank you so much.</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/dumpcap/" class="post-tag tag-link-dumpcap"
                                        title="see questions tagged 'dumpcap'" rel="tag">dumpcap</a>
                                
                                    <a href="/tags/dissector.speed/" class="post-tag tag-link-dissector.speed"
                                        title="see questions tagged 'dissector.speed'" rel="tag">dissector.speed</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>14 Oct '13, 19:20</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/824a7342f59ff90e6040505b38626416?s=32&amp;d=identicon&amp;r=g" alt="hoangsonk49's gravatar image" />
    <p><a href="/users/5593/hoangsonk49">hoangsonk49</a><br/>
    <span class="score" title="81 reputation points">81</span><span title="28 badges"><span class="badge1">&#9679;</span><span class="badgecount">28</span></span><span title="29 badges"><span class="silver">&#9679;</span><span class="badgecount">29</span></span><span title="33 badges"><span class="bronze">&#9679;</span><span class="badgecount">33</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="hoangsonk49 has 2 accepted answers">28&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/25984/">
                edited
                <strong>15 Oct '13, 02:54</strong>
            </a>
        </p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-25984">
    
</div>
<div id="comment-tools-25984" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-25984-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/25984/what-does-processing-speed-of-dissectors-depend-on?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/25984/what-does-processing-speed-of-dissectors-depend-on?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/25984/what-does-processing-speed-of-dissectors-depend-on?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/25984/what-does-processing-speed-of-dissectors-depend-on?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="25985"></a>
                    <div id="answer-container-25985" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-25985-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/25985/up/" rel="nofollow"> </a>
<div id="post-25985-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-25985-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/25985/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>I'm not sure your experiment is going to be useful, because you're probably getting thrown off by side effects that will have a more or less great impact on your measurements. Keep in mind that, while dumpcap is writing to file, tshark is reading that file at the same time. Meaning: you have file I/O from two processes - one is writing, one is reading, so there is going to be some serialization of who accesses the file when. Also, as you noticed, dumpcap will often buffer frames in memory and write them to disk in a bunch, which means that tshark will not be able to read them as soon as they really arrived.</p>
<p>All in all, dissecting packets may be slower than writing them to disk, but I doubt it. File I/O is usually a lot slower than in-memory processing, so I guess your test is basically a measurement of how fast your capture file is written and read again, biases by serialization of allowing access to the file.</p>
<p>Now, I'll sit and wait for Guy's answer - this is probably more in his area of expertise :-)</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/25985/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>14 Oct '13, 22:24</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" alt="Jasper's gravatar image" />
    <p><a href="/users/145/jasper">Jasper ♦♦</a><br/>
    <span class="score" title="23806 reputation points"><span class="">23.8k</span></span><span title="5 badges"><span class="badge1">&#9679;</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">&#9679;</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">&#9679;</span><span class="badgecount">284</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Jasper has 263 accepted answers">18&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/25985/">
                edited
                <strong>14 Oct '13, 22:25</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-25985">
    
        <a name="25986"></a>
        <div class="comment" id="comment-25986">
            <div id="post-25986-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi Jasper, I agree with you about </p>

<blockquote>
<p>while dumpcap is writing to file,
tshark is reading that file at the
same time</p>
</blockquote>

<p>we can consider they are doing at the same time, but actually, they have an order: write-read-write-read... at least in my experiment, I'm able to see this in the log.</p>

<blockquote>
<p>dumpcap will often buffer frames in
memory and write them to disk in a
bunch, which means that tshark will
not be able to read them as soon as
they really arrived</p>
</blockquote>

<p>In the question number 4, I also say that I don't have enough evidence to say which is faster. But it doesn't matter because my objective is not measurement. My concern is why Dissector only take a number of packet differently. For example: in the line 9, there are <strong>2444 incoming packets</strong> but Dissector takes only about <strong>37 outgoing packets</strong> to dissect even they are able to do more as they dissect <strong>839 packets</strong> in the line 8. In line 1,2, the number of packet incoming and outgoing are often similar but sometime they are too different. It makes sense to me if dumpcap write x packets into pcap, then Dissector take y packets to dissect and <strong>y = x</strong> or close to x as much as possible. I'm trying to find out what decide the number y in stead of x and how to make it close to x.
And one more question: How to start debug mode to print out g_log (both of tshark and dumpcap). Thanks</p></div>
            <div class="comment-info" id="comment-25986-info">
                
                
                
                

                

                <span class="comment-age">(14 Oct '13, 23:54)</span>
                <a class="comment-user userinfo" href="/users/5593/hoangsonk49">hoangsonk49</a>
                
            </div>
        </div>
    
        <a name="25990"></a>
        <div class="comment" id="comment-25990">
            <div id="post-25990-score" class="comment-score"></div>
            <div class="comment-text"><p>Is there any possible reason related to the pipe? Because as I check, the number of outgoing packets was read from the header of message from pipe (1 byte indicator, 3 bytes for message length)</p>

<blockquote>
<pre><code>/* convert header values */
pipe_convert_header((guchar*)header,4,indicator,&amp;required);
</code></pre>
</blockquote>

<p>--&gt; To have "required" : number of byte to read</p>

<blockquote>
<pre><code>/* read the actual block data */
newly = pipe_read_bytes(pipe_fd, msg, required, err_msg);
</code></pre>
</blockquote>

<p>--&gt; To have "msg" : value reading from "required" bytes. It is also the number of packets which are going to be dissected</p></div>
            <div class="comment-info" id="comment-25990-info">
                
                
                
                

                

                <span class="comment-age">(15 Oct '13, 03:00)</span>
                <a class="comment-user userinfo" href="/users/5593/hoangsonk49">hoangsonk49</a>
                
            </div>
        </div>
    
        <a name="26015"></a>
        <div class="comment" id="comment-26015">
            <div id="post-26015-score" class="comment-score"></div>
            <div class="comment-text"><p>Keep in mind that dumpcap only alerts tshark to there being additional packets every once in a while (every 500 msec: see the DUMPCAP_UPD_TIME macro in dumpcap.c).  So you may have times when tshark does less work than dumpcap simply because tshark is waiting for packets.  Theoretically tshark should catch up after the next time tick.</p></div>
            <div class="comment-info" id="comment-26015-info">
                
                
                
                

                

                <span class="comment-age">(15 Oct '13, 10:30)</span>
                <a class="comment-user userinfo" href="/users/655/jeffmorriss">JeffMorriss ♦</a>
                
            </div>
        </div>
    
        <a name="26037"></a>
        <div class="comment" id="comment-26037">
            <div id="post-26037-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks for your comment. As I understand,the DUMPCAP_UPD_TIME is used for non-overload slow displays. During this duration, dumpcap does nothing and wait for tshark and display, right? Now, if I don't care about what is printing on display, should I increase the DUMPCAP_UPD_TIME (for example: 750 ms or 1s) so that Dumpcap have a "longer delay" for tshark does its work. Is there any problem? Thanks.</p></div>
            <div class="comment-info" id="comment-26037-info">
                
                
                
                

                

                <span class="comment-age">(15 Oct '13, 18:55)</span>
                <a class="comment-user userinfo" href="/users/5593/hoangsonk49">hoangsonk49</a>
                
            </div>
        </div>
    
        <a name="26043"></a>
        <div class="comment" id="comment-26043">
            <div id="post-26043-score" class="comment-score"></div>
            <div class="comment-text"><p>I have just done with DUMPCAP_UPD_TIME = 1000 and DUMPCAP_UPD_TIME = 100 ms. When DUMPCAP_UPD_TIME = 1000, the number of dissecting packets increase a lot but the number of incoming packet to dumpcap each time also increase more rapidly (I use speed limiter = 2000 kB/s to make sure that the network always stabilize at speed rate ~ 2 MB/s). It also happens similarly to DUMPCAP_UPD_TIME = 1000. So totally, we still got the problem. </p>

<blockquote>
<p>So you may have times when tshark does
less work than dumpcap simply because
tshark is waiting for packets</p>
</blockquote>

<p>In the line 9: 2444 packets already written by dumpcap and THEN only 37 packets are dissected by tshark (even 2444 packets ready for dissecting and tshark does not need to wait for anything) while Dissector can dissect 839 packets as it have done in the line 8.</p></div>
            <div class="comment-info" id="comment-26043-info">
                
                
                
                

                

                <span class="comment-age">(16 Oct '13, 00:51)</span>
                <a class="comment-user userinfo" href="/users/5593/hoangsonk49">hoangsonk49</a>
                
            </div>
        </div>
    
        <a name="26061"></a>
        <div class="comment not_top_scorer" id="comment-26061">
            <div id="post-26061-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>During this duration, dumpcap does
nothing and wait for tshark and
display, right? Now, if I don't care
about what is printing on display,
should I increase the DUMPCAP_UPD_TIME
(for example: 750 ms or 1s) so that
Dumpcap have a "longer delay" for
tshark does its work.</p>
</blockquote>

<p>Actually I think you're going for the opposite: you want tshark to dissect packets as soon as they're available, right?  So there is less variability between how many packets dumpcap processes and how many tshark processes.  To do that, decrease DUMPCAP_UPD_TIME to a small number.</p></div>
            <div class="comment-info" id="comment-26061-info">
                
                
                
                

                

                <span class="comment-age">(16 Oct '13, 06:23)</span>
                <a class="comment-user userinfo" href="/users/655/jeffmorriss">JeffMorriss ♦</a>
                
            </div>
        </div>
    
        <a name="26152"></a>
        <div class="comment not_top_scorer" id="comment-26152">
            <div id="post-26152-score" class="comment-score"></div>
            <div class="comment-text"><p>I have done with 2 cases: <strong>DUMPCAP_UPD_TIME = 1000 ms</strong> and <strong>DUMPCAP_UPD_TIME = 100 ms</strong>, let 's see the difference. With <strong>DUMPCAP_UPD_TIME = 1000 ms</strong>, the number of incoming packets: (<strong>8000 ~ 19000</strong>) vs the number of outgoing packets: (<strong>1000 ~ 2000</strong>). With <strong>DUMPCAP_UPD_TIME = 100 ms</strong>, the number of incoming packets: (<strong>2000 ~ 8000</strong>) vs the number of outgoing packets: (<strong>300 ~ 50</strong>0). So,  we have a less variability between how many packets dumpcap processes and how many tshark processes, but if we focus on the percentage of outgoing packets/incoming packets, the performance might be decrease so that when we stop tshark (by using -a duration:120), only dumpcap stops while tshark is still running and the delay is still long.</p></div>
            <div class="comment-info" id="comment-26152-info">
                
                
                
                

                

                <span class="comment-age">(17 Oct '13, 19:36)</span>
                <a class="comment-user userinfo" href="/users/5593/hoangsonk49">hoangsonk49</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-25985" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 7
        </span>
        <a href="#" class="show-all-comments-link">show 2 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-25985-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="25992"></a>
                    <div id="answer-container-25992" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-25992-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/25992/up/" rel="nofollow"> </a>
<div id="post-25992-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-25992-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/25992/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <blockquote>
<p>Does this mean the processing speed of Dissectors is less than Dumpcap (i don't think so because we don't have enough evidence)?</p>
</blockquote>
<p>well, just by applying logic, I would answer: Yes</p>
<p>Reason: Both dumpcap and tshark have the same amount of I/O work (if we ignore file system caches for a while). So, that amount of time is the same (dumpcap writing data, tshark reading the same amount of data). Then tshark has <strong>a lot of additional work</strong> due to the dissection of frames. So, yes dissecting packets with tshark will always be slower than just writing the packets to disk with dumpcap. This is due to the way how dumpcap 'delivers' packets to tshark, through a file they use both. </p>
<p>Thus, I believe the specific problem you have found is a structural problem and I don't know if there is a general or an easy solution for this. There will always be situations where dumpcap will be ahead of tshark, due to the time tshark needs to dissect the frames and it gets worse the longer tshark runs, due to larger lists and hash tables tshark needs to fill, search and possibly reorganize (hash table collisions - although I did <strong>not</strong> check where exactly that might happen!!). File system caching might help, as the I/O work of tshark (reading what dumpcap just wrote) has a much lower impact than for dumpcap (writing new data), but still....</p>
<blockquote>
<p>I change the code to print out the number of incoming packet (which are written to .pcap file by dumpcap) and the number of outgoing packets (which are dissected by dissector together).</p>
</blockquote>
<p>Can you please post the code change, so we can check if the changes are appropriate to measure what you are trying to measure ;-))</p>
<p>Regards<br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/25992/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>15 Oct '13, 05:58</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/25992/">
                edited
                <strong>15 Oct '13, 07:12</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-25992">
    
        <a name="26036"></a>
        <div class="comment" id="comment-26036">
            <div id="post-26036-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>So, yes dissecting packets with tshark
will always be slower than just
writing the packets to disk with
dumpcap</p>
</blockquote>

<p>OK, I agree with you that it is logical answer. With this thought, I think it would cause a delay increasing between incoming and outgoing packets but in fact with my experiment, there is no delay and it only happens to the high speed rate incoming. That 's why I have to print out and compare the number of incoming and outgoing packets. And after seeing the log, maybe the important thing is not a processing speed, it is how Dissector takes packets to dissect. As in block quote:</p>

<pre><code>8.     89:839
 9.     2444:37
</code></pre>

<p>Why Dissector takes only 37 packets in line 9 while it is able to do more as it has just done in line 8. Now, It is not a problem of the speed, it is problem of how it decide the number of packets which are going to be dissected. If I can do as line 8, the problem could be solved.</p>

<blockquote>
<p>Can you please post the code change,
so we can check if the changes are
appropriate to measure what you are
trying to measure ;-))</p>
</blockquote>

<p>Of course, here you are. In the dumpcap.c, function capture_loop_start(), I print out:</p>

<blockquote>
<p>print_log_1(global_ld.packet_count);</p>
</blockquote>

<p>In the tshark.c , function capture_input_new_packets(), I print out:</p>

<blockquote>
<p>print_log_2(to_read,packet_count);</p>
</blockquote>

<p>Please correct me if I did something wrong. Thanks.</p></div>
            <div class="comment-info" id="comment-26036-info">
                
                
                
                

                

                <span class="comment-age">(15 Oct '13, 18:40)</span>
                <a class="comment-user userinfo" href="/users/5593/hoangsonk49">hoangsonk49</a>
                
            </div>
        </div>
    
        <a name="26067"></a>
        <div class="comment" id="comment-26067">
            <div id="post-26067-score" class="comment-score"></div>
            <div class="comment-text"><p>and what's the code of print_log_1() and print_log_2()?</p></div>
            <div class="comment-info" id="comment-26067-info">
                
                
                
                

                

                <span class="comment-age">(16 Oct '13, 07:12)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="26096"></a>
        <div class="comment" id="comment-26096">
            <div id="post-26096-score" class="comment-score"></div>
            <div class="comment-text"><p>Here is the code of print. In both of function print, we open the same file and insert new values</p>

<p>tshark.c , function capture_input_new_packets()</p>

<blockquote>
<p>fprintf(sOut,"\nTo_read: %d/%u",to_read,packet_count);</p>
</blockquote>

<p>dumpcap.c, function capture_loop_start()</p>

<blockquote>
<p>fprintf(sOut,"\nPacket_count: %u",packet_count);</p>
</blockquote>

<p>packet_count in tshark.c is an ID of the latest packet since the last processing of tshark while packet_count in dumpcap.c is an ID of the latest packet which is written into pcap by dumpcap.</p></div>
            <div class="comment-info" id="comment-26096-info">
                
                
                
                

                

                <span class="comment-age">(16 Oct '13, 18:35)</span>
                <a class="comment-user userinfo" href="/users/5593/hoangsonk49">hoangsonk49</a>
                
            </div>
        </div>
    
        <a name="26106"></a>
        <div class="comment" id="comment-26106">
            <div id="post-26106-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>In both of function print, we open the same file and insert new values</p>
</blockquote>

<p>O.K. I'm sorry to be annoying but you did not post the whole code.</p>

<p>If you reopen a file and write things to it, couldn't there be a bug in that code that leads to a mismatch of tshark and dumpcap packet count? </p>

<p>Without the full code of print_log_1() and print_log_2(), it is impossible to check (or even understand) your results.</p></div>
            <div class="comment-info" id="comment-26106-info">
                
                
                
                

                

                <span class="comment-age">(17 Oct '13, 01:47)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="26108"></a>
        <div class="comment" id="comment-26108">
            <div id="post-26108-score" class="comment-score"></div>
            <div class="comment-text"><p>Ok, sorry, here is the code:</p>

<pre><code>    void print_log_1(gint packet_count)
{
    FILE *sOut;
    sOut = fopen("D:/asonnhx.txt","ab");
    fprintf(sOut,"\nPacket_count: %u",packet_count);
    fclose(sOut);
}
        void print_log_2(int to_read, guint16 t)
{
    FILE *sOut;
    sOut = fopen("D:/asonnhx.txt","ab");
    fprintf(sOut,"\nTo_read: %d/%u",to_read,t);
    fclose(sOut);
}
</code></pre>

<p>Thanks.</p></div>
            <div class="comment-info" id="comment-26108-info">
                
                
                
                

                

                <span class="comment-age">(17 Oct '13, 02:14)</span>
                <a class="comment-user userinfo" href="/users/5593/hoangsonk49">hoangsonk49</a>
                
            </div>
        </div>
    
        <a name="26110"></a>
        <div class="comment not_top_scorer" id="comment-26110">
            <div id="post-26110-score" class="comment-score"></div>
            <div class="comment-text"><p>Hm.. the same file name? Isn't there a race condition if both (tshark and dumpcap) try to open and write to the file at the same time?</p></div>
            <div class="comment-info" id="comment-26110-info">
                
                
                
                

                

                <span class="comment-age">(17 Oct '13, 02:23)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="26120"></a>
        <div class="comment not_top_scorer" id="comment-26120">
            <div id="post-26120-score" class="comment-score"></div>
            <div class="comment-text"><p>No, there isn't. I use the same file name just to see the order of output. Sometime I see it has unusual organization (according to what I expect) but most of output going in expected order: incoming-outgoing-incoming-outgoing...</p></div>
            <div class="comment-info" id="comment-26120-info">
                
                
                
                

                

                <span class="comment-age">(17 Oct '13, 03:29)</span>
                <a class="comment-user userinfo" href="/users/5593/hoangsonk49">hoangsonk49</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-25992" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 7
        </span>
        <a href="#" class="show-all-comments-link">show 2 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-25992-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/25984/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='ztONbDUWsp2d3lPB9jNJkb1XFfIDeZwk' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/25984/what-does-processing-speed-of-dissectors-depend-on?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/25984/what-does-processing-speed-of-dissectors-depend-on?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/dumpcap/"
            class="tag-link-dumpcap"
            title="see questions tagged'dumpcap'using tags"
            rel="tag">dumpcap</a> <span class="tag-number">&#215;89</span><br/>
        
        <a href="/tags/dissector.speed/"
            class="tag-link-dissector.speed"
            title="see questions tagged'dissector.speed'using tags"
            rel="tag">dissector.speed</a> <span class="tag-number">&#215;1</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Oct. 14, 2013, 7:20 p.m.">14 Oct '13, 19:20</strong>
    </p>
    <p> 
     	question was seen: <strong>3,198 times</strong>
    </p>
    <p> 
        last updated: <strong title="Oct. 17, 2013, 7:36 p.m.">17 Oct '13, 19:36</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/302/initd-scipt-for-dumpcap-on-fedora-linux">init.d scipt for dumpcap on Fedora Linux?</a>
        </p>
        
        <p>
            <a href="/questions/12835/how-to-use-dumpcap-to-monitor-winpcap-on-a-remote-machine">how to use dumpcap to monitor winpcap on a remote machine</a>
        </p>
        
        <p>
            <a href="/questions/24224/is-it-possible-to-filter-out-specific-fields-of-specific-packet-types-in-a-live-capture">Is it possible to filter out specific fields of specific packet types in a live capture?</a>
        </p>
        
        <p>
            <a href="/questions/34747/how-to-remove-tcp-header">How to remove tcp header?</a>
        </p>
        
        <p>
            <a href="/questions/47726/capturing-5-gig-of-traffic-using-dumpcap-on-vm">capturing 5 gig of traffic using dumpcap on VM</a>
        </p>
        
        <p>
            <a href="/questions/58194/missing-data-when-displaying-dumpcap-output-on-wireshark">Missing data when displaying dumpcap output on Wireshark</a>
        </p>
        
        <p>
            <a href="/questions/1069/dumpcap-syntax-error">Dumpcap syntax error</a>
        </p>
        
        <p>
            <a href="/questions/13113/gui-of-dumpcap">GUI of dumpcap</a>
        </p>
        
        <p>
            <a href="/questions/24335/wireshark-and-2008-r2-server-reliability-issues">Wireshark and 2008 R2 server reliability issues</a>
        </p>
        
        <p>
            <a href="/questions/38546/how-do-i-configure-dumpcap-from-tshark-while-pipeing-the-tshark-output-to-my-program">how do I configure dumpcap from tshark while pipeing the tshark output to my program?</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
