<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Strip ERSPAN Header from output? - Wireshark Q&amp;A</title>
        <meta name="description" content="Hi Guys I have a pcapng file captured from an ERSPAN session, i need to strip the ERSPAN header from all packets so i can view the encapsulated packet properly in Steelhead Packet Analyzer. I looked at editcap.exe but the -C option seemed to malform the packets as opposed to striping the header off...." />
        <meta name="keywords" content="gre,steelhead,erspan" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/46740/strip-erspan-header-from-output" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/46740/strip-erspan-header-from-output?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='pNILhQOlexV8tTWf3pEft2knKMhkB4bl' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/46740/strip-erspan-header-from-output">Strip ERSPAN Header from output?</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-46740-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/46740/up/" rel="nofollow"> </a>
<div id="post-46740-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-46740-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/46740/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/46740/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hi Guys</p>
<p>I have a pcapng file captured from an ERSPAN session, i need to strip the ERSPAN header from all packets so i can view the encapsulated packet properly in Steelhead Packet Analyzer.</p>
<p>I looked at editcap.exe but the -C option seemed to malform the packets as opposed to striping the header off.</p>
<p>Any ideas?</p>
<p>Thanks for any help you can offer</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/gre/" class="post-tag tag-link-gre"
                                        title="see questions tagged 'gre'" rel="tag">gre</a>
                                
                                    <a href="/tags/steelhead/" class="post-tag tag-link-steelhead"
                                        title="see questions tagged 'steelhead'" rel="tag">steelhead</a>
                                
                                    <a href="/tags/erspan/" class="post-tag tag-link-erspan"
                                        title="see questions tagged 'erspan'" rel="tag">erspan</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>19 Oct '15, 18:04</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/4488347a0278bd48c6afc5cb5413d31f?s=32&amp;d=identicon&amp;r=g" alt="Warren%20Sullivan's gravatar image" />
    <p><a href="/users/20345/warren-sullivan">Warren Sullivan</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">&#9679;</span><span class="badgecount">3</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Warren Sullivan has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-46740">
    
</div>
<div id="comment-tools-46740" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-46740-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/46740/strip-erspan-header-from-output?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/46740/strip-erspan-header-from-output?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/46740/strip-erspan-header-from-output?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/46740/strip-erspan-header-from-output?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="46789"></a>
                    <div id="answer-container-46789" class="answer accepted-answer">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-46789-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/46789/up/" rel="nofollow"> </a>
<div id="post-46789-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-46789-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/46789/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="Warren Sullivan has selected this answer as the correct answer"
        href="/accept_answer/46789/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Well, it looks like your traces are broken. There is a GRE header with Protocol type set to 0x88be, but instead of a ERSPAN header following it there is Ethernet right away. So the ERSPAN header is missing, and the decode fails for any tool that tries. Looks like the device doing your ERSPAN doesn't know it's RFCs :-)</p>
<p>You can fix your capture by running this editcap command, cutting away the leading 38 bytes before the second Ethernet header:</p>
<p>editcap -C 38 pcap.pcap pcap_edited.pcap</p>
<p>Worked for me with your sample.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/46789/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>20 Oct '15, 17:35</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" alt="Jasper's gravatar image" />
    <p><a href="/users/145/jasper">Jasper ♦♦</a><br/>
    <span class="score" title="23806 reputation points"><span class="">23.8k</span></span><span title="5 badges"><span class="badge1">&#9679;</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">&#9679;</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">&#9679;</span><span class="badgecount">284</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Jasper has 263 accepted answers">18&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-46789">
    
        <a name="46790"></a>
        <div class="comment" id="comment-46790">
            <div id="post-46790-score" class="comment-score"></div>
            <div class="comment-text"><p>Perfect! works a treat! thankyou soooo much for your help!</p></div>
            <div class="comment-info" id="comment-46790-info">
                
                
                
                

                

                <span class="comment-age">(20 Oct '15, 18:04)</span>
                <a class="comment-user userinfo" href="/users/20345/warren-sullivan">Warren Sullivan</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-46789" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-46789-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="46751"></a>
                    <div id="answer-container-46751" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-46751-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/46751/up/" rel="nofollow"> </a>
<div id="post-46751-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-46751-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/46751/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <blockquote>
<p>so i can view the encapsulated packet properly in Steelhead Packet Analyzer.</p>
</blockquote>
<p>If you would use Wireshark to view the frames, you would not have to strip the ERSPAN header! ;-)</p>
<p>BTW: I wonder why SteelCentral Packet Analyzer is unable to view those frames !?!</p>
<p>Sample file: </p>
<blockquote>
<p><a href="https://github.com/securactive/junkie/blob/master/tests/pcap/gre/erspan.pcap">https://github.com/securactive/junkie/blob/master/tests/pcap/gre/erspan.pcap</a></p>
</blockquote>
<p><strong>Solution</strong>:
Is you really want to strip the ERSPAN 'headers', please read my answer to a similar question:</p>
<blockquote>
<p><a href="https://ask.wireshark.org/questions/9180/strip-off-gtp-headers">https://ask.wireshark.org/questions/9180/strip-off-gtp-headers</a></p>
</blockquote>
<p>The following command should remove everything related to ERSPAN (including outer eth/ip/etc.)</p>
<blockquote>
<p>bittwiste -I erspan.pcap -O no_erspan.pcap -D 1-50</p>
</blockquote>
<p>This works with the sample file on github.com.</p>
<p>Regards <br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/46751/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>20 Oct '15, 03:41</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/46751/">
                edited
                <strong>20 Oct '15, 03:41</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-46751">
    
        <a name="46752"></a>
        <div class="comment" id="comment-46752">
            <div id="post-46752-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks!</p>

<p>OK i may need to add some detail, i need to strip the header so steelcentral can see the inner DSCP markings and create a nice little pie graph of all DSCP markings in the capture, at the moment it only sees BE or best effort, as that is the CS marking on the outer ERSPAN header.</p>

<p>So i tried bittwist but no luck, came up with this;</p>

<p>C:\Temp\bittwist-win-2.0\bittwist-win-2.0\src&gt;bittwiste -I "c:\Users\ws2593\Desktop\QOS\raw 7million packets.pcapng" -O no_erspan.pcap -D 1-50
      0 [main] bittwiste 6864 find_fast_cwd: WARNING: Couldn't compute FAST_CWD pointer.  Please report this problem to
the public mailing list <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="94f7edf3e3fdfad4f7edf3e3fdfabaf7fbf9">[email&#160;protected]</a>
input file: c:\Users\ws2593\Desktop\QOS\raw 7million packets.pcapng
cygwin warning:
  MS-DOS style path detected: c:\Users\ws2593\Desktop\QOS\raw 7million packets.pcapng
  Preferred POSIX equivalent is: /cygdrive/c/Users/ws2593/Desktop/QOS/raw 7million packets.pcapng
  CYGWIN environment variable option "nodosfilewarning" turns off this warning.
  Consult the user's guide for more details about POSIX paths:
    <a href="http://cygwin.com/cygwin-ug-net/using.html#using-pathnames">http://cygwin.com/cygwin-ug-net/using.html#using-pathnames</a>
output file: no_erspan.pcap
bittwiste: c:\Users\ws2593\Desktop\QOS\raw 7million packets.pcapng is not a valid pcap based trace file</p></div>
            <div class="comment-info" id="comment-46752-info">
                
                
                
                

                

                <span class="comment-age">(20 Oct '15, 04:06)</span>
                <a class="comment-user userinfo" href="/users/20345/warren-sullivan">Warren Sullivan</a>
                
            </div>
        </div>
    
        <a name="46761"></a>
        <div class="comment" id="comment-46761">
            <div id="post-46761-score" class="comment-score"></div>
            <div class="comment-text"><p>It works on my Windows 7 system. Looks like there is a problem with your Cywin environment.</p>

<p>I downloaded an older version, including the Cygwin DLLs from this location:</p>

<blockquote>
<p><a href="http://www.lovemytool.com/blog/2011/05/bittwiste-pcap-capture-file-editor-by-joke-snelders.html">http://www.lovemytool.com/blog/2011/05/bittwiste-pcap-capture-file-editor-by-joke-snelders.html</a></p>
</blockquote></div>
            <div class="comment-info" id="comment-46761-info">
                
                
                
                

                

                <span class="comment-age">(20 Oct '15, 07:59)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="46782"></a>
        <div class="comment" id="comment-46782">
            <div id="post-46782-score" class="comment-score"></div>
            <div class="comment-text"><p>OK, i couldnt deal with the pcapng extension, so i saved a capture as a pcap from within wireshark, ran it on a smaller file and it worked (read - it performed a function) but it has messed up the packet, ill see if i can attach or upload the pre and post processed captures....</p>

<p><a href="https://onedrive.live.com/redir?resid=B59E85C305951CF1!90306&amp;authkey=!AOHCiiz98HLPcII&amp;ithint=folder%2c">https://onedrive.live.com/redir?resid=B59E85C305951CF1!90306&amp;authkey=!AOHCiiz98HLPcII&amp;ithint=folder%2c</a></p>

<p>thanks heaps for your help thus far!!!</p></div>
            <div class="comment-info" id="comment-46782-info">
                
                
                
                

                

                <span class="comment-age">(20 Oct '15, 15:32)</span>
                <a class="comment-user userinfo" href="/users/20345/warren-sullivan">Warren Sullivan</a>
                
            </div>
        </div>
    
        <a name="46784"></a>
        <div class="comment" id="comment-46784">
            <div id="post-46784-score" class="comment-score"></div>
            <div class="comment-text"><p>Try TraceWrangler, I added handling of ERSPAN layers today, so if you add an "Edit" task and chose to strip GRE, it will also remove ERSPAN if it finds it. At least it worked for the trace I have.</p>

<p>Get the automated build here: 
<a href="https://www.tracewrangler.com/download/automated/">https://www.tracewrangler.com/download/automated/</a></p></div>
            <div class="comment-info" id="comment-46784-info">
                
                
                
                

                

                <span class="comment-age">(20 Oct '15, 16:31)</span>
                <a class="comment-user userinfo" href="/users/145/jasper">Jasper ♦♦</a>
                
            </div>
        </div>
    
        <a name="46785"></a>
        <div class="comment" id="comment-46785">
            <div id="post-46785-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi Jasper,</p>

<p>I tried tracewrangler last night to no avail, i tried your new build just now but no luck, can you use my pcap file below to test? It doesnt remove the GRE header or the ERSPAN header, in fact it actually increases the file size! hehe</p>

<p><a href="https://onedrive.live.com/redir?resid=B59E85C305951CF1!90304&amp;authkey=!APq7eLArEBnXmtw&amp;ithint=file%2cpcap">https://onedrive.live.com/redir?resid=B59E85C305951CF1!90304&amp;authkey=!APq7eLArEBnXmtw&amp;ithint=file%2cpcap</a></p>

<p>Thanks for your help so far!</p></div>
            <div class="comment-info" id="comment-46785-info">
                
                
                
                

                

                <span class="comment-age">(20 Oct '15, 16:59)</span>
                <a class="comment-user userinfo" href="/users/20345/warren-sullivan">Warren Sullivan</a>
                
            </div>
        </div>
    
        <a name="46786"></a>
        <div class="comment not_top_scorer" id="comment-46786">
            <div id="post-46786-score" class="comment-score"></div>
            <div class="comment-text"><p>Hm, that's because it uses an ERSPAN version I haven't seen so far. I need to adjust my parser for that, which may take a while. Even Wireshark 1.12.8 doesn't decode it correctly for me. Interesting.</p></div>
            <div class="comment-info" id="comment-46786-info">
                
                
                
                

                

                <span class="comment-age">(20 Oct '15, 17:23)</span>
                <a class="comment-user userinfo" href="/users/145/jasper">Jasper ♦♦</a>
                
            </div>
        </div>
    
        <a name="46787"></a>
        <div class="comment not_top_scorer" id="comment-46787">
            <div id="post-46787-score" class="comment-score"></div>
            <div class="comment-text"><p>By the way, just stumbled across this page while researching ERSPAN encapsulation types, maybe it helps:</p>

<p><a href="http://brezular.com/2015/05/03/decapsulation-erspan-traffic-with-open-source-tools/">http://brezular.com/2015/05/03/decapsulation-erspan-traffic-with-open-source-tools/</a></p>

<p>It also points to a tool at Sourceforge: </p>

<p><a href="http://sourceforge.net/projects/rcdcap/">http://sourceforge.net/projects/rcdcap/</a></p></div>
            <div class="comment-info" id="comment-46787-info">
                
                
                
                

                

                <span class="comment-age">(20 Oct '15, 17:27)</span>
                <a class="comment-user userinfo" href="/users/145/jasper">Jasper ♦♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-46751" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 7
        </span>
        <a href="#" class="show-all-comments-link">show 2 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-46751-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/46740/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='pNILhQOlexV8tTWf3pEft2knKMhkB4bl' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/46740/strip-erspan-header-from-output?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/46740/strip-erspan-header-from-output?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/gre/"
            class="tag-link-gre"
            title="see questions tagged'gre'using tags"
            rel="tag">gre</a> <span class="tag-number">&#215;10</span><br/>
        
        <a href="/tags/erspan/"
            class="tag-link-erspan"
            title="see questions tagged'erspan'using tags"
            rel="tag">erspan</a> <span class="tag-number">&#215;8</span><br/>
        
        <a href="/tags/steelhead/"
            class="tag-link-steelhead"
            title="see questions tagged'steelhead'using tags"
            rel="tag">steelhead</a> <span class="tag-number">&#215;3</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Oct. 19, 2015, 6:04 p.m.">19 Oct '15, 18:04</strong>
    </p>
    <p> 
     	question was seen: <strong>9,369 times</strong>
    </p>
    <p> 
        last updated: <strong title="Oct. 20, 2015, 6:04 p.m.">20 Oct '15, 18:04</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/2532/gre-decapsulation">Gre Decapsulation</a>
        </p>
        
        <p>
            <a href="/questions/46449/erspan-on-cisco-aci-fabric">ERSPAN on Cisco ACI Fabric</a>
        </p>
        
        <p>
            <a href="/questions/7859/how-to-capture-gre-packets-on-mac-107x">[closed] How to capture GRE packets on MAC 10.7.x</a>
        </p>
        
        <p>
            <a href="/questions/49625/erspan-packet-format-support">ERSPAN Packet Format Support</a>
        </p>
        
        <p>
            <a href="/questions/9723/capture-an-ip-inside-a-gre-packet">Capture an IP inside a GRE packet</a>
        </p>
        
        <p>
            <a href="/questions/1803/lua-examples-to-parse-custom-headers-inside-gre">Lua Examples to parse custom headers inside GRE</a>
        </p>
        
        <p>
            <a href="/questions/23390/extend-gre-dissector">Extend GRE dissector</a>
        </p>
        
        <p>
            <a href="/questions/41554/gre-protocol-type">GRE Protocol Type</a>
        </p>
        
        <p>
            <a href="/questions/58049/gre-tunnel-esp-decryption">GRE Tunnel ESP decryption</a>
        </p>
        
        <p>
            <a href="/questions/61796/decapsulate-gre">Decapsulate GRE</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
