<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Capturing url from tcp packets - Wireshark Q&amp;A</title>
        <meta name="description" content="Hi All I have gone through the packet-tcp.c but I am not sure which section deals with extracting the url if it exists in the tcp packets. I have my whole payload packet but I need this specific function." />
        <meta name="keywords" content="url,dissector,tcp" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/23706/capturing-url-from-tcp-packets" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/23706/capturing-url-from-tcp-packets?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='NVxpPmBChj7dunqZ6ST0bjB8a4NahibK' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/23706/capturing-url-from-tcp-packets">Capturing url from tcp packets</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-23706-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/23706/up/" rel="nofollow"> </a>
<div id="post-23706-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-23706-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/23706/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/23706/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hi All I have gone through the packet-tcp.c but I am not sure which section deals with extracting the url if it exists in the tcp packets. I have my whole payload packet but I need this specific function.</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/url/" class="post-tag tag-link-url"
                                        title="see questions tagged 'url'" rel="tag">url</a>
                                
                                    <a href="/tags/dissector/" class="post-tag tag-link-dissector"
                                        title="see questions tagged 'dissector'" rel="tag">dissector</a>
                                
                                    <a href="/tags/tcp/" class="post-tag tag-link-tcp"
                                        title="see questions tagged 'tcp'" rel="tag">tcp</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>12 Aug '13, 06:09</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/26750873415fcbe30ebf2fdeab499d99?s=32&amp;d=identicon&amp;r=g" alt="newbie14's gravatar image" />
    <p><a href="/users/4974/newbie14">newbie14</a><br/>
    <span class="score" title="26 reputation points">26</span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="3 badges"><span class="silver">&#9679;</span><span class="badgecount">3</span></span><span title="8 badges"><span class="bronze">&#9679;</span><span class="badgecount">8</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="newbie14 has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-23706">
    
</div>
<div id="comment-tools-23706" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-23706-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    3 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/23706/capturing-url-from-tcp-packets?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/23706/capturing-url-from-tcp-packets?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/23706/capturing-url-from-tcp-packets?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/23706/capturing-url-from-tcp-packets?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="23707"></a>
                    <div id="answer-container-23707" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-23707-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/23707/up/" rel="nofollow"> </a>
<div id="post-23707-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-23707-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/23707/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <blockquote>
<p>All I have gone through the packet-tcp.c but I am not sure which section deals with extracting the url</p>
</blockquote>
<p>there are no URLs in TCP itself. URLs are a concept of HTTP. You need to look in packet-http.c</p>
<p><strong>UPDATE</strong></p>
<blockquote>
<p>I am capturing the packets via pf_ring. So in my case I am interested for fly-by analysis and later store into database.</p>
</blockquote>
<p>O.K. in that case, Wireshark is kind of 'overkill' for you. Please have a look at the following tools (and their code): ngrep, xplico, tcpextract, etc.</p>
<blockquote>
<p><a href="http://ngrep.sourceforge.net/">http://ngrep.sourceforge.net/</a><br>
<a href="http://www.xplico.org/">http://www.xplico.org/</a> <br>
<a href="https://pypi.python.org/pypi/tcpextract">https://pypi.python.org/pypi/tcpextract</a></p>
</blockquote>
<p>Regards<br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/23707/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>12 Aug '13, 06:10</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/23707/">
                edited
                <strong>13 Aug '13, 04:38</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-23707">
    
        <a name="23708"></a>
        <div class="comment" id="comment-23708">
            <div id="post-23708-score" class="comment-score"></div>
            <div class="comment-text"><p>I am lost here. So say I got a tcp packet how to decide if it will have url or not ? I will go through packet-http.c where to start ? Where does each of this packet-*** starts from ? Sorry I am very new.</p></div>
            <div class="comment-info" id="comment-23708-info">
                
                
                
                

                

                <span class="comment-age">(12 Aug '13, 06:13)</span>
                <a class="comment-user userinfo" href="/users/4974/newbie14">newbie14</a>
                
            </div>
        </div>
    
        <a name="23709"></a>
        <div class="comment" id="comment-23709">
            <div id="post-23709-score" class="comment-score"></div>
            <div class="comment-text"><p>Take a look at the function basic_request_dissector() and what is called therein.</p>

<p>BTW: Why do you need 'that specific function'? Maybe there is a better solution to your problem.</p>

<blockquote>
<p>So say I got a tcp packet how to decide if it will have url or not</p>
</blockquote>

<p>within your own Wireshark dissector or in general?</p></div>
            <div class="comment-info" id="comment-23709-info">
                
                
                
                

                

                <span class="comment-age">(12 Aug '13, 06:17)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="23711"></a>
        <div class="comment" id="comment-23711">
            <div id="post-23711-score" class="comment-score"></div>
            <div class="comment-text"><p>I have capture packets using another tool. So I want to read the url in those packets where I have the whole payload. So what is your best suggestion? I know there available solution so no point to re invent the wheel. I have seen the basic_request_dissector() but I am not too sure with the parameters passed into it.</p></div>
            <div class="comment-info" id="comment-23711-info">
                
                
                
                

                

                <span class="comment-age">(12 Aug '13, 08:22)</span>
                <a class="comment-user userinfo" href="/users/4974/newbie14">newbie14</a>
                
            </div>
        </div>
    
        <a name="23721"></a>
        <div class="comment" id="comment-23721">
            <div id="post-23721-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>I have capture packets using another tool. </p>
</blockquote>

<p>Do you have those packets in a pcap file or are you interested in a fly-by analysis?</p>

<p>If it is a pcap file, you can still run tshark and print the payload of the packets, then use some perl/python scripts to search for URLs in the output with regular expressions.</p></div>
            <div class="comment-info" id="comment-23721-info">
                
                
                
                

                

                <span class="comment-age">(12 Aug '13, 14:21)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="23723"></a>
        <div class="comment" id="comment-23723">
            <div id="post-23723-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/4992/i68040">@I</a> am capturing the packets via pf_ring. So its all in hex format. So in my case I am interested for fly-by analysis and later store into database. The issue I can get all the ip layer details but the tool does not do further then. So I need to dissect further layers by myself based on the layer types. Any idea? Everything I prefer to be in C as the capture engine is all in C too.</p></div>
            <div class="comment-info" id="comment-23723-info">
                
                
                
                

                

                <span class="comment-age">(12 Aug '13, 19:34)</span>
                <a class="comment-user userinfo" href="/users/4974/newbie14">newbie14</a>
                
            </div>
        </div>
    
        <a name="23724"></a>
        <div class="comment not_top_scorer" id="comment-23724">
            <div id="post-23724-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>So say I got a tcp packet how to decide if it will have url or not ?</p>
</blockquote>

<p>You first decide whether it's traffic for a protocol such as HTTP that <em>has</em> URLs; if not, it doesn't have a URL.  Wireshark decides whether traffic is HTTP based on the TCP port it's going to or from; ports such as 80 and 8080 are assumed to be HTTP.</p>

<p>Then you have to parse the HTTP data to see whether it contains an HTTP request or response and, if it does, extract the request URL from requests and other URLs from responses (e.g., a 301 Moved Permanently response has the URL to which the item has moved).</p></div>
            <div class="comment-info" id="comment-23724-info">
                
                
                
                

                

                <span class="comment-age">(12 Aug '13, 20:08)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="23726"></a>
        <div class="comment not_top_scorer" id="comment-23726">
            <div id="post-23726-score" class="comment-score"></div>
            <div class="comment-text"><p>@GuyHarris ok I have capture the source and destination port. So say now I have either way is 80 then I move to next level. With this port I know it will be http traffic right. So now I need help is on parsing the payloaad to capture the url. Thank you for your insights.</p></div>
            <div class="comment-info" id="comment-23726-info">
                
                
                
                

                

                <span class="comment-age">(12 Aug '13, 20:56)</span>
                <a class="comment-user userinfo" href="/users/4974/newbie14">newbie14</a>
                
            </div>
        </div>
    
        <a name="23740"></a>
        <div class="comment not_top_scorer" id="comment-23740">
            <div id="post-23740-score" class="comment-score"></div>
            <div class="comment-text"><p>see the <strong>UPDATE</strong> in my answer</p></div>
            <div class="comment-info" id="comment-23740-info">
                
                
                
                

                

                <span class="comment-age">(13 Aug '13, 04:26)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="23752"></a>
        <div class="comment not_top_scorer" id="comment-23752">
            <div id="post-23752-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/2593/kurt-knochner"></a><a href="/users/2593/kurt-knochner">@Kurt</a> thank you for the link let me go through them. I think the second links looks good.</p></div>
            <div class="comment-info" id="comment-23752-info">
                
                
                
                

                

                <span class="comment-age">(13 Aug '13, 10:58)</span>
                <a class="comment-user userinfo" href="/users/4974/newbie14">newbie14</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-23707" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 9
        </span>
        <a href="#" class="show-all-comments-link">show 4 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-23707-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="23727"></a>
                    <div id="answer-container-23727" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-23727-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/23727/up/" rel="nofollow"> </a>
<div id="post-23727-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-23727-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/23727/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>hi Newbie,</p>
<p>Open the wireshark app on your laptop, make sure you have your laptop/pc connected to internet. Then from Wireshark turn on packet capture on the interface card. Open browser and type a url and browse. Stop the packet capture. Open the pcap file and in the search filter type "http", you should be able to see packets on HTTP protocol.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/23727/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>12 Aug '13, 21:08</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/9e7e0ea42e77b011e54384af126344a7?s=32&amp;d=identicon&amp;r=g" alt="pundalik's gravatar image" />
    <p><a href="/users/5441/pundalik">pundalik</a><br/>
    <span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="bronze">&#9679;</span><span class="badgecount">1</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="pundalik has no accepted answers">0&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-23727">
    
        <a name="23728"></a>
        <div class="comment" id="comment-23728">
            <div id="post-23728-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/5431/the-third">@the</a> problem I am not going to use wireshark for the capture I am using another tool called pf_ring. So I have capture most data except from the payload I need the url.</p></div>
            <div class="comment-info" id="comment-23728-info">
                
                
                
                

                

                <span class="comment-age">(12 Aug '13, 21:10)</span>
                <a class="comment-user userinfo" href="/users/4974/newbie14">newbie14</a>
                
            </div>
        </div>
    
        <a name="23729"></a>
        <div class="comment" id="comment-23729">
            <div id="post-23729-score" class="comment-score"></div>
            <div class="comment-text"><p>So you have your own application running on top of a modified libpcap
using pfring? If so you will have to reinvent part of wireshark/tcpdump to parse what you need of all the protocol layers upto and including http, not realy a wireshark question.</p></div>
            <div class="comment-info" id="comment-23729-info">
                
                
                
                

                

                <span class="comment-age">(12 Aug '13, 21:49)</span>
                <a class="comment-user userinfo" href="/users/42/anders">Anders ♦</a>
                
            </div>
        </div>
    
        <a name="23730"></a>
        <div class="comment" id="comment-23730">
            <div id="post-23730-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/2340/yeskw">@yes</a> I am using pfring to capture the packets. I can determine the ports no issue with that just that I need the url parser now which I think is available in wireshark and no point me reinventing the wheel?</p></div>
            <div class="comment-info" id="comment-23730-info">
                
                
                
                

                

                <span class="comment-age">(12 Aug '13, 22:57)</span>
                <a class="comment-user userinfo" href="/users/4974/newbie14">newbie14</a>
                
            </div>
        </div>
    
        <a name="23732"></a>
        <div class="comment" id="comment-23732">
            <div id="post-23732-score" class="comment-score">1</div>
            <div class="comment-text"><blockquote>
<p>I need the url parser now which I think is available in wireshark</p>
</blockquote>

<p>There is no "URL parser" in Wireshark.  There is an <em>HTTP</em> parser in Wireshark, which is in <code>epan/dissectors/packet-http.c</code>, and it (and the routines it calls, such as the ones in <code>epan/req_resp_hdrs.c</code>) parses <a href="http://tools.ietf.org/html/rfc2616">HTTP</a> in its entirety.  It uses a <em>lot</em> of other parts of Wireshark, including the "tvbuff" code in <code>epan/tvbuff.c</code> for handing buffers with packet data and the "protocol tree" code in <code>epan/proto.c</code> for constructing a tree of protocol fields.  It is <em>not</em> code that's going to be easy to pull out of the rest of Wireshark and use by itself; given that it's part of Wireshark, and written to be part of Wireshark, it was not written to be easy to pull out of the rest of Wireshark and use by itself.  I.e., it's like a wheel that depends heavily on the rest of the car, so if you don't want to reinvent the wheel, you'll have to use the transmission and axles and engine and... of the car, in addition to the wheel.</p></div>
            <div class="comment-info" id="comment-23732-info">
                
                
                
                

                

                <span class="comment-age">(12 Aug '13, 23:47)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="23736"></a>
        <div class="comment" id="comment-23736">
            <div id="post-23736-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/4856/guy">@Guy</a> I appreciate your explanation so what should I do is reinvent the wheel cause I need to store data into db which is not feasible via wireshark right. Yes I have seen on the tvbuff which I still dont understand as I am new to it.</p></div>
            <div class="comment-info" id="comment-23736-info">
                
                
                
                

                

                <span class="comment-age">(13 Aug '13, 01:20)</span>
                <a class="comment-user userinfo" href="/users/4974/newbie14">newbie14</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-23727" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-23727-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="23739"></a>
                    <div id="answer-container-23739" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-23739-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/23739/up/" rel="nofollow"> </a>
<div id="post-23739-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-23739-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/23739/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>As <a href="/users/4856/guy">@Guy</a> has said, there is a lot of work being done by different parts of Wireshark before the URL is extracted. If you're just interested in the URL's and you <em>assume</em> that each HTTP request is generating a new TCP packet (which usually is true, but the nature of TCP does not make this a necessity) and you <em>assume</em> that the requested URL will fit in one TCP segment (which is not true for networks with small MTU's and large request URL's), then you can skip all reassembly and just parse each TCP packet on it's own.</p>
<p>When parsing the payload, look for a pattern like "&lt;method&gt; &lt;url&gt; HTTP/&lt;version&gt;" at the start of each TCP payload. Where &lt;method&gt; can be "GET", "POST", "HEAD", etc. Look for the methods in which you're interested. The &lt;url&gt; should always start with "/" and will not contain spaces. Finally, &lt;version&gt; will be "1.0" or "1.1" currently. In short, anything between "GET " and " HTTP/1.",  "POST " and " HTTP/1." or "HEAD " and " HTTP/1." (watch the spaces) will be your URL and should be quite easy to extract.</p>
<p>Downsides of this method:</p>
<ul>
<li>URL's in requests that do not start at a packet boundery will not be extracted</li>
<li>URL's that are too large to fit one TCP segment will not be extracted</li>
<li>Any packet that have the same pattern at the start of the packet will be seen as URL (think of a webpage containing an example of a http request)</li>
</ul>
<p>So depending on how fool-proof your tool must be, this could be a simple solution to your problem... If you need 100% exact results, there is nothing you could do but follow all the steps that wireshark is taking (TCP reassembly and fully parsing the reassembled TCP stream to exactly determine where a new request starts).</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/23739/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>13 Aug '13, 04:08</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7901a94d8fdd1f9f47cda9a32fcfa177?s=32&amp;d=identicon&amp;r=g" alt="SYN-bit's gravatar image" />
    <p><a href="/users/5/syn-bit">SYN-bit ♦♦</a><br/>
    <span class="score" title="17094 reputation points"><span class="">17.1k</span></span><span title="9 badges"><span class="badge1">&#9679;</span><span class="badgecount">9</span></span><span title="57 badges"><span class="silver">&#9679;</span><span class="badgecount">57</span></span><span title="245 badges"><span class="bronze">&#9679;</span><span class="badgecount">245</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="SYN-bit has 174 accepted answers">20&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-23739">
    
        <a name="23751"></a>
        <div class="comment" id="comment-23751">
            <div id="post-23751-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/5/syn-bit"></a><a href="/users/5/syn-bit">@SYN-bit</a> so if I understand your answer carefully please correct me,what I need to do now if the its a tcp packet transform all the hex payload value into human readable. Next look for anything between "GET " and " HTTP/1.", "POST " and " HTTP/1." or "HEAD " and " HTTP/1." Is that correct ?</p></div>
            <div class="comment-info" id="comment-23751-info">
                
                
                
                

                

                <span class="comment-age">(13 Aug '13, 10:54)</span>
                <a class="comment-user userinfo" href="/users/4974/newbie14">newbie14</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-23739" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-23739-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/23706/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='NVxpPmBChj7dunqZ6ST0bjB8a4NahibK' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/23706/capturing-url-from-tcp-packets?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/23706/capturing-url-from-tcp-packets?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/tcp/"
            class="tag-link-tcp"
            title="see questions tagged'tcp'using tags"
            rel="tag">tcp</a> <span class="tag-number">&#215;752</span><br/>
        
        <a href="/tags/dissector/"
            class="tag-link-dissector"
            title="see questions tagged'dissector'using tags"
            rel="tag">dissector</a> <span class="tag-number">&#215;637</span><br/>
        
        <a href="/tags/url/"
            class="tag-link-url"
            title="see questions tagged'url'using tags"
            rel="tag">url</a> <span class="tag-number">&#215;29</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Aug. 12, 2013, 6:09 a.m.">12 Aug '13, 06:09</strong>
    </p>
    <p> 
     	question was seen: <strong>58,021 times</strong>
    </p>
    <p> 
        last updated: <strong title="Aug. 13, 2013, 10:58 a.m.">13 Aug '13, 10:58</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/46203/howt-to-distinguish-multiple-conversations-with-the-same-addr1port1-and-addr2port2-pair">Howt to distinguish multiple conversations with the same addr1/port1 and addr2/port2 pair</a>
        </p>
        
        <p>
            <a href="/questions/43383/during-reassembly-of-a-protocol-running-on-top-of-tcp-setting-desegment_offset0-and-desegment_lendesegment_one_more_segment-seems-to-break-down-the-behavior-stated-in-readmedissector-is-this-expected">During reassembly of a protocol running on top of TCP, setting desegment_offset=0 and desegment_len=DESEGMENT_ONE_MORE_SEGMENT seems to break down the behavior stated in README.dissector. Is this expected?</a>
        </p>
        
        <p>
            <a href="/questions/44057/complex-lua-tcp-reassembly-problem">Complex Lua TCP Reassembly Problem</a>
        </p>
        
        <p>
            <a href="/questions/22600/getting-pdus-length">getting PDUs length</a>
        </p>
        
        <p>
            <a href="/questions/28524/tcp-dissector-being-called-on-udp">TCP dissector being called on UDP</a>
        </p>
        
        <p>
            <a href="/questions/56975/tls-server_hello-truncated">TLS SERVER_HELLO truncated?</a>
        </p>
        
        <p>
            <a href="/questions/5382/custom-dissector-and-info-column">Custom dissector and info column</a>
        </p>
        
        <p>
            <a href="/questions/51655/defragmenting-tcp-stream-fragments">Defragmenting TCP Stream Fragments</a>
        </p>
        
        <p>
            <a href="/questions/53802/how-dissect-two-segments-of-one-protocol-in-the-same-packet-in-the-same-tcp-segment-lua">How dissect two segments of one protocol in the same packet , in the same TCP segment (LUA)?</a>
        </p>
        
        <p>
            <a href="/questions/24701/handling-tcp-retransmission-in-a-wireshark-dissector">Handling TCP Retransmission in a Wireshark Dissector</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
