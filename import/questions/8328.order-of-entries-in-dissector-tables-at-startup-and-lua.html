<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Order of entries in dissector tables at startup and lua - Wireshark Q&amp;A</title>
        <meta name="description" content="Hello, I&#39;m trying to modify RTP dissector table with Lua. When I create a Lua script like below and run it either from plugins directory or the command line  it doesn&#39;t work, and I can see via Internals -&amp;gt; Dissector Tables that my entry was overwritten by AMR protocol. local ip_dissector = Dissec..." />
        <meta name="keywords" content="development,lua,dissector,startup,rtp" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/8328/order-of-entries-in-dissector-tables-at-startup-and-lua" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/8328/order-of-entries-in-dissector-tables-at-startup-and-lua?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='EpulcjrLmWq7bvZHWbnuYLetkNKF8j13' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/8328/order-of-entries-in-dissector-tables-at-startup-and-lua">Order of entries in dissector tables at startup and lua</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-8328-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/8328/up/" rel="nofollow"> </a>
<div id="post-8328-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-8328-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/8328/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/8328/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   1
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hello,
I'm trying to modify RTP dissector table with Lua.
When I create a Lua script like below and run it either from plugins directory or the command line 
it doesn't work, and I can see via <code>Internals -&gt; Dissector Tables</code> that my entry was overwritten by AMR protocol.</p>
<pre><code>local ip_dissector = Dissector.get("ip")
local rtp_table = DissectorTable.get("rtp.pt")
rtp_table:add(96, ip_dissector)
</code></pre>
<p>However, when I enter the same code via the evaluate window and reload the pcap file, it works as expected. This leads me to think that startup Lua code is executed before the other protocol adds itself to the same table, effectively being overwritten.</p>
<p>Am I right and, if yes, is there a way in which I can control that order? 
By maybe somehow putting that Lua code in a function and running it when all dissectors and protocols have been fully loaded?</p>
<p>Thanks</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/development/" class="post-tag tag-link-development"
                                        title="see questions tagged 'development'" rel="tag">development</a>
                                
                                    <a href="/tags/lua/" class="post-tag tag-link-lua"
                                        title="see questions tagged 'lua'" rel="tag">lua</a>
                                
                                    <a href="/tags/dissector/" class="post-tag tag-link-dissector"
                                        title="see questions tagged 'dissector'" rel="tag">dissector</a>
                                
                                    <a href="/tags/startup/" class="post-tag tag-link-startup"
                                        title="see questions tagged 'startup'" rel="tag">startup</a>
                                
                                    <a href="/tags/rtp/" class="post-tag tag-link-rtp"
                                        title="see questions tagged 'rtp'" rel="tag">rtp</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>11 Jan '12, 09:07</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/96df873546556d82f89c599816554877?s=32&amp;d=identicon&amp;r=g" alt="izopizo's gravatar image" />
    <p><a href="/users/370/izopizo">izopizo</a><br/>
    <span class="score" title="202 reputation points">202</span><span title="4 badges"><span class="badge1">&#9679;</span><span class="badgecount">4</span></span><span title="7 badges"><span class="silver">&#9679;</span><span class="badgecount">7</span></span><span title="14 badges"><span class="bronze">&#9679;</span><span class="badgecount">14</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="izopizo has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/8328/">
                edited
                <strong>11 Jan '12, 10:06</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/fe1cf996b30e896dc95ca3cd47ac7406?s=32&amp;d=identicon&amp;r=g" alt="multipleinterfaces's gravatar image" />
            <p><a href="/users/730/multipleinterfaces">multipleinte...</a><br/>
            <span class="score" title="1321 reputation points"><span class="">1.3k</span></span><span title="15 badges"><span class="badge1">&#9679;</span><span class="badgecount">15</span></span><span title="23 badges"><span class="silver">&#9679;</span><span class="badgecount">23</span></span><span title="40 badges"><span class="bronze">&#9679;</span><span class="badgecount">40</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-8328">
    
</div>
<div id="comment-tools-8328" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-8328-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/8328/order-of-entries-in-dissector-tables-at-startup-and-lua?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/8328/order-of-entries-in-dissector-tables-at-startup-and-lua?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/8328/order-of-entries-in-dissector-tables-at-startup-and-lua?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/8328/order-of-entries-in-dissector-tables-at-startup-and-lua?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="8387"></a>
                    <div id="answer-container-8387" class="answer accepted-answer">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-8387-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/8387/up/" rel="nofollow"> </a>
<div id="post-8387-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-8387-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/8387/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="izopizo has selected this answer as the correct answer"
        href="/accept_answer/8387/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <h2>AMR preferences</h2>
<p>As <em>@Anders</em> pointed out, the problem is due to your preference for <em>"AMR dynamic payload type"</em> conflicting with your dissector registration. Set that preference to <code>0</code> to prevent AMR from being put into the dissector table for <code>rtp.pt</code>.</p>
<p><a href="http://postimage.org/image/p7ocku28n/"><img alt="Screenshot" src="http://s15.postimage.org/p7ocku28n/Screen_Shot_2012_01_12_at_6_22_17_PM.jpg"></a></p>
<br>

<h2>Initialization order</h2>
<p>Actually, the dissectors are <strong>not</strong> loaded randomly. Wireshark loads the C dissectors and then the Lua scripts, each of which is always loaded in the same order. Note that preferences are read last during initialization, which is the reason the AMR preference took effect over your Lua dissector.</p>
<p>The <a href="http://anonsvn.wireshark.org/viewvc/trunk/epan/dissectors/Makefile.common?revision=40439&amp;view=markup#l1463"><code>Makefile</code></a> generates dissector-registration code (<a href="http://pastebin.com/pYLPMzZm"><code>register.c</code></a>) based on dissector source. The C dissectors are thus registered in the order seen in this generated code, which is ascending ASCII order.</p>
<p>Then, Lua scripts (which can contain dissectors) are also loaded in ascending ASCII order as follows:</p>
<ol>
<li><code>${GLOBAL_CONFIG_DIR}/init.lua</code></li>
<li><code>${GLOBAL_PLUGINS_DIR}/**/*.lua</code></li>
<li><code>${PERSONAL_CONFIG_DIR}/init.lua</code></li>
<li><code>${PERSONAL_PLUGINS_DIR}/**/*.lua</code></li>
</ol>
<p>The path variables above can be determined in Wireshark (<code>Help &gt; About &gt; Folders</code>). Example values:</p>
<table cellpadding="5" cellspacing="5" frame="box" rules="rows">

<tbody><tr>
<th>Variable name</th>
<th>Mac OSX value</th>
<th>Windows value</th>
</tr>

<tr>
<td><code>GLOBAL_CONFIG_DIR</code></td>
<td><code>/usr/share/wireshark</code></td>
<td><code>%WIRESHARK%</code></td>
</tr>

<tr>
<td><code>GLOBAL_PLUGINS_DIR</code></td>
<td><code>/usr/lib/wireshark/plugins/1.7.1</code></td>
<td><code>%WIRESHARK%\plugins\1.7.1</code></td>
</tr>

<tr>
<td><code>PERSONAL_CONFIG_DIR</code></td>
<td><code>$HOME/.wireshark</code></td>
<td><code>%APPDATA%\Wireshark</code></td>
</tr>

<tr>
<td><code>PERSONAL_PLUGINS_DIR</code></td>
<td><code>$HOME/.wireshark/plugins</code></td>
<td><code>%APPDATA%\Wireshark\plugins</code></td>
</tr>

</tbody></table>

<p><br>
</p><h2>Control of initialization order</h2>
You can't change the initialization order of the C dissectors unless you modify the code. However, you <i>do</i> have control of Lua script loading, but it requires you to make changes to prevent the scripts from being auto-loaded:<p></p>
<ol>
 <li>Move all Lua scripts outside of <code>${PERSONAL_PLUGINS_DIR}</code> <b>OR</b> rename them to a different extension (such as <code>".lua_"</code>).</li>

<li>Modify <code>${PERSONAL_CONFIG_DIR}/init.lua</code> to explicitly load the Lua scripts in a specific order.</li>
</ol>

<p><b>Example:</b>
Let's say I had this directory structure:
</p><pre>~/.wireshark/plugins/
    |-- a.lua
    |-- b.lua
    -- x/
        |-- c.lua
        |-- d.lua
        |-- e.lua
        -- f.lua
</pre><p></p>
<p>...which has a load order of <code>a</code> through <code>f</code>. I want to change the order to <i>"everything in the <code>x</code> directory alphabetically, then <code>b</code>, and <code>a</code>"</i>. So, I move the Lua scripts outside of <code>~/.wireshark/plugins</code> to say, <code>~/.wireshark/lua/</code>; and I add <code>~/.wireshark/init.lua</code>, which contains:</p>
<pre>-- USER_DIR is initialized in ${GLOBAL_CONFIG_DIR}/init.lua
local basedir = ( USER_DIR or <a href="http://wiki.wireshark.org/LuaAPI/Utils#persconffile_path.28.5Bfilename.5D.29">persconffile_path</a>() )..'lua/'

-- load all Lua scripts in "~/.wireshark/lua/x" (ascending ASCII order)
local xdir = basedir..'x/'
for f in <a href="http://wiki.wireshark.org/LuaAPI/Utils#Dir.open.28pathname_.5B.2Cextension.5D.29">Dir.open</a>(xdir, ".lua") do
    <a href="http://wiki.wireshark.org/LuaAPI/Utils#dofile.28filename.29">dofile</a>(xdir..f)
end

dofile(basedir..'b.lua')
dofile(basedir..'a.lua')
</pre>

<p>Assume the contents of each Lua script contains:
</p><pre>print( (require 'debug').getinfo(1).source )
</pre><p></p>
<p>which prints the absolute path to the running script. Now, if I start Wireshark or TShark, I should see the load order from the command line, like so:</p>
<pre>$ tshark -v
<b>@/Users/tony/.wireshark/lua/x/c.lua
@/Users/tony/.wireshark/lua/x/d.lua
@/Users/tony/.wireshark/lua/x/e.lua
@/Users/tony/.wireshark/lua/x/f.lua
@/Users/tony/.wireshark/lua/x/z.lua
@/Users/tony/.wireshark/lua/b.lua
@/Users/tony/.wireshark/lua/a.lua</b>
TShark 1.7.1 (SVN Rev Unknown from unknown)

Copyright 1998-2012 Gerald Combs &lt;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="086f6d7a69646c487f617a6d7b60697a6326677a6f">[email&#160;protected]</a>&gt; and contributors.
This is free software; see the source for copying conditions. There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

Compiled (64-bit) with GLib 2.28.8, with libpcap (version unknown), with libz
1.2.5, without POSIX capabilities, with SMI 0.4.8, with c-ares 1.7.4, with Lua
5.1, with Python 2.7.1, with GnuTLS 2.8.6, with Gcrypt 1.5.0, with MIT Kerberos,
with GeoIP.

Running on Mac OS 10.7.2 (Darwin 11.2.0), with locale en_US.UTF-8, with libpcap
version 1.1.1, with libz 1.2.5.

Built using llvm-gcc 4.2.1 (Based on Apple Inc. build 5658) (LLVM build
2336.1.00).
</pre>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/8387/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>14 Jan '12, 10:42</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/362ba1008ad9a075d1556d33e97dfed6?s=32&amp;d=identicon&amp;r=g" alt="helloworld's gravatar image" />
    <p><a href="/users/817/helloworld">helloworld</a><br/>
    <span class="score" title="3149 reputation points"><span class="">3.1k</span></span><span title="4 badges"><span class="badge1">&#9679;</span><span class="badgecount">4</span></span><span title="20 badges"><span class="silver">&#9679;</span><span class="badgecount">20</span></span><span title="41 badges"><span class="bronze">&#9679;</span><span class="badgecount">41</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="helloworld has 28 accepted answers">28&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/8387/">
                edited
                <strong>14 Jan '12, 10:42</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-8387">
    
</div>
<div id="comment-tools-8387" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-8387-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="8329"></a>
                    <div id="answer-container-8329" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-8329-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/8329/up/" rel="nofollow"> </a>
<div id="post-8329-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-8329-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/8329/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Dissectors are loaded in a random order, and there is nothing you can do to control the specific order in which they are loaded. What you could do in stead is to disable the AMR protocol in <code>Analyze -&gt; Enabled Protocols</code> (you may then need to restart Wireshark). This will prevent the AMR dissector from registering, which will prevent packets from being dissected as AMR packets (allowing you to use <code>rtp.pt 96</code> for your own protocol). This shouldn't be a problem for you unless your dissector must perform a handoff to the AMR dissector.</p>
<p>The reason it works in the evaluate window is because all of the protocols are already registered at that point, so your dissector will be the last on to overwrite that table entry.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/8329/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>11 Jan '12, 10:03</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/fe1cf996b30e896dc95ca3cd47ac7406?s=32&amp;d=identicon&amp;r=g" alt="multipleinterfaces's gravatar image" />
    <p><a href="/users/730/multipleinterfaces">multipleinte...</a><br/>
    <span class="score" title="1321 reputation points"><span class="">1.3k</span></span><span title="15 badges"><span class="badge1">&#9679;</span><span class="badgecount">15</span></span><span title="23 badges"><span class="silver">&#9679;</span><span class="badgecount">23</span></span><span title="40 badges"><span class="bronze">&#9679;</span><span class="badgecount">40</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="multipleinterfaces has 9 accepted answers">12&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-8329">
    
        <a name="8332"></a>
        <div class="comment" id="comment-8332">
            <div id="post-8332-score" class="comment-score"></div>
            <div class="comment-text"><p>You can set the PT preference for AMR to 0</p></div>
            <div class="comment-info" id="comment-8332-info">
                
                
                
                

                

                <span class="comment-age">(11 Jan '12, 22:47)</span>
                <a class="comment-user userinfo" href="/users/42/anders">Anders â™¦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-8329" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-8329-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/8328/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='EpulcjrLmWq7bvZHWbnuYLetkNKF8j13' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/8328/order-of-entries-in-dissector-tables-at-startup-and-lua?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/8328/order-of-entries-in-dissector-tables-at-startup-and-lua?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/dissector/"
            class="tag-link-dissector"
            title="see questions tagged'dissector'using tags"
            rel="tag">dissector</a> <span class="tag-number">&#215;637</span><br/>
        
        <a href="/tags/lua/"
            class="tag-link-lua"
            title="see questions tagged'lua'using tags"
            rel="tag">lua</a> <span class="tag-number">&#215;431</span><br/>
        
        <a href="/tags/rtp/"
            class="tag-link-rtp"
            title="see questions tagged'rtp'using tags"
            rel="tag">rtp</a> <span class="tag-number">&#215;238</span><br/>
        
        <a href="/tags/development/"
            class="tag-link-development"
            title="see questions tagged'development'using tags"
            rel="tag">development</a> <span class="tag-number">&#215;158</span><br/>
        
        <a href="/tags/startup/"
            class="tag-link-startup"
            title="see questions tagged'startup'using tags"
            rel="tag">startup</a> <span class="tag-number">&#215;32</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Jan. 11, 2012, 9:07 a.m.">11 Jan '12, 09:07</strong>
    </p>
    <p> 
     	question was seen: <strong>11,406 times</strong>
    </p>
    <p> 
        last updated: <strong title="Jan. 14, 2012, 10:42 a.m.">14 Jan '12, 10:42</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/47943/need-to-get-rtp-sequence-number-from-payload-dissector">Need to get RTP sequence number from payload dissector</a>
        </p>
        
        <p>
            <a href="/questions/8629/rtp-header-extension-in-lua">RTP Header extension in Lua</a>
        </p>
        
        <p>
            <a href="/questions/5659/how-best-to-customize-wireshark">How best to customize wireshark?</a>
        </p>
        
        <p>
            <a href="/questions/5940/tcp-options-how-to-make-a-separate-dll">tcp options  ( how to make a separate DLL )</a>
        </p>
        
        <p>
            <a href="/questions/9413/dissector-frame-buffer-is-not-getting-refreshed">dissector frame buffer is not getting refreshed</a>
        </p>
        
        <p>
            <a href="/questions/13966/dissector-ondoubleclick">dissector onDoubleClick</a>
        </p>
        
        <p>
            <a href="/questions/40772/adding-tree-items-according-to-bitmask">Adding tree items according to bitmask</a>
        </p>
        
        <p>
            <a href="/questions/44057/complex-lua-tcp-reassembly-problem">Complex Lua TCP Reassembly Problem</a>
        </p>
        
        <p>
            <a href="/questions/46195/calling-mac-lte-dissectors-using-lua">Calling MAC-LTE Dissectors using LUA</a>
        </p>
        
        <p>
            <a href="/questions/52968/how-to-write-a-postdissector-in-c">How to write a postdissector in C?</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
