<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>How to use Wireshark to identify packets carrying payload sent to tcp socket? - Wireshark Q&amp;A</title>
        <meta name="description" content="Hello, Here&#39;s my detailed question: There&#39;s a Windows C# driver to a Database(which contains the server). I have analysed the client-server communication on Wireshark between these two. How can I know which particular packets are responsible for opening the socket, establishing connection and closin..." />
        <meta name="keywords" content="tcpip,socket,tcp,wireshark" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/48512/how-to-use-wireshark-to-identify-packets-carrying-payload-sent-to-tcp-socket" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/48512/how-to-use-wireshark-to-identify-packets-carrying-payload-sent-to-tcp-socket?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='rUHiN2uHo6Ui7QQkme0FKxGW4ve4Gqu2' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/48512/how-to-use-wireshark-to-identify-packets-carrying-payload-sent-to-tcp-socket">How to use Wireshark to identify packets carrying payload sent to tcp socket?</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-48512-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/48512/up/" rel="nofollow"> </a>
<div id="post-48512-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-48512-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/48512/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/48512/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hello,</p>
<p>Here's my detailed question:
There's a Windows C# driver to a Database(which contains the server). I have analysed the client-server communication on Wireshark between these two. How can I know which particular packets are responsible for opening the socket, establishing connection and closing the socket? My idea is to send the same type of packets from a PLC(Non-windows) to the Database to 'recreate' the driver functionality.</p>
<p>What I have understood so far: 3-way TCP handshake is necessary for opening a socket. </p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/tcpip/" class="post-tag tag-link-tcpip"
                                        title="see questions tagged 'tcpip'" rel="tag">tcpip</a>
                                
                                    <a href="/tags/socket/" class="post-tag tag-link-socket"
                                        title="see questions tagged 'socket'" rel="tag">socket</a>
                                
                                    <a href="/tags/tcp/" class="post-tag tag-link-tcp"
                                        title="see questions tagged 'tcp'" rel="tag">tcp</a>
                                
                                    <a href="/tags/wireshark/" class="post-tag tag-link-wireshark"
                                        title="see questions tagged 'wireshark'" rel="tag">wireshark</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>15 Dec '15, 01:26</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/39a5848e53a3c2268c4fc15fd84afe80?s=32&amp;d=identicon&amp;r=g" alt="Arjun%20S's gravatar image" />
    <p><a href="/users/21794/arjun-s">Arjun S</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">&#9679;</span><span class="badgecount">3</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Arjun S has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/48512/">
                edited
                <strong>15 Dec '15, 04:56</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/00fc6e2633725bd871ff636f0175eabc?s=32&amp;d=identicon&amp;r=g" alt="sindy's gravatar image" />
            <p><a href="/users/19586/sindy">sindy</a><br/>
            <span class="score" title="6049 reputation points"><span class="">6.0k</span></span><span title="4 badges"><span class="badge1">&#9679;</span><span class="badgecount">4</span></span><span title="8 badges"><span class="silver">&#9679;</span><span class="badgecount">8</span></span><span title="51 badges"><span class="bronze">&#9679;</span><span class="badgecount">51</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-48512">
    
</div>
<div id="comment-tools-48512" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-48512-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/48512/how-to-use-wireshark-to-identify-packets-carrying-payload-sent-to-tcp-socket?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/48512/how-to-use-wireshark-to-identify-packets-carrying-payload-sent-to-tcp-socket?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/48512/how-to-use-wireshark-to-identify-packets-carrying-payload-sent-to-tcp-socket?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/48512/how-to-use-wireshark-to-identify-packets-carrying-payload-sent-to-tcp-socket?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="48515"></a>
                    <div id="answer-container-48515" class="answer accepted-answer">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-48515-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/48515/up/" rel="nofollow"> </a>
<div id="post-48515-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-48515-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/48515/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="Arjun S has selected this answer as the correct answer"
        href="/accept_answer/48515/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>3-way tcp handshake is necessary for establishing a tcp session (which, from the client application point of view, is equivalent to opening the socket).</p>
<p>But after successfully establishing the session, it is necessary to send packets with properly formatted tcp headers to let the tcp session fulfil its purpose of delivering application data sent to the socket. So sending just a couple of properly formatted packets will not do the job. So the first thing you need is a complete tcp stack, not just an ability to send two packets.</p>
<p>Next, you need to understand the application protocol which uses tcp as transport, so that you could send proper queries to the database and understand the answers.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/48515/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>15 Dec '15, 01:59</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/00fc6e2633725bd871ff636f0175eabc?s=32&amp;d=identicon&amp;r=g" alt="sindy's gravatar image" />
    <p><a href="/users/19586/sindy">sindy</a><br/>
    <span class="score" title="6049 reputation points"><span class="">6.0k</span></span><span title="4 badges"><span class="badge1">&#9679;</span><span class="badgecount">4</span></span><span title="8 badges"><span class="silver">&#9679;</span><span class="badgecount">8</span></span><span title="51 badges"><span class="bronze">&#9679;</span><span class="badgecount">51</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="sindy has 110 accepted answers">24&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-48515">
    
        <a name="48516"></a>
        <div class="comment not_top_scorer" id="comment-48516">
            <div id="post-48516-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks for the detailed answer, Sindy.</p>

<p>I am using a Mongo Database so as you said, I do need to query the database. But not using query commands, rather with the packet data(used for Windows) itself.</p>

<p>Also, since I am using the Mongo Wire protocol, it says 'Clients should connect to the database with a regular TCP/IP socket. There is no connection handshake.' Since there is no connection handshake for this one, how does it affect the entire thing?</p></div>
            <div class="comment-info" id="comment-48516-info">
                
                
                
                

                

                <span class="comment-age">(15 Dec '15, 02:15)</span>
                <a class="comment-user userinfo" href="/users/21794/arjun-s">Arjun S</a>
                
            </div>
        </div>
    
        <a name="48519"></a>
        <div class="comment" id="comment-48519">
            <div id="post-48519-score" class="comment-score">1</div>
            <div class="comment-text"><p>I would understand</p>

<blockquote>
<p>Clients should connect to the database with a regular TCP/IP socket. There is no connection handshake.</p>
</blockquote>

<p>the way that there is no (need for) connection handshake <em>at application level</em> (the query/answer format/protocol used to talk to the database), because tcp is a reliable transport in terms that it itself takes care about retransmission of eventual lost packets, delivering the bytes of the messages in proper sequence in case that the packets' order swaps in transmission etc.</p>

<p>So once a tcp session is established (which from the application point of view is equal to successful opening of a socket), you can write your query to the socket, and read back from it the answer, without worrying about reliability of the transmission, because the tcp transport below does that for you.</p>

<p>That once again leads us to need to have a working tcp stack on the PLC, as without it, you'll simply not be able to send your application queries and receive the answers.</p>

<p>If there is no tcp stack available for the PLC (possibly due to memory limit or due to complete absence of IP stack, you haven't told us about what the PLC <em>can</em> do at network level), you may need an intermediate box which would understand the protocols which the PLCs already can talk and would act as a mediation gateway to the TCP (or even IP) world, translating the queries in PLC's native protocol to queries to Mongo transported using TCP, and vice versa.</p></div>
            <div class="comment-info" id="comment-48519-info">
                
                
                
                

                

                <span class="comment-age">(15 Dec '15, 02:56)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="48520"></a>
        <div class="comment not_top_scorer" id="comment-48520">
            <div id="post-48520-score" class="comment-score"></div>
            <div class="comment-text"><p>The PLC has asynchronous function blocks TCP for connecting, sending data, receiving data and finally closing the connection. I have used them in my program to in order to communicate with the Database. But the only hurdle is I cannot query to the database at all, since there is no driver available.</p></div>
            <div class="comment-info" id="comment-48520-info">
                
                
                
                

                

                <span class="comment-age">(15 Dec '15, 03:08)</span>
                <a class="comment-user userinfo" href="/users/21794/arjun-s">Arjun S</a>
                
            </div>
        </div>
    
        <a name="48521"></a>
        <div class="comment" id="comment-48521">
            <div id="post-48521-score" class="comment-score">1</div>
            <div class="comment-text"><p>OK, in that case everything seems much simpler. In that case, we come back to the area of using Wireshark to reverse-engineer a protocol and verify our own clone of that protocol.</p>

<p>When you capture the communication of an existing client with the MongoDB, you can right-click a packet (in the packet list pane) which you know to be part of the session (e.g. the one which says SYN and has the MongoDB IP as source or destination) and then choose Follow -&gt; TCP stream. A new window will pop up, showing you the <strong>payload</strong> of the conversation over that tcp session (it means without the tcp overhead, it means actually the byte streams which an application writes to the socket and reads from it). Switch the "show data as" to "hex dump", and you'll see the queries and answers distinguished by colour and offset from the left. This should help you understand what is missing in your queries that Mongo rejects or ignores, especially if you do the same on a capture taken between your PLC running your code and Mongo and compare the results.</p></div>
            <div class="comment-info" id="comment-48521-info">
                
                
                
                

                

                <span class="comment-age">(15 Dec '15, 03:20)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="48523"></a>
        <div class="comment not_top_scorer" id="comment-48523">
            <div id="post-48523-score" class="comment-score"></div>
            <div class="comment-text"><p>ah okay, it seems much clearer and that's probably what I was looking for. </p>

<p>So, I have 2 questions:</p>

<ol>
<li>
<p>Since there are many frames with SYN, should I select just one of them because there are different payload for different frames with SYN in it? </p>
</li>
<li>
<p>Should I check for the payload of the conversation in which only SYN is present or [SYN, ACK] and [ACK] as well?</p>
</li>
</ol></div>
            <div class="comment-info" id="comment-48523-info">
                
                
                
                

                

                <span class="comment-age">(15 Dec '15, 04:26)</span>
                <a class="comment-user userinfo" href="/users/21794/arjun-s">Arjun S</a>
                
            </div>
        </div>
    
        <a name="48524"></a>
        <div class="comment" id="comment-48524">
            <div id="post-48524-score" class="comment-score">1</div>
            <div class="comment-text"><p>I don't think there's any need to reverse engineer the MongoDb protocol, it's specified <a href="https://docs.mongodb.org/v3.0/reference/mongodb-wire-protocol/">here</a>.</p>

<p>Wireshark also includes a dissector for MongoDB, so it should be able to show you the packet details straight away, unless you're running MongoDB on another port (other than 27017), in which case you can modify the MongoDB dissector preference for the port you're using.</p></div>
            <div class="comment-info" id="comment-48524-info">
                
                
                
                

                

                <span class="comment-age">(15 Dec '15, 04:30)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="48525"></a>
        <div class="comment" id="comment-48525">
            <div id="post-48525-score" class="comment-score">1</div>
            <div class="comment-text"><p>Each tcp session starts from the "three way handshake", which is</p>

<ol>
<li>
<p>the client sends a packet with no payload, SYN bit in flags set to 1, and some (as-if-random) sequence number,</p>
</li>
<li>
<p>the server sends a packet with no payload, ack number matching the sequence number of the previously received packet, and its own, completely unrelated, sequence number, also with SYN bit of flags set to 1</p>
</li>
<li>
<p>the client sends a packet (which already may have a payload but I am not sure here) whose ack number matches the sequence number of the server's sequence number.</p>
</li>
</ol>

<p>Normally, a single tcp session is re-used for more than one request-response pair between a client and a server, but it depends on particular implementation. So if you have, in a relatively short capture, several packets with <code>tcp.flags.syn == 1</code> and the source/destination IP matching the one where the MongoDB is running, you have to look also at tcp port at MongoDB server side and at the other IP (if you capture on the MongoDB server and many clients are connected).</p>

<p>In any case, the packets with SYN = 1 do not carry any payload, but are easy to identify and a good base for "follow tcp stream".</p></div>
            <div class="comment-info" id="comment-48525-info">
                
                
                
                

                

                <span class="comment-age">(15 Dec '15, 04:34)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="48526"></a>
        <div class="comment not_top_scorer" id="comment-48526">
            <div id="post-48526-score" class="comment-score"></div>
            <div class="comment-text"><p>Grahamb, </p>

<p>Yes, I am running the DB on 27017. The different fields inside the Structure Message Header appear on the Wireshark pane. Now that I have those, I can compare the field values of the Windows driver with those of PLC and see where it is going. </p>

<p>Thank you very much. :)</p></div>
            <div class="comment-info" id="comment-48526-info">
                
                
                
                

                

                <span class="comment-age">(15 Dec '15, 04:54)</span>
                <a class="comment-user userinfo" href="/users/21794/arjun-s">Arjun S</a>
                
            </div>
        </div>
    
        <a name="48527"></a>
        <div class="comment not_top_scorer" id="comment-48527">
            <div id="post-48527-score" class="comment-score"></div>
            <div class="comment-text"><p>Sindy, </p>

<p>You said 'you have to look also at tcp port at MongoDB server side'. I am only checking the connections from the client side via Wireshark. Is it a necessity to check on the server side as well or can I check it from the client computer itself? And there is only 1 client and 1 server involved.</p></div>
            <div class="comment-info" id="comment-48527-info">
                
                
                
                

                

                <span class="comment-age">(15 Dec '15, 05:03)</span>
                <a class="comment-user userinfo" href="/users/21794/arjun-s">Arjun S</a>
                
            </div>
        </div>
    
        <a name="48528"></a>
        <div class="comment" id="comment-48528">
            <div id="post-48528-score" class="comment-score">1</div>
            <div class="comment-text"><p>I've said that in a context where you've complained about many packets matching display filter <code>tcp.flags.syn == 1</code> in your capture. It is enough to capture on the client computer, and applying a <strong>display filter</strong> <code>tcp.flags.syn == 1 and tcp.dstport == 27017</code> should be sufficient to tell whether just a single tcp session has been established between the client PC and the server during the capture, or more than one. But even if there are several such packets in a capture from successful communication, any of them can be used to "follow tcp stream" (which will replace the display filter with <code>tcp.stream == xx</code>), as for your purpose there is little difference between the sessions.</p>

<p>When capturing to debug your PLC application (probably on the server, with <strong>capture filter</strong> set to <code>host ip.add.re.ss</code>, where ip.add.re.ss is the IP of your PLC device), you should see the three-way handshake to complete successfully first, and if this is true, you should see also some packet(s) whose protocol name in the packet list is "MONGO", because it carries some payload and the source or destination tcp port is 27017. These two conditions should be enough for the mongo dissector to kick in, although what you send may be a garbage yet.</p></div>
            <div class="comment-info" id="comment-48528-info">
                
                
                
                

                

                <span class="comment-age">(15 Dec '15, 05:20)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="48529"></a>
        <div class="comment not_top_scorer" id="comment-48529">
            <div id="post-48529-score" class="comment-score"></div>
            <div class="comment-text"><p>This answer helped me a lot to understand about the payload. Thanks a lot for your valuable time. :)</p></div>
            <div class="comment-info" id="comment-48529-info">
                
                
                
                

                

                <span class="comment-age">(15 Dec '15, 05:52)</span>
                <a class="comment-user userinfo" href="/users/21794/arjun-s">Arjun S</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-48515" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 11
        </span>
        <a href="#" class="show-all-comments-link">show 6 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-48515-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="48517"></a>
                    <div id="answer-container-48517" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-48517-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/48517/up/" rel="nofollow"> </a>
<div id="post-48517-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-48517-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/48517/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Can you be more specific about what you're trying to do with your DB?  TCP 3-way handshake is not normally something a DB programmer will be concerned with.</p>
<p>On Windows programmers would generally use an ODBC driver, or possibly a DB specific driver.  The driver abstracts out all the low-level details such as TCP handshake and allows the programmer to concentrate on their task of querying the db.</p>
<p>For C#, there is a MongoDB driver available <a href="https://docs.mongodb.org/ecosystem/drivers/csharp/">here</a>.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/48517/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>15 Dec '15, 02:33</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" alt="grahamb's gravatar image" />
    <p><a href="/users/1225/grahamb">grahamb ♦</a><br/>
    <span class="score" title="19834 reputation points"><span class="">19.8k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">&#9679;</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">&#9679;</span><span class="badgecount">206</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="grahamb has 274 accepted answers">22&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-48517">
    
        <a name="48518"></a>
        <div class="comment" id="comment-48518">
            <div id="post-48518-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks for the reply, Grahamb. :)</p>

<p>I want to insert documents from a PLC into MongoDB(NoSQL) <em>but</em> the PLC doesn't have a driver for MongoDB which is why I looked at the socket communication for client and MongoDB using C# to get a rough idea.</p>

<p>Since there is no driver at all, is it possible to send the same packets for opening a socket, connecting, closing, et al as seen on Wireshark from a PLC to DB as a string, maybe?</p></div>
            <div class="comment-info" id="comment-48518-info">
                
                
                
                

                

                <span class="comment-age">(15 Dec '15, 02:42)</span>
                <a class="comment-user userinfo" href="/users/21794/arjun-s">Arjun S</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-48517" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-48517-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/48512/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='rUHiN2uHo6Ui7QQkme0FKxGW4ve4Gqu2' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/48512/how-to-use-wireshark-to-identify-packets-carrying-payload-sent-to-tcp-socket?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/48512/how-to-use-wireshark-to-identify-packets-carrying-payload-sent-to-tcp-socket?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/wireshark/"
            class="tag-link-wireshark"
            title="see questions tagged'wireshark'using tags"
            rel="tag">wireshark</a> <span class="tag-number">&#215;1,620</span><br/>
        
        <a href="/tags/tcp/"
            class="tag-link-tcp"
            title="see questions tagged'tcp'using tags"
            rel="tag">tcp</a> <span class="tag-number">&#215;752</span><br/>
        
        <a href="/tags/socket/"
            class="tag-link-socket"
            title="see questions tagged'socket'using tags"
            rel="tag">socket</a> <span class="tag-number">&#215;19</span><br/>
        
        <a href="/tags/tcpip/"
            class="tag-link-tcpip"
            title="see questions tagged'tcpip'using tags"
            rel="tag">tcpip</a> <span class="tag-number">&#215;6</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Dec. 15, 2015, 1:26 a.m.">15 Dec '15, 01:26</strong>
    </p>
    <p> 
     	question was seen: <strong>10,165 times</strong>
    </p>
    <p> 
        last updated: <strong title="Dec. 15, 2015, 5:52 a.m.">15 Dec '15, 05:52</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/60998/what-is-standard-query-0x0000-ptr-_ippd_tcplocal-qm-question-ptr-my-script-hangs-on-this-packet">What is &quot;Standard query  0x0000 PTR, _ippd._tcp.local, &quot;QM&quot; question PTR&quot; ? My script hangs on this packet .</a>
        </p>
        
        <p>
            <a href="/questions/51048/is-it-necessary-for-an-rst-packet-to-have-an-acknowledgement-number">Is it necessary for an RST packet to have an acknowledgement number?</a>
        </p>
        
        <p>
            <a href="/questions/51139/rst-sequence-number-and-window-size">RST sequence number and window size</a>
        </p>
        
        <p>
            <a href="/questions/60840/tcp-analysis">TCP analysis</a>
        </p>
        
        <p>
            <a href="/questions/61455/tcp-packet-length-and-congestion">TCP packet length and congestion</a>
        </p>
        
        <p>
            <a href="/questions/19083/tcp-statistics">TCP statistics</a>
        </p>
        
        <p>
            <a href="/questions/20642/why-cannot-see-tcp-protocol-when-packet-sniffing">Why cannot see  tcp protocol when packet sniffing?</a>
        </p>
        
        <p>
            <a href="/questions/22600/getting-pdus-length">getting PDUs length</a>
        </p>
        
        <p>
            <a href="/questions/23854/computer-sending-emails-via-phishing-program">Computer sending emails via phishing program.</a>
        </p>
        
        <p>
            <a href="/questions/44540/tcp-previous-segment-not-captured-does-it-indicate-something-wrong">[TCP Previous segment not captured] Does it indicate something wrong?</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
