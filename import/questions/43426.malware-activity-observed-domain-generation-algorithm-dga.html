<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Malware Activity Observed - Domain Generation Algorithm (DGA) - Wireshark Q&amp;A</title>
        <meta name="description" content="Hi Folks! This is my second question to the forum, and it&#39;s a little different in the sense that I don&#39;t know that posting the capture file will help - at least here. I had been troubleshooting a problem at work reported as slow DNS response, started looking through packet details, and was digging i..." />
        <meta name="keywords" content="communication,malware,dga,botnet,dns" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/43426/malware-activity-observed-domain-generation-algorithm-dga" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/43426/malware-activity-observed-domain-generation-algorithm-dga?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='oPrAQEO3p1VmpwiBsUpIOTbZdNML3i1T' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/43426/malware-activity-observed-domain-generation-algorithm-dga">Malware Activity Observed - Domain Generation Algorithm (DGA)</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-43426-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/43426/up/" rel="nofollow"> </a>
<div id="post-43426-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-43426-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/43426/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/43426/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hi Folks!</p>
<p>This is my second question to the forum, and it's a little different in the sense that I don't know that posting the capture file will help - at least here.  I had been troubleshooting a problem at work reported as slow DNS response, started looking through packet details, and was digging into failed DNS recursive queries when I saw other failed queries that were very strange.  They used the domain suffix for my organization, but the first part of the domain name appeared to be gibberish.  Something like, qe4l7rius9adfe.mydomain.com.  They came three at a time, a few nanosecs apart, at variable times throughout the day.  From my first observation subnet, they were recursed from other DNS servers.  I moved my observation point to the source subnet and checked again, identified a subnet used for VDI systems to support offshore resources, and then saw additional DNS servers and other hosts requesting similar bogus names.  We temporarily blocked the VDI subnet (the majority of the activity), and then saw additional sources for the requests.</p>
<p>I had read something in one of my Wireshark Kindle books in a DNS section about how this could be possible malware activity.  I thought the referrence was to DNS Fast Fluxing, but after googling around I found security articles for DGA that actually were a better matching description for the observed behavior.  I had created a DNS hostname columun that helped make them jump out in the packet list, as these strange failed DNS names weren't evident in any kind of summary view, just in the packet details.  Tedious to review by drilling into each packet, and hard to isolate from the rest of normal DNS activity.  It's really a miracle that I stumbled over them at all, as upon reflection I don't know how you'd otherwise screen for or detect this activity.</p>
<p>I found a great wiki link describing the DGA behavior, and some other articles that got very deep really quick.  Following one seems to indicate that the best form of detection requires determining the encoding algorithm, and then somehow filtering or looking for that.  Sounds like a job for a security contractor to me!  I notified my managers and forwarded the tracefile to our ONE security guy, and haven't heard a word from them since.  I guess what I'd like to know from anyone in this forum is, have you seen DGA before (I couldn't find another question here about it), and if so - how bad is it, what's the most effective method to block it?  If you read the wiki, this method is part of a botnet communication strategy.  What I couldn't determine is, does this confirm that I have bots on my network that are using these DGA names?  Is there a simpler/easier way to remedy other than using security consultants to reverse engineer the algorithm (used to "type" and source the attack vector), can I do this usuing Wireshark, or should I advise my company to get the Feds involved?  We're processing HIPA data, and I'm greatly concerned - I'm just lacking context and experience with this type of issue.</p>
<p>Thanks!</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/communication/" class="post-tag tag-link-communication"
                                        title="see questions tagged 'communication'" rel="tag">communication</a>
                                
                                    <a href="/tags/malware/" class="post-tag tag-link-malware"
                                        title="see questions tagged 'malware'" rel="tag">malware</a>
                                
                                    <a href="/tags/dga/" class="post-tag tag-link-dga"
                                        title="see questions tagged 'dga'" rel="tag">dga</a>
                                
                                    <a href="/tags/botnet/" class="post-tag tag-link-botnet"
                                        title="see questions tagged 'botnet'" rel="tag">botnet</a>
                                
                                    <a href="/tags/dns/" class="post-tag tag-link-dns"
                                        title="see questions tagged 'dns'" rel="tag">dns</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>21 Jun '15, 18:08</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f0950f468133c72b3e15e65edf5db5ce?s=32&amp;d=identicon&amp;r=g" alt="Lucidcryotank's gravatar image" />
    <p><a href="/users/17534/lucidcryotank">Lucidcryotank</a><br/>
    <span class="score" title="26 reputation points">26</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="3 badges"><span class="silver">&#9679;</span><span class="badgecount">3</span></span><span title="4 badges"><span class="bronze">&#9679;</span><span class="badgecount">4</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Lucidcryotank has one accepted answer">50&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-43426">
    
        <a name="43428"></a>
        <div class="comment" id="comment-43428">
            <div id="post-43428-score" class="comment-score"></div>
            <div class="comment-text"><p>Also, EVERY one of these DNS names is unique, and I only saw each one once.</p></div>
            <div class="comment-info" id="comment-43428-info">
                
                
                
                

                

                <span class="comment-age">(21 Jun '15, 19:21)</span>
                <a class="comment-user userinfo" href="/users/17534/lucidcryotank">Lucidcryotank</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-43426" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-43426-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/43426/malware-activity-observed-domain-generation-algorithm-dga?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/43426/malware-activity-observed-domain-generation-algorithm-dga?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/43426/malware-activity-observed-domain-generation-algorithm-dga?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/43426/malware-activity-observed-domain-generation-algorithm-dga?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="43429"></a>
                    <div id="answer-container-43429" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-43429-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/43429/up/" rel="nofollow"> </a>
<div id="post-43429-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-43429-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/43429/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p><code> "They came three at a time"</code></p>
<p>This could be Google Chrome checking if the owner of the DNS server is modifying DNS requests, for example, by using wildcard domains to match requests for non-existent domain names. See the InfoSec article <a href="https://isc.sans.edu/diary/Google+Chrome+and+(weird)+DNS+requests/10312">Google Chrome and (weird) DNS requests</a> and also the Wikipedia article for <a href="https://en.wikipedia.org/wiki/Wildcard_DNS_record">Wildcard DNS record</a>.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/43429/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>21 Jun '15, 21:44</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/071fe61f64868d98bdf4eb060b63b6ca?s=32&amp;d=identicon&amp;r=g" alt="Jim%20Aragon's gravatar image" />
    <p><a href="/users/527/jim-aragon">Jim Aragon</a><br/>
    <span class="score" title="7187 reputation points"><span class="">7.2k</span></span><span title="7 badges"><span class="badge1">&#9679;</span><span class="badgecount">7</span></span><span title="33 badges"><span class="silver">&#9679;</span><span class="badgecount">33</span></span><span title="118 badges"><span class="bronze">&#9679;</span><span class="badgecount">118</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Jim Aragon has 70 accepted answers">24&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-43429">
    
        <a name="43430"></a>
        <div class="comment" id="comment-43430">
            <div id="post-43430-score" class="comment-score"></div>
            <div class="comment-text"><p>Interesting.  I'll have to dig deeper into this info.  How could you verify if it was Chrome activity?  Is there a log on the host running Chrome that I can correlate the event to the DNS query sent from the host IP in the query?  Chrome is in rare use, but present.  I'll look more closely at how to disable that and check one of the querying hosts after reconfig.  Thanks for the info!  If this is the case, our one security guy can stand down from his efforts, saving all of us time.</p></div>
            <div class="comment-info" id="comment-43430-info">
                
                
                
                

                

                <span class="comment-age">(21 Jun '15, 22:44)</span>
                <a class="comment-user userinfo" href="/users/17534/lucidcryotank">Lucidcryotank</a>
                
            </div>
        </div>
    
        <a name="43431"></a>
        <div class="comment" id="comment-43431">
            <div id="post-43431-score" class="comment-score"></div>
            <div class="comment-text"><p>Not sure why the example trace shows the same DNS name twice in that sample capture.  I only see one request &amp; response for each of the 3...</p></div>
            <div class="comment-info" id="comment-43431-info">
                
                
                
                

                

                <span class="comment-age">(21 Jun '15, 22:52)</span>
                <a class="comment-user userinfo" href="/users/17534/lucidcryotank">Lucidcryotank</a>
                
            </div>
        </div>
    
        <a name="43441"></a>
        <div class="comment" id="comment-43441">
            <div id="post-43441-score" class="comment-score"></div>
            <div class="comment-text"><p>Actually I was wrong about the latter.  I'm going to anonymize my trace and post it.  The names vary in length, and do not contain any numbers or special characters.</p></div>
            <div class="comment-info" id="comment-43441-info">
                
                
                
                

                

                <span class="comment-age">(22 Jun '15, 08:01)</span>
                <a class="comment-user userinfo" href="/users/17534/lucidcryotank">Lucidcryotank</a>
                
            </div>
        </div>
    
        <a name="43443"></a>
        <div class="comment" id="comment-43443">
            <div id="post-43443-score" class="comment-score"></div>
            <div class="comment-text"><p>Here's the anonymized trace, ignore the malformed packet info - it was generated by Tracewrangler because the original packets were sliced at capture to 92 bytes and were originally notated as "packet size limited during capture".</p>

<p><a href="https://www.cloudshark.org/captures/63dc7c2802d4">https://www.cloudshark.org/captures/63dc7c2802d4</a></p></div>
            <div class="comment-info" id="comment-43443-info">
                
                
                
                

                

                <span class="comment-age">(22 Jun '15, 08:22)</span>
                <a class="comment-user userinfo" href="/users/17534/lucidcryotank">Lucidcryotank</a>
                
            </div>
        </div>
    
        <a name="43444"></a>
        <div class="comment" id="comment-43444">
            <div id="post-43444-score" class="comment-score"></div>
            <div class="comment-text"><p>I do see now where the same bogus DNS name is tried on multiple domains.</p></div>
            <div class="comment-info" id="comment-43444-info">
                
                
                
                

                

                <span class="comment-age">(22 Jun '15, 08:25)</span>
                <a class="comment-user userinfo" href="/users/17534/lucidcryotank">Lucidcryotank</a>
                
            </div>
        </div>
    
        <a name="43445"></a>
        <div class="comment not_top_scorer" id="comment-43445">
            <div id="post-43445-score" class="comment-score"></div>
            <div class="comment-text"><p>Some of this activity is again recursion between DNS servers.  All of the individual source hosts are again on our VDI network.  I'm going to find and talk to the VDI admins to see if Chrome is part of their desktop build.</p></div>
            <div class="comment-info" id="comment-43445-info">
                
                
                
                

                

                <span class="comment-age">(22 Jun '15, 08:44)</span>
                <a class="comment-user userinfo" href="/users/17534/lucidcryotank">Lucidcryotank</a>
                
            </div>
        </div>
    
        <a name="43446"></a>
        <div class="comment not_top_scorer" id="comment-43446">
            <div id="post-43446-score" class="comment-score"></div>
            <div class="comment-text"><p>Chrome will try the same names using each locally configured DNS suffix. I'm not sure how you would confirm if this is Chrome. I'd start by capturing on a PC that has Chrome installed. Make sure Chrome is NOT running. It normally runs in the background even after all Chrome windows have been closed. On Windows 7, after closing all Chrome windows, click on the "Show hidden icons" icon in the System Tray, right-click on the Chrome icon, and select "Exit." Start capturing with Wireshark, then start Chrome, and see if the DNS lookups generated by Chrome seem to match what you saw in your earlier traces. I see Chrome generate three different domain names, and try each one multiple times.</p></div>
            <div class="comment-info" id="comment-43446-info">
                
                
                
                

                

                <span class="comment-age">(22 Jun '15, 08:52)</span>
                <a class="comment-user userinfo" href="/users/527/jim-aragon">Jim Aragon</a>
                
            </div>
        </div>
    
        <a name="43459"></a>
        <div class="comment not_top_scorer" id="comment-43459">
            <div id="post-43459-score" class="comment-score"></div>
            <div class="comment-text"><p>Is the number of suspicious machines increasing?
I can see 3 different IP Addresess?
And if you really think that some machines are infected, why don´t you  isolate them asap?</p>

<p>But it looks to me more like the things in <a href="https://isc.sans.edu/diary/Google+Chrome+and+(weird)+DNS+requests/10312"> Jim Arragons link </a> then this here:  <a href="https://www.damballa.com/downloads/r_pubs/RN_DGAs-and-Cyber-Criminals-A-Case-Study.pdf"> DGA Case Study </a></p></div>
            <div class="comment-info" id="comment-43459-info">
                
                
                
                

                

                <span class="comment-age">(22 Jun '15, 12:56)</span>
                <a class="comment-user userinfo" href="/users/16160/christian_r">Christian_R</a>
                
            </div>
        </div>
    
        <a name="43470"></a>
        <div class="comment not_top_scorer" id="comment-43470">
            <div id="post-43470-score" class="comment-score"></div>
            <div class="comment-text"><p>That's a great diagnostic plan, except the machine that's running is a VMWare VDI (virtual desktop interface?), and I don't think I'll get them to put wireshark in it or allow me to install it - but I'm not sure it's necessary.  I should be able to observe the same event regardless of whether I'm on the workstation or back on the subnet where the DNS server is.  As long as I know the VDI's IP, I should be fine watching the behavior on the DNS server subnet when I disable and re-enable Chrome.<br>
</p>

<p>I think this is a solid method, maybe I'll even get a VDI of my own and see what permissions I can have.  The number of infected machines doesn't necessarily keep increasing, but it certainly changes as VDI's come and go throughout the day.  I bet if I were to look at enough data to see a trend, any increase in this activity would actually be the offshore resources using them during our CST off-hours.  There may be a few local VDI users (devs) during our business day, Chrome isn't in the corporate workstation standard build, but several users with local admin have installed it.<br>
</p>

<p>I also think Jim's explanation is more of a match and plausible explanation than DGA now.  However, knowing how screwy this is and how it looks, I'd kinda like to see examples of DGA traffic and compare them.  I've notified my security guy, and he's relieved.</p>

<p>We did temporarily shut down a couple of the ESX hosts serving the VDI's, but the devs had to have them back.  And like I said, our security department is ONE guy.  If this isn't DGA (looking unlikely now), I'm glad that what little screaming wolf I did didn't seriously disrupt our business.  As I couldn't exactly identify what the impact would be if it truly were malicious, I didn't make a federal case out of it - I was still trying to determine if it should be a big deal or not.  As there was already a guy assigned to look at it, I kind felt that I had played my part as a network engineer, and had notified my manager and top execs.  My biggest mistake was probably not posting it here sooner!  Like I said though, I couldn't find it in any other question, and I was already working on my other post.  I guess I thought my company would at least check with the security consulting group for their analysis (kinda wanted to see how that worked if it had been real), but again - now I'm glad they didn't.</p></div>
            <div class="comment-info" id="comment-43470-info">
                
                
                
                

                

                <span class="comment-age">(22 Jun '15, 21:15)</span>
                <a class="comment-user userinfo" href="/users/17534/lucidcryotank">Lucidcryotank</a>
                
            </div>
        </div>
    
        <a name="43471"></a>
        <div class="comment not_top_scorer" id="comment-43471">
            <div id="post-43471-score" class="comment-score"></div>
            <div class="comment-text"><p>I was having trouble with the concept of infected VDI instances as well, and the entire offshore team uses them.</p></div>
            <div class="comment-info" id="comment-43471-info">
                
                
                
                

                

                <span class="comment-age">(22 Jun '15, 21:19)</span>
                <a class="comment-user userinfo" href="/users/17534/lucidcryotank">Lucidcryotank</a>
                
            </div>
        </div>
    
        <a name="43472"></a>
        <div class="comment not_top_scorer" id="comment-43472">
            <div id="post-43472-score" class="comment-score"></div>
            <div class="comment-text"><p>I'm also in the middle of a Riverbed eval I built for NetExpress, VShark and Packet Analyzer.  I have continuous VLAN traffic captures (packet sliced - on both the VDI and DNS server subnets) running on multiple ESX hosts in a cluster, with several days of history.  I can look at the data there at any time, which to me is better than trying to run Wireshark on a VDI anyway.  I'm still learning the best methods for using all of the tools in the suite for analysis.  I do believe that studying Wireshark has improved my analysis efforts overall, more than just overlaying all of the interesting Packet Analyzer filters.  The trick to that seems to be finding the incidents of interest quickly using PA, then zooming into the packets with Wireshark.</p>

<p>If we had more engineers and I wasn't trying to perform a network redesign and new hardware implementation at the same time, I'd have more availability for pure analysis.</p></div>
            <div class="comment-info" id="comment-43472-info">
                
                
                
                

                

                <span class="comment-age">(22 Jun '15, 21:31)</span>
                <a class="comment-user userinfo" href="/users/17534/lucidcryotank">Lucidcryotank</a>
                
            </div>
        </div>
    
        <a name="43528"></a>
        <div class="comment not_top_scorer" id="comment-43528">
            <div id="post-43528-score" class="comment-score"></div>
            <div class="comment-text"><p>I've been provisioned with a VDI client.  I'm going to try and recreate the event and make a new observation.</p></div>
            <div class="comment-info" id="comment-43528-info">
                
                
                
                

                

                <span class="comment-age">(24 Jun '15, 16:34)</span>
                <a class="comment-user userinfo" href="/users/17534/lucidcryotank">Lucidcryotank</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-43429" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 12
        </span>
        <a href="#" class="show-all-comments-link">show 7 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-43429-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/43426/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='oPrAQEO3p1VmpwiBsUpIOTbZdNML3i1T' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/43426/malware-activity-observed-domain-generation-algorithm-dga?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/43426/malware-activity-observed-domain-generation-algorithm-dga?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/dns/"
            class="tag-link-dns"
            title="see questions tagged'dns'using tags"
            rel="tag">dns</a> <span class="tag-number">&#215;109</span><br/>
        
        <a href="/tags/malware/"
            class="tag-link-malware"
            title="see questions tagged'malware'using tags"
            rel="tag">malware</a> <span class="tag-number">&#215;27</span><br/>
        
        <a href="/tags/botnet/"
            class="tag-link-botnet"
            title="see questions tagged'botnet'using tags"
            rel="tag">botnet</a> <span class="tag-number">&#215;8</span><br/>
        
        <a href="/tags/communication/"
            class="tag-link-communication"
            title="see questions tagged'communication'using tags"
            rel="tag">communication</a> <span class="tag-number">&#215;5</span><br/>
        
        <a href="/tags/dga/"
            class="tag-link-dga"
            title="see questions tagged'dga'using tags"
            rel="tag">dga</a> <span class="tag-number">&#215;1</span><br/>
        
    </p>
    <p>
        question asked: <strong title="June 21, 2015, 6:08 p.m.">21 Jun '15, 18:08</strong>
    </p>
    <p> 
     	question was seen: <strong>3,328 times</strong>
    </p>
    <p> 
        last updated: <strong title="June 24, 2015, 4:34 p.m.">24 Jun '15, 16:34</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/3697/odd-dns-queries-malware">odd dns queries (malware?)</a>
        </p>
        
        <p>
            <a href="/questions/38040/capture-botnet-or-malware">[closed] Capture Botnet or malware</a>
        </p>
        
        <p>
            <a href="/questions/38041/botnet-collecting-how-using-wireshark-or">botnet collecting how? using wireshark or...?</a>
        </p>
        
        <p>
            <a href="/questions/6060/outbound-traffic-to-china">Outbound traffic to China</a>
        </p>
        
        <p>
            <a href="/questions/78/can-i-limit-name-resolution-to-only-use-wiresharks-own-hosts-file">Can I limit name resolution to only use Wireshark&#39;s own hosts file?</a>
        </p>
        
        <p>
            <a href="/questions/7514/dns-ipv6-queryreponse">DNS IPV6 query/reponse</a>
        </p>
        
        <p>
            <a href="/questions/18394/help-with-filters-for-detecting-fast-flux-in-dns-queries">Help with Filters for Detecting Fast Flux in DNS Queries</a>
        </p>
        
        <p>
            <a href="/questions/31573/question-on-dns-query-type">Question on DNS Query Type</a>
        </p>
        
        <p>
            <a href="/questions/41555/dns-two-nics">[closed] DNS / two NIC&#39;s</a>
        </p>
        
        <p>
            <a href="/questions/48663/how-can-you-tell-if-a-dns-response-has-the-message-compressed-in-wireshark">How can you tell if a DNS Response has the Message compressed in Wireshark?</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
