<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Wireshark dissector development - Reassembly tcp frames - Wireshark Q&amp;A</title>
        <meta name="description" content="Just before starting, sorry for my english... i&#39;m french. I&#39;m developing (in C language) a wireshark dissector to dissect a specific protocol to the company (it&#39;s owner of it) where I work but I have a problems when messages are several TCP frames ... I can not reassemble the messages when a message..." />
        <meta name="keywords" content="reassembly,dissector,help,tcp,wireshark" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/37566/wireshark-dissector-development-reassembly-tcp-frames" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/37566/wireshark-dissector-development-reassembly-tcp-frames?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='bCYHXPCyZMe622MocNHCIh2ziSR15bgA' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/37566/wireshark-dissector-development-reassembly-tcp-frames">Wireshark dissector development - Reassembly tcp frames</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-37566-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/37566/up/" rel="nofollow"> </a>
<div id="post-37566-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-37566-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/37566/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/37566/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Just before starting, sorry for my english... i'm french.</p>
<p>I'm developing (in C language) a wireshark dissector to dissect a specific protocol to the company (it's owner of it) where I work but I have a problems when messages are several TCP frames ... I can not reassemble the messages when a message is broken into two different frames TCP, I can not reform it in one message...</p>
<p>I read the readme.dissector and try using two methods:</p>
<pre><code>First method:

    tcp_dissect_pdus(tvb, pinfo, tree, dns_desegment, 2,
                get_dns_pdu_len, dissect_dns_tcp_pdu, data);
            return tvb_captured_length(tvb);

Second method :

    guint offset = 0;
        while(offset &lt; tvb_reported_length(tvb)) {
            gint available = tvb_reported_length_remaining(tvb, offset);
            gint len = tvb_strnlen(tvb, offset, available);

            if( -1 == len ) {
                /* we ran out of data: ask for more */
                pinfo-&gt;desegment_offset = offset;
                pinfo-&gt;desegment_len = DESEGMENT_ONE_MORE_SEGMENT;
                return (offset + available);
            }

            col_set_str(pinfo-&gt;cinfo, COL_INFO, "C String");

            len += 1; /* Add one for the '\0' */

            if (tree) {
                proto_tree_add_item(tree, hf_cstring, tvb, offset, len,
                    ENC_ASCII|ENC_NA);
            }
            offset += (guint)len;
        }

        /* if we get here, then the end of the tvb coincided with the end of a
           string. Happy days. */
        return tvb_captured_length(tvb);
</code></pre>
<p>But impossible to reassemble the message, I do not understand why ... can you help me please? I hope you understand my problem ...: /</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/reassembly/" class="post-tag tag-link-reassembly"
                                        title="see questions tagged 'reassembly'" rel="tag">reassembly</a>
                                
                                    <a href="/tags/dissector/" class="post-tag tag-link-dissector"
                                        title="see questions tagged 'dissector'" rel="tag">dissector</a>
                                
                                    <a href="/tags/help/" class="post-tag tag-link-help"
                                        title="see questions tagged 'help'" rel="tag">help</a>
                                
                                    <a href="/tags/tcp/" class="post-tag tag-link-tcp"
                                        title="see questions tagged 'tcp'" rel="tag">tcp</a>
                                
                                    <a href="/tags/wireshark/" class="post-tag tag-link-wireshark"
                                        title="see questions tagged 'wireshark'" rel="tag">wireshark</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>04 Nov '14, 04:47</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/6e41ef358edbaa0233d30fbd5b41b4d1?s=32&amp;d=identicon&amp;r=g" alt="Guillaume's gravatar image" />
    <p><a href="/users/11435/guillaume">Guillaume</a><br/>
    <span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">&#9679;</span><span class="badgecount">2</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Guillaume has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-37566">
    
        <a name="37640"></a>
        <div class="comment" id="comment-37640">
            <div id="post-37640-score" class="comment-score"></div>
            <div class="comment-text"><p>Nobody can help me please ?</p></div>
            <div class="comment-info" id="comment-37640-info">
                
                
                
                

                

                <span class="comment-age">(07 Nov '14, 01:53)</span>
                <a class="comment-user userinfo" href="/users/11435/guillaume">Guillaume</a>
                
            </div>
        </div>
    
        <a name="37641"></a>
        <div class="comment" id="comment-37641">
            <div id="post-37641-score" class="comment-score"></div>
            <div class="comment-text"><p>You're not really giving anyone a chance to help.  You must describe in more detail what happens with the two methods, as they are both used successfully elsewhere in the code.</p>

<p>The first method is definitely the easiest as long as you have correctly created the <code>get_dns_pdu_len()</code> function.  Have you tried debugging the code to check that function returns the expected value?</p></div>
            <div class="comment-info" id="comment-37641-info">
                
                
                
                

                

                <span class="comment-age">(07 Nov '14, 02:48)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="37646"></a>
        <div class="comment" id="comment-37646">
            <div id="post-37646-score" class="comment-score"></div>
            <div class="comment-text"><p>Thank grahamb for your answer!</p>

<p>I will try to explain you...
So, my problem is to reassemble the packets between them.
To illustrate this, see "picture1.png" (in the end of this message) which shows the packet number 8 should be following the packet number 6. As you can see the number 6 is malformed packet because its sequel is in the number 8 ... I can not get them together to make one cut and the entire message ...</p>

<p>To reach the result of "picture1.png" I'll put the code I use. "choixMessageASA" allows according to the header frame of the ASA (the protocol that I have to decode) to know what message travels :</p>

<p>if (tree) {</p>

<pre><code>    col_set_str(pinfo-&gt;cinfo, COL_PROTOCOL, "ASA");
    col_set_str(pinfo-&gt;cinfo, COL_INFO, "Ceci est un test message ASA");
    ti = proto_tree_add_item(tree, proto_asa, tvb, 0, -1, ENC_NA);
    asa_tree = proto_item_add_subtree(ti, ett_asa);
    artrh = wmem_new(wmem_packet_scope(), struct artere_header);
    artrh-&gt;th_length = tvb_get_ntohs(tvb, offset);
    if(artrh-&gt;th_length &gt; tvb_length(tvb)){
        pinfo-&gt;desegment_offset = offset;
        pinfo-&gt;desegment_len = artrh-&gt;th_length - tvb_length(tvb);
        choixMessageASA(artrh, tvb, asa_tree, &amp;offset);
    } else {
        choixMessageASA(artrh, tvb, asa_tree, &amp;offset);
    }

}
</code></pre>

<p>I hope you can help me :/</p>

<p>picture1.png :
<img alt="alt text" src="https://osqa-ask.wireshark.org/upfiles/picture1_VHv0ZuD.png"></p></div>
            <div class="comment-info" id="comment-37646-info">
                
                
                
                

                

                <span class="comment-age">(07 Nov '14, 05:14)</span>
                <a class="comment-user userinfo" href="/users/11435/guillaume">Guillaume</a>
                
            </div>
        </div>
    
        <a name="37669"></a>
        <div class="comment" id="comment-37669">
            <div id="post-37669-score" class="comment-score"></div>
            <div class="comment-text"><p>Why don't you use tvb_dissect_pdus? It would be much simpler. The code should be something like this:</p>

<pre><code>static int dissect_asa_pdu(tvbuff_t *tvb, packet_info *pinfo, proto_tree *tree, void *data)
{
    tcp_dissect_pdus(tvb, pinfo, tree, TRUE, 2, get_asa_pdu_len, dissect_asa_pdu, data); 
    return tvb_captured_length(tvb);
}
</code></pre>

<p>where get_asa_pdu_len() is:</p>

<pre><code>static guint get_asa_pdu_len(packet_info *pinfo _U_, tvbuff_t *tvb, int offset)
{
    return tvb_get_ntohs(tvb, offset);
}
</code></pre></div>
            <div class="comment-info" id="comment-37669-info">
                
                
                
                

                

                <span class="comment-age">(07 Nov '14, 13:07)</span>
                <a class="comment-user userinfo" href="/users/1538/pascal-quantin">Pascal Quantin</a>
                
            </div>
        </div>
    
        <a name="37776"></a>
        <div class="comment" id="comment-37776">
            <div id="post-37776-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks for your answer and sorry for my late reply ...</p>

<p>I tried the way you speak with tvb_dissect_pdus but the result is the same, I get the same thing as "picture1.png" I set in my previous message ... Do not you know how to meet the frames 6 and 8 (those of "picture1.png") and dissect the whole frame assembled?</p></div>
            <div class="comment-info" id="comment-37776-info">
                
                
                
                

                

                <span class="comment-age">(12 Nov '14, 01:08)</span>
                <a class="comment-user userinfo" href="/users/11435/guillaume">Guillaume</a>
                
            </div>
        </div>
    
        <a name="37782"></a>
        <div class="comment not_top_scorer" id="comment-37782">
            <div id="post-37782-score" class="comment-score"></div>
            <div class="comment-text"><p>One small thing reassembly and code adding to columns shouldn't be under "if (tree) {"
as allwas should be executed.</p></div>
            <div class="comment-info" id="comment-37782-info">
                
                
                
                

                

                <span class="comment-age">(12 Nov '14, 04:10)</span>
                <a class="comment-user userinfo" href="/users/42/anders">Anders ♦</a>
                
            </div>
        </div>
    
        <a name="37785"></a>
        <div class="comment not_top_scorer" id="comment-37785">
            <div id="post-37785-score" class="comment-score"></div>
            <div class="comment-text"><p>Thank you Anders for your answer but I do not know what you mean ... is it possible showing me what would be the code please?</p>

<p>You thought that because it gives me the same thing:</p>

<pre><code>col_set_str(pinfo-&gt;cinfo, COL_PROTOCOL, "ASA");
col_set_str(pinfo-&gt;cinfo, COL_INFO, "Ceci est un test message ASA");

ti = proto_tree_add_item(tree, proto_asa, tvb, 0, -1, ENC_NA);
asa_tree = proto_item_add_subtree(ti, ett_asa);

artrh = wmem_new(wmem_packet_scope(), struct artere_header);

artrh-&gt;th_length = tvb_get_ntohs(tvb, offset);

if(artrh-&gt;th_length &gt; tvb_length(tvb)){
    if (tree) {
       pinfo-&gt;desegment_offset = offset;
       pinfo-&gt;desegment_len = artrh-&gt;th_length - tvb_length(tvb);
       choixMessageASA(artrh, tvb, asa_tree, &amp;offset);
} else {
    if (tree) {
       choixMessageASA(artrh, tvb, asa_tree, &amp;offset);
    }
}
</code></pre></div>
            <div class="comment-info" id="comment-37785-info">
                
                
                
                

                

                <span class="comment-age">(12 Nov '14, 04:45)</span>
                <a class="comment-user userinfo" href="/users/11435/guillaume">Guillaume</a>
                
            </div>
        </div>
    
        <a name="37786"></a>
        <div class="comment not_top_scorer" id="comment-37786">
            <div id="post-37786-score" class="comment-score"></div>
            <div class="comment-text"><p>Higer up in the post before the code box you have</p>

<blockquote>
<p>if (tree) {
if that's in your code and the code block is inside it - it's wrong.
e.g the reassembly code must not be inside an if(tree) attement.</p>
</blockquote></div>
            <div class="comment-info" id="comment-37786-info">
                
                
                
                

                

                <span class="comment-age">(12 Nov '14, 05:00)</span>
                <a class="comment-user userinfo" href="/users/42/anders">Anders ♦</a>
                
            </div>
        </div>
    
        <a name="37789"></a>
        <div class="comment not_top_scorer" id="comment-37789">
            <div id="post-37789-score" class="comment-score"></div>
            <div class="comment-text"><p>I'm sorry, I did not understand what you meant! I succeeded to make it work according your advice, thank you!</p>

<p>Quick question, how can I customize the "length" column to display the length of the reassembled message and not the length of the normal message?</p></div>
            <div class="comment-info" id="comment-37789-info">
                
                
                
                

                

                <span class="comment-age">(12 Nov '14, 05:51)</span>
                <a class="comment-user userinfo" href="/users/11435/guillaume">Guillaume</a>
                
            </div>
        </div>
    
        <a name="37790"></a>
        <div class="comment not_top_scorer" id="comment-37790">
            <div id="post-37790-score" class="comment-score"></div>
            <div class="comment-text"><p>Use something like <code>col_add_fstr(pinfo-&gt;cinfo, COL_PACKET_LENGTH, "%i", new_length);</code>, but be very careful about this, all Wireshark users and code expect the length column to contain the length of that frame, not reassembled length from subsequent frames.  You would be better adding the length as a field in the packet tree and possibly in the "Info" column.</p></div>
            <div class="comment-info" id="comment-37790-info">
                
                
                
                

                

                <span class="comment-age">(12 Nov '14, 06:13)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="37807"></a>
        <div class="comment not_top_scorer" id="comment-37807">
            <div id="post-37807-score" class="comment-score"></div>
            <div class="comment-text"><p>The changes made to the hiqnet dissector <a href="https://code.wireshark.org/review/#/c/5267/1">here</a> show how simple it is to do reassembly when using tcp_dissect_pdus().</p></div>
            <div class="comment-info" id="comment-37807-info">
                
                
                
                

                

                <span class="comment-age">(13 Nov '14, 01:39)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="37817"></a>
        <div class="comment not_top_scorer" id="comment-37817">
            <div id="post-37817-score" class="comment-score"></div>
            <div class="comment-text"><p>I have already tried this method but I have two warnings during compilation :</p>

<ul>
<li>
<p><code>warning C4020: 'tcp_dissect_pdus' : too many actuals parameters</code> but if I remove the "data" parameter at the end of <code>tcp_dissect_pdu</code> the warning disappears...</p>
</li>
<li>
<p><code>warning C4013: 'tcp_captured_length' undefined; assuming extern returning int</code> while i imported the correct files...</p>
</li>
</ul>

<p>This is why I have not used this method even if it is faster :/</p></div>
            <div class="comment-info" id="comment-37817-info">
                
                
                
                

                

                <span class="comment-age">(13 Nov '14, 04:38)</span>
                <a class="comment-user userinfo" href="/users/11435/guillaume">Guillaume</a>
                
            </div>
        </div>
    
        <a name="37819"></a>
        <div class="comment not_top_scorer" id="comment-37819">
            <div id="post-37819-score" class="comment-score"></div>
            <div class="comment-text"><p>Are you using an older version of source code, rather than trunk (or 1.12)?</p>

<p>The <code>dissector_data</code> parameter was added to <code>tcp_dissect_pdus</code> last year:</p>

<blockquote><code>
commit 8081cf1d90397cbbb4404f9720595e1537ed5e14                                                    
Author: Michael Mann &lt;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="9ef3f3fff0f0a9a6def0fbeaedfdffeefbb0f0fbea">[email&#160;protected]</a>&gt;                                                        
Date:   Sat Nov 9 17:46:28 2013 +0000

    Add data parameter to tcp_dissect_pdus() as well as convert it to using "new" style dissectors.
</code></blockquote>

<p>Did you actually use <code>tcp_captured_length</code> in your code or is that just a typo in your comment?  It should be <code>tvb_captured_length</code> and that was added earlier this year:</p>

<blockquote><code>
commit 22149c5523a77e642ec13d12064b2ccef29e51fb                                     
Author: Evan Huus &lt;<a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="3451554455575c51745359555d581a575b59">[email&#160;protected]</a>&gt;                                               
Date:   Sat Feb 22 08:39:57 2014 -0500

    TVB API deprecations and cleanup                                                

    - rename tvb_length and similar to tvb_captured_length and similar; leave       
      #defines in place for backwards-compat, but mark them clearly as deprecated in
      code comments and in checkAPI                                                 
</code></blockquote></div>
            <div class="comment-info" id="comment-37819-info">
                
                
                
                

                

                <span class="comment-age">(13 Nov '14, 04:57)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="37820"></a>
        <div class="comment not_top_scorer" id="comment-37820">
            <div id="post-37820-score" class="comment-score"></div>
            <div class="comment-text"><p>I use an an older version is why the <code>tcp_dissect_pdus</code> does not work with the data parameter! You're right!</p>

<p>For <code>tvb_captured_length</code> is a typo from me in my comment for the <code>tcp</code> .. Maybe the warning is there because I do not have the latest version of Wireshark.</p>

<p>Anyway, thank you all for your answers, it has been of great help!</p></div>
            <div class="comment-info" id="comment-37820-info">
                
                
                
                

                

                <span class="comment-age">(13 Nov '14, 05:33)</span>
                <a class="comment-user userinfo" href="/users/11435/guillaume">Guillaume</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-37566" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 14
        </span>
        <a href="#" class="show-all-comments-link">show 9 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-37566-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
        <form id="fmanswer" action="/questions/37566/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='bCYHXPCyZMe622MocNHCIh2ziSR15bgA' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Be the first one to answer this question!
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/37566/wireshark-dissector-development-reassembly-tcp-frames?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/37566/wireshark-dissector-development-reassembly-tcp-frames?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/wireshark/"
            class="tag-link-wireshark"
            title="see questions tagged'wireshark'using tags"
            rel="tag">wireshark</a> <span class="tag-number">&#215;1,620</span><br/>
        
        <a href="/tags/tcp/"
            class="tag-link-tcp"
            title="see questions tagged'tcp'using tags"
            rel="tag">tcp</a> <span class="tag-number">&#215;752</span><br/>
        
        <a href="/tags/dissector/"
            class="tag-link-dissector"
            title="see questions tagged'dissector'using tags"
            rel="tag">dissector</a> <span class="tag-number">&#215;637</span><br/>
        
        <a href="/tags/reassembly/"
            class="tag-link-reassembly"
            title="see questions tagged'reassembly'using tags"
            rel="tag">reassembly</a> <span class="tag-number">&#215;78</span><br/>
        
        <a href="/tags/help/"
            class="tag-link-help"
            title="see questions tagged'help'using tags"
            rel="tag">help</a> <span class="tag-number">&#215;63</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Nov. 4, 2014, 4:47 a.m.">04 Nov '14, 04:47</strong>
    </p>
    <p> 
     	question was seen: <strong>16,654 times</strong>
    </p>
    <p> 
        last updated: <strong title="Nov. 13, 2014, 5:33 a.m.">13 Nov '14, 05:33</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/22600/getting-pdus-length">getting PDUs length</a>
        </p>
        
        <p>
            <a href="/questions/35584/wireshark-documentation">Wireshark Documentation</a>
        </p>
        
        <p>
            <a href="/questions/22612/how-to-add-extra-dissected-packets-to-info-column-when-reassembling-is-on">How to add extra dissected packets to info column when reassembling is on</a>
        </p>
        
        <p>
            <a href="/questions/5382/custom-dissector-and-info-column">Custom dissector and info column</a>
        </p>
        
        <p>
            <a href="/questions/44057/complex-lua-tcp-reassembly-problem">Complex Lua TCP Reassembly Problem</a>
        </p>
        
        <p>
            <a href="/questions/20001/reassembling-tcp-fragments-doesnt-reassemble-some-packets">Reassembling TCP fragments doesn&#39;t reassemble some packets</a>
        </p>
        
        <p>
            <a href="/questions/43383/during-reassembly-of-a-protocol-running-on-top-of-tcp-setting-desegment_offset0-and-desegment_lendesegment_one_more_segment-seems-to-break-down-the-behavior-stated-in-readmedissector-is-this-expected">During reassembly of a protocol running on top of TCP, setting desegment_offset=0 and desegment_len=DESEGMENT_ONE_MORE_SEGMENT seems to break down the behavior stated in README.dissector. Is this expected?</a>
        </p>
        
        <p>
            <a href="/questions/48918/tcp-retransmissions-reassembled-pdu-tcp-out-of-order-issue-with-slow-connectivity">TCP Retransmissions, reassembled PDU, TCP Out-of-order, issue with slow connectivity</a>
        </p>
        
        <p>
            <a href="/questions/1357/lua-tcp-reassembly">Lua TCP reassembly</a>
        </p>
        
        <p>
            <a href="/questions/18082/tcp_dissect_pdus-doesnt-work-well-tcp-segment-of-a-reassembled-pdu">tcp_dissect_pdus doesn&#39;t work well - TCP segment of a reassembled PDU</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
