<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>TCP handshake question - Wireshark Q&amp;A</title>
        <meta name="description" content="HI I am trying to troubleshoot some issues on a Linux Apache web server (very slow response several times during the day). For testing i am trying to load a page on my laptop (192.168.249.2) from the web server (172.18.26.41).  I used wireshark and noticed some TCP retransmissions and TCP DUP ACKs, ..." />
        <meta name="keywords" content="dup-ack,handshake,tcp" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/33690/tcp-handshake-question" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/33690/tcp-handshake-question?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='cmBVsGyezR80V4gljuP3aAm8TKZU0Iqm' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/33690/tcp-handshake-question">TCP handshake question</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-33690-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/33690/up/" rel="nofollow"> </a>
<div id="post-33690-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-33690-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/33690/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/33690/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>HI</p>
<p>I am trying to troubleshoot some issues on a Linux Apache web server (very slow response several times during the day).  For testing i am trying to load a page on my laptop (192.168.249.2) from the web server (172.18.26.41).<br>
</p>
<p>I used wireshark and noticed some TCP retransmissions and TCP DUP ACKs, see below, I ran the trace on both ends and saw the same results so no packets are going missing.  I cant see anything out of sequence here and i don't understand why 26.41(web) is sending a TCP retransmission (22461) if its already received an ACK in packet 21453.</p>
<p>It only does this when there is a heavy load on the server, could this be an application (Apache) issue where port 80 becomes unavailable, could wireshark have seen packet 21453 come in but if apache is busy and port 80 becomes unavailable 26.41 issues a re transmission??</p>
<p>There doesn't appear to be any congestion on the network, we have 100mb link into the MPLS and a 1gb at the other end and the highest utilisation is approx 30%.</p>
<pre><code>21432   0.000   192.168.249.2   172.18.26.41    TCP 55708 &gt; http [SYN] Seq=0 Win=8192 Len=0 MSS=1460 SACK_PERM=1 TSval=70329226 TSecr=0

21433   0.000   172.18.26.41    192.168.249.2   TCP http &gt; 55708 [SYN, ACK] Seq=0 Ack=1 Win=14480 Len=0 MSS=1460 SACK_PERM=1 TSval=33418600 TSecr=70329226

21453   0.000   192.168.249.2   172.18.26.41    TCP 55708 &gt; http [ACK] Seq=1 Ack=1 Win=65160 Len=0 TSval=70329226 TSecr=33418600

22461   0.000   172.18.26.41    192.168.249.2   TCP [TCP Retransmission] http &gt; 55708 [SYN, ACK] Seq=0 Ack=1 Win=14480 Len=0 MSS=1460 SACK_PERM=1 TSval=33418876 TSecr=70329226

22470   0.000   192.168.249.2   172.18.26.41    TCP [TCP Dup ACK 21453#1] 55708 &gt; http [ACK] Seq=1 Ack=1 Win=65160 Len=0 TSval=70329337 TSecr=33418600 SLE=0 SRE=1

24541   0.000   172.18.26.41    192.168.249.2   TCP [TCP Retransmission] http &gt; 55708 [SYN, ACK] Seq=0 Ack=1 Win=14480 Len=0 MSS=1460 SACK_PERM=1 TSval=33419377 TSecr=70329337

24546   0.000   192.168.249.2   172.18.26.41    TCP [TCP Dup ACK 21453#2] 55708 &gt; http [ACK] Seq=1 Ack=1 Win=65160 Len=0 TSval=70329537 TSecr=33418600 SLE=0 SRE=1

26976   0.000   172.18.26.41    192.168.249.2   TCP [TCP Retransmission] http &gt; 55708 [SYN, ACK] Seq=0 Ack=1 Win=14480 Len=0 MSS=1460 SACK_PERM=1 TSval=33420378 TSecr=70329537

26979   0.000   192.168.249.2   172.18.26.41    TCP [TCP Dup ACK 21453#3] 55708 &gt; http [ACK] Seq=1 Ack=1 Win=65160 Len=0 TSval=70329937 TSecr=33418600 SLE=0 SRE=1

32111   0.000   192.168.249.2   172.18.26.41    TCP 55708 &gt; http [FIN, ACK] Seq=1 Ack=1 Win=65160 Len=0 TSval=70330565 TSecr=33418600

32458   0.000   192.168.249.2   172.18.26.41    TCP [TCP Retransmission] 55708 &gt; http [FIN, ACK] Seq=1 Ack=1 Win=65160 Len=0 TSval=70330595 TSecr=33418600

33001   0.000   192.168.249.2   172.18.26.41    TCP [TCP Retransmission] 55708 &gt; http [FIN, ACK] Seq=1 Ack=1 Win=65160 Len=0 TSval=70330655 TSecr=33418600

33008   0.000   172.18.26.41    192.168.249.2   TCP http &gt; 55708 [ACK] Seq=1 Ack=2 Win=14480 Len=0 TSval=33422175 TSecr=70330655
</code></pre>
<p>Any help would be helpful.</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/dup-ack/" class="post-tag tag-link-dup-ack"
                                        title="see questions tagged 'dup-ack'" rel="tag">dup-ack</a>
                                
                                    <a href="/tags/handshake/" class="post-tag tag-link-handshake"
                                        title="see questions tagged 'handshake'" rel="tag">handshake</a>
                                
                                    <a href="/tags/tcp/" class="post-tag tag-link-tcp"
                                        title="see questions tagged 'tcp'" rel="tag">tcp</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>12 Jun '14, 03:18</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/928ee1169df4504c262e98c1fff1f03c?s=32&amp;d=identicon&amp;r=g" alt="navs_123456's gravatar image" />
    <p><a href="/users/7508/navs_123456">navs_123456</a><br/>
    <span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">&#9679;</span><span class="badgecount">2</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="navs_123456 has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/33690/">
                edited
                <strong>12 Jun '14, 03:20</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" alt="grahamb's gravatar image" />
            <p><a href="/users/1225/grahamb">grahamb ♦</a><br/>
            <span class="score" title="19834 reputation points"><span class="">19.8k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">&#9679;</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">&#9679;</span><span class="badgecount">206</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-33690">
    
        <a name="33691"></a>
        <div class="comment" id="comment-33691">
            <div id="post-33691-score" class="comment-score"></div>
            <div class="comment-text"><p><img alt="alt text" src="https://osqa-ask.wireshark.org/upfiles/Capture_7.JPG"></p></div>
            <div class="comment-info" id="comment-33691-info">
                
                
                
                

                

                <span class="comment-age">(12 Jun '14, 03:20)</span>
                <a class="comment-user userinfo" href="/users/7508/navs_123456">navs_123456</a>
                
            </div>
        </div>
    
        <a name="33692"></a>
        <div class="comment" id="comment-33692">
            <div id="post-33692-score" class="comment-score">1</div>
            <div class="comment-text"><p>It's time consuming to do an analysis based on text exports and screen shots. Can you please post a pcap file somewhere, like Google drive, dropbox or cloudshark.org?</p></div>
            <div class="comment-info" id="comment-33692-info">
                
                
                
                

                

                <span class="comment-age">(12 Jun '14, 03:30)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="33694"></a>
        <div class="comment" id="comment-33694">
            <div id="post-33694-score" class="comment-score"></div>
            <div class="comment-text"><p>hi, try this <a href="https://dl.dropboxusercontent.com/u/48120370/172.18.26.41-DuringSlow-11am-spec.pcap">https://dl.dropboxusercontent.com/u/48120370/172.18.26.41-DuringSlow-11am-spec.pcap</a> , i have cleaned the file so the packet numbers have changed.</p></div>
            <div class="comment-info" id="comment-33694-info">
                
                
                
                

                

                <span class="comment-age">(12 Jun '14, 03:55)</span>
                <a class="comment-user userinfo" href="/users/7508/navs_123456">navs_123456</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-33690" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-33690-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    4 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/33690/tcp-handshake-question?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/33690/tcp-handshake-question?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/33690/tcp-handshake-question?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/33690/tcp-handshake-question?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="33796"></a>
                    <div id="answer-container-33796" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-33796-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/33796/up/" rel="nofollow"> </a>
<div id="post-33796-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-33796-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/33796/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>After doing a googling found that it could be causing because of TCP_DEFER_ACCEPT option,Please check similar behaviour in this link,
<a href="http://webcache.googleusercontent.com/search?q=cache:zoA_A0cao28J:https://labs.ripe.net/Members/gih/the-curious-case-of-the-crooked-tcp-handshake+&amp;cd=9&amp;hl=en&amp;ct=clnk&amp;gl=in">http://webcache.googleusercontent.com/search?q=cache:zoA_A0cao28J:https://labs.ripe.net/Members/gih/the-curious-case-of-the-crooked-tcp-handshake+&amp;cd=9&amp;hl=en&amp;ct=clnk&amp;gl=in</a></p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/33796/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>14 Jun '14, 00:35</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/6f9cdab5081b4272d1abf703a2689372?s=32&amp;d=identicon&amp;r=g" alt="kishan%20pandey's gravatar image" />
    <p><a href="/users/4851/kishan-pandey">kishan pandey</a><br/>
    <span class="score" title="221 reputation points">221</span><span title="28 badges"><span class="badge1">&#9679;</span><span class="badgecount">28</span></span><span title="29 badges"><span class="silver">&#9679;</span><span class="badgecount">29</span></span><span title="36 badges"><span class="bronze">&#9679;</span><span class="badgecount">36</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="kishan pandey has 2 accepted answers">28&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-33796">
    
        <a name="33817"></a>
        <div class="comment" id="comment-33817">
            <div id="post-33817-score" class="comment-score"></div>
            <div class="comment-text"><p>Very good find!! </p>

<p>Thanks a lot for that link for several reasons</p>

<ul>
<li>It shows a similar behavior, like the one described in the question.</li>
<li>it could explain what caused the problem (see my next answer)</li>
<li>I did not know about TCP_DEFER_ACCEPT and I have never seen that 'in the wild'. Cool!</li>
<li>I did not know RIPE labs. They have some interesting stuff on their site</li>
</ul>

<p>BTW: <strong>How did you find that article? What did you search for?</strong></p>

<p><strong>Hint:</strong> I converted your comment to an answer, as it is an answer in itself. It does not explain what is causing the problem, but it might help to do so! Please <a href="http://ask.wireshark.org/faq/">read the FAQ</a>, for how this site works.</p></div>
            <div class="comment-info" id="comment-33817-info">
                
                
                
                

                

                <span class="comment-age">(15 Jun '14, 03:06)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="33821"></a>
        <div class="comment" id="comment-33821">
            <div id="post-33821-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks Kurt for encouraging words for a Learner like me,I googled for "retransmit syn ack even after receiving ack" and it worked.</p></div>
            <div class="comment-info" id="comment-33821-info">
                
                
                
                

                

                <span class="comment-age">(15 Jun '14, 05:55)</span>
                <a class="comment-user userinfo" href="/users/4851/kishan-pandey">kishan pandey</a>
                
            </div>
        </div>
    
        <a name="33822"></a>
        <div class="comment" id="comment-33822">
            <div id="post-33822-score" class="comment-score"></div>
            <div class="comment-text"><p>cool. Keep going ;-)</p></div>
            <div class="comment-info" id="comment-33822-info">
                
                
                
                

                

                <span class="comment-age">(15 Jun '14, 06:18)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-33796" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-33796-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="33818"></a>
                    <div id="answer-container-33818" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-33818-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/33818/up/" rel="nofollow"> </a>
<div id="post-33818-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-33818-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/33818/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Based on the answer of <a href="/users/4851/kishan-pandey"><a href="/users/4851/kishan-pandey">@kishan pandey</a></a> (TCP_DEFER_ACCEPT), here is a new attempt to explain what could have happened: </p>
<p>TCP_DEFER_ACCEPT makes the server wait for a data packet from the client, which never arrives, so the SYN-ACK is sent again. </p>
<p>Now, the interesting question is: Why is there no data packet (HTTP GET, POST, HEAD) from the client?</p>
<p>A possible answer: Because it's not the client who ACKs the SYN-ACK, but 'something' between the client and the server. And now we should have a look at your Fortinet Firewall (concluded from the MAC address used in the capture file).</p>
<p>Maybe the Fortinet acts as a TCP or SYN proxy, because there is a content scanning feature enabled on that firewall and that's causing problems.</p>
<pre>client  ----------  Fortinet ------------ server

        SYN -&gt;               SYN -&gt; 
                                   &lt;- SYN-ACK (wrong check sum !!)
                             ACK -&gt;
                                   &lt;- SYN-ACK (wrong check sum !!)
        SYN -&gt; (dropped)     ACK -&gt;

</pre>

<p>Maybe the client sends a SYN and the firewall forwards that SYN to the server.
The server answers with a SYN-ACK (wrong check sum in the capture file), which gets answered by the firewall (SYN proxy, TCP proxy) with an ACK. But then the firewall <strong>does not forward the SYN-ACK</strong> to the client and also drops any further SYN (re-transmit) from the client, for whatever reason (Hint: the SYN-ACK from the server shows a wrong check sum in the capture file - which could be true or caused by TCP offloading on the server). </p>
<p>As the client has no chance to send the data packet (never seen the SYN-ACK), the server will resend its SYN-ACK due to the TCP_DEFER_ACCEPT option. </p>
<p>So, the key to analyze this problem is a capture file taken at the client and the server in parallel, to check who is doing what.</p>
<p><a href="/users/7508/navs_123456"><a href="/users/7508/navs_123456">@navs_123456</a></a>: Can you please post both capture files (client and server), so we can check my new theory :-) </p>
<p>Regards <br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/33818/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>15 Jun '14, 03:24</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/33818/">
                edited
                <strong>15 Jun '14, 03:32</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-33818">
    
</div>
<div id="comment-tools-33818" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-33818-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="33702"></a>
                    <div id="answer-container-33702" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-33702-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/33702/up/" rel="nofollow"> </a>
<div id="post-33702-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-33702-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/33702/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Looks like the ACK for the SYN-ACK does not get through to the server, so the SYN-ACK is sent again and again. </p>
<p>You have created the capture file on (or near) the client. What do you see in the capture file on (or near) the server at the same time?</p>
<p>Regards <br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/33702/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>12 Jun '14, 05:19</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/33702/">
                edited
                <strong>12 Jun '14, 07:10</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-33702">
    
        <a name="33717"></a>
        <div class="comment" id="comment-33717">
            <div id="post-33717-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi Kurt, this is the capture on the linix web server 172.18.26.41 (used tcpdump), this is what puzzles me, the server is actually seeing ACK for the SYN ACK, or at least wireshark can see it.</p></div>
            <div class="comment-info" id="comment-33717-info">
                
                
                
                

                

                <span class="comment-age">(12 Jun '14, 08:02)</span>
                <a class="comment-user userinfo" href="/users/7508/navs_123456">navs_123456</a>
                
            </div>
        </div>
    
        <a name="33718"></a>
        <div class="comment" id="comment-33718">
            <div id="post-33718-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>this is the capture on the linix web server 172.18.26.41 (used tcpdump),</p>
</blockquote>

<p>Ah, you're right. It's on the server. I messed up the delta times of SYN-ACK and ACK ;-)</p>

<blockquote>
<p>his is what puzzles me, the server is actually seeing ACK for the SYN ACK, or at least wireshark can see it.</p>
</blockquote>

<p>Yes, that's 'strange'. Is there any firewall (iptables) on that server? </p>

<p>What is the output of the following commands?</p>

<blockquote>
<p>iptables -L -nv </p>
</blockquote>

<p>and </p>

<blockquote>
<p>conntrack -L</p>
</blockquote>

<p>Furthermore:</p>

<blockquote>
<p>netstat -ns -w</p>
</blockquote>

<p>Do you see an 'increasing' number of the following?</p>

<pre>IP: 
    0 with invalid addresses
    0 incoming packets discarded
    0 dropped because of missing route
</pre>

<blockquote>
<p>netstat -ns -t</p>
</blockquote>

<p>Do you see an 'increasing' number of the following?</p>

<pre>Tcp:
    0 failed connection attempts
    0 bad segments received.
</pre></div>
            <div class="comment-info" id="comment-33718-info">
                
                
                
                

                

                <span class="comment-age">(12 Jun '14, 08:18)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="33719"></a>
        <div class="comment" id="comment-33719">
            <div id="post-33719-score" class="comment-score"></div>
            <div class="comment-text"><p>BTW: One thing I found in the capture file. The <strong>TSval</strong> values of the SYN and ACK frames are <strong>identical</strong> although the time delta is ~4ms. I've never heard about a linux kernel feature that drops frames like these, but you'll never know. </p>

<p>What do you see in the capture files from the same client, while a connection works. Is the <strong>TSval</strong> value identical as well (maybe set/updated by your Fortinet).</p></div>
            <div class="comment-info" id="comment-33719-info">
                
                
                
                

                

                <span class="comment-age">(12 Jun '14, 08:38)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="33720"></a>
        <div class="comment" id="comment-33720">
            <div id="post-33720-score" class="comment-score"></div>
            <div class="comment-text"><p>One more thing, as I have seen similar things recently. How many entries do see in the output of the following command, while the system behaves like you described it?</p>

<blockquote>
<p>netstat -nat</p>
</blockquote>

<p>How many of them are in TIME_WAIT and how many in ESTABLISHED and SYN_SENT state</p>

<blockquote>
<p>netstat -nat &gt; netstat.txt <br>
grep TIME_WAIT netstat.txt | wc -l <br>
grep ESTABLISHED netstat.txt | wc -l   <br>
grep SYN_SENT netstat.txt | wc -l   <br>
wc -l netstat.txt</p>
</blockquote></div>
            <div class="comment-info" id="comment-33720-info">
                
                
                
                

                

                <span class="comment-age">(12 Jun '14, 08:50)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="33763"></a>
        <div class="comment" id="comment-33763">
            <div id="post-33763-score" class="comment-score"></div>
            <div class="comment-text"><p>HI Kurt</p>

<p>Dont believe any firewall is enabled.</p>

<p><strong>iptables -L -nv</strong></p>

<p>Chain INPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination                       <br>
</p>

<p>Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination                       <br>
</p>

<p>Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination<br>
</p>

<p><strong>conntrack -L</strong> doesnt appear to exist</p>

<p><strong>netstat -ns -w</strong> this looks ok to me.</p>

<p>Ip:</p>

<pre><code>17642648 total packets received
0 forwarded
0 incoming packets discarded
17640734 incoming packets delivered
15326802 requests sent out
4 dropped because of missing route
</code></pre>

<p><strong>netstat -ns -t</strong></p>

<p>Tcp: looks like a few issues here.</p>

<pre><code>1073142 active connections openings
511389 passive connection openings
5100 failed connection attempts
55827 connection resets received
25 connections established
17545014 segments received
19464507 segments send out
437359 segments retransmited
705 bad segments received.
265095 resets sent
</code></pre></div>
            <div class="comment-info" id="comment-33763-info">
                
                
                
                

                

                <span class="comment-age">(13 Jun '14, 02:43)</span>
                <a class="comment-user userinfo" href="/users/7508/navs_123456">navs_123456</a>
                
            </div>
        </div>
    
        <a name="33766"></a>
        <div class="comment not_top_scorer" id="comment-33766">
            <div id="post-33766-score" class="comment-score"></div>
            <div class="comment-text"><p>HI</p>

<p>out of the 900 entries in netstat -nat i had the following (this was during the busy period)</p>

<pre>15 CLOSE_WAIT
266 ESTABLISHED
3 FIN_WAIT2
126 SYN_RECV
510 TIME_WAIT
</pre></div>
            <div class="comment-info" id="comment-33766-info">
                
                
                
                

                

                <span class="comment-age">(13 Jun '14, 04:48)</span>
                <a class="comment-user userinfo" href="/users/7508/navs_123456">navs_123456</a>
                
            </div>
        </div>
    
        <a name="33767"></a>
        <div class="comment not_top_scorer" id="comment-33767">
            <div id="post-33767-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi, also my comment about the TSval seems to have dissapered. </p>

<p>Basically it said that i ran the test twice during a time where the connection was working normally, both times the delta between the SYN and ACK was 3ms, once the TSval incemented by 1 and the second time it didnt increment.</p></div>
            <div class="comment-info" id="comment-33767-info">
                
                
                
                

                

                <span class="comment-age">(13 Jun '14, 04:56)</span>
                <a class="comment-user userinfo" href="/users/7508/navs_123456">navs_123456</a>
                
            </div>
        </div>
    
        <a name="33769"></a>
        <div class="comment not_top_scorer" id="comment-33769">
            <div id="post-33769-score" class="comment-score"></div>
            <div class="comment-text"><p>O.K. let's sum it up:</p>

<p>There is no firewall on the server, so nothing that could block the (valid) ACks. </p>

<p>There is no problem with the number of sessions, regardless of their state, as even 510 connections in TIME_WAIT is <strong>nothing</strong> for a busy web server.</p>

<p>There are some 'interesting' TCP counters (like <strong>5100 failed connection attempts</strong>), but the reason for those are unknown. <strong>Could be related to your problem</strong>.</p>

<p>You are capturing on the server, so the ACKs should get through to the OS, as Wireshark sees them as well.</p>

<p>There seems to be no problem with the TSval time stamps, as you have observed working connections, with the same TSval value for the SYN and the ACK frame (at least that's how I understand your comment).</p>

<p>Unfortunately I'm running out of ideas. You could try to enable debug logging in apache and check if you get any results. However, as long as the OS does not accept the 3-way-handshake ACK, I doubt that apache will ever get 'notified' about the new connection. So, to me it looks like a problem in the OS (kernel), but I don't have any explanation to offer, as everything looks good.</p>

<p>One last thing: You can try to disable TCP offloading, if it is enabled. And then check if things are getting better.</p>

<blockquote>
<p><a href="http://wiki.wireshark.org/CaptureSetup/Offloading">http://wiki.wireshark.org/CaptureSetup/Offloading</a> <br>
<a href="http://sandilands.info/sgordon/segmentation-offloading-with-wireshark-and-ethtool">http://sandilands.info/sgordon/segmentation-offloading-with-wireshark-and-ethtool</a></p>
</blockquote></div>
            <div class="comment-info" id="comment-33769-info">
                
                
                
                

                

                <span class="comment-age">(13 Jun '14, 06:30)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="33775"></a>
        <div class="comment not_top_scorer" id="comment-33775">
            <div id="post-33775-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi Kurt, yes you have understood all correctly. </p>

<p>I am wondering about the 126 SYN_RECV messages, suggests the OS hasnt seen an ACK for these SYNs. </p>

<p>I will try some more troubleshooting and try and marry up a new wireshark capture with netstat -nat command, to see if wireshark see's the ACKs come in from the client but the netstat -nat is still sitting in SYN_RECV. This i guess would confirm its some sort of OS issue.</p>

<p>Thanks for your help.</p></div>
            <div class="comment-info" id="comment-33775-info">
                
                
                
                

                

                <span class="comment-age">(13 Jun '14, 08:27)</span>
                <a class="comment-user userinfo" href="/users/7508/navs_123456">navs_123456</a>
                
            </div>
        </div>
    
        <a name="33778"></a>
        <div class="comment not_top_scorer" id="comment-33778">
            <div id="post-33778-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>I am wondering about the 126 SYN_RECV messages, suggests the OS hasnt seen an ACK for these SYNs. </p>
</blockquote>

<p>Yes, that could be another sign for your problem. As I cannot find any problem within the ACK frame (checksum O.K., etc.) I have no explanation to offer why the OS might drop that ACK frame.</p>

<blockquote>
<p>This i guess would confirm its some sort of OS issue.</p>
</blockquote>

<p>agreed. BTW: What happens if you restart apache while you see that many connections in SYN_RECV state?<br>
</p>

<p>BTW: did you check/disable TCP offloading?</p></div>
            <div class="comment-info" id="comment-33778-info">
                
                
                
                

                

                <span class="comment-age">(13 Jun '14, 09:18)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="33779"></a>
        <div class="comment not_top_scorer" id="comment-33779">
            <div id="post-33779-score" class="comment-score"></div>
            <div class="comment-text"><p>One more thing...</p>

<p>Can you please run the following command and post the output for some of the SYN_RECV connections</p>

<blockquote>
<p>ss -t -epim</p>
</blockquote></div>
            <div class="comment-info" id="comment-33779-info">
                
                
                
                

                

                <span class="comment-age">(13 Jun '14, 09:22)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-33702" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 11
        </span>
        <a href="#" class="show-all-comments-link">show 6 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-33702-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="33739"></a>
                    <div id="answer-container-33739" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-33739-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/33739/up/" rel="nofollow"> </a>
<div id="post-33739-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-33739-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/33739/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Maybe the TCP or IP  checksumm is incorrect. The trace file is gone again so I couldn't check myself </p>
<hr>
<p>Ok,  found the trace by removing the '.' from the URL  and the checksums are correct.<br>
Could you check whether <a href="http://cr.yp.to/syncookies.html">syncookies</a> are enabled on your server and test by disabling it. 
<code>cat /proc/sys/net/ipv4/tcp_syncookies</code>  <br>
126 SYN-RECV half-open connections look a bit high to me</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/33739/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>12 Jun '14, 13:13</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/5500bd1decb766660522dfb347eedc49?s=32&amp;d=identicon&amp;r=g" alt="mrEEde's gravatar image" />
    <p><a href="/users/4668/mreede">mrEEde</a><br/>
    <span class="score" title="3892 reputation points"><span class="">3.9k</span></span><span title="15 badges"><span class="badge1">&#9679;</span><span class="badgecount">15</span></span><span title="22 badges"><span class="silver">&#9679;</span><span class="badgecount">22</span></span><span title="70 badges"><span class="bronze">&#9679;</span><span class="badgecount">70</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="mrEEde has 48 accepted answers">20&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/33739/">
                edited
                <strong>13 Jun '14, 12:01</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-33739">
    
        <a name="33793"></a>
        <div class="comment" id="comment-33793">
            <div id="post-33793-score" class="comment-score"></div>
            <div class="comment-text"><p>Isn't the idea of SYN cookies to have <strong>no queue</strong>? So, if SYN cookies are enabled, there should be no SYN_RECV at all, as the socket will be 're-created' only after a valid ACK has been received. At least that's how I understand it. I might be wrong...</p></div>
            <div class="comment-info" id="comment-33793-info">
                
                
                
                

                

                <span class="comment-age">(13 Jun '14, 13:47)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="33801"></a>
        <div class="comment" id="comment-33801">
            <div id="post-33801-score" class="comment-score"></div>
            <div class="comment-text"><p>from <a href="http://lwn.net/Articles/277146/">http://lwn.net/Articles/277146/</a> : 
" Due to this limitation, and the modest computation overhead of the cryptographic hash, the Linux stack only resorts to syncookie based connections when the number of half-open connection exceeds a high watermark controlled by the net.ipv4.tcp_max_syn_backlog sysctl." 
I was thinking that the syn_backlog might be sitting at 128 and only then the syn_cookie code would kick in. But ... I might be wrong ;-)</p>

<p>Should be easy enough though to try it out and feedback</p></div>
            <div class="comment-info" id="comment-33801-info">
                
                
                
                

                

                <span class="comment-age">(14 Jun '14, 05:51)</span>
                <a class="comment-user userinfo" href="/users/4668/mreede">mrEEde</a>
                
            </div>
        </div>
    
        <a name="33816"></a>
        <div class="comment" id="comment-33816">
            <div id="post-33816-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>I was thinking that the syn_backlog might be sitting at 128 and only then the syn_cookie code would kick in.</p>
</blockquote>

<p>Good point regarding the 'late use' SYN cookies!</p>

<p>But then, if the number of half open connections is the <strong>trigger</strong> for using SYN cookies, how would disabling SYN cookies fix the problem that caused the half open connections?  ;-))</p></div>
            <div class="comment-info" id="comment-33816-info">
                
                
                
                

                

                <span class="comment-age">(15 Jun '14, 03:03)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-33739" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-33739-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/33690/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='cmBVsGyezR80V4gljuP3aAm8TKZU0Iqm' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/33690/tcp-handshake-question?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/33690/tcp-handshake-question?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/tcp/"
            class="tag-link-tcp"
            title="see questions tagged'tcp'using tags"
            rel="tag">tcp</a> <span class="tag-number">&#215;752</span><br/>
        
        <a href="/tags/handshake/"
            class="tag-link-handshake"
            title="see questions tagged'handshake'using tags"
            rel="tag">handshake</a> <span class="tag-number">&#215;44</span><br/>
        
        <a href="/tags/dup-ack/"
            class="tag-link-dup-ack"
            title="see questions tagged'dup-ack'using tags"
            rel="tag">dup-ack</a> <span class="tag-number">&#215;42</span><br/>
        
    </p>
    <p>
        question asked: <strong title="June 12, 2014, 3:18 a.m.">12 Jun '14, 03:18</strong>
    </p>
    <p> 
     	question was seen: <strong>19,271 times</strong>
    </p>
    <p> 
        last updated: <strong title="June 15, 2014, 6:24 a.m.">15 Jun '14, 06:24</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/4932/not-honoring-own-mss">Not honoring own MSS?</a>
        </p>
        
        <p>
            <a href="/questions/58283/what-would-cause-devices-not-to-respond-to-an-ip-cameras-synack-intermittently">What would cause devices not to respond to an IP camera&#39;s SYN/ACK intermittently?</a>
        </p>
        
        <p>
            <a href="/questions/17859/router-retransmitting-packets">router retransmitting packets</a>
        </p>
        
        <p>
            <a href="/questions/45028/capturing-tcp-handshake-but-no-data-traffic">Capturing TCP handshake but no data traffic</a>
        </p>
        
        <p>
            <a href="/questions/46490/details-about-do-not-call-subdissector-for-error-packets-tcp-preference">Details about &quot;Do not call subdissector for error packets&quot; TCP preference</a>
        </p>
        
        <p>
            <a href="/questions/48019/tcp-dup-ack-tcp-retransmission">TCP Dup ACK / TCP Retransmission</a>
        </p>
        
        <p>
            <a href="/questions/24683/why-would-a-client-not-send-the-ack-after-receiving-the-syn-ack-for-a-tcp-handshake-and-this-problem-affect-multiple-clients">Why would a client not send the [ACK] after receiving the [SYN, ACK] for a TCP handshake and this problem affect multiple clients?</a>
        </p>
        
        <p>
            <a href="/questions/57187/why-is-server-centos-6-sending-rst-after-tcp-three-way-handshake">Why is server (CentOS 6) sending RST after TCP three-way handshake?</a>
        </p>
        
        <p>
            <a href="/questions/15057/how-to-capture-tcp-3-way-handshake">How to capture tcp 3 way handshake</a>
        </p>
        
        <p>
            <a href="/questions/36646/tcp-dup-and-resetting-phone">TCP DUP and resetting phone</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
