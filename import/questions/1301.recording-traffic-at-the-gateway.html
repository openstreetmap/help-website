<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>recording traffic at the gateway - Wireshark Q&amp;A</title>
        <meta name="description" content="hi, somebody is constantly hacking my firewall. which way is there to record traffic at the gateway (which is a modem-router in my case)? do i need a hub where a second pc is running on which wireshark is recording? is there any tutorial on how to do this? a total beginner" />
        <meta name="keywords" content="recording,traffic,gateway" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/1301/recording-traffic-at-the-gateway" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/1301/recording-traffic-at-the-gateway?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='LR8FuI96EPLuIMPlZ92g9yYD5M5IkmQV' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/1301/recording-traffic-at-the-gateway">recording traffic at the gateway</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-1301-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/1301/up/" rel="nofollow"> </a>
<div id="post-1301-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-1301-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/1301/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/1301/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>hi, somebody is constantly hacking my firewall. which way is there to record traffic at the gateway (which is a modem-router in my case)?</p>
<p>do i need a hub where a second pc is running on which wireshark is recording? is there any tutorial on how to do this?</p>
<p>a total beginner</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/recording/" class="post-tag tag-link-recording"
                                        title="see questions tagged 'recording'" rel="tag">recording</a>
                                
                                    <a href="/tags/traffic/" class="post-tag tag-link-traffic"
                                        title="see questions tagged 'traffic'" rel="tag">traffic</a>
                                
                                    <a href="/tags/gateway/" class="post-tag tag-link-gateway"
                                        title="see questions tagged 'gateway'" rel="tag">gateway</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>09 Dec '10, 07:59</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7d69a51ae803b51b82ed57f4b40f1da8?s=32&amp;d=identicon&amp;r=g" alt="C8H10N4O2's gravatar image" />
    <p><a href="/users/425/c8h10n4o2">C8H10N4O2</a><br/>
    <span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="bronze">&#9679;</span><span class="badgecount">1</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="C8H10N4O2 has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/1301/">
                edited
                <strong>29 Feb '12, 19:01</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/55158e2322c4e365a5e0a4a0ac3fbcef?s=32&amp;d=identicon&amp;r=g" alt="cmaynard's gravatar image" />
            <p><a href="/users/402/cmaynard">cmaynard ♦♦</a><br/>
            <span class="score" title="9361 reputation points"><span class="">9.4k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="38 badges"><span class="silver">&#9679;</span><span class="badgecount">38</span></span><span title="142 badges"><span class="bronze">&#9679;</span><span class="badgecount">142</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-1301">
    
</div>
<div id="comment-tools-1301" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-1301-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    6 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/1301/recording-traffic-at-the-gateway?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/1301/recording-traffic-at-the-gateway?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/1301/recording-traffic-at-the-gateway?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/1301/recording-traffic-at-the-gateway?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="1305"></a>
                    <div id="answer-container-1305" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-1305-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/1305/up/" rel="nofollow"> </a>
<div id="post-1305-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-1305-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/1305/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Is the device that you are calling the firewall and "modem-router" the same device?  And by modem-router, is that terminating a DSL or cable modem connection?  If so, you are going to have difficulty capturing in front of it.  If this is all one device, it could conceivably log the information to a syslog server on the private side.  This does not give you the detail that you could see if you could capture packets on the public side.  The reason that your ability to capture in front of it is limited (again, assuming this is a single device) is that you would need hardware capability to sniff the connection.  It's not likely that you have this hardware.<br>
</p>
<p>If you have a cable or dsl connection terminating in what you are calling a modem-router and your firewall is behind it, then you could capture traffic between the two.  This would involve the standard methods.<br>
</p>
<p>1) A hub with the modem-router, firewall and capture pc.</p>
<p>2) A switch with span (or monitor) capability and the above devices connected</p>
<p>3) Network TAPs</p>
<p>Please post back where you need clarification to this. </p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/1305/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>09 Dec '10, 17:56</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/e62501f00394530927e4b0c9e86bfb46?s=32&amp;d=identicon&amp;r=g" alt="Paul%20Stewart's gravatar image" />
    <p><a href="/users/412/paul-stewart">Paul Stewart</a><br/>
    <span class="score" title="301 reputation points">301</span><span title="8 badges"><span class="bronze">&#9679;</span><span class="badgecount">8</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Paul Stewart has 3 accepted answers">6&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-1305">
    
</div>
<div id="comment-tools-1305" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-1305-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="1309"></a>
                    <div id="answer-container-1309" class="answer answered-by-owner">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-1309-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/1309/up/" rel="nofollow"> </a>
<div id="post-1309-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-1309-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/1309/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>dear paul:</p>
<p>thank you for your feedback! the device is a modem and can be used as a router too. I guess I will run it only as a modem. I have a zyxel router/firewall too. do I need a hub or a switch (I have all the stuff stored in the company, so no problem at all. what would be the best configuration?</p>
<p>thanks</p>
<p>mike</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/1309/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>10 Dec '10, 04:22</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7d69a51ae803b51b82ed57f4b40f1da8?s=32&amp;d=identicon&amp;r=g" alt="C8H10N4O2's gravatar image" />
    <p><a href="/users/425/c8h10n4o2">C8H10N4O2</a><br/>
    <span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="bronze">&#9679;</span><span class="badgecount">1</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="C8H10N4O2 has no accepted answers">0&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-1309">
    
</div>
<div id="comment-tools-1309" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-1309-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="1310"></a>
                    <div id="answer-container-1310" class="answer answered-by-owner">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-1310-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/1310/up/" rel="nofollow"> </a>
<div id="post-1310-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-1310-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/1310/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>dear paul:</p>
<p>thanks for your feedback! the device is a modem and can be used as a router too. I guess I will run it only as a modem. I have a zyxel router/firewall too which I can put right after the modem. do I need a hub or a switch (monitored port) (I have all the stuff stored in the company, so no problem at all. what would be the best configuration?</p>
<p>thanks</p>
<p>mike</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/1310/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>10 Dec '10, 04:23</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7d69a51ae803b51b82ed57f4b40f1da8?s=32&amp;d=identicon&amp;r=g" alt="C8H10N4O2's gravatar image" />
    <p><a href="/users/425/c8h10n4o2">C8H10N4O2</a><br/>
    <span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="bronze">&#9679;</span><span class="badgecount">1</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="C8H10N4O2 has no accepted answers">0&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-1310">
    
</div>
<div id="comment-tools-1310" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-1310-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="1312"></a>
                    <div id="answer-container-1312" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-1312-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/1312/up/" rel="nofollow"> </a>
<div id="post-1312-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-1312-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/1312/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>If you run it as a modem only, it should basically be a bridge from your flavor of broadband to Ethernet. So you can then capture traffic between the modem and your firewall. To do so a 'dumb' hub connected to a capture station would suffice.  The side effect of this is that the communication will drop to half duplex. I have seen cases where a hub isn't necessarily just a hub. So just be for warned, that the oldest, simplest, single speed hub you can find is the one that will always work. </p>
<p>A switch has the added advantage of allowing full duplex communication to continue. However, it requires configuration and not all switches are capable of this span or monitor mode. </p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/1312/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>10 Dec '10, 04:40</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/e62501f00394530927e4b0c9e86bfb46?s=32&amp;d=identicon&amp;r=g" alt="Paul%20Stewart's gravatar image" />
    <p><a href="/users/412/paul-stewart">Paul Stewart</a><br/>
    <span class="score" title="301 reputation points">301</span><span title="8 badges"><span class="bronze">&#9679;</span><span class="badgecount">8</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Paul Stewart has 3 accepted answers">6&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-1312">
    
</div>
<div id="comment-tools-1312" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-1312-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="1497"></a>
                    <div id="answer-container-1497" class="answer answered-by-owner">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-1497-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/1497/up/" rel="nofollow"> </a>
<div id="post-1497-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-1497-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/1497/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>dear paul:</p>
<p>can you give me a hint, in which way the recording system should be configured due to safety aspects? I would like to use this setup regarding forensics / proof of evidence.</p>
<p>is there any way to ensure that the recording system won't be corrupted. should I use linux? windows without web access / EFS-filesystem for the recording device?</p>
<p>can the traffic which is recorded be secured by hash-code in any way so you really get proof?</p>
<p>best regards</p>
<p>max</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/1497/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>28 Dec '10, 04:24</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7d69a51ae803b51b82ed57f4b40f1da8?s=32&amp;d=identicon&amp;r=g" alt="C8H10N4O2's gravatar image" />
    <p><a href="/users/425/c8h10n4o2">C8H10N4O2</a><br/>
    <span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="bronze">&#9679;</span><span class="badgecount">1</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="C8H10N4O2 has no accepted answers">0&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-1497">
    
</div>
<div id="comment-tools-1497" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-1497-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="1507"></a>
                    <div id="answer-container-1507" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-1507-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/1507/up/" rel="nofollow"> </a>
<div id="post-1507-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-1507-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/1507/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>A capture that will withstand forensic scrutiny brings up several concerns. For example:</p>
<p>1) was every related packet captured</p>
<p>2) were any packets corrupted during the capture process</p>
<p>3) were the capture file(s) modified post capture</p>
<p>I'm not sure I can answer them all. Each frame has a hash, but that would only help authenticate a capture file if that hash could be written to another secure location during the capture process. Missing frames are always possible due to various issues. For example, if the switch span port was changed or if capacity was exceeded. </p>
<p>I think, as you suggested, post capture storage security is about the best we can do. So it would be nice to md5 each file as soon as writing is complete. It would also be good to audit the file system and record the md5 hash externally (to another destination). Beyond that, general security best practices. Since this does not fully address your concerns, I'll be watching for other's comments as well. </p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/1507/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>29 Dec '10, 05:34</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/e62501f00394530927e4b0c9e86bfb46?s=32&amp;d=identicon&amp;r=g" alt="Paul%20Stewart's gravatar image" />
    <p><a href="/users/412/paul-stewart">Paul Stewart</a><br/>
    <span class="score" title="301 reputation points">301</span><span title="8 badges"><span class="bronze">&#9679;</span><span class="badgecount">8</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Paul Stewart has 3 accepted answers">6&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-1507">
    
</div>
<div id="comment-tools-1507" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-1507-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/1301/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='LR8FuI96EPLuIMPlZ92g9yYD5M5IkmQV' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/1301/recording-traffic-at-the-gateway?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/1301/recording-traffic-at-the-gateway?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/traffic/"
            class="tag-link-traffic"
            title="see questions tagged'traffic'using tags"
            rel="tag">traffic</a> <span class="tag-number">&#215;115</span><br/>
        
        <a href="/tags/gateway/"
            class="tag-link-gateway"
            title="see questions tagged'gateway'using tags"
            rel="tag">gateway</a> <span class="tag-number">&#215;8</span><br/>
        
        <a href="/tags/recording/"
            class="tag-link-recording"
            title="see questions tagged'recording'using tags"
            rel="tag">recording</a> <span class="tag-number">&#215;4</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Dec. 9, 2010, 7:59 a.m.">09 Dec '10, 07:59</strong>
    </p>
    <p> 
     	question was seen: <strong>12,133 times</strong>
    </p>
    <p> 
        last updated: <strong title="Feb. 29, 2012, 7:01 p.m.">29 Feb '12, 19:01</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/82/can-wireshark-monitor-bandwidth-usage-per-applicationprocess">Can Wireshark monitor bandwidth usage per application/process?</a>
        </p>
        
        <p>
            <a href="/questions/6047/capturing-download-size">Capturing download size</a>
        </p>
        
        <p>
            <a href="/questions/13925/cannot-see-other-lan-traffic">Cannot see other LAN traffic</a>
        </p>
        
        <p>
            <a href="/questions/20937/wireshark-capturing-only-incoming-traffic-on-windows-7">Wireshark capturing only incoming traffic on Windows 7</a>
        </p>
        
        <p>
            <a href="/questions/32227/how-to-capture-lan-traffic">how to capture LAN traffic</a>
        </p>
        
        <p>
            <a href="/questions/39934/hidden-traffic">Hidden Traffic</a>
        </p>
        
        <p>
            <a href="/questions/53497/check-bidirectional-traffic">check bidirectional traffic</a>
        </p>
        
        <p>
            <a href="/questions/59987/voicedata-traffic-question">Voice/Data Traffic Question</a>
        </p>
        
        <p>
            <a href="/questions/170/wireshark-only-showing-one-way-communication-over-vpn-tunnel">Wireshark only showing one way communication over VPN tunnel</a>
        </p>
        
        <p>
            <a href="/questions/6694/identify-data-traffic-requested-by-users">Identify data traffic requested by users</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
