<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>how to stop tshark from writing to a temp file? - Wireshark Q&amp;A</title>
        <meta name="description" content="Hello I have looked in the forum but i wasn&#39;t able to find the right question here nor answer i&#39;m looking for. I&#39;m using windows 2008 server and using tshark to capture directy from the NIC card and output a CSV text of atributes to the screen. (stdout) But I got a number of times when tshark stoppe..." />
        <meta name="keywords" content="temp,tshark,file" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/23523/how-to-stop-tshark-from-writing-to-a-temp-file" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/23523/how-to-stop-tshark-from-writing-to-a-temp-file?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='wKNX3rTo5GfvHQawba4YRSQMLE17xiJH' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/23523/how-to-stop-tshark-from-writing-to-a-temp-file">how to stop tshark from writing to a temp file?</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-23523-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/23523/up/" rel="nofollow"> </a>
<div id="post-23523-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-23523-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/23523/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/23523/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hello</p>
<p>I have looked in the forum but i wasn't able to find the right question here nor answer i'm looking for.
I'm using windows 2008 server and using tshark to capture directy from the NIC card
and output a CSV text of atributes to the screen. (stdout)</p>
<p>But I got a number of times when tshark stopped working.
after checking i have found out that it writes a TMP file into
C:\Users\%Username%\AppData\Local\Temp</p>
<p>It has grown too big and i must stop the process to delete it and then start the process
again.
I have checked but i wasn't able to find a way to disable the tmp file.
I tried the -w - or the -b but none has any effect.</p>
<p>Can someone please point me to the correct way to stop the temp file.
or the a correct way to deal with this issue without stopping the service?
like rotate the tmp file or limiting at a fixed size etc..</p>
<p>thank you
Lior<br>
</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/temp/" class="post-tag tag-link-temp"
                                        title="see questions tagged 'temp'" rel="tag">temp</a>
                                
                                    <a href="/tags/tshark/" class="post-tag tag-link-tshark"
                                        title="see questions tagged 'tshark'" rel="tag">tshark</a>
                                
                                    <a href="/tags/file/" class="post-tag tag-link-file"
                                        title="see questions tagged 'file'" rel="tag">file</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>03 Aug '13, 04:21</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/2e1b2f81089b35501974478f754ca06b?s=32&amp;d=identicon&amp;r=g" alt="liorh007's gravatar image" />
    <p><a href="/users/5395/liorh007">liorh007</a><br/>
    <span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">&#9679;</span><span class="badgecount">2</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="liorh007 has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/23523/">
                edited
                <strong>03 Aug '13, 04:23</strong>
            </a>
        </p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-23523">
    
        <a name="23543"></a>
        <div class="comment" id="comment-23543">
            <div id="post-23543-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi
thank you all for the answers , but here is more info.
1. I must use tshark as a service for long time 24/7.
    it never got stuck , but i got a very large temp file 
2. I'm using the -R filter option with -T fields and -e for attributes
   to create a CSV text output.
3. the computer is very strong with few cpu's and lots of memory
4. Guy is right and dumpcap won't help me.
5. I have taken the advice of using the -b filesize/num and added 
   an output file with -w, however they don't work with -R
   so i'm back in/to square one :-( </p>

<p>is there any way to make it work? 
the key is having the -b work with -R ;-)
also i'm willing to think outside the box
and maybe :
is there a way to make dumpcap output a filtered CSV text
info a file by itself and i would us this file as an input?</p>

<p>thank you</p></div>
            <div class="comment-info" id="comment-23543-info">
                
                
                
                

                

                <span class="comment-age">(04 Aug '13, 23:04)</span>
                <a class="comment-user userinfo" href="/users/5395/liorh007">liorh007</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-23523" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-23523-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    4 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/23523/how-to-stop-tshark-from-writing-to-a-temp-file?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/23523/how-to-stop-tshark-from-writing-to-a-temp-file?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/23523/how-to-stop-tshark-from-writing-to-a-temp-file?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/23523/how-to-stop-tshark-from-writing-to-a-temp-file?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="23524"></a>
                    <div id="answer-container-23524" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-23524-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/23524/up/" rel="nofollow"> </a>
<div id="post-23524-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-23524-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/23524/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Try using dumpcap it works really well and can create multiple files for you, you can provide the time or volume after which a new file should be created as well as you can provide the max number of files that should be rotated </p>
<p>eg: dumpcap -i any -b filesize:153600 -b files:2000 -Z none -f port 2123 -w c:\Traces\tracesaug.snoop</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/23524/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>03 Aug '13, 10:18</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/3ac62e4a103b118d6c93f65777d77402?s=32&amp;d=identicon&amp;r=g" alt="RAVI_TANDON's gravatar image" />
    <p><a href="/users/2822/ravi_tandon">RAVI_TANDON</a><br/>
    <span class="score" title="10 reputation points">10</span><span title="4 badges"><span class="badge1">&#9679;</span><span class="badgecount">4</span></span><span title="4 badges"><span class="silver">&#9679;</span><span class="badgecount">4</span></span><span title="7 badges"><span class="bronze">&#9679;</span><span class="badgecount">7</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="RAVI_TANDON has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/23524/">
                edited
                <strong>03 Aug '13, 10:19</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-23524">
    
        <a name="23527"></a>
        <div class="comment" id="comment-23527">
            <div id="post-23527-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi
thank you for the answer , however as i checked dumpcap does
not support filters, which is what i'm doing with tshark
to output the CSV atributes .
so i must use tshark.
is there a way to combine the dumpcap file features with tshark?
i can live with rotating files, (ie delete them as needed)
thank you
Lior</p></div>
            <div class="comment-info" id="comment-23527-info">
                
                
                
                

                

                <span class="comment-age">(03 Aug '13, 14:00)</span>
                <a class="comment-user userinfo" href="/users/5395/liorh007">liorh007</a>
                
            </div>
        </div>
    
        <a name="23529"></a>
        <div class="comment" id="comment-23529">
            <div id="post-23529-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>is there a way to combine the dumpcap file features with tshark?</p>
</blockquote>

<p>Yes.  See my answer.</p></div>
            <div class="comment-info" id="comment-23529-info">
                
                
                
                

                

                <span class="comment-age">(03 Aug '13, 14:35)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="23535"></a>
        <div class="comment" id="comment-23535">
            <div id="post-23535-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/5395/liorh007">@liorh007</a>, dumpcap supports capture filters, what is the filter expression you're using.</p></div>
            <div class="comment-info" id="comment-23535-info">
                
                
                
                

                

                <span class="comment-age">(04 Aug '13, 08:15)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="23539"></a>
        <div class="comment" id="comment-23539">
            <div id="post-23539-score" class="comment-score"></div>
            <div class="comment-text"><p>"filter" is a word that's sometimes used to refer to actual <em>filters</em>, i.e. packet-matching expressions used to choose which packets to capture/save/show and which ones not to capture/save/show, and other times used to refer to <em>named fields</em> (whenever I catch "filter" used in a bug title to mean "named field", I fix it).</p>

<p>If he means "named fields", which I'm guessing he does from "dumpcap does not support filters, which is what i'm doing with tshark to output the CSV atributes", then dumpcap won't do the job.</p></div>
            <div class="comment-info" id="comment-23539-info">
                
                
                
                

                

                <span class="comment-age">(04 Aug '13, 11:43)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-23524" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-23524-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="23528"></a>
                    <div id="answer-container-23528" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-23528-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/23528/up/" rel="nofollow"> </a>
<div id="post-23528-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-23528-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/23528/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Unfortunately, TShark currently doesn't support any mechanism other than temporary files to pass packets from dumpcap to it; that's <a href="https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=2743">bug 2743</a>.  That bug would require some work to fix.</p>
<p>You could, however, use flags such as <code>-b filesize:</code><em>size</em> and <code>-b files:</code><em>nfiles</em> with TShark as well; they're passed on to dumpcap.  Pick a small value for <em>nfiles</em> and a not-too-large value for <em>size</em>, and that won't take up too much disk space - only <em>nfiles</em> will be kept around, each one having a size approximately as big as <em>size</em>.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/23528/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>03 Aug '13, 14:25</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" alt="Guy%20Harris's gravatar image" />
    <p><a href="/users/79/guy-harris">Guy Harris ♦♦</a><br/>
    <span class="score" title="17443 reputation points"><span class="">17.4k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">&#9679;</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">&#9679;</span><span class="badgecount">196</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Guy Harris has 216 accepted answers">19&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/23528/">
                edited
                <strong>03 Aug '13, 14:35</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-23528">
    
        <a name="23534"></a>
        <div class="comment" id="comment-23534">
            <div id="post-23534-score" class="comment-score"></div>
            <div class="comment-text"><p>Note that running tshark for an extended period of time (you mention "service" in your question) is not recommended, it will run out of memory at some point.  This is because tshark (and Wireshark) store data about conversations which accumulates during a run.</p>

<p>dumpcap doesn't do this, hence why it's recommend for long-running processes.</p></div>
            <div class="comment-info" id="comment-23534-info">
                
                
                
                

                

                <span class="comment-age">(04 Aug '13, 08:14)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="23538"></a>
        <div class="comment" id="comment-23538">
            <div id="post-23538-score" class="comment-score"></div>
            <div class="comment-text"><p>I infer from "using tshark to capture directy from the NIC card and output a CSV text of atributes to the screen. (stdout)" that dissecting packets is the reason for running TShark, so dumpcap <em>won't</em> suffice for his purpose.</p></div>
            <div class="comment-info" id="comment-23538-info">
                
                
                
                

                

                <span class="comment-age">(04 Aug '13, 11:39)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-23528" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-23528-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="23544"></a>
                    <div id="answer-container-23544" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-23544-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/23544/up/" rel="nofollow"> </a>
<div id="post-23544-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-23544-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/23544/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <blockquote>
<ol>
<li>I must use tshark as a service for long time 24/7.</li>
</ol>
</blockquote>
<p>Sadly, eventually that 24/7 will have to end, as TShark, in order to dissect packets, saves various bits of state in its address space, and runs the risk of eventually running out of "memory" (address space/swap space, in reality).</p>
<blockquote>
<p>it never got stuck , but i got a very large temp file</p>
</blockquote>
<p>Then you weren't using the <code>-b</code> flags in question, because it wasn't rotating the files.</p>
<blockquote>
<ol>
<li>I'm using the -R filter option</li>
</ol>
</blockquote>
<p>Then you're out of luck, as</p>
<ol>
<li>in order to use the <code>-b</code> options, you need to be saving to a file;</li>
<li>the <code>-R</code> option currently isn't supported if you're not saving to a file.</li>
</ol>
<blockquote>
<ol>
<li>the computer is very strong with few cpu's and lots of memory</li>
</ol>
</blockquote>
<p>No matter how much memory you have, with enough packets, TShark can eat up all your memory and swap space (unless you're on an OS where swap space is easily expandable, in which case it'll eat up all your disk space instead).  If your computer is running a 32-bit version of TShark, TShark will probably eat up all its address space before it even gets a chance to eat up all the memory and swap space.</p>
<ol>
<li>
<ol>
<li>I have taken the advice of using the -b filesize/num and added an output file with -w, however they don't work with -R so i'm back in/to square one :-(</li>
</ol>
</li>
</ol>
<p>And there's currently a 1km high wall around that square, unfortunately.</p>
<blockquote>
<p>is there any way to make it work?</p>
</blockquote>
<p>No, because...</p>
<blockquote>
<p>the key is having the -b work with -R </p>
</blockquote>
<p>...and you can't currently do that.</p>
<blockquote>
<p>is there a way to make dumpcap output a filtered CSV text info a file by itself </p>
</blockquote>
<p>No.  dumpcap was <em>explicitly designed</em> to be incapable of doing that.  It might have to run with extra privileges in order to capture traffic, so the ability to dissect packets was explicitly left <em>out</em> of it to reduce the amount of code in it that could cause problems if there's a bug in it that opens a security hole.</p>
<p>At best, you could run dumpcap with the <code>-b</code> options to have it produce a sequence of capture files, but <em>not</em> remove them.  You could then try running a script that watches for new capture files to appear and, when a new file appears, runs TShark on each of the <em>older</em> capture files, removing each one after it's processed.  Note, however, that this means that if, in order to dissect a packet in a particular file, information from a packet in an <em>earlier</em> file is required, the later packet won't be able to be fully dissected, so, if the fields you're using with <code>-e</code> require a full dissection, you might not get the information you want.  (The information in question is part of the stuff that eventually will fill up TShark's address space.)</p>
<p>What information are you trying to get?  There might be <em>other</em> programs that can get that information for you.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/23544/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>04 Aug '13, 23:35</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" alt="Guy%20Harris's gravatar image" />
    <p><a href="/users/79/guy-harris">Guy Harris ♦♦</a><br/>
    <span class="score" title="17443 reputation points"><span class="">17.4k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">&#9679;</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">&#9679;</span><span class="badgecount">196</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Guy Harris has 216 accepted answers">19&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-23544">
    
        <a name="23546"></a>
        <div class="comment" id="comment-23546">
            <div id="post-23546-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi
Thank you for the answer.
I'm capturing RADIUS traffic and i split it into CSV fields
like username,disconnection reason,packets used, etc...
so i need to capture ALL traffic and can't relay on files
that might not hold all the info i need.
also i need to make decisions based on that info
in REALTIME.</p>

<p>but as i said i'm willing to try anything.
also since the current TEMP solution I found now is to "stop" the service once during "off hours" delete the tmp file and then
restart the service again, solving the memory issues you said.</p>

<p>The other solution would be to setup a 2nd computer that would
get the info and save only, so when I stop the main service
I can read the missing info from the 2nd server.
but this idea is only on paper now.</p>

<p>also about reading from a dumpcap rotated file, I need to figure
out how to make the tshark read the files one after the other
this makes it more complicated and i really need the realtime speed.</p>

<p>any help in making it work would be forever thanked :-)</p></div>
            <div class="comment-info" id="comment-23546-info">
                
                
                
                

                

                <span class="comment-age">(05 Aug '13, 01:34)</span>
                <a class="comment-user userinfo" href="/users/5395/liorh007">liorh007</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-23544" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-23544-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="23687"></a>
                    <div id="answer-container-23687" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-23687-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/23687/up/" rel="nofollow"> </a>
<div id="post-23687-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-23687-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/23687/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <blockquote>
<p>I'm <strong>capturing RADIUS traffic</strong> and i split it into CSV fields like username,disconnection reason,packets used, etc.</p>
</blockquote>
<p>In that case, I recommend a radius sniffer, like one of these.</p>
<blockquote>
<p><a href="http://sourceforge.net/projects/raddump/">http://sourceforge.net/projects/raddump/</a> <br>
<a href="http://www.manpagez.com/man/8/radsniff/">http://www.manpagez.com/man/8/radsniff/</a></p>
</blockquote>
<p>Combined with some scripting, you should be able to achieve your goal.</p>
<p>Regards <br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/23687/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>09 Aug '13, 14:54</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-23687">
    
</div>
<div id="comment-tools-23687" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-23687-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/23523/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='wKNX3rTo5GfvHQawba4YRSQMLE17xiJH' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/23523/how-to-stop-tshark-from-writing-to-a-temp-file?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/23523/how-to-stop-tshark-from-writing-to-a-temp-file?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/tshark/"
            class="tag-link-tshark"
            title="see questions tagged'tshark'using tags"
            rel="tag">tshark</a> <span class="tag-number">&#215;832</span><br/>
        
        <a href="/tags/file/"
            class="tag-link-file"
            title="see questions tagged'file'using tags"
            rel="tag">file</a> <span class="tag-number">&#215;91</span><br/>
        
        <a href="/tags/temp/"
            class="tag-link-temp"
            title="see questions tagged'temp'using tags"
            rel="tag">temp</a> <span class="tag-number">&#215;10</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Aug. 3, 2013, 4:21 a.m.">03 Aug '13, 04:21</strong>
    </p>
    <p> 
     	question was seen: <strong>8,985 times</strong>
    </p>
    <p> 
        last updated: <strong title="Aug. 9, 2013, 3:15 p.m.">09 Aug '13, 15:15</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/17696/tshark-how-to-capture-to-a-file-and-print-text-on-screen">Tshark how to capture to a file and print text on screen</a>
        </p>
        
        <p>
            <a href="/questions/51373/how-to-run-tshark-without-creating-tmpwireshark_-file">How to run tshark without creating /tmp/wireshark_* file?</a>
        </p>
        
        <p>
            <a href="/questions/8205/temp-file">Temp file</a>
        </p>
        
        <p>
            <a href="/questions/18024/tshark-command-to-make-a-xml-file-of-wireshark-data">Tshark Command to make a xml file of wireshark data</a>
        </p>
        
        <p>
            <a href="/questions/10415/capinfos-file-size-and-summary-statistics-file-size-not-matching">capinfos file size and summary statistics file size not matching</a>
        </p>
        
        <p>
            <a href="/questions/35525/tshark-how-to-change-the-temp-directory">tshark - how to change the temp directory</a>
        </p>
        
        <p>
            <a href="/questions/29279/how-do-i-apply-a-capture-filter-to-a-file">How do I apply a capture filter to a file?</a>
        </p>
        
        <p>
            <a href="/questions/37587/tshark-w-switch">Tshark -w switch</a>
        </p>
        
        <p>
            <a href="/questions/9278/tshark-filter-from-a-file">tshark filter from a file</a>
        </p>
        
        <p>
            <a href="/questions/62/static-tshark-builds-for-linux-andor-solaris-sparcx64">static tshark builds for linux and/or solaris sparc/x64</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
