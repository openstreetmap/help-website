<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Why capture filter icmp6 does not capture ICMPv6 replies? - Wireshark Q&amp;A</title>
        <meta name="description" content="I&#39;m running a couple of LXC containers (Container1 and Container2) on my host, each with a veth (veth1000_1 and veth1001_1) connected through a bridge (mbr1). From Container1 I ping6 Container2 and everything is working, but I can&#39;t manage to capture the icmp6 replies if I filter by protocol on veth..." />
        <meta name="keywords" content="capture-filter,vlan,lxc,tshark,icmp6" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/24992/why-capture-filter-icmp6-does-not-capture-icmpv6-replies" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/24992/why-capture-filter-icmp6-does-not-capture-icmpv6-replies?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='JKoVgbBrMM4Xma6Rap7ayJbIWTQ2VwIK' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/24992/why-capture-filter-icmp6-does-not-capture-icmpv6-replies">Why capture filter icmp6 does not capture ICMPv6 replies?</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-24992-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/24992/up/" rel="nofollow"> </a>
<div id="post-24992-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-24992-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/24992/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/24992/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>I'm running a couple of LXC containers (Container1 and Container2) on my host, each with a veth  (veth1000_1 and veth1001_1) connected through a bridge (mbr1). From Container1 I ping6 Container2 and everything is working, but I can't manage to capture the icmp6 replies if I filter by protocol on veth1000_1:</p>
<ul>
<li><strong>tshark -i veth1000_1</strong> captures requests and replies</li>
<li><strong>tshark -i veth1000_1 -f icmp6</strong> captures only requests</li>
<li><strong>tshark -i mbr1 -f icmp6</strong> captures requests and replies</li>
<li><strong>tshark -i eth1.12 -f icmp6</strong> inside Container1 captures both requests and replies</li>
</ul>
<p>I'm interested in using veth1000_1 instead of mbr1 because when jumping to a more complex scenario, where packets can be lost, I'm interested on seeing only the packets actually received by the container and not on the network. Also having to capture in the container makes everything more complicated so I rather capture everything from the host. And I don't want huge capture files, so I'd like to filter out the other traffic.</p>
<p>I've also tried with tcpdump with the same results. Also I tried pinging from the host to the outside world and everything worked fine.</p>
<p>I'm using tshark 1.8.2 with libpcap 1.3.0.</p>
<p>Any idea what I'm doing wrong and how can I manage to do it properly?</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/capture-filter/" class="post-tag tag-link-capture-filter"
                                        title="see questions tagged 'capture-filter'" rel="tag">capture-filter</a>
                                
                                    <a href="/tags/vlan/" class="post-tag tag-link-vlan"
                                        title="see questions tagged 'vlan'" rel="tag">vlan</a>
                                
                                    <a href="/tags/lxc/" class="post-tag tag-link-lxc"
                                        title="see questions tagged 'lxc'" rel="tag">lxc</a>
                                
                                    <a href="/tags/tshark/" class="post-tag tag-link-tshark"
                                        title="see questions tagged 'tshark'" rel="tag">tshark</a>
                                
                                    <a href="/tags/icmp6/" class="post-tag tag-link-icmp6"
                                        title="see questions tagged 'icmp6'" rel="tag">icmp6</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>20 Sep '13, 03:01</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7e2df31cada4c7bc3f6f18ece179fee5?s=32&amp;d=identicon&amp;r=g" alt="Ester's gravatar image" />
    <p><a href="/users/5705/ester">Ester</a><br/>
    <span class="score" title="16 reputation points">16</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">&#9679;</span><span class="badgecount">4</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Ester has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/24992/">
                edited
                <strong>20 Sep '13, 17:55</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" alt="Guy%20Harris's gravatar image" />
            <p><a href="/users/79/guy-harris">Guy Harris ♦♦</a><br/>
            <span class="score" title="17443 reputation points"><span class="">17.4k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">&#9679;</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">&#9679;</span><span class="badgecount">196</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-24992">
    
</div>
<div id="comment-tools-24992" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-24992-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/24992/why-capture-filter-icmp6-does-not-capture-icmpv6-replies?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/24992/why-capture-filter-icmp6-does-not-capture-icmpv6-replies?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/24992/why-capture-filter-icmp6-does-not-capture-icmpv6-replies?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/24992/why-capture-filter-icmp6-does-not-capture-icmpv6-replies?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="24997"></a>
                    <div id="answer-container-24997" class="answer accepted-answer">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-24997-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/24997/up/" rel="nofollow"> </a>
<div id="post-24997-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-24997-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/24997/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="Ester has selected this answer as the correct answer"
        href="/accept_answer/24997/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <blockquote>
<p>I've <strong>also tried with tcpdump</strong> with the <strong>same results</strong>. </p>
</blockquote>
<p>O.K. then I guess it's either a libpcap issue or an issue with the LXC virtual interfaces and <strong>not an issue with Wireshark</strong>. Unfortunately neither problem can be fixed by the Wireshark community.</p>
<p>Did you ask this question in the forums of libpcap/tcpdump and/or lxc?</p>
<blockquote>
<p>tshark -i veth1000_1 captures requests and replies</p>
</blockquote>
<p>If you look at the reply packets in this case: Is there any VLAN tag added (I don't know if LXC uses VLANs internally)? Or do the replies look in any way 'strange'? </p>
<p>BTW: If you cannot detect a difference, can you please post a capture file somewhere (google docs, dropbox, cloudshark, etc.)?</p>
<p><strong>SOLUTION</strong></p>
<p>see comments below. </p>
<p>The problem seems to be related to VLAN tags and possibly a bug in libpcap in conjunction with LXC virtual interfaces. The following filter shows both, requests and responses:</p>
<blockquote>
<p>tcpdump -ni veth1000_1 'icmp6 or (vlan and icmp6)' <br>
tshark -ni veth1000_1  -f 'icmp6 or (vlan and icmp6)'</p>
</blockquote>
<p>Regards<br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/24997/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>20 Sep '13, 04:10</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/24997/">
                edited
                <strong>20 Sep '13, 07:17</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-24997">
    
        <a name="25003"></a>
        <div class="comment" id="comment-25003">
            <div id="post-25003-score" class="comment-score"></div>
            <div class="comment-text"><p>Yup, I forgot to mention that traffic carries a VLAN tag, but both request and replies. What I don't get is why (if everything seems the same on lower ayers) when filtering by protocol it will drop some packets.</p>

<p>A capture file (without the icmp6 filter): <a href="https://dl.dropboxusercontent.com/u/3807034/ICMP6_capture.pcap">https://dl.dropboxusercontent.com/u/3807034/ICMP6_capture.pcap</a></p>

<p>Anyway, I'll ask too to the libpcap community. Thanks Kurt.</p></div>
            <div class="comment-info" id="comment-25003-info">
                
                
                
                

                

                <span class="comment-age">(20 Sep '13, 04:27)</span>
                <a class="comment-user userinfo" href="/users/5705/ester">Ester</a>
                
            </div>
        </div>
    
        <a name="25004"></a>
        <div class="comment" id="comment-25004">
            <div id="post-25004-score" class="comment-score"></div>
            <div class="comment-text"><p>Can you please try this:</p>

<blockquote>
<p>tshark -ni veth1000_1 -f "vlan and icmp6" <br>
</p>
</blockquote>

<p>and/or</p>

<blockquote>
<p>tcpdump -ni veth1000_1 vlan and icmp6</p>
</blockquote>

<p>What do you see?</p>

<blockquote>
<p>What I don't get is why (if everything seems the same on lower ayers) when filtering by protocol it will drop some packets.</p>
</blockquote>

<p>If it's a bug in the LXC veth code or the libpcap code, there is no logic you can apply ;-))</p></div>
            <div class="comment-info" id="comment-25004-info">
                
                
                
                

                

                <span class="comment-age">(20 Sep '13, 04:30)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="25007"></a>
        <div class="comment" id="comment-25007">
            <div id="post-25007-score" class="comment-score"></div>
            <div class="comment-text"><p>Wow,</p>

<p>In both cases (tcpdump and tshark) I see only the replies:</p>

<blockquote>
<p>tshark -ni veth1000_1 -f "vlan and icmp6"</p>
<p>Capturing on veth1000_1</p>
<p>0.000000 fd02::a0cd:ef10:1101:0:1 -&gt; fd02::a0cd:ef10:1:0:1 ICMPv6 122 Echo (ping) reply id=0x021c, seq=693</p>
<p>0.007975 fd02::a0cd:ef10:1501:0:1 -&gt; fd02::a0cd:ef10:1:0:1 ICMPv6 122 Echo (ping) reply id=0x022c, seq=585</p>
<p>0.012042 fd02::a0cd:ef10:601:0:1 -&gt; fd02::a0cd:ef10:1:0:1 ICMPv6 122 Echo (ping) reply id=0x0208, seq=752</p>
<p>0.012059 fd02::a0cd:ef10:1001:0:1 -&gt; fd02::a0cd:ef10:1:0:1 ICMPv6 122 Echo (ping) reply id=0x0218, seq=720</p>
</blockquote>

<p>whereas</p>

<blockquote>
<p>tshark -ni veth1000_1 -f "icmp6"</p>
<p>Capturing on veth1000_1</p>
<p>0.000000 fd02::a0cd:ef10:1:0:1 -&gt; fd02::a0cd:ef10:1201:0:1 ICMPv6 122 Echo (ping) request id=0x0220, seq=1383</p>
<p>0.012003 fd02::a0cd:ef10:1:0:1 -&gt; fd02::a0cd:ef10:801:0:1 ICMPv6 122 Echo (ping) request id=0x0210, seq=1297</p>
<p>0.016011 fd02::a0cd:ef10:1:0:1 -&gt; fd02::a0cd:ef10:901:0:1 ICMPv6 122 Echo (ping) request id=0x0214, seq=1263</p>
<p>0.020014 fd02::a0cd:ef10:1:0:1 -&gt; fd02::a0cd:ef10:201:0:1 ICMPv6 122 Echo (ping) request id=0x01f8, seq=1291</p>
</blockquote>

<p>Could you explain me the rationale behind this? (I mean I know I can now use the filter "icmp6 or (vlan and icmp6)" but I cannot understand the reason why it works)</p></div>
            <div class="comment-info" id="comment-25007-info">
                
                
                
                

                

                <span class="comment-age">(20 Sep '13, 04:39)</span>
                <a class="comment-user userinfo" href="/users/5705/ester">Ester</a>
                
            </div>
        </div>
    
        <a name="25012"></a>
        <div class="comment" id="comment-25012">
            <div id="post-25012-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>Could you explain me the rationale behind this?</p>
</blockquote>

<p>I'm sorry, but no. I believe this could be a libpcap issue (or a problem with the veth interface code).</p>

<p>What do you see with this filter:</p>

<blockquote>
<p>tcpdump -ni '(vlan and icmp6) or icmp6'</p>
</blockquote></div>
            <div class="comment-info" id="comment-25012-info">
                
                
                
                

                

                <span class="comment-age">(20 Sep '13, 04:45)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="25016"></a>
        <div class="comment not_top_scorer" id="comment-25016">
            <div id="post-25016-score" class="comment-score"></div>
            <div class="comment-text"><p>Captur filter works on byte offsets and the VLAN tag adds a couple of bytes so "icmp6" does not work on the VLAN tagged packet, Most probably the outgoing request gets the VLAN tag added by the interface or after libpcap "sees" the pacaket so the filter with VLAN does not catch the packet try "vlan and icmp6"|| "icmp6"</p></div>
            <div class="comment-info" id="comment-25016-info">
                
                
                
                

                

                <span class="comment-age">(20 Sep '13, 04:51)</span>
                <a class="comment-user userinfo" href="/users/42/anders">Anders ♦</a>
                
            </div>
        </div>
    
        <a name="25019"></a>
        <div class="comment not_top_scorer" id="comment-25019">
            <div id="post-25019-score" class="comment-score"></div>
            <div class="comment-text"><p>Neither the filter '(vlan and icmp6) or icmp6' nor "vlan and icmp6"|| "icmp6" worked (they only show replies).</p>

<p>I guess it is because, as explained by Anders, once you write vlan it expects the packets to have a VLAN tag and then does not recognise the ones without it.</p>

<p>Anyway, it is confusing, because the "or" operation should be commutative.</p>

<p>Many thanks to you both.</p></div>
            <div class="comment-info" id="comment-25019-info">
                
                
                
                

                

                <span class="comment-age">(20 Sep '13, 05:04)</span>
                <a class="comment-user userinfo" href="/users/5705/ester">Ester</a>
                
            </div>
        </div>
    
        <a name="25021"></a>
        <div class="comment not_top_scorer" id="comment-25021">
            <div id="post-25021-score" class="comment-score"></div>
            <div class="comment-text"><p>Did you try this:</p>

<blockquote>
<p>tcpdump -ni 'icmp6 or (vlan and icmp6)'</p>
</blockquote>

<p>The BPF code is different see</p>

<blockquote>
<p>tcpdump -d 'icmp6 or (vlan and icmp6)'</p>
</blockquote>

<p>versus</p>

<blockquote>
<p>tcpdump -d '(vlan and icmp6) or icmp6'</p>
</blockquote></div>
            <div class="comment-info" id="comment-25021-info">
                
                
                
                

                

                <span class="comment-age">(20 Sep '13, 05:11)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="25023"></a>
        <div class="comment not_top_scorer" id="comment-25023">
            <div id="post-25023-score" class="comment-score"></div>
            <div class="comment-text"><p>Yeah, that one is working :), yet I always thought that 'or' order didn't matter (much).. </p>

<p>I see that is not the case after seeing the code, though I couldn't decipher it, but I see that 'icmp6 or (vlan and icmp6)' seems to check more cases, or at least its longer.</p></div>
            <div class="comment-info" id="comment-25023-info">
                
                
                
                

                

                <span class="comment-age">(20 Sep '13, 05:22)</span>
                <a class="comment-user userinfo" href="/users/5705/ester">Ester</a>
                
            </div>
        </div>
    
        <a name="25025"></a>
        <div class="comment" id="comment-25025">
            <div id="post-25025-score" class="comment-score">1</div>
            <div class="comment-text"><blockquote>
<p>Yeah, that one is working :)</p>
</blockquote>

<p>I'm glad I could help. </p>

<p>Nevertheless, there seems to be a bug in libpcap in conjunction with LXC virtual ethernet nics, whereas it is yet unclear who is introducing the bug. See <a href="/users/42/anders"></a><a href="/users/42/anders">@Anders</a> comment: I's probably related to the fact where/when the VLAN tag is added.</p>

<blockquote>
<p>I see that is not the case after seeing the code, though I couldn't decipher it</p>
</blockquote>

<p>It's code for the BPF filtering virtual machine. See here, if you are interested in some details</p>

<blockquote>
<p><a href="http://sharkfest.wireshark.org/sharkfest.11/presentations/McCanne-Sharkfest%2711_Keynote_Address.pdf">http://sharkfest.wireshark.org/sharkfest.11/presentations/McCanne-Sharkfest%2711_Keynote_Address.pdf</a></p>
</blockquote></div>
            <div class="comment-info" id="comment-25025-info">
                
                
                
                

                

                <span class="comment-age">(20 Sep '13, 05:29)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="25062"></a>
        <div class="comment not_top_scorer" id="comment-25062">
            <div id="post-25062-score" class="comment-score"></div>
            <div class="comment-text"><p>For future reference, you may want to refer to the <a href="http://www.tcpdump.org/manpages/pcap-filter.7.html">pcap-filter man page</a> hosted on <a href="http://www.tcpdump.org/">www.tcpdump.org</a>.</p>

<p>Of particular note:</p>

<ul>
<li>The <code>vlan</code> primitive is not the only primitive that behaves this way - both <code>mpls</code> and <code>pppoes</code> do as well.</li>
<li>Each use of the <code>vlan</code> (and <code>mpls</code>) primitive increments the filter offsets by 4.  (Refer to the man page for more details and examples.)</li>
</ul></div>
            <div class="comment-info" id="comment-25062-info">
                
                
                
                

                

                <span class="comment-age">(20 Sep '13, 19:51)</span>
                <a class="comment-user userinfo" href="/users/402/cmaynard">cmaynard ♦♦</a>
                
            </div>
        </div>
    
        <a name="25063"></a>
        <div class="comment not_top_scorer" id="comment-25063">
            <div id="post-25063-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>For future reference, you may want to refer to the pcap-filter man page</p>
</blockquote>

<p>the pcap-filter man page would be a good source of information about the filter synatx, however the OP wanted to understand the difference in generated BPF code and thus he needs to know how the BPF virtual machine works and how to read the BPF 'machine instructions'. The pcap-filter man page does not contain that information, whereas the PDF is a pretty good tutorial for that.</p></div>
            <div class="comment-info" id="comment-25063-info">
                
                
                
                

                

                <span class="comment-age">(21 Sep '13, 00:08)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-24997" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 11
        </span>
        <a href="#" class="show-all-comments-link">show 6 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-24997-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/24992/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='JKoVgbBrMM4Xma6Rap7ayJbIWTQ2VwIK' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/24992/why-capture-filter-icmp6-does-not-capture-icmpv6-replies?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/24992/why-capture-filter-icmp6-does-not-capture-icmpv6-replies?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/tshark/"
            class="tag-link-tshark"
            title="see questions tagged'tshark'using tags"
            rel="tag">tshark</a> <span class="tag-number">&#215;832</span><br/>
        
        <a href="/tags/capture-filter/"
            class="tag-link-capture-filter"
            title="see questions tagged'capture-filter'using tags"
            rel="tag">capture-filter</a> <span class="tag-number">&#215;184</span><br/>
        
        <a href="/tags/vlan/"
            class="tag-link-vlan"
            title="see questions tagged'vlan'using tags"
            rel="tag">vlan</a> <span class="tag-number">&#215;66</span><br/>
        
        <a href="/tags/icmp6/"
            class="tag-link-icmp6"
            title="see questions tagged'icmp6'using tags"
            rel="tag">icmp6</a> <span class="tag-number">&#215;1</span><br/>
        
        <a href="/tags/lxc/"
            class="tag-link-lxc"
            title="see questions tagged'lxc'using tags"
            rel="tag">lxc</a> <span class="tag-number">&#215;1</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Sept. 20, 2013, 3:01 a.m.">20 Sep '13, 03:01</strong>
    </p>
    <p> 
     	question was seen: <strong>3,034 times</strong>
    </p>
    <p> 
        last updated: <strong title="Sept. 21, 2013, 12:08 a.m.">21 Sep '13, 00:08</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/13408/tshark-capture-and-display-filters-for-httphttps">TShark: Capture and Display Filters for HTTP/HTTPS</a>
        </p>
        
        <p>
            <a href="/questions/21191/how-to-capture-the-information-just-for-one-ip-address-t-shark">How to capture the information just for one IP ADDRESS? (T-SHARK)</a>
        </p>
        
        <p>
            <a href="/questions/54809/what-capture-filter-can-i-use-to-capture-only-tcp-and-udp-traffic-in-tshark-commandline-interface">What capture filter can I use to capture only TCP and UDP traffic in tshark commandline interface?</a>
        </p>
        
        <p>
            <a href="/questions/552/capture-filter-problem-when-tshark-is-started-within-a-bash-script">capture filter problem when tshark is started within a bash-script</a>
        </p>
        
        <p>
            <a href="/questions/13710/writing-a-tshark-filter-through-tcl">Writing a tshark filter through tcl</a>
        </p>
        
        <p>
            <a href="/questions/9303/how-to-retrieve-packet-information-using-wireshark-commands">how to retrieve packet information using wireshark commands</a>
        </p>
        
        <p>
            <a href="/questions/18278/tshark-that-string-looks-like-a-valid-display-filter-however-it-isnt-a-valid">tshark: That string looks like a valid display filter; however, it isn&#39;t a valid</a>
        </p>
        
        <p>
            <a href="/questions/50322/weird-capture-issue-seem-to-be-missing-traffic">Weird capture issue - seem to be missing traffic</a>
        </p>
        
        <p>
            <a href="/questions/34284/capture-filter-for-mdshdr-fields">capture-filter for mdshdr fields</a>
        </p>
        
        <p>
            <a href="/questions/38905/filter-tshark-command">Filter tshark command</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
