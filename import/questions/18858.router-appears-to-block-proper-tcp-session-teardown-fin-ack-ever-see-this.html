<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Router appears to block proper TCP Session Teardown (FIN, ACK), Ever See This? - Wireshark Q&amp;A</title>
        <meta name="description" content="We have several Cisco (Linksys) RV082 routers in our networks. I have been trying to run down a problem with a new application that appears to be network related. After 3 weeks of investigation, it appears our RV082 router is terminating some TCP conversations before the full teardown handshake can ..." />
        <meta name="keywords" content="ack,handshake,fin,tcp,rv082" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/18858/router-appears-to-block-proper-tcp-session-teardown-fin-ack-ever-see-this" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/18858/router-appears-to-block-proper-tcp-session-teardown-fin-ack-ever-see-this?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='BZptPXAZmegNcqShHk0zdQ2tdZU84TVr' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/18858/router-appears-to-block-proper-tcp-session-teardown-fin-ack-ever-see-this">Router appears to block proper TCP Session Teardown (FIN, ACK), Ever See This?</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-18858-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/18858/up/" rel="nofollow"> </a>
<div id="post-18858-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-18858-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/18858/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/18858/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>We have several Cisco (Linksys) RV082 routers in our networks.  I have been trying to run down a problem with a new application that appears to be network related.  After 3 weeks of investigation, it appears our RV082 router is terminating some TCP conversations before the full teardown handshake can take place.  I have done simultaneous packet capture on both sides of the router and compared the conversations/sessions.  (I can provide full packet captures if it comes to that).</p>
<p>Anyway, The client is INSIDE the network and the SERVER is outside.  The client establishes an HTTP session with the server.  This all looks OK.  Data is requested and received.  The problem starts when the server then requests that the session be terminated.</p>
<p>[Start of session...]
Server: [FIN, ACK]
Client: [ACK]</p>
<p>The client then sends 10 FIN, ACK packets (in exponentially increasing delay) which never make it through the router.  It appears that the router has slammed the door after the client ACK's the server's FIN, ACK...</p>
<p>This is not an isolated problem and I can see exactly the same behavior on many occasions.  Although it appears that the conversation payload is being delivered, I suspect the application in question is throwing away the data if it thinks the port was not closed properly.  I've been trying to educate myself on whether this is the root cause of our issue, and everything I read seems to indicate that this is not proper behavior.</p>
<p>I've posted this info on the Cisco SMB support forum, but they don't seem to have any interest in commenting on this behavior.  (They reply with some boilerplate about making sure I don't have an Virus' on my network and that all my NIC cards are working properly!)</p>
<p>Has anyone ever seem this before?  Is this likely a bona-fida bug in our router's firmware?<br>
</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/ack/" class="post-tag tag-link-ack"
                                        title="see questions tagged 'ack'" rel="tag">ack</a>
                                
                                    <a href="/tags/handshake/" class="post-tag tag-link-handshake"
                                        title="see questions tagged 'handshake'" rel="tag">handshake</a>
                                
                                    <a href="/tags/fin/" class="post-tag tag-link-fin"
                                        title="see questions tagged 'fin'" rel="tag">fin</a>
                                
                                    <a href="/tags/tcp/" class="post-tag tag-link-tcp"
                                        title="see questions tagged 'tcp'" rel="tag">tcp</a>
                                
                                    <a href="/tags/rv082/" class="post-tag tag-link-rv082"
                                        title="see questions tagged 'rv082'" rel="tag">rv082</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>25 Feb '13, 11:52</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/81ae17d36e548026e62525855b896541?s=32&amp;d=identicon&amp;r=g" alt="evanevery's gravatar image" />
    <p><a href="/users/4453/evanevery">evanevery</a><br/>
    <span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">&#9679;</span><span class="badgecount">3</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="evanevery has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-18858">
    
</div>
<div id="comment-tools-18858" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-18858-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/18858/router-appears-to-block-proper-tcp-session-teardown-fin-ack-ever-see-this?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/18858/router-appears-to-block-proper-tcp-session-teardown-fin-ack-ever-see-this?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/18858/router-appears-to-block-proper-tcp-session-teardown-fin-ack-ever-see-this?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/18858/router-appears-to-block-proper-tcp-session-teardown-fin-ack-ever-see-this?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="18867"></a>
                    <div id="answer-container-18867" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-18867-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/18867/up/" rel="nofollow"> </a>
<div id="post-18867-score" class="post-score"
    title="current number of votes">
    3
</div>
<a id="post-18867-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/18867/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Replacing the routers may solve your problem, but I think it's premature to put all the blame on the routers. It seems that you also have an application that's not as well behaved as it could be. Let's start with the image you posted of captured traffic at <a href="http://homecommunity.cisco.com/t5/Wired-Routers/RV082-Dropping-Packets-captures-included/td-p/612638">http://homecommunity.cisco.com/t5/Wired-Routers/RV082-Dropping-Packets-captures-included/td-p/612638</a> .</p>
<p>It appears that the time display format was set to "Seconds since beginning of capture." In packet 8, the server sends its FIN/ACK. In packet 9, 39 ms later, the client responds with an ACK. In packet 10, <em>over 39 seconds later</em>, the client sends its own FIN/ACK.</p>
<p>So, the first question for the application developers is, "Why does the application wait <em>39 seconds</em> to issue its own FIN/ACK when it has no data to send?"</p>
<p>On the Cisco site, you said the TCP timeout is set to 1800 seconds. That's a lot more than 39 seconds, but that's probably the timeout for an idle connection, that is, one on which no data has moved. Your router likely has a different, shorter timeout for a connection on which a FIN/ACK has been seen. I'd guess that this timer is 30 seconds or less. So, is the router "slamming the door prematurely"? Well, it's slamming the door before the client responds, but 39 seconds is a long time in networking. If this other timer is user configurable, you might be able to fix your problem by changing the timeout value to, say, a minute.</p>
<p>I see this behavior on my home network. My anti-virus software contacts the update server. After the data exchange is complete, the server sends a FIN/ACK. Sometimes the client responds with its own FIN/ACK within a second or two. In that case, the connection closes normally. Other times, the client waits a full minute or more before sending its FIN/ACK. By this time, the router has cleared the session information, so the router returns an ICMP "Destination unreachable, network unreachable" packet. The client sends six FIN/ACKs, and when it doesn't get a response to any of them, it finally sends a RST and then gives up. However, if I wasn't using Wireshark, I would never know anything was wrong. In fact, from the user perspective nothing <em>is</em> wrong.</p>
<p>However, in your case, as you posted on the Cisco site, "This causes a lot of problems with a particular application which simply throws away the whole conversation since the port/conversation 'wasn't closed properly.'"</p>
<p>So the second question for the application developers is, "Why does the application throw away an entire conversation <em>that is known to be good</em> simply because there was a technical problem with the last packet of the tear down procedure?"</p>
<p>The client knows that the server has no more data to send because it has received the server's FIN packet. The client can tell from the sequence number in the FIN packet that it has successfully received all the data that the server sent. The client can tell from the ACK number in the server's FIN packet that the server successfully received all the data that the client sent. So, regardless of whether the connection terminated correctly or not, the client can tell that all the data was transferred successfully.</p>
<p>It seems to me that the developers have been a bit lazy, and they're just assuming that the data may be incomplete or bad if the connection didn't close properly. If they would reprogram the app to actually determine from the sequence and acknowledgment numbers if all the data has been received properly, the app would be much more robust under real-world network conditions, like my anti-virus app.</p>
<p>The fact that you're not having a similar problem with all your applications indicates that it's at least partly an application problem. The problem will go away when you replace your routers <em>if</em> the new routers have a FIN/ACK teardown timer that is longer than your application's response time, otherwise you will still have the problem.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/18867/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>25 Feb '13, 15:25</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/071fe61f64868d98bdf4eb060b63b6ca?s=32&amp;d=identicon&amp;r=g" alt="Jim%20Aragon's gravatar image" />
    <p><a href="/users/527/jim-aragon">Jim Aragon</a><br/>
    <span class="score" title="7187 reputation points"><span class="">7.2k</span></span><span title="7 badges"><span class="badge1">&#9679;</span><span class="badgecount">7</span></span><span title="33 badges"><span class="silver">&#9679;</span><span class="badgecount">33</span></span><span title="118 badges"><span class="bronze">&#9679;</span><span class="badgecount">118</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Jim Aragon has 70 accepted answers">24&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/18867/">
                edited
                <strong>25 Feb '13, 18:08</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-18867">
    
        <a name="18882"></a>
        <div class="comment" id="comment-18882">
            <div id="post-18882-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks Jim!  I'm in 100% agreement with your analysis.  I've asked the developer about this on several occasions.  Why does it appear they ignore a perfectly good payload just because the teardown (port closure) may have returned an error.  I still have not got any response from them...  Its somewhat comforting to see that I was/am on the correct path here.</p></div>
            <div class="comment-info" id="comment-18882-info">
                
                
                
                

                

                <span class="comment-age">(26 Feb '13, 07:22)</span>
                <a class="comment-user userinfo" href="/users/4453/evanevery">evanevery</a>
                
            </div>
        </div>
    
        <a name="18883"></a>
        <div class="comment" id="comment-18883">
            <div id="post-18883-score" class="comment-score"></div>
            <div class="comment-text"><p>It sounds as if this applications was developed and tested on a LAN where it did not have to pass through any NAT or firewall devices, but it's not actually ready for service under real-world WAN network conditions. Any NAT router you buy will have a FIN teardown timer, and on a SOHO class router like the RV082, it will not generally be user-configurable. As mentioned above, if the teardown timer is longer than the application's response time, you won't see this problem any more; however, the problem won't be gone, it will just be masked by the long timer. They really need to tune the app.</p></div>
            <div class="comment-info" id="comment-18883-info">
                
                
                
                

                

                <span class="comment-age">(26 Feb '13, 09:07)</span>
                <a class="comment-user userinfo" href="/users/527/jim-aragon">Jim Aragon</a>
                
            </div>
        </div>
    
        <a name="18888"></a>
        <div class="comment" id="comment-18888">
            <div id="post-18888-score" class="comment-score"></div>
            <div class="comment-text"><p>Is the application related to Commtouch Antispam (see the last comment in my answer)? If so, is your developer using the API of Commtouch?</p></div>
            <div class="comment-info" id="comment-18888-info">
                
                
                
                

                

                <span class="comment-age">(26 Feb '13, 11:25)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-18867" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-18867-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="18860"></a>
                    <div id="answer-container-18860" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-18860-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/18860/up/" rel="nofollow"> </a>
<div id="post-18860-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-18860-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/18860/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>As you've added much more information in the Cisco forum, I'll post the links here. If you don't like that, please add a comment and I'll delete the links.</p>
<blockquote>
<p><code><a href="https://supportforums.cisco.com/thread/2199005">https://supportforums.cisco.com/thread/2199005</a></code> <br>
<code><a href="http://homecommunity.cisco.com/t5/Wired-Routers/RV082-Dropping-Packets-captures-included/td-p/612638">http://homecommunity.cisco.com/t5/Wired-Routers/RV082-Dropping-Packets-captures-included/td-p/612638</a></code><br>
</p>
</blockquote>
<p>So, to me it looks like the routers firewall clears the session table entry very soon after it receives the first FIN packet from the server. Any further packet from the client (FIN,ACK) will then be dropped and logged as "Connection Refused - Policy violation"). So, this seems to be a firmware issue with the RV082 and should be solved by Cisco.</p>
<p>As an alternative, you could try to install OpenWRT, dd-wrt or NSLU2 on the RV082 (not sure if any of those properly support the RV082 - please google yourself ;-)).</p>
<p>Regards<br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/18860/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>25 Feb '13, 12:41</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-18860">
    
        <a name="18861"></a>
        <div class="comment" id="comment-18861">
            <div id="post-18861-score" class="comment-score"></div>
            <div class="comment-text"><p>No problem posting those links...  Thanks for asking though!</p>

<p>Thank you for confirming my suspicion.  I could not get a straight answer anywhere else!  Based on the lack of support from the CISCO SMB group, we are already in process of getting the routers replaced.  We are replacing them with Netgear UTM150's which have some additional security features...</p>

<p>It really is a shame when someone works hard to isolate a pretty major problem and then the vendor does not even spend the time to read the findings...</p>

<p>Thanks so much for your information.  I feel better knowing that the replacement of the RV082's is the correct thing to do!</p></div>
            <div class="comment-info" id="comment-18861-info">
                
                
                
                

                

                <span class="comment-age">(25 Feb '13, 13:19)</span>
                <a class="comment-user userinfo" href="/users/4453/evanevery">evanevery</a>
                
            </div>
        </div>
    
        <a name="18870"></a>
        <div class="comment" id="comment-18870">
            <div id="post-18870-score" class="comment-score"></div>
            <div class="comment-text"><p>before you replace the router, please consider what <a href="/users/527/jim-aragon"></a><a href="/users/527/jim-aragon">@Jim Aragon</a> said about the behavior of your application (see his answer). </p>

<p>BTW: Is that an application you developed or simply a web application accessed by a standard browser. If so, what happens if you use a different browser? Is any client code involved (java, java script, flash)? </p>

<p>The mentioned IP address belongs to c1iprep1.ctmail.com, which is part of a mail security system (Antispam) of Commtouch Software.</p></div>
            <div class="comment-info" id="comment-18870-info">
                
                
                
                

                

                <span class="comment-age">(25 Feb '13, 17:30)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-18860" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-18860-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/18858/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='BZptPXAZmegNcqShHk0zdQ2tdZU84TVr' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/18858/router-appears-to-block-proper-tcp-session-teardown-fin-ack-ever-see-this?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/18858/router-appears-to-block-proper-tcp-session-teardown-fin-ack-ever-see-this?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/tcp/"
            class="tag-link-tcp"
            title="see questions tagged'tcp'using tags"
            rel="tag">tcp</a> <span class="tag-number">&#215;752</span><br/>
        
        <a href="/tags/ack/"
            class="tag-link-ack"
            title="see questions tagged'ack'using tags"
            rel="tag">ack</a> <span class="tag-number">&#215;139</span><br/>
        
        <a href="/tags/handshake/"
            class="tag-link-handshake"
            title="see questions tagged'handshake'using tags"
            rel="tag">handshake</a> <span class="tag-number">&#215;44</span><br/>
        
        <a href="/tags/fin/"
            class="tag-link-fin"
            title="see questions tagged'fin'using tags"
            rel="tag">fin</a> <span class="tag-number">&#215;32</span><br/>
        
        <a href="/tags/rv082/"
            class="tag-link-rv082"
            title="see questions tagged'rv082'using tags"
            rel="tag">rv082</a> <span class="tag-number">&#215;1</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Feb. 25, 2013, 11:52 a.m.">25 Feb '13, 11:52</strong>
    </p>
    <p> 
     	question was seen: <strong>12,273 times</strong>
    </p>
    <p> 
        last updated: <strong title="Feb. 26, 2013, 11:25 a.m.">26 Feb '13, 11:25</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/14212/router-replies-with-rst-after-fin-ack">Router replies with [RST] after [FIN, ACK]</a>
        </p>
        
        <p>
            <a href="/questions/60799/modbus-tcp-connection-drops-after-7-hours-and-20-minutes">Modbus TCP connection drops after 7 hours and 20 minutes</a>
        </p>
        
        <p>
            <a href="/questions/55471/syn-no-synacktrying-to-figure-out-whats-wrong-with-the-client-server-tcp-communication">[SYN-&gt;no SYN,ACK]Trying to figure out what&#39;s wrong with the client-server TCP communication.</a>
        </p>
        
        <p>
            <a href="/questions/18817/syn-is-answered-by-a-strange-ack-rst-is-ignored-windows">SYN is answered by a strange ACK, RST is ignored. Windows</a>
        </p>
        
        <p>
            <a href="/questions/4932/not-honoring-own-mss">Not honoring own MSS?</a>
        </p>
        
        <p>
            <a href="/questions/7972/acked-lost-segments-false-positive">ACKed lost segments - false positive?</a>
        </p>
        
        <p>
            <a href="/questions/25374/server-sending-rst-message">Server sending RST Message</a>
        </p>
        
        <p>
            <a href="/questions/39477/difference-in-captured-packets-on-ubuntu-1404-vs-debian-8">Difference in captured packets on Ubuntu 14.04 VS. Debian 8</a>
        </p>
        
        <p>
            <a href="/questions/42044/how-to-know-if-the-packet-is-acknowledgement-packet-or-not">how to know if the packet is acknowledgement packet or not</a>
        </p>
        
        <p>
            <a href="/questions/58259/measure-rtt-over-lte-strange-behaviour">Measure RTT over LTE , strange behaviour</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
