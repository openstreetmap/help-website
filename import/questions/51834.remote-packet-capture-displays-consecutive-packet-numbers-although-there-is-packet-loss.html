<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Remote packet capture displays consecutive packet numbers although there is packet loss - Wireshark Q&amp;A</title>
        <meta name="description" content="Hi, When using Wireshark with remote packet capture against remote interface running rpcapd (and capture is done over UDP), I get sometimes packet loss in the network due to network congestion. Although these lost packets are indicated in the RPCAP “frame number” (i.e. received RPCAP captured packet..." />
        <meta name="keywords" content="remote-capture,rpcap,order,packetloss" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/51834/remote-packet-capture-displays-consecutive-packet-numbers-although-there-is-packet-loss" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/51834/remote-packet-capture-displays-consecutive-packet-numbers-although-there-is-packet-loss?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='fQsvfuEVJ7PxFpaP8PawapDWTX3BgOBh' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/51834/remote-packet-capture-displays-consecutive-packet-numbers-although-there-is-packet-loss">Remote packet capture displays consecutive packet numbers although there is packet loss</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-51834-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/51834/up/" rel="nofollow"> </a>
<div id="post-51834-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-51834-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/51834/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/51834/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hi,
When using Wireshark with remote packet capture against remote interface running rpcapd (and capture is done over UDP), I get sometimes packet loss in the network due to network congestion.
Although these lost packets are indicated in the RPCAP “frame number” (i.e. received RPCAP captured packets frame numbers are not consecutive), it seems that Wireshark is renumbering the received RPCAP UDP captured packets and display the packet numbers as consecutive.
To my understanding the displayed numbers should be taken from the RPCAP “frame number” so the lost packets will be shown as “missing”.
Is there some configuration to change that ?
Thanks,
Guy</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/remote-capture/" class="post-tag tag-link-remote-capture"
                                        title="see questions tagged 'remote-capture'" rel="tag">remote-capture</a>
                                
                                    <a href="/tags/rpcap/" class="post-tag tag-link-rpcap"
                                        title="see questions tagged 'rpcap'" rel="tag">rpcap</a>
                                
                                    <a href="/tags/order/" class="post-tag tag-link-order"
                                        title="see questions tagged 'order'" rel="tag">order</a>
                                
                                    <a href="/tags/packetloss/" class="post-tag tag-link-packetloss"
                                        title="see questions tagged 'packetloss'" rel="tag">packetloss</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>21 Apr '16, 03:31</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/51995149b9c12024f2da2a17d171bba0?s=32&amp;d=identicon&amp;r=g" alt="Guyg's gravatar image" />
    <p><a href="/users/23953/guyg">Guyg</a><br/>
    <span class="score" title="0 reputation points">0</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">&#9679;</span><span class="badgecount">3</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Guyg has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/51834/">
                edited
                <strong>21 Apr '16, 03:50</strong>
            </a>
        </p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-51834">
    
</div>
<div id="comment-tools-51834" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-51834-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/51834/remote-packet-capture-displays-consecutive-packet-numbers-although-there-is-packet-loss?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/51834/remote-packet-capture-displays-consecutive-packet-numbers-although-there-is-packet-loss?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/51834/remote-packet-capture-displays-consecutive-packet-numbers-although-there-is-packet-loss?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/51834/remote-packet-capture-displays-consecutive-packet-numbers-although-there-is-packet-loss?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="51848"></a>
                    <div id="answer-container-51848" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-51848-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/51848/up/" rel="nofollow"> </a>
<div id="post-51848-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-51848-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/51848/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <blockquote>
<p>Wireshark is renumbering the received RPCAP UDP captured packets and display the packet numbers as consecutive. </p>
</blockquote>
<p>Wireshark <em>always</em> numbers packets consecutively, as seen by the dumpcap program (which is part of Wireshark, and what Wireshark runs to do capturing).  There's no provision for having the captured frames numbered differently.</p>
<p>If your remote capture is being done by telling Wireshark to capture on a remote machine, WinPcap is not passing the packet number from the RPCAP messages to Wireshark, so Wireshark has no idea what the packet numbers were when captured on the remote machine.</p>
<p>If your remote capture is being done by another program, and Wireshark is capturing on the network over which that program and the machine on which the capture is being done are communicating, with Wireshark dissecting the RPCAP protocol and the packets carried over it, what you <em>could</em> do is edit the list of displayed columns, remove the "frame number" column, and add a custom column displaying the "rpcap.number" field, and call <em>that</em> column "Num" or "Number".</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/51848/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>21 Apr '16, 14:04</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" alt="Guy%20Harris's gravatar image" />
    <p><a href="/users/79/guy-harris">Guy Harris ♦♦</a><br/>
    <span class="score" title="17443 reputation points"><span class="">17.4k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">&#9679;</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">&#9679;</span><span class="badgecount">196</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Guy Harris has 216 accepted answers">19&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/51848/">
                edited
                <strong>22 Apr '16, 10:31</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-51848">
    
        <a name="51866"></a>
        <div class="comment" id="comment-51866">
            <div id="post-51866-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi Guy,</p>

<p>Thanks for the answer !
Re “Wireshark always numbers packets consecutively, as captured.”:</p>

<p>I agree, but, I think in this case the RPCAP “frame number” represent the actual order on the port, as we are talking about “remote interface” ?</p>

<p>Regarding your proposal:
I didn’t manage to add a "frame number" as a column when I'm capturing from remote interface as it seems Wireshark removes the RPCAP encapsulation before displaying the packets (I did managed doing that when capturing from the local port and applying display filter of “rpcap and udp” but then the packets are shown with their encapsulation which is a pity when one have the ability of showing the traffic exactly as on remote port).</p>

<p>Thanks again,</p>

<p>Guy</p></div>
            <div class="comment-info" id="comment-51866-info">
                
                
                
                

                

                <span class="comment-age">(22 Apr '16, 04:24)</span>
                <a class="comment-user userinfo" href="/users/23953/guyg">Guyg</a>
                
            </div>
        </div>
    
        <a name="51881"></a>
        <div class="comment" id="comment-51881">
            <div id="post-51881-score" class="comment-score"></div>
            <div class="comment-text"><p>I've updated the question to 1) give more details as to what "as captured" means and 2) talk about two different ways in which an RPCAP capture can be handled by Wireshark.</p></div>
            <div class="comment-info" id="comment-51881-info">
                
                
                
                

                

                <span class="comment-age">(22 Apr '16, 10:33)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="51889"></a>
        <div class="comment" id="comment-51889">
            <div id="post-51889-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi Guy,</p>

<p>Thanks for the clarification !
I think the RPCAP "frame number" delivers a very important info that adds to the reliability of the remote capture data. As it is already delivered together with the captured packet, it'll be very beneficial if it will be shown (together with the regular number) in Wireshark's display.
Is there a way to suggest that WinPcap will be modified to pass the RPCAP "frame number" to Wireshark ?</p>

<p>Thanks,
Guy</p></div>
            <div class="comment-info" id="comment-51889-info">
                
                
                
                

                

                <span class="comment-age">(23 Apr '16, 05:01)</span>
                <a class="comment-user userinfo" href="/users/23953/guyg">Guyg</a>
                
            </div>
        </div>
    
        <a name="51899"></a>
        <div class="comment" id="comment-51899">
            <div id="post-51899-score" class="comment-score"></div>
            <div class="comment-text"><p>WinPcap's API will probably track libpcap's API (especially once the new remote capture support gets into libpcap), so the right place to ask would be on the <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="2357405347564e530e544c5148465150634f4a5057500d57405347564e530d4c5144">[email&#160;protected]</a> mailing list or the <a href="https://github.com/the-tcpdump-group/libpcap/issues">libpcap issues list on GitHub</a>.</p>

<p>However, are the frame numbers interesting by themselves, or is what's interesting an indication of the points at which packets were dropped and a number of dropped packets?  Handling the drop indications would require support in <a href="https://github.com/pcapng/pcapng">pcapng</a>; there's already an "epb_dropcount" option in the Enhanced Packet Block, and an "epb_remotedropcount" option, or something such as that, could record drops in remote captures due to packets not being received by libpcap/WinPcap.</p></div>
            <div class="comment-info" id="comment-51899-info">
                
                
                
                

                

                <span class="comment-age">(23 Apr '16, 14:01)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="51900"></a>
        <div class="comment" id="comment-51900">
            <div id="post-51900-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi Guy,
As far as I know, RPCAP is not supported on libpcap. 
Can you elaborate on the "new remote capture support gets into libpcap" ?</p>

<p>The frame numbers are of interest as someone who uses remote capture to debug a network problem, need to know if the information he reviews is indeed the actual packets at the remote port or some info is missing due to (additional other) network problem.</p>

<p>I just realized that as the RPCAP frame numbers are not passed by WinPcap to Wireshark, this is probably the case with the RPCAP timestamps that are not passed to Wireshark as well ? :-(</p>

<p>Interesting to hear about the pcapng RFC. Will libpcap support it as well as Winpcap ?</p>

<p>Thanks,
Guy</p></div>
            <div class="comment-info" id="comment-51900-info">
                
                
                
                

                

                <span class="comment-age">(23 Apr '16, 14:28)</span>
                <a class="comment-user userinfo" href="/users/23953/guyg">Guyg</a>
                
            </div>
        </div>
    
        <a name="51901"></a>
        <div class="comment not_top_scorer" id="comment-51901">
            <div id="post-51901-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>As far as I know, RPCAP is not supported on libpcap. Can you elaborate on the "new remote capture support gets into libpcap" ?</p>
</blockquote>

<p>RPCAP support can be added to libpcap, and some have added it.  However, it doesn't fit well with the new <code>pcap_create()</code> and <code>pcap_activate()</code> APIs, and may not be general enough to handle other forms of remote capture, so I have a work in progress to add new APIs to go along with <code>pcap_create()</code> and <code>pcap_activate()</code> to support multiple remote capture mechanisms.</p></div>
            <div class="comment-info" id="comment-51901-info">
                
                
                
                

                

                <span class="comment-age">(23 Apr '16, 14:39)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="51902"></a>
        <div class="comment not_top_scorer" id="comment-51902">
            <div id="post-51902-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>The frame numbers are of interest as someone who uses remote capture to debug a network problem, need to know if the information he reviews is indeed the actual packets at the remote port or some info is missing due to (additional other) network problem.</p>
</blockquote>

<p>If the packets are delivered to the program using libpcap/WinPcap in order by frame number (which the RPCAP client should do), what information would be unavailable to the person doing the remote capture if every packet for which some previous packets had been lost over the network included a count of lost packets, rather than having each packet have a frame number (from which the count of lost packets can be calculated), and the lost packet counts were displayed?</p></div>
            <div class="comment-info" id="comment-51902-info">
                
                
                
                

                

                <span class="comment-age">(23 Apr '16, 14:42)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="51903"></a>
        <div class="comment not_top_scorer" id="comment-51903">
            <div id="post-51903-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi,
Not sure I follow you, but as I see it, knowing the amount of lost packets may be insufficient. Sometimes there is a need to debug specific session running specific protocol. For example, when a handshake between client and server is malfunctioning, there is a need to analyze the protocol packet by packet (e.g. when there is a request and no response). In such debug, it'll be most confusing to see some of the handshake missing while not knowing if the missing packet is a real problem occurring at the remote port or just additional problem due to congestion in the path between remote port and Wireshark.</p></div>
            <div class="comment-info" id="comment-51903-info">
                
                
                
                

                

                <span class="comment-age">(23 Apr '16, 14:57)</span>
                <a class="comment-user userinfo" href="/users/23953/guyg">Guyg</a>
                
            </div>
        </div>
    
        <a name="51905"></a>
        <div class="comment not_top_scorer" id="comment-51905">
            <div id="post-51905-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>I just realized that as the RPCAP frame numbers are not passed by WinPcap to Wireshark, this is probably the case with the RPCAP timestamps that are not passed to Wireshark as well ?</p>
</blockquote>

<p>No.  The libpcap/WinPcap APIs don't pass <em>any</em> frame numbers to its callers, so there's no provision to pass a frame number from the RPCAP packet.  Those APIs <em>do</em> pass a time stamp, and the only time stamp that makes sense for them to pass is the one from the RPCAP packet, so that's what they pass.</p></div>
            <div class="comment-info" id="comment-51905-info">
                
                
                
                

                

                <span class="comment-age">(23 Apr '16, 17:33)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="51906"></a>
        <div class="comment not_top_scorer" id="comment-51906">
            <div id="post-51906-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>Hi, Not sure I follow you, but as I see it, knowing the amount of lost packets may be insufficient.</p>
</blockquote>

<p>It's not just the number of lost packets, it's the point at which they're lost - Wireshark could, for example, display in the packet list pane, for example, in addition to packets, "N packets dropped" indications (and should do so for <em>all</em> packets dropped, not just packets dropped due to remotely-captured packets not being received - currently, few if any packet capture mechanisms supply packet drop counts <em>along with packets</em>, but pcapng supports that, and I'd like to get that ability into the {Linux, BPF, etc.} packet capture mechanisms.</p></div>
            <div class="comment-info" id="comment-51906-info">
                
                
                
                

                

                <span class="comment-age">(23 Apr '16, 17:41)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="51907"></a>
        <div class="comment not_top_scorer" id="comment-51907">
            <div id="post-51907-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>Interesting to hear about the pcapng RFC. Will libpcap support it as well as Winpcap ?</p>
</blockquote>

<p>libpcap already has limited support for it; the current libpcap APIs can't handle more than one link-layer header type, snapshot length, or section byte order in a capture, but any program using sufficiently recent versions of libpcap can read pcapng files in which all the network interfaces have the same link-layer header type and snapshot length and all the sections have the same byte order.</p>

<p>Current WinPcap releases, however, are based on an older version of libpcap that didn't support pcapng, so it <em>doesn't</em> currently support reading pcapng files.</p>

<p>Future versions of libpcap will offer an alternative API that can read arbitrary pcapng files (and that will also read pcap files, with the application not needing to know or care what type of file it is), as well as offering the current APIs; versions of WinPcap or NPcap based on those future versions will have the same capabilities.</p></div>
            <div class="comment-info" id="comment-51907-info">
                
                
                
                

                

                <span class="comment-age">(23 Apr '16, 17:52)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="51914"></a>
        <div class="comment not_top_scorer" id="comment-51914">
            <div id="post-51914-score" class="comment-score"></div>
            <div class="comment-text"><p>Interesting.
I hope to go over the RFC in more details later.
One thing I think will be of value is to add indication of the packet direction (ingress/egress).
As you suggested, I will post a request in libpcap issues list on GitHub for RPCAP support in general and passing on RPCAP frame number specifically.
Many thanks !
Guy</p></div>
            <div class="comment-info" id="comment-51914-info">
                
                
                
                

                

                <span class="comment-age">(24 Apr '16, 13:44)</span>
                <a class="comment-user userinfo" href="/users/23953/guyg">Guyg</a>
                
            </div>
        </div>
    
        <a name="51915"></a>
        <div class="comment not_top_scorer" id="comment-51915">
            <div id="post-51915-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>One thing I think will be of value is to add indication of the packet direction (ingress/egress).</p>
</blockquote>

<p>Presumably meaning "display, in Wireshark, the direction indication, for file formats that support it, including pcapng"; pcapng's Enhanced Packet Block (and deprecated Packet Block) have an epb_flags option (or pb_flags for the Packet Block) that includes an optional indication of whether the packet is incoming or outgoing.</p>

<p>This applies when capturing on an interface that's an active network device, such as an Ethernet or Wi-Fi adapter.  If you're doing passive tapping on a wire, all packets are incoming; if this is passively capturing on a connection to, for example, an ISDN or ATM network, the "user to network" or "network to user" direction would be provided in a pseudo-header at the beginning of the packet data.</p></div>
            <div class="comment-info" id="comment-51915-info">
                
                
                
                

                

                <span class="comment-age">(24 Apr '16, 15:18)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-51848" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 13
        </span>
        <a href="#" class="show-all-comments-link">show 8 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-51848-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/51834/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='fQsvfuEVJ7PxFpaP8PawapDWTX3BgOBh' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/51834/remote-packet-capture-displays-consecutive-packet-numbers-although-there-is-packet-loss?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/51834/remote-packet-capture-displays-consecutive-packet-numbers-although-there-is-packet-loss?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/packetloss/"
            class="tag-link-packetloss"
            title="see questions tagged'packetloss'using tags"
            rel="tag">packetloss</a> <span class="tag-number">&#215;45</span><br/>
        
        <a href="/tags/remote-capture/"
            class="tag-link-remote-capture"
            title="see questions tagged'remote-capture'using tags"
            rel="tag">remote-capture</a> <span class="tag-number">&#215;26</span><br/>
        
        <a href="/tags/rpcap/"
            class="tag-link-rpcap"
            title="see questions tagged'rpcap'using tags"
            rel="tag">rpcap</a> <span class="tag-number">&#215;17</span><br/>
        
        <a href="/tags/order/"
            class="tag-link-order"
            title="see questions tagged'order'using tags"
            rel="tag">order</a> <span class="tag-number">&#215;10</span><br/>
        
    </p>
    <p>
        question asked: <strong title="April 21, 2016, 3:31 a.m.">21 Apr '16, 03:31</strong>
    </p>
    <p> 
     	question was seen: <strong>2,010 times</strong>
    </p>
    <p> 
        last updated: <strong title="April 24, 2016, 3:18 p.m.">24 Apr '16, 15:18</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/56514/find-adapter-name-for-winpcap">Find Adapter Name for WinPCAP</a>
        </p>
        
        <p>
            <a href="/questions/54976/cannot-capture-from-remote-system">cannot capture from remote system</a>
        </p>
        
        <p>
            <a href="/questions/1698/tcp-out-of-order-what-does-it-means">&quot;TCP out of order &quot; what does it means ?!!!</a>
        </p>
        
        <p>
            <a href="/questions/30485/measure-delay-and-packetloss-on-http-ftp-packet">Measure delay and packetloss on HTTP &amp; FTP packet</a>
        </p>
        
        <p>
            <a href="/questions/42321/using-wireshark-to-detect-isp-throttling">Using Wireshark to detect isp throttling</a>
        </p>
        
        <p>
            <a href="/questions/60703/info-about-this-capture">info about this capture</a>
        </p>
        
        <p>
            <a href="/questions/56239/decrypt-ssl-from-remote-interface">decrypt ssl from remote interface</a>
        </p>
        
        <p>
            <a href="/questions/48675/capture-appliance">Capture Appliance</a>
        </p>
        
        <p>
            <a href="/questions/7986/order-of-operation">Order-of-operation</a>
        </p>
        
        <p>
            <a href="/questions/20723/please-check-for-me">please check for me.</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
