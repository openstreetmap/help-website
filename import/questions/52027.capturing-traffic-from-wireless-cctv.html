<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Capturing Traffic From Wireless CCTV - Wireshark Q&amp;A</title>
        <meta name="description" content="Hello guys, I&#39;d like to check the traffic in/out from my wireless camera. I need to know the who it talks to. Now the camera has a internal ip of 192.X.X.X If I start capturing with filter: host 192.X.X.X I get only traffic in/out the camera which is good but if I connect to the camera from my iPhon..." />
        <meta name="keywords" content="wireless,cctv" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/52027/capturing-traffic-from-wireless-cctv" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/52027/capturing-traffic-from-wireless-cctv?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='0S0r9NAZgTKp08lOjypIsUU1UjPcQj7v' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/52027/capturing-traffic-from-wireless-cctv">Capturing Traffic From Wireless CCTV</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-52027-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/52027/up/" rel="nofollow"> </a>
<div id="post-52027-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-52027-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/52027/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/52027/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hello guys,</p>
<p>I'd like to check the traffic in/out from my wireless camera.</p>
<p>I need to know the who it talks to.</p>
<p>Now the camera has a internal ip of 192.X.X.X</p>
<p>If I start capturing with filter: host 192.X.X.X I get only traffic in/out the camera which is good but if I connect to the camera from my iPhone app Wireshark doesn't capture any traffic in/out the camera.</p>
<p>can anybody help me with this issue?</p>
<p>Thanks in advance</p>
<p>Bye</p>
<p>64rl0</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/wireless/" class="post-tag tag-link-wireless"
                                        title="see questions tagged 'wireless'" rel="tag">wireless</a>
                                
                                    <a href="/tags/cctv/" class="post-tag tag-link-cctv"
                                        title="see questions tagged 'cctv'" rel="tag">cctv</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>27 Apr '16, 15:46</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/10122200f079bddde0be996f032cd8d8?s=32&amp;d=identicon&amp;r=g" alt="64rl0's gravatar image" />
    <p><a href="/users/24012/64rl0">64rl0</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">&#9679;</span><span class="badgecount">4</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="64rl0 has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-52027">
    
</div>
<div id="comment-tools-52027" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-52027-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/52027/capturing-traffic-from-wireless-cctv?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/52027/capturing-traffic-from-wireless-cctv?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/52027/capturing-traffic-from-wireless-cctv?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/52027/capturing-traffic-from-wireless-cctv?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="52030"></a>
                    <div id="answer-container-52030" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-52030-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/52030/up/" rel="nofollow"> </a>
<div id="post-52030-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-52030-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/52030/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Check <a href="https://ask.wireshark.org/questions/50844/cant-capture-all-packets-from-my-iphone">this older question</a> regarding a similar topic and the answer to it. If it does not help, come back here.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/52030/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>28 Apr '16, 00:43</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/00fc6e2633725bd871ff636f0175eabc?s=32&amp;d=identicon&amp;r=g" alt="sindy's gravatar image" />
    <p><a href="/users/19586/sindy">sindy</a><br/>
    <span class="score" title="6049 reputation points"><span class="">6.0k</span></span><span title="4 badges"><span class="badge1">&#9679;</span><span class="badgecount">4</span></span><span title="8 badges"><span class="silver">&#9679;</span><span class="badgecount">8</span></span><span title="51 badges"><span class="bronze">&#9679;</span><span class="badgecount">51</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="sindy has 110 accepted answers">24&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-52030">
    
        <a name="52032"></a>
        <div class="comment" id="comment-52032">
            <div id="post-52032-score" class="comment-score"></div>
            <div class="comment-text"><p>Thank you very much!!!!!</p>

<p>I've got OS X so the only think I now need to find is monitoring mode, isn't it?</p>

<p>Do I need to turn promiscuous mode off when I turn monitoring mode on?</p>

<p>Thank again </p>

<p>Bye</p>

<p>64rl0</p></div>
            <div class="comment-info" id="comment-52032-info">
                
                
                
                

                

                <span class="comment-age">(28 Apr '16, 00:50)</span>
                <a class="comment-user userinfo" href="/users/24012/64rl0">64rl0</a>
                
            </div>
        </div>
    
        <a name="52034"></a>
        <div class="comment" id="comment-52034">
            <div id="post-52034-score" class="comment-score"></div>
            <div class="comment-text"><p>I've converted your "Answer" (which it was not) into a Comment to my Answer, which is how this site is supposed to work, see site FAQ.</p>

<blockquote>
<p>Do I need to turn promiscuous mode off when I turn monitoring mode on?</p>
</blockquote>

<p>No, if the WLAN driver is in monitoring mode, the destination MAC address filter, which you normally deactivate by setting promiscuous mode, is not active.</p>

<p>But bear in mind that if your WLAN uses encryption, you have to capture the encryption key negotiation phase of all devices except the Access Point (your wireless router) whose traffic you want to see above the 802.11 layer (so in your case, it would be the camera and the iPhone). So if it is the case, first start the capture in monitoring mode on your MAC, then restart the camera, and then switch off and on WiFi on the iPhone. After that, you have to tell Wireshark the passphrase to your WLAN. Instructions can be found e.g. <a href="https://ask.wireshark.org/questions/49288/problems-with-capturing-other-device-wlan-traffic">here</a> but there are several simpler answers around here.</p>

<p>This is only necessary in monitoring mode - in promiscuous mode, you didn't need to care as there it is the driver that takes care of WPA so you get the frames decrypted.</p></div>
            <div class="comment-info" id="comment-52034-info">
                
                
                
                

                

                <span class="comment-age">(28 Apr '16, 01:09)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="52060"></a>
        <div class="comment" id="comment-52060">
            <div id="post-52060-score" class="comment-score"></div>
            <div class="comment-text"><p>Hello Sindy,</p>

<p>I followed all the steps:</p>

<p>•capture options -&gt; interface: Wi-Fi -&gt; monitoring mode: enabled</p>

<p>•start capturing</p>

<p>•802.11 Preferences</p>

<p>•Decryption Keys -&gt; edit</p>

<p>•add Key type: wpa-pdw</p>

<p>•add Key: password:ssid </p>

<p>everything looks ok now my question is:</p>

<p>why it doesn't capture anything if I set ipv4 host on the camera IP?
It does capture lots of date if I don't set any filter.</p>

<p>What I'd like to do is monitor which external ip address the camera sends data to.</p>

<p>It is a cheap camera from Amazon and I'd like to know if the camera sends information to anyone else rather than me.</p>

<p>This is the reason why I'd like to monitor the traffic in/out from the camera.</p>

<p>Thanks in advance</p>

<p>Bye </p>

<p>64rl0</p></div>
            <div class="comment-info" id="comment-52060-info">
                
                
                
                

                

                <span class="comment-age">(28 Apr '16, 12:35)</span>
                <a class="comment-user userinfo" href="/users/24012/64rl0">64rl0</a>
                
            </div>
        </div>
    
        <a name="52070"></a>
        <div class="comment" id="comment-52070">
            <div id="post-52070-score" class="comment-score"></div>
            <div class="comment-text"><p>Ok I'll add a bit more of info after all the tests I've run.</p>

<p>I can now tell that nothing is working with the wpa.</p>

<p>I created a new network 2.4ghz without security. 
Connected camera phone and MacBook to that network. 
Start monitoring and everything was PERFECT!!!!!!
Start monitoring again with filter host X.X.X.X and again PERFECT!!!!!!</p>

<p>I then removed the test SSID and connect everything back to the standard one.
Start monitoring with filter host and NOTHING!!!!</p>

<p>802.11 preferences I set it on wpa-pdw -&gt;password:SSID.
and I set wpa-psk as well with the raw generator.</p>

<p>Unfortunately nothing </p>

<p>Thanks</p>

<p>Bye </p>

<p>Carlo</p></div>
            <div class="comment-info" id="comment-52070-info">
                
                
                
                

                

                <span class="comment-age">(29 Apr '16, 00:47)</span>
                <a class="comment-user userinfo" href="/users/24012/64rl0">64rl0</a>
                
            </div>
        </div>
    
        <a name="52087"></a>
        <div class="comment" id="comment-52087">
            <div id="post-52087-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>I can now tell that nothing is working with the wpa.</p>
</blockquote>

<p>As it works for almost everyone else, I dare to ask you whether you haven't forgotten that in order to allow Wireshark use the password:ssid tuple for WPA decryption, you have to capture the negotiation of encryption keys between each of the devices (STAs) of interest and the AP as part of the capture. The display filter which shall quickly show you whether you have really captured them is <code>eapol</code>. In the Info column of packet list, you must see "Key (Message 1 of 4)" through to "Key (Message 4 of 4)". If you've missed any of the EAPOL frames while capturing for a given device, the decryption for that device won't work.</p>

<p>The EAPOL negotiation takes place each time the STA associates to the WLAN, and the negotiated keys differ each time and for each device even though the passphrase is the same for all. Switching the device off and on is one possibility how to enforce the EAPOL negotiation, but you may use a smaller hammer on some devices - switch off an on only the WLAN connection, or switch the device to sleep mode and wake it up again. But I suspect that the only method for the camera will be a power cycle.</p>

<p>If you can see that you have captured all the EAPOL packets but the decryption doesn't work anyway, I'd suggest you to temporarily change the passphrase to some other one which you're really unlikely to use normally, take the capture including the association phase of the devices, and publish that capture, login-free, somewhere like at Cloudshark (preferred by the community around this site), Google drive, Dropbox, ... and provide a link to it here so that we could have a look what may be wrong without disclosing the passphrase you use normally.</p></div>
            <div class="comment-info" id="comment-52087-info">
                
                
                
                

                

                <span class="comment-age">(29 Apr '16, 10:46)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="52090"></a>
        <div class="comment not_top_scorer" id="comment-52090">
            <div id="post-52090-score" class="comment-score"></div>
            <div class="comment-text"><p>hello Sindy,</p>

<p>I think my decryption key doesn't work. I can't understand where I got it wrong.</p>

<p>So, here a picture of what happen after I start a capture in monitor mode:</p>

<p>•start capture</p>

<p>•turn Wi-Fi off/on on my iPhone</p>

<p>•browser on iPhone apps </p>

<p>•taken screenshot </p>

<p><a href="https://i.imgsafe.org/534727d.png">https://i.imgsafe.org/534727d.png</a></p>

<p>as you can see I've got "Key (Message 1 of 4)" through to "Key (Message 4 of 4)" but I can't filter the iPhone ip X.X.X.X</p>

<p>Thanks</p>

<p>Bye</p>

<p>64rl0</p></div>
            <div class="comment-info" id="comment-52090-info">
                
                
                
                

                

                <span class="comment-age">(29 Apr '16, 14:30)</span>
                <a class="comment-user userinfo" href="/users/24012/64rl0">64rl0</a>
                
            </div>
        </div>
    
        <a name="52093"></a>
        <div class="comment not_top_scorer" id="comment-52093">
            <div id="post-52093-score" class="comment-score"></div>
            <div class="comment-text"><p>Above <code>Decryption keys</code> in the list of 802.11 <code>Protocol Preferences</code>, there is <code>[] Enable Decryption</code>. Is the tickbox checked or not? If yes and decryption doesn't work, is there a colon (<code>:</code>) symbol in your passphrase or SSID?</p>

<p>And as already said - if we eventually should proceed further, you'd have to publish the pcap file, not just some screenshots, and in order not to disclose your real passphrase, you'll have to change it before taking the capture to be published.</p></div>
            <div class="comment-info" id="comment-52093-info">
                
                
                
                

                

                <span class="comment-age">(29 Apr '16, 22:33)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="52101"></a>
        <div class="comment not_top_scorer" id="comment-52101">
            <div id="post-52101-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi Sindy,</p>

<p>yes, enable decryption is ticked, and this is how I ì've inserted my detail.</p>

<p><a href="http://s32.postimg.org/o9waxx8id/Screen_Shot_2016_04_30_at_12_13_47.png">http://s32.postimg.org/o9waxx8id/Screen_Shot_2016_04_30_at_12_13_47.png</a></p>

<p>here a copy of the pcap with SSID: The Wolf and Password: 123456789 WPA2/PSK AES</p>

<p><a href="https://www.dropbox.com/s/xmma38ejgwctg55/test.pcap?dl=0">https://www.dropbox.com/s/xmma38ejgwctg55/test.pcap?dl=0</a></p></div>
            <div class="comment-info" id="comment-52101-info">
                
                
                
                

                

                <span class="comment-age">(30 Apr '16, 04:15)</span>
                <a class="comment-user userinfo" href="/users/24012/64rl0">64rl0</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-52030" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 8
        </span>
        <a href="#" class="show-all-comments-link">show 3 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-52030-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="52107"></a>
                    <div id="answer-container-52107" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-52107-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/52107/up/" rel="nofollow"> </a>
<div id="post-52107-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-52107-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/52107/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>I put in your SSID and passphrase and cannot determine what the issue might be with decryption because of the real issue: there are no data frames to decrypt.<br>
</p>
<p>With a filter: </p>
<pre><code>eapol
</code></pre>
<p>I see two sets of full 4-way handshake:</p>
<p><img alt="alt text" src="https://osqa-ask.wireshark.org/upfiles/eapol1_lbzL55G.png"></p>
<p>for devices </p>
<pre><code>(wlan.bssid == 00:1d:aa:ea:ca:42) or (wlan.addr == 6c:72:e7:05:60:60)
</code></pre>
<p>So the only frames that could be decrypted are after this 4-way handshake, and before the next set (i.e. as long as this PTK is in use, so up to a rekey, death, disassociate, etc).  Group key traffic is handled a little different, but a detail not likely critical here.</p>
<p>This filter gives me the frames for wlan client, and show only good ones:</p>
<pre><code>(wlan.addr == 6c:72:e7:05:60:60) and wlan.fcs_good == 1
</code></pre>
<p>So I don't see any Data frames between frame 3312 (Key 4 message) and a disassociate in frame 3594.<br>
</p>
<p>Your issue is not decryption, it is capturing packets.  I see both client and AP support 802.11n/ac (HT/VHT).  How are you capturing in the local RF environment?  I see the Checksum is passed up but no MCS index value, what capture device are you using?  Is it 802.11abg capable only?</p>
<p>I can infer traffic is passing between devices due to the block ACKs, CTS/RTS, etc.  These are sent usually transmitted at lower rates so probability is that we are more likely to see these than data frames which would be sent at a higher rate/modulation.</p>
<p>Note this finding might be consistent with the claim that a 2.4GHz/unencrypted environment was setup and all worked well.  Apple devices will not use 802.11n rates (and no device can do 802.11ac) on 2.4GHz, so perhaps the recognition of unencrypted traffic was due to the capture mechanism handling 802.11b/g rate frames properly.  I note this capture is on channel 36 (5GHz).  So we have two changes compounding the difficulties: 5GHz and capture of likely high speed unicast frames and encryption.  Perhaps try encrypted 2.4GHz configuration to see if you can get decryption to work, then address the other modulation issue with 5GHz.</p>
<p>I also note that this is not generally true:</p>
<blockquote>
<p>No, if the WLAN driver is in monitoring mode, the destination MAC address filter, which you normally deactivate by setting promiscuous mode, is not active.</p>
</blockquote>
<p>I have a handful of adapters with various chipsets that support monitor mode but not promiscuous mode.  I do agree that checking the box in Wireshark for promisc mode has no effect, but general searches on Google for this topic make similar claims: monitor mode is all that is needed.  Perhaps there is a better term or concept so this might be technically a correct statement, as written, but practically it is a myth.  Not all chipsets pass up unicast frames from other hosts even of they do monitor mode.  Perhaps this behavior is a bug and monitor mode is supposed to mean no filter, but it happens. </p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/52107/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>30 Apr '16, 05:11</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/0a47ef51dd9c9996d194a4983295f5a4?s=32&amp;d=identicon&amp;r=g" alt="Bob%20Jones's gravatar image" />
    <p><a href="/users/112/bob-jones">Bob Jones</a><br/>
    <span class="score" title="1014 reputation points"><span class="">1.0k</span></span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="5 badges"><span class="silver">&#9679;</span><span class="badgecount">5</span></span><span title="15 badges"><span class="bronze">&#9679;</span><span class="badgecount">15</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Bob Jones has 19 accepted answers">21&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-52107">
    
        <a name="52108"></a>
        <div class="comment" id="comment-52108">
            <div id="post-52108-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="/users/112/bob-jones">@Bob Jones</a>, you've made me delete an already written comment :-)</p>

<p>I was wondering how comes that the capture with WPA off did contain the data frames carrying IP packets while the WPA one doesn't; if the interdependency you describe (i.e. that the frequency band and modulation scheme used depends on security mode chosen) exists on some devices, it explains a lot.</p>

<p>As for my (over)statement, do you say it should have actually read "No, if the WLAN driver is in monitoring mode, ticking the promiscuous mode in Wireshark won't make any difference because it depends on the particular WLAN driver whether it filters frames by destination MAC address or not, and the promiscuous mode setting in Wireshark cannot change this"?</p>

<p><a href="/users/24012/64rl0">@64rl0</a>, in your particular case the above should not be an issue, given that your adaptor in the Mac machine does let through unicast packets sent to different destination MAC addresses.</p></div>
            <div class="comment-info" id="comment-52108-info">
                
                
                
                

                

                <span class="comment-age">(30 Apr '16, 05:26)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="52109"></a>
        <div class="comment" id="comment-52109">
            <div id="post-52109-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks Bob,</p>

<p>I'm using a macbook pro and its only capable of 802.11/abgn its not capable of ac.</p>

<p>so what I did was to turn 5Ghz off in the router and leave only 2.4 on.
unfortunately I can't see any difference in the capturing.</p>

<p><a href="https://www.dropbox.com/s/qk1htlyz10pwx2v/test1.pcap?dl=0">https://www.dropbox.com/s/qk1htlyz10pwx2v/test1.pcap?dl=0</a></p>

<p>here another capturing with SSID: test and Password: /none/</p>

<p><a href="https://www.dropbox.com/s/11pauwbcvhpctn7/test2.pcap?dl=0">https://www.dropbox.com/s/11pauwbcvhpctn7/test2.pcap?dl=0</a></p>

<p>as you can see I can filter camera ip and lots od UDP data that I can't see when I use an encrypted network</p>

<p>why can't I achieve the same results of the result with </p>

<p>SSID:test and password /none/</p>

<p>when I use </p>

<p>SSID: The Wolf an d password 123456789</p>

<p>thanks</p>

<p>Bye</p>

<p>64rl0</p></div>
            <div class="comment-info" id="comment-52109-info">
                
                
                
                

                

                <span class="comment-age">(30 Apr '16, 05:41)</span>
                <a class="comment-user userinfo" href="/users/24012/64rl0">64rl0</a>
                
            </div>
        </div>
    
        <a name="52110"></a>
        <div class="comment" id="comment-52110">
            <div id="post-52110-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<blockquote>
<p>(i.e. that the frequency band and modulation scheme used depends on security mode chosen)</p>
</blockquote>
</blockquote>

<p>In this case it was a 'user' choice to make both changes: going from something (presume 5GHz... but no trace so we can't tell) to 2.4GHz AND turning off encryption.  I know Apple devices (nor Cisco APs) won't do 40MHz on 2.4GHz so I actually mis-typed - they will do some n rates, just not the wide channels - sorry for my confusion.  I was looking at his beacons and they are set for 40MHz for 802.11n, </p>

<p>.... .... .... ..1. = HT Support channel width: Transmitter supports 20MHz and 40MHz operation</p>

<p>and looks like 80MHz on ac as well:</p>

<p>.... .... .... .... .... .... ..1. .... = Short GI for 80MHz: Supported</p>

<p>Since the network appears to support high speed rates with n/ac, wide channels, etc., his unicast frames will be high speed so they will be difficult to capture.<br>
</p>

<p>And I do agree with the new comment regarding promiscuous mode.  With these devices, nothing I do changes the behavior until I get a new driver.  My MacBook does monitor+promisc out of the box, but, for instance, here is a regression in the Linux kernel:</p>

<p><a href="http://marc.info/?l=linux-wireless&amp;m=145338234007903&amp;w=2">http://marc.info/?l=linux-wireless&amp;m=145338234007903&amp;w=2</a></p></div>
            <div class="comment-info" id="comment-52110-info">
                
                
                
                

                

                <span class="comment-age">(30 Apr '16, 05:48)</span>
                <a class="comment-user userinfo" href="/users/112/bob-jones">Bob Jones</a>
                
            </div>
        </div>
    
        <a name="52115"></a>
        <div class="comment" id="comment-52115">
            <div id="post-52115-score" class="comment-score"></div>
            <div class="comment-text"><p>In the file test1.pcap, after frame 64583 I am able to decrypt device wlan.addr == 6c:72:e7:05:60:60 with your provided credentials.  The positioning in the trace is significant because this is the first instance of 4-way handshake completion.</p>

<p>For instance, frame  64819 is:</p>

<p>64819   119.993339  0.00019  132.245.229.146    192.168.1.31    TCP 2412    130 -44 130         678     [TCP segment of a reassembled PDU]</p></div>
            <div class="comment-info" id="comment-52115-info">
                
                
                
                

                

                <span class="comment-age">(30 Apr '16, 09:06)</span>
                <a class="comment-user userinfo" href="/users/112/bob-jones">Bob Jones</a>
                
            </div>
        </div>
    
        <a name="52117"></a>
        <div class="comment" id="comment-52117">
            <div id="post-52117-score" class="comment-score"></div>
            <div class="comment-text"><p>ok finally i solve my problem.</p>

<p>I found a website to convert my SSID and password in a spa-psk, added that to the 802.11 preferences, then turn 5 Ghz off in the router, rebooted the camera and voilà traffic has started appearing in Wireshark.</p>

<p>The only problem is as soon as I turn 5 Ghz on my macbook connects straight to it and Wireshark stops getting traffic from the camera.</p>

<p>I think it is because 2.4 and 5 have the same SSID and the macbook is connected to 5 and the camera is connected to 2.4.</p>

<p>But its alright because I got what i wanted.</p>

<p>now i know i need to turn 5Ghz off in the router if I need to monitor the traffic in my network.</p>

<p>THANKS TO EVERYONE GUYS FOR ALL YOUR HELP!!!!</p>

<p>Bye</p>

<p>64rl0</p></div>
            <div class="comment-info" id="comment-52117-info">
                
                
                
                

                

                <span class="comment-age">(30 Apr '16, 12:05)</span>
                <a class="comment-user userinfo" href="/users/24012/64rl0">64rl0</a>
                
            </div>
        </div>
    
        <a name="52124"></a>
        <div class="comment not_top_scorer" id="comment-52124">
            <div id="post-52124-score" class="comment-score"></div>
            <div class="comment-text"><p>Glad it's working for you.  Some comments:</p>

<blockquote>
<blockquote>
<p>I found a website to convert my SSID and password in a spa-psk</p>
</blockquote>
</blockquote>

<p>I didn't have to do this to decrypt your traffic, so it should work but is not necessary.  Wireshark can (does) the same calculation of converting an SSID and PSK to a PMK.</p>

<blockquote>
<blockquote>
<p>The only problem is as soon as I turn 5 Ghz on my macbook connects straight to it and Wireshark stops getting traffic from the camera.<br>
</p>
</blockquote>
</blockquote>

<p>This can happen, so have a look at this answer if you want to avoid this:</p>

<p><a href="https://ask.wireshark.org/questions/52077/cant-capture-5ghz-traffic-on-os-x">https://ask.wireshark.org/questions/52077/cant-capture-5ghz-traffic-on-os-x</a></p>

<p>Use your particular channel that has camera communication.  This assumes you don't want the MAC to be connected to anything.  If you do, then obviously you don't want to do this, and you won't be able to capture a different channel at the same time.</p>

<blockquote>
<blockquote>
<p>i need to turn 5Ghz</p>
</blockquote>
</blockquote>

<p>You should be able to sniff 5GHz, it will just take more work to get the capture mechanism correct.  Try the tool referenced in the link above and set your Mac as a dedicated sniffer to the 5GHz channel and proper width - I'm guessing 80MHz from the probes/beacons in an earlier trace - and see if you can catch the 5GHz traffic.</p></div>
            <div class="comment-info" id="comment-52124-info">
                
                
                
                

                

                <span class="comment-age">(01 May '16, 11:36)</span>
                <a class="comment-user userinfo" href="/users/112/bob-jones">Bob Jones</a>
                
            </div>
        </div>
    
        <a name="52125"></a>
        <div class="comment not_top_scorer" id="comment-52125">
            <div id="post-52125-score" class="comment-score"></div>
            <div class="comment-text"><p>Well, from what Carlo wrote over time I've concluded that while the AP supports 2.4 and 5 GHz simultaneously, the camera doesn't. And as the Mscbook Pro in monitoring mode remained tuned to the 5 GHz channel to which it was previously associated, it could only monitor at 5 GHz, and thus could only see part of the iPhone's 5 GHz traffic but none of the camera's 2.4 GHz one.</p>

<p>So while the AP can bridge the 802.11 frames between the camera and the iPhone, so the frames which the camera is sending to the iPhone could be spotted on the "5 GHz" portion of their way which spans from the AP to the iPhone (provided that the AP would be sending them using a modulation scheme the Macbook Pro would understand), to fulfil the task of finding out all IPs to which the camera is talking to, it is necessary to set the Macbook Pro to monitor at the proper channel at 2.4 GHz.</p>

<p>And, having myself no clue how to instruct the wireless driver what channel to tune to in monitoring mode (I don't own any Mac), I can imagine that Carlo also depends on what channel the adaptor was associated before the monitoring mode has been activated, and so the easiest way to make the Macbook Pro monitor at the right channel in 2.4 GHz band may be to simply disable the 5 GHz band on the AP.</p></div>
            <div class="comment-info" id="comment-52125-info">
                
                
                
                

                

                <span class="comment-age">(01 May '16, 12:00)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-52107" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 7
        </span>
        <a href="#" class="show-all-comments-link">show 2 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-52107-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/52027/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='0S0r9NAZgTKp08lOjypIsUU1UjPcQj7v' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/52027/capturing-traffic-from-wireless-cctv?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/52027/capturing-traffic-from-wireless-cctv?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/wireless/"
            class="tag-link-wireless"
            title="see questions tagged'wireless'using tags"
            rel="tag">wireless</a> <span class="tag-number">&#215;139</span><br/>
        
        <a href="/tags/cctv/"
            class="tag-link-cctv"
            title="see questions tagged'cctv'using tags"
            rel="tag">cctv</a> <span class="tag-number">&#215;2</span><br/>
        
    </p>
    <p>
        question asked: <strong title="April 27, 2016, 3:46 p.m.">27 Apr '16, 15:46</strong>
    </p>
    <p> 
     	question was seen: <strong>7,518 times</strong>
    </p>
    <p> 
        last updated: <strong title="May 1, 2016, noon">01 May '16, 12:00</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/501/wireshark-not-detecting-wireless-card">Wireshark not detecting wireless card</a>
        </p>
        
        <p>
            <a href="/questions/3492/rallink-80211n-wireless-lan-card">Rallink 802.11n wireless LAN card</a>
        </p>
        
        <p>
            <a href="/questions/9022/can-wireshark-monitor-wifi">Can Wireshark monitor wifi?</a>
        </p>
        
        <p>
            <a href="/questions/12635/i-just-installed-wireshark-on-win7-on-a-thinkpad-why-is-the-wireless-interface-not-listed">I just installed Wireshark on Win7 on a Thinkpad.  Why is the wireless interface not listed?</a>
        </p>
        
        <p>
            <a href="/questions/22022/decrypt-80211-data-inside-peekremote-capture">Decrypt 802.11 data inside peekremote capture</a>
        </p>
        
        <p>
            <a href="/questions/29903/is-it-possible-in-wireshark-and-t-shark-to-capture-only-data-frame-in-monitor-mode-for-wireless-network">Is it possible in wireshark and t-shark to capture only data frame ( in monitor mode) for WIRELESS network?</a>
        </p>
        
        <p>
            <a href="/questions/36433/lost-packets-between-portable-computer-and-scanner-wired-and-wireless">Lost packets between portable computer and scanner, wired and wireless.</a>
        </p>
        
        <p>
            <a href="/questions/44296/sniff-packets-for-wireless-thermostat">Sniff packets for wireless thermostat</a>
        </p>
        
        <p>
            <a href="/questions/60000/trouble-on-decrypting-captured-80211-packets">Trouble on decrypting captured 802.11 packets</a>
        </p>
        
        <p>
            <a href="/questions/654/download-from-mac-on-wireless-decreases-until-it-stops">Download from mac on wireless decreases until it stops.</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
