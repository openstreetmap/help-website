<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Seeing unicast traffic on a switchport without spanning - Wireshark Q&amp;A</title>
        <meta name="description" content="I ran a packet capture on a client computer connected to a non-spanned switch port. I expected to see only broadcasts and multicast traffic. What I did get was multicast, broadcast AND - some unicast traffic to/from clients other than my capture client host. Why would I be seeing unicast traffic lik..." />
        <meta name="keywords" content="unicast,broadcast,switch,multicast,tshark" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/268/seeing-unicast-traffic-on-a-switchport-without-spanning" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/268/seeing-unicast-traffic-on-a-switchport-without-spanning?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='X6Dd9tAxzDQOKJBfJH9aA7NZuQOYHs7l' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/268/seeing-unicast-traffic-on-a-switchport-without-spanning">Seeing unicast traffic on a switchport without spanning</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-268-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/268/up/" rel="nofollow"> </a>
<div id="post-268-score" class="post-score"
    title="current number of votes">
    3
</div>
<a id="post-268-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/268/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/268/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>I ran a packet capture on a client computer connected to a non-spanned switch port. I expected to see only broadcasts and multicast traffic. What I did get was multicast, broadcast AND - some unicast traffic to/from clients other than my capture client host. Why would I be seeing unicast traffic like this on a switched client?</p>
<p>The capture host is running tshark 0.99.4 on Linux 2.4.27-3-686.</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/unicast/" class="post-tag tag-link-unicast"
                                        title="see questions tagged 'unicast'" rel="tag">unicast</a>
                                
                                    <a href="/tags/broadcast/" class="post-tag tag-link-broadcast"
                                        title="see questions tagged 'broadcast'" rel="tag">broadcast</a>
                                
                                    <a href="/tags/switch/" class="post-tag tag-link-switch"
                                        title="see questions tagged 'switch'" rel="tag">switch</a>
                                
                                    <a href="/tags/multicast/" class="post-tag tag-link-multicast"
                                        title="see questions tagged 'multicast'" rel="tag">multicast</a>
                                
                                    <a href="/tags/tshark/" class="post-tag tag-link-tshark"
                                        title="see questions tagged 'tshark'" rel="tag">tshark</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>22 Sep '10, 12:15</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d1f7fabf169915dc5ba93025794b84db?s=32&amp;d=identicon&amp;r=g" alt="Labnuke's gravatar image" />
    <p><a href="/users/126/labnuke">Labnuke</a><br/>
    <span class="score" title="61 reputation points">61</span><span title="4 badges"><span class="badge1">&#9679;</span><span class="badgecount">4</span></span><span title="4 badges"><span class="silver">&#9679;</span><span class="badgecount">4</span></span><span title="9 badges"><span class="bronze">&#9679;</span><span class="badgecount">9</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Labnuke has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/268/">
                edited
                <strong>22 Sep '10, 14:22</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7901a94d8fdd1f9f47cda9a32fcfa177?s=32&amp;d=identicon&amp;r=g" alt="SYN-bit's gravatar image" />
            <p><a href="/users/5/syn-bit">SYN-bit ♦♦</a><br/>
            <span class="score" title="17094 reputation points"><span class="">17.1k</span></span><span title="9 badges"><span class="badge1">&#9679;</span><span class="badgecount">9</span></span><span title="57 badges"><span class="silver">&#9679;</span><span class="badgecount">57</span></span><span title="245 badges"><span class="bronze">&#9679;</span><span class="badgecount">245</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-268">
    
        <a name="276"></a>
        <div class="comment" id="comment-276">
            <div id="post-276-score" class="comment-score"></div>
            <div class="comment-text"><p>Labnuke, I updated the title of your question to make it more general and easier for people to find. Hope you don't mind :-)</p></div>
            <div class="comment-info" id="comment-276-info">
                
                
                
                

                

                <span class="comment-age">(22 Sep '10, 14:22)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="313"></a>
        <div class="comment" id="comment-313">
            <div id="post-313-score" class="comment-score"></div>
            <div class="comment-text"><p>No worries - I struggled with how to set the subject to begin with.</p></div>
            <div class="comment-info" id="comment-313-info">
                
                
                
                

                

                <span class="comment-age">(24 Sep '10, 08:24)</span>
                <a class="comment-user userinfo" href="/users/126/labnuke">Labnuke</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-268" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-268-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    5 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/268/seeing-unicast-traffic-on-a-switchport-without-spanning?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/268/seeing-unicast-traffic-on-a-switchport-without-spanning?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/268/seeing-unicast-traffic-on-a-switchport-without-spanning?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/268/seeing-unicast-traffic-on-a-switchport-without-spanning?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="274"></a>
                    <div id="answer-container-274" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-274-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/274/up/" rel="nofollow"> </a>
<div id="post-274-score" class="post-score"
    title="current number of votes">
    6
</div>
<a id="post-274-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/274/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Apart from the cases already mentioned by Laura, there are actually a few situations in which this is "works as designed" (so much for general network "design"):</p>
<ul>
<li>
<p><em>Asymetric routing in a redundant environment:</em> If the traffic to a host passes one switch while the traffic from the host back doesn't pass the switch AND the arp timer of the upstream router is higher than the aging timer on the switch, then the switch mentioned will lose the mac-address of the host and will start flooding traffic for this host. If this is the case, you might want to adjust your timers.</p>
</li>
<li>
<p><em>Microsoft Network Loadbalancing:</em> To make every member of the cluster receive all requests (so that the designated server can answer the request while the other hosts will ignore it), Microsoft deliberately makes the switch flood all incoming traffic. This is done by not sending any traffic from the virtual mac-address. Hence the switch does not know where to send it and it will flood it across the vlan. That's why you don't want to put any other servers in a vlan that is used for Microsoft Network Loadbalanced Clusters.</p>
</li>
<li>
<p><em>Full mac-address-table:</em> When you have one flat network and many many hosts, the switch's forwarding table might be filled. This means it starts to flood for those addresses that did not make it into the forwarding table. If this is the case, start segmenting your network into smaller parts.</p>
</li>
</ul>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/274/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>22 Sep '10, 14:20</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7901a94d8fdd1f9f47cda9a32fcfa177?s=32&amp;d=identicon&amp;r=g" alt="SYN-bit's gravatar image" />
    <p><a href="/users/5/syn-bit">SYN-bit ♦♦</a><br/>
    <span class="score" title="17094 reputation points"><span class="">17.1k</span></span><span title="9 badges"><span class="badge1">&#9679;</span><span class="badgecount">9</span></span><span title="57 badges"><span class="silver">&#9679;</span><span class="badgecount">57</span></span><span title="245 badges"><span class="bronze">&#9679;</span><span class="badgecount">245</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="SYN-bit has 174 accepted answers">20&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-274">
    
        <a name="315"></a>
        <div class="comment" id="comment-315">
            <div id="post-315-score" class="comment-score"></div>
            <div class="comment-text"><p>The network is a /16 network but I don't think there are very many hosts on this LAN (&lt;500). So would full mac-address-table really be a potential cause in this case? </p>

<p>There is not a second router in this environment. Just a single router to outside networks.</p></div>
            <div class="comment-info" id="comment-315-info">
                
                
                
                

                

                <span class="comment-age">(24 Sep '10, 08:34)</span>
                <a class="comment-user userinfo" href="/users/126/labnuke">Labnuke</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-274" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-274-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="358"></a>
                    <div id="answer-container-358" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-358-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/358/up/" rel="nofollow"> </a>
<div id="post-358-score" class="post-score"
    title="current number of votes">
    3
</div>
<a id="post-358-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/358/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>I see this when Cisco Switch ages out a MAC address (mac aging time - default 5 minutes) but the device forwarding the traffic (usually UDP traffic) has a 4 hour ARP aging time.</p>
<p>Try pinging the ip address of the traffic from the work station and see if it disappears. The PING will cause an ARP and the arp response will place the MAC back in all the switch tables.</p>
<p>Are the addresses all the same subnet? We recently cleaned up a network where multiple subnets were active in the same VLAN!!!</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/358/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>29 Sep '10, 12:33</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d5aa09edfeeb0600f74a72e63806f227?s=32&amp;d=identicon&amp;r=g" alt="erics's gravatar image" />
    <p><a href="/users/167/erics">erics</a><br/>
    <span class="score" title="46 reputation points">46</span><span title="2 badges"><span class="bronze">&#9679;</span><span class="badgecount">2</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="erics has no accepted answers">0&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-358">
    
        <a name="1934"></a>
        <div class="comment" id="comment-1934">
            <div id="post-1934-score" class="comment-score"></div>
            <div class="comment-text"><p>+1 for erics. We had a similar issue (not really a problem) with seeing traffic we weren't supposed to see on a host. We pinged the ip addresses of the traffic from the work station and sure enough, they went away. The ARP timeouts on the different devices were set to 5000 and 300. I'm gonna try and remember this nifty troubleshooting tip. Thanks.</p></div>
            <div class="comment-info" id="comment-1934-info">
                
                
                
                

                

                <span class="comment-age">(25 Jan '11, 14:57)</span>
                <a class="comment-user userinfo" href="/users/608/robertm">RobertM</a>
                
            </div>
        </div>
    
        <a name="21960"></a>
        <div class="comment" id="comment-21960">
            <div id="post-21960-score" class="comment-score"></div>
            <div class="comment-text"><p>We just had exactly the same problem on our Cisco core - massive amount of UDP packets being broadcast out to all switch ports, strange thing was that there was an entry in the ARP cache for the destination IP, pinging the detination IP from the core solved the issue, I guess we need to look at our ARP aging times as well!</p>

<p>Cheers erics!</p></div>
            <div class="comment-info" id="comment-21960-info">
                
                
                
                

                

                <span class="comment-age">(12 Jun '13, 06:55)</span>
                <a class="comment-user userinfo" href="/users/5098/gaz-jones">Gaz Jones</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-358" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-358-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="359"></a>
                    <div id="answer-container-359" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-359-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/359/up/" rel="nofollow"> </a>
<div id="post-359-score" class="post-score"
    title="current number of votes">
    3
</div>
<a id="post-359-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/359/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>As already pointed out ARP Cache timeout is the likely culprit.  We see this a lot on networks where you have a switch pair connected to each other and each having uplinks to a router pair but they DO NOT have cross connects (an X, a bowtie, etc) between the switches and routers - kind of a horseshoe.  Your device is on switch A, which is directly connected to router A.  All outbound traffic will go that route, but the return traffic will possibly hit router B, which has no ARP entries for your workstation but does have an interface within the proper subnet/VLAN.  So it forwards it out of that interface to Switch B which also has no ARP entry and blasts it to every port - including the cross connect, which is how the packets make it to your interface.  We have argued with Cisco and Juniper about this being the result of their "best practices".  You might want to keep an eye on that crosslink's utilization.  There are a few remedies for this but all are dependent on your environment.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/359/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>29 Sep '10, 12:58</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/9e493496d59bb4ce33c37cd6e7a26a4d?s=32&amp;d=identicon&amp;r=g" alt="GeonJay's gravatar image" />
    <p><a href="/users/67/geonjay">GeonJay</a><br/>
    <span class="score" title="470 reputation points">470</span><span title="5 badges"><span class="badge1">&#9679;</span><span class="badgecount">5</span></span><span title="9 badges"><span class="silver">&#9679;</span><span class="badgecount">9</span></span><span title="22 badges"><span class="bronze">&#9679;</span><span class="badgecount">22</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="GeonJay has 2 accepted answers">5&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-359">
    
</div>
<div id="comment-tools-359" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-359-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="272"></a>
                    <div id="answer-container-272" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-272-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/272/up/" rel="nofollow"> </a>
<div id="post-272-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-272-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/272/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Ohh... ouch! That is not a great situation.  Here are some possible reasons... (and you might want to update your Tshark version...) </p>
<ol>
<li>The traffic was addressed to unknown MAC addresses so the switch forwarded the packets down all ports in hopes of finding that MAC address on one of them.</li>
<li>Your switch has a problem - it is acting like a hub either for some ports or all ports (not a good sign at all). </li>
<li>Someone set up port spanning on that port and left it running. </li>
</ol>
<p>Make sure you look at the MAC address of those "unicast" packets you are seeing as the switch is forwarding based on that address, not the IP address. Maybe the MAC destination has the multicast or broadcast bit set for some freaky reason. </p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/272/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>22 Sep '10, 13:45</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/9b4bb3984350b45aee3eda5cc1c90d36?s=32&amp;d=identicon&amp;r=g" alt="lchappell's gravatar image" />
    <p><a href="/users/7/lchappell">lchappell ♦</a><br/>
    <span class="score" title="1206 reputation points"><span class="">1.2k</span></span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="7 badges"><span class="silver">&#9679;</span><span class="badgecount">7</span></span><span title="30 badges"><span class="bronze">&#9679;</span><span class="badgecount">30</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="lchappell has 6 accepted answers">8&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-272">
    
        <a name="314"></a>
        <div class="comment" id="comment-314">
            <div id="post-314-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks for the feedback. This is a Nortel BayStack 470 switch. I will confirm the mac addresses in the packet and ses what they show. I know that there is no port spanning setup so that would not be the cause of this. </p></div>
            <div class="comment-info" id="comment-314-info">
                
                
                
                

                

                <span class="comment-age">(24 Sep '10, 08:24)</span>
                <a class="comment-user userinfo" href="/users/126/labnuke">Labnuke</a>
                
            </div>
        </div>
    
        <a name="317"></a>
        <div class="comment" id="comment-317">
            <div id="post-317-score" class="comment-score"></div>
            <div class="comment-text"><p>Are you referring to the IG bit on the destination MAC? If so, that is set to 0. </p>

<p>Based on what I see today on a capture on this host that your #1 suggestion is the correct one. That for some reason, the clients have an old address cached in ARP and the switch does not know where the device is so floods all ports with that traffic.</p></div>
            <div class="comment-info" id="comment-317-info">
                
                
                
                

                

                <span class="comment-age">(24 Sep '10, 10:55)</span>
                <a class="comment-user userinfo" href="/users/126/labnuke">Labnuke</a>
                
            </div>
        </div>
    
        <a name="318"></a>
        <div class="comment" id="comment-318">
            <div id="post-318-score" class="comment-score"></div>
            <div class="comment-text"><p>So, this then leads to the question about how often does a client on the same LAN do an ARP before communicating? I'm sure it depends on OS version and how often ARP entries timeout. But what if the traffic is coming from an external network? When will the router or layer 3 device do an ARP?</p></div>
            <div class="comment-info" id="comment-318-info">
                
                
                
                

                

                <span class="comment-age">(24 Sep '10, 10:58)</span>
                <a class="comment-user userinfo" href="/users/126/labnuke">Labnuke</a>
                
            </div>
        </div>
    
        <a name="319"></a>
        <div class="comment" id="comment-319">
            <div id="post-319-score" class="comment-score">1</div>
            <div class="comment-text"><p>Local routers/layer 3 devices will ARP when their ARP cache times out and - yup - you're right - it depends on the OS. As a reminder to readers - ARP packets are non-routable because they have no IP header so any ARP traffic you see is local only.</p></div>
            <div class="comment-info" id="comment-319-info">
                
                
                
                

                

                <span class="comment-age">(24 Sep '10, 12:11)</span>
                <a class="comment-user userinfo" href="/users/7/lchappell">lchappell ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-272" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-272-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="326"></a>
                    <div id="answer-container-326" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-326-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/326/up/" rel="nofollow"> </a>
<div id="post-326-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-326-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/326/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>I have seen this happen a couple of times to, so here's my 2 additional cents ;-)</p>
<ul>
<li>
<p>Switches keep refreshing their MAC address tables and relearning MAC addresses, so I got used to getting one unicast packet every once in a while of a station that I didn't span, but usually you won't see a second because the switch had already learned the port where the MAC resides from the answer packet and will direct the next packets only to that port. No worries here.</p>
</li>
<li>
<p>The second (and unfortunately not completely uncommon) reason for this behavior could be a misconfiguration of a load balancing setup. I have encountered several customer networks where servers had network cards teamed together for fail over/load balancing (which is okay so far), but then they forgot to tell the switches about it, too. I had one case where a switch constantly tried to reach the second MAC but the server always and exclusively replied with the first MAC. That way the switch could never learn the port of the second MAC and kept flooding, until by a random chance the server decided to send a packet with the second MAC.</p>
</li>
</ul>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/326/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>25 Sep '10, 15:23</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" alt="Jasper's gravatar image" />
    <p><a href="/users/145/jasper">Jasper ♦♦</a><br/>
    <span class="score" title="23806 reputation points"><span class="">23.8k</span></span><span title="5 badges"><span class="badge1">&#9679;</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">&#9679;</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">&#9679;</span><span class="badgecount">284</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Jasper has 263 accepted answers">18&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-326">
    
</div>
<div id="comment-tools-326" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-326-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/268/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='X6Dd9tAxzDQOKJBfJH9aA7NZuQOYHs7l' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/268/seeing-unicast-traffic-on-a-switchport-without-spanning?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/268/seeing-unicast-traffic-on-a-switchport-without-spanning?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/tshark/"
            class="tag-link-tshark"
            title="see questions tagged'tshark'using tags"
            rel="tag">tshark</a> <span class="tag-number">&#215;832</span><br/>
        
        <a href="/tags/switch/"
            class="tag-link-switch"
            title="see questions tagged'switch'using tags"
            rel="tag">switch</a> <span class="tag-number">&#215;32</span><br/>
        
        <a href="/tags/broadcast/"
            class="tag-link-broadcast"
            title="see questions tagged'broadcast'using tags"
            rel="tag">broadcast</a> <span class="tag-number">&#215;31</span><br/>
        
        <a href="/tags/multicast/"
            class="tag-link-multicast"
            title="see questions tagged'multicast'using tags"
            rel="tag">multicast</a> <span class="tag-number">&#215;27</span><br/>
        
        <a href="/tags/unicast/"
            class="tag-link-unicast"
            title="see questions tagged'unicast'using tags"
            rel="tag">unicast</a> <span class="tag-number">&#215;9</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Sept. 22, 2010, 12:15 p.m.">22 Sep '10, 12:15</strong>
    </p>
    <p> 
     	question was seen: <strong>21,939 times</strong>
    </p>
    <p> 
        last updated: <strong title="June 12, 2013, 6:55 a.m.">12 Jun '13, 06:55</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/30985/help-setting-up-wireshark-to-capture-this-problem">Help setting up wireshark to capture this problem</a>
        </p>
        
        <p>
            <a href="/questions/7023/cdp-packets-dont-show-up-on-laptop">cdp packets don&#39;t show up on laptop</a>
        </p>
        
        <p>
            <a href="/questions/7277/arp-broadcast">ARP Broadcast</a>
        </p>
        
        <p>
            <a href="/questions/43228/tshark-multicast-statistics">tshark multicast statistics</a>
        </p>
        
        <p>
            <a href="/questions/62/static-tshark-builds-for-linux-andor-solaris-sparcx64">static tshark builds for linux and/or solaris sparc/x64</a>
        </p>
        
        <p>
            <a href="/questions/1962/high-nfs-read-latency-from-sles10-client-to-emc-clarion-filer">High NFS READ latency from SLES10 client to EMC Clarion filer</a>
        </p>
        
        <p>
            <a href="/questions/3490/tshark-plugin-for-tunelled-ethernet-payload">tshark plugin for tunelled ethernet payload</a>
        </p>
        
        <p>
            <a href="/questions/5241/tshark-display-filter-in-windows-command-line-seems-not-support-special-characters">tshark display filter in windows command-line seems not support special characters</a>
        </p>
        
        <p>
            <a href="/questions/6543/how-to-get-number-of-packets-displayed-via-tshark">how to get number of packets displayed via tshark?</a>
        </p>
        
        <p>
            <a href="/questions/8518/collect-expertmessage-from-tshark">Collect expert.message from tshark</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
