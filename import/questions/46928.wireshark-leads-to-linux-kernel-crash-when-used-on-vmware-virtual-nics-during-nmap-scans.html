<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Wireshark leads to linux kernel crash when used on Vmware virtual NICs during nmap scans - Wireshark Q&amp;A</title>
        <meta name="description" content="I have a weird problem. I work with local penetration test environments on 2 different Opensuse 13.2 hosts. One laptop; one a desktop PC. Kernel version in both cases:3.16. VMware Workstation 11 is installed. Several Win XP and Win 7 guests can be started in the VMware environment. A host-only netwo..." />
        <meta name="keywords" content="nmap,kernel,crash,vmware,wireshark" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/46928/wireshark-leads-to-linux-kernel-crash-when-used-on-vmware-virtual-nics-during-nmap-scans" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/46928/wireshark-leads-to-linux-kernel-crash-when-used-on-vmware-virtual-nics-during-nmap-scans?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='lIzO4ncmarFBmgcv6qSLo2XlZUnk9yLm' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/46928/wireshark-leads-to-linux-kernel-crash-when-used-on-vmware-virtual-nics-during-nmap-scans">Wireshark leads to linux kernel crash when used on Vmware virtual NICs during nmap scans</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-46928-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/46928/up/" rel="nofollow"> </a>
<div id="post-46928-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-46928-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/46928/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/46928/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>I have a weird problem. I work with local penetration test environments on 2 different Opensuse 13.2 hosts. One laptop; one a desktop PC. Kernel version in both cases:3.16. VMware Workstation 11 is installed.  Several Win XP and Win 7 guests can be started in the VMware environment. A host-only network is used for the VMware guests; the VMmware host only bridge got a virtual host NIC (vmnet3) assigned, too. (An additional VMware bridge to the physical device of the host is installed, too, but not actively used by the guests). In addition KVM with separate virtual networks/bridges and Linux guests is used on the very same host. The whole setup normally works totally stable and without any problems. Routing between the networks works flawlessly. The virtual bridges are in several test scenarios controlled by ebtables/iptables rules. However, the following problem is independent of whether netfilter is active or not.<br>
</p>
<p>To watch network packets passing the host NIC vmnet3 on their way to VMware guests I tried to use Wireshark or Tshark. This works - at least for normal traffic; vmnet3 is switched to promiscuous mode as expected. I can e.g. follow packets coming from KVM guests which are routed via the host to the VMware guest.<br>
</p>
<p>However, as soon as I start in addition a <strong>nmap scan</strong> <strong>on the Linux host</strong> directed against one of the VMware guests the whole Linux host system freezes. journalctl afterwards shows:</p>
<p>kernel: BUG: unable to handle kernel NULL pointer dereference at        (null) </p>
<p>The host has to be restarted physically resetting/rebooting the machine. Which is a mess as all virtual machines get affected by the crash. </p>
<p>This bug is reproducible. It seems to be independent of different nmap scan types (I have not yet tested all.) It is independent of the VMmware guest type. It is independent of the hardware (laptop, desktop). It is independent of netfilter being active or not. </p>
<p>A similar effect does not occur if a scan is performed for KVM guests connected to KVm/qemu virtual networks/bridges. It only happens for VMware vmnet-host-devices. The combination of wireshark/tshark on virtual VMware host NICs plus the start of nmap against guests seems to lead to a kernel bug.<br>
</p>
<p>The bug does not occur if nmap scans are started from KVM linux guests against the vmware guests - i.e. not for routed packets. The bug occurs for nmap scans started on the host itself. <br>
</p>
<p>I should add that <strong>tcpdump</strong> in contrast to Wireshark/Tshark works flawlessly on the virtual VMware NIC (vmnet3). No problems for whatever nmap scan type executed. </p>
<p>So, this all leads me to the question whether there is a severe problem of Wireshark with virtual vmware NICs and certain ethernet packet created by nmap. </p>
<p>Any ideas? </p>
<p>Regards 
Ralph </p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/nmap/" class="post-tag tag-link-nmap"
                                        title="see questions tagged 'nmap'" rel="tag">nmap</a>
                                
                                    <a href="/tags/kernel/" class="post-tag tag-link-kernel"
                                        title="see questions tagged 'kernel'" rel="tag">kernel</a>
                                
                                    <a href="/tags/crash/" class="post-tag tag-link-crash"
                                        title="see questions tagged 'crash'" rel="tag">crash</a>
                                
                                    <a href="/tags/vmware/" class="post-tag tag-link-vmware"
                                        title="see questions tagged 'vmware'" rel="tag">vmware</a>
                                
                                    <a href="/tags/wireshark/" class="post-tag tag-link-wireshark"
                                        title="see questions tagged 'wireshark'" rel="tag">wireshark</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>26 Oct '15, 04:57</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/e6a32feea9c62a5a5e2013878da7a2bc?s=32&amp;d=identicon&amp;r=g" alt="moench's gravatar image" />
    <p><a href="/users/20514/moench">moench</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">&#9679;</span><span class="badgecount">3</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="moench has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-46928">
    
</div>
<div id="comment-tools-46928" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-46928-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/46928/wireshark-leads-to-linux-kernel-crash-when-used-on-vmware-virtual-nics-during-nmap-scans?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/46928/wireshark-leads-to-linux-kernel-crash-when-used-on-vmware-virtual-nics-during-nmap-scans?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/46928/wireshark-leads-to-linux-kernel-crash-when-used-on-vmware-virtual-nics-during-nmap-scans?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/46928/wireshark-leads-to-linux-kernel-crash-when-used-on-vmware-virtual-nics-during-nmap-scans?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="46929"></a>
                    <div id="answer-container-46929" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-46929-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/46929/up/" rel="nofollow"> </a>
<div id="post-46929-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-46929-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/46929/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <blockquote>
<p>So, this all leads me to the question whether there is a severe problem of 
Wireshark with virtual vmware NICs and certain ethernet packet created by nmap.</p>
</blockquote>
<p>If you create a lot of new sessions very fast (nmap port scan), the dissection engine of Wireshark/tshark has to build internal hash table entries to keep track, so this sounds like a simple CPU overload situation. Why do you use Wireshark/tshark to do the <strong>capturing</strong>? Both are diagnosis/analysis tools, <strong>not</strong> capturing tools (although both can do that), which means in high load situations it's not a very good idea to do the capturing with Wireshark, as it's doing the analysis in parallel!</p>
<p>Please try to use <strong>dumpcap</strong> or <strong>tcpdump</strong> to capture the traffic and later use <strong>Wireshark/tshark</strong> to do the analysis!</p>
<p>Regards <br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/46929/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>26 Oct '15, 05:12</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/46929/">
                edited
                <strong>26 Oct '15, 05:14</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-46929">
    
        <a name="46931"></a>
        <div class="comment" id="comment-46931">
            <div id="post-46931-score" class="comment-score"></div>
            <div class="comment-text"><p>As already written I use tcpdump also - in this case I had/have to because of the failure of tshark/wireshark. </p>

<p>Nevertheless, I thought a bit about your answer. I accept the point being made about wireshark doing several things in parallel  - but after some quick tests on the laptop I am not at all sure whether a CPU overload really explains the occurrence of the kernel bug. </p>

<p>Actually, the measured CPU load on even tiny time intervals is pretty small for just one VMware guest without any running special SW. Furthermore 8 CPU threads are available - and the VMware processes are assigned to only 4. But Ok, the low average CPU load on a 20 ms scale does not exclude a spike on  smaller time scales.   <br>
</p>

<p>But: 
Also simple nmap scans with only some created packets lead to the crash. Furthermore, you can parametrize the time scale for the packet creation of nmap. This does not seem to change anything. The crash seems to happen just a tiny bit later - but this is at best  a marginal effect.  <br>
</p>

<p>In addition I would expect something similar for virtual qemu/KVM host NICs if wireshark/tshark's  interaction with virtual NIC devices really lead to CPU load problems. However, with KVM/qemu virtual NICs nothing happens - smooth error free capturing operation of wireshark/tshark.</p>

<p>So, I really don't know ...</p></div>
            <div class="comment-info" id="comment-46931-info">
                
                
                
                

                

                <span class="comment-age">(26 Oct '15, 05:45)</span>
                <a class="comment-user userinfo" href="/users/20514/moench">moench</a>
                
            </div>
        </div>
    
        <a name="46932"></a>
        <div class="comment" id="comment-46932">
            <div id="post-46932-score" class="comment-score"></div>
            <div class="comment-text"><p>O.K. maybe there is a bug, but then I would wonder why a non-privileged process (Wireshark) is able to create a <strong>kernel crash</strong> (although in your question <strong>you mention just a freeze</strong> - 'whole Linux host system freezes'). Wireshark uses the same libpcap as tcpdump, so while there can be a bug in libpcap, triggered only by Wireshark, I think it's rather unlikely, but you never know... </p>

<p>Anyway: Can you please use <strong>dumpcap</strong> (actually beeing used by Wireshark/tshark to do the capturing) on that system. I would love to see if you experience a freeze as well.</p></div>
            <div class="comment-info" id="comment-46932-info">
                
                
                
                

                

                <span class="comment-age">(26 Oct '15, 06:35)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="46937"></a>
        <div class="comment" id="comment-46937">
            <div id="post-46937-score" class="comment-score"></div>
            <div class="comment-text"><p>Actually I "tested" too quickly on the laptop - and I must correct myself and the last comment. Sorry, for the misinformation ...<br>
</p>

<p>The "freeze" occurs also for pure KVM/qemu virtual host NICs (not bridged to a physical device). So, the problem occurs for both VMware AND KVM virtual NICs. I checked this also on the desktop machine</p>

<p>With the expression "kernel crash" I referred to the kernel bug message in the log journal of systemd: </p>

<p>kernel: BUG: unable to handle kernel NULL pointer dereference at (null)</p>

<p>which always appears as the last message directly before the "freeze". </p>

<p>Regarding  <strong>dumpcap</strong>: I tested again - now for a KVM/qemu  virtual host interface - result: freeze, with the same kernel related bug message in the systemd journal. <br>
</p>

<p>Regarding <strong>tcpdump</strong>: Works! No problems.</p></div>
            <div class="comment-info" id="comment-46937-info">
                
                
                
                

                

                <span class="comment-age">(26 Oct '15, 07:35)</span>
                <a class="comment-user userinfo" href="/users/20514/moench">moench</a>
                
            </div>
        </div>
    
        <a name="46939"></a>
        <div class="comment" id="comment-46939">
            <div id="post-46939-score" class="comment-score"></div>
            <div class="comment-text"><p>O.K. then it could be a bug in dumpcap. What is your wireshark/dumpcap verson (-v will tell!)?</p></div>
            <div class="comment-info" id="comment-46939-info">
                
                
                
                

                

                <span class="comment-age">(26 Oct '15, 07:57)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="46941"></a>
        <div class="comment not_top_scorer" id="comment-46941">
            <div id="post-46941-score" class="comment-score"></div>
            <div class="comment-text"><p>Thank you for the quick reaction !</p>

<p>dumpcap -v
Dumpcap 1.12.8 </p>

<p>...</p>

<p>Compiled (64-bit) with GLib 2.42.0, with libpcap, with libz 1.2.8, with POSIX
capabilities (Linux), with libnl 3.</p>

<p>Running on Linux 3.16.7-24-desktop, with locale POSIX, with libpcap version
1.6.2, with libz 1.2.8.
Intel(R) Core(TM) i7 CPU         950  @ 3.07GHz</p>

<p>Built using gcc 4.8.3 20140627 [gcc-4_8-branch revision 212064].</p>

<p></p><hr>
<p>tshark -v
TShark 1.12.8 
.....
Compiled (64-bit) with GLib 2.42.0, with libpcap, with libz 1.2.8, with POSIX
capabilities (Linux), with libnl 3, with SMI 0.4.8, with c-ares 1.10.0, with Lua
5.2, without Python, with GnuTLS 3.2.18, with Gcrypt 1.6.1, with MIT Kerberos,
with GeoIP.</p>
<p>Running on Linux 3.16.7-24-desktop, with locale POSIX, with libpcap version
1.6.2, with libz 1.2.8.
Intel(R) Core(TM) i7 CPU         950  @ 3.07GHz</p>
<p>Built using gcc 4.8.3 20140627 [gcc-4_8-branch revision 212064].</p><p></p></div>
            <div class="comment-info" id="comment-46941-info">
                
                
                
                

                

                <span class="comment-age">(26 Oct '15, 08:08)</span>
                <a class="comment-user userinfo" href="/users/20514/moench">moench</a>
                
            </div>
        </div>
    
        <a name="46944"></a>
        <div class="comment not_top_scorer" id="comment-46944">
            <div id="post-46944-score" class="comment-score"></div>
            <div class="comment-text"><p>1.12.8. Hm.. please open a bug report at <a href="https://bugs.wireshark.org">https://bugs.wireshark.org</a> . Add as much information as possible and a link to this question.</p></div>
            <div class="comment-info" id="comment-46944-info">
                
                
                
                

                

                <span class="comment-age">(26 Oct '15, 09:47)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="46956"></a>
        <div class="comment" id="comment-46956">
            <div id="post-46956-score" class="comment-score">1</div>
            <div class="comment-text"><p>Or, even better, <a href="https://en.opensuse.org/openSUSE:Submitting_bug_reports">please open a bug report with the OpenSUSE maintainers</a>, as a kernel crash is a kernel bug, not a bug of whatever program happens to trigger the kernel bug.</p></div>
            <div class="comment-info" id="comment-46956-info">
                
                
                
                

                

                <span class="comment-age">(26 Oct '15, 13:26)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="46958"></a>
        <div class="comment not_top_scorer" id="comment-46958">
            <div id="post-46958-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>Also simple nmap scans with only some created packets lead to the crash<a href="https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=e0ee9c12157dc74e49e4731e0d07512e7d1ceb95">.</a></p>
</blockquote>

<p>what are the nmap parameters?</p>

<p>BTW: What's the output of the following command on the system that 'crashed'?</p>

<blockquote>
<p>cat /proc/sys/net/core/bpf_jit_enable</p>
</blockquote>

<p>If it's 1, try to disable BPF JIT </p>

<blockquote>
<p>echo 0 &gt; /proc/sys/net/core/bpf_jit_enable</p>
</blockquote></div>
            <div class="comment-info" id="comment-46958-info">
                
                
                
                

                

                <span class="comment-age">(26 Oct '15, 14:34)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="46963"></a>
        <div class="comment not_top_scorer" id="comment-46963">
            <div id="post-46963-score" class="comment-score"></div>
            <div class="comment-text"><p>Examples for simple TCP nmap parameters: 
-sT -T2 -p135 -v<br>
or
-sS -T2 -p135</p>

<p>What I wanted to do is to run "zombie" scans like 
nmap -sI Zombie_IP:port -Pn -p- --packet-trace -v Target_IP 
which actually works when I use tcpdump for packet capturing. </p>

<p>Regarding <strong>bfp_jit</strong>: </p>

<p>cat /proc/sys/net/core/bpf_jit_enable gives me <strong>1</strong>, as soon as Wireshark/Tshark are started. Not before, not after. </p>

<p>However, setting it to "0" does not prevent the bug/freeze to occur. </p>

<p>I shall open a bug report tomorrow.</p></div>
            <div class="comment-info" id="comment-46963-info">
                
                
                
                

                

                <span class="comment-age">(26 Oct '15, 17:10)</span>
                <a class="comment-user userinfo" href="/users/20514/moench">moench</a>
                
            </div>
        </div>
    
        <a name="46964"></a>
        <div class="comment not_top_scorer" id="comment-46964">
            <div id="post-46964-score" class="comment-score"></div>
            <div class="comment-text"><p>What's the state of /proc/sys/net/core/bpf_jit_enable while you run tcpdump  (and dumpcap)?</p></div>
            <div class="comment-info" id="comment-46964-info">
                
                
                
                

                

                <span class="comment-age">(26 Oct '15, 17:17)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-46929" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 10
        </span>
        <a href="#" class="show-all-comments-link">show 5 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-46929-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/46928/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='lIzO4ncmarFBmgcv6qSLo2XlZUnk9yLm' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/46928/wireshark-leads-to-linux-kernel-crash-when-used-on-vmware-virtual-nics-during-nmap-scans?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/46928/wireshark-leads-to-linux-kernel-crash-when-used-on-vmware-virtual-nics-during-nmap-scans?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/wireshark/"
            class="tag-link-wireshark"
            title="see questions tagged'wireshark'using tags"
            rel="tag">wireshark</a> <span class="tag-number">&#215;1,620</span><br/>
        
        <a href="/tags/crash/"
            class="tag-link-crash"
            title="see questions tagged'crash'using tags"
            rel="tag">crash</a> <span class="tag-number">&#215;84</span><br/>
        
        <a href="/tags/vmware/"
            class="tag-link-vmware"
            title="see questions tagged'vmware'using tags"
            rel="tag">vmware</a> <span class="tag-number">&#215;23</span><br/>
        
        <a href="/tags/nmap/"
            class="tag-link-nmap"
            title="see questions tagged'nmap'using tags"
            rel="tag">nmap</a> <span class="tag-number">&#215;4</span><br/>
        
        <a href="/tags/kernel/"
            class="tag-link-kernel"
            title="see questions tagged'kernel'using tags"
            rel="tag">kernel</a> <span class="tag-number">&#215;2</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Oct. 26, 2015, 4:57 a.m.">26 Oct '15, 04:57</strong>
    </p>
    <p> 
     	question was seen: <strong>1,997 times</strong>
    </p>
    <p> 
        last updated: <strong title="Oct. 26, 2015, 5:17 p.m.">26 Oct '15, 17:17</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/51391/112x-plugin-installation-doesnt-work-with-2x-wireshark">1.12.x plugin installation doesn&#39;t work with 2.x Wireshark</a>
        </p>
        
        <p>
            <a href="/questions/53437/wireshark-204-crashes-on-windows-10-in-live-capture-analysis-using-remote-capture">Wireshark 2.0.4 Crashes on Windows 10 in Live Capture Analysis using remote capture</a>
        </p>
        
        <p>
            <a href="/questions/5087/wireshark-crash">Wireshark crash</a>
        </p>
        
        <p>
            <a href="/questions/37911/tcp-dump-cannot-understand-these-4-lines">TCP Dump, cannot understand these 4 lines?</a>
        </p>
        
        <p>
            <a href="/questions/3949/tcpdump-vs-wireshark-differences-packets-merged">tcpdump vs wireshark differences (packets merged?)</a>
        </p>
        
        <p>
            <a href="/questions/20816/wireshark-crashing">Wireshark crashing</a>
        </p>
        
        <p>
            <a href="/questions/28244/mac-os-109-mavericks-wireshark-always-crash-right-after-i-started-the-capture">Mac OS 10.9 Mavericks: Wireshark always crash right after I started the capture</a>
        </p>
        
        <p>
            <a href="/questions/36465/wireshark-crashing-on-os-x-when-trying-to-open-a-file-can-some-one-please-help-me-how-to-resolve-it">Wireshark crashing on OS X when trying to open a file? Can some one please help me how to resolve it?</a>
        </p>
        
        <p>
            <a href="/questions/38858/wireshark-crashes-when-using-g_free">Wireshark crashes when using g_free()</a>
        </p>
        
        <p>
            <a href="/questions/11170/wireshark-in-vmware-machines">Wireshark in VMWare Machines</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
