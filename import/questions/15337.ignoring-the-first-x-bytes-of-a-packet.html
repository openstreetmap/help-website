<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Ignoring the first X bytes of a packet - Wireshark Q&amp;A</title>
        <meta name="description" content="Hello, community. I&#39;m capturing packets where the first X bytes (a special header) are not covered by any dissector available. Therefore, the rest of the package is not dissected anymore. Is it possible to instruct Wireshark to ignore the first X bytes and proceed further? Or is the only feasible op..." />
        <meta name="keywords" content="ignore,bytes,mask" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/15337/ignoring-the-first-x-bytes-of-a-packet" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/15337/ignoring-the-first-x-bytes-of-a-packet?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='dFLgsLvmA4guICRI8OaLpURH1ZAphgSK' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/15337/ignoring-the-first-x-bytes-of-a-packet">Ignoring the first X bytes of a packet</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-15337-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/15337/up/" rel="nofollow"> </a>
<div id="post-15337-score" class="post-score"
    title="current number of votes">
    2
</div>
<a id="post-15337-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/15337/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/15337/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   1
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hello, community. I'm capturing packets where the first X bytes (a special header) are not covered by any dissector available. Therefore, the rest of the package is not dissected anymore. Is it possible to instruct Wireshark to ignore the first X bytes and proceed further? Or is the only feasible option to write an own dissector for the first part of the package - the first X bytes?</p>
<p>BR
Ewgenij</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/ignore/" class="post-tag tag-link-ignore"
                                        title="see questions tagged 'ignore'" rel="tag">ignore</a>
                                
                                    <a href="/tags/bytes/" class="post-tag tag-link-bytes"
                                        title="see questions tagged 'bytes'" rel="tag">bytes</a>
                                
                                    <a href="/tags/mask/" class="post-tag tag-link-mask"
                                        title="see questions tagged 'mask'" rel="tag">mask</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>29 Oct '12, 07:27</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/74ba4ba7a26d5efda01b6ae18bbe48e4?s=32&amp;d=identicon&amp;r=g" alt="Ewgenijkkg's gravatar image" />
    <p><a href="/users/3729/ewgenijkkg">Ewgenijkkg</a><br/>
    <span class="score" title="66 reputation points">66</span><span title="8 badges"><span class="badge1">&#9679;</span><span class="badgecount">8</span></span><span title="9 badges"><span class="silver">&#9679;</span><span class="badgecount">9</span></span><span title="15 badges"><span class="bronze">&#9679;</span><span class="badgecount">15</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Ewgenijkkg has 3 accepted answers">60&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/15337/">
                edited
                <strong>29 Oct '12, 15:05</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" alt="grahamb's gravatar image" />
            <p><a href="/users/1225/grahamb">grahamb ♦</a><br/>
            <span class="score" title="19834 reputation points"><span class="">19.8k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">&#9679;</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">&#9679;</span><span class="badgecount">206</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-15337">
    
        <a name="15345"></a>
        <div class="comment" id="comment-15345">
            <div id="post-15345-score" class="comment-score"></div>
            <div class="comment-text"><p>Capturing with Wireshark (or tcpdump or some other libpcap/WinPcap-based tool), or with some other special software (possibly piping to Wireshark/TShark over a named pipe, or possibly capturing to a file and having Wireshark read the file)?  If Wireshark's only reading the file, what format is it?  If it's a pcap or pcap-ng file, or a live capture, what's the link-layer header type?  Perhaps a new link-layer header type needs to be assigned to it.</p></div>
            <div class="comment-info" id="comment-15345-info">
                
                
                
                

                

                <span class="comment-age">(29 Oct '12, 14:22)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="15349"></a>
        <div class="comment" id="comment-15349">
            <div id="post-15349-score" class="comment-score"></div>
            <div class="comment-text"><p>Hello. The capture was performed with tcpdump. Wireshark reads the dump file then.</p>

<blockquote>
<p>If Wireshark's only reading the file, what format is it?</p>
</blockquote>

<p>It was captured with the -w option of tcpdump, thus I suppose its the pcap-savefile format.</p>

<blockquote>
<p>what's the link-layer header type</p>
</blockquote>

<p>The packets were captured on a wireless interface. The wireless communication is running over special wirelss modules of Cohda <a href="http://www.cohdawireless.com/">http://www.cohdawireless.com/</a> The Cohda headers are unknown to Wireshark, therefore no processing is possible. Thus, the idea was to remove these additional bytes from the capture file.</p>

<p>Regards
Ewgenij Sokolovski</p></div>
            <div class="comment-info" id="comment-15349-info">
                
                
                
                

                

                <span class="comment-age">(30 Oct '12, 01:20)</span>
                <a class="comment-user userinfo" href="/users/3729/ewgenijkkg">Ewgenijkkg</a>
                
            </div>
        </div>
    
        <a name="15360"></a>
        <div class="comment" id="comment-15360">
            <div id="post-15360-score" class="comment-score"></div>
            <div class="comment-text"><p>[I converted your comment from an Answer to a comment to keep things structured]</p>

<p>Can you provide a sample trace to take a look at? If that is not possible, how many bytes do you need to remove from the start of each packet?</p></div>
            <div class="comment-info" id="comment-15360-info">
                
                
                
                

                

                <span class="comment-age">(30 Oct '12, 03:48)</span>
                <a class="comment-user userinfo" href="/users/145/jasper">Jasper ♦♦</a>
                
            </div>
        </div>
    
        <a name="15369"></a>
        <div class="comment" id="comment-15369">
            <div id="post-15369-score" class="comment-score"></div>
            <div class="comment-text"><p>Hello, it's not a secret :) Here is the example</p>

<p>a1 b2 c3 d4 00 02 00 04 00 00 00 00 00 00 00 00 00 00 00 44 00 00 00 71 50 8a 5e 87 00 05 be e0 00 00 00 44 00 00 00 87 00 04 ff fe 00 06 00 00 00 00 00 00 00 00 00 00 ff ff ff ff ff ff 04 e5 48 01 d7 02 ff ff ff ff ff ff 00 00 00 00 aa aa 03 00 00 00 07 07</p>

<p>The last two bytes 07 07 are the protocal type and the 12 bytes before them are destination and source MAC addresses.</p></div>
            <div class="comment-info" id="comment-15369-info">
                
                
                
                

                

                <span class="comment-age">(30 Oct '12, 08:38)</span>
                <a class="comment-user userinfo" href="/users/3729/ewgenijkkg">Ewgenijkkg</a>
                
            </div>
        </div>
    
        <a name="15370"></a>
        <div class="comment" id="comment-15370">
            <div id="post-15370-score" class="comment-score"></div>
            <div class="comment-text"><p>The sequence </p>

<p>00 05 be e0 00 00 00 44 00 00 00 87 00 04 ff fe 00 06 00 00 00 00 00 00 00 00 00 00 ff ff ff ff ff ff 04 e5 48 01 d7 02 ff ff ff ff</p>

<p>is then the special Cohda stuff, which wireshark apparently can't deal with.</p>

<p>BR
Ewgenij</p>

<p>P.S. Isn't it possible to place more signs in one single comment? I got to split the text in two comments :(</p></div>
            <div class="comment-info" id="comment-15370-info">
                
                
                
                

                

                <span class="comment-age">(30 Oct '12, 08:40)</span>
                <a class="comment-user userinfo" href="/users/3729/ewgenijkkg">Ewgenijkkg</a>
                
            </div>
        </div>
    
        <a name="15376"></a>
        <div class="comment not_top_scorer" id="comment-15376">
            <div id="post-15376-score" class="comment-score"></div>
            <div class="comment-text"><p>Yeah, the length limitation of comments is a constant problem... no idea if the admins could increase the limit.</p>

<p>Can you upload the sample to <a href="http://www.cloudshark.org">www.cloudshark.org</a> and post the link? That would make it easier to look at things in a binary way. If I get this correctly from what you've posted the Destination MAC is ff:ff:00:00:00:00, the Source MAC is aa:aa:03:00:00:00, and the ether type 0x0707. Correct?</p>

<p>What is the stuff that comes before the Cohda stuff, starting with a1 b2 c3 ... up to 50 8a 5e 87?</p></div>
            <div class="comment-info" id="comment-15376-info">
                
                
                
                

                

                <span class="comment-age">(30 Oct '12, 09:33)</span>
                <a class="comment-user userinfo" href="/users/145/jasper">Jasper ♦♦</a>
                
            </div>
        </div>
    
        <a name="15397"></a>
        <div class="comment not_top_scorer" id="comment-15397">
            <div id="post-15397-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>The packets were captured on a wireless interface. </p>
</blockquote>

<p>Cohda offers a wireless board with a CAN bus and USB 2.0 host interface. So, how and where did you capture the data? </p>

<p>Is it an embedded linux running on the board itself or through a driver that offers some kind of (wireless) interface to a standard linux?</p></div>
            <div class="comment-info" id="comment-15397-info">
                
                
                
                

                

                <span class="comment-age">(30 Oct '12, 13:29)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-15337" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 7
        </span>
        <a href="#" class="show-all-comments-link">show 2 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-15337-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/15337/ignoring-the-first-x-bytes-of-a-packet?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/15337/ignoring-the-first-x-bytes-of-a-packet?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/15337/ignoring-the-first-x-bytes-of-a-packet?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/15337/ignoring-the-first-x-bytes-of-a-packet?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="15388"></a>
                    <div id="answer-container-15388" class="answer accepted-answer">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-15388-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/15388/up/" rel="nofollow"> </a>
<div id="post-15388-score" class="post-score"
    title="current number of votes">
    7
</div>
<a id="post-15388-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/15388/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="Ewgenijkkg has selected this answer as the correct answer"
        href="/accept_answer/15388/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Actually, no, the 12 bytes before 07 07 are <em>NOT</em> destination source and MAC addresses.  aa aa 03 is an IEEE 802.2 header with a DSAP and SSAP of aa, meaning SNAP (at this point my brain's wired to recognize aa aa 03 :-)); the 00 00 00 07 07 is a SNAP header with an OUI of 00 00 00, meaning "the protocol ID is an Ethernet type", and a protocol ID of 07 07, which <a href="http://standards.ieee.org/cgi-bin/ethsearch?search_term=0707&amp;submit2=Search%21">is not a publicly registered Ethernet type</a> and not listed in <a href="http://standards.ieee.org/develop/regauth/ethertype/eth.txt">the official IEEE registry of Ethertypes</a> as of 2012-10-30.  However, Googling for "ethertype 0707" found <a href="http://www.etsi.org/plugtests/ITS_CMS/Document/ITS_TestDescriptions%20v009.pdf">ETSI CTI Plugtests Guide Stable Draft V0.0.9 (2011-11) "Cooperative Mobility Services Plugtests; Helmond, Netherlands; 14 - 18 November 2011"</a>, which says "The ether type 0x0707 shall be used to indicate a GeoNetworking packet."  It also says "The PHY layer of the communication system is based on IEEE802.11p-2010."</p>
<p>The ff ff ff ff ff ff 04 e5 48 01 d7 02 ff ff ff ff ff ff preceding it looks as if it might be <em>three</em> MAC addresses - two broadcast and one unicast.</p>
<p>Digging around looking for specifications for the protocols being used (and avoiding any references to ISO standards, as I'm a cheap bastard and would rather not pay, for example, CHF 140 or so for one of the standards I found) found <a href="http://www.etsi.org/deliver/etsi_en/302600_302699/302665/01.01.01_60/en_302665v010101p.pdf">ETSI EN 302 665 V1.1.1 (2010-09) "Intelligent Transport Systems (ITS); Communications Architecture"</a>.  That appeared to suggest that one link layer for this was <a href="http://www.etsi.org/deliver/etsi_es/202600_202699/202663/01.01.00_50/es_202663v010100m.pdf">Final draft ETSI ES 202 663 V1.1.0 (2009-11) "Intelligent Transport Systems (ITS); European profile standard for the physical and medium access control layer of Intelligent Transport Systems operating in the 5 GHz frequency band"</a>, which is Good Old Wi-Fi.  Another one to which it refers is ISO/IEC IS 21215 "Intelligent Transport Systems - Communications access for land mobiles (CALM) - M5 medium"; I'm too cheap (as noted earlier) to buy that document, but <a href="http://en.wikipedia.org/wiki/Communications,_Air-interface,_Long_and_Medium_range">the Wikipedia page for CALM</a> lists a bunch of link layers, including 802.11 (Wi-Fi), 802.16 (WiMAX), Bluetooth, and GSM/UMTS, and there's a link for "M5" that goes to <a href="http://en.wikipedia.org/wiki/CALM_M5">a Wikipedia page for CALM M5</a>, and that page says "CALM M5 is the ISO 21215 standard that incorporates WAVE (WAVE PHY/MAC is IEEE 802.11p standard) and adds the following features:..."  So there might be an 802.11 header somewhere in there - or it might be WiMAX, or it might be something else.  My guess is that it's <em>probably</em> either 802.11 or 802.16, given the 802.2+SNAP header.</p>
<p>So, looking at the hex dump:</p>
<blockquote>
<p>a1 b2 c3 d4</p>
</blockquote>
<p>OK, that's a pcap file magic number, so I'm guessing this is a dump of the full pcap file.  That means that:</p>
<blockquote>
<p>00 02</p>
</blockquote>
<p>Major pcap file format version number 2</p>
<blockquote>
<p>00 04</p>
</blockquote>
<p>Minor pcap file format version number 4</p>
<blockquote>
<p>00 00 00 00</p>
</blockquote>
<p>Time zone offset (which nobody ever actually sets, so it's always zero in practice)</p>
<blockquote>
<p>00 00 00 00</p>
</blockquote>
<p>Time stamp accuracy (which nobody ever actually sets, so it's always zero in practice)</p>
<blockquote>
<p>00 00 00 44</p>
</blockquote>
<p>Snapshot length (68, which was, until recently, the tcpdump default for non-IPv6-enabled tcpdump; the default is now 65535 so you get full packets by default)</p>
<blockquote>
<p>00 00 00 71</p>
</blockquote>
<p>Link-layer header type (113, which is <code>LINKTYPE_LINUX_SLL</code>, used on Linux for the "any" device, some interfaces known to supply bogus headers such as PPP interfaces, <em>and</em> interfaces for which the <code>ARPHRD_</code> value returned by the OS isn't one libpcap knows about; this is probably tcpdump on Linux with an unknown <code>ARPHRD_</code> value)</p>
<blockquote>
<p>50 8a 5e 87</p>
</blockquote>
<p>Time stamp, seconds part</p>
<blockquote>
<p>00 05 be e0</p>
</blockquote>
<p>TIme stamp, microseconds part</p>
<blockquote>
<p>00 00 00 44</p>
</blockquote>
<p>Captured data length (68 bytes)</p>
<blockquote>
<p>00 00 00 87</p>
</blockquote>
<p>Actual packet length on the network (135 bytes, so the packet data was cut short to 68 bytes)</p>
<p>And the packet data, with a <code>LINKTYPE_LINUX_SLL</code>/<code>DLT_LINUX_SLL</code> header, which is described on <a href="http://www.tcpdump.org/linktypes/LINKTYPE_LINUX_SLL.html">the page linked to from the entry in the </a><a href="http://tcpdump.org">tcpdump.org</a> link-layer header types page, is:</p>
<blockquote>
<p>00 04</p>
</blockquote>
<p>Packet type - "sent by us"</p>
<blockquote>
<p>ff fe</p>
</blockquote>
<p><code>ARPHRD_</code> type (<code>ARPHRD_NONE</code>, which claims to be "zero header length" in the comment for the entry in Linux's <code>if_arp.h</code>; is this going through a tuntap device from some user-land capture program?)</p>
<blockquote>
<p>00 06</p>
</blockquote>
<p>Link-layer address length - 6 octets (not surprising, if this is really 802.11 or even 802.16)</p>
<blockquote>
<p>00 00 00 00 00 00 00 00</p>
</blockquote>
<p>Link-layer address (as noted in the document, padded to 8 bytes)</p>
<blockquote>
<p>00 00</p>
</blockquote>
<p>Protocol type - 0x0000 is <em>NOT</em> a value listed in the Linux 3.0.4 <code>if_ether.h</code>, so that's either bogus, an undocumented value, or something in a later kernel version</p>
<blockquote>
<p>ff ff ff ff ff ff 04 e5 48 01 d7 02 ff ff ff ff ff ff 00 00 00 00</p>
</blockquote>
<p>A bunch of stuff that looks like MAC addresses plus 00 00 00 00</p>
<blockquote>
<p>aa aa 03 00 00 00 07 07</p>
</blockquote>
<p>802.2 and SNAP header</p>
<p>So Wireshark should be dissecting this as "Linux cooked-mode capture", and should be showing the payload as raw data, given that 0x0000 is not a known <code>ETH_P_</code> value in Linux.</p>
<p>So either Wireshark needs to be made to handle 0x0000 in that case, whatever the right thing to do there is, or the code in Linux (network layer or driver) or whatever's supplying the packets to the system needs to be fixed to set the protocol type correctly.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/15388/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>30 Oct '12, 11:51</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" alt="Guy%20Harris's gravatar image" />
    <p><a href="/users/79/guy-harris">Guy Harris ♦♦</a><br/>
    <span class="score" title="17443 reputation points"><span class="">17.4k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">&#9679;</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">&#9679;</span><span class="badgecount">196</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Guy Harris has 216 accepted answers">19&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/15388/">
                edited
                <strong>30 Oct '12, 12:29</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-15388">
    
        <a name="15390"></a>
        <div class="comment" id="comment-15390">
            <div id="post-15390-score" class="comment-score">1</div>
            <div class="comment-text"><p>"at this point my brain's wired to recognize aa aa 03 :-)"... You Sir are scary... :-D</p></div>
            <div class="comment-info" id="comment-15390-info">
                
                
                
                

                

                <span class="comment-age">(30 Oct '12, 11:54)</span>
                <a class="comment-user userinfo" href="/users/145/jasper">Jasper ♦♦</a>
                
            </div>
        </div>
    
        <a name="15393"></a>
        <div class="comment" id="comment-15393">
            <div id="post-15393-score" class="comment-score">1</div>
            <div class="comment-text"><blockquote>
<p>"at this point my brain's wired to recognize aa aa 03 :-)"... You Sir are scary... :-D</p>
</blockquote>

<p>That's what <a href="https://www.ohloh.net/accounts/gharris">14 years of hacking Wireshark and 12 years of hacking libpcap/tcpdump</a> will do to your brain....</p></div>
            <div class="comment-info" id="comment-15393-info">
                
                
                
                

                

                <span class="comment-age">(30 Oct '12, 12:25)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="15398"></a>
        <div class="comment" id="comment-15398">
            <div id="post-15398-score" class="comment-score">1</div>
            <div class="comment-text"><p>And if the Cohda device is a <a href="http://cohdawireless.com/product/mk2.html">MK2 WAVE-DSRC Radio</a>, then it's <em>definitely</em> 802.11p.  If tcpdump was running on the embedded processor - the pcap file is big-endian, which makes it more likely that it was, as a typical Linux box is x86 and thus little-endian - you might want to ask the fine folks at Cohda Wireless to fix their driver, or whatever, to use <code>ARPHRD_IEEE80211</code> or <code>ARPHRD_IEEE80211_RADIOTAP</code> as the <code>ARPHRD_</code> type, and to supply the appropriate link-layer headers (802.11 or 802.11+radiotap).</p></div>
            <div class="comment-info" id="comment-15398-info">
                
                
                
                

                

                <span class="comment-age">(30 Oct '12, 15:02)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="15485"></a>
        <div class="comment" id="comment-15485">
            <div id="post-15485-score" class="comment-score"></div>
            <div class="comment-text"><p>OK, guys, thank you very much for your in-depth answers. I will investigate then :)</p>

<p>Greetings from Germany
Ewgenij</p></div>
            <div class="comment-info" id="comment-15485-info">
                
                
                
                

                

                <span class="comment-age">(02 Nov '12, 02:07)</span>
                <a class="comment-user userinfo" href="/users/3729/ewgenijkkg">Ewgenijkkg</a>
                
            </div>
        </div>
    
        <a name="15486"></a>
        <div class="comment" id="comment-15486">
            <div id="post-15486-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>So Wireshark should be dissecting this as "Linux cooked-mode capture", and should be showing the payload as raw data, given that 0x0000 is not a known ETH_P_ value in Linux.</p>
</blockquote>

<p>So, if 0x0000 would be a valid protocol value, the header would not be linux-cooked capture but ethernet, for example. Do I understand it right? And independent from that, if bytes after the link-layer would fit into higher level protocols, Wireshark would dissect them correctly? It would not present them as raw bytes, if I got it right. Did I? :)</p></div>
            <div class="comment-info" id="comment-15486-info">
                
                
                
                

                

                <span class="comment-age">(02 Nov '12, 02:39)</span>
                <a class="comment-user userinfo" href="/users/3729/ewgenijkkg">Ewgenijkkg</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-15388" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-15388-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="15408"></a>
                    <div id="answer-container-15408" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-15408-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/15408/up/" rel="nofollow"> </a>
<div id="post-15408-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-15408-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/15408/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Hi Ewgenij,</p>
<p>I strongly suggest you get in contact with the folks at Cohda: <a href="http://www.cohdawireless.com/contact/default.html">http://www.cohdawireless.com/contact/default.html</a></p>
<p>They provide both a wireshark plugin to dissect their proprietary headers and a mechanism to switch the monitoring interface to ARPHRD_IEEE80211.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/15408/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>31 Oct '12, 01:59</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/048a93a04e3d7ca7be6dfa1828b369a4?s=32&amp;d=identicon&amp;r=g" alt="Jason%20Boyd's gravatar image" />
    <p><a href="/users/3740/jason-boyd">Jason Boyd</a><br/>
    <span class="score" title="1 reputation points">1</span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Jason Boyd has no accepted answers">0&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-15408">
    
        <a name="15411"></a>
        <div class="comment" id="comment-15411">
            <div id="post-15411-score" class="comment-score"></div>
            <div class="comment-text"><p>If they provide that dissector to their commercial customers, I think they have to disclose the source code of the dissector, due to GPL licensing ;-)</p></div>
            <div class="comment-info" id="comment-15411-info">
                
                
                
                

                

                <span class="comment-age">(31 Oct '12, 02:39)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="15425"></a>
        <div class="comment" id="comment-15425">
            <div id="post-15425-score" class="comment-score"></div>
            <div class="comment-text"><p>And if their documentation doesn't explain that you want to switch the monitoring interface to <code>ARPHRD_IEEE80211</code>, they need to fix it.  For that matter, unless there's some compelling reason why either <code>ARPHRD_IEEE80211</code> or <code>ARPHRD_IEEE80211_RADIOTAP</code> shouldn't be the <em>only</em> mode, they should make it so - maybe <code>ARPHRD_ETHER</code> should be an alternative, and possibly the default alternative, but <code>ARPHRD_NONE</code> is completely bogus.  (If they make it a <a href="http://www.linuxwireless.org">mac80211 driver</a>, perhaps that'll handle all that for them.)</p></div>
            <div class="comment-info" id="comment-15425-info">
                
                
                
                

                

                <span class="comment-age">(31 Oct '12, 09:59)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
        <a name="15488"></a>
        <div class="comment" id="comment-15488">
            <div id="post-15488-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>They provide both a wireshark plugin to dissect their proprietary headers</p>
</blockquote>

<p>Are you sure? I could not find anything about the plugin on their website...</p></div>
            <div class="comment-info" id="comment-15488-info">
                
                
                
                

                

                <span class="comment-age">(02 Nov '12, 03:19)</span>
                <a class="comment-user userinfo" href="/users/3729/ewgenijkkg">Ewgenijkkg</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-15408" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-15408-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/15337/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='dFLgsLvmA4guICRI8OaLpURH1ZAphgSK' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/15337/ignoring-the-first-x-bytes-of-a-packet?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/15337/ignoring-the-first-x-bytes-of-a-packet?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/bytes/"
            class="tag-link-bytes"
            title="see questions tagged'bytes'using tags"
            rel="tag">bytes</a> <span class="tag-number">&#215;32</span><br/>
        
        <a href="/tags/mask/"
            class="tag-link-mask"
            title="see questions tagged'mask'using tags"
            rel="tag">mask</a> <span class="tag-number">&#215;7</span><br/>
        
        <a href="/tags/ignore/"
            class="tag-link-ignore"
            title="see questions tagged'ignore'using tags"
            rel="tag">ignore</a> <span class="tag-number">&#215;5</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Oct. 29, 2012, 7:27 a.m.">29 Oct '12, 07:27</strong>
    </p>
    <p> 
     	question was seen: <strong>7,839 times</strong>
    </p>
    <p> 
        last updated: <strong title="Nov. 2, 2012, 3:19 a.m.">02 Nov '12, 03:19</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/5341/should-size-of-file-increase-when-saved-on-disk-after-extracting-from-packets">Should size of file increase when saved on disk after extracting from packets</a>
        </p>
        
        <p>
            <a href="/questions/39381/finding-ip-pairs-that-exchange-most-bytes">finding IP pairs that exchange most bytes</a>
        </p>
        
        <p>
            <a href="/questions/44458/discardignore-data-on-capture">Discard/ignore data on capture</a>
        </p>
        
        <p>
            <a href="/questions/5935/missing-bytes-in-capture-file">Missing bytes in Capture file</a>
        </p>
        
        <p>
            <a href="/questions/40203/display-only-portion-of-data-field-as-column">display only portion of data field as column</a>
        </p>
        
        <p>
            <a href="/questions/49416/how-to-prevent-an-ip-from-displaying-in-a-live-capture">How to prevent an IP from displaying in a live capture?</a>
        </p>
        
        <p>
            <a href="/questions/6091/offset-in-packet-byte-pane">offset in packet byte pane</a>
        </p>
        
        <p>
            <a href="/questions/40914/wireshark-bug-or-due-to-tcp-offload">Wireshark Bug or due to TCP offload?</a>
        </p>
        
        <p>
            <a href="/questions/54446/how-do-i-un-ignore-an-ignored-packet">How do I un-ignore an ignored packet ?</a>
        </p>
        
        <p>
            <a href="/questions/8684/bytes-in-flight-value">Bytes in flight value</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
