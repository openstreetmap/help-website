<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>How do you decrypt The Encrypted Handshakes and Application Data. - Wireshark Q&amp;A</title>
        <meta name="description" content="Hi folks, I am trying to use wire shark to evaluate the security of my server. Specifically the SSL section. I have seen some documentation witch show wire shark decrypting The Encrypted Handshakes and Application Data from a 2 conversations between client and server. I Need to learn how to configur..." />
        <meta name="keywords" content="ssl" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/13090/how-do-you-decrypt-the-encrypted-handshakes-and-application-data" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/13090/how-do-you-decrypt-the-encrypted-handshakes-and-application-data?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='bmx3N6RnMjJ3EeqpycI34BynkpmU4Duo' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/13090/how-do-you-decrypt-the-encrypted-handshakes-and-application-data">How do you decrypt The Encrypted Handshakes and Application Data.</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-13090-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/13090/up/" rel="nofollow"> </a>
<div id="post-13090-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-13090-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/13090/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/13090/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hi folks,</p>
<p>I am trying to use wire shark to evaluate the security of my server. Specifically the SSL section. I have seen some documentation witch show wire shark decrypting The Encrypted Handshakes and Application Data from a 2 conversations between client and server. I Need to learn how to configure wire shark to be able to do this. All the documentation I found on this subject has ether indicated that I should already have this ability, or it is too confusing to figure out. I need something a little more step by step. I am hopping that this is reliant on some form of data that only the client or the Administer would have access to and not something that posses a real secretly risk, but I won't know until I learn more about it.</p>
<p>From what I have learned, I believe this is probably the most useful info for me to share about problem.</p>
<p>In the example from my test between the web browser (witch is currently Chrome) and my server. </p>
<p>At the point of Client Key Exchange, I am getting "Handshake Protocol: Encrypted Handshake Message", and not what the message is. <a href="http://wiki.wireshark.org/SSL/">http://wiki.wireshark.org/SSL/</a> show wire shark decrypting this. Same kind of thing for Application data. I also have not found a pre-master secret variable yet.</p>
<p>I do have GnuTLS 2.8.5 and Gcrypt 1.4.5 already installed in wire shark(1.2.10).</p>
<p>At the Client Hello stage, My Brower is using TLSV1, so I do not have a challenge variable and no Public-key algorithm as <a href="http://www.cs.ucy.ac.cy/courses/EPL375/tutorials/Tut10/Wireshark_SSL_Solution_July_22_2007.pdf">http://www.cs.ucy.ac.cy/courses/EPL375/tutorials/Tut10/Wireshark_SSL_Solution_July_22_2007.pdf</a> states that I should be looking for, I have gathered that the Random variable is probably a replacement for the challenge. </p>
<p>At the Server Hello stage, my server had selected to use Cipher Suite: TLS_DHE_RSA_WITH_AES_256_CBC_SHA I don't know if this make a difference.</p>
<p>could some one please point me in the right direction?</p>
<p>Sincerely,</p>
<p>Nonlin</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/ssl/" class="post-tag tag-link-ssl"
                                        title="see questions tagged 'ssl'" rel="tag">ssl</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>28 Jul '12, 04:56</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/38d4fe3773b1dbf3936aa9171904ec34?s=32&amp;d=identicon&amp;r=g" alt="nonlin's gravatar image" />
    <p><a href="/users/3156/nonlin">nonlin</a><br/>
    <span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">&#9679;</span><span class="badgecount">2</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="nonlin has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/13090/">
                edited
                <strong>28 Jul '12, 04:57</strong>
            </a>
        </p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-13090">
    
</div>
<div id="comment-tools-13090" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-13090-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/13090/how-do-you-decrypt-the-encrypted-handshakes-and-application-data?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/13090/how-do-you-decrypt-the-encrypted-handshakes-and-application-data?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/13090/how-do-you-decrypt-the-encrypted-handshakes-and-application-data?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/13090/how-do-you-decrypt-the-encrypted-handshakes-and-application-data?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="13132"></a>
                    <div id="answer-container-13132" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-13132-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/13132/up/" rel="nofollow"> </a>
<div id="post-13132-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-13132-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/13132/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Take a look at the answer of <a href="/users/5/syn-bit">@SYN-bit</a> in his <a href="http://ask.wireshark.org/questions/13004/decoding-ssl-traffic?page=1#13010">answer to a similar question</a>. Especially take a look at his Sharkfest presentation.</p>
<p><strong>HINT:</strong> Your server is suggesting/using <code>TLS_</code><strong><code>DHE</code></strong><code>_RSA_WITH_AES_256_CBC_SHA</code>. <strong>DHE</strong> means it is using a Diffie Hellman Key Exchange during the Handshake. That's one reason why you cannot decrypt the TLS connection simply by providing the server's private key. <br>
</p>
<p>Regards<br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/13132/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>30 Jul '12, 13:41</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/13132/">
                edited
                <strong>03 Aug '12, 02:38</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-13132">
    
        <a name="13333"></a>
        <div class="comment" id="comment-13333">
            <div id="post-13333-score" class="comment-score"></div>
            <div class="comment-text"><p>Thank you Kurt for leading me to Syn bit site. I have spent several day going over the text, and doing some experiments and haven't gotten very far. I still find a lot of it quite confusing, or/and I am missing simple bits of information.</p>

<p>At this point, I have set up an experiment where I have exported a private key file from my server, put in the RSA keys list. (I made shore I was in binary mode during the ssh transfer). I then repeated the same experiment as above but I used Internet explorer instead of Chrome because IE did seem to support the specific Diffie Hellman Key Exchange that Chrome did. So I figured it would be best to figure  out how to make the system work for now and then figure out how to make DHE work latter. IE used TLS_RSA_WITH_RC4_123_MD5.</p>

<p>So of course I don't work. Hear is a sample from the SSL debug file:</p>

<p>dissect_ssl enter frame #11 (first time)</p>

<p>ssl_session_init: initializing ptr 0528240C size 588</p>

<p>conversation = 05281F88, ssl_session = 0528240C</p>

<p>record: offset = 0, reported_length_remaining = 77</p>

<p>dissect_ssl3_record: content_type 22 Handshake</p>

<p>decrypt_ssl3_record: app_data len 72, ssl state 0x00</p>

<p>association_find: TCP port 4433 found 00000000</p>

<p>packet_from_server: is from server - FALSE</p>

<p>decrypt_ssl3_record: using client decoder</p>

<p>decrypt_ssl3_record: no decoder available</p>

<p>dissect_ssl3_handshake iteration 1 type 1 offset 5 length 68 bytes, remaining 77 </p>

<p>packet_from_server: is from server - FALSE</p>

<p>ssl_find_private_key server 24.215.166.144:443</p>

<p>dissect_ssl3_hnd_hello_common found CLIENT RANDOM -&gt; state 0x01</p>

<p>I believe that I have the wrong private key file. The server has a couple of files with the .key extension.
The one I am using is : /etc/httpd/conf/ssl.key/server.key
I also have:
/etc/rndc.key
/usr/share/doc/lynx-2.8.5./docs/ slang.key pdcouses.key djgpp.key
var/named/chroot/etc/rndc.key
and a hole bunch of keys under /ect/Zeffie/keys/ but I believe that the Zeffie dir is not native to the server.
, So I probably need to know where to find it, if some one have an idea as to what I should be looking for to identify it, I would greatly appreciate it. It happens to be a BlueQuartz. Also I would also like to figure out how to a get the private key (I guess they are the private key) from the client side to see how that works. </p>

<p>I would like to thank every one for there patients with me, some of my question may seem a little amateur for my level of administration. and my spelling is even worse.</p>

<p>Sincerely
Nonlin</p></div>
            <div class="comment-info" id="comment-13333-info">
                
                
                
                

                

                <span class="comment-age">(02 Aug '12, 21:21)</span>
                <a class="comment-user userinfo" href="/users/3156/nonlin">nonlin</a>
                
            </div>
        </div>
    
        <a name="13344"></a>
        <div class="comment" id="comment-13344">
            <div id="post-13344-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>So I figured it would be best to figure out how to make the system work for now and then figure out how to make DHE work latter.</p>
</blockquote>

<p>well, with a browser, it's hard to "make DHE work" as you cannot use the private key of the server. You could use the premaster key, but there is no way (at least I don't know one) to extract that information from a browser. You can test with curl (<a href="http://curl.haxx.se">curl.haxx.se</a>) and verbose mode. But that's a second step, after you managed to decrypt your first ssl session.</p>

<blockquote>
<p><code>IE used TLS_RSA_WITH_RC4_123_MD5.</code><br>
</p>
</blockquote>

<p>That should work, if you used the right key.</p>

<blockquote>
<p>So of course I don't work. Hear is a sample from the SSL debug file:</p>
</blockquote>

<p>Please post a more complete debug file.</p>

<blockquote>
<p>I believe that I have the wrong private key file. The server has a couple of files with the .key extension. The one I am using is : /etc/httpd/conf/ssl.key/server.key</p>
</blockquote>

<p>According to the debug file (and your description), you tried to decrypt https on port 443, so that key looks like a good choice. HOWEVER, it depends on the apache configuration which key is used. If there is no other key in the apache config directory and no other apache config on your system, that key might be the right one. As a test, you can move the key and restart apache. If apache does not start, it was the right one. If it still starts and you can access the https site, it's using a different key. Then you should check the configuration.</p>

<p>BTW: If you open the key with an editor, do you see the string 'ENCRYPTED' somewhere in that file? If so, the private key is encrypted and you need to specify that passphrase in wireshark as well.</p>

<p>BTW: Did you try to decrypt the sample that <a href="/users/5/syn-bit">@SYN-bit</a> used in his presentation? That would be a good start for you.</p>

<blockquote>
<p><code><a href="http://sharkfest.wireshark.org/sharkfest.12/prsentations/MB-2_SSL_Troubleshooting_Hands-on_Lab_Files.tgz">http://sharkfest.wireshark.org/sharkfest.12/prsentations/MB-2_SSL_Troubleshooting_Hands-on_Lab_Files.tgz</a></code><br>
</p>
</blockquote></div>
            <div class="comment-info" id="comment-13344-info">
                
                
                
                

                

                <span class="comment-age">(03 Aug '12, 02:40)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="13406"></a>
        <div class="comment" id="comment-13406">
            <div id="post-13406-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks again for your help.</p>

<p>I think I am just starting to get a handle on this thing, do to some of the segmentations you made, I discovered that yes, I was using the wrong key. Hears a segment from the log file I should have sent you.
</p>

<pre>dissect_ssl enter frame #95 (first time)
  conversation = 05281F88, ssl_session = 0528240C
  record: offset = 0, reported_length_remaining = 435
dissect_ssl3_record: content_type 23 Application Data
decrypt_ssl3_record: app_data len 430, ssl state 0x17
packet_from_server: is from server - FALSE
decrypt_ssl3_record: using client decoder
decrypt_ssl3_record: no decoder available
association_find: TCP port 4433 found 00000000
association_find: TCP port 443 found 090A0EA0
</pre>

<p></p>

<p>I am still not shore what part of the file really tell me that I had the wrong key, I guess it is the line that says "no decoder available", not very descriptive enough to lead me to the issue. But at least it better then nothing.</p>

<p>Anyway I did find the key I needed, it was just called "key" (no extension) and it was located /home/sites/&lt;domain name="" of="" secure="" site=""&gt;/certs. overly, I hit my head and said "Gee, I could have had a V8". So now it works fine.</p>

<p>Thank you for the sample file it was really helpful, unforchunetly the link you gave me was dead, but I pocked around the net and found that this link was ok. <a href="http://sharkfest.wireshark.org/sharkfest.12/presentations/MB-2_SSL_Troubleshooting_Hands-on_Lab_Files.tgz">http://sharkfest.wireshark.org/sharkfest.12/presentations/MB-2_SSL_Troubleshooting_Hands-on_Lab_Files.tgz</a></p>

<p>Even though I still have more to learn from the server key, I am ready to ask my next question. Is there a way to do the some thing from the client side, you mentioned something about exporting a privat key or Master-key with a Session-Id from a web browser, or rather you wished that we had the ability to do that. I have seen some stuff about a patch for Chrome and Firefox to do something like that, but they keep mentioning have to rebuild the browser, and since I am using windows for the client side of my research, that would make things some what more complicated, or rather I would need step by step instructions before I would attempt it. But I was hopping that I could trying something like digging though the web browser temp files, or maybe I could use OpenSSL to request it or find it on the hard drive. I know you can it to open a session with the server, but seems independent from the web browser, I don't know how to use it to get the session information for an existing web browsers session so I would have the right Master key and session-IDs to decryption the bower session. Something like that. Have any ideas?</p>

<p>Sincerely,
Nonlin </p></div>
            <div class="comment-info" id="comment-13406-info">
                
                
                
                

                

                <span class="comment-age">(06 Aug '12, 15:55)</span>
                <a class="comment-user userinfo" href="/users/3156/nonlin">nonlin</a>
                
            </div>
        </div>
    
        <a name="13407"></a>
        <div class="comment" id="comment-13407">
            <div id="post-13407-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>I am still not shore what part of the file really tell 
me that I had the wrong key</p>
</blockquote>

<p>unfortunately the ssl debug file is a bit hard to understand and there are many reasons for a problem, thus many different error messages.</p>

<blockquote>
<p>unfortunately the link you gave me was dead, </p>
</blockquote>

<p>sorry, it was a typo. /<strong>prs</strong>entations/ instead of /presentations/. </p>

<blockquote>
<p>I have seen some stuff about a patch for Chrome and Firefox to do something like that</p>
</blockquote>

<p>That's the way to go...</p>

<blockquote>
<p>But I was hopping that I could trying something like digging though the web browser temp files</p>
</blockquote>

<p>I'm sorry, those keys will never appear somewhere in the file system, as they are never written to disk (maybe with one exception: the paging file). </p>

<p>So, no other (easy) way than a tool that extracts the key from the running browser (e.g. a plugin).</p></div>
            <div class="comment-info" id="comment-13407-info">
                
                
                
                

                

                <span class="comment-age">(06 Aug '12, 16:17)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-13132" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-13132-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/13090/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='bmx3N6RnMjJ3EeqpycI34BynkpmU4Duo' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/13090/how-do-you-decrypt-the-encrypted-handshakes-and-application-data?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/13090/how-do-you-decrypt-the-encrypted-handshakes-and-application-data?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/ssl/"
            class="tag-link-ssl"
            title="see questions tagged'ssl'using tags"
            rel="tag">ssl</a> <span class="tag-number">&#215;319</span><br/>
        
    </p>
    <p>
        question asked: <strong title="July 28, 2012, 4:56 a.m.">28 Jul '12, 04:56</strong>
    </p>
    <p> 
     	question was seen: <strong>25,383 times</strong>
    </p>
    <p> 
        last updated: <strong title="Aug. 6, 2012, 4:18 p.m.">06 Aug '12, 16:18</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/337/where-did-the-google-ssl-video-go">Where did the Google SSL video go?</a>
        </p>
        
        <p>
            <a href="/questions/4303/decrypt-ssl-traffic-destined-for-squid-proxy-server">Decrypt SSL Traffic destined for Squid Proxy Server</a>
        </p>
        
        <p>
            <a href="/questions/6368/ssl-capture">SSL capture</a>
        </p>
        
        <p>
            <a href="/questions/8004/ssl-decryption-only-works-in-promiscuous-mode">SSL decryption only works in promiscuous mode?</a>
        </p>
        
        <p>
            <a href="/questions/10184/ssl-descrypt-_without_-specifying-a-protocol">SSL Descrypt _without_ specifying a protocol?</a>
        </p>
        
        <p>
            <a href="/questions/13573/capture-bridge-ssl-packet">capture bridge SSL packet</a>
        </p>
        
        <p>
            <a href="/questions/16163/soap-messages-not-decrypted">Soap Messages Not Decrypted</a>
        </p>
        
        <p>
            <a href="/questions/20855/is-it-possible-to-decrypt-an-ssl-session-post-capture">Is it possible to decrypt an SSL Session post capture</a>
        </p>
        
        <p>
            <a href="/questions/23563/http-gzip-decompression-failed-not-out-of-order">HTTP gzip decompression failed (NOT out-of-order)</a>
        </p>
        
        <p>
            <a href="/questions/28145/cant-decrypt-ssl-in-capture-from-windump">Can&#39;t decrypt ssl in capture from windump</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
