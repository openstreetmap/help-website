<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Unable to start 4 way handshake and can&#39;t capture EAPOL packets - Wireshark Q&amp;A</title>
        <meta name="description" content="Hi everyone, Wireshark cannot capture EAPOL packets in monitor mode. I am working on Kali Linux 2016.2 64 bit OS. I have exactly the same problem and have same network adapter which is mentioned in the following link: This Post I&#39;ve typed these commands to get in monitor mode: airmon-ng check kill a..." />
        <meta name="keywords" content="eapol,monitor-mode" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/58748/unable-to-start-4-way-handshake-and-cant-capture-eapol-packets" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/58748/unable-to-start-4-way-handshake-and-cant-capture-eapol-packets?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='hUkaVxrIfDkBe3fkeEBAMjYhussbwh8v' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/58748/unable-to-start-4-way-handshake-and-cant-capture-eapol-packets">Unable to start 4 way handshake and can&#39;t capture EAPOL packets</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-58748-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/58748/up/" rel="nofollow"> </a>
<div id="post-58748-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-58748-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/58748/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/58748/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hi everyone, Wireshark cannot capture EAPOL packets in monitor mode. I am working on Kali Linux 2016.2 64 bit OS.</p>
<p>I have exactly the same problem and have same network adapter which is mentioned in the following link:<br>
<a href="https://ask.wireshark.org/questions/57692/wireshark-doesnt-capture-eapol-packets-and-no-http-traffic">This Post</a></p>
<p><strong>I've typed these commands to get in monitor mode:</strong>
<code>airmon-ng check kill
airmon-ng start wlan0
airodump-ng wlan0mon</code></p>
<p>I've added decryption key [Passphrase:SSID] in 802.11 protocol.</p>
<p>Could anyone help me?</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/eapol/" class="post-tag tag-link-eapol"
                                        title="see questions tagged 'eapol'" rel="tag">eapol</a>
                                
                                    <a href="/tags/monitor-mode/" class="post-tag tag-link-monitor-mode"
                                        title="see questions tagged 'monitor-mode'" rel="tag">monitor-mode</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>13 Jan '17, 14:03</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f269fa8e8bfb8c5492f4a7b901fc6940?s=32&amp;d=identicon&amp;r=g" alt="instantcrush's gravatar image" />
    <p><a href="/users/27379/instantcrush">instantcrush</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">&#9679;</span><span class="badgecount">3</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="instantcrush has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/58748/">
                edited
                <strong>13 Jan '17, 14:03</strong>
            </a>
        </p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-58748">
    
</div>
<div id="comment-tools-58748" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-58748-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/58748/unable-to-start-4-way-handshake-and-cant-capture-eapol-packets?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/58748/unable-to-start-4-way-handshake-and-cant-capture-eapol-packets?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/58748/unable-to-start-4-way-handshake-and-cant-capture-eapol-packets?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/58748/unable-to-start-4-way-handshake-and-cant-capture-eapol-packets?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="58749"></a>
                    <div id="answer-container-58749" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-58749-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/58749/up/" rel="nofollow"> </a>
<div id="post-58749-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-58749-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/58749/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>We can probably help you, but not with the limited information you provide.  The reference question had a number of comments and a technique to start but you did not provide a trace nor do you say if you followed the procedure described.</p>
<p>There are MANY reasons why one can't get this to work.  Are you on the right frequency band?  Are you on the right channel?  Do you know how to identify the device under review?<br>
</p>
<p>Having the key entered will not help the capture - it will decrypt if you get the 4-way eapol frames, but has no impact on capture.  Make sure you shutdown the network manager as well - one of those commands above may do it (I don't use the aircrack-ng scripts so don't know exactly what they do) so suggest to shutdown the network manager and make sure the proper channel is set, and follow the procedure described in the other question.  If you don't have any luck, post a trace and we can figure out why it doesn't work.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/58749/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>13 Jan '17, 14:25</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/0a47ef51dd9c9996d194a4983295f5a4?s=32&amp;d=identicon&amp;r=g" alt="Bob%20Jones's gravatar image" />
    <p><a href="/users/112/bob-jones">Bob Jones</a><br/>
    <span class="score" title="1014 reputation points"><span class="">1.0k</span></span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="5 badges"><span class="silver">&#9679;</span><span class="badgecount">5</span></span><span title="15 badges"><span class="bronze">&#9679;</span><span class="badgecount">15</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Bob Jones has 19 accepted answers">21&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-58749">
    
        <a name="58752"></a>
        <div class="comment" id="comment-58752">
            <div id="post-58752-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks for reply, I've followed provided steps in the link and then got a cloudshark account but they suggested this forum. As you mentioned: <em>There are MANY reasons why one can't get this to work. Are you on the right frequency band? Are you on the right channel? Do you know how to identify the device under review?</em></p>

<p>I don't know how to configure these, I looked up wiki but didn't encounter with those. Can you suggest me a proper source?</p></div>
            <div class="comment-info" id="comment-58752-info">
                
                
                
                

                

                <span class="comment-age">(13 Jan '17, 14:34)</span>
                <a class="comment-user userinfo" href="/users/27379/instantcrush">instantcrush</a>
                
            </div>
        </div>
    
        <a name="58753"></a>
        <div class="comment" id="comment-58753">
            <div id="post-58753-score" class="comment-score">1</div>
            <div class="comment-text"><p>Try</p>

<p><a href="https://wireless.wiki.kernel.org/en/users/documentation/iw">https://wireless.wiki.kernel.org/en/users/documentation/iw</a></p>

<p>This will set channel and other settings.  Check your status with:<br>
</p>

<p><a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="bce9cfd9cefccfd9cecad9ce">[email&#160;protected]</a>$ iw dev</p>

<p>Then you can use ifconfig to bring interface up and down, and set the channel with iw.  Set to same channel the ap is on.</p></div>
            <div class="comment-info" id="comment-58753-info">
                
                
                
                

                

                <span class="comment-age">(13 Jan '17, 16:20)</span>
                <a class="comment-user userinfo" href="/users/112/bob-jones">Bob Jones</a>
                
            </div>
        </div>
    
        <a name="58773"></a>
        <div class="comment not_top_scorer" id="comment-58773">
            <div id="post-58773-score" class="comment-score"></div>
            <div class="comment-text"><p>I've configured moni0 interface with below command:<br>
    <code>iw phy phy0 interface add moni0 type monitor</code> <br><br>
then <br>
    <code>ifconfig moni0 up</code><br><br>
and<br>
    <code>ifconfig wlan0 down</code><br><br>
My AP channel is 11 so I typed:<br>
    <code>iw moni0 set channel 11</code><br><br>
iw dev command output without addr is:<br>
<code>phy#0
    Interface moni0
        ifindex 4
        wdev 0x2
        type monitor
        channel 11 (2462 MHz), width: 20 MHz (no HT), center1: 2462 MHz
        txpower 20.00 dBm
    Interface wlan0
        ifindex 3
        wdev 0x1
        type managed
        txpower 20.00 dBm</code><br><br>
Even if I did those, when I capture packets with moni0 on Wireshark. I cannot see EAPOL packets and even my AP's SSID. There are just 802.11 protocols with encrypted data.</p></div>
            <div class="comment-info" id="comment-58773-info">
                
                
                
                

                

                <span class="comment-age">(15 Jan '17, 08:03)</span>
                <a class="comment-user userinfo" href="/users/27379/instantcrush">instantcrush</a>
                
            </div>
        </div>
    
        <a name="58774"></a>
        <div class="comment" id="comment-58774">
            <div id="post-58774-score" class="comment-score">1</div>
            <div class="comment-text"><p>Your commands for prepping the interface look OK, but you should see beacons from your AP.  These are sent at relatively low rates so are generally easily picked up.  Where are you looking for your AP's SSID?  It should be present in probe responses, and is likely in a beacon, but it is possible to mask by configuration in the beacons.<br>
</p>

<p>If you are seeing 802.11 frames in Wireshark, but not yours, I can only imagine the AP is really off, or you are on the wrong channel.  Even with all the capability stuff we have to deal with now, your should see SOME traffic - beacons, ACKs, etc (i.e. mgmt and control frames) are generally sent at low rates so are easy to pickup.  The hard part is the unicast data frames.<br>
</p>

<p>Other wifi chipsets have issues picking up unicast frames and perhaps the behavior you are seeing is consistent with that type of issue; a trace would confirm that you get nothing but broadcast and multicast frames.  However, I discount this because I have never seen that adapter referenced have this problem.  TP-Link TL-WN722N has an Atheros chipset which works well for many.  If you put a short trace in cloudshark we may be able to identify what the issue is faster.</p></div>
            <div class="comment-info" id="comment-58774-info">
                
                
                
                

                

                <span class="comment-age">(15 Jan '17, 08:19)</span>
                <a class="comment-user userinfo" href="/users/112/bob-jones">Bob Jones</a>
                
            </div>
        </div>
    
        <a name="58776"></a>
        <div class="comment not_top_scorer" id="comment-58776">
            <div id="post-58776-score" class="comment-score"></div>
            <div class="comment-text"><p>First I could not see my AP's becaons, now I can. However, as you mentioned I am only able to see my AP's beacons and probe responses. How can I capture eapol, http, tcp traffic on my AP. Also, I'm very thankful to your quick responses.</p></div>
            <div class="comment-info" id="comment-58776-info">
                
                
                
                

                

                <span class="comment-age">(15 Jan '17, 08:38)</span>
                <a class="comment-user userinfo" href="/users/27379/instantcrush">instantcrush</a>
                
            </div>
        </div>
    
        <a name="58779"></a>
        <div class="comment not_top_scorer" id="comment-58779">
            <div id="post-58779-score" class="comment-score"></div>
            <div class="comment-text"><p><a href="https://www.cloudshark.org/captures/3cee3898f881">https://www.cloudshark.org/captures/3cee3898f881</a></p>

<p>Here is my capture</p></div>
            <div class="comment-info" id="comment-58779-info">
                
                
                
                

                

                <span class="comment-age">(15 Jan '17, 09:04)</span>
                <a class="comment-user userinfo" href="/users/27379/instantcrush">instantcrush</a>
                
            </div>
        </div>
    
        <a name="58782"></a>
        <div class="comment not_top_scorer" id="comment-58782">
            <div id="post-58782-score" class="comment-score"></div>
            <div class="comment-text"><p>I looked at the capture and it looks good.  You have all traffic types - multicast/unicast/broadcast, up to MCS7 for 802.11bgn.  This is consistent with the TP-Link capture adapter.  These are some data frames I pulled out that are encrypted:</p>

<p><img src="https://osqa-ask.wireshark.org/upfiles/2017-01-15_14_03_17-wireshark_capture.pcapng_[Wireshark_2.2.3_(v2.2.3-0-g57531cd)].png" width="600"></p>

<p>I don't know the device you want to decrypt from so could not analyze signal strength.  Let's pretend it's healthy, so when running a capture like you have here, did you reboot the device, or otherwise have it connect to this SSID, on this channel?  If the device in question is  capable of both 2.4 and 5 GHz, it may prefer 5 GHz.  Since your capture is only 2.4, you would miss it.  You need to force things - set the AP to have the SSID on only 2.4GHz, and then reboot the device or otherwise have it connect.  Post that trace if you don't see the eapol frames - also look for the whole sequence of request/response frames:</p>

<p>Probe</p>

<p>Authentication</p>

<p>Association</p>

<p>EAPOL</p>

<p>Do you see any of these?  Is the device in question in this trace?</p></div>
            <div class="comment-info" id="comment-58782-info">
                
                
                
                

                

                <span class="comment-age">(15 Jan '17, 11:10)</span>
                <a class="comment-user userinfo" href="/users/112/bob-jones">Bob Jones</a>
                
            </div>
        </div>
    
        <a name="58786"></a>
        <div class="comment not_top_scorer" id="comment-58786">
            <div id="post-58786-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes it has connected to my AP's SSID with same channel. My AP has only 2.4 GHz. However the output is same as my previous capture. I'm running on guest OS, is this cause a problem? Is my problem only decryption of frames or a frequency mismatch? I provided psk decryption key and configured frequency channel correctly. Are there any required configuration to get eopal packets?</p></div>
            <div class="comment-info" id="comment-58786-info">
                
                
                
                

                

                <span class="comment-age">(15 Jan '17, 11:58)</span>
                <a class="comment-user userinfo" href="/users/27379/instantcrush">instantcrush</a>
                
            </div>
        </div>
    
        <a name="58789"></a>
        <div class="comment not_top_scorer" id="comment-58789">
            <div id="post-58789-score" class="comment-score"></div>
            <div class="comment-text"><p>Whats the mac of the device you want to evaluate?  We need to check the capability.  Decryption is not an issue until you get the eapol frames.  Is the capture system in the vm?<br>
</p>

<p>Whats the bssid?  If the frames are sent at a rate/capability the capture supports you should get them.</p></div>
            <div class="comment-info" id="comment-58789-info">
                
                
                
                

                

                <span class="comment-age">(15 Jan '17, 15:34)</span>
                <a class="comment-user userinfo" href="/users/112/bob-jones">Bob Jones</a>
                
            </div>
        </div>
    
        <a name="58790"></a>
        <div class="comment not_top_scorer" id="comment-58790">
            <div id="post-58790-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes the capture system is in the VM. SSID is Cankistan. For information, I'm not using RADIUS authentication, is that cause a problem?</p></div>
            <div class="comment-info" id="comment-58790-info">
                
                
                
                

                

                <span class="comment-age">(15 Jan '17, 15:40)</span>
                <a class="comment-user userinfo" href="/users/27379/instantcrush">instantcrush</a>
                
            </div>
        </div>
    
        <a name="58791"></a>
        <div class="comment" id="comment-58791">
            <div id="post-58791-score" class="comment-score">1</div>
            <div class="comment-text"><p>The trace looks healthy except for what you say is not there...</p>

<p>Enterprise should not matter.  That will end in a 4-way handshake.  With WPA2-Personal, there is only a 4-way EAPOL handshake after probing/authentication/associating.</p>

<p>I looked through the trace again and there is are a couple of probes from devices not connected to that BSSID, so no auth/assoc/eapol action.  Just to be clear: start the capture, then have the device leave that SSID.  Then have it come back - you can move to another network, or reboot, or whatever, but it has to leave and then come back.  When it (re)associates, it will rekey so will go through the 4-way process again.</p>

<p>The beacon says four devices are on that SSID, but Wireshark really only shows two:</p>

<p><img src="https://osqa-ask.wireshark.org/upfiles/2017-01-15_19_03_03-Wireshark__WLAN_Traffic_Statistics__wireshark_capture.png" width="600"></p>

<p></p><hr>
<p>Omnipeek shows three:</p>
<p><img src="https://osqa-ask.wireshark.org/upfiles/2017-01-15_19_08_40-Omnipeek_8ajwLUY.png" width="600"></p>
<p>I can't explain the discrepancy, nor find that fourth device.</p><p></p></div>
            <div class="comment-info" id="comment-58791-info">
                
                
                
                

                

                <span class="comment-age">(15 Jan '17, 16:16)</span>
                <a class="comment-user userinfo" href="/users/112/bob-jones">Bob Jones</a>
                
            </div>
        </div>
    
        <a name="58792"></a>
        <div class="comment not_top_scorer" id="comment-58792">
            <div id="post-58792-score" class="comment-score"></div>
            <div class="comment-text"><p>I rebooted my AP during capture, It works! I have 4 EAPOL packets now.</p></div>
            <div class="comment-info" id="comment-58792-info">
                
                
                
                

                

                <span class="comment-age">(15 Jan '17, 16:28)</span>
                <a class="comment-user userinfo" href="/users/27379/instantcrush">instantcrush</a>
                
            </div>
        </div>
    
        <a name="58793"></a>
        <div class="comment not_top_scorer" id="comment-58793">
            <div id="post-58793-score" class="comment-score"></div>
            <div class="comment-text"><p>I'm very thankful to you. I'm now able to capture some packets but not all of them. I tried to connect an HTTP server on mobile but those packets weren't captured. What is the cause of this? I can see port 443 data but cannot see port 80's data.</p></div>
            <div class="comment-info" id="comment-58793-info">
                
                
                
                

                

                <span class="comment-age">(15 Jan '17, 16:44)</span>
                <a class="comment-user userinfo" href="/users/27379/instantcrush">instantcrush</a>
                
            </div>
        </div>
    
        <a name="58794"></a>
        <div class="comment" id="comment-58794">
            <div id="post-58794-score" class="comment-score">1</div>
            <div class="comment-text"><p>If you found the answer useful to the the question, please accept the answer for others.</p>

<blockquote>
<blockquote>
<p>What is the cause of this? I can see port 443 data but cannot see port 80's data.</p>
</blockquote>
</blockquote>

<p>Functionally, there is no difference.  Maybe you are only using https and not http?  Also the eapol frames are generally easy to get - but I expect you may have some problems capturing actual data.  Your capture device is a single stream while the AP supports two spatial streams.  If a client connects that supports two spatial streams, and has a healthy RSSI, it will usually use a higher MCS index than your capture device will support so you will miss those frames.  You will, however, still pickup control frames as these are usually sent at low data rates.</p>

<p>The HT IE in the beacon tells us what the AP supports, and the probe requests and association requests from the client will tell you what the client supports.  I haven't seen those for the device so I can't comment.  Something to watch out for.</p></div>
            <div class="comment-info" id="comment-58794-info">
                
                
                
                

                

                <span class="comment-age">(15 Jan '17, 17:31)</span>
                <a class="comment-user userinfo" href="/users/112/bob-jones">Bob Jones</a>
                
            </div>
        </div>
    
        <a name="58819"></a>
        <div class="comment not_top_scorer" id="comment-58819">
            <div id="post-58819-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks for all your kind efforts. I try to capture all udps by using all connected devices.</p></div>
            <div class="comment-info" id="comment-58819-info">
                
                
                
                

                

                <span class="comment-age">(16 Jan '17, 09:42)</span>
                <a class="comment-user userinfo" href="/users/27379/instantcrush">instantcrush</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-58749" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 15
        </span>
        <a href="#" class="show-all-comments-link">show 10 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-58749-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/58748/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='hUkaVxrIfDkBe3fkeEBAMjYhussbwh8v' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/58748/unable-to-start-4-way-handshake-and-cant-capture-eapol-packets?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/58748/unable-to-start-4-way-handshake-and-cant-capture-eapol-packets?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/eapol/"
            class="tag-link-eapol"
            title="see questions tagged'eapol'using tags"
            rel="tag">eapol</a> <span class="tag-number">&#215;38</span><br/>
        
        <a href="/tags/monitor-mode/"
            class="tag-link-monitor-mode"
            title="see questions tagged'monitor-mode'using tags"
            rel="tag">monitor-mode</a> <span class="tag-number">&#215;36</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Jan. 13, 2017, 2:03 p.m.">13 Jan '17, 14:03</strong>
    </p>
    <p> 
     	question was seen: <strong>8,388 times</strong>
    </p>
    <p> 
        last updated: <strong title="Jan. 16, 2017, 10:07 a.m.">16 Jan '17, 10:07</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/1631/hash-from-eapol">HASH from EAPOL</a>
        </p>
        
        <p>
            <a href="/questions/32873/distinguishing-between-eapol-messages-1-2-3-and-4">Distinguishing between EAPOL messages (1, 2, 3, and 4)</a>
        </p>
        
        <p>
            <a href="/questions/60050/decrypt-80211-i-got-the-4-way-handshake">Decrypt 802.11 (i got the 4-way handshake)</a>
        </p>
        
        <p>
            <a href="/questions/34507/monitor-mode-on-lan">Monitor mode on LAN?</a>
        </p>
        
        <p>
            <a href="/questions/54433/why-cant-i-capture-data-packets-in-monitor-mode">Why can&#39;t I capture data packets in monitor mode?</a>
        </p>
        
        <p>
            <a href="/questions/2363/can-just-decrypt-wpa2-if-i-connect-the-sniffing-computer-to-network-and-then-disconnects-it-why">Can just decrypt WPA2 if I connect the sniffing computer to network and then disconnects it, why?</a>
        </p>
        
        <p>
            <a href="/questions/33397/no-eapol-handshakes-captured">No eapol handshakes captured</a>
        </p>
        
        <p>
            <a href="/questions/60947/why-isnt-wireshark-decrypting-80211-traffic-in-my-capture-even-if-the-eapol-handshake-is-present">Why isn&#39;t Wireshark decrypting 802.11 traffic in my capture, even if the EAPOL handshake is present?</a>
        </p>
        
        <p>
            <a href="/questions/34620/wireshark-on-mac-stuck-in-monitor-mode-only-capturing-80211-headers">Wireshark (on Mac) stuck in monitor mode only capturing 802.11 headers</a>
        </p>
        
        <p>
            <a href="/questions/54790/capturing-data-in-monitor-mode">Capturing data in monitor mode</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
