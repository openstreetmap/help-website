<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Unable dissect TLS handshake messages - Wireshark Q&amp;A</title>
        <meta name="description" content="Hi,  We are using Latest Version of wireshark 2.0.3 with GnuTLS 3.2.15, with Gcrypt 1.6.2 on our windows Machine. Also we have wireshark 1.0.15 on CentOS 4.5. We have issue on Both wireshark version on Both OS. In our case we trying to dissert TLS handshake messages, where we have Netconf messages a..." />
        <meta name="keywords" content="dissector" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/52942/unable-dissect-tls-handshake-messages" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/52942/unable-dissect-tls-handshake-messages?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='TvySlf8xbhgX1XP7anWCQ88ftY0j77H0' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/52942/unable-dissect-tls-handshake-messages">Unable dissect TLS handshake messages</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-52942-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/52942/up/" rel="nofollow"> </a>
<div id="post-52942-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-52942-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/52942/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/52942/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hi, </p>
<p>We are using Latest Version of wireshark 2.0.3 with  GnuTLS 3.2.15, with Gcrypt 1.6.2 on our windows Machine. Also we have wireshark 1.0.15 on CentOS 4.5. We have issue on Both wireshark version on Both OS.</p>
<p>In our case we trying to dissert TLS handshake messages, where we have Netconf messages as payload for TLS messages. i.e we are trying to establish Netconf session over TLS.
Our protocol encapsulation will be like TCP--TLS--Netconf</p>
<p>We are trying to see the TLS handshake messages which is used for the Netconf Over TLS session.</p>
<p>But we are not able dessect TLS Handshake messages in this case.</p>
<p>Is there any Limitation from wireshark for this case Netconf over TLS &amp; TCP i.e TCP--TLS-- Netconf.</p>
<p>At the same time, We are able to capture and dissect TLS handshake messages, when we browse https sites.</p>
<p>Please Help</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/dissector/" class="post-tag tag-link-dissector"
                                        title="see questions tagged 'dissector'" rel="tag">dissector</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>26 May '16, 00:55</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/df4dab12d9437bfe0ef8981b3526b069?s=32&amp;d=identicon&amp;r=g" alt="dhanish's gravatar image" />
    <p><a href="/users/24241/dhanish">dhanish</a><br/>
    <span class="score" title="6 reputation points">6</span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="3 badges"><span class="silver">&#9679;</span><span class="badgecount">3</span></span><span title="5 badges"><span class="bronze">&#9679;</span><span class="badgecount">5</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="dhanish has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-52942">
    
        <a name="52950"></a>
        <div class="comment" id="comment-52950">
            <div id="post-52950-score" class="comment-score"></div>
            <div class="comment-text"><p>Can you share a capture in a publicly accessible spot, e.g. <a href="http://cloudshark.org">CloudShark</a>?</p></div>
            <div class="comment-info" id="comment-52950-info">
                
                
                
                

                

                <span class="comment-age">(26 May '16, 02:36)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="52959"></a>
        <div class="comment" id="comment-52959">
            <div id="post-52959-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks for the response.
Actuall as per another query from wireshark forum i have upgraded my CentOS 5.5 version with wireshark version 1.6.16.</p>

<p>Now am able to capture the TLS traffic and TLS dissector working working on linux CentOS machine. (Note:packet captured on same machine with loopback interface lo).</p>

<p>But the same capture(which is captured in linux on lo interface) when i open from my windows 7 desktop machine which has got the latest wireshark version 2.0-3 - No success. Its display only as TCP packets.</p>

<p>Is it because of windows machine doesnt have loopback lo ?
But as said earlier am able to dissect https traffic from my browser from my window machine.</p>

<p>It have uploaded 2 capture files on to cloudshark with tag "callhome" 
1.packet - URL - <a href="https://www.cloudshark.org/captures/c793bfd6c8d1">https://www.cloudshark.org/captures/c793bfd6c8d1</a>
2.callhomeTLSwireshark1.6.16 - URL - <a href="https://www.cloudshark.org/captures/baa5c0384046">https://www.cloudshark.org/captures/baa5c0384046</a></p></div>
            <div class="comment-info" id="comment-52959-info">
                
                
                
                

                

                <span class="comment-age">(26 May '16, 06:02)</span>
                <a class="comment-user userinfo" href="/users/24241/dhanish">dhanish</a>
                
            </div>
        </div>
    
        <a name="52960"></a>
        <div class="comment" id="comment-52960">
            <div id="post-52960-score" class="comment-score"></div>
            <div class="comment-text"><p>We need the "sharing" links to the Cloudshark captures.  In the Cloudshark UI, next to each file there is an (i) button, click that then on the resulting dialog click the sharing tab.  Edit your question and add the links to the captures there.</p></div>
            <div class="comment-info" id="comment-52960-info">
                
                
                
                

                

                <span class="comment-age">(26 May '16, 06:12)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="52961"></a>
        <div class="comment" id="comment-52961">
            <div id="post-52961-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi,</p>

<p>This query is inline with query "Unable to decrypt TLS data from a TLS captured file"</p>

<p>After upgrading the linux CentOS 4.5 with wireshark , as said TLS dissector works fine. 
Hence i tried to decrypt the TLS data using wireshark GUI- EDIT-Preference-RSA key - ssl_init IPv4 addr '127.0.0.1' (127.0.0.1) port '39515' filename '/home/amanimar/openssl/device.key</p>

<p>In the ssl debug file i find more info than before , but still TLS data is not decrypted,</p>

<p>Debug log uploaded on cloudshark with tag 'callhomessldebuglog' file name "callhomeTlsNew1". - URL -  <a href="https://www.cloudshark.org/captures/45435a2b6f7b">https://www.cloudshark.org/captures/45435a2b6f7b</a></p>

<p>As i mentioned earlier our packet encapsulation is like this, TCP-TLS-Netconf session details.</p>

<p>Here TLS payload is Netconf protocol, not http - Is that the reason why we are not able decrypt the TLS data ?</p>

<p>RSA key is of PEM format.</p>

<p>Thanks Very Much for the Response !!</p></div>
            <div class="comment-info" id="comment-52961-info">
                
                
                
                

                

                <span class="comment-age">(26 May '16, 06:33)</span>
                <a class="comment-user userinfo" href="/users/24241/dhanish">dhanish</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-52942" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-52942-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/52942/unable-dissect-tls-handshake-messages?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/52942/unable-dissect-tls-handshake-messages?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/52942/unable-dissect-tls-handshake-messages?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/52942/unable-dissect-tls-handshake-messages?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="52973"></a>
                    <div id="answer-container-52973" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-52973-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/52973/up/" rel="nofollow"> </a>
<div id="post-52973-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-52973-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/52973/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Are you trying to <em>decrypt</em> the TLS or just dissect it?</p>
<p>Since Wireshark doesn't have a NETCONF dissector if you just want to dissect the TLS messages you can just tell the <strong>HTTP</strong> dissector that one of its TLS ports is 4444.  That should show you the Server Hello, etc.  (Maybe there's a less hacky way to get this done.)</p>
<p>In terms of <em>decryption</em> (where I presume you're putting the protocol in the TLS key configuration as <code>data</code>) the log file says:</p>
<pre><code>   dissect_ssl3_hnd_srv_hello can't find cipher suite 0x9D
   record: offset = 63, reported_length_remaining = 934
</code></pre>
<p>That means that the Wireshark version that generated that log file does not understand the cipher (<code>TLS_RSA_WITH_AES_256_GCM_SHA384</code>) used in the session.  Wireshark 2.0.3 knows that cipher so I'm guessing this was run on RHEL.</p>
<p>To get the decryption working on RHEL you'll need to change the cipher being sent by the NETCONF server (or upgrade Wireshark's version--which you may not be able to do).</p>
<p>Decryption should work on Windows--we'd need to see the log file from that to know what's wrong there.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/52973/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>26 May '16, 14:54</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/e0564001bb7deb960d5d9d9c1e0ba074?s=32&amp;d=identicon&amp;r=g" alt="JeffMorriss's gravatar image" />
    <p><a href="/users/655/jeffmorriss">JeffMorriss ♦</a><br/>
    <span class="score" title="6219 reputation points"><span class="">6.2k</span></span><span title="5 badges"><span class="silver">&#9679;</span><span class="badgecount">5</span></span><span title="72 badges"><span class="bronze">&#9679;</span><span class="badgecount">72</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="JeffMorriss has 103 accepted answers">27&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-52973">
    
        <a name="52980"></a>
        <div class="comment" id="comment-52980">
            <div id="post-52980-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks Jeff !</p>

<p>Actually traffic is captured at Linux machine Centos 4.5.</p>

<p>On Linux :
After upgrading to 1.6.16 able to dessect TLS handshake message.
But unable to decrypt - Understand thats because of Unsupported Cipher used between client and server . Will check with dev to make use of another cipher for client server Transcations.</p>

<p>On my Windows 7 am trying to open the captured file from Linux,</p>

<p>Here on Windows:</p>

<p>Am upgraded to latest version 2.0.3.
But here TLS dissect itself getting failed . Hence i hope decryption wont happen.
At the same time with 2.0.3 am able dissect TLS traffic from my browser, like any https sites.</p>

<p>What might be the reason ?
I doubt the interface 'lo' on which handshake was captured.
But windows doesnt have 'lo' does it make any impact ?</p>

<p>Thanks Again,
Dhanish.</p></div>
            <div class="comment-info" id="comment-52980-info">
                
                
                
                

                

                <span class="comment-age">(26 May '16, 22:47)</span>
                <a class="comment-user userinfo" href="/users/24241/dhanish">dhanish</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-52973" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-52973-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="52984"></a>
                    <div id="answer-container-52984" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-52984-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/52984/up/" rel="nofollow"> </a>
<div id="post-52984-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-52984-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/52984/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>The server in both captures is on port 4444, so use "Decode as ..." to set tcp\4444 to be SSL.  The captures then dissect TLS 1.2 quite happily for me using 2.0.2 on Windows.</p>
<p>To decrypt the data you'll also need to use port 4444 in the RSA Keys list preference setting.</p>
<p>After you've set that, post the SSL debug log for the capture packet.pcap back here.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/52984/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>27 May '16, 02:35</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" alt="grahamb's gravatar image" />
    <p><a href="/users/1225/grahamb">grahamb ♦</a><br/>
    <span class="score" title="19834 reputation points"><span class="">19.8k</span></span><span title="3 badges"><span class="badge1">&#9679;</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">&#9679;</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">&#9679;</span><span class="badgecount">206</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="grahamb has 274 accepted answers">22&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-52984">
    
        <a name="52988"></a>
        <div class="comment" id="comment-52988">
            <div id="post-52988-score" class="comment-score"></div>
            <div class="comment-text"><p>I tried to decrypt with port 4444 but still not working.</p>

<p>but i feel in our case 39515 is TLS server port. Below is our scenario,</p>

<p>CALLHome/TLS Client(4444)                        CALLHome/TLS server(39515)
TCP is intiated &lt;------------------------------------------syn
------------------------------------------------------&gt;syn + ACK
&lt;--------------------------------------------------------- Ack
On Established TCP connection  client will initiate TLS connction with port 39515
----------------------------------------------------------&gt;client Hello</p>

<p>Dump i am unable to upload to cloudshark - getthing this error "Couldn't read capinfo from this file. Please make sure it is a file Wireshark can read." Not sure Why ?</p>

<p>Thanks Again,
Dhanish.</p></div>
            <div class="comment-info" id="comment-52988-info">
                
                
                
                

                

                <span class="comment-age">(27 May '16, 05:33)</span>
                <a class="comment-user userinfo" href="/users/24241/dhanish">dhanish</a>
                
            </div>
        </div>
    
        <a name="52991"></a>
        <div class="comment" id="comment-52991">
            <div id="post-52991-score" class="comment-score"></div>
            <div class="comment-text"><p>Nope, in that capture port 4444 is definitely the server, look at the directions of the packets only carrying a SYN, they are from ephemeral ports to 4444.</p>

<p>Just try it and you'll see TLS dissection.  Correct your RSA key setting and you should see decryption as well.</p>

<p>Note also the info on the <a href="https://wiki.wireshark.org/SSL#Key_File_format_conversion">SSL</a> Wiki page about PEM files and the private key.</p></div>
            <div class="comment-info" id="comment-52991-info">
                
                
                
                

                

                <span class="comment-age">(27 May '16, 05:52)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="52993"></a>
        <div class="comment" id="comment-52993">
            <div id="post-52993-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>Dump i am unable to upload to cloudshark - getthing this error "Couldn't read capinfo from this file. Please make sure it is a file Wireshark can read." Not sure Why ?</p>
</blockquote>

<p>Because Cloudshark accepts only files which contain packet captures, i.e. files which Wireshark itself can open. The ssl debug file you are trying to upload there is a plain text file so Cloudshark rejects it. So please publish it at some file sharing service (Google drive, Dropbox, ...), login-free, and provide a link to it here.</p></div>
            <div class="comment-info" id="comment-52993-info">
                
                
                
                

                

                <span class="comment-age">(27 May '16, 06:01)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="52994"></a>
        <div class="comment" id="comment-52994">
            <div id="post-52994-score" class="comment-score"></div>
            <div class="comment-text"><p>re the debug log, or add it to your question by editing the question and pasting the debug log contents.</p></div>
            <div class="comment-info" id="comment-52994-info">
                
                
                
                

                

                <span class="comment-age">(27 May '16, 06:05)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="53275"></a>
        <div class="comment" id="comment-53275">
            <div id="post-53275-score" class="comment-score"></div>
            <div class="comment-text"><p>Hi all,</p>

<p>I am continuing with the query which Dhanish have raised. Working for the same team.
We are having a packet captured with protocol encapsulation TCP--TLS--Netconf. we are trying to decrypt the packet, but not able to decrypt it.
Using the wireshark Version "Version 2.0.3 (v2.0.3-0-geed34f0 from master-2.0)"
For decrypting, what we did is:
a) Under Edit--&gt; preference --&gt;Selected Protocol 'SSL' --&gt; RSA Key List --&gt; EDIT --&gt; 
IP Address - 127.0.0.1
Port - 4444
Protocol - http
Key File - Path for Server.key.
But not able to decrypt the packet.</p>

<p>I am sharing the packet capture --&gt; <a href="https://drive.google.com/file/d/0B6pHYzndrgxScjd1VWNNMTR5NGM/view?usp=sharing">here</a>.</p>

<p>And also sharing the Key which we are using for Encryption, Sever.key --&gt; <a href="https://drive.google.com/open?id=0B6pHYzndrgxSQjItQzY5dFN3LXM">here</a>.</p>

<p>Please help me with Decryption.</p>

<p>Thanks,
Nancy.</p></div>
            <div class="comment-info" id="comment-53275-info">
                
                
                
                

                

                <span class="comment-age">(07 Jun '16, 05:49)</span>
                <a class="comment-user userinfo" href="/users/24365/nancy">Nancy</a>
                
            </div>
        </div>
    
        <a name="53278"></a>
        <div class="comment not_top_scorer" id="comment-53278">
            <div id="post-53278-score" class="comment-score"></div>
            <div class="comment-text"><p>For whoever understands it better than me but may not look for obvious things, the roles of client and server are swapped between TCP and TLS. The TCP session is initiated from client port 39975 to server port 4444, but the Client Hello packet is sent from server port 4444 to client port 39975 and Server Hello comes from the TCP client. But even defining 39975 as SSL port and relating the RSA key to it doesn't help Wireshark decipher the Application Data.</p></div>
            <div class="comment-info" id="comment-53278-info">
                
                
                
                

                

                <span class="comment-age">(07 Jun '16, 06:33)</span>
                <a class="comment-user userinfo" href="/users/19586/sindy">sindy</a>
                
            </div>
        </div>
    
        <a name="53280"></a>
        <div class="comment not_top_scorer" id="comment-53280">
            <div id="post-53280-score" class="comment-score"></div>
            <div class="comment-text"><p>Odd behaviour indeed, but looking at the SSL debug log I don't think the key is the correct one for the server certificate:</p>

<pre><code>KeyID[20]:
| 3b cd c0 07 7b a3 7d a1 f6 7b 24 b6 aa 38 14 61 |;...{.}..{$..8.a|
| 68 94 e4 06                                     |h...            |
ssl_load_key: swapping p and q parameters and recomputing u
ssl_init private key file C:/Users/graham.bloice/Downloads/server.key successfully loaded.
ssl_init port '39975' filename 'C:/Users/xxx/Downloads/server.key' password(only for p12 file) ''
association_add ssl.port port 39975 handle 04ABAAD8
</code></pre>

<p>...</p>

<pre><code>dissect_ssl enter frame #6 (first time)
packet_from_server: is from server - TRUE
  conversation = 068ADE78, ssl_session = 068AE4D8
  record: offset = 0, reported_length_remaining = 997
ssl_try_set_version found version 0x0303 -&gt; state 0x11
dissect_ssl3_record: content_type 22 Handshake
Calculating hash with offset 5 58
decrypt_ssl3_record: app_data len 58, ssl state 0x11
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 2 offset 5 length 54 bytes, remaining 63 
ssl_try_set_version found version 0x0303 -&gt; state 0x11
ssl_dissect_hnd_hello_common found SERVER RANDOM -&gt; state 0x13
ssl_dissect_hnd_srv_hello found CIPHER 0x009D TLS_RSA_WITH_AES_256_GCM_SHA384 -&gt; state 0x17
  record: offset = 63, reported_length_remaining = 934
dissect_ssl3_record: content_type 22 Handshake
Calculating hash with offset 68 878
decrypt_ssl3_record: app_data len 878, ssl state 0x17
packet_from_server: is from server - TRUE
decrypt_ssl3_record: using server decoder
decrypt_ssl3_record: no decoder available
dissect_ssl3_handshake iteration 1 type 11 offset 68 length 874 bytes, remaining 946 
lookup(KeyID)[20]:
| 4b 0b 80 88 a1 54 bc ee 75 94 cd 1e f1 4e 95 84 |K....T..u....N..|
| bd a0 4b 9c                                     |..K.            |
ssl_find_private_key_by_pubkey: lookup result: 00000000
</code></pre></div>
            <div class="comment-info" id="comment-53280-info">
                
                
                
                

                

                <span class="comment-age">(07 Jun '16, 06:47)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-52984" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 7
        </span>
        <a href="#" class="show-all-comments-link">show 2 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-52984-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/52942/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='TvySlf8xbhgX1XP7anWCQ88ftY0j77H0' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/52942/unable-dissect-tls-handshake-messages?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/52942/unable-dissect-tls-handshake-messages?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/dissector/"
            class="tag-link-dissector"
            title="see questions tagged'dissector'using tags"
            rel="tag">dissector</a> <span class="tag-number">&#215;637</span><br/>
        
    </p>
    <p>
        question asked: <strong title="May 26, 2016, 12:55 a.m.">26 May '16, 00:55</strong>
    </p>
    <p> 
     	question was seen: <strong>3,772 times</strong>
    </p>
    <p> 
        last updated: <strong title="June 7, 2016, 6:47 a.m.">07 Jun '16, 06:47</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/480/how-the-protocol-hierarchy-statistics-works">How the Protocol Hierarchy Statistics works?</a>
        </p>
        
        <p>
            <a href="/questions/2099/can-i-have-two-separate-builds-of-wireshark-running-on-my-ubuntu">can i have two separate builds of wireshark running on my ubuntu?</a>
        </p>
        
        <p>
            <a href="/questions/3553/building-rpm">building rpm</a>
        </p>
        
        <p>
            <a href="/questions/4797/dissector-debugging-how-to-find-the-exact-line-of-a-malformed-packet-exception">dissector debugging -- how to find the exact line of a &quot;malformed packet&quot; exception</a>
        </p>
        
        <p>
            <a href="/questions/5867/what-is-the-best-way-to-track-data-between-packets-during-dissection">What is the best way to track data between packets during dissection?</a>
        </p>
        
        <p>
            <a href="/questions/6957/adding-to-tree">Adding to tree</a>
        </p>
        
        <p>
            <a href="/questions/8629/rtp-header-extension-in-lua">RTP Header extension in Lua</a>
        </p>
        
        <p>
            <a href="/questions/9171/heuristic-dissector-leaves-data-on-protocol-tree">[closed] Heuristic Dissector leaves &quot;data&quot; on protocol tree</a>
        </p>
        
        <p>
            <a href="/questions/11124/support-for-g8032v2">support for g8032v2</a>
        </p>
        
        <p>
            <a href="/questions/12921/how-to-get-source-ip-address">How to get source IP address?</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
