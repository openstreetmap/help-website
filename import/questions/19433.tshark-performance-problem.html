<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Tshark performance problem - Wireshark Q&amp;A</title>
        <meta name="description" content="I execute tshark command. Process is too slow. Sometimes take more than 6-7 seconds. Pcap file is really small (~500bytes). Actually strange thing is that re-execute same command consequently, process duration is decreasing dramatically (about 1 second). After wait for a while (without execution com..." />
        <meta name="keywords" content="performance,tshark" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/19433/tshark-performance-problem" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/19433/tshark-performance-problem?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='w4wTbbjXgcUNRmcMiAr7hFPxXdGH2tQC' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/19433/tshark-performance-problem">Tshark performance problem</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-19433-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/19433/up/" rel="nofollow"> </a>
<div id="post-19433-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-19433-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/19433/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/19433/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>I execute tshark command. Process is too slow. Sometimes take more than 6-7 seconds. Pcap file is really small (~500bytes). Actually strange thing is that re-execute same command consequently, process duration is decreasing dramatically (about 1 second). After wait for a while (without execution command), re-run same command and process completion duration increase again. Why process behave like that? How to solve this problem?</p>
<p>Command : </p>
<pre><code>tshark -ta -r test.pcap
</code></pre>
<p>OS Details :</p>
<pre><code>SunOS er 5.10 Generic_147441-01 i86pc i386 i86pc
</code></pre>
<p>Thanks</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/performance/" class="post-tag tag-link-performance"
                                        title="see questions tagged 'performance'" rel="tag">performance</a>
                                
                                    <a href="/tags/tshark/" class="post-tag tag-link-tshark"
                                        title="see questions tagged 'tshark'" rel="tag">tshark</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>13 Mar '13, 02:32</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/ffe99b05b3063ba35b43aeca99292479?s=32&amp;d=identicon&amp;r=g" alt="erdinc's gravatar image" />
    <p><a href="/users/4557/erdinc">erdinc</a><br/>
    <span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">&#9679;</span><span class="badgecount">3</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="erdinc has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-19433">
    
</div>
<div id="comment-tools-19433" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-19433-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    2 Answers:
                    </div>
                    
<div class="tabsA"><a href="/questions/19433/tshark-performance-problem?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/19433/tshark-performance-problem?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/19433/tshark-performance-problem?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/19433/tshark-performance-problem?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="19440"></a>
                    <div id="answer-container-19440" class="answer accepted-answer">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-19440-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/19440/up/" rel="nofollow"> </a>
<div id="post-19440-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-19440-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/19440/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="grahamb has selected this answer as the correct answer"
        href="/accept_answer/19440/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <blockquote>
<p>Actually strange thing is that re-execute same command consequently, process duration is decreasing dramatically (about 1 second)</p>
</blockquote>
<p>That's most certainly due to DNS resolving. The seconds time it runs faster due to DNS caching. Please use option '-n' and tshark should run faster.</p>
<blockquote>
<p><code>tshark -ta -n -r test.pcap</code></p>
</blockquote>
<p>If that does not help try this:</p>
<blockquote>
<p><code>tshark -ta -r test.pcap -o name_resolve:FALSE</code></p>
</blockquote>
<p>Regards<br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/19440/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>13 Mar '13, 04:30</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/19440/">
                edited
                <strong>13 Mar '13, 04:31</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-19440">
    
        <a name="19442"></a>
        <div class="comment" id="comment-19442">
            <div id="post-19442-score" class="comment-score"></div>
            <div class="comment-text"><p>Both of options does not solve my problem. Tshark behaviour is not changed.</p></div>
            <div class="comment-info" id="comment-19442-info">
                
                
                
                

                

                <span class="comment-age">(13 Mar '13, 04:56)</span>
                <a class="comment-user userinfo" href="/users/4557/erdinc">erdinc</a>
                
            </div>
        </div>
    
        <a name="19483"></a>
        <div class="comment" id="comment-19483">
            <div id="post-19483-score" class="comment-score"></div>
            <div class="comment-text"><p>what is you tshark version (tshark -v)?</p>

<p>Can you please add the output of the following command for the first call (long run time) and the second call (short run time)?</p>

<p>Case #1: <br>
</p>

<blockquote>
<p><code>truss -a -d -e -f -o /var/tmp/tshark_case1.out tshark -ta -r test.pcap</code><br>
</p>
</blockquote>

<p>Case #2:<br>
</p>

<blockquote>
<p><code>truss -a -d -e -f -o /var/tmp/tshark_case2.out tshark -ta -r test.pcap</code><br>
</p>
</blockquote>

<p>Please post the content of the files tshark_case1.out and tshark_case2.out somewhere.</p></div>
            <div class="comment-info" id="comment-19483-info">
                
                
                
                

                

                <span class="comment-age">(13 Mar '13, 16:49)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="19925"></a>
        <div class="comment" id="comment-19925">
            <div id="post-19925-score" class="comment-score"></div>
            <div class="comment-text"><p>I did your test, Biggest differences is at brk function. brk function consume lots of time. Output files link is below. 
 <a href="http://www.speedyshare.com/AwzRh/tshark.rar">http://www.speedyshare.com/AwzRh/tshark.rar</a>
What is wrong about memory (brk), why brk need to time, how to resolve it?</p></div>
            <div class="comment-info" id="comment-19925-info">
                
                
                
                

                

                <span class="comment-age">(29 Mar '13, 01:55)</span>
                <a class="comment-user userinfo" href="/users/4557/erdinc">erdinc</a>
                
            </div>
        </div>
    
        <a name="20024"></a>
        <div class="comment" id="comment-20024">
            <div id="post-20024-score" class="comment-score"></div>
            <div class="comment-text"><p>As far as I know, brk() is used my malloc() to expand the programs heap. However, I have no idea why it takes that much longer in case #1 (first load) than in case #3 (second load). </p>

<p>Can you please post the output of the command 'limit' or 'ulimit -a' (whatever works)?</p></div>
            <div class="comment-info" id="comment-20024-info">
                
                
                
                

                

                <span class="comment-age">(02 Apr '13, 10:08)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="20041"></a>
        <div class="comment" id="comment-20041">
            <div id="post-20041-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>ulimit -a<br>
<br>
core file size          (blocks, -c) unlimited<br>
data seg size           (kbytes, -d) unlimited<br>
file size               (blocks, -f) unlimited<br>
open files                      (-n) 256<br>
pipe size            (512 bytes, -p) 10<br>
stack size              (kbytes, -s) 10240<br>
cpu time               (seconds, -t) unlimited<br>
max user processes              (-u) 27493<br>
virtual memory          (kbytes, -v) unlimited<br></p>
</blockquote></div>
            <div class="comment-info" id="comment-20041-info">
                
                
                
                

                

                <span class="comment-age">(03 Apr '13, 03:02)</span>
                <a class="comment-user userinfo" href="/users/4557/erdinc">erdinc</a>
                
            </div>
        </div>
    
        <a name="20046"></a>
        <div class="comment not_top_scorer" id="comment-20046">
            <div id="post-20046-score" class="comment-score"></div>
            <div class="comment-text"><p>can you please try to increase the stack size (ulimit -s) and see if that changes anything?</p></div>
            <div class="comment-info" id="comment-20046-info">
                
                
                
                

                

                <span class="comment-age">(03 Apr '13, 03:28)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="20051"></a>
        <div class="comment not_top_scorer" id="comment-20051">
            <div id="post-20051-score" class="comment-score"></div>
            <div class="comment-text"><p>I set stack size to 100.000 (increase 10 times), result is same.</p></div>
            <div class="comment-info" id="comment-20051-info">
                
                
                
                

                

                <span class="comment-age">(03 Apr '13, 06:27)</span>
                <a class="comment-user userinfo" href="/users/4557/erdinc">erdinc</a>
                
            </div>
        </div>
    
        <a name="20053"></a>
        <div class="comment not_top_scorer" id="comment-20053">
            <div id="post-20053-score" class="comment-score"></div>
            <div class="comment-text"><p>Hm.. looks like there is 'something' on your system that makes memory reallocation slow for the first time (brk calls) and faster for consecutive calls. Could be a specific behavior of the solaris memory management or just a specific behavior of your installation, like a large memory consumption on the system and thus swapping. Are there any processes that consume large amounts of memory (output of 'top' and 'swapon -s')? </p>

<p>I googled for slow brk() calls, but was unable to find something interesting. Can you please check my assumption about memory usage (above).</p></div>
            <div class="comment-info" id="comment-20053-info">
                
                
                
                

                

                <span class="comment-age">(03 Apr '13, 07:02)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="20064"></a>
        <div class="comment not_top_scorer" id="comment-20064">
            <div id="post-20064-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes, system use most of memory. 12 GB memory is installed. Top command says %63 percentage is used. Only one process is about half of total memory consuming. 
I observe similar behaviour at windows machine, I guess differences is not as big as at solaris</p></div>
            <div class="comment-info" id="comment-20064-info">
                
                
                
                

                

                <span class="comment-age">(03 Apr '13, 10:11)</span>
                <a class="comment-user userinfo" href="/users/4557/erdinc">erdinc</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-19440" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 9
        </span>
        <a href="#" class="show-all-comments-link">show 4 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-19440-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                    <a name="19445"></a>
                    <div id="answer-container-19445" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-19445-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/19445/up/" rel="nofollow"> </a>
<div id="post-19445-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-19445-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/19445/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>How much time a process takes is dependent on a lot of things. It looks like your initial tshark execution is taking more time because of disk IO. The second time you run tshark it will be faster since it will have cached things in memory. When you run tshark for the 3rd time after waiting a while, the cache will have flushed your data from cache and will need to re-read it from disk (or the network in case of NFS, iSCSI, etc).</p>
<p>You can check this by using the "time" utility, although I'm not sure what options you have with it on solaris. But on my OSX I get the following:</p>
<pre><code>$ /usr/bin/time -l tshark -ta -r bug4716.cap 
  1 14:41:28.843078     10.0.0.1 -&gt; 10.0.0.1     TCP 62 swrmi &gt; EtherNet-IP-1 [SYN] Seq=0 Win=65535 [TCP CHECKSUM INCORRECT] Len=0 MSS=1460 SACK_PERM=1
  2 14:41:29.169626     10.0.0.1 -&gt; 10.0.0.1     TCP 60 swrmi &gt; EtherNet-IP-1 [ACK] Seq=1 Ack=1 Win=65535 [TCP CHECKSUM INCORRECT] Len=0
  3 14:41:29.712539     10.0.0.1 -&gt; 10.0.0.1     TCP 93 swrmi &gt; EtherNet-IP-1 [PSH, ACK] Seq=1 Ack=1 Win=65535 [TCP CHECKSUM INCORRECT] Len=39
  4 14:41:30.203991     10.0.0.1 -&gt; 10.0.0.1     TCP 119 swrmi &gt; EtherNet-IP-1 [PSH, ACK] Seq=40 Ack=1 Win=65535 [TCP CHECKSUM INCORRECT] Len=65
  5 14:41:32.235725     10.0.0.1 -&gt; 10.0.0.1     TCP 60 swrmi &gt; EtherNet-IP-1 [PSH, ACK] Seq=105 Ack=2 Win=65534 [TCP CHECKSUM INCORRECT] Len=1
        1.21 real         0.22 user         0.20 sys
  88346624  maximum resident set size
         0  average shared memory size
         0  average unshared data size
         0  average unshared stack size
     22420  page reclaims
         0  page faults
         0  swaps
        55  block input operations
        34  block output operations
         0  messages sent
         0  messages received
         0  signals received
       161  voluntary context switches
        21  involuntary context switches
$ /usr/bin/time -l tshark -ta -r bug4716.cap 
  1 14:41:28.843078     10.0.0.1 -&gt; 10.0.0.1     TCP 62 swrmi &gt; EtherNet-IP-1 [SYN] Seq=0 Win=65535 [TCP CHECKSUM INCORRECT] Len=0 MSS=1460 SACK_PERM=1
  2 14:41:29.169626     10.0.0.1 -&gt; 10.0.0.1     TCP 60 swrmi &gt; EtherNet-IP-1 [ACK] Seq=1 Ack=1 Win=65535 [TCP CHECKSUM INCORRECT] Len=0
  3 14:41:29.712539     10.0.0.1 -&gt; 10.0.0.1     TCP 93 swrmi &gt; EtherNet-IP-1 [PSH, ACK] Seq=1 Ack=1 Win=65535 [TCP CHECKSUM INCORRECT] Len=39
  4 14:41:30.203991     10.0.0.1 -&gt; 10.0.0.1     TCP 119 swrmi &gt; EtherNet-IP-1 [PSH, ACK] Seq=40 Ack=1 Win=65535 [TCP CHECKSUM INCORRECT] Len=65
  5 14:41:32.235725     10.0.0.1 -&gt; 10.0.0.1     TCP 60 swrmi &gt; EtherNet-IP-1 [PSH, ACK] Seq=105 Ack=2 Win=65534 [TCP CHECKSUM INCORRECT] Len=1
        0.56 real         0.22 user         0.19 sys
  88346624  maximum resident set size
         0  average shared memory size
         0  average unshared data size
         0  average unshared stack size
     22420  page reclaims
         0  page faults
         0  swaps
         0  block input operations
         2  block output operations
         0  messages sent
         0  messages received
         0  signals received
       106  voluntary context switches
       338  involuntary context switches
$
</code></pre>
<p>Please note the block input/output operations and also the "involuntary context switches" which are caused by other processes (and which could contribute to extra load time if the system is heavily loaded).</p>
<p>As you can see, the sys and user time are about the same for both executions, but the real time differs because of time spent waiting on the disk and/or other processes.</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/19445/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>13 Mar '13, 06:06</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/7901a94d8fdd1f9f47cda9a32fcfa177?s=32&amp;d=identicon&amp;r=g" alt="SYN-bit's gravatar image" />
    <p><a href="/users/5/syn-bit">SYN-bit ♦♦</a><br/>
    <span class="score" title="17094 reputation points"><span class="">17.1k</span></span><span title="9 badges"><span class="badge1">&#9679;</span><span class="badgecount">9</span></span><span title="57 badges"><span class="silver">&#9679;</span><span class="badgecount">57</span></span><span title="245 badges"><span class="bronze">&#9679;</span><span class="badgecount">245</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="SYN-bit has 174 accepted answers">20&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-19445">
    
        <a name="19447"></a>
        <div class="comment" id="comment-19447">
            <div id="post-19447-score" class="comment-score"></div>
            <div class="comment-text"><p>I execute commands with time, my result is below. I can inference that slowness is not about tshark, because of slowness of computer. Is this assumption true? 
Another question (but not primarely important) Involuntary context switches can cause "real" time is big but waiting disc IO operations should be in "sys" time?
real        2.6
user        0.1
sys         0.0</p></div>
            <div class="comment-info" id="comment-19447-info">
                
                
                
                

                

                <span class="comment-age">(13 Mar '13, 06:43)</span>
                <a class="comment-user userinfo" href="/users/4557/erdinc">erdinc</a>
                
            </div>
        </div>
    
        <a name="19453"></a>
        <div class="comment" id="comment-19453">
            <div id="post-19453-score" class="comment-score"></div>
            <div class="comment-text"><p>user and sys time only refer to time spent on the CPU, not time waiting on disk.</p>

<p>Have a look at <a href="http://stackoverflow.com/questions/556405/what-do-real-user-and-sys-mean-in-the-output-of-time1">http://stackoverflow.com/questions/556405/what-do-real-user-and-sys-mean-in-the-output-of-time1</a></p></div>
            <div class="comment-info" id="comment-19453-info">
                
                
                
                

                

                <span class="comment-age">(13 Mar '13, 07:53)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="19456"></a>
        <div class="comment" id="comment-19456">
            <div id="post-19456-score" class="comment-score"></div>
            <div class="comment-text"><p>I checked with DTrace script that calculate system call duration (below link).Total sys call duration is less than 0.1 second but all process is completed in 5 seconds. 
If I am correct, this dtrace script accumulate all context swiches and I/O operation durations. There should be another reason why tshark is completed &gt;4 seconds.</p>

<p><a href="http://www.brendangregg.com/DTrace/procsystime">http://www.brendangregg.com/DTrace/procsystime</a></p></div>
            <div class="comment-info" id="comment-19456-info">
                
                
                
                

                

                <span class="comment-age">(13 Mar '13, 08:25)</span>
                <a class="comment-user userinfo" href="/users/4557/erdinc">erdinc</a>
                
            </div>
        </div>
    
        <a name="19482"></a>
        <div class="comment" id="comment-19482">
            <div id="post-19482-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>Pcap file is really small (~500bytes).</p>
</blockquote>

<p>disk I/O and context switches as problem source for a <strong>500 byte</strong> file? No way .. ;-))</p>

<p>There must be another reason, apparently some caching (DNS, filesystem, etc.)</p>

<p><a href="/users/4557/erdinc"></a><a href="/users/4557/erdinc">@erdinc</a>: Do you start tshark from an NFS mounted filesystem (<a href="/users/5/syn-bit"></a><a href="/users/5/syn-bit">@SYN-bit</a> mentioned it)?</p></div>
            <div class="comment-info" id="comment-19482-info">
                
                
                
                

                

                <span class="comment-age">(13 Mar '13, 16:39)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="19495"></a>
        <div class="comment" id="comment-19495">
            <div id="post-19495-score" class="comment-score"></div>
            <div class="comment-text"><p>There is no any NFS mounting point on my system. If it helps to identify problem, mysql server is running and heavily used disc. iostat tells that %b around %50.</p></div>
            <div class="comment-info" id="comment-19495-info">
                
                
                
                

                

                <span class="comment-age">(14 Mar '13, 05:09)</span>
                <a class="comment-user userinfo" href="/users/4557/erdinc">erdinc</a>
                
            </div>
        </div>
    
        <a name="19497"></a>
        <div class="comment not_top_scorer" id="comment-19497">
            <div id="post-19497-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>disk I/O and context switches as
problem source for a 500 byte file? No
way .. ;-))</p>
</blockquote>

<p>Well, I was not worried about the 500 byte file :-), but was thinking about the tshark executable and access to all the supporting files...</p>

<p>That the disk is 50% busy seems OK, but how about the "wait" and "%w" columns?</p></div>
            <div class="comment-info" id="comment-19497-info">
                
                
                
                

                

                <span class="comment-age">(14 Mar '13, 05:23)</span>
                <a class="comment-user userinfo" href="/users/5/syn-bit">SYN-bit ♦♦</a>
                
            </div>
        </div>
    
        <a name="19501"></a>
        <div class="comment not_top_scorer" id="comment-19501">
            <div id="post-19501-score" class="comment-score"></div>
            <div class="comment-text"><p>wait("w") is always zero.</p></div>
            <div class="comment-info" id="comment-19501-info">
                
                
                
                

                

                <span class="comment-age">(14 Mar '13, 06:05)</span>
                <a class="comment-user userinfo" href="/users/4557/erdinc">erdinc</a>
                
            </div>
        </div>
    
        <a name="19692"></a>
        <div class="comment not_top_scorer" id="comment-19692">
            <div id="post-19692-score" class="comment-score"></div>
            <div class="comment-text"><p>can you please add the truss output? (see the comment in my answer)...</p></div>
            <div class="comment-info" id="comment-19692-info">
                
                
                
                

                

                <span class="comment-age">(20 Mar '13, 11:13)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-19445" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 8
        </span>
        <a href="#" class="show-all-comments-link">show 3 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-19445-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/19433/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='w4wTbbjXgcUNRmcMiAr7hFPxXdGH2tQC' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/19433/tshark-performance-problem?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/19433/tshark-performance-problem?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/tshark/"
            class="tag-link-tshark"
            title="see questions tagged'tshark'using tags"
            rel="tag">tshark</a> <span class="tag-number">&#215;832</span><br/>
        
        <a href="/tags/performance/"
            class="tag-link-performance"
            title="see questions tagged'performance'using tags"
            rel="tag">performance</a> <span class="tag-number">&#215;55</span><br/>
        
    </p>
    <p>
        question asked: <strong title="March 13, 2013, 2:32 a.m.">13 Mar '13, 02:32</strong>
    </p>
    <p> 
     	question was seen: <strong>5,649 times</strong>
    </p>
    <p> 
        last updated: <strong title="April 3, 2013, 10:11 a.m.">03 Apr '13, 10:11</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/50948/automate-network-performance-data-collection">automate network performance data collection</a>
        </p>
        
        <p>
            <a href="/questions/63178/tshark-follow-tcp-flow-for-a-400m-pcap-file-extremely-slow">tshark follow tcp flow for a 400M pcap file extremely slow</a>
        </p>
        
        <p>
            <a href="/questions/45630/tshark-running-multiple-instances-vs-one">Tshark - Running multiple instances vs one</a>
        </p>
        
        <p>
            <a href="/questions/36598/impact-of-packet-capture">impact of packet capture</a>
        </p>
        
        <p>
            <a href="/questions/39163/tshark-command-to-find-answer-field-in-dns-query-response-with-more-than-1-answer-rrs">tshark command to find answer field in dns query response with more than 1 answer RRs</a>
        </p>
        
        <p>
            <a href="/questions/62/static-tshark-builds-for-linux-andor-solaris-sparcx64">static tshark builds for linux and/or solaris sparc/x64</a>
        </p>
        
        <p>
            <a href="/questions/1670/tshark-hex-dump">tshark hex dump</a>
        </p>
        
        <p>
            <a href="/questions/3479/could-the-file-name-parameter-in-tshark-be-chinese-characters">could the file name parameter in tshark be chinese characters?</a>
        </p>
        
        <p>
            <a href="/questions/5132/write-gzip-encoded-http-as-inflated-in-pcap-file">Write Gzip Encoded HTTP as Inflated in PCAP File</a>
        </p>
        
        <p>
            <a href="/questions/6488/use-tshark-to-analyze-source-and-destination-ips-from-dumpfile">Use tshark to analyze source and destination IPs from dumpfile?</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
