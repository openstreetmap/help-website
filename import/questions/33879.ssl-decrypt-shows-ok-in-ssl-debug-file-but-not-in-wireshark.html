<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>SSL decrypt shows ok in SSL debug file but not in Wireshark - Wireshark Q&amp;A</title>
        <meta name="description" content="I followed the instuctions provided under the &quot;Complete walk through&quot; section in http://wiki.wireshark.org/SSL After the SSL handshake the GET request (frame #10) dispays in plain text in Wireshark, but the server response (frame #11) is displayed as &quot;Encrypted Application Data&quot;. However, the SSL de..." />
        <meta name="keywords" content="ssl_decrypt" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/33879/ssl-decrypt-shows-ok-in-ssl-debug-file-but-not-in-wireshark" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/33879/ssl-decrypt-shows-ok-in-ssl-debug-file-but-not-in-wireshark?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='PBlwyewq2OET9zvHOjwWOcNYie2B1f7L' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/33879/ssl-decrypt-shows-ok-in-ssl-debug-file-but-not-in-wireshark">SSL decrypt shows ok in SSL debug file but not in Wireshark</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-33879-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/33879/up/" rel="nofollow"> </a>
<div id="post-33879-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-33879-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/33879/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/33879/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>I followed the instuctions provided under the "Complete walk through" section in <a href="http://wiki.wireshark.org/SSL">http://wiki.wireshark.org/SSL</a>
After the SSL handshake the GET request (frame #10) dispays in plain text in Wireshark, but the server response (frame #11) is displayed as "Encrypted Application Data". However, the SSL debug file shows the successful decryption for that same frame.
Any idea what I'm doing wrong here?
Thanks in advance.</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/ssl_decrypt/" class="post-tag tag-link-ssl_decrypt"
                                        title="see questions tagged 'ssl_decrypt'" rel="tag">ssl_decrypt</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>16 Jun '14, 22:10</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/f134d8267729bbc8c9667ce56b225b91?s=32&amp;d=identicon&amp;r=g" alt="PotRoast's gravatar image" />
    <p><a href="/users/7531/potroast">PotRoast</a><br/>
    <span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">&#9679;</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">&#9679;</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">&#9679;</span><span class="badgecount">3</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="PotRoast has no accepted answers">0&#37;</span>
    </p>
</div>


                            </div>
                            




<div class="comments-container" id="comments-container-33879">
    
        <a name="33881"></a>
        <div class="comment" id="comment-33881">
            <div id="post-33881-score" class="comment-score"></div>
            <div class="comment-text"><p>In Wireshark click Edit&gt;Preferences…</p>

<p>Select and expand Protocols, scroll down (or just type ssl) and select SSL</p>

<p>Click the RSA Keys List Edit… button, click New and then enter the following information;</p>

<p>■IP Address is the IP address of the host that holds the private key used to decrypt the data and serves the certificate (i.e. the decrypting host, the server)
■Port is the destination port used to communicate with the host that holds the private key used to decrypt the data and serves the certificate (enter Port used for ssl ideally 443)
■Protocol is the upper-layer protocol encrypted by SSL/TLS, for instance, the protocol encrypted over a HTTPS web connection is HTTP(Type HTTP)
■Key File – select as necessary
■Password is the passphrase used to protect the private key file, if any (Can be put blank)</p>

<p>IMP notes : 
■The private key file must be in the PEM or PKCS12 format; if it’s not you can use OpenSSL to convert what you have as appropriate, just Google it.
■The private key file should only contain the private key, not the public key (aka the certificate). Files frequently contain both, check by viewing the file in a true text editor. You only need the text delimited by this; 
Header:
—–BEGIN RSA PRIVATE KEY—–
Footer:
—–END RSA PRIVATE KEY—–
■The capture must include both ‘sides’ of a conversation. In other words, the capture must include the full client and server exchange.
■The capture must include the initial SSL/TLS session establishment. In other words, the CLIENTHELLO and SERVERHELLO exchange. Beware captures taken where a session has been resumed. Ideally, ensure any capture either a) is of packets related to an entirely new device connecting or b) where a device that has already previously established a session is used, it is used after a considerable time after the last session was established.
■Ensure the use of a Diffie-Hellman Ephemeral (DHE/EDH) or RSA Ephemeral cipher suite is not negotiated between the two hosts. This is indicated by the use of a ServerKeyExchange message. There is no way to decrypt data where ephemeral ciphers are used.</p></div>
            <div class="comment-info" id="comment-33881-info">
                
                
                
                

                

                <span class="comment-age">(16 Jun '14, 23:28)</span>
                <a class="comment-user userinfo" href="/users/4851/kishan-pandey">kishan pandey</a>
                
            </div>
        </div>
    
        <a name="33902"></a>
        <div class="comment" id="comment-33902">
            <div id="post-33902-score" class="comment-score"></div>
            <div class="comment-text"><p>what is your</p>

<ul>
<li>OS and OS version</li>
<li>Wireshark version</li>
</ul>

<p>can you please post the SSL debug file (in total, not just the lines for frame #11)?</p></div>
            <div class="comment-info" id="comment-33902-info">
                
                
                
                

                

                <span class="comment-age">(17 Jun '14, 11:55)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="33974"></a>
        <div class="comment" id="comment-33974">
            <div id="post-33974-score" class="comment-score"></div>
            <div class="comment-text"><p>Here's the follow-up infomration ...</p>

<ol>
<li>Packet Capture file <a href="https://drive.google.com/file/d/0BwNG6bK8noRIVW5QZlhIWVR5MEk/edit?usp=sharing">https://drive.google.com/file/d/0BwNG6bK8noRIVW5QZlhIWVR5MEk/edit?usp=sharing</a></li>
<li>Wireshark decrypt debug file <a href="https://drive.google.com/file/d/0BwNG6bK8noRIYkE2QkxSV2U5V1E/edit?usp=sharing">https://drive.google.com/file/d/0BwNG6bK8noRIYkE2QkxSV2U5V1E/edit?usp=sharing</a></li>
<li>Screen shot of Wireshark previous to decrypt <a href="https://drive.google.com/file/d/0BwNG6bK8noRIazN2LVY0bFRFb0k/edit?usp=sharing">https://drive.google.com/file/d/0BwNG6bK8noRIazN2LVY0bFRFb0k/edit?usp=sharing</a></li>
<li>Screen shot of Wireshark with debug info configured as specified above and in the Wireshire SSL page <a href="https://drive.google.com/file/d/0BwNG6bK8noRISjlwclljVTNKRUE/edit?usp=sharing">https://drive.google.com/file/d/0BwNG6bK8noRISjlwclljVTNKRUE/edit?usp=sharing</a></li>
<li>PEM file used for decryption (don't worry, this is a throw-away private key that I don't use other than this exercise). <a href="https://drive.google.com/file/d/0BwNG6bK8noRIRUxJcUJHRHJsS0E/edit?usp=sharing">https://drive.google.com/file/d/0BwNG6bK8noRIRUxJcUJHRHJsS0E/edit?usp=sharing</a></li>
</ol>

<p>The frame I'm most interested in is frame #11. The debug log file shows the encrypted and decrypted (plain text) data, so I'm confident that Wireshark can do the decryption, but is still shows as encrypted in the Wireshark app.</p></div>
            <div class="comment-info" id="comment-33974-info">
                
                
                
                

                

                <span class="comment-age">(19 Jun '14, 23:12)</span>
                <a class="comment-user userinfo" href="/users/7531/potroast">PotRoast</a>
                
            </div>
        </div>
    
        <a name="33975"></a>
        <div class="comment" id="comment-33975">
            <div id="post-33975-score" class="comment-score"></div>
            <div class="comment-text"><p>I'm wondering if this issue has anything to do with the TLS version and cipher suite:
TLSv1.2
Cipher Suite: TLS_RSA_WITH_AES_256_CBC_SHA (0x0035)
although the log file show successful decryption so I'm at a loss.
Thanks in advance for help.</p></div>
            <div class="comment-info" id="comment-33975-info">
                
                
                
                

                

                <span class="comment-age">(19 Jun '14, 23:19)</span>
                <a class="comment-user userinfo" href="/users/7531/potroast">PotRoast</a>
                
            </div>
        </div>
    
        <a name="33976"></a>
        <div class="comment" id="comment-33976">
            <div id="post-33976-score" class="comment-score">1</div>
            <div class="comment-text"><p>I decrypted it,Find below the steps performed,
1) entered  4433 in ssl port list ( preference - http - ssl)
2) under Preferencec -HTTP - Uncheck "HTTP header spanning multiple  tcp segments"</p></div>
            <div class="comment-info" id="comment-33976-info">
                
                
                
                

                

                <span class="comment-age">(20 Jun '14, 00:00)</span>
                <a class="comment-user userinfo" href="/users/4851/kishan-pandey">kishan pandey</a>
                
            </div>
        </div>
    
        <a name="33979"></a>
        <div class="comment not_top_scorer" id="comment-33979">
            <div id="post-33979-score" class="comment-score"></div>
            <div class="comment-text"><p>FYI ... here is the version of Wireshark I'm using on Ubunutu 14.04 </p>

<p>wireshark --version</p>

<p>wireshark 1.10.6 (v1.10.6 from master-1.10)</p>

<p>Copyright 1998-2014 Gerald Combs <a href="/cdn-cgi/l/email-protection#11767463707d755166786374627970637a3f7e6376"><span class="__cf_email__" data-cfemail="a1c6c4d3c0cdc5e1d6c8d3c4d2c9c0d3ca8fced3c6">[email&#160;protected]</span></a> and contributors.
This is free software; see the source for copying conditions. There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p>

<p>Compiled (64-bit) with GTK+ 3.10.7, with Cairo 1.13.1, with Pango 1.36.1, with
GLib 2.39.91, with libpcap, with libz 1.2.8, with POSIX capabilities (Linux),
without libnl, with SMI 0.4.8, with c-ares 1.10.0, with Lua 5.2, without Python,
with GnuTLS 2.12.23, with Gcrypt 1.5.3, with MIT Kerberos, with GeoIP, with
PortAudio V19-devel (built Feb 25 2014 21:09:53), with AirPcap.</p>

<p>Running on Linux 3.13.0-29-generic, with locale en_US.UTF-8, with libpcap
version 1.5.3, with libz 1.2.8, GnuTLS 2.12.23, Gcrypt 1.5.3, without AirPcap.
Intel(R) Core(TM)2 CPU          4300  @ 1.80GHz</p>

<p>Built using gcc 4.8.2.</p></div>
            <div class="comment-info" id="comment-33979-info">
                
                
                
                

                

                <span class="comment-age">(20 Jun '14, 00:31)</span>
                <a class="comment-user userinfo" href="/users/7531/potroast">PotRoast</a>
                
            </div>
        </div>
    
        <a name="34013"></a>
        <div class="comment not_top_scorer" id="comment-34013">
            <div id="post-34013-score" class="comment-score"></div>
            <div class="comment-text"><p>also, here are the contents of the Wireshark ssl_keys file:</p>

<p>"127.0.0.1","4433","http","/home/doug/temp/ssl/server.pem",""</p></div>
            <div class="comment-info" id="comment-34013-info">
                
                
                
                

                

                <span class="comment-age">(21 Jun '14, 00:48)</span>
                <a class="comment-user userinfo" href="/users/7531/potroast">PotRoast</a>
                
            </div>
        </div>
    
        <a name="34016"></a>
        <div class="comment not_top_scorer" id="comment-34016">
            <div id="post-34016-score" class="comment-score"></div>
            <div class="comment-text"><p>thanks kishan, but I'm still getting the same result.
Here at my HTTP setting from the Wireshark preferences file:</p>

<p>#http.dechunk_body: TRUE <br>
#http.decompress_body: TRUE<br>
#http.desegment_body: TRUE<br>
http.desegment_headers: FALSE<br>
http.ssl.port: 443,4433<br>
#http.tcp.port: 80,3128,3132,5985,8080,8088,11371,1900,2869,2710<br>
</p>

<p>any suggestions?</p></div>
            <div class="comment-info" id="comment-34016-info">
                
                
                
                

                

                <span class="comment-age">(21 Jun '14, 14:45)</span>
                <a class="comment-user userinfo" href="/users/7531/potroast">PotRoast</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-33879" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 8
        </span>
        <a href="#" class="show-all-comments-link">show 3 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-33879-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/33879/ssl-decrypt-shows-ok-in-ssl-debug-file-but-not-in-wireshark?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/33879/ssl-decrypt-shows-ok-in-ssl-debug-file-but-not-in-wireshark?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/33879/ssl-decrypt-shows-ok-in-ssl-debug-file-but-not-in-wireshark?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/33879/ssl-decrypt-shows-ok-in-ssl-debug-file-but-not-in-wireshark?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="34019"></a>
                    <div id="answer-container-34019" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-34019-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/34019/up/" rel="nofollow"> </a>
<div id="post-34019-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-34019-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/34019/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>If you look at your ssl debug file, you will see, that Wireshark <strong>was able</strong> to decrypt the frame!</p>
<pre> 77 d0 0b cc 59 fd b2 bc 61 1d 7f 1c 17 f1 75 f1 |w...Y...a.....u.|
 48 54 54 50 2f 31 2e 30 20 32 30 30 20 6f 6b 0d |HTTP/1.0 200 ok.|
 0a 43 6f 6e 74 65 6e 74 2d 74 79 70 65 3a 20 74 |.Content-type: t|
 65 78 74 2f 68 74 6d 6c 0d 0a 0d 0a 3c 48 54 4d |ext/html....HTM|
 0a 0a 73 5f 73 65 72 76 65 72 20 2d 77 77 77 20 |..s_server -www |
 2d 63 69 70 68 65 72 20 41 45 53 32 35 36 2d 53 |-cipher AES256-S|
 48 41 20 2d 6b 65 79 20 73 65 72 76 65 72 2e 70 |HA -key server.p|
 65 6d 20 2d 63 65 72 74 20 73 65 72 76 65 72 2e |em -cert server.|
 63 72 74 20 0a 53 65 63 75 72 65 20 52 65 6e 65 |crt .Secure Rene|
 67 6f 74 69 61 74 69 6f 6e 20 49 53 20 73 75 70 |gotiation IS sup|
 70 6f 72 74 65 64 0a 43 69 70 68 65 72 73 20 73 |ported.Ciphers s|
 75 70 70 6f 72 74 65 64 20 69 6e 20 73 5f 73 65 |upported in s_se|
</pre>

<p>It just does not show the decrypted frame as HTTP response.</p>
<p>After playing a bit with the protocol preferences, I found that <strong>disabling</strong> the following option <strong>will show</strong> the HTTP response ('HTTP/1.0 200 ok').</p>
<blockquote>
<p>Edit -&gt; Preferences -&gt; SSL -&gt; Reassemble SSL Application Data spanning multiple SSL records</p>
</blockquote>
<p>I'm not sure what is going on here, as I did not check the code. Could be a bug due to the large answer (multiple TCP segments). Please file a bug report at <a href="https://bugs.wireshark.org">https://bugs.wireshark.org</a> and include the files you posted in this question.</p>
<p>In the meantime you can continue your work/tests by disabling the option I mentioned.</p>
<p>Regards <br>
Kurt</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/34019/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>21 Jun '14, 16:25</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" alt="Kurt%20Knochner's gravatar image" />
    <p><a href="/users/2593/kurt-knochner">Kurt Knochner ♦</a><br/>
    <span class="score" title="24767 reputation points"><span class="">24.8k</span></span><span title="10 badges"><span class="badge1">&#9679;</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">&#9679;</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">&#9679;</span><span class="badgecount">237</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Kurt Knochner has 344 accepted answers">15&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/34019/">
                edited
                <strong>21 Jun '14, 16:26</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-34019">
    
        <a name="34027"></a>
        <div class="comment" id="comment-34027">
            <div id="post-34027-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks Kurt.  Yes, as I stated in my original post, the SSL debug file shows the successful decryption, so that's good.<br>
</p>

<p>I tried unchecking the option you suggest (ssl.desegment_ssl_application_data: FALSE) and am still getting the same result as I had before: no decrypted output in Wireshark. Could you post the contents of your Preferences file so I can do a full compare? </p>

<p>However, the debug log still continues to show successfull decryption.
I also did this in tshark and am getting the same results.<br>
</p>

<blockquote>
<p>tshark  -r localhost-test.pcap -o ssl.desegment_ssl_application_data:FALSE  -o "ssl.keys_list: 127.0.0.1,4443,http,/home/doug/temp/ssl/server.pem" -V &gt; tshark.out</p>
</blockquote>

<p>Here's the resulting output file (tshark.out):
<a href="https://drive.google.com/file/d/0BwNG6bK8noRIWUhDM2FqazJ4T1U/edit?usp=sharing">https://drive.google.com/file/d/0BwNG6bK8noRIWUhDM2FqazJ4T1U/edit?usp=sharing</a></p>

<p>Here's the resulting debug file:
<a href="https://drive.google.com/file/d/0BwNG6bK8noRIRkZxOTBKT0xEOEE/edit?usp=sharing">https://drive.google.com/file/d/0BwNG6bK8noRIRkZxOTBKT0xEOEE/edit?usp=sharing</a></p></div>
            <div class="comment-info" id="comment-34027-info">
                
                
                
                

                

                <span class="comment-age">(21 Jun '14, 17:44)</span>
                <a class="comment-user userinfo" href="/users/7531/potroast">PotRoast</a>
                
            </div>
        </div>
    
        <a name="34029"></a>
        <div class="comment" id="comment-34029">
            <div id="post-34029-score" class="comment-score"></div>
            <div class="comment-text"><blockquote>
<p>I tried unchecking the option you suggest ssl.desegment_ssl_application_data: FALSE </p>
<p>Could you post the contents of your Preferences file so I can do a full compare? </p>
</blockquote>

<p>That's the only option in my preferences file that is different than the default settings for HTTP and SSL, so it makes no sense to post the file.</p>

<p>BTW: My tests are on Windows, not Linux. Maybe that makes a difference (somehow - the code should be the same).</p>

<p>I tested with 1.10.7 and 1.11.2. Both show the same behavior.</p></div>
            <div class="comment-info" id="comment-34029-info">
                
                
                
                

                

                <span class="comment-age">(21 Jun '14, 17:52)</span>
                <a class="comment-user userinfo" href="/users/2593/kurt-knochner">Kurt Knochner ♦</a>
                
            </div>
        </div>
    
        <a name="34096"></a>
        <div class="comment" id="comment-34096">
            <div id="post-34096-score" class="comment-score"></div>
            <div class="comment-text"><p>No need to file a new bug, I already encountered this in the past: <a href="https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=9154.">https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=9154.</a> Last time I tried to debug it, there appears to be deeper problems in HTTP assembly but I have not picked up the work yet.</p></div>
            <div class="comment-info" id="comment-34096-info">
                
                
                
                

                

                <span class="comment-age">(23 Jun '14, 15:12)</span>
                <a class="comment-user userinfo" href="/users/5644/lekensteyn">Lekensteyn</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-34019" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-34019-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/33879/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='PBlwyewq2OET9zvHOjwWOcNYie2B1f7L' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/33879/ssl-decrypt-shows-ok-in-ssl-debug-file-but-not-in-wireshark?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/33879/ssl-decrypt-shows-ok-in-ssl-debug-file-but-not-in-wireshark?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/ssl_decrypt/"
            class="tag-link-ssl_decrypt"
            title="see questions tagged'ssl_decrypt'using tags"
            rel="tag">ssl_decrypt</a> <span class="tag-number">&#215;56</span><br/>
        
    </p>
    <p>
        question asked: <strong title="June 16, 2014, 10:10 p.m.">16 Jun '14, 22:10</strong>
    </p>
    <p> 
     	question was seen: <strong>14,175 times</strong>
    </p>
    <p> 
        last updated: <strong title="June 23, 2014, 3:12 p.m.">23 Jun '14, 15:12</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/29546/ssl_decrypt_record-mac-failed">ssl_decrypt_record: mac failed</a>
        </p>
        
        <p>
            <a href="/questions/44214/cant-decrypt-ssl">Can&#39;t decrypt SSL</a>
        </p>
        
        <p>
            <a href="/questions/54975/issues-decrypting-ssl-traffic">issues decrypting SSL Traffic</a>
        </p>
        
        <p>
            <a href="/questions/60602/decrypt-website-traffic-ssltsl">Decrypt website traffic SSL/TSL</a>
        </p>
        
        <p>
            <a href="/questions/30176/wireshark-decrypts-ssl-traces-just-partly">Wireshark decrypts SSL traces just partly</a>
        </p>
        
        <p>
            <a href="/questions/44535/ssl_generate_keyring_material-not-enough-data-keys-verified">ssl_generate_keyring_material not enough data (keys verified)</a>
        </p>
        
        <p>
            <a href="/questions/55119/ssl-decryption-not-working">SSL Decryption not working.</a>
        </p>
        
        <p>
            <a href="/questions/61107/problem-with-ssl-decryption">problem with SSL decryption</a>
        </p>
        
        <p>
            <a href="/questions/32292/ssltls-decrypt-doesnt-work-if-capture-started-mid-session">SSL/TLS decrypt doesn&#39;t work if capture started mid-session</a>
        </p>
        
        <p>
            <a href="/questions/45463/amqp-traffic-on-ssltls">AMQP traffic on SSL/TLS</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
