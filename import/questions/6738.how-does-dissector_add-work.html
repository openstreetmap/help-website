<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>How does dissector_add work? - Wireshark Q&amp;A</title>
        <meta name="description" content="Hi, I&#39;m a newbie trying to write a dissector for the first time. I&#39;ve noticed the function dissector_add() gets called to associate a particular identifier with a dissector handle. If I call dissector_add() twice for the same handle does it &quot;and&quot; these two identifiers or &quot;or&quot; them?  What do I do if ..." />
        <meta name="keywords" content="development,dissector_table,dissector" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/6738/how-does-dissector_add-work" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/6738/how-does-dissector_add-work?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='cUPUnN3Ekj2sI8SiUWc3HmogLedNSqBw' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/6738/how-does-dissector_add-work">How does dissector_add work?</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-6738-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/6738/up/" rel="nofollow"> </a>
<div id="post-6738-score" class="post-score"
    title="current number of votes">
    0
</div>
<a id="post-6738-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/6738/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/6738/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>Hi, I'm a newbie trying to write a dissector for the first time. I've noticed the function <code>dissector_add()</code> gets called to associate a particular identifier with a dissector handle.</p>
<p>If I call dissector_add() twice for the same handle does it "and" these two identifiers or "or" them? </p>
<p>What do I do if I want my dissector to match a combination of "and"s and "or"s, like an expression like this might indicate?: "((host 1.2.3.4 and port 111) or (host 5.6.7.8 and port 222))"</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/development/" class="post-tag tag-link-development"
                                        title="see questions tagged 'development'" rel="tag">development</a>
                                
                                    <a href="/tags/dissector_table/" class="post-tag tag-link-dissector_table"
                                        title="see questions tagged 'dissector_table'" rel="tag">dissector_table</a>
                                
                                    <a href="/tags/dissector/" class="post-tag tag-link-dissector"
                                        title="see questions tagged 'dissector'" rel="tag">dissector</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>05 Oct '11, 12:47</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/851676df3c7a09999c0522099f40d6e1?s=32&amp;d=identicon&amp;r=g" alt="JVo's gravatar image" />
    <p><a href="/users/1450/jvo">JVo</a><br/>
    <span class="score" title="16 reputation points">16</span><span title="5 badges"><span class="badge1">&#9679;</span><span class="badgecount">5</span></span><span title="5 badges"><span class="silver">&#9679;</span><span class="badgecount">5</span></span><span title="8 badges"><span class="bronze">&#9679;</span><span class="badgecount">8</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="JVo has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/6738/">
                edited
                <strong>05 Oct '11, 16:40</strong>
            </a>
        </p>
        
            <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/fe1cf996b30e896dc95ca3cd47ac7406?s=32&amp;d=identicon&amp;r=g" alt="multipleinterfaces's gravatar image" />
            <p><a href="/users/730/multipleinterfaces">multipleinte...</a><br/>
            <span class="score" title="1321 reputation points"><span class="">1.3k</span></span><span title="15 badges"><span class="badge1">&#9679;</span><span class="badgecount">15</span></span><span title="23 badges"><span class="silver">&#9679;</span><span class="badgecount">23</span></span><span title="40 badges"><span class="bronze">&#9679;</span><span class="badgecount">40</span></span></p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-6738">
    
</div>
<div id="comment-tools-6738" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-6738-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/6738/how-does-dissector_add-work?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/6738/how-does-dissector_add-work?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/6738/how-does-dissector_add-work?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/6738/how-does-dissector_add-work?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="6739"></a>
                    <div id="answer-container-6739" class="answer ">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-6739-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/6739/up/" rel="nofollow"> </a>
<div id="post-6739-score" class="post-score"
    title="current number of votes">
    3
</div>
<a id="post-6739-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/6739/down/" rel="nofollow"> </a>

                                        


    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p><code>dissector_add</code> is really just a <code>#define</code>d alias for <code>dissector_add_uint</code>, so if you are using <code>dissector_add</code> you should change it to <code>dissector_add_uint</code>. That said, when you call <code>dissector_add_uint("foo", BAR_PORT, bar_handle);</code>, it adds the dissector referenced by <code>bar_handle</code> to the dissector table referenced by <code>foo</code> for the <code>uint</code> value <code>BAR_PORT</code>.</p>
<p>To answer your question, it would be more like a logical <code>or</code> operation. Consider adding a dissector to the <code>udp.port</code> table twice using <code>1337</code> and <code>31337</code> as your ports --when the UDP dissector looks into its table for traffic on either of those ports, your dissector would be called. Note that hueristic dissectors work a little differently. <code>dissector_add_uint</code> is declared in <code>epan/packet.h</code>, so you should read some of the comments there about how the functions work and are intended to be used.</p>
<p><strong>Edit</strong>: Regarding your comments, 1337 and 31337 were example ports; in your example, these would be 111 and 222.</p>
<p>Regarding the IP address, there are no dissector tables tied to particular IP addresses. Network protocols are generic and typically understood by more than one machine, and maintaining large lists of IPs would become cumbersome (and practically infeasable) over time. In stead, you can limit the packets you see with a display filter so that only hosts 1.2.3.4 and 5.6.7.8 are shown (<code>ip.addr == 1.2.3.4 || ip.addr == 5.6.7.8</code>).</p>
<p>You can find more information in the <a href="http://www.wireshark.org/docs/wsdg_html_chunked/">Wireshark Developer's Guide</a>. Comments in the various source files (<code>.c</code>) typically concern implementation details that are subject to change or specific workarounds. Usually, you should hope to find the information you need in the header files, as these expose the interface as it is intended (and are usually easier to follow).</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/6739/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>05 Oct '11, 13:05</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/fe1cf996b30e896dc95ca3cd47ac7406?s=32&amp;d=identicon&amp;r=g" alt="multipleinterfaces's gravatar image" />
    <p><a href="/users/730/multipleinterfaces">multipleinte...</a><br/>
    <span class="score" title="1321 reputation points"><span class="">1.3k</span></span><span title="15 badges"><span class="badge1">&#9679;</span><span class="badgecount">15</span></span><span title="23 badges"><span class="silver">&#9679;</span><span class="badgecount">23</span></span><span title="40 badges"><span class="bronze">&#9679;</span><span class="badgecount">40</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="multipleinterfaces has 9 accepted answers">12&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/6739/">
                edited
                <strong>05 Oct '11, 14:12</strong>
            </a>
        </p>
        
    </div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-6739">
    
        <a name="6740"></a>
        <div class="comment" id="comment-6740">
            <div id="post-6740-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks so much for the quick response.</p>

<p>So, are "1337" and "31337" just example port numbers? In my example that would be "111" and "222", right?</p>

<p>Sorry for my confusion but how would I handle the host IP addresses as well, like in my example? "((host 1.2.3.4 and port 111) or (host 5.6.7.8 and port 222))"</p>

<p>Because I don't want to match tcp port 111 on every IP address, just that one. How do I deal with a "logical and" expression?</p></div>
            <div class="comment-info" id="comment-6740-info">
                
                
                
                

                

                <span class="comment-age">(05 Oct '11, 13:38)</span>
                <a class="comment-user userinfo" href="/users/1450/jvo">JVo</a>
                
            </div>
        </div>
    
        <a name="6741"></a>
        <div class="comment" id="comment-6741">
            <div id="post-6741-score" class="comment-score"></div>
            <div class="comment-text"><p>Sorry for my very little understanding of this - I'm just not sure where to go to learn about dissector tables. There don't seem to be many detailed comments in packet.h. Is my best bet to try to read the code itself in packet.c?</p>

<p>Thanks again!</p></div>
            <div class="comment-info" id="comment-6741-info">
                
                
                
                

                

                <span class="comment-age">(05 Oct '11, 13:39)</span>
                <a class="comment-user userinfo" href="/users/1450/jvo">JVo</a>
                
            </div>
        </div>
    
        <a name="6742"></a>
        <div class="comment" id="comment-6742">
            <div id="post-6742-score" class="comment-score"></div>
            <div class="comment-text"><p>I've updated my answer with some more information. The comments in the header files are usually the ones to go by, though they can be daunting at first. Make sure you understand the relevant portions of the Developer's Guide and have read <code>doc/README.developer</code>. You can also find information on the wiki: http://wiki.wireshark.org/</p></div>
            <div class="comment-info" id="comment-6742-info">
                
                
                
                

                

                <span class="comment-age">(05 Oct '11, 14:14)</span>
                <a class="comment-user userinfo" href="/users/730/multipleinterfaces">multipleinte...</a>
                
            </div>
        </div>
    
        <a name="6745"></a>
        <div class="comment" id="comment-6745">
            <div id="post-6745-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks for the update.</p>

<p>Regarding the IP addresses: I suppose generally the port number for our protocol should be unique to messages of this protocol. </p>

<p>If, in the off chance, another message arrives with the same port number (from a different IP), I'm not sure what I'll do. Preventing it from being displayed by using the display filter isn't really what I'd want. I still want to display all messages, whether or not they are one of my protocol messages. Any other thoughts? I may just have to make the assumption that any message with this port number is of this protocol.</p></div>
            <div class="comment-info" id="comment-6745-info">
                
                
                
                

                

                <span class="comment-age">(05 Oct '11, 16:14)</span>
                <a class="comment-user userinfo" href="/users/1450/jvo">JVo</a>
                
            </div>
        </div>
    
        <a name="6746"></a>
        <div class="comment" id="comment-6746">
            <div id="post-6746-score" class="comment-score"></div>
            <div class="comment-text"><p>Do you know if it's possible to tie a dissector to a particular ethernet capture device such as eth0, eth1, etc?</p></div>
            <div class="comment-info" id="comment-6746-info">
                
                
                
                

                

                <span class="comment-age">(05 Oct '11, 16:16)</span>
                <a class="comment-user userinfo" href="/users/1450/jvo">JVo</a>
                
            </div>
        </div>
    
        <a name="6747"></a>
        <div class="comment not_top_scorer" id="comment-6747">
            <div id="post-6747-score" class="comment-score"></div>
            <div class="comment-text"><p>I suppose there isn't a way in the dissect_foo() method to say "nevermind, this isn't a foo after all", is there? :o) (Sorry for the 20 questions)</p></div>
            <div class="comment-info" id="comment-6747-info">
                
                
                
                

                

                <span class="comment-age">(05 Oct '11, 16:19)</span>
                <a class="comment-user userinfo" href="/users/1450/jvo">JVo</a>
                
            </div>
        </div>
    
        <a name="6748"></a>
        <div class="comment not_top_scorer" id="comment-6748">
            <div id="post-6748-score" class="comment-score"></div>
            <div class="comment-text"><p>You cannot tie your dissector to a specific capture interface (other than by only capturing on that interface) since this information is not provided to dissectors. Regarding your other questions, what you are looking for is a "hueristic dissector". You should look at <code>doc/README.heuristic</code> for information about how to convert your current dissector into a hueristic dissector and what changes you may need to make otherwise. If you go this route, also make sure that your transport protocol's <code>try_heuristic_dissectors_first</code> preference is enabled.</p></div>
            <div class="comment-info" id="comment-6748-info">
                
                
                
                

                

                <span class="comment-age">(05 Oct '11, 16:30)</span>
                <a class="comment-user userinfo" href="/users/730/multipleinterfaces">multipleinte...</a>
                
            </div>
        </div>
    
        <a name="6749"></a>
        <div class="comment not_top_scorer" id="comment-6749">
            <div id="post-6749-score" class="comment-score"></div>
            <div class="comment-text"><p>I'll take a look at README.heuristic. Thanks!</p></div>
            <div class="comment-info" id="comment-6749-info">
                
                
                
                

                

                <span class="comment-age">(05 Oct '11, 16:52)</span>
                <a class="comment-user userinfo" href="/users/1450/jvo">JVo</a>
                
            </div>
        </div>
    
        <a name="6790"></a>
        <div class="comment not_top_scorer" id="comment-6790">
            <div id="post-6790-score" class="comment-score"></div>
            <div class="comment-text"><p>Wireshark dissectors works in a similar way as the protocol stack does
if your protocol runs on top of TCP/UDP the handoff would be to something listening to that port. (dissector registered in tcp and udp uint dissector tables in the case of Wireshark)
When capturing you can use capture filters to only capture packets
to from IP addresses and ports the interface yo capture on will be the ETH "selector". If your protocol has a magic number or a unique signature you can make it an heuristic dissector.</p></div>
            <div class="comment-info" id="comment-6790-info">
                
                
                
                

                

                <span class="comment-age">(07 Oct '11, 10:14)</span>
                <a class="comment-user userinfo" href="/users/42/anders">Anders ♦</a>
                
            </div>
        </div>
    
        <a name="6791"></a>
        <div class="comment not_top_scorer" id="comment-6791">
            <div id="post-6791-score" class="comment-score"></div>
            <div class="comment-text"><p>The heuristic dissector idea looks promising in that I can check the IP addresses, and return FALSE if they don't match.
However, can I use a heuristic dissector in combination with tcp_dissect_pdus()? 
I have 2 methods: tcp_dissect_foo() and tcp_dissect_foo_message(). tcp_dissect_foo() calls tcp_dissect_pdus(), which sets tcp_dissect_foo_message() to be called once the full message is received.
If I make this a heuristic dissector and check my IPs in tcp_dissect_foo_message(), returning false if they don't match, will wireshark do the right thing and pass the message on to other dissectors?</p></div>
            <div class="comment-info" id="comment-6791-info">
                
                
                
                

                

                <span class="comment-age">(07 Oct '11, 10:51)</span>
                <a class="comment-user userinfo" href="/users/1450/jvo">JVo</a>
                
            </div>
        </div>
    
        <a name="6793"></a>
        <div class="comment not_top_scorer" id="comment-6793">
            <div id="post-6793-score" class="comment-score"></div>
            <div class="comment-text"><p>Oh wait. Now that I think about it, I can check the IPs from tcp_dissect_foo() and return false if they don't match. If they do match, I could call tcp_dissect_pdus().
On the other hand, what if I wanted to check bytes in the message to verify that it was a "foo"? It seems like I would want to check those bytes in the full message, not in some random packet of the message. Thus, wouldn't I want to check them in tcp_dissect_foo_message() and return FALSE from there?</p></div>
            <div class="comment-info" id="comment-6793-info">
                
                
                
                

                

                <span class="comment-age">(07 Oct '11, 11:21)</span>
                <a class="comment-user userinfo" href="/users/1450/jvo">JVo</a>
                
            </div>
        </div>
    
        <a name="6794"></a>
        <div class="comment not_top_scorer" id="comment-6794">
            <div id="post-6794-score" class="comment-score"></div>
            <div class="comment-text"><p>tcp_dissect_pdus() expects packets of a particular protocol, as it has to be able to figure out how big each packet is, and how that's done is protocol-dependent (for example, one protocol might have a 2-byte big-endian length field at the beginning of the packet whose value that includes the length of the length field, another might have a 4-byte little-endian length field 2 bytes into the packet whose value does <em>not</em> include the length of the length field).  This makes it difficult to support having tcp_dissect_pdus() call heuristic dissectors, and it does not support that.</p></div>
            <div class="comment-info" id="comment-6794-info">
                
                
                
                

                

                <span class="comment-age">(07 Oct '11, 13:25)</span>
                <a class="comment-user userinfo" href="/users/79/guy-harris">Guy Harris ♦♦</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-6739" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 12
        </span>
        <a href="#" class="show-all-comments-link">show 7 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-6739-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/6738/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='cUPUnN3Ekj2sI8SiUWc3HmogLedNSqBw' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/6738/how-does-dissector_add-work?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/6738/how-does-dissector_add-work?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/dissector/"
            class="tag-link-dissector"
            title="see questions tagged'dissector'using tags"
            rel="tag">dissector</a> <span class="tag-number">&#215;637</span><br/>
        
        <a href="/tags/development/"
            class="tag-link-development"
            title="see questions tagged'development'using tags"
            rel="tag">development</a> <span class="tag-number">&#215;158</span><br/>
        
        <a href="/tags/dissector_table/"
            class="tag-link-dissector_table"
            title="see questions tagged'dissector_table'using tags"
            rel="tag">dissector_table</a> <span class="tag-number">&#215;1</span><br/>
        
    </p>
    <p>
        question asked: <strong title="Oct. 5, 2011, 12:47 p.m.">05 Oct '11, 12:47</strong>
    </p>
    <p> 
     	question was seen: <strong>8,284 times</strong>
    </p>
    <p> 
        last updated: <strong title="Oct. 7, 2011, 1:25 p.m.">07 Oct '11, 13:25</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/4797/dissector-debugging-how-to-find-the-exact-line-of-a-malformed-packet-exception">dissector debugging -- how to find the exact line of a &quot;malformed packet&quot; exception</a>
        </p>
        
        <p>
            <a href="/questions/5867/what-is-the-best-way-to-track-data-between-packets-during-dissection">What is the best way to track data between packets during dissection?</a>
        </p>
        
        <p>
            <a href="/questions/7341/why-does-wireshark-make-multiple-passes-during-dissection">Why does Wireshark make multiple passes during dissection?</a>
        </p>
        
        <p>
            <a href="/questions/8627/can-i-pass-arguments-to-a-sub-dissector">Can I pass arguments to a sub-dissector?</a>
        </p>
        
        <p>
            <a href="/questions/8649/dissector-bug-protocol-mysql-in-packet-665-protoc2518-failed-assertion-hfinfo-type-ft_string-hfinfo-type-ft_stringz">Dissector bug, protocol MySQL, in packet 665: proto.c:2518: failed assertion &quot;hfinfo-&gt;type == FT_STRING || hfinfo-&gt;type == FT_STRINGZ&quot;</a>
        </p>
        
        <p>
            <a href="/questions/11433/error-lnk2005-and-lnk1169">error LNK2005 and LNK1169</a>
        </p>
        
        <p>
            <a href="/questions/5050/how-do-multiple-dissectors-work-in-same-plugindll">How do multiple dissectors work in same plugindll ?</a>
        </p>
        
        <p>
            <a href="/questions/5956/setting-address-information-in-packet-info-structure-for-conversations">Setting address information in packet info structure for conversations</a>
        </p>
        
        <p>
            <a href="/questions/8690/cant-dissect-the-tcp-payload">can&#39;t dissect the tcp payload!</a>
        </p>
        
        <p>
            <a href="/questions/11476/how-can-i-dissect-1-and-3-bit-fields-from-a-byte">How can I dissect 1- and 3-bit fields from a byte?</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
