<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- base_content.html -->

<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>Does reassembly address multiple PDUs in a single TCP segment? - Wireshark Q&amp;A</title>
        <meta name="description" content="I&#39;m starting to dig into the details of some capture files and have been humbled by the gaps in my knowledge that have been exposed in this process. I am using a Lua dissector for a protocol (call it MYPROTO) that is conveyed via TCP. I was puzzled by some extremely large TCP segments in the capture..." />
        <meta name="keywords" content="lua,dissector,reassembly" />
        
        <link rel="canonical" href="https://osqa-ask.wireshark.org/questions/30529/does-reassembly-address-multiple-pdus-in-a-single-tcp-segment" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="/questions/30529/does-reassembly-address-multiple-pdus-in-a-single-tcp-segment?type=rss">


        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        <meta name="google-site-verification" content="dqzpAlfsUDYClyC-7mNVrF11yfwuCZ0-uF7C4HApzkU" />
        
        <link rel="shortcut icon" href="/upfiles/favicon-ask_1.ico" />
        <link href="/m/default/media/style/style.css" rel="stylesheet" type="text/css" />
        
        <link href="/cstyle.css" rel="stylesheet" type="text/css" />
        
        <link rel="stylesheet" type="text/css" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.7.1/themes/base/jquery-ui.css" />
        <!--[if IE 6]>
        <style type="text/css">
        img, div, a { behavior: url(/m/default/media/iepngfix/iepngfix.htc) }
        </style>
        <![endif]-->
        

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/jquery-ui.min.js"></script>
        
        <script type="text/javascript">
        /*<![CDATA[*/
            
            

            var i18nLang = 'en';
            var appUrl = 'https://osqa-ask.wireshark.org'
            var scriptUrl = '/'
            var osqaSkin = 'default';

            var messages = {
                username: '',
                confirm: "Are you sure?",
                yes: "Yes",
                no: "No",
                message: "Message:",
                cancel: "Cancel",
                close: "Close",
                ok: "Ok",
                matching_tags_url: "/matching_tags/",
                word: "word",
                words: "words",
                character: "character",
                characters: "characters"
            }
        /*]]>*/
        </script>
        <script type="text/javascript" src="/m/default/media/js/osqa.main.js"></script>
        
        <style type="text/css">
            body { margin-top:2.4em; }
        </style>
        <script type="text/javascript">
            $(document).ready(function() {
                var element = $('#validate_email_alert');
                element.click(function(){notify.close(true);})
                notify.show();
            });
        </script>
        
        
            <META name="y_key" content="af3ab95b28a8b14e">
<meta name="msvalidate.01" content="9EAF899765C0DD43A19EEF6EAFFA6A77" />
        
        
        
        <script type='text/javascript' src='/m/default/media/js/osqa.question.js'></script>
        <script type='text/javascript' src='/m/default/media/js/jquery.caret.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/showdown.js'></script>
        <script type='text/javascript' src='/m/default/media/js/wmd/wmd.js'></script>
        <script type='text/javascript' src='/m/default/media/js/html_sanitizer.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/wmd/wmd.css" />

        
        <script type='text/javascript' src='/m/default/media/js/viewbox_min.js'></script>
        <script type='text/javascript' src='/m/default/media/js/youtube.js'></script>
        <link rel="stylesheet" type="text/css" href="/m/default/media/js/viewbox.css" />
        
        

        <script type="text/javascript">
        $().ready(function(){
            $("#nav_questions").attr('className',"on");
            var answer_sort_tab = "";

            if (answer_sort_tab) {
                $("#" + answer_sort_tab).attr('className',"on");
            }

            $('#editor').TextAreaResizer();

            //toggle preview of editor
            var display = true;
            var txt = "[hide preview]";
            $('#pre-collapse').text(txt);
            $('#pre-collapse').bind('click', function(){
                txt = display ? "[show preview]" : "[hide preview]";
                display = !display;
                $('#previewer').toggle();
                $('#pre-collapse').text(txt);
            });
        });

        function submitClicked(e, f) {
            if(!(browserTester('chrome') || browserTester('safari'))) {
                $("input.submit")[0].disabled=true;
            }
            window.removeEventListener('beforeunload', beforeUnload, true);
            if (f) {
                f.submit();
            }
        }

        function beforeUnload(e) {

            if($("textarea#editor")[0].value != "") {
                return yourWorkWillBeLost(e);
            }

            var commentBoxes = $("textarea.commentBox");
            for(var index = 0; index < commentBoxes.length; index++) {
                if(commentBoxes[index].value != "") {
                    return yourWorkWillBeLost(e);
                }
            }
        }
        window.addEventListener('beforeunload', beforeUnload, true);
        </script>
        <noscript>
            <style>
                .comment.not_top_scorer {
                    display: block;
                }
                .comment-form-container {
                    display: block;
                }
                .div.comment-tools {
                    display: none;
                }
            </style>
        </noscript>

        <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="Wireshark Q&amp;A Search" />
        
    </head>
    <body>
        <div class="wrapper">
        
        <!-- template header.html -->


	<div id="roof">
	  
		<div id="logo">
			<a href="/">
				<img src="/upfiles/wsbadge@186x57.png" title="back to home page" alt="Wireshark Q&amp;A logo"/>
			</a>
		</div>
	  
		<div id="top">
		     <a href="/account/signin/" >login</a>  <a href="/about/" >about</a>  <a href="/faq/" >faq</a> 
		</div>

    <div id="nav">
        <a id="nav_questions" class="on" href="/questions/" >questions</a><a id="nav_tags" href="/tags/" >tags</a><a id="nav_users" href="/users/" >users</a><a id="nav_badges" href="/badges/" >badges</a><a id="nav_unanswered" href="/questions/unanswered/" >unanswered</a>
        
    </div>
  </div>

  <div class="clear"></div>
  
	<div id="searchBar">
    <form action="/search/" method="get">
        <input type='hidden' name='csrfmiddlewaretoken' value='yITHPBVYq8yRM0MWDyb1x1mT9z2Ee3ql' />
        <div>
            <input type="text" class="searchInput" value="" name="q" id="keywords" />
            <input type="submit" name="Submit" value="search" class="searchBtn" />
        </div>
        <div class="options">
            <input id="type-question" type="radio" value="question" name="t" 
                checked="checked" /><label for="type-question">questions</label>
            <input id="type-tag" type="radio" value="tag" name="t" /><label for="type-tag">tags</label>
            <input id="type-user" type="radio" value="user" name="t" /><label for="type-user">users</label>
        </div>
    </form>	
	</div>

	
  <div id="announcement">
      <div style="padding: 1em; margin-top: 5px; border-radius: 5px; border: 1px solid rgb(107, 43, 40); background: rgb(243, 227, 225);">
This is our old Q&amp;A Site. Please post any new questions and answers at <a href="https://ask.wireshark.org/">ask.wireshark.org</a>.
</div>
  </div>
  

<!-- end template header.html -->

        



<div id="wrapper">
    
    
    <div id="room">
        <div id="CALeft">
            
<div class="headNormal">
    <h1><a href="/questions/30529/does-reassembly-address-multiple-pdus-in-a-single-tcp-segment">Does reassembly address multiple PDUs in a single TCP segment?</a></h1>
</div>
<div id="main-body" class="">
    <div id="askform">
            <table style="width:100%;" id="question-table" >
                <tr>
                    <td style="width:30px;vertical-align:top">
                        <div class="vote-buttons">
                            

<a id="post-30529-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/30529/up/" rel="nofollow"> </a>
<div id="post-30529-score" class="post-score"
    title="current number of votes">
    1
</div>
<a id="post-30529-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/30529/down/" rel="nofollow"> </a>

                            

<a id="favorite-mark" title="mark/unmark this question as favorite (click again to cancel)"
    class="ajax-command favorite-mark "
    href="/mark_favorite/30529/" rel="nofollow"> </a>
<div id="favorite-count" class="favorite-count">
   
</div>

                        </div>
                    </td>
                    <td>
                        <div id="item-right">
                            <div class="question-body">
                                <p>I'm starting to dig into the details of some capture files and have been humbled by the gaps in my knowledge that have been exposed in this process. I am using a Lua dissector for a protocol (call it MYPROTO) that is conveyed via TCP. I was puzzled by some extremely large TCP segments in the capture, but now understand that multiple MYPROTO PDUs can be carried in a single TCP segment. However, the Lua dissector only shows one MYPROTO PDU. (I'm still puzzled by the underlying question of why some segments are extremely large while others are not, but I can put that aside while I look to solve the dissector problem.)</p>
<p>I have been reading about reassembly, which I understand to mean the process of reassembling higher-level PDUs that may cross multiple TCP segments. If I modify the dissector to support reassembly, will the same mechanism allow the dissector to discover multiple MYPROTO PDUs within a single TCP segment?</p>
                            </div>
                            <div id="question-tags" class="tags-container tags">
                                
                                    <a href="/tags/lua/" class="post-tag tag-link-lua"
                                        title="see questions tagged 'lua'" rel="tag">lua</a>
                                
                                    <a href="/tags/dissector/" class="post-tag tag-link-dissector"
                                        title="see questions tagged 'dissector'" rel="tag">dissector</a>
                                
                                    <a href="/tags/reassembly/" class="post-tag tag-link-reassembly"
                                        title="see questions tagged 'reassembly'" rel="tag">reassembly</a>
                                
                            </div>
                            <div id="question-controls" class="post-controls">
                                

                                

                            </div>
                            <div class="post-update-info-container">
                                    
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        asked
        <strong>07 Mar '14, 04:35</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/143ca820606b9b8df4a6441003ef1b53?s=32&amp;d=identicon&amp;r=g" alt="yotommy's gravatar image" />
    <p><a href="/users/6685/yotommy">yotommy</a><br/>
    <span class="score" title="36 reputation points">36</span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">&#9679;</span><span class="badgecount">2</span></span><span title="7 badges"><span class="bronze">&#9679;</span><span class="badgecount">7</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="yotommy has no accepted answers">0&#37;</span>
    </p>
</div>

    <div class='post-update-info post-update-info-edited'>
        <p style="line-height:12px;">
            <a href="/revisions/30529/">
                edited
                <strong>07 Mar '14, 04:43</strong>
            </a>
        </p>
        
    </div>


                            </div>
                            




<div class="comments-container" id="comments-container-30529">
    
</div>
<div id="comment-tools-30529" class="comment-tools">
    
    
</div>




<div class="clear"></div>
<div id="comment-30529-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                        </div>

                    </td>
                </tr>
            </table>
            
            
                <hr/>
                <div class="tabBar">
                    <a name="sort-top"></a>
                    <div class="headQuestions">
                    One Answer:
                    </div>
                    
<div class="tabsA"><a href="/questions/30529/does-reassembly-address-multiple-pdus-in-a-single-tcp-segment?sort=active" title="most recently updated answers/comments will be shown first">active answers</a><a href="/questions/30529/does-reassembly-address-multiple-pdus-in-a-single-tcp-segment?sort=oldest" title="oldest answers will be shown first">oldest answers</a><a href="/questions/30529/does-reassembly-address-multiple-pdus-in-a-single-tcp-segment?sort=newest" title="newest answers will be shown first">newest answers</a><a href="/questions/30529/does-reassembly-address-multiple-pdus-in-a-single-tcp-segment?sort=votes" class="on" title="most voted answers will be shown first">popular answers</a></div>

                </div>
                

                
                    <a name="30531"></a>
                    <div id="answer-container-30531" class="answer accepted-answer">
                        <table style="width:100%;">
                            <tr>
                                <td style="width:30px;vertical-align:top">
                                    <div class="vote-buttons">
                                        

<a id="post-30531-upvote" title="I like this post (click again to cancel)"
    class="ajax-command post-vote up "
     href="/vote/30531/up/" rel="nofollow"> </a>
<div id="post-30531-score" class="post-score"
    title="current number of votes">
    3
</div>
<a id="post-30531-downvote" title="I dont like this post (click again to cancel)"
    class="ajax-command post-vote down"
     href="/vote/30531/down/" rel="nofollow"> </a>

                                        


    
      <a class="accept-answer on"
        title="yotommy has selected this answer as the correct answer"
        href="/accept_answer/30531/" rel="nofollow">
      </a>
    



                                    </div>
                                </td>
                                <td>
                                    <div class="item-right">
                                        <div class="answer-body">
                                            <p>Not the last time I checked.  I believe you have to write your dissector function with a loop internally, to handle the case of there being multiple of your protocol messages inside a single TCP segment.  I could be wrong, but I don't believe wireshark will call your dissector function multiple times for the same TCP segment (or at least it didn't use to, though that may have changed).  That should be easy enough for you to test though, and report back here with an answer. :)</p>
<p>Regardless, if your dissector doesn't use one of the two reassembly mechanisms/models, then wireshark has no idea how much of a segment(s) your protocol message consumed, since there's no inherent message framing inside TCP.  So you at least have to use one of the reassembly models to handle the fact any given protocol message may cross one or more segment(s).</p>
                                        </div>
                                        <div class="answer-controls post-controls">
                                            
<span class="action-link"><a rel="nofollow" title="answer permanent link" class="ajax-command withprompt  copy" href="/answer_link/30531/">permanent link</a></span>
                                            

                                        </div>
                                        <div class="post-update-info-container">
                                            
<div class='post-update-info post-update-info-user'>
    <p style="line-height:12px;">
        answered
        <strong>07 Mar '14, 05:10</strong>
    </p>
    <img class="gravatar" width="32" height="32" src="https://secure.gravatar.com/avatar/d02f20c18a7742ec73a666f1974bf6dc?s=32&amp;d=identicon&amp;r=g" alt="Hadriel's gravatar image" />
    <p><a href="/users/4318/hadriel">Hadriel</a><br/>
    <span class="score" title="2652 reputation points"><span class="">2.7k</span></span><span title="2 badges"><span class="badge1">&#9679;</span><span class="badgecount">2</span></span><span title="9 badges"><span class="silver">&#9679;</span><span class="badgecount">9</span></span><span title="39 badges"><span class="bronze">&#9679;</span><span class="badgecount">39</span></span><br />
    
    <span title="Rate of the user's accepted answers" class="accept_rate">accept rate:</span>
    <span title="Hadriel has 30 accepted answers">18&#37;</span>
    </p>
</div>


                                        </div>
                                        




<div class="comments-container" id="comments-container-30531">
    
        <a name="30532"></a>
        <div class="comment" id="comment-30532">
            <div id="post-30532-score" class="comment-score">1</div>
            <div class="comment-text"><p>For a C based "new" style dissector that returns the number of bytes it dissected, multiple PDU's per TCP segments are dissected.  See the reassembly chapter in README.dissector.</p>

<p>I don't know if a Lua dissector can do this.</p></div>
            <div class="comment-info" id="comment-30532-info">
                
                
                
                

                

                <span class="comment-age">(07 Mar '14, 05:31)</span>
                <a class="comment-user userinfo" href="/users/1225/grahamb">grahamb ♦</a>
                
            </div>
        </div>
    
        <a name="30533"></a>
        <div class="comment" id="comment-30533">
            <div id="post-30533-score" class="comment-score">1</div>
            <div class="comment-text"><p>Yeah I was just about to correct myself, because it looks like there's a loop inside dissect_tcp() now. So it should work for Lua as well, if you use the new style of returning the number of bytes consumed. (or at least the Lua binding code does look for a number return value and passes that back in to wireshark, so the plumbing's there)</p></div>
            <div class="comment-info" id="comment-30533-info">
                
                
                
                

                

                <span class="comment-age">(07 Mar '14, 05:44)</span>
                <a class="comment-user userinfo" href="/users/4318/hadriel">Hadriel</a>
                
            </div>
        </div>
    
        <a name="30534"></a>
        <div class="comment" id="comment-30534">
            <div id="post-30534-score" class="comment-score">1</div>
            <div class="comment-text"><p>Large TCP sgements may be due to offloading, you can try to turn that off.</p></div>
            <div class="comment-info" id="comment-30534-info">
                
                
                
                

                

                <span class="comment-age">(07 Mar '14, 05:54)</span>
                <a class="comment-user userinfo" href="/users/42/anders">Anders ♦</a>
                
            </div>
        </div>
    
        <a name="30536"></a>
        <div class="comment" id="comment-30536">
            <div id="post-30536-score" class="comment-score"></div>
            <div class="comment-text"><p>This is great info, thanks. I will modify the dissector to return the number of bytes consumed. Using this mechanism, will the buffer passed into the dissector always point to the beginning of the to-be-dissected data, or do I need to check pinfo.desegment_offset?</p></div>
            <div class="comment-info" id="comment-30536-info">
                
                
                
                

                

                <span class="comment-age">(07 Mar '14, 06:01)</span>
                <a class="comment-user userinfo" href="/users/6685/yotommy">yotommy</a>
                
            </div>
        </div>
    
        <a name="30568"></a>
        <div class="comment" id="comment-30568">
            <div id="post-30568-score" class="comment-score"></div>
            <div class="comment-text"><p>Modifying the Lua dissector to have it return the number of bytes consumed did not have an effect. So I created a loop inside the dissector to add a subtree when I have enough data and to request reassembly otherwise. This is working better, but the packet length shown in the display is that of the enclosing TCP segment rather than that of the MYPROTO PDU. Any tips for this?</p></div>
            <div class="comment-info" id="comment-30568-info">
                
                
                
                

                

                <span class="comment-age">(07 Mar '14, 09:53)</span>
                <a class="comment-user userinfo" href="/users/6685/yotommy">yotommy</a>
                
            </div>
        </div>
    
        <a name="30572"></a>
        <div class="comment not_top_scorer" id="comment-30572">
            <div id="post-30572-score" class="comment-score"></div>
            <div class="comment-text"><p>Can you post your code, or at least th relevant portions of it that weren't working with the number return model?</p></div>
            <div class="comment-info" id="comment-30572-info">
                
                
                
                

                

                <span class="comment-age">(07 Mar '14, 10:28)</span>
                <a class="comment-user userinfo" href="/users/4318/hadriel">Hadriel</a>
                
            </div>
        </div>
    
        <a name="30577"></a>
        <div class="comment not_top_scorer" id="comment-30577">
            <div id="post-30577-score" class="comment-score"></div>
            <div class="comment-text"><p>To demonstrate this, I modified the 'trivial' dissector provided on wireshark.org. The revised code is shown here: <a href="https://gist.github.com/yotommy/9418831">https://gist.github.com/yotommy/9418831</a> - sample capture file here: <a href="http://www.cloudshark.org/captures/ef2f1bb3e67a">http://www.cloudshark.org/captures/ef2f1bb3e67a</a></p></div>
            <div class="comment-info" id="comment-30577-info">
                
                
                
                

                

                <span class="comment-age">(07 Mar '14, 12:04)</span>
                <a class="comment-user userinfo" href="/users/6685/yotommy">yotommy</a>
                
            </div>
        </div>
    
        <a name="30579"></a>
        <div class="comment not_top_scorer" id="comment-30579">
            <div id="post-30579-score" class="comment-score"></div>
            <div class="comment-text"><p>Excellent - thanks for uploading that.  I just tried your script and was worried something else was broken because I kept getting a Lua error in the second packet's dissection pane, and putting a print statement showed wireshark was only giving your dissector a 2-byte tvb/buffer.</p>

<p>But then I looked at the second packet closely and saw the IP header length field is wrong, indicating it really does think the payload is 2 bytes long - you must have created this packet by hand, right? :)</p>

<p>Anyway, I'll go investigate why the first packet isn't getting chopped up.</p></div>
            <div class="comment-info" id="comment-30579-info">
                
                
                
                

                

                <span class="comment-age">(07 Mar '14, 13:15)</span>
                <a class="comment-user userinfo" href="/users/4318/hadriel">Hadriel</a>
                
            </div>
        </div>
    
        <a name="30580"></a>
        <div class="comment not_top_scorer" id="comment-30580">
            <div id="post-30580-score" class="comment-score"></div>
            <div class="comment-text"><p>Yes, created the pcap file with text2pcap. There are two bytes left over in the first packet that ideally will be combined with the two bytes from the second packet to make another 'trivial' PDU. Thanks for your help.</p></div>
            <div class="comment-info" id="comment-30580-info">
                
                
                
                

                

                <span class="comment-age">(07 Mar '14, 13:31)</span>
                <a class="comment-user userinfo" href="/users/6685/yotommy">yotommy</a>
                
            </div>
        </div>
    
        <a name="30581"></a>
        <div class="comment not_top_scorer" id="comment-30581">
            <div id="post-30581-score" class="comment-score"></div>
            <div class="comment-text"><p>Hmm... not only does it not work in 1.11, 1,10, nor 1.8, but I don't see how it <em>ever</em> worked.  The loop I saw is in tcp_dissect_pdus(), and it's not exposed for Lua scripts to use, but it has to be used.<br>
</p>

<p>So returning a number is meaningless, even though the Lua binding C-code registers the dissector as a new type and passes back the number.  The TCP dissector must have worked differently a long time ago, or else this behavior was never tested.</p>

<p>Looks like you'll have to write your own looping code in Lua, before returning from the dissector() function.</p>

<p>I'll submit a bug to track this, though I'll have to think about the best way to enable this to work.  It's always a tricky balance of exposing too much of the internals and potentially breaking scripts if the internals change in the future, vs. exposing too little and making it not powerful enough and making the Lua script writer have to do more work.</p></div>
            <div class="comment-info" id="comment-30581-info">
                
                
                
                

                

                <span class="comment-age">(07 Mar '14, 14:17)</span>
                <a class="comment-user userinfo" href="/users/4318/hadriel">Hadriel</a>
                
            </div>
        </div>
    
        <a name="30582"></a>
        <div class="comment not_top_scorer" id="comment-30582">
            <div id="post-30582-score" class="comment-score"></div>
            <div class="comment-text"><p>Thanks for taking a careful look. One last (?) question: I've experimented with some looping code that adds multiple MYPROTO subtrees. Is there anyway to get Wireshark to display one row per MYPROTO PDU rather than having multiple PDUs grafted to a single TCP row?</p></div>
            <div class="comment-info" id="comment-30582-info">
                
                
                
                

                

                <span class="comment-age">(07 Mar '14, 14:22)</span>
                <a class="comment-user userinfo" href="/users/6685/yotommy">yotommy</a>
                
            </div>
        </div>
    
        <a name="30584"></a>
        <div class="comment not_top_scorer" id="comment-30584">
            <div id="post-30584-score" class="comment-score"></div>
            <div class="comment-text"><p>I'm not sure I follow you, but this should probably be a new question in a new topic.  This ask.wireshark.org site follows a one-question/answer model, rather than a forum discussion model.  Besides, that way I get paid more commission fees. ;)</p></div>
            <div class="comment-info" id="comment-30584-info">
                
                
                
                

                

                <span class="comment-age">(07 Mar '14, 14:32)</span>
                <a class="comment-user userinfo" href="/users/4318/hadriel">Hadriel</a>
                
            </div>
        </div>
    
</div>
<div id="comment-tools-30531" class="comment-tools">
    
        <span class="comments-showing">
            showing 5 of 12
        </span>
        <a href="#" class="show-all-comments-link">show 7 more comments</a>
    
    
</div>




<div class="clear"></div>
<div id="comment-30531-form-container" class="comment-form-container">
    
</div>
<div class="clear"></div>



                                    </div>
                                </td>
                            </tr>
                        </table>
                    </div>
                
                <div class="paginator-container-left">
                    
                </div>
            
        <form id="fmanswer" action="/questions/30529/answer/" method="post">
            <input type='hidden' name='csrfmiddlewaretoken' value='yITHPBVYq8yRM0MWDyb1x1mT9z2Ee3ql' />
            <div style="clear:both">
            </div>

            
                <div style="padding:10px 0 0 0;">
                    <div class="headNormal">
                        
                            Your answer
                        
                    </div>
                </div>
                

                <div id="description" class="" >
                    <div id="wmd-button-bar" class="wmd-panel"></div>
                    <textarea cols="40" id="editor" name="text" rows="10"></textarea>
                    <div class="preview-toggle">
                        <table width="100%">
                            <tr>
                                <td>
                                    <span id="pre-collapse" 
                                        title="Toggle the real time Markdown editor preview">
                                            toggle preview
                                    </span>
                                </td>
                                <td style="text-align: right;" id="editor-metrics"></td>
                                
                                <td style="text-align:right;">
                                    <input id="id_wiki" name="wiki" type="checkbox" /> 
                                    <span style="font-weight:normal;cursor:help" 
                                        title="if you choose community wiki option, the question and answer do not generate points and name of author will not be shown">
                                            <label for="id_wiki">community wiki:</label> 
                                    </span>
                                </td>
                                
                            </tr>

                        </table>
                    </div>
                    
                    <div id="previewer" class="wmd-preview"></div>
                </div>

                

                <p><span class="form-error"></span></p>
                <input type="button"
                    
                        value="Login/Signup to Post Your Answer" 
                    
                    class="submit" style="float:left" onclick="submitClicked(event, this.form)"/>
            
        </form>
    </div>
</div>


        </div>
        <div id="CARight">
            
<div class="boxC" id="subscription_box">
    <h3 class="subtitle">Follow this question</h3><strong>By Email:</strong><p>Once you sign in you will be able to subscribe for any updates here</p><strong>By RSS:</strong><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/30529/does-reassembly-address-multiple-pdus-in-a-single-tcp-segment?type=rss" title="subscribe to answers"></a>
    Answers
</p><p><a class="feed-icon" style="background-image:url('/m/default/media/images/feed-icon-small.png');"
        href="/questions/30529/does-reassembly-address-multiple-pdus-in-a-single-tcp-segment?type=rss&comments=yes" title="subscribe to comments and answers"></a>
    Answers and Comments
</p>

</div>


<div class="boxC" id="editor_side_bar">
    <p class="subtitle darkred">Markdown Basics</p>
    <ul class="list-item">
        <li>
            *italic* or _italic_
        </li>
        <li>
			**bold** or __bold__
        </li>
        <li>
            <b>link</b>:[text](http://url.com/ "title")

        </li>

        <li>
            <b>image</b>?![alt text](/path/img.jpg "title")

        </li>
        <li>
			numbered list:
            1.  Foo
            2.  Bar
        </li>
        <li>
			to add a line break simply add two spaces to where you would like the new line to be.
        </li>
        <li>
			basic HTML tags are also supported
        </li>
    </ul>
    <p class='info-box-follow-up-links'>
        <a href="/markdown_help/" target="_blank">learn more about Markdown </a>
    </p>
</div>



<div id="sidebar-upper" class="boxC">
    <div class="body">
        <h2>You have a trillion packets.</h2>
<h3>You need to see four of them.</h3>
<p><a href="http://www.riverbed.com/products-solutions/products/network-performance-management/">Riverbed Technology</a> lets you seamlessly move between packets and flows for comprehensive monitoring, analysis and troubleshooting.</p>
<p><a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/"><img style="margin-left: 39px;" src="https://www.wireshark.org/image/logo_riverbed_150.png"></a></p>
<p>Riverbed is Wireshark's primary sponsor and provides our funding.</p>
     </div>
</div>




<div class="boxC">
    <p>
        Question tags:
    </p>
    <p class="tags" >
        
        <a href="/tags/dissector/"
            class="tag-link-dissector"
            title="see questions tagged'dissector'using tags"
            rel="tag">dissector</a> <span class="tag-number">&#215;637</span><br/>
        
        <a href="/tags/lua/"
            class="tag-link-lua"
            title="see questions tagged'lua'using tags"
            rel="tag">lua</a> <span class="tag-number">&#215;431</span><br/>
        
        <a href="/tags/reassembly/"
            class="tag-link-reassembly"
            title="see questions tagged'reassembly'using tags"
            rel="tag">reassembly</a> <span class="tag-number">&#215;78</span><br/>
        
    </p>
    <p>
        question asked: <strong title="March 7, 2014, 4:35 a.m.">07 Mar '14, 04:35</strong>
    </p>
    <p> 
     	question was seen: <strong>2,785 times</strong>
    </p>
    <p> 
        last updated: <strong title="March 7, 2014, 2:32 p.m.">07 Mar '14, 14:32</strong>
    </p>
</div>


<div id="sidebar-lower" class="boxC">
    <div class="body">
        <h2>Don't have Wireshark?</h2>
<p>What are you waiting for? It's free! Wireshark documentation and downloads can be found at the <a href="https://www.wireshark.org/"><strong>Wireshark web site</strong></a>.</p>
     </div>
</div>


<div class="boxC">
    <h3 class="subtitle">Related questions</h3>
    <div class="questions-related">

        
        <p>
            <a href="/questions/59151/how-to-reassemble-custom-protocols-with-lua">How to reassemble custom protocols with Lua?</a>
        </p>
        
        <p>
            <a href="/questions/1357/lua-tcp-reassembly">Lua TCP reassembly</a>
        </p>
        
        <p>
            <a href="/questions/59346/tcp-reassembly-what-happens-when-retransmissions-occur">TCP reassembly: What happens when retransmissions occur?</a>
        </p>
        
        <p>
            <a href="/questions/60889/how-to-export-reassembled-packets-to-a-pcapng-file">How to export reassembled packets to a .pcapng file?</a>
        </p>
        
        <p>
            <a href="/questions/9018/confusing-lua-reassembly-documentation-how-is-this-done-in-current-16x170">Confusing Lua reassembly documentation, how is this done in current 1.6.x/1.7.0 ?</a>
        </p>
        
        <p>
            <a href="/questions/28076/pdu-reassembly-over-udp-within-a-lua-dissector">PDU reassembly over UDP within a lua dissector</a>
        </p>
        
        <p>
            <a href="/questions/44057/complex-lua-tcp-reassembly-problem">Complex Lua TCP Reassembly Problem</a>
        </p>
        
        <p>
            <a href="/questions/57685/reassembly-not-working-with-a-chained-dissector-in-lua">Reassembly not working with a chained dissector in Lua</a>
        </p>
        
        <p>
            <a href="/questions/2660/lua-cannot-read-snmp-request_id-field">Lua: cannot read SNMP request_id field</a>
        </p>
        
        <p>
            <a href="/questions/20518/create-an-extended-icmpv6-dissector">Create an extended ICMPv6 dissector</a>
        </p>
        

    </div>
</div>



        </div>
        <div id="tail" style="clear:both;">
            
            
        </div>
    </div>
    <div class="spacer3"></div>
</div>

        
            <div id="ground">
                


<div>
    <div class="footerLinks" >
         <a href="/about/" >about</a> <span class="link-separator"> |</span> <a href="/faq/" >faq</a> <span class="link-separator"> |</span> <a href="/privacy/" >privacy</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" target="_blank">support</a> <span class="link-separator"> |</span> <a href="https://bugs.wireshark.org/" >contact</a> 
    </div>
  <p>
        p&#8203;o&#8203;w&#8203;e&#8203;r&#8203;e&#8203;d by &#79;&#8203;&#83;&#8203;&#81;&#8203;&#65;
  </p>
</div>
 <div id="licenseLogo">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">
            <img src="/m/default/media/images/by-sa-88x31.png" title="Creative Commons: Attribution - Share Alike" alt="cc-by-sa" width="88" height="31" />
  </a>
 </div>


            </div>
        
        

        
            <script type="text/javascript">
                var _gaq = _gaq || [];
                _gaq.push(['_setAccount', 'UA-605389-6']);
                _gaq.push(['_trackPageview']);

                (function() {
                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                })();
            </script>
        
        </div>

        <!-- Put all elements with fixed position here, IE6 fixed position fix: http://ryanfait.com/position-fixed-ie6/ -->
        <div class="notify" style="display:none">
            
                
                    
                          <p class="darkred">First time here? Check out the <a href="/faq/">FAQ</a>!</p>
                    
                
            
            <a id="close-notify" onclick="notify.close(true)">&#215;</a>
        </div>
    </body>
</html>
<!-- end template base_content.html -->
