+++
type = "question"
title = "How to see RoHC decoded data in Wireshark"
description = '''Hello all, In my work, I have to check from time to time RoHC related data transfer. It would be very useful to see such decoded data directly in Wireshark (I have pcap file), where I have LTE traffic. I tried to do this for a long time (maybe almost 2 years), but without any results. I think, that ...'''
date = "2016-02-25T04:33:00Z"
lastmod = "2016-03-04T01:24:00Z"
weight = 50505
keywords = [ "pdcp-lte", "rohc" ]
aliases = [ "/questions/50505" ]
osqa_answers = 1
osqa_accepted = true
+++

<div class="headNormal">

# [How to see RoHC decoded data in Wireshark](/questions/50505/how-to-see-rohc-decoded-data-in-wireshark)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-50505-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-50505-score" class="post-score" title="current number of votes">0</div><span id="post-50505-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hello all,</p><p>In my work, I have to check from time to time RoHC related data transfer. It would be very useful to see such decoded data directly in Wireshark (I have pcap file), where I have LTE traffic. I tried to do this for a long time (maybe almost 2 years), but without any results. I think, that I always configured all correctly, but the result was the same - no decoded RoHC data and in "Configuration" field (PDCP-LTE part) always stay the same: "[ROHC Compression: False]". I have this protocol stack:</p><ul><li>Ethernet II</li><li>IPv4</li><li>UDP</li><li>MAC-LTE</li><li>RLC-LTE</li><li>PDCP-LTE</li><li>(here should be RoHC part, but I see only "data" - undecoded part)</li></ul><p>In PDCP-LTE protocol preferences, I have checked option "Attempt to decode ROHC data". It seems, that everything is configured OK (apart from ROHC, all other fields in other headers - MAC, RLC, PDCP - are decoded correctly). In some pages, I've read, that the only way to decode RoHC is to have protocol stack with DCT2000 catapult layer, but I can't believe, that it is the only way.</p><p>I will be very grateful, if somebody would like to help me. I used different version of Wireshark, now I use the newest one: 2.0.1.</p><p>EDIT: Because it seems, that without sample file nobody can help, I attached this sample file:</p><p><a href="https://drive.google.com/open?id=0B23kiO_viwuLUHlwRmpyR3JEcmM">https://drive.google.com/open?id=0B23kiO_viwuLUHlwRmpyR3JEcmM</a></p><p>Some properites of traffic here:</p><ol><li>RoHC should be detected on DRB7 and uncompressed profile should be used (so it seems to be easy to decode)</li><li>MAC-LTE settings: I had to uncheck "Attempt to dissect LCID 1&amp;2 as srb 1&amp;2"and use mapping from static table (LCID to DRB: 3:5:AM; 4:6:UM,SN=5; 5:7:UM,SN=5)</li><li>RLC-LTE settings: default values</li><li>PDCP-LTE settings: no ciphering for DRB7, I didn't set values for other DRBs</li></ol></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-pdcp-lte" rel="tag" title="see questions tagged &#39;pdcp-lte&#39;">pdcp-lte</span> <span class="post-tag tag-link-rohc" rel="tag" title="see questions tagged &#39;rohc&#39;">rohc</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>25 Feb '16, 04:33</strong></p><img src="https://secure.gravatar.com/avatar/d893bc2b480c108088570ecfee0673eb?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="zaklopotany&#39;s gravatar image" /><p><span>zaklopotany</span><br />
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="5 badges"><span class="bronze">●</span><span class="badgecount">5</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="zaklopotany has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>01 Mar '16, 00:40</strong> </span></p></div></div><div id="comments-container-50505" class="comments-container"><span id="50508"></span><div id="comment-50508" class="comment"><div id="post-50508-score" class="comment-score"></div><div class="comment-text"><p>Any ciphering in play? Without looking at the capture file details its hard to tell. Please share a sample capture file.</p></div><div id="comment-50508-info" class="comment-info"><span class="comment-age">(25 Feb '16, 08:02)</span> <span class="comment-user userinfo">Jaap ♦</span></div></div><span id="50569"></span><div id="comment-50569" class="comment"><div id="post-50569-score" class="comment-score"></div><div class="comment-text"><p>Hi Jaap,</p><p>Thanks for your comment, I forgot to clarify this. During this time, I checked both cases: without ciphering and with ciphering enabled (in this case, I always entered appropriate encryption keys). The result was always the same - no RoHC data decoded.</p><p>Regarding sample file - unfortunately, I'm affraid, that I'm not allowed to attach such file...</p></div><div id="comment-50569-info" class="comment-info"><span class="comment-age">(29 Feb '16, 00:29)</span> <span class="comment-user userinfo">zaklopotany</span></div></div><span id="50570"></span><div id="comment-50570" class="comment"><div id="post-50570-score" class="comment-score"></div><div class="comment-text"><p>IF you can share the capture, then save it in a publicly accessible spot, e.g. Google Drive, Dropbox etc. and then edit your question with a link to the file.</p><p>If you can't share the capture, then it's very difficult to help any more on this Q&amp;A site.</p><p>Another option might be to raise a bug on the Wireshark <a href="https://bugs.wireshark.org">Bugzilla</a> where attached captures can be marked as private, so that only Wireshark Core Developers have access to it.</p></div><div id="comment-50570-info" class="comment-info"><span class="comment-age">(29 Feb '16, 01:09)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="50607"></span><div id="comment-50607" class="comment"><div id="post-50607-score" class="comment-score"></div><div class="comment-text"><p>I'm probably not the best qualified one to advise as I wasn't able to make Wireshark 2.0.2 read even the UDP encapsulation of MAC-LTE itself in your sample file even though I've checked UDP's preference <code>try heuristic dissectors first</code>, but if by</p><blockquote><p>I've read that the only way to decode RoHC is to have protocol stack with DCT2000 catapult layer, but I can't believe that it is the only way.</p></blockquote><p>you refer to <span>@Pascal Quantin</span>'s comments to <a href="https://ask.wireshark.org/questions/18813/unable-to-see-rohc-decoded-message-in-pdcp-lte-message/18830">this older answer</a>, I'd rather look at the "Note that ROHC support is only partial" remark there.</p><p>Also if your need is only occasional, and as you forge the eth/ip/udp headers to your mac-lte frames anyway, you may prefer to extract the ROHC part alone and provide it with a forged ethernet header with ethertype 0x22f1, as described in <a href="https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=8856#c3">this</a> and the immediately following comment to bug 8856. Also note Pascal's remark that an IR packet has to be present in the capture so that the ROHC dissection could work properly.</p></div><div id="comment-50607-info" class="comment-info"><span class="comment-age">(01 Mar '16, 07:34)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="50609"></span><div id="comment-50609" class="comment"><div id="post-50609-score" class="comment-score"></div><div class="comment-text"><p>Hi Sindy,</p><p>I have to write, that in Wireshark 2.0.1 I also met this kind of problem once (I mean decoding MAC-LTE). Suddenly, the data below UDP wasn't recognized as MAC-LTE. I don't know why, but one setting has changed without my action. To solve this issue, I had to go to “Analyze”-&gt;”Enabled Protocols…” and there set once again checkbox "mac_lte_udp" in "MAC-LTE". Maybe you have the same problem...</p><p>And thank you for your suggestion regarding encapsulation in ethernet frame. If there is no idea to decode this easier, I will surely check this solution.</p></div><div id="comment-50609-info" class="comment-info"><span class="comment-age">(01 Mar '16, 07:51)</span> <span class="comment-user userinfo">zaklopotany</span></div></div><span id="50610"></span><div id="comment-50610" class="comment not_top_scorer"><div id="post-50610-score" class="comment-score"></div><div class="comment-text"><p>Alternatively, you could generate the dct2000 encapsulation header already for the MAC-LTE layer. The advantage of encapsulation of MAC-LTE into eth/ip/udp header is that you can mix it with other encapsulation types in a common pcap(ng) file, but if this is not your need, providing the MAC-LTE frames with the dpt2000 header instead of the eth/ip/udp one could save you the burden of extracting the ROHC data into a separate file and cooking the eth headers for them.</p><p>But as indicated, I suspect that you'd get the same results regardless what encapsulation you use for the MAC-LTE, as the eth/ip/udp pseudo-header should convey the same per-frame info like the dct2000 one.</p></div><div id="comment-50610-info" class="comment-info"><span class="comment-age">(01 Mar '16, 08:37)</span> <span class="comment-user userinfo">sindy</span></div></div></div><div id="comment-tools-50505" class="comment-tools"><span class="comments-showing"> showing 5 of 6 </span> <a href="#" class="show-all-comments-link">show 1 more comments</a></div><div class="clear"></div><div id="comment-50505-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="50675"></span>

<div id="answer-container-50675" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-50675-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-50675-score" class="post-score" title="current number of votes">0</div><span id="post-50675-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span class="accept-answer on" rel="nofollow" title="zaklopotany has selected this answer as the correct answer"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>As explained in the previous threads, for now you cannot decode RoHC packets without having some meta data indicating whether the payload is actually compressed, whether you used large CID or not, the profiles used, ... This is something that is either provided by the DCT2000 capture equipment, or that can be manually provided on a per packet basis when using the <a href="https://code.wireshark.org/review/gitweb?p=wireshark.git;a=blob;f=epan/dissectors/packet-pdcp-lte.h;h=d5d21a96254c2be0be87bfd8d478954f73f28b5a;hb=refs/heads/master">PDCP UDP framing protocol</a> (so it will NOT work when capturing at MAC level.</p><p>One could eventually add the extraction of some RoHC parameters from RRC Connection Reconfiguration messages configuring the DRB, but it would require some non negligible work and your capture does not even seem to contain the RRC messages exchanged on SRB1.</p><p>TO say it simply: no you cannot decode RoHC traffic as-is with Wireshark for now.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>02 Mar '16, 07:07</strong></p><img src="https://secure.gravatar.com/avatar/713f24fd877861260b71ecd455018625?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Pascal%20Quantin&#39;s gravatar image" /><p><span>Pascal Quantin</span><br />
<span class="score" title="5544 reputation points"><span>5.5k</span></span><span title="10 badges"><span class="silver">●</span><span class="badgecount">10</span></span><span title="60 badges"><span class="bronze">●</span><span class="badgecount">60</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Pascal Quantin has 92 accepted answers">30%</span></p></div></div><div id="comments-container-50675" class="comments-container"><span id="50688"></span><div id="comment-50688" class="comment"><div id="post-50688-score" class="comment-score"></div><div class="comment-text"><p>Do I read you right that</p><ul><li><p>in dct2000 encapsulation, a single frame may contain all the LTE layers starting from MAC through PDCP to RoHC, and still the RoHC dissector can do its job because this encapsulation provides space for the metadata necessary to properly interpret the PDCP payload,</p></li><li><p>the UDP "encapsulation" or "pseudo-header" of MAC-LTE layer provides no space for the metadata necessary for the RoHC dissection, so even if <span>@zaklopotany</span> would have these metadata, there would be no possibility to attach them to the frame, so if an UDP "encapsulation" needs to be used, it must be the PDCP - UDP one which provides space for the metadata but not for the LTE layers below PDCP?</p></li></ul></div><div id="comment-50688-info" class="comment-info"><span class="comment-age">(02 Mar '16, 13:14)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="50699"></span><div id="comment-50699" class="comment"><div id="post-50699-score" class="comment-score"></div><div class="comment-text"><p>Catapult DCT2000 can capture data at different layers and from what I can see in the code support PDCP LTE meta data when the PDCP PDUs are captured, not really MAC LTE ones. The same thing applies to the UDP framing info format. The best way to handle this would be to extract the info from RRC messages and have RRC dissector configure the PDCP one. This is a significant work though.</p></div><div id="comment-50699-info" class="comment-info"><span class="comment-age">(03 Mar '16, 00:45)</span> <span class="comment-user userinfo">Pascal Quantin</span></div></div><span id="50714"></span><div id="comment-50714" class="comment"><div id="post-50714-score" class="comment-score"></div><div class="comment-text"><p>Hi Pascal,</p><p>Your answer seems to be clear. Together with other comments, I have now full view on this issue. Thank all of you for your help.</p></div><div id="comment-50714-info" class="comment-info"><span class="comment-age">(04 Mar '16, 01:24)</span> <span class="comment-user userinfo">zaklopotany</span></div></div></div><div id="comment-tools-50675" class="comment-tools"></div><div class="clear"></div><div id="comment-50675-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

