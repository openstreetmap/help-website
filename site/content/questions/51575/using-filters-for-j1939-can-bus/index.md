+++
type = "question"
title = "using filters for j1939 (CAN bus)"
description = '''Hi evb, All is in the topic : I&#x27;m trying to filter my CAN frames with j1939, but apparently the usage on wireshark is incorrect. I suppose the frame No.1 should be still visible if I type &quot;j1939&quot; (or maybe I should precise the extended ID like &quot;j1939.can_id == 0xdeadbeef&quot;) on the textbar... You have...'''
date = "2016-04-12T00:38:00Z"
lastmod = "2016-04-12T06:42:00Z"
weight = 51575
keywords = [ "filter", "j1939", "can", "bus" ]
aliases = [ "/questions/51575" ]
osqa_answers = 1
osqa_accepted = true
+++

<div class="headNormal">

# [using filters for j1939 (CAN bus)](/questions/51575/using-filters-for-j1939-can-bus)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-51575-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-51575-score" class="post-score" title="current number of votes">0</div><span id="post-51575-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hi evb,</p><p>All is in the topic : I'm trying to filter my CAN frames with j1939, but apparently the usage on wireshark is incorrect. I suppose the frame No.1 should be still visible if I type "j1939" (or maybe I should precise the extended ID like "j1939.can_id == 0xdeadbeef") on the textbar...</p><p>You have to know there is nothing responding on my network, I don't know if this is problematic. I just using can-utils "cansend" command and watching if it still appears below. (see screenshots at the end of this post)</p><p>Any advice? I don't know how to proceed... Thank you in advance. Cheers <img src="https://osqa-ask.wireshark.org/upfiles/wireshark_2016-04-12_09:18:51.png" alt="alt text" /> <img src="https://osqa-ask.wireshark.org/upfiles/wireshark_2016-04-12_09:21:14.png" alt="alt text" /></p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-filter" rel="tag" title="see questions tagged &#39;filter&#39;">filter</span> <span class="post-tag tag-link-j1939" rel="tag" title="see questions tagged &#39;j1939&#39;">j1939</span> <span class="post-tag tag-link-can" rel="tag" title="see questions tagged &#39;can&#39;">can</span> <span class="post-tag tag-link-bus" rel="tag" title="see questions tagged &#39;bus&#39;">bus</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>12 Apr '16, 00:38</strong></p><img src="https://secure.gravatar.com/avatar/177e55c0d5e8a290e016f63356e5f9fe?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="lamoule74&#39;s gravatar image" /><p><span>lamoule74</span><br />
<span class="score" title="16 reputation points">16</span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="3 badges"><span class="silver">●</span><span class="badgecount">3</span></span><span title="8 badges"><span class="bronze">●</span><span class="badgecount">8</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="lamoule74 has 2 accepted answers">66%</span></p></img></div></div><div id="comments-container-51575" class="comments-container"><span id="51584"></span><div id="comment-51584" class="comment"><div id="post-51584-score" class="comment-score"></div><div class="comment-text"><p>see below <img src="https://osqa-ask.wireshark.org/upfiles/wireshark_2016-04-12_11:13:07.png" alt="alt text" /></p></div><div id="comment-51584-info" class="comment-info"><span class="comment-age">(12 Apr '16, 02:29)</span> <span class="comment-user userinfo">lamoule74</span></div></div><span id="51588"></span><div id="comment-51588" class="comment"><div id="post-51588-score" class="comment-score"></div><div class="comment-text"><p>OK, so you now have it dissected as J1939, what is your question?</p></div><div id="comment-51588-info" class="comment-info"><span class="comment-age">(12 Apr '16, 03:18)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div></div><div id="comment-tools-51575" class="comment-tools"></div><div class="clear"></div><div id="comment-51575-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="51579"></span>

<div id="answer-container-51579" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-51579-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-51579-score" class="post-score" title="current number of votes">1</div><span id="post-51579-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span class="accept-answer on" rel="nofollow" title="lamoule74 has selected this answer as the correct answer"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>j1939 is a sub-dissector of can, and as can be seen, both from the protocol column and the packet details you have a can frame, so the filter would be <code>can.id == 0x...</code>.</p><p>The easy way to find any filter name is to select the field in question in the packet details pane and then look at the status bar at the bottom which shows the field info. You can also right click any field in the packet details pane and choose "Apply as Filter" or "Prepare a Filter" to have a filter applied or added with the contents of the field you selected.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>12 Apr '16, 01:36</strong></p><img src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="grahamb&#39;s gravatar image" /><p><span>grahamb ♦</span><br />
<span class="score" title="19834 reputation points"><span>19.8k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">●</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">●</span><span class="badgecount">206</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="grahamb has 274 accepted answers">22%</span></p></img></div></div><div id="comments-container-51579" class="comments-container"><span id="51583"></span><div id="comment-51583" class="comment"><div id="post-51583-score" class="comment-score"></div><div class="comment-text"><p>Hello Grahamb and thanks for replying.</p><p>OK, I don't really make the difference between "Apply as Filter" or "Prepare a Filter". That's funny because you didn't really give me the solution because I was trying to put a filter only on the protocol, like through the menu : right click on the frame -&gt; decode as -&gt; then in the field you have to save with the current field.</p><p>Then "J1939" appears in the column protocol.</p><p>Btw, do you know what "value" field is corresponding to in the decode as windows setting? A mask maybe ?...</p></div><div id="comment-51583-info" class="comment-info"><span class="comment-age">(12 Apr '16, 02:24)</span> <span class="comment-user userinfo">lamoule74</span></div></div><span id="51586"></span><div id="comment-51586" class="comment"><div id="post-51586-score" class="comment-score">1</div><div class="comment-text"><p>Your top screenshot clearly shows the protocol as CAN, both in the protocol column and in the packet details. Maybe redo the screenshot with the CAN identifier selected so that the status bar shows the field info.</p><p>"Decode as", as a manual setting to decode traffic on some transport layer as something other than Wireshark is currently decoding. This may be necessary because there is insufficient distinguishing material in a protocol to automatically decode it. In the case of CAN there is no unique identifier to determine the subdissector, so "Decode As ..." must be used.</p><p>Wireshark can be asked to decode CAN traffic as j1939 using the right click "Decode As ...". menu on any CAN frame in the packet list and in the dialog column "Current", select "J1939".</p></div><div id="comment-51586-info" class="comment-info"><span class="comment-age">(12 Apr '16, 02:50)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="51589"></span><div id="comment-51589" class="comment"><div id="post-51589-score" class="comment-score">1</div><div class="comment-text"><ol><li><p>If you right-click on the line saying <code>CAN Identifier: 0x005...</code> in the packet dissection pane and choose <code>Apply as Filter</code> (or <code>Prepare as filter</code>), what syntax gets pre-filled into the display-filter form field? Please copy-paste it here.</p></li><li><p>If you apply that automatically generated filter, is the packet still visible in the packet list or it disappears from there? Means: is the auto-generated filter condition actually working or not?</p></li></ol></div><div id="comment-51589-info" class="comment-info"><span class="comment-age">(12 Apr '16, 03:43)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="51595"></span><div id="comment-51595" class="comment"><div id="post-51595-score" class="comment-score"></div><div class="comment-text"><p>Hey sindy,</p><ol><li>it depends if I click below the group "Controller Area Network" or "SAE J1939"; the syntax is something like can.id == 0x........ or j1939.can_id == 0x........</li></ol><p>2.yes, it works! so everything is good for my application now.</p><p>I understood what I asked initially, so now I just want to know this, go to: right click on any frame -&gt; decode as... -&gt; column Value (I guess because I've got the Fr version)</p><p><strong>What is it ??</strong> what is the usefulness of this cell ? is that a mask ?..</p></div><div id="comment-51595-info" class="comment-info"><span class="comment-age">(12 Apr '16, 05:20)</span> <span class="comment-user userinfo">lamoule74</span></div></div><span id="51596"></span><div id="comment-51596" class="comment"><div id="post-51596-score" class="comment-score"></div><div class="comment-text"><p>The Value, or Valeur, column is for those protocols that do have a unique identifier field to identify sub-protocols, and allows you to set the value for the corresponding sub-protocol.</p></div><div id="comment-51596-info" class="comment-info"><span class="comment-age">(12 Apr '16, 05:33)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="51597"></span><div id="comment-51597" class="comment not_top_scorer"><div id="post-51597-score" class="comment-score"></div><div class="comment-text"><p>I'd make <span>@grahamb</span>'s answer more extended: some protocol dissectors decide which other dissectors to invoke for dissecting their payload using dissection tables. The most clear (and probably not realistic because the TCP dissector actually uses a lot of heuristic) example would be a TCP's dissector table where TCP port is used as index:</p><pre><code>22 -&gt; ssh
23 -&gt; telnet
25 -&gt; smtp
80 -&gt; http</code></pre><p>For most cases, Wireshark already knows the default assignment of such values, so "decode as" is only necessary when a non-standard assignment is used in a particular capture, or when no standard assignment exists at all.</p><p>As there seems to be no "payload type" field in the CAN header, there is no way to use such non-existent value as an index into dissector table, so "Decode as" telling Wireshark that the CAN packets should be interpreted as j1939 must be done manually, and I <strong>suppose</strong> that the "Value" field is ignored in this case (the authoritative answer is in the source code).</p><p>So if all your CAN captures are j1939 ones, this static setting of "Decode as" is all you need; otherwise, you may think of creating several Wireshark profiles with different Decode as settings for CAN (but choosing a profile may need an equal number of clicks as changing the Decode as setting).</p></div><div id="comment-51597-info" class="comment-info"><span class="comment-age">(12 Apr '16, 06:21)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="51600"></span><div id="comment-51600" class="comment not_top_scorer"><div id="post-51600-score" class="comment-score"></div><div class="comment-text"><p>OK, gotcha, thank you.</p></div><div id="comment-51600-info" class="comment-info"><span class="comment-age">(12 Apr '16, 06:42)</span> <span class="comment-user userinfo">lamoule74</span></div></div></div><div id="comment-tools-51579" class="comment-tools"><span class="comments-showing"> showing 5 of 7 </span> <a href="#" class="show-all-comments-link">show 2 more comments</a></div><div class="clear"></div><div id="comment-51579-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

