+++
type = "question"
title = "Decrypt wifi/wlan packets when knowing the shared key"
description = '''I know the key which is used to connect to the wifi. When I type that key in edit-&amp;gt;preferences-&amp;gt;protocol as wp-psw, only the packets which are coming in or from my computer are decrypted. What I need to do in order to decrypt all the packets?'''
date = "2013-09-15T14:35:00Z"
lastmod = "2013-09-15T15:10:00Z"
weight = 24724
keywords = [ "decryption", "wifi", "wlan" ]
aliases = [ "/questions/24724" ]
osqa_answers = 0
osqa_accepted = true
+++

<div class="headNormal">

# [Decrypt wifi/wlan packets when knowing the shared key](/questions/24724/decrypt-wifiwlan-packets-when-knowing-the-shared-key)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-24724-score" class="post-score" title="current number of votes">0</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I know the key which is used to connect to the wifi. When I type that key in edit-&gt;preferences-&gt;protocol as wp-psw, only the packets which are coming in or from my computer are decrypted. What I need to do in order to decrypt all the packets?</p></div><div id="question-tags" class="tags-container tags">decryption wifi wlan</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>15 Sep '13, 14:35</strong></p><img src="https://secure.gravatar.com/avatar/eeca75356089d0569c63dfc514d7f19d?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="tttttttttttt2&#39;s gravatar image" /><p>tttttttttttt2<br />
<span class="score" title="34 reputation points">34</span><span title="7 badges"><span class="badge1">●</span><span class="badgecount">7</span></span><span title="9 badges"><span class="silver">●</span><span class="badgecount">9</span></span><span title="12 badges"><span class="bronze">●</span><span class="badgecount">12</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="tttttttttttt2 has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 15 Sep '13, 15:11</p><img src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Kurt%20Knochner&#39;s gravatar image" /><p>Kurt Knochner ♦<br />
<span class="score" title="24767 reputation points"><span>24.8k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">●</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">●</span><span class="badgecount">237</span></span></p></div></div><div id="comments-container-24724" class="comments-container"></div><div id="comment-tools-24724" class="comment-tools"></div><div class="clear"></div><div id="comment-24724-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="24725"></span>

<div id="answer-container-24725" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-24725-score" class="post-score" title="current number of votes">2</div></div></td><td><div class="item-right"><div class="answer-body"><p>From the <a href="http://wiki.wireshark.org/HowToDecrypt802.11">How to Decrypt 802.11 Wiki</a>:</p><blockquote><p>WPA and WPA2 use keys derived from an EAPOL handshake to encrypt traffic. <strong>Unless all four handshake packets are present</strong> for the session you're trying to decrypt, <strong>Wireshark won't be able to decrypt</strong> the traffic.</p></blockquote><p>So, I guess you do not have the full handshake of the other systems in your capture file. There are (at least) two possible reasons:</p><ul><li>You did not capture them, because the other stations had already connected to the AP when you started to capture in <a href="http://wiki.wireshark.org/CaptureSetup/WLAN#Monitor_mode">monitor mode</a>.</li><li>You did <strong>not capture</strong> in <a href="http://wiki.wireshark.org/CaptureSetup/WLAN#Monitor_mode">monitor mode</a>, and thus you have only your own traffic in the capture file.</li></ul><p>Regards<br />
Kurt</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>15 Sep '13, 15:10</strong></p><img src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Kurt%20Knochner&#39;s gravatar image" /><p>Kurt Knochner ♦<br />
<span class="score" title="24767 reputation points"><span>24.8k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">●</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">●</span><span class="badgecount">237</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Kurt Knochner has 344 accepted answers">15%</span> </br></p></div><div class="post-update-info post-update-info-edited"><p>edited 15 Sep '13, 15:12</p></div></div><div id="comments-container-24725" class="comments-container"><span id="24810"></span><div id="comment-24810" class="comment"><div id="post-24810-score" class="comment-score"></div><div class="comment-text"><p>@KurtKNochner: What do I need to capture? I see 2 messages with EAPOL protocol when the new machine is logged in to the wifi.</p></div><div id="comment-24810-info" class="comment-info"><span class="comment-age">(17 Sep '13, 04:43)</span> tttttttttttt2</div></div><span id="24811"></span><div id="comment-24811" class="comment"><div id="post-24811-score" class="comment-score"></div><div class="comment-text"><p>Take a look at the following capture file.</p><blockquote><p><a href="http://wiki.wireshark.org/SampleCaptures?action=AttachFile&amp;do=get&amp;target=wpa-Induction.pcap">http://wiki.wireshark.org/SampleCaptures?action=AttachFile&amp;do=get&amp;target=wpa-Induction.pcap</a></p></blockquote><p>The WPA password is <strong>Induction</strong>.</p><p>If you use the following display filter, you will see 4 EAPOL frames.</p><blockquote><p>eapol</p></blockquote><p>You need <strong>all 4 frame</strong>, to be able to decrypt the traffic.</p><p>If you see only two, something is not O.K. with your capture setup. As you did not give any information about that, I cannot say what might be wrong.</p></div><div id="comment-24811-info" class="comment-info"><span class="comment-age">(17 Sep '13, 05:19)</span> Kurt Knochner ♦</div></div><span id="24820"></span><div id="comment-24820" class="comment"><div id="post-24820-score" class="comment-score"></div><div class="comment-text"><p>@KurtKnochner: Thank you. Yes, I see only 2nd and 4th packet (what should I do...?). And I know WPA password, it's shared key known to a few people who can connect to this wifi.</p></div><div id="comment-24820-info" class="comment-info"><span class="comment-age">(17 Sep '13, 07:16)</span> tttttttttttt2</div></div><span id="24823"></span><div id="comment-24823" class="comment"><div id="post-24823-score" class="comment-score"></div><div class="comment-text"><p>By the way, I added that password to wpa-pwd, but it decrypts just my computer's packets.</p></div><div id="comment-24823-info" class="comment-info"><span class="comment-age">(17 Sep '13, 07:18)</span> tttttttttttt2</div></div><span id="24825"></span><div id="comment-24825" class="comment"><div id="post-24825-score" class="comment-score"></div><div class="comment-text"><p>how do you capture the traffic of other machines?</p><p>Did you enable monitor mode?</p><p>If yes: how?<br />
If no: Maybe that's your problem.</p></div><div id="comment-24825-info" class="comment-info"><span class="comment-age">(17 Sep '13, 07:32)</span> Kurt Knochner ♦</div></div><span id="24829"></span><div id="comment-24829" class="comment not_top_scorer"><div id="post-24829-score" class="comment-score"></div><div class="comment-text"><p>@KurtKNochner: I am sorry, where can I enable monitor mode? edit: i've found it!</p></div><div id="comment-24829-info" class="comment-info"><span class="comment-age">(17 Sep '13, 07:46)</span> tttttttttttt2</div></div><span id="24830"></span><div id="comment-24830" class="comment not_top_scorer"><div id="post-24830-score" class="comment-score"></div><div class="comment-text"><p>@KurtKNochner: It says I don't have permissions or something to use monitor mode :(</p></div><div id="comment-24830-info" class="comment-info"><span class="comment-age">(17 Sep '13, 07:56)</span> tttttttttttt2</div></div><span id="24835"></span><div id="comment-24835" class="comment not_top_scorer"><div id="post-24835-score" class="comment-score"></div><div class="comment-text"><p>what is your OS?</p></div><div id="comment-24835-info" class="comment-info"><span class="comment-age">(17 Sep '13, 08:25)</span> Kurt Knochner ♦</div></div><span id="24836"></span><div id="comment-24836" class="comment not_top_scorer"><div id="post-24836-score" class="comment-score"></div><div class="comment-text"><p>Ubuntu 13.04</p></div><div id="comment-24836-info" class="comment-info"><span class="comment-age">(17 Sep '13, 08:27)</span> tttttttttttt2</div></div><span id="24838"></span><div id="comment-24838" class="comment not_top_scorer"><div id="post-24838-score" class="comment-score"></div><div class="comment-text"><p>Did you read the section about monitor mode on Linux in the link I posted in my answer? Especially the section <strong>Turning on monitor mode</strong></p></div><div id="comment-24838-info" class="comment-info"><span class="comment-age">(17 Sep '13, 08:31)</span> Kurt Knochner ♦</div></div><span id="24841"></span><div id="comment-24841" class="comment not_top_scorer"><div id="post-24841-score" class="comment-score"></div><div class="comment-text"><p>Damn it I am noob, thanks, I'll try to enable monitor mode. And what exactly does monitor mode do?</p></div><div id="comment-24841-info" class="comment-info"><span class="comment-age">(17 Sep '13, 08:36)</span> tttttttttttt2</div></div><span id="24842"></span><div id="comment-24842" class="comment not_top_scorer"><div id="post-24842-score" class="comment-score"></div><div class="comment-text"><p>It allows you to capture traffic of other stations on a wifi interface. It's all explained in the link I mentioned ;-)</p></div><div id="comment-24842-info" class="comment-info"><span class="comment-age">(17 Sep '13, 08:37)</span> Kurt Knochner ♦</div></div><span id="24859"></span><div id="comment-24859" class="comment not_top_scorer"><div id="post-24859-score" class="comment-score"></div><div class="comment-text"><p>@KurtKNochner: When I tried to run airmon-ng, I got <code>Fatal exception in interrupt</code> and <code>panic occured</code> :(</p></div><div id="comment-24859-info" class="comment-info"><span class="comment-age">(17 Sep '13, 10:40)</span> tttttttttttt2</div></div><span id="24861"></span><div id="comment-24861" class="comment not_top_scorer"><div id="post-24861-score" class="comment-score"></div><div class="comment-text"><p>That does not sound good. Did you run it as root?</p></div><div id="comment-24861-info" class="comment-info"><span class="comment-age">(17 Sep '13, 11:06)</span> Kurt Knochner ♦</div></div><span id="24862"></span><div id="comment-24862" class="comment not_top_scorer"><div id="post-24862-score" class="comment-score"></div><div class="comment-text"><p>Yes.... :(</p></div><div id="comment-24862-info" class="comment-info"><span class="comment-age">(17 Sep '13, 11:21)</span> tttttttttttt2</div></div><span id="24884"></span><div id="comment-24884" class="comment not_top_scorer"><div id="post-24884-score" class="comment-score"></div><div class="comment-text"><p>Please post the full airmon-ng command. What is the output of</p><blockquote><p>ifconfig -a<br />
dmesg | grep wlan</p></blockquote><p>What kind of wifi interface do you use?</p><blockquote><p>and panic occured :(</p></blockquote><p>If this was a kernel panic, I suggest top ask the Ubuntu people what went wrong ;-)</p></div><div id="comment-24884-info" class="comment-info"><span class="comment-age">(18 Sep '13, 00:38)</span> Kurt Knochner ♦</div></div><span id="25068"></span><div id="comment-25068" class="comment not_top_scorer"><div id="post-25068-score" class="comment-score"></div><div class="comment-text"><p>@KurtKnochner : Maybe it's mobile, that's why it captures just 2 packets?</p></div><div id="comment-25068-info" class="comment-info"><span class="comment-age">(22 Sep '13, 05:24)</span> tttttttttttt2</div></div><span id="25072"></span><div id="comment-25072" class="comment not_top_scorer"><div id="post-25072-score" class="comment-score"></div><div class="comment-text"><p>I use eth1 interface</p></div><div id="comment-25072-info" class="comment-info"><span class="comment-age">(22 Sep '13, 07:12)</span> tttttttttttt2</div></div><span id="25073"></span><div id="comment-25073" class="comment not_top_scorer"><div id="post-25073-score" class="comment-score"></div><div class="comment-text"><blockquote><p>@KurtKnochner : Maybe it's mobile, that's why it captures just 2 packets?</p></blockquote><p>mobile? What do you mean?</p><blockquote><p>I use eth1 interface</p></blockquote><p><strong>eth1</strong> is (most certainly) <strong>not a wifi/wlan interface</strong>. So, it is <strong>no surprise</strong> that airmon-ng does not work with eth1, although it should not crash that miserably.</p><p>Don't you see a wlan0 or wlan1 interface on your system? What is the wifi/wlan interface? Is it builtin or a USB adapter? If the later, which one?</p></div><div id="comment-25073-info" class="comment-info"><span class="comment-age">(22 Sep '13, 07:17)</span> Kurt Knochner ♦</div></div><span id="25139"></span><div id="comment-25139" class="comment not_top_scorer"><div id="post-25139-score" class="comment-score"></div><div class="comment-text"><p>only eth1 is shown in wireshark (also eth0), and it catches the packets on eth1, just can't decrypt them</p></div><div id="comment-25139-info" class="comment-info"><span class="comment-age">(23 Sep '13, 16:41)</span> tttttttttttt2</div></div><span id="25141"></span><div id="comment-25141" class="comment not_top_scorer"><div id="post-25141-score" class="comment-score"></div><div class="comment-text"><blockquote><p>only eth1 is shown in wireshark</p></blockquote><p>????</p><p>can you please post the output of the following commands</p><blockquote><p>dmesg | grep eth<br />
lspci<br />
lsusb</p></blockquote></div><div id="comment-25141-info" class="comment-info"><span class="comment-age">(23 Sep '13, 16:56)</span> Kurt Knochner ♦</div></div></div><div id="comment-tools-24725" class="comment-tools"><span class="comments-showing"> showing 5 of 21 </span> <a href="#" class="show-all-comments-link">show 16 more comments</a></div><div class="clear"></div><div id="comment-24725-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

