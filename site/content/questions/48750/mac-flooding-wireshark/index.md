+++
type = "question"
title = "mac flooding wireshark"
description = '''hi all, just wondering, MAC flooding attack. In a typical MAC flooding attack, a switch is flooded with packets, each containing different source MAC addresses. If we consume the limited memory set aside in the switch to store the MAC address-to-physical port translation table it will start to remov...'''
date = "2015-12-29T13:09:00Z"
lastmod = "2015-12-29T14:25:00Z"
weight = 48750
keywords = [ "mac", "flooding" ]
aliases = [ "/questions/48750" ]
osqa_answers = 0
osqa_accepted = true
+++

<div class="headNormal">

# [mac flooding wireshark](/questions/48750/mac-flooding-wireshark)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-48750-score" class="post-score" title="current number of votes">0</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>hi all,</p><p>just wondering, MAC flooding attack. In a typical MAC flooding attack, a switch is flooded with packets, each containing different source MAC addresses. If we consume the limited memory set aside in the switch to store the MAC address-to-physical port translation table it will start to remove valid MAC-to-port mappings.</p><p><strong>All incoming packets are broadcast out on all ports (as with a hub), instead of just down the correct port as per normal operation. A malicious user could then use any packet sniffer (such as Wireshark) running in promiscuous mode to capture sensitive data from other computers (such as unencrypted passwords, e-mail and instant messaging conversations), which would not be accessible were the switch operating normally.</strong></p><p>How can it be technically possible, I mean the MAC table is filled with garbage MAC addresses, removing all valid entries ... so what would happen if I'm in the middle of a file copy between to hosts and both the source and destination MAC addresses get removed? The source MAC is not anymore in the CAM Table (it will not be added because let's say we have reached the limit of 15,000 allowed entries or it would remove another entry to make room for the hosts valid MAC ?? ). What about the destination MAC ? it will broadcast an ARP request in the middle of the file copy process (TCP stream)???</p><p>how can be the data intercepted by Wireshark useful for me ?</p><p>I appreciate all comments!</p><p>BR</p><p>Adam</p></div><div id="question-tags" class="tags-container tags">mac flooding</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>29 Dec '15, 13:09</strong></p><img src="https://secure.gravatar.com/avatar/2b3f26f3a24449776af62dd8cca7715a?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="adasko&#39;s gravatar image" /><p>adasko<br />
<span class="score" title="86 reputation points">86</span><span title="34 badges"><span class="badge1">●</span><span class="badgecount">34</span></span><span title="38 badges"><span class="silver">●</span><span class="badgecount">38</span></span><span title="42 badges"><span class="bronze">●</span><span class="badgecount">42</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="adasko has no accepted answers">0%</span></p></div></div><div id="comments-container-48750" class="comments-container"></div><div id="comment-tools-48750" class="comment-tools"></div><div class="clear"></div><div id="comment-48750-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="48752"></span>

<div id="answer-container-48752" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-48752-score" class="post-score" title="current number of votes">1</div></div></td><td><div class="item-right"><div class="answer-body"><blockquote><p>How can it be technically possible, I mean the MAC table is filled with garbage MAC addresses, ... What about the destination MAC ? it will broadcast an ARP request in the middle of the file copy process (TCP stream)???</p></blockquote><p>You mix two things together, the MAC table of the switch and the arp table of the protocol stack on the connected machine. The MAC flood will make the switch send a copy of any received packet out through all ports, which is a default behaviour for any destination MAC unknown to the switch even if there is no ongoing flood. But any receiving machine will ignore packets whose destination MAC is not that machine's own one, and it will not learn those fake source MACs because it does not need them. Similarly, the sending machine will not lose the association between destination IP and destination MAC, so it has no reason to send a new arp request. If it does have a reason, the arp request will reach its destination as it would normally (as arp requests are normally broadcast anyway), and the response will be delivered too. All this is valid if the MAC flood does not cause packet loss, because as ingress traffic from any port is copied to all ports at egress, the total throughput of the switch is equivalent to the nominal bit rate of a single port (same like with a hub).</p><p>The switch itself never sends ARP requests, it builds the association between ports and a MAC addresses solely based on source MACs of packets coming in through a given port. It means that if you connect a piece of equipment to a port of a switch, the switch does not know its MAC until the piece of equipment sends the first packet. In most cases, such first packet will be an arp response, because any other piece of equipment will first ask for the new equipment's MAC address by sending and arp request. In rare cases, the sending equipment will send a unicast packet with destination MAC of the newly connected one without first using an arp request to determine it, but in such cases, the switch will broadcast that first packet not because its destination MAC address is a broadcast/multicast one but because it is unknown to it. And it will continue to do so until it learns the MAC from an incoming packet which has it as a source one - or forever, see how e.g. Microsoft Network Load Balancing works.</p><p>And even if an arp request arrives to a network adaptor (of a PC) between two packets of a TCP session, it causes no trouble, it is a normal event.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>29 Dec '15, 14:25</strong></p><img src="https://secure.gravatar.com/avatar/00fc6e2633725bd871ff636f0175eabc?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="sindy&#39;s gravatar image" /><p>sindy<br />
<span class="score" title="6049 reputation points"><span>6.0k</span></span><span title="4 badges"><span class="badge1">●</span><span class="badgecount">4</span></span><span title="8 badges"><span class="silver">●</span><span class="badgecount">8</span></span><span title="51 badges"><span class="bronze">●</span><span class="badgecount">51</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="sindy has 110 accepted answers">24%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 29 Dec '15, 14:28</p></div></div><div id="comments-container-48752" class="comments-container"><span id="48756"></span><div id="comment-48756" class="comment"><div id="post-48756-score" class="comment-score"></div><div class="comment-text"><p>But before i can send traffic to a host i need to know it's MAC address. If there's an entry in the CAM table for host A and the receiving host B it will know that it has (the switch) to forward all pacekts for host B to let's say port eth 0/1. After an attack valid entries are removed,so the entry for host B as well. So how can the switch still know where to move the packets? It will broadcast to all ports. But The CAM table is full so how it can again update hosts B mac in it‘s table?</p></div><div id="comment-48756-info" class="comment-info"><span class="comment-age">(30 Dec '15, 01:47)</span> adasko</div></div><span id="48757"></span><div id="comment-48757" class="comment"><div id="post-48757-score" class="comment-score">1</div><div class="comment-text"><p>Once again: if the mapping table (MAC -&gt; port) of the switch does not contain (for any reason) a destination MAC address of a packet, the switch sends the packet out through all ports, i.e. does the same thing it would do if the packet's dst mac would be a broadcast one.</p><p>This behaviour does not affect arp requests, arp responses and normal communication between any two pieces of connected equipment because this is exactly the same what hubs are doing and equipment connected to hubs was doing just fine for years.</p><p>The only purpose of the mapping table is to reduce the collisions: on a hub, if port A receives a packet for port B at the same time when port C receives a packet for port D, both packets will be corrupt because both will be sent to all ports. Thus they will have to be retransmitted (after random delay so that they wouldn't collide again). On a switch, the switching matrix has a throughput which is a double of a sum of ports' speeds, so if the packets do not meet at the same egress (output) port, they do not collide.</p><p>The other part is the recovery after the MAC flood ends. The switch replaces the oldest records in the MAC-&gt;port table with the newest arrivals, which is also a normal operation principle (think about how changes in the network configuration on the fly can be handled). So as long as the flood of fake unique source MACs keeps coming in, the switch keeps doing that, quickly pushing the real MACs of connected equipment out of the table again when they get there. As soon as you stop the flood, the switch learns the valid MACs again in no time because they keep coming.</p></div><div id="comment-48757-info" class="comment-info"><span class="comment-age">(30 Dec '15, 02:28)</span> sindy</div></div><span id="48760"></span><div id="comment-48760" class="comment"><div id="post-48760-score" class="comment-score"></div><div class="comment-text"><p>thank you @sindy for taking the time to answer my questions, I really appreciate it!</p><p>to double check.the switch is behaving like a hub during a mac flooding attack, right ? and because of this, each station running a network analyzer could "see" packets exchanged between each and every hosts in the give LAN segment, right ?</p><p>BR</p><p>Adam</p></div><div id="comment-48760-info" class="comment-info"><span class="comment-age">(30 Dec '15, 11:16)</span> adasko</div></div><span id="48761"></span><div id="comment-48761" class="comment"><div id="post-48761-score" class="comment-score">1</div><div class="comment-text"><p>right and right.</p><p>Just don't forget that you cannot be 100% sure that the network analyzer will see all packets: during the flood, the real MACs of connected equipment also keep appearing as source ones, so for short periods of time, until they get pushed out by the flood again, they exist in the MAC -&gt; port mapping table of the switch. Due to this, some packets may be delivered to their proper destination ports directly and thus not reach the analyzer.</p></div><div id="comment-48761-info" class="comment-info"><span class="comment-age">(30 Dec '15, 11:31)</span> sindy</div></div><span id="48763"></span><div id="comment-48763" class="comment"><div id="post-48763-score" class="comment-score"></div><div class="comment-text"><p>Thank you "sindy. It's finally clear now! Great help!</p><p>wish you a happy new year !</p></div><div id="comment-48763-info" class="comment-info"><span class="comment-age">(30 Dec '15, 12:08)</span> adasko</div></div></div><div id="comment-tools-48752" class="comment-tools"></div><div class="clear"></div><div id="comment-48752-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

