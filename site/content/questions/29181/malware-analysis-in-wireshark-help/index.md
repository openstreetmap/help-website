+++
type = "question"
title = "Malware Analysis In Wireshark help"
description = '''Hello , I searched on the internet tutorials, on how to analyze and detect the virus on the network using Wireshark . I installed Win7 VM, began to catch packets and then activated malware. After 30 seconds, in the wireshark begin to appear a lot of the packages with informations like 122 ... Standa...'''
date = "2014-01-27T07:18:00Z"
lastmod = "2014-01-27T08:18:00Z"
weight = 29181
keywords = [ "malware", "analysis", "wireshark" ]
aliases = [ "/questions/29181" ]
osqa_answers = 2
osqa_accepted = true
+++

<div class="headNormal">

# [Malware Analysis In Wireshark help](/questions/29181/malware-analysis-in-wireshark-help)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-29181-score" class="post-score" title="current number of votes">0</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hello ,</p><p>I searched on the internet tutorials, on how to analyze and detect the virus on the network using Wireshark . I installed Win7 VM, began to catch packets and then activated malware. After 30 seconds, in the wireshark begin to appear a lot of the packages with informations like</p><pre><code>122 ... Standard query 0xd235 A pjplrhpfdeivctxokvxwozcyo.info
123 ... Standard query response 0xd235 No such name
...
392 ... Standard query 0x4499 A orlvpygqlzfeofuhuwkinlfmexw.info
393 ... Standard query response 0x4499 No such name
...</code></pre><p>Which is left on me a positive impression, because I was sure that a malware is activated. However, I would like to know what this info above means "Standard query...", what does wireshark want to say with information such as "Standard query response 0x4499 No such name" ? - That he couldn't establish connection with that fake dns ?</p><p>However, please check the pcap file below, I would like to draw some more info about this malware, since I'm doing a task. Here is a PCAP file of analysis. <a href="http://www.sendspace.com/file/armgyb">PCAP File</a></p></div><div id="question-tags" class="tags-container tags">malware analysis wireshark</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>27 Jan '14, 07:18</strong></p><img src="https://secure.gravatar.com/avatar/bd23f18ea1f2b5981020717fb5be41cc?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Espen&#39;s gravatar image" /><p>Espen<br />
<span class="score" title="21 reputation points">21</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="6 badges"><span class="bronze">●</span><span class="badgecount">6</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Espen has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 27 Jan '14, 08:02</p></div></div><div id="comments-container-29181" class="comments-container"></div><div id="comment-tools-29181" class="comment-tools"></div><div class="clear"></div><div id="comment-29181-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

2 Answers:

</div>

</div>

<span id="29187"></span>

<div id="answer-container-29187" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-29187-score" class="post-score" title="current number of votes">1</div></div></td><td><div class="item-right"><div class="answer-body"><p>Those DNS queries are (most certainly) the attempt to find the malware control server using <a href="http://en.wikipedia.org/wiki/Fast_flux">DNS fast flux</a>. The only positive answer is for the IP (208.73.211.66) - see several DNS queries like this one</p><blockquote><p>frame.number == 146 or frame.number eq 147</p></blockquote><p>Then the malware is connecting to that IP via HTTP</p><blockquote><p>http.request and ip.addr eq 208.73.211.66</p></blockquote><p>Click on one of those frames and select "Follow TCP Stream" to see what gets loaded. If you google for 'typical' strings found in the HTTP conversation (like: turing_cluster_prod), you'll get more information. Of course this is just a first step ;-)</p><p>Regards<br />
Kurt</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>27 Jan '14, 08:18</strong></p><img src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Kurt%20Knochner&#39;s gravatar image" /><p>Kurt Knochner ♦<br />
<span class="score" title="24767 reputation points"><span>24.8k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">●</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">●</span><span class="badgecount">237</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Kurt Knochner has 344 accepted answers">15%</span> </br></p></div><div class="post-update-info post-update-info-edited"><p>edited 27 Jan '14, 08:22</p></div></div><div id="comments-container-29187" class="comments-container"><span id="29199"></span><div id="comment-29199" class="comment"><div id="post-29199-score" class="comment-score"></div><div class="comment-text"><p>Thanks on info!</p></div><div id="comment-29199-info" class="comment-info"><span class="comment-age">(27 Jan '14, 09:14)</span> Espen</div></div></div><div id="comment-tools-29187" class="comment-tools"></div><div class="clear"></div><div id="comment-29187-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="29183"></span>

<div id="answer-container-29183" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-29183-score" class="post-score" title="current number of votes">2</div></div></td><td><div class="item-right"><div class="answer-body"><p>Looks like a Zeus infection to me. What happens is that the Zeus trojan has an algorithm to calculate seemingly random domain names, which the bad guys preregister to run the command &amp; control servers on.</p><p>Of course most of them are not active, because they have to move from domain to domain all the time to avoid being caught. When a domain is not registered you get a "No Such Name" from the DNS servers. It's not a fake DNS - DNS is working fine. It's just that the names the trojan calculated are unknown to the DNS system at that time.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>27 Jan '14, 08:04</strong></p><img src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Jasper&#39;s gravatar image" /><p>Jasper ♦♦<br />
<span class="score" title="23806 reputation points"><span>23.8k</span></span><span title="5 badges"><span class="badge1">●</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">●</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">●</span><span class="badgecount">284</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Jasper has 263 accepted answers">18%</span></p></div></div><div id="comments-container-29183" class="comments-container"><span id="29185"></span><div id="comment-29185" class="comment"><div id="post-29185-score" class="comment-score"></div><div class="comment-text"><p>Yes, you're correct! I've read somewhere that it could be a zeus. However, when I did a scan with a virustotal, it appears to be also a trojan.zbot.. <a href="https://www.virustotal.com/sr/file/0e5a6248d05d94363942ff01409fd7ce9fd6c7e8d18e9d513b4e085c37cd3c79/analysis/1390819629/">https://www.virustotal.com/sr/file/0e5a6248d05d94363942ff01409fd7ce9fd6c7e8d18e9d513b4e085c37cd3c79/analysis/1390819629/</a> However, could you please take a look at my pcap file, and tell me if there's something more interesting that I could look at those packages and describe. Or if you think this is a really bad sample of malware, could you tell me where can I find some malware that does more, like type of a malware which downloads some data.. I pretty much new to the wireshark as well. Thanks!</p></div><div id="comment-29185-info" class="comment-info"><span class="comment-age">(27 Jan '14, 08:14)</span> Espen</div></div><span id="29189"></span><div id="comment-29189" class="comment"><div id="post-29189-score" class="comment-score"></div><div class="comment-text"><p>zbot is another name for "Zeus Bot" if I am not mistaken ;-)</p><p>See Kurts answer on how to find more interesting stuff. Basically what you do is to look for DNS answers that are not "No Such Name" and then filter for the according communication that includes the IP from the successful answer. It will contain a callback and the downloaded malware or command sequence from the C&amp;C servers.</p></div><div id="comment-29189-info" class="comment-info"><span class="comment-age">(27 Jan '14, 08:22)</span> Jasper ♦♦</div></div></div><div id="comment-tools-29183" class="comment-tools"></div><div class="clear"></div><div id="comment-29183-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

