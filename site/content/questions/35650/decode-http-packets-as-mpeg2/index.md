+++
type = "question"
title = "Decode HTTP packets as MPEG2"
description = '''Hello I&#x27;ve been using the &quot;mpeg_dump.lua&quot; wireshark script ( http://wiki.wireshark.org/mpeg_dump.lua ) in order to get the Mpeg Stream from UDP packets. I would like to explain a little bit my test scenario: 1.- I have 2 Set Top Boxes (STB with Ethernet connection), one with internal HDD and the oth...'''
date = "2014-08-21T10:31:00Z"
lastmod = "2014-08-21T10:31:00Z"
weight = 35650
keywords = [ "mpeg28557", "iptv", "dump", "rtp" ]
aliases = [ "/questions/35650" ]
osqa_answers = 0
osqa_accepted = false
+++

<div class="headNormal">

# [Decode HTTP packets as MPEG2](/questions/35650/decode-http-packets-as-mpeg2)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-35650-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-35650-score" class="post-score" title="current number of votes">0</div><span id="post-35650-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hello</p><p>I've been using the "mpeg_dump.lua" wireshark script ( <a href="http://wiki.wireshark.org/mpeg_dump.lua">http://wiki.wireshark.org/mpeg_dump.lua</a> ) in order to get the Mpeg Stream from UDP packets.</p><p>I would like to explain a little bit my test scenario:</p><p>1.- I have 2 Set Top Boxes (STB with Ethernet connection), one with internal HDD and the other one without internal HDD.</p><p>2.- I have IPTV service</p><p>3.- If i do watch Live TV (IPTV) in any STB, and also I get at the same time the packets on wireshark, I can see the UDP packets, then once I select "decode as --&gt; RTP" I can see the MPEG-TS Packets and save the mpeg video by using the mentioned Dump tool (mpeg_dump.lua). You can download and check the dump file "IPTV_Channel_LIVE.pcapng" (around 60mb) and test what I saying in this point. If you just made a "follow UDP stream" from the "IPTV_Channel_LIVE.pcapng" file and then save the result as RAW with .ts or .mpg extension you also will able to watch the same video BUT with garbage pixels LIKE if the video is scrambled.. but is not! because I'm able to clean and save that video by using the dump tool script. (this information is important to the results of the next point)</p><p>"IPTV_Channel_LIVE.pcapng":</p><p><a href="https://mega.co.nz/#!SAZxEToB!UwY9IELlq5ElLuFGgrE-m0bTPRMGybvrGt17YTThO4A">https://mega.co.nz/#!SAZxEToB!UwY9IELlq5ElLuFGgrE-m0bTPRMGybvrGt17YTThO4A</a></p><p>4.- The problem is when I want to capture the MPEG-TS packets from an already recorded channel, stored in the STB with internal HDD (IP 192.168.1.153). In order to capture the packets I made a port mirroring on a router that I have between the STB's, the one with internal HDD and the STB WITHOUT HDD (IP 192.168.1.154). Then in this last STB I look for the recordings that I have stored in the other one and then play it. What I got are HTTP packets sent from 192.168.1.153 to 192.168.1.154. and it seems like a UNICAST broadcast. If i do a "Follow TCP" and then "save the dump in RAW data" (with .mpg or .ts extension) you will be able to watch something in your player (VLC or Media Player Classic) but with garbage pixels LIKE if the video is scrambled.. but is not!!!. I have no way to "decode as --&gt; RTP" the HTTP packets. If i do try to "File --&gt; EXPORT --&gt; Http", i get many many little HTTP files, that can not be reproduced alone. As you can see the RAW file has the same garbage pixels like the UDP stream got in a NORMAL LIVE IPTV capture (when you save it as RAW from the "follow UDP stream)(point 3.-), so the problem here for me is how to dump rightly the HTTP packets in order to get a clean video. Please check the following wireshark captured file in order to evidence the explained at this point:</p><p>"IPTV_RECORDED_CHANNEL.pcapng" (you will see the video is GET as http.. GET /dvrfs/v290.......)</p><p><a href="https://mega.co.nz/#!TE4mDToZ!MYbPFrhA9PdK27SQh9AvZxfwHWnn6WWH6sdmcYeZKII">https://mega.co.nz/#!TE4mDToZ!MYbPFrhA9PdK27SQh9AvZxfwHWnn6WWH6sdmcYeZKII</a></p><ul><li>in the following capture file you will see that i capture 2 recorded videos, once after the other, from the STB with HDD. One video is "tune src='http://192.168.1.153:8080/dvrfs/v242" and the other is "tune src='http://192.168.1.153:8080/dvrfs/v75". Just for your checks. The wireshark captured file is:</li></ul><p>"IPTV_RECORDED_CHANNEL_-_2_Recordings.pcapng":</p><p><a href="https://mega.co.nz/#!mQR1WCQS!NeCgww3sEsk79i2tRdVPUwgj_BW2OkHpfE3GpZ_39OY">https://mega.co.nz/#!mQR1WCQS!NeCgww3sEsk79i2tRdVPUwgj_BW2OkHpfE3GpZ_39OY</a></p><p>Please I'm asking for your help in order to get the mpeg-ts stream from the recorded videos on the STB with HDD.</p><p>Please fell free to ask any question and thanks in advance for your help and support!</p><p>Regards!</p><p>PD: sorry for my bad english :/</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-mpeg28557" rel="tag" title="see questions tagged &#39;mpeg28557&#39;">mpeg28557</span> <span class="post-tag tag-link-iptv" rel="tag" title="see questions tagged &#39;iptv&#39;">iptv</span> <span class="post-tag tag-link-dump" rel="tag" title="see questions tagged &#39;dump&#39;">dump</span> <span class="post-tag tag-link-rtp" rel="tag" title="see questions tagged &#39;rtp&#39;">rtp</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>21 Aug '14, 10:31</strong></p><img src="https://secure.gravatar.com/avatar/21efd0d60f3b6ff711b4985c93247fef?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Bellower&#39;s gravatar image" /><p><span>Bellower</span><br />
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Bellower has no accepted answers">0%</span></p></div></div><div id="comments-container-35650" class="comments-container"></div><div id="comment-tools-35650" class="comment-tools"></div><div class="clear"></div><div id="comment-35650-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

</div>

