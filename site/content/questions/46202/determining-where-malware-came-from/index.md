+++
type = "question"
title = "Determining where malware came from"
description = '''I can&#x27;t find antivirus software that will tell me where malware came from once it&#x27;s detected by a full scan. My current AV software is Microsoft Security Essentials and it just gives me the name of the malware, its location on my hard drive, and its threat level. What&#x27;s the easiest way to figure out...'''
date = "2015-09-27T16:30:00Z"
lastmod = "2015-10-01T22:55:00Z"
weight = 46202
keywords = [ "origin", "malware", "antivirus" ]
aliases = [ "/questions/46202" ]
osqa_answers = 1
osqa_accepted = true
+++

<div class="headNormal">

# [Determining where malware came from](/questions/46202/determining-where-malware-came-from)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-46202-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-46202-score" class="post-score" title="current number of votes">0</div><span id="post-46202-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I can't find antivirus software that will tell me where malware came from once it's detected by a full scan. My current AV software is Microsoft Security Essentials and it just gives me the name of the malware, its location on my hard drive, and its threat level. What's the easiest way to figure out what website it came from? I was thinking I can determine when it was saved to my computer using the file manager or a command at the command line, then I can check a Wireshark log to see what was happening at that time. Is that really the easiest way?</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-origin" rel="tag" title="see questions tagged &#39;origin&#39;">origin</span> <span class="post-tag tag-link-malware" rel="tag" title="see questions tagged &#39;malware&#39;">malware</span> <span class="post-tag tag-link-antivirus" rel="tag" title="see questions tagged &#39;antivirus&#39;">antivirus</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>27 Sep '15, 16:30</strong></p><img src="https://secure.gravatar.com/avatar/109042482d7739fbdbc5bb078bf9cf9f?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Barry%20Pencil&#39;s gravatar image" /><p><span>Barry Pencil</span><br />
<span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Barry Pencil has no accepted answers">0%</span></p></div></div><div id="comments-container-46202" class="comments-container"></div><div id="comment-tools-46202" class="comment-tools"></div><div class="clear"></div><div id="comment-46202-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="46208"></span>

<div id="answer-container-46208" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-46208-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-46208-score" class="post-score" title="current number of votes">1</div><span id="post-46208-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span class="accept-answer on" rel="nofollow" title="Barry Pencil has selected this answer as the correct answer"> </span></div></td><td><div class="item-right"><div class="answer-body"><blockquote><p>Is that really the easiest way?</p></blockquote><p>One option would be to get a malware scanner that is able to scan your network data streams (HTTP, HTTPS, POP3, IMAP, MAPI, whatever). <strong>HOWEVER</strong> Even then you will not be 100% safe. Often a new malware won't be detected by the current pattern database of all AV vendors, so the malware will slip through and it will be detected only days, weeks or months later by a disk scan after a pattern was developed.</p><p>An that's exactly the problem with network forensics. Malware can sit undetected on a system for weeks/months, so you would have to collect an store the whole network traffic for that period of time (several 100Gbyte or even Tbyte) and that's certainly impossible on a typical enduser PC/Laptop.</p><p>Sorry, I don't have a technical network forensic solution for your scenario, as I believe there exists none, at least not a feasible one.</p><p>What I usually do: Use a virtual machine for Internet access (Linux based, if possible), which I reset at every start. That way a possible malware infection has the least possible impact.</p><p>Regards<br />
Kurt</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>28 Sep '15, 01:05</strong></p><img src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Kurt%20Knochner&#39;s gravatar image" /><p><span>Kurt Knochner ♦</span><br />
<span class="score" title="24767 reputation points"><span>24.8k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">●</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">●</span><span class="badgecount">237</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Kurt Knochner has 344 accepted answers">15%</span> </br></p></div></div><div id="comments-container-46208" class="comments-container"><span id="46257"></span><div id="comment-46257" class="comment"><div id="post-46257-score" class="comment-score"></div><div class="comment-text"><p>It sounds like I could use one of those data stream scanners in addition to regular AV software. I was hoping to use just one product but maybe I'll use two if necessary. I found Snort and Suricata but I didn't download anything yet. I wish there was regular, popular AV software that did this.</p></div><div id="comment-46257-info" class="comment-info"><span class="comment-age">(29 Sep '15, 08:11)</span> <span class="comment-user userinfo">Barry Pencil</span></div></div><span id="46263"></span><div id="comment-46263" class="comment"><div id="post-46263-score" class="comment-score"></div><div class="comment-text"><blockquote><p>It sounds like I could use one of those data stream scanners in addition to regular AV software.</p></blockquote><p>That's usually part of every AV suite!</p></div><div id="comment-46263-info" class="comment-info"><span class="comment-age">(29 Sep '15, 11:27)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="46269"></span><div id="comment-46269" class="comment"><div id="post-46269-score" class="comment-score"></div><div class="comment-text"><p>Let me rephrase what I want just in case I'm on the wrong path. My current AV software (Microsoft Security Essentials) doesn't notify me in real time of files that match virus definitions if they're not in a dangerous location, for example, if the file is in Temporary Internet Files, I won't be notified at the time of the infection. I will only be notified after a full scan, but at that time it's much harder to determine which website was the cause. So, I want software that will help me to determine where malware came from, even if the malware (anything that fits a malware definition) is headed to Temporary Internet Files.</p><p>In other words, I want everything that reaches my computer to be scanned and I want to know what website sent me anything that matches a malware definition.</p></div><div id="comment-46269-info" class="comment-info"><span class="comment-age">(29 Sep '15, 15:44)</span> <span class="comment-user userinfo">Barry Pencil</span></div></div><span id="46270"></span><div id="comment-46270" class="comment"><div id="post-46270-score" class="comment-score"></div><div class="comment-text"><p>O.K. one more time, in other words: AV software is not perfect! If you get hit by a totally unknown malware <strong>tomorrow</strong>, no AV software will detect that, no matter where you save that piece of data. So, that malware can sit undetected on your computer for days, weeks or even months until your AV vendor (and all other) learn about that new virus/trojan/whatever. Then they will update their pattern database and your scanner will find the malware on the disk. But then it's too late to figure out where it came from, because that information is gone, after weeks, months! It's a general technological problem/limit with no (simple) solution.</p></div><div id="comment-46270-info" class="comment-info"><span class="comment-age">(29 Sep '15, 16:38)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="46272"></span><div id="comment-46272" class="comment"><div id="post-46272-score" class="comment-score"></div><div class="comment-text"><p>Yes, but if there IS a malware definition for something that reached my computer, I don't think I'm always notified. I want to be, even if the malware isn't executable.</p><p>A couple of days ago I did a full scan (I do them every few weeks) and Ransom:JS/Brolo.C was found. I have real-time protection turned on but I wasn't alerted to this malware in real time. Only after the full scan. It's in Temporary Internet Files.</p><p>Here's information on Ransom:JS/Brolo.C from Microsoft's website:</p><p>Alert level: Severe First detected by definition: 1.201.2067.0 Latest detected by definition: 1.201.2067.0 and higher First detected on: Jul 17, 2015 This entry was first published on: Oct 27, 2014 This entry was updated on: Sep 10, 2015</p><p>If something isn't detected because there's no malware definition, that's understandable. I'm not trying to fix that. I just want to be made aware of where malware came from IF there's a definition at the time it reaches my computer. Even if it's in Temporary Internet Files and can't hurt my computer, I still want to know what website sent it to me.</p></div><div id="comment-46272-info" class="comment-info"><span class="comment-age">(29 Sep '15, 17:29)</span> <span class="comment-user userinfo">Barry Pencil</span></div></div><span id="46274"></span><div id="comment-46274" class="comment not_top_scorer"><div id="post-46274-score" class="comment-score"></div><div class="comment-text"><blockquote><p>I just want to be made aware of where malware came from IF there's a definition at the time it reaches my computer.</p></blockquote><p>EVERY decent AV suite is able to do that, apparently besides your tool. But maybe it's just a config issue!</p></div><div id="comment-46274-info" class="comment-info"><span class="comment-age">(29 Sep '15, 19:30)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="46336"></span><div id="comment-46336" class="comment not_top_scorer"><div id="post-46336-score" class="comment-score"></div><div class="comment-text"><p>I've heard that viruses in Temporary Internet Files aren't important, and it looked like I had one that was ignored by a real-time scan but maybe it wasn't. I'll have to wait for my next virus detection to know for sure. Maybe there wasn't a definition for my last virus until my full scan, or maybe I forgot about a real-time detection.</p></div><div id="comment-46336-info" class="comment-info"><span class="comment-age">(01 Oct '15, 22:55)</span> <span class="comment-user userinfo">Barry Pencil</span></div></div></div><div id="comment-tools-46208" class="comment-tools"><span class="comments-showing"> showing 5 of 7 </span> <a href="#" class="show-all-comments-link">show 2 more comments</a></div><div class="clear"></div><div id="comment-46208-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

