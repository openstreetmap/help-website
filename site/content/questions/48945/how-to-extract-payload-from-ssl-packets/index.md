+++
type = "question"
title = "How to extract payload from SSL packets"
description = '''Hello I have a problem about how to extract(not decrypt) payload from SSL packets. I have tried the methods mentioned in the https://ask.wireshark.org/questions/25371/how-to-extract-hex-data-from-ssl, but it didn&#x27;t work. Is there anyone can help me? Thanks!! '''
date = "2016-01-07T07:41:00Z"
lastmod = "2016-01-11T08:06:00Z"
weight = 48945
keywords = [ "ssl", "payload" ]
aliases = [ "/questions/48945" ]
osqa_answers = 1
osqa_accepted = false
+++

<div class="headNormal">

# [How to extract payload from SSL packets](/questions/48945/how-to-extract-payload-from-ssl-packets)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-48945-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-48945-score" class="post-score" title="current number of votes">0</div><span id="post-48945-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hello I have a problem about how to extract(not decrypt) payload from SSL packets. I have tried the methods mentioned in the <a href="https://ask.wireshark.org/questions/25371/how-to-extract-hex-data-from-ssl,">https://ask.wireshark.org/questions/25371/how-to-extract-hex-data-from-ssl,</a> but it didn't work. Is there anyone can help me? Thanks!!</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-ssl" rel="tag" title="see questions tagged &#39;ssl&#39;">ssl</span> <span class="post-tag tag-link-payload" rel="tag" title="see questions tagged &#39;payload&#39;">payload</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>07 Jan '16, 07:41</strong></p><img src="https://secure.gravatar.com/avatar/5829e3b672ce222462faed04eef05eec?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Leo&#39;s gravatar image" /><p><span>Leo</span><br />
<span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Leo has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>08 Jan '16, 15:57</strong> </span></p><img src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Kurt%20Knochner&#39;s gravatar image" /><p><span>Kurt Knochner ♦</span><br />
<span class="score" title="24767 reputation points"><span>24.8k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">●</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">●</span><span class="badgecount">237</span></span></p></div></div><div id="comments-container-48945" class="comments-container"><span id="48953"></span><div id="comment-48953" class="comment"><div id="post-48953-score" class="comment-score"></div><div class="comment-text"><p>What payload are you referring to? The decrypted SSL data from the <em>Application Data</em> records, all TLS-related packets (the TCP payload) or something else?</p></div><div id="comment-48953-info" class="comment-info"><span class="comment-age">(07 Jan '16, 12:09)</span> <span class="comment-user userinfo">Lekensteyn</span></div></div><span id="48956"></span><div id="comment-48956" class="comment"><div id="post-48956-score" class="comment-score"></div><div class="comment-text"><p>The payload is the whole data we can see in the "Secure Socket Layer". Is that possible?Thanks!</p></div><div id="comment-48956-info" class="comment-info"><span class="comment-age">(07 Jan '16, 15:24)</span> <span class="comment-user userinfo">Leo</span></div></div><span id="49000"></span><div id="comment-49000" class="comment"><div id="post-49000-score" class="comment-score"></div><div class="comment-text"><p>I still don't understand if you want to get the SSL protocol data or the <strong>decrypted payload</strong>. Can you please elaborate?</p></div><div id="comment-49000-info" class="comment-info"><span class="comment-age">(08 Jan '16, 15:57)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="49011"></span><div id="comment-49011" class="comment"><div id="post-49011-score" class="comment-score"></div><div class="comment-text"><p>Actually , i am analyzing the packets created by malware. It uses the tcp port 443 to send data, and i found it did not follow the standard SSL protocol. The victims' stolen data were in the Secure Socket Layer just like the diagram below, so i want to extract it and output it to a file. Is that possible? Thanks!</p></div><div id="comment-49011-info" class="comment-info"><span class="comment-age">(09 Jan '16, 06:51)</span> <span class="comment-user userinfo">Leo</span></div></div><span id="49012"></span><div id="comment-49012" class="comment"><div id="post-49012-score" class="comment-score"></div><div class="comment-text"><p><img src="https://osqa-ask.wireshark.org/upfiles/sample.jpg" alt="alt text" /></p></div><div id="comment-49012-info" class="comment-info"><span class="comment-age">(09 Jan '16, 06:51)</span> <span class="comment-user userinfo">Leo</span></div></div><span id="49049"></span><div id="comment-49049" class="comment not_top_scorer"><div id="post-49049-score" class="comment-score"></div><div class="comment-text"><p><img src="https://osqa-ask.wireshark.org/upfiles/g_UyYrOtQ.jpg" alt="alt text" /></p></div><div id="comment-49049-info" class="comment-info"><span class="comment-age">(10 Jan '16, 05:58)</span> <span class="comment-user userinfo">Leo</span></div></div></div><div id="comment-tools-48945" class="comment-tools"><span class="comments-showing"> showing 5 of 6 </span> <a href="#" class="show-all-comments-link">show 1 more comments</a></div><div class="clear"></div><div id="comment-48945-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="49020"></span>

<div id="answer-container-49020" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-49020-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-49020-score" class="post-score" title="current number of votes">0</div><span id="post-49020-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>"Looks" like regular SSL/TLS traffic !?! So, you want to save the highlighted (blue) part into a file? If so, just right click the frame, choose <strong>Follow TCP Stream</strong> and then select <strong>Raw</strong> and <strong>Save as</strong>.</p><p>But I doubt that you will get any 'data file', as this really looks like SSL/TLS protocol data. Anyway, hard to tell without access to the pcap file...</p><p>Regards<br />
Kurt</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>09 Jan '16, 11:50</strong></p><img src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Kurt%20Knochner&#39;s gravatar image" /><p><span>Kurt Knochner ♦</span><br />
<span class="score" title="24767 reputation points"><span>24.8k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">●</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">●</span><span class="badgecount">237</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Kurt Knochner has 344 accepted answers">15%</span> </br></p></img></div></div><div id="comments-container-49020" class="comments-container"><span id="49038"></span><div id="comment-49038" class="comment"><div id="post-49038-score" class="comment-score"></div><div class="comment-text"><p>Thanks a lot for your reply! Yes, i can use the method you said to choose Follow TCP Stream and then select Raw and Save as(the diagram is below). My next questions is that i want to know how to extract those information and out put them in Hex form by tshark.exe or other tools (because i have lots of packet files)? Thanks!!</p></div><div id="comment-49038-info" class="comment-info"><span class="comment-age">(09 Jan '16, 19:14)</span> <span class="comment-user userinfo">Leo</span></div></div><span id="49039"></span><div id="comment-49039" class="comment"><div id="post-49039-score" class="comment-score"></div><div class="comment-text"><p>BTW,you are right! The sample in the diagram is the regular SSL/TLS traffic, i just use it as an example,it is not the real malicious traffic. Thanks!!</p></div><div id="comment-49039-info" class="comment-info"><span class="comment-age">(09 Jan '16, 19:20)</span> <span class="comment-user userinfo">Leo</span></div></div><span id="49050"></span><div id="comment-49050" class="comment"><div id="post-49050-score" class="comment-score"></div><div class="comment-text"><p>Please see my answer to a similar question:</p><blockquote><p><a href="https://ask.wireshark.org/questions/40289/how-to-display-the-full-tcp-payload-from-a-pcap-using-tshark">https://ask.wireshark.org/questions/40289/how-to-display-the-full-tcp-payload-from-a-pcap-using-tshark</a><br />
</p></blockquote><p>You can try to work with the option <strong>-z follow,tcp,hex,</strong></p><p>Or these:</p><blockquote><p><a href="https://ask.wireshark.org/questions/21991/how-to-use-tshark-to-extract-tcp-hex-portion">https://ask.wireshark.org/questions/21991/how-to-use-tshark-to-extract-tcp-hex-portion</a><br />
</p><p><a href="https://ask.wireshark.org/questions/15928/how-to-export-hex-and-timestamp">https://ask.wireshark.org/questions/15928/how-to-export-hex-and-timestamp</a></p></blockquote></div><div id="comment-49050-info" class="comment-info"><span class="comment-age">(10 Jan '16, 07:12)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="49084"></span><div id="comment-49084" class="comment"><div id="post-49084-score" class="comment-score"></div><div class="comment-text"><p>Thanks for your reply!! i will keep trying it!</p></div><div id="comment-49084-info" class="comment-info"><span class="comment-age">(11 Jan '16, 07:37)</span> <span class="comment-user userinfo">Leo</span></div></div><span id="49086"></span><div id="comment-49086" class="comment"><div id="post-49086-score" class="comment-score"></div><div class="comment-text"><p>good luck.</p><p>Hint: If a supplied answer resolves your question can you please "accept" it by clicking the checkmark icon next to it. This highlights good answers for the benefit of subsequent users with the same or similar questions. For extra points you can up vote the answer (thumb up).</p></div><div id="comment-49086-info" class="comment-info"><span class="comment-age">(11 Jan '16, 08:06)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div></div><div id="comment-tools-49020" class="comment-tools"></div><div class="clear"></div><div id="comment-49020-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

