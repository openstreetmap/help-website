+++
type = "question"
title = "Fatal Error LNK 1112 when building Wireshark for Windows 7-64bit"
description = '''I&#x27;m trying to build a 64bit version of Wireshark, but I cannot complete the compilation because I have some errors, among which the first is  QT5Widgets_lib(Qt5Widgets.dll) : fatal error LNK 1112: module machine type &#x27;x86&#x27; conflicts with target machine type &#x27;x64&#x27;.  I know that I have probably not se...'''
date = "2014-08-01T07:55:00Z"
lastmod = "2014-08-01T09:00:00Z"
weight = 35068
keywords = [ "link", "build", "64-bit" ]
aliases = [ "/questions/35068" ]
osqa_answers = 0
osqa_accepted = true
+++

<div class="headNormal">

# [Fatal Error LNK 1112 when building Wireshark for Windows 7-64bit](/questions/35068/fatal-error-lnk-1112-when-building-wireshark-for-windows-7-64bit)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-35068-score" class="post-score" title="current number of votes">0</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I'm trying to build a 64bit version of Wireshark, but I cannot complete the compilation because I have some errors, among which the first is</p><pre><code>QT5Widgets_lib(Qt5Widgets.dll) : fatal error LNK 1112: module machine type &#39;x86&#39; conflicts with target machine type &#39;x64&#39;.</code></pre><p>I know that I have probably not set some option for the x64 compiling, but I cannot find where. Here you have the steps I do, following the Wireshark Developers' Guide:</p><pre><code>-&quot;C:\Program Files\Microsoft SDKs\Windows\v7.1\Bin\SetEnv.Cmd&quot; /Release /x64

-set WIRESHARK_TARGET_PLATFORM=win64

-C:\Development\Copied_script.bat</code></pre><p>Note: this Copied_script that I put there is the script taken from the guide, that I have modified as follow:</p><pre><code>   &lt;&lt;
   @echo off

   set CYGWIN_BIN=C:\cygwin64\bin
   set QT5_BIN=C:\Qt\Qt5.3.1\5.3\msvc2010_opengl\bin
   set MSVC_BIN=&quot;C:\Program Files\Microsoft SDKs\Windows\v7.1\Bin&quot;

   :x64
   echo Adding things to the path...
   set PATH=%PATH%;%CYGWIN_BIN%;%QT5_BIN%
   set WIRESHARK_TARGET_PLATFORM=win64
   call %MSVC_BIN%\SetEnv.Cmd /Release /x64
   title Command Prompt (VC++ 2010 x64)
   goto :eof

&gt;&gt;</code></pre><p>In practice,I've just deleted some parts, and corrected the paths.</p><pre><code>-nmake -f Makefile.nmake verify_tools (that returns me exactly the desired output)

-nmake -f Makefile.nmake setup (everything downloaded and unzipped correctly)

-nmake -f Makefile.nmake distclean (still no errors)

-nmake -f Makefile.nmake all (here I have the error above)</code></pre><p>Furthermore I have this 2 errors:</p><pre><code>NMAKE : fatal error U1077: &quot;C:\...\link.EXE&quot; return code 0x458
NMAKE : fatal error U1077: &quot;C:\...\nmake.EXE&quot; return code 0x2</code></pre><p>Cuold someone please help me?</p></div><div id="question-tags" class="tags-container tags">link build 64-bit</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>01 Aug '14, 07:55</strong></p><img src="https://secure.gravatar.com/avatar/e1fba327ed394306c1606291dedfd698?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="francesco_bigotto&#39;s gravatar image" /><p>francesco_bi...<br />
<span class="score" title="21 reputation points">21</span><span title="4 badges"><span class="badge1">●</span><span class="badgecount">4</span></span><span title="5 badges"><span class="silver">●</span><span class="badgecount">5</span></span><span title="9 badges"><span class="bronze">●</span><span class="badgecount">9</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="francesco_bigotto has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 01 Aug '14, 08:54</p><img src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="grahamb&#39;s gravatar image" /><p>grahamb ♦<br />
<span class="score" title="19834 reputation points"><span>19.8k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">●</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">●</span><span class="badgecount">206</span></span></p></div></div><div id="comments-container-35068" class="comments-container"></div><div id="comment-tools-35068" class="comment-tools"></div><div class="clear"></div><div id="comment-35068-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="35070"></span>

<div id="answer-container-35070" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-35070-score" class="post-score" title="current number of votes">2</div></div></td><td><div class="item-right"><div class="answer-body"><blockquote><p><code>set QT5_BIN=C:\Qt\Qt5.3.1\5.3\msvc2010_opengl\bin</code></p></blockquote><p>This looks like an x86 version of QT. I don't know if the QT downloads have a Windows x64 version for VS2010. I can't see one in the list anyway, it seems you need at least VS2012 for an x64 version of QT.</p><p>You might also want to follow the Developers Guide exactly as written. Any modifications you make are likely to cause you issues.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>01 Aug '14, 09:00</strong></p><img src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="grahamb&#39;s gravatar image" /><p>grahamb ♦<br />
<span class="score" title="19834 reputation points"><span>19.8k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">●</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">●</span><span class="badgecount">206</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="grahamb has 274 accepted answers">22%</span></p></div></div><div id="comments-container-35070" class="comments-container"><span id="35130"></span><div id="comment-35130" class="comment"><div id="post-35130-score" class="comment-score"></div><div class="comment-text"><p>I removed all the references to Qt, in order to build just a GTK version of wireshark. I've done this by commenting out the Qt_base_dir variable in config.nmake, and in the Copied_script. It seems that's enough, because when I run nmake verify_tools, I get the answer "Qt not found". Now I still have a LNK problem:</p><p>inffasx64.obj : fatal error LNK 1112: module machine type 'x86' conflicts with target machine type 'x64'.</p><p>To help you help me, I found a hint: I modified the Copied_script, and now I use exactly the one given in the step-by-step guide (except that I removed the declaration for Qt variable). I have noticed that it doesn't take the road of x64 compilation! Probably there is still something somewhere set to target x86, but unfortunately I don't know what to modify to make work correctly. Can you suggest what to modify?</p></div><div id="comment-35130-info" class="comment-info"><span class="comment-age">(04 Aug '14, 02:16)</span> francesco_bi...</div></div><span id="35132"></span><div id="comment-35132" class="comment"><div id="post-35132-score" class="comment-score">2</div><div class="comment-text"><p>It would help if you gave the context for the link problem, but in general wrong machine type errors indicate the object file has been compiled with one architecture and you're trying to link it as another. This can come about if you have previously compiled as x86 and haven't done a "clean" (and then double check with <code>del /s *.obj</code>) to remove all old object files.</p></div><div id="comment-35132-info" class="comment-info"><span class="comment-age">(04 Aug '14, 02:37)</span> grahamb ♦</div></div><span id="35134"></span><div id="comment-35134" class="comment not_top_scorer"><div id="post-35134-score" class="comment-score"></div><div class="comment-text"><p>I haven't done any x86 build, my first attempt was a x64 build! What context should I give you to make the problem clearer? I saw that when I call the batch script, which begins with</p><p>if "%1" == "" goto x86</p><p>if /i %1 == x86 goto x86</p><p>if /i %1 == x64 goto x64</p><p>goto usage</p><p>the program takes the x86 way! Why? I set the environment variable WIRESHARK_TARGET_PLATFORM=win64, and I used the SetEnv.cmd with the /x64 option, in fact, in the top of the command line there's written "Targeting Windows 7 x64 Release". Should I modify/have modified anything else?</p></div><div id="comment-35134-info" class="comment-info"><span class="comment-age">(04 Aug '14, 03:08)</span> francesco_bi...</div></div><span id="35135"></span><div id="comment-35135" class="comment not_top_scorer"><div id="post-35135-score" class="comment-score"></div><div class="comment-text"><p>I don't even know what do those "%1" or /I mean. Are they variable? Where are they declared? How can I find/change them?</p></div><div id="comment-35135-info" class="comment-info"><span class="comment-age">(04 Aug '14, 03:12)</span> francesco_bi...</div></div><span id="35136"></span><div id="comment-35136" class="comment"><div id="post-35136-score" class="comment-score">1</div><div class="comment-text"><p>Context as in what were the preceding lines of output before the error occurred.</p><p><code>%1</code> in a batch file denotes the first parameter passed into the batch file, the <code>/i</code> option to <code>if</code> indicates a case insensitive comparison. The batch files assumes that with no parameter an x86 build is desired. To get an x64 build you must pass a parameter of "x64".</p><p>I'm not particularly happy with that batch file as it does things that are, IMHO, unnecessary such as adding things to the path which are already done by the makefiles.</p><p>FWIW my version (for VS2010 x86 is): <code> REM Environment setup for Wireshark set CYGWIN=nodosfilewarning set WIRESHARK_BASE_DIR=E:\Wireshark set WIRESHARK_TARGET_PLATFORM=win32 set QT5_BASE_DIR=C:\qt\Qt-5.1.1-MSVC2010-win32-ws set VisualStudioVersion=10.0 set WIRESHARK_VERSION_EXTRA=-GMB</code></p><p>Note that I also run my version in a command prompt from the start Menu "[Microsoft ]Visual Studio xxxx" | "Visual Studio Tools" | "Visual Studio .... Command Prompt" which sets the correct Visual Studio command line environment. This saves working out whether to call the SDK SetEnv.Cmd, or the VS vcvars32.bat or the vcvarsall.bat</p></div><div id="comment-35136-info" class="comment-info"><span class="comment-age">(04 Aug '14, 03:32)</span> grahamb ♦</div></div><span id="35137"></span><div id="comment-35137" class="comment not_top_scorer"><div id="post-35137-score" class="comment-score"></div><div class="comment-text"><p>so I post some of the output I had when trying to compile.</p><p><code> OUTPUT OF: nmake -f Makefile.nmake verify_tools</code></p><p><code></code></p><p><code>Setting SDK environment relative to C:\Program Files\Microsoft SDKs\Windows\v7.1. Targeting Windows 7 x64 Release</code></p><code></code><p>C:\Windows\System32&gt;cd C:\Development\wireshark</p><p>C:\Development\wireshark&gt;nmake -f Makefile.nmake verify_tools</p><p>Microsoft (R) Program Maintenance Utility Version 10.00.40219.01 Copyright (C) Microsoft Corporation. All rights reserved.</p><p>Can't find Qt. This will become a problem at some point. Checking for required applications: cl: /cygdrive/c/Program Files (x86)/Microsoft Visual Studio 10.0/VC/Bin/amd64/cl link: /cygdrive/c/Program Files (x86)/Microsoft Visual Studio 10.0/VC/Bin/amd64/link nmake: /cygdrive/c/Program Files (x86)/Microsoft Visual Studio 10.0/VC/Bin/amd64/nmake bash: /usr/bin/bash bison: /usr/bin/bison flex: /usr/bin/flex env: /usr/bin/env grep: /usr/bin/grep /usr/bin/find: /usr/bin/find peflags: /usr/bin/peflags perl: /usr/bin/perl C:\Python27\python.exe: /cygdrive/c/Python27/python.exe sed: /usr/bin/sed unzip: /usr/bin/unzip wget: /usr/bin/wget</p></code><p><code>C:\Development\wireshark&gt;</code></p></div><div id="comment-35137-info" class="comment-info"><span class="comment-age">(04 Aug '14, 04:01)</span> francesco_bi...</div></div><span id="35138"></span><div id="comment-35138" class="comment not_top_scorer"><div id="post-35138-score" class="comment-score"></div><div class="comment-text"><p>OUTPUT OF: nmake -f Makefile.nmake setup Obviously it was much longer, but all the modules had more or less this output</p><p><code> *** WinSparkle-0.3-44-g2c8d9d3-win64ws.zip *** No HTTP proxy specified (http_proxy and HTTP_PROXY are empty). Downloading WinSparkle-0.3-44-g2c8d9d3-win64ws.zip into '/cygdrive/c/Development/wireshark/Wireshark-win64-lib s', installing into . File 'WinSparkle-0.3-44-g2c8d9d3-win64ws.zip' already there; not retrieving.</code></p><p><code></code></p><p><code>Extracting '/cygdrive/c/Development/wireshark/Wireshark-win64-libs/WinSparkle-0.3-44-g2c8d9d3-win64ws.zip' int o '/cygdrive/c/Development/wireshark/Wireshark-win64-libs/.' Verifying that the DLLs and EXEs in . are executable.</code></p><code></code><p><code>Wireshark is ready to build.</code></p></div><div id="comment-35138-info" class="comment-info"><span class="comment-age">(04 Aug '14, 04:01)</span> francesco_bi...</div></div><span id="35139"></span><div id="comment-35139" class="comment not_top_scorer"><div id="post-35139-score" class="comment-score"></div><div class="comment-text"><p>OUTPUT OF: nmake -f Makefile.nmake distclean This was longer too, but it was all similar to these lines</p><p><code> Microsoft (R) Program Maintenance Utility Version 10.00.40219.01 Copyright (C) Microsoft Corporation.  All rights reserved.</code></p><p><code></code></p><pre><code>    rm -f wireshark-win64-1.99.0-FBG.exe
    rm -f ....\wireshark-gtk2\uninstall_installer.exe
    rm -f NEWS.txt
    rm -f user-guide.chm
    rm -f qt-dll-manifest.nsh
    rm -f wireshark-win64-.exe
    cd ../portableapps/win32
    &quot;c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe&quot; /                   -f Makefile.nmake distclean</code></pre><code></code><p>Microsoft (R) Program Maintenance Utility Version 10.00.40219.01 Copyright (C) Microsoft Corporation. All rights reserved.</p><pre><code>    cd ../../
    &quot;c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe&quot; -f Makefile.nmake clean</code></pre><p>Microsoft (R) Program Maintenance Utility Version 10.00.40219.01 Copyright (C) Microsoft Corporation. All rights reserved.</p></em><pre><code>    rm -rf wireshark.manifest
    cd portableapps/win32
    rm -rf Files
    rm -rf appinfo.ini
    rm -rf WiresharkPortable.ini
    rm -rf distribution.nmake
    rm -rf WiresharkPortable-1.99.0-FBG.paf.exe
    rm -rf ~ .~
    rm -rf WiresharkPortable-*.paf.exe
    cd ../../..</code></pre></code><p><code>C:\Development\wireshark&gt;</code></p></div><div id="comment-35139-info" class="comment-info"><span class="comment-age">(04 Aug '14, 04:02)</span> francesco_bi...</div></div><span id="35140"></span><div id="comment-35140" class="comment not_top_scorer"><div id="post-35140-score" class="comment-score"></div><div class="comment-text"><p>Microsoft (R) Program Maintenance Utility Version 10.00.40219.01 Copyright (C) Microsoft Corporation. All rights reserved.</p><p>Can't find Qt. This will become a problem at some point. Verifying library package files ...</p><p>Microsoft (R) Program Maintenance Utility Version 10.00.40219.01 Copyright (C) Microsoft Corporation. All rights reserved.</p><p>Can't find Qt. This will become a problem at some point.</p><p>Wireshark is ready to build. sed -e s/@[email protected]/1.99.0-FBG/ -e s/@[email protected]/1/ -e s/@[email protected]/99/ -e s/@VERSION_MICRO @/0/ -e "s/@HA[email protected]/#define HAVE_C_ARES 1/" -e "s/@HA[email protected]//" -e "s/@HA[email protected]//" -e "s/@HAVE_ [email protected]/#define HAVE_LIBZ 1/" -e "s/@HA[email protected]/#define HAVE_LIBPCAP 1/" -e "s/@HA[email protected]/#def ine HAVE_PCAP_FINDALLDEVS 1/" -e "s/@HA[email protected]/#define HAVE_PCAP_DATALINK_NAME_TO_VAL 1 /" -e "s/@HA[email protected]/#define HAVE_PCAP_DATALINK_VAL_TO_NAME 1/" -e "s/@HAVE_PCAP_DATALI [email protected]/#define HAVE_PCAP_DATALINK_VAL_TO_DESCRIPTION 1/" -e "s/@HA[email protected]//" -e " s/@HA[email protected]/#define HAVE_REMOTE 1/" -e "s/@HA[email protected]/#define HAVE_PCAP_REMOTE 1/" -e "s/@HAVE_PC [email protected]/#define HAVE_PCAP_OPEN 1/" -e "s/@HA[email protected]/#define HAVE_PCAP_OPEN_DEAD 1/" -e "s/@HAVE_ [email protected]/#define HAVE_PCAP_LIST_DATALINKS 1/" -e "s/@HA[email protected]/#define HAVE_PCAP_ FREE_DATALINKS 1/" -e "s/@HA[email protected]/#define HAVE_PCAP_SET_DATALINK 1/" -e "s/@HAVE_PCAP_SETSAM [email protected]/#define HAVE_PCAP_SETSAMPLING 1/" -e "s/@HA[email protected]/#define HAVE_BPF_IMAGE 1/" -e "s/@HAVE_LIBGN [email protected]/#define HAVE_LIBGNUTLS 1/" -e "s/@HA[email protected]/#define HAVE_LIBGCRYPT 1/" -e "s/@HA[email protected]/#define HAVE_LUA 1/" -e "s/@HA[email protected]/#define HAVE_LUA 1/" -e "s/@HA[email protected]/#define HAVE_AIRPCAP 1/" -e "s/@HAV [email protected]//" -e "s/@HA[email protected]/#define HAVE_LIBPORTAUDIO 1/" -e "s/@[email protected]//" -e "s/@HA [email protected]/#define HAVE_LIBSMI 1/" -e "s/@HA[email protected]/#define HAVE_GEOIP 1/" -e "s/</p></div><div id="comment-35140-info" class="comment-info"><span class="comment-age">(04 Aug '14, 04:06)</span> francesco_bi...</div></div><span id="35141"></span><div id="comment-35141" class="comment not_top_scorer"><div id="post-35141-score" class="comment-score"></div><div class="comment-text"><p>/@[email protected]/#define HAVE _GEOIP_V6 1/" -e "s/@[email protected]/#define HAVE_SOFTWARE_UPDATE 1/" -e "s/@[email protected]/#define INET6 1/" -e "s/@[email protected]/#define HAVE_NTDDNDIS_H 1/" -e "s/@[email protected]/#define PCAP_NG_DEFAULT 1/" -e "s/@[email protected]/#define WANT_PACKET_EDITOR 1/" &lt; config.h.win32 &gt; config.h cd tools "c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe" / -f Ma kefile.nmake</p><p>Microsoft (R) Program Maintenance Utility Version 10.00.40219.01 Copyright (C) Microsoft Corporation. All rights reserved.</p><pre><code>    cd lemon
    ..\native-nmake &quot;c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe&quot; /
       -f Makefile.nmake</code></pre><p>Microsoft (R) Program Maintenance Utility Version 10.00.40219.01 Copyright (C) Microsoft Corporation. All rights reserved.</p><pre><code>    cl -WX -I..\..\ /Zi /W3 /MD /O2 /DWIN32_LEAN_AND_MEAN /DMSC_VER_REQUIRED=1600  /D_CRT_SECURE_NO_DEPREC</code></pre><p>ATE /D_CRT_NONSTDC_NO_DEPRECATE -DPSAPI_VERSION=1 /MP lemon.c Microsoft (R) C/C++ Optimizing Compiler Version 16.00.40219.01 for x64 Copyright (C) Microsoft Corporation. All rights reserved.</p><p>lemon.c Microsoft (R) Incremental Linker Version 10.00.40219.01 Copyright (C) Microsoft Corporation. All rights reserved.</p><p>/out:lemon.exe /debug lemon.obj cd .. cd .. cd image "c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe" / -f Ma kefile.nmake</p></div><div id="comment-35141-info" class="comment-info"><span class="comment-age">(04 Aug '14, 04:06)</span> francesco_bi...</div></div><span id="35142"></span><div id="comment-35142" class="comment not_top_scorer"><div id="post-35142-score" class="comment-score"></div><div class="comment-text"><p>Microsoft (R) Program Maintenance Utility Version 10.00.40219.01 Copyright (C) Microsoft Corporation. All rights reserved.</p><pre><code>    sed -e s/@[email protected]/1/  -e s/@[email protected]/99/  -e s/@[email protected]/0/  -e s/@PROCESSOR_ARCHIT</code></pre><p>[email protected]/amd64/ &lt; wireshark.exe.manifest.in &gt; wireshark.exe.manifest sed -e s/@[email protected]/1.99.0-FBG/ -e s/@[email protected]/1,99,0,0/ &lt; wireshark.rc.in &gt; wireshark.rc sed -e s/@[email protected]/1.99.0-FBG/ -e s/@[email protected]/1,99,0,0/ &lt; libwireshark.rc.in &gt; libwireshark.rc sed -e s/@[email protected]/1.99.0-FBG/ -e s/@[email protected]/1,99,0,0/ &lt; tshark.rc.in &gt; tshark.rc sed -e s/@[email protected]/1.99.0-FBG/ -e s/@[email protected]/1,99,0,0/ &lt; tfshark.rc.in &gt; tfshark.rc sed -e s/@[email protected]/1.99.0-FBG/ -e s/@[email protected]/1,99,0,0/ &lt; rawshark.rc.in &gt; rawshark.rc sed -e s/@[email protected]/1.99.0-FBG/ -e s/@[email protected]/1,99,0,0/ &lt; capinfos.rc.in &gt; capinfos.rc sed -e s/@[email protected]/1.99.0-FBG/ -e s/@[email protected]/1,99,0,0/ &lt; captype.rc.in &gt; captype.rc</p></div><div id="comment-35142-info" class="comment-info"><span class="comment-age">(04 Aug '14, 04:07)</span> francesco_bi...</div></div><span id="35143"></span><div id="comment-35143" class="comment not_top_scorer"><div id="post-35143-score" class="comment-score"></div><div class="comment-text"><p>sed -e s/@[email protected]/1.99.0-FBG/ -e s/@[email protected]/1,99,0,0/ &lt; editcap.rc.in &gt; editcap.rc sed -e s/@[email protected]/1.99.0-FBG/ -e s/@[email protected]/1,99,0,0/ &lt; text2pcap.rc.in &gt; text2pcap.rc sed -e s/@[email protected]/1.99.0-FBG/ -e s/@[email protected]/1,99,0,0/ &lt; mergecap.rc.in &gt; mergecap.rc sed -e s/@[email protected]/1.99.0-FBG/ -e s/@R[email protected]/1,99,0,0/ &lt; reordercap.rc.in &gt; reordercap.rc sed -e s/@[email protected]/1.99.0/ -e s/@[email protected]/1,99,0/ &lt; filetap.rc.in &gt; filetap.rc sed -e s/@[email protected]/1.99.0/ -e s/@[email protected]/1,99,0/ &lt; wiretap.rc.in &gt; wiretap.rc sed -e s/@[email protected]/1.99.0-FBG/ -e s/@[email protected]/1,99,0,0/ &lt; dumpcap.rc.in &gt; dumpcap.rc sed -e s/@[email protected]/1.99.0-FBG/ -e s/@[email protected]/1,99,0,0/ &lt; libwsutil.rc.in &gt; libwsutil.rc cd .. cd codecs "c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe" / -f Ma kefile.nmake</p><p>Microsoft (R) Program Maintenance Utility Version 10.00.40219.01 Copyright (C) Microsoft Corporation. All rights reserved.</p><pre><code>    cl /I.. -WX /DWINPCAP_VERSION=4_1_3 /Zi /W3 /MD /O2 /DWIN32_LEAN_AND_MEAN /DMSC_VER_REQUIRED=1600  /D_</code></pre><p>CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE -DPSAPI_VERSION=1 /MP /w34295 /IC:\Development\wireshark\ Wireshark-win64-libs\gtk2\include\glib-2.0 /IC:\Development\wireshark\Wireshark-win64-libs\gtk2\lib\glib-2.0\ include -DG_DISABLE_DEPRECATED -DG_DISABLE_SINGLE_INCLUDES -Fd.\ -c codecs.c /Focodecs.obj Microsoft (R) C/C++ Optimizing Compiler Version 16.00.40219.01 for x64 Copyright (C) Microsoft Corporation. All rights reserved.</p><p>codecs.c</p></div><div id="comment-35143-info" class="comment-info"><span class="comment-age">(04 Aug '14, 04:07)</span> francesco_bi...</div></div><span id="35144"></span><div id="comment-35144" class="comment not_top_scorer"><div id="post-35144-score" class="comment-score"></div><div class="comment-text"><p>cl /I.. -WX /DWINPCAP_VERSION=4_1_3 /Zi /W3 /MD /O2 /DWIN32_LEAN_AND_MEAN /DMSC_VER_REQUIRED=1600 /D_ CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE -DPSAPI_VERSION=1 /MP /w34295 /IC:\Development\wireshark\ Wireshark-win64-libs\gtk2\include\glib-2.0 /IC:\Development\wireshark\Wireshark-win64-libs\gtk2\lib\glib-2.0\ include -DG_DISABLE_DEPRECATED -DG_DISABLE_SINGLE_INCLUDES -Fd.\ -c G711u\G711udecode.c /FoG711udecode.obj Microsoft (R) C/C++ Optimizing Compiler Version 16.00.40219.01 for x64 Copyright (C) Microsoft Corporation. All rights reserved.</p><p>G711udecode.c cl /I.. -WX /DWINPCAP_VERSION=4_1_3 /Zi /W3 /MD /O2 /DWIN32_LEAN_AND_MEAN /DMSC_VER_REQUIRED=1600 /D_ CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE -DPSAPI_VERSION=1 /MP /w34295 /IC:\Development\wireshark\ Wireshark-win64-libs\gtk2\include\glib-2.0 /IC:\Development\wireshark\Wireshark-win64-libs\gtk2\lib\glib-2.0\ include -DG_DISABLE_DEPRECATED -DG_DISABLE_SINGLE_INCLUDES -Fd.\ -c G711a\G711adecode.c /FoG711adecode.obj Microsoft (R) C/C++ Optimizing Compiler Version 16.00.40219.01 for x64 Copyright (C) Microsoft Corporation. All rights reserved.</p><p>G711adecode.c cl /I.. -WX /DWINPCAP_VERSION=4_1_3 /Zi /W3 /MD /O2 /DWIN32_LEAN_AND_MEAN /DMSC_VER_REQUIRED=1600 /D_ CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE -DPSAPI_VERSION=1 /MP /w34295 /IC:\Development\wireshark\ Wireshark-win64-libs\gtk2\include\glib-2.0 /IC:\Development\wireshark\Wireshark-win64-libs\gtk2\lib\glib-2.0\ include -DG_DISABLE_DEPRECATED -DG_DISABLE_SINGLE_INCLUDES -Fd.\ -c G722\G722decode.c /FoG722decode.obj Microsoft (R) C/C++ Optimizing Compiler Version 16.00.40219.01 for x64 Copyright (C) Microsoft Corporation. All rights reserved.</p></div><div id="comment-35144-info" class="comment-info"><span class="comment-age">(04 Aug '14, 04:08)</span> francesco_bi...</div></div><span id="35145"></span><div id="comment-35145" class="comment not_top_scorer"><div id="post-35145-score" class="comment-score"></div><div class="comment-text"><p>G722decode.c cl /I.. -WX /DWINPCAP_VERSION=4_1_3 /Zi /W3 /MD /O2 /DWIN32_LEAN_AND_MEAN /DMSC_VER_REQUIRED=1600 /D_ CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE -DPSAPI_VERSION=1 /MP /w34295 /IC:\Development\wireshark\ Wireshark-win64-libs\gtk2\include\glib-2.0 /IC:\Development\wireshark\Wireshark-win64-libs\gtk2\lib\glib-2.0\ include -DG_DISABLE_DEPRECATED -DG_DISABLE_SINGLE_INCLUDES -Fd.\ -c G726\G726decode.c /FoG726decode.obj Microsoft (R) C/C++ Optimizing Compiler Version 16.00.40219.01 for x64 Copyright (C) Microsoft Corporation. All rights reserved.</p><p>G726decode.c cl /I.. -WX /DWINPCAP_VERSION=4_1_3 /Zi /W3 /MD /O2 /DWIN32_LEAN_AND_MEAN /DMSC_VER_REQUIRED=1600 /D_ CRT_SECURE_NO_DEPRECATE /D_CRT_NONSTDC_NO_DEPRECATE -DPSAPI_VERSION=1 /MP /w34295 /IC:\Development\wireshark\ Wireshark-win64-libs\gtk2\include\glib-2.0 /IC:\Development\wireshark\Wireshark-win64-libs\gtk2\lib\glib-2.0\ include -DG_DISABLE_DEPRECATED -DG_DISABLE_SINGLE_INCLUDES -Fd.\ -c sbc\sbc.c /Fosbc.obj Microsoft (R) C/C++ Optimizing Compiler Version 16.00.40219.01 for x64 Copyright (C) Microsoft Corporation. All rights reserved.</p><p>sbc.c link /lib /out:codecs.lib codecs.obj G711udecode.obj G711adecode.obj G722decode.obj G726decode.obj sbc.obj Microsoft (R) Library Manager Version 10.00.40219.01 Copyright (C) Microsoft Corporation. All rights reserved.</p><pre><code>    cd ..
    xcopy C:\Development\wireshark\Wireshark-win64-libs\zlib125 zlib.tmp /D /I /E /Y</code></pre><p>0 File(s) copied cd zlib.tmp "c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe" / -f wi n32/Makefile.msc zlib1.dll AS=ml64 LOC="-DASMV -DASMINF" OBJA="inffasx64.obj gvmat64.obj inffas8664.obj"</p></div><div id="comment-35145-info" class="comment-info"><span class="comment-age">(04 Aug '14, 04:08)</span> francesco_bi...</div></div><span id="35146"></span><div id="comment-35146" class="comment not_top_scorer"><div id="post-35146-score" class="comment-score"></div><div class="comment-text"><p>Microsoft (R) Program Maintenance Utility Version 10.00.40219.01 Copyright (C) Microsoft Corporation. All rights reserved.</p><pre><code>    link -nologo -debug -incremental:no -opt:ref -def:win32/zlib.def -dll -implib:zdll.lib  -out:zlib1.dll</code></pre><p>-base:0x5A4C0000 adler32.obj compress.obj crc32.obj deflate.obj gzclose.obj gzlib.obj gzread.obj gzwrite.obj infback.obj inflate.obj inftrees.obj trees.obj uncompr.obj zutil.obj inffasx64.obj gvmat64.obj inffas8664.obj zlib1.res inffasx64.obj : fatal error LNK1112: module machine type 'x64' conflicts with target machine type 'X86' NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\link.EXE"' : ret urn code '0x458' Stop. NMAKE : fatal error U1077: '"c:\Program Files (x86)\Microsoft Visual Studio 10.0\VC\Bin\amd64\nmake.exe"' : re turn code '0x2' Stop.</p><p>C:\Development\wireshark&gt;</p></div><div id="comment-35146-info" class="comment-info"><span class="comment-age">(04 Aug '14, 04:08)</span> francesco_bi...</div></div><span id="35147"></span><div id="comment-35147" class="comment"><div id="post-35147-score" class="comment-score">1</div><div class="comment-text"><p>OK, all that looks OK, did you run <code>del /s *.obj</code> at the top of your source tree?</p><p>And then what happens when you try to build?</p></div><div id="comment-35147-info" class="comment-info"><span class="comment-age">(04 Aug '14, 04:09)</span> grahamb ♦</div></div><span id="35150"></span><div id="comment-35150" class="comment not_top_scorer"><div id="post-35150-score" class="comment-score"></div><div class="comment-text"><p>IT WORKED!! Thank you so much, I have complete the build! When I open the .exe it shows this message: "The NPF driver isn't running. You may have trouble capturing or listing interfaces." Is it a problem?</p></div><div id="comment-35150-info" class="comment-info"><span class="comment-age">(04 Aug '14, 05:09)</span> francesco_bi...</div></div><span id="35151"></span><div id="comment-35151" class="comment not_top_scorer"><div id="post-35151-score" class="comment-score"></div><div class="comment-text"><p>The NPF driver message is because you either don't have WinPCap installed on your build machine, or the WinPCap driver isn't running, most likely the former. Try installing WinPCap. This is only an issue if you wish to capture traffic on your build machine, you can still open captures from elsewhere.</p><p>You might want to wrap your command output in <code></code> tags in future to make it more viewable.</p><p>Now you have given the context your build error was with zlib, a third-party library that is built by the nmake build process.</p></div><div id="comment-35151-info" class="comment-info"><span class="comment-age">(04 Aug '14, 05:23)</span> grahamb ♦</div></div><span id="35152"></span><div id="comment-35152" class="comment not_top_scorer"><div id="post-35152-score" class="comment-score"></div><div class="comment-text"><p>ok, sorry, I didn't know how to put those lines in tags. As for the building, now I start dealing with my real problem: adding my own dissector (as I asked in another question <a href="http://ask.wireshark.org/questions/34966/migration-of-a-plugin-dissector-to-64-bit">http://ask.wireshark.org/questions/34966/migration-of-a-plugin-dissector-to-64-bit</a> ).</p><p>I think I just have to follow the instructions on README.plugin, that is, briefly, adding the folder "MyProtocol" to the Plugins directory in the source tree, isn't it? Nevertheless I have some questions about that. Should I have to</p><p>1)Ask a new question?</p><p>2)Add them as comments to my other question?</p><p>3)Add them as comments to this question?</p></div><div id="comment-35152-info" class="comment-info"><span class="comment-age">(04 Aug '14, 05:33)</span> francesco_bi...</div></div><span id="35156"></span><div id="comment-35156" class="comment not_top_scorer"><div id="post-35156-score" class="comment-score"></div><div class="comment-text"><p>I think I answered most aspects of your original question, but if there any bits left over then add a comment.</p><p>In any case, follow all the instructions in README.plugin, and see what results. If you don't succeed, check for similar issues on this site, and if you can't find an answer post a new question.</p></div><div id="comment-35156-info" class="comment-info"><span class="comment-age">(04 Aug '14, 06:26)</span> grahamb ♦</div></div><span id="35190"></span><div id="comment-35190" class="comment not_top_scorer"><div id="post-35190-score" class="comment-score"></div><div class="comment-text"><p>I have asked another question for the plugin( <a href="http://ask.wireshark.org/questions/35189/problems-in-building-a-custom-dissector">http://ask.wireshark.org/questions/35189/problems-in-building-a-custom-dissector</a> ), but I still have a problem with this question. When I try to open Wireshark.exe, now it not even starts, but just prompt me this message</p><p>"The program can't start because wiretap-1.99.0.dll is missing from your computer. Try reinstalling the program to fix this problem".</p><p>But in the wireshark directory I have a folder wiretap; there is no wiretap-1.99.0.dll file, but I tried to look for it on the internet and I didn't find anything... What can I do?</p></div><div id="comment-35190-info" class="comment-info"><span class="comment-age">(05 Aug '14, 02:52)</span> francesco_bi...</div></div><span id="35195"></span><div id="comment-35195" class="comment"><div id="post-35195-score" class="comment-score">1</div><div class="comment-text"><p>Are you running the exe in ...\wireshark-gtk2\wireshark.exe as specified in the <a href="http://www.wireshark.org/docs/wsdg_html_chunked/ChSetupWin32.html#_build_wireshark">Developers Guide section 2.2.11.4</a>?</p></div><div id="comment-35195-info" class="comment-info"><span class="comment-age">(05 Aug '14, 03:15)</span> grahamb ♦</div></div><span id="35200"></span><div id="comment-35200" class="comment not_top_scorer"><div id="post-35200-score" class="comment-score"></div><div class="comment-text"><p>I don't have such folder. My exe is in C:\Development\wireshark\Wireshark.exe I don't even have a folder "wireshark-gtk2". The most similar I have is C:\Development\wireshark\Wireshark-win64-libs\gtk2\ with inside the folders: bin etc include lib share. Do I have to move the Wireshark.exe there? Or it should be in the right folder itself, and so it's a sort of building error?</p></div><div id="comment-35200-info" class="comment-info"><span class="comment-age">(05 Aug '14, 03:47)</span> francesco_bi...</div></div><span id="35202"></span><div id="comment-35202" class="comment not_top_scorer"><div id="post-35202-score" class="comment-score"></div><div class="comment-text"><p>You have a build error. The result of the build should be a directory wireshark-gtk (and wireshark-qt-release if building the QT version) underneath your top level source directory that contains all the built artefacts ready to run.</p></div><div id="comment-35202-info" class="comment-info"><span class="comment-age">(05 Aug '14, 04:12)</span> grahamb ♦</div></div><span id="35204"></span><div id="comment-35204" class="comment not_top_scorer"><div id="post-35204-score" class="comment-score"></div><div class="comment-text"><p>Ok, I rebuilt it, and it works now! Thank you!</p></div><div id="comment-35204-info" class="comment-info"><span class="comment-age">(05 Aug '14, 04:56)</span> francesco_bi...</div></div><span id="47963"></span><div id="comment-47963" class="comment not_top_scorer"><div id="post-47963-score" class="comment-score"></div><div class="comment-text"><p>I had the same problem and grahamb's solution worked to me. By running nmake -f Makefile.nmake distclean and then del /s *.obj that error disappear :)</p></div><div id="comment-47963-info" class="comment-info"><span class="comment-age">(25 Nov '15, 04:06)</span> glores</div></div><span id="47964"></span><div id="comment-47964" class="comment not_top_scorer"><div id="post-47964-score" class="comment-score"></div><div class="comment-text"><p>@glores</p><p>Note that in the 2.0 release and later building on Windows now uses CMake, as per the updated Developers Guide. It's likely that nmake will be deprecated, so please switch to CMake as soon as you can.</p></div><div id="comment-47964-info" class="comment-info"><span class="comment-age">(25 Nov '15, 04:23)</span> grahamb ♦</div></div></div><div id="comment-tools-35070" class="comment-tools"><span class="comments-showing"> showing 5 of 27 </span> <a href="#" class="show-all-comments-link">show 22 more comments</a></div><div class="clear"></div><div id="comment-35070-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

