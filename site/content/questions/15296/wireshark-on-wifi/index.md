+++
type = "question"
title = "Wireshark on Wifi"
description = '''Hello, I am no guru when it comes to sniifers so I need some guidance. I want to run a sniffer (Wireshak) on my PC (LAN Ethernet) or laptop (Wifi 802.11b/g) to capture/sniff all data on my home network. I have D-Link WRT110 router with WPA2, with some laptops and smartphones connected to it. I want ...'''
date = "2012-10-26T10:08:00Z"
lastmod = "2012-10-28T23:06:00Z"
weight = 15296
keywords = [ "wifi" ]
aliases = [ "/questions/15296" ]
osqa_answers = 2
osqa_accepted = false
+++

<div class="headNormal">

# [Wireshark on Wifi](/questions/15296/wireshark-on-wifi)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-15296-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-15296-score" class="post-score" title="current number of votes">0</div><span id="post-15296-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hello, I am no guru when it comes to sniifers so I need some guidance. I want to run a sniffer (Wireshak) on my PC (LAN Ethernet) or laptop (Wifi 802.11b/g) to capture/sniff all data on my home network. I have D-Link WRT110 router with WPA2, with some laptops and smartphones connected to it. I want to check what my kids are doing, the web sites they visit, the chat rooms and even reading the chat history (like Whatsapp on smartphones). Is that possible to do with Wireshark or I need something else? If possible: - What version of Wireshark do I need? - Once installed, what parameters do I need to set? - Once captured, do I need to decrypt the datd and if yes, how?<br />
</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-wifi" rel="tag" title="see questions tagged &#39;wifi&#39;">wifi</span></div><div id="question-controls" class="post-controls"><div class="community-wiki">This question is marked "community wiki".</div></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>26 Oct '12, 10:08</strong></p><img src="https://secure.gravatar.com/avatar/9d79d51d41864fae0200109e57807c31?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="torontoguy&#39;s gravatar image" /><p><span>torontoguy</span><br />
<span class="score" title="1 reputation points">1</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="torontoguy has no accepted answers">0%</span> </br></p></div></div><div id="comments-container-15296" class="comments-container"></div><div id="comment-tools-15296" class="comment-tools"></div><div class="clear"></div><div id="comment-15296-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

2 Answers:

</div>

</div>

<span id="15327"></span>

<div id="answer-container-15327" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-15327-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-15327-score" class="post-score" title="current number of votes">2</div><span id="post-15327-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>As per my reply, Wireshark, Network Monitor, and other network analyzers aren't really designed for people who just want to know what sites their children are visiting, they're designed for technical users such as network software developers, network administrators/managers/troubleshooters, and the like, who need to know technical details about what traffic is going over a network.</p><p>You might be better off with software designed for the average user or, at least, the average parent - and designed for the purpose of monitoring network activity on other people's machines, rather than for the purpose of capturing raw network traffic and letting you look at it in detail for whatever you might be trying to find. Some Googling found, for example, <a href="https://onlinefamily.norton.com/familysafety/loginStart.fs">Symantec's Norton Online Family</a> and <a href="http://www.gomcgruff.com">McGruff SafeGuard</a>. You may have to install software on <em>their</em> PC's and smartphones to use it; make sure whatever you install supports whatever operating system their PCs and smartphones are running.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>28 Oct '12, 23:06</strong></p><img src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Guy%20Harris&#39;s gravatar image" /><p><span>Guy Harris ♦♦</span><br />
<span class="score" title="17443 reputation points"><span>17.4k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">●</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">●</span><span class="badgecount">196</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Guy Harris has 216 accepted answers">19%</span></p></div></div><div id="comments-container-15327" class="comments-container"></div><div id="comment-tools-15327" class="comment-tools"></div><div class="clear"></div><div id="comment-15327-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="15300"></span>

<div id="answer-container-15300" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-15300-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-15300-score" class="post-score" title="current number of votes">0</div><span id="post-15300-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><blockquote><p>I have D-Link WRT110 router</p></blockquote><p>(I assume you mean "Linksys WRT110 router" - I couldn't find any WRT110 product on D-Link's Web site, but I did find one on Cisco's page for Linksys products.)</p><blockquote><p>I want to check what my kids are doing, the web sites they visit, the chat rooms and even reading the chat history (like Whatsapp on smartphones). Is that possible to do with Wireshark</p></blockquote><p>Yes, if either</p><ol><li>you <a href="http://wiki.wireshark.org/CaptureSetup/Ethernet">use a hub or network tap</a> on the connection between the router and your Internet modem (cable modem, DSL modem, etc.) and plug your PC into it on the Ethernet connection (which might cause problems with its Internet access, including resolving host names from IP addresses)</li></ol><p>or</p><ol><li>you run a Wi-Fi sniffer in monitor mode (which means your laptop can't be running Windows if you're using Wireshark, but if your laptop is running Windows Vista or later, <a href="http://www.microsoft.com/en-us/download/details.aspx?id=4865">Microsoft Network Monitor</a> might be able to capture in monitor mode <em>if</em> the adapter and driver support it) <em>and</em> the sniffer supports WPA2 decryption (which Wireshark does) <em>and</em> you keep it capturing continuously so that every time your kids' machines connect to the Wi-Fi network you capture the setup packets (which means you don't get to clamshell it or let it go to sleep - you'd probably be best off running dumpcap from the command line).</li></ol><p>In <em>either</em> case you'll probably have to end up doing continuous captures, which means you'll have a <em>lot</em> of data to dig through if you want to catch them surfing pr0n or whatever.</p><blockquote><p>What version of Wireshark do I need?</p></blockquote><p>Probably any sufficiently modern version would do, but the newer, the better - go for the latest 1.8 version.</p><blockquote><p>Once captured, do I need to decrypt the datd</p></blockquote><p>Yes, as you're using WPA2.</p><blockquote><p>and if yes, how?</p></blockquote><p><a href="http://wiki.wireshark.org/HowToDecrypt802.11">Thus</a>. Note, however, that, atop any WPA2 link-layer encryption, the services they're using might <em>also</em> use, for example, SSL/TLS encryption over TCP. <a href="http://wiki.wireshark.org/SSL">Wireshark can decrypt SSL</a> if it's built with the right support libraries (I don't know what support libraries various versions of Wireshark on various OSes are built with) <em>and</em> RSA key exchange is used <em>and</em> you can provide the RSA keys, as per that documentation.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>26 Oct '12, 18:16</strong></p><img src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Guy%20Harris&#39;s gravatar image" /><p><span>Guy Harris ♦♦</span><br />
<span class="score" title="17443 reputation points"><span>17.4k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">●</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">●</span><span class="badgecount">196</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Guy Harris has 216 accepted answers">19%</span></p></div></div><div id="comments-container-15300" class="comments-container"><span id="15304"></span><div id="comment-15304" class="comment"><div id="post-15304-score" class="comment-score"></div><div class="comment-text"><p>Thank you Guy Harris. Sorry, I am using Linksys right now. D-Link is my very old one.</p><p>Again, I am not that guru when it comes to setting up/configuring these applications so I am hoping for some steps. What I gather from your answer is: - Traffic capture: I use Microsoft Network Monitor since I am running Windows Vista. Hopefully that will be supported on my adapter and driver. - Since my wifi is WPA2 I need to decrypt it <strong>Option 1: Use Wireshark (latest is 1.8.3)</strong> Option 2: Perhaps I use another tool? - Since there is SSL/TLS encrytption too, again I need to decrypt it <strong>Option 1: Use Wireshark</strong> Option 2: Use something else</p><p>I am not sure if I will get all these combinations right without messing up.</p><p>PS: I am not sticking to Wireshark. I just brought it up as an example. In fact I see there are 8 sub-files under (Stable Release 1.8.3) and I am not sure if I need to install all of them. <a href="http://www.wireshark.org/download.html">http://www.wireshark.org/download.html</a></p></div><div id="comment-15304-info" class="comment-info"><span class="comment-age">(26 Oct '12, 22:13)</span> <span class="comment-user userinfo">torontoguy</span></div></div><span id="15316"></span><div id="comment-15316" class="comment"><div id="post-15316-score" class="comment-score"></div><div class="comment-text"><p>As you're using Windows, Wireshark can't capture in monitor mode (it could capture if you bought an <a href="http://www.riverbed.com/us/products/cascade/wireshark_enhancements/airpcap.php">AirPcap adapter</a>).</p><p>Yes, you would need to set up decryption for WPA2; I don't know whether Network Monitor can do that, but Wireshark can read captures saved from Network Monitor.</p><p>If your kids' internet access includes any secure sites, you'll also have to decrypt SSL/TLS; I don't think Network Monitor can do that.</p></div><div id="comment-15316-info" class="comment-info"><span class="comment-age">(27 Oct '12, 13:33)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="15317"></span><div id="comment-15317" class="comment"><div id="post-15317-score" class="comment-score"></div><div class="comment-text"><p>As for the 8 sub-files, they're 8 different versions of Wireshark, for different operating systems and types of hardware:</p><ul><li><p>The source code is for OSes for which neither the Wireshark developers nor the OS vendor supply a binary version - binaries are supplied for Windows, so that's not an issue.</p></li><li><p>The OS X versions are, obviously, for OS X, not Windows.</p></li><li><p>The U3 and PortableApps versions are specialized versions; you put them on a flash drive and stick the flash drive into a machine on which Wireshark isn't installed and run it from the flash drive.</p></li></ul></div><div id="comment-15317-info" class="comment-info"><span class="comment-age">(27 Oct '12, 13:36)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="15318"></span><div id="comment-15318" class="comment"><div id="post-15318-score" class="comment-score"></div><div class="comment-text"><p>That leaves the Windows Installer versions. If you have a 64-bit PC running 64-bit Windows, you probably want the 64-bit version, as it can handle larger captures; otherwise, you need the 32-bit version, as the 64-bit version won't work.</p></div><div id="comment-15318-info" class="comment-info"><span class="comment-age">(27 Oct '12, 13:37)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="15325"></span><div id="comment-15325" class="comment"><div id="post-15325-score" class="comment-score"></div><div class="comment-text"><p>For an average user this stuff seems complicated. I installed Microsoft Network Monitor and it captures load os stuff and I don't seem successful in understanding what I am capturing. Once I I understand MNM I will move to Wireshark. For the time being all I need is capture Whatsapp conversations on smartphones. If I can get this, I will be more than happy. I searched for that and it doesn't seem there is an easy way.</p><p>The straight forward solution is to use e.g., combination of MNM and Wireshark but that is steps above the average user knowledge.</p></div><div id="comment-15325-info" class="comment-info"><span class="comment-age">(28 Oct '12, 22:17)</span> <span class="comment-user userinfo">torontoguy</span></div></div><span id="15326"></span><div id="comment-15326" class="comment not_top_scorer"><div id="post-15326-score" class="comment-score"></div><div class="comment-text"><p>Neither Wireshark nor Network Monitor nor most if not all other network analyzers are designed for people who just want to find out what sites their kids are going to; they're designed for network software developers, network managers and troubleshooters, and other people who need to know technical details about what traffic is going over a network.</p></div><div id="comment-15326-info" class="comment-info"><span class="comment-age">(28 Oct '12, 22:57)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div></div><div id="comment-tools-15300" class="comment-tools"><span class="comments-showing"> showing 5 of 6 </span> <a href="#" class="show-all-comments-link">show 1 more comments</a></div><div class="clear"></div><div id="comment-15300-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

