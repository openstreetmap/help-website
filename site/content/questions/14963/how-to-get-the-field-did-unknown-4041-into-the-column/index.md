+++
type = "question"
title = "How to get the field &quot;DID unknown 4041&quot; into the column"
description = '''Hello everybody, I am trying to analyze the up-link Wireless traffic generated by my Sony Ericsson phone and captured by my D-Link router, on which I installed the DD-WRT firmware. To do this, first I log in the router and enable the prism0 interface by typing the command: wl -i eth1 monitor 1 and t...'''
date = "2012-10-12T06:21:00Z"
lastmod = "2012-10-16T06:29:00Z"
weight = 14963
keywords = [ "tcpdump", "wireshark" ]
aliases = [ "/questions/14963" ]
osqa_answers = 2
osqa_accepted = true
+++

<div class="headNormal">

# [How to get the field "DID unknown 4041" into the column](/questions/14963/how-to-get-the-field-did-unknown-4041-into-the-column)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-14963-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-14963-score" class="post-score" title="current number of votes">0</div><span id="post-14963-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hello everybody,</p><p>I am trying to analyze the up-link Wireless traffic generated by my Sony Ericsson phone and captured by my D-Link router, on which I installed the DD-WRT firmware. To do this, first I log in the router and enable the prism0 interface by typing the command:</p><p><code>wl -i eth1 monitor 1</code></p><p>and then I start to capture the packets by typing:</p><pre><code>tcpdump -i prism0 ether src xx:xx:xx:xx:xx:xx -s0 -w /tmp/smbshare/sony_ericsson_test.pcap</code></pre><p>where xx:xx:xx:xx:xx:xx is the MAC address of my Sony Ericsson phone. After a while I transfer the sony_ericsson_test.pcap file to my computer and open it with Wireshark program. The RSSI values for each packet are present under "Prism capture header" -&gt; "DID unknown 4041" as displayed in the attached image:</p><p><img src="https://osqa-ask.wireshark.org/upfiles/Screen_Shot_2012-10-12_at_3.07.47_PM.png" alt="alt text" /></p><p>in this case the RSSI value for this packet is: 0xfffffffc7.</p><p>Is there a way to filter these values and inflate them into the column "Power"?</p><p>I tried already to do the following procedure but without success: Edit -&gt; Preferences... -&gt; Columns -&gt; Press "Add" button -&gt; As "Field type" I choose "IEEE 802.11 RSSI" and finally I choose name "Power" and click on "Apply" button.</p><p>Thanks in advance for the help!</p><p>Giovanni</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-tcpdump" rel="tag" title="see questions tagged &#39;tcpdump&#39;">tcpdump</span> <span class="post-tag tag-link-wireshark" rel="tag" title="see questions tagged &#39;wireshark&#39;">wireshark</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>12 Oct '12, 06:21</strong></p><img src="https://secure.gravatar.com/avatar/0f9e9d97875e20337ca50e2709f4b929?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Giovanni%20Soldi&#39;s gravatar image" /><p><span>Giovanni Soldi</span><br />
<span class="score" title="6 reputation points">6</span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="3 badges"><span class="silver">●</span><span class="badgecount">3</span></span><span title="5 badges"><span class="bronze">●</span><span class="badgecount">5</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Giovanni Soldi has no accepted answers">0%</span></p></img></div></div><div id="comments-container-14963" class="comments-container"></div><div id="comment-tools-14963" class="comment-tools"></div><div class="clear"></div><div id="comment-14963-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

2 Answers:

</div>

</div>

<span id="14975"></span>

<div id="answer-container-14975" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-14975-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-14975-score" class="post-score" title="current number of votes">3</div><span id="post-14975-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span class="accept-answer on" rel="nofollow" title="Giovanni Soldi has selected this answer as the correct answer"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>The current code that analyzes Prism radio headers is not treating 0x00004041 as the DID value for the RSSI, it's looking for 0x00040044 instead (and the same applies to some of the other values). There is at least one capture where 0x00040044 is correct, but, in your capture, 0x00004041 is correct, and <a href="http://home.martin.cc/linux/prism">this header file</a> seems to say 0x00004041 is correct.</p><p>That code should check for both values, which should fix your problem without breaking other capture files. I'll check in a fix for that, and schedule it for the next 1.6.x and 1.8.x release.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>12 Oct '12, 18:07</strong></p><img src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Guy%20Harris&#39;s gravatar image" /><p><span>Guy Harris ♦♦</span><br />
<span class="score" title="17443 reputation points"><span>17.4k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">●</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">●</span><span class="badgecount">196</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Guy Harris has 216 accepted answers">19%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>12 Oct '12, 18:29</strong> </span></p></div></div><div id="comments-container-14975" class="comments-container"><span id="14993"></span><div id="comment-14993" class="comment"><div id="post-14993-score" class="comment-score"></div><div class="comment-text"><p>Thanks for the answer! Great! Do you know already when the next release will be ready with this fix?</p></div><div id="comment-14993-info" class="comment-info"><span class="comment-age">(13 Oct '12, 15:35)</span> <span class="comment-user userinfo">Giovanni Soldi</span></div></div><span id="14994"></span><div id="comment-14994" class="comment"><div id="post-14994-score" class="comment-score"></div><div class="comment-text"><p>According to <a href="http://wiki.wireshark.org/Development/Roadmap">the development roadmap</a>, the next 1.8.x and 1.6.x releases aren't scheduled yet, as of 2012-10-13.</p></div><div id="comment-14994-info" class="comment-info"><span class="comment-age">(13 Oct '12, 15:44)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="14998"></span><div id="comment-14998" class="comment"><div id="post-14998-score" class="comment-score"></div><div class="comment-text"><p>After Guy has committed the change you'll be able to pick up a nightly build from the <a href="http://www.wireshark.org/download/automated/">automated build</a> area, or build yourself from trunk, but beware that both these options are on the bleeding edge of Wireshark development.</p></div><div id="comment-14998-info" class="comment-info"><span class="comment-age">(14 Oct '12, 01:40)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="15013"></span><div id="comment-15013" class="comment"><div id="post-15013-score" class="comment-score"></div><div class="comment-text"><p>Okay! I'll try it that release then! I just need to use Wireshark to read the pcap files and export the data into MATLAB but I need to be able to read the RSSI values. Where can I monitor the commits history so that I don't continue to bother you on when it's fixed? Or, can you just simply write me here when it's ready? Thanks you very much!</p></div><div id="comment-15013-info" class="comment-info"><span class="comment-age">(15 Oct '12, 04:27)</span> <span class="comment-user userinfo">Giovanni Soldi</span></div></div><span id="15014"></span><div id="comment-15014" class="comment"><div id="post-15014-score" class="comment-score"></div><div class="comment-text"><p>Way cool! I picked up this version Wireshark 1.9.0-SVN-45556 PPC 32.dmg and it seems to work perfectly. Thanks a lot! :)</p></div><div id="comment-15014-info" class="comment-info"><span class="comment-age">(15 Oct '12, 04:35)</span> <span class="comment-user userinfo">Giovanni Soldi</span></div></div><span id="15015"></span><div id="comment-15015" class="comment not_top_scorer"><div id="post-15015-score" class="comment-score"></div><div class="comment-text"><p>Glad to be of help. If your question has been answered can you mark the question as such by clicking the checkmark icon next to the answer?</p></div><div id="comment-15015-info" class="comment-info"><span class="comment-age">(15 Oct '12, 04:44)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="15034"></span><div id="comment-15034" class="comment not_top_scorer"><div id="post-15034-score" class="comment-score"></div><div class="comment-text"><p>Hi! I have another question! After I get displayed RSSI values into the column I try to export my data into CSV format but the RSSI values don't show up in the output file. Probably, it hasn't been fixed yet, right? Would it be possible to include this fix in the next nightly build? Thanks again for the help!</p></div><div id="comment-15034-info" class="comment-info"><span class="comment-age">(16 Oct '12, 06:29)</span> <span class="comment-user userinfo">Giovanni Soldi</span></div></div></div><div id="comment-tools-14975" class="comment-tools"><span class="comments-showing"> showing 5 of 7 </span> <a href="#" class="show-all-comments-link">show 2 more comments</a></div><div class="clear"></div><div id="comment-14975-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="14972"></span>

<div id="answer-container-14972" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-14972-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-14972-score" class="post-score" title="current number of votes">1</div><span id="post-14972-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>Did you try selecting the field (just like in the screenshot) and using the popup menu selecting "Apply as column"? It should do what you need.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>12 Oct '12, 14:12</strong></p><img src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Jasper&#39;s gravatar image" /><p><span>Jasper ♦♦</span><br />
<span class="score" title="23806 reputation points"><span>23.8k</span></span><span title="5 badges"><span class="badge1">●</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">●</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">●</span><span class="badgecount">284</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Jasper has 263 accepted answers">18%</span></p></div></div><div id="comments-container-14972" class="comments-container"><span id="14992"></span><div id="comment-14992" class="comment"><div id="post-14992-score" class="comment-score"></div><div class="comment-text"><p>Thanks for the answer! I tried but I get also all the other DID unknown fields into the column.</p></div><div id="comment-14992-info" class="comment-info"><span class="comment-age">(13 Oct '12, 15:26)</span> <span class="comment-user userinfo">Giovanni Soldi</span></div></div></div><div id="comment-tools-14972" class="comment-tools"></div><div class="clear"></div><div id="comment-14972-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

