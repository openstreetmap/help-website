+++
type = "question"
title = "Problem with importing a  frame from hex dump..."
description = '''Hi guys, I have a problem with importing a frame from hex dump. When I was trying to import a frame I followed this guide: https://www.wireshark.org/docs/wsug_html_chunked/ChIOImportSection.html But still it didn&#x27;t work. I believe that solution is pretty simple and I am just stupid.  So I would like...'''
date = "2016-07-24T09:36:00Z"
lastmod = "2016-08-03T07:27:00Z"
weight = 54265
keywords = [ "import", "frame", "offset" ]
aliases = [ "/questions/54265" ]
osqa_answers = 2
osqa_accepted = false
+++

<div class="headNormal">

# [Problem with importing a frame from hex dump...](/questions/54265/problem-with-importing-a-frame-from-hex-dump)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-54265-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-54265-score" class="post-score" title="current number of votes">0</div><span id="post-54265-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hi guys,</p><p>I have a problem with importing a frame from hex dump. When I was trying to import a frame I followed this guide: <a href="https://www.wireshark.org/docs/wsug_html_chunked/ChIOImportSection.html">https://www.wireshark.org/docs/wsug_html_chunked/ChIOImportSection.html</a> But still it didn't work. I believe that solution is pretty simple and I am just stupid.</p><p>So I would like to import this frame: 00 04 76 a4 e4 8c 00 00 c0 d7 80 c2 08 00 45 00 01 b0 08 9f 40 00 80 06 2d 69 93 af 62 ee 45 38 87 6a 04 54 00 50 77 4d 60 d0 39 8e 41 a8 50 18 44 70 64 56 00 00 47 45 54 20 2f 20 48 54 54 50 2f 31 2e 31 0d 0a 41 63 63 65 70 74 3a 20 69 6d 61 67 65 2f 67 69 66 2c 20 69 6d 61 67 65 2f 78 2d 78 62 69 74 6d 61 70 2c 20 69 6d 61 67 65 2f 6a 70 65 67 2c 20 69 6d 61 67 65 2f 70 6a 70 65</p><p>I am aware that I have to put in every line of the frame so called offset. This are the numbers which you can see in the article on which I posted a link above. I think that is the problem why wireshark wont accept my frame.</p><p>So could you please tell how the offset should looks like for a frame like that ? I would also be very glad for a little guide which would told me how to apply the offsets on every frame, so I would be able to import other frames to the wireshark on my own.</p><p>Thanks</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-import" rel="tag" title="see questions tagged &#39;import&#39;">import</span> <span class="post-tag tag-link-frame" rel="tag" title="see questions tagged &#39;frame&#39;">frame</span> <span class="post-tag tag-link-offset" rel="tag" title="see questions tagged &#39;offset&#39;">offset</span></div><div id="question-controls" class="post-controls"><div class="community-wiki">This question is marked "community wiki".</div></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>24 Jul '16, 09:36</strong></p><img src="https://secure.gravatar.com/avatar/bfa3445dfbcc505538018f63b9c90cf0?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="snakehead28&#39;s gravatar image" /><p><span>snakehead28</span><br />
<span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="snakehead28 has no accepted answers">0%</span></p></div></div><div id="comments-container-54265" class="comments-container"></div><div id="comment-tools-54265" class="comment-tools"></div><div class="clear"></div><div id="comment-54265-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

2 Answers:

</div>

</div>

<span id="54267"></span>

<div id="answer-container-54267" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-54267-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-54267-score" class="post-score" title="current number of votes">0</div><span id="post-54267-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>Paste the byte string as a single line of text into a text file, and put <code>0</code> (a zero and a space) in front of the text, so it will look like</p><pre><code>0 00 04 76 a4 e4 8c ...</code></pre><p>and save the file. The 0 is the offset you are looking for.</p><p>Then open the <code>File -&gt; Import from Hex Dump</code> form, make sure that the field for date format is empty and make sure that the <code>Direction indication</code> field is not checked (if you use 1.x wireshark then also that the <code>Date/time</code> checkbox is not checked). Then use the <code>Browse</code> button to choose the file you've saved, and then press the <code>Import</code> button.</p><p>As your hex dump is of an Ethernet frame, you don't need to change the default choice of encapsulation.</p><p>Come back if it does not work.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>24 Jul '16, 11:44</strong></p><img src="https://secure.gravatar.com/avatar/00fc6e2633725bd871ff636f0175eabc?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="sindy&#39;s gravatar image" /><p><span>sindy</span><br />
<span class="score" title="6049 reputation points"><span>6.0k</span></span><span title="4 badges"><span class="badge1">●</span><span class="badgecount">4</span></span><span title="8 badges"><span class="silver">●</span><span class="badgecount">8</span></span><span title="51 badges"><span class="bronze">●</span><span class="badgecount">51</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="sindy has 110 accepted answers">24%</span></p></div></div><div id="comments-container-54267" class="comments-container"><span id="54271"></span><div id="comment-54271" class="comment"><div id="post-54271-score" class="comment-score"></div><div class="comment-text"><p>thanks for you reply.</p><p>But if I may ask you, when I will analyze frames different then Ethernet II such as 802.3 what about encapsulation ?</p><p>thanks :-)</p></div><div id="comment-54271-info" class="comment-info"><span class="comment-age">(24 Jul '16, 12:57)</span> <span class="comment-user userinfo">snakehead28</span></div></div><span id="54283"></span><div id="comment-54283" class="comment"><div id="post-54283-score" class="comment-score"></div><div class="comment-text"><p>The pcap file must contain information about encapsulation type so that Wireshark would know which dissector to use for each frame as the first one. So if importing a hex dump, you must provide this information manually: in the GUI, there is a drop-down menu for that, if you use the command-line utility text2pcap, you have to use a <code>-l n</code> command line parameter where <code>n</code> is a number representing the encapsulation type. The list of supported encapsulation types is <a href="http://www.tcpdump.org/linktypes.html">here</a>. Of course the encapsulation type specified must match the actual contents of the packets.</p><p>If none of the available encapsulation types matches the one you need, you may use a custom encapsulation type, for which you'll have to specify the dissector through configuration, or you may prefix the packet data with a manually created bytes representing a protocol for which encapsulation exists (such as Ethernet). These may be the same for all packets or you may e.g. want to express transmission direction of the hex-dumped packets by swapping the sender and recipient address in your handcrafted headers.</p><p>As for Ethernet II and 802.3 in particular, these two can even peacefully coexist on the same wire, which means that they have to be easily discriminated from one another. In particular, if the binary value of the first two bytes following the two MAC addresses is higher than 1536 (0x600), these whole frame is an Ethernet II one (where these two bytes contain an "ethertype", otherwise as an 802.3 frame (where these two bytes contain the length of the frame). So the pcap (and pcapng) file format uses the same encapsulation type for both and it is up to the application processing the file (Wireshark's "ethernet" dissector in our case) to tell apples from pears.</p></div><div id="comment-54283-info" class="comment-info"><span class="comment-age">(25 Jul '16, 00:15)</span> <span class="comment-user userinfo">sindy</span></div></div></div><div id="comment-tools-54267" class="comment-tools"></div><div class="clear"></div><div id="comment-54267-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="54268"></span>

<div id="answer-container-54268" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-54268-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-54268-score" class="post-score" title="current number of votes">0</div><span id="post-54268-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>The offset, is the count of bytes since the start of the file. As you can see from the example in your link, that has 8 bytes per line so the offset is incremented by 8 on each line.</p><p>Converting your sample data to this format gives:</p><pre><code>0000 00 04 76 a4 e4 8c 00 00
0008 c0 d7 80 c2 08 00 45 00
0010 01 b0 08 9f 40 00 80 06
0018 2d 69 93 af 62 ee 45 38
0020 87 6a 04 54 00 50 77 4d
0028 60 d0 39 8e 41 a8 50 18
0030 44 70 64 56 00 00 47 45
0038 54 20 2f 20 48 54 54 50
0040 2f 31 2e 31 0d 0a 41 63
0048 63 65 70 74 3a 20 69 6d
0050 61 67 65 2f 67 69 66 2c
0058 20 69 6d 61 67 65 2f 78
0060 2d 78 62 69 74 6d 61 70
0068 2c 20 69 6d 61 67 65 2f
0070 6a 70 65 67 2c 20 69 6d
0078 61 67 65 2f 70 6a 70 65</code></pre><p>And converting it to a pcap after saving it to a text file using <code>text2pcap inputfile.txt output.pcap</code> shows the packet is malformed, missing some data.</p><p>Note that you aren't limited to 8 bytes per line, you can use whatever size you like, I was just keeping it the same as the example.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>24 Jul '16, 11:53</strong></p><img src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="grahamb&#39;s gravatar image" /><p><span>grahamb ♦</span><br />
<span class="score" title="19834 reputation points"><span>19.8k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">●</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">●</span><span class="badgecount">206</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="grahamb has 274 accepted answers">22%</span></p></div></div><div id="comments-container-54268" class="comments-container"><span id="54269"></span><div id="comment-54269" class="comment"><div id="post-54269-score" class="comment-score"></div><div class="comment-text"><p><span>@grahamb</span>, I would dare to slightly correct you - the offset is not from the beginning of the <strong>file</strong> but of each <strong>packet</strong>. And I think there is a bug in the import from hex dump - the last byte of (at least) the last packet is not imported. I even think I have filed that bug some months ago.</p></div><div id="comment-54269-info" class="comment-info"><span class="comment-age">(24 Jul '16, 12:04)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="54270"></span><div id="comment-54270" class="comment"><div id="post-54270-score" class="comment-score"></div><div class="comment-text"><p>thank you, guys very much. You really helped me :-)</p><p>I would like to ask you another question. It's really stupid but I do not know how to convert .txt to .pcap. You said that I should use "text2pcap inputfile.txt output.pcap", but I do not know if you meant some online tool for converting files or something else. I tried to search for in on the web bud I did not found specific answer. So I don't know how can I do that, perhaps from within a wire shark ?</p><p>I would be grateful if you tell me also this.</p><p>And sorry for the noobish question :/</p><p>btw, I have the frame now in the very exact format you posted above in the .txt file.</p><p>Thanks</p></div><div id="comment-54270-info" class="comment-info"><span class="comment-age">(24 Jul '16, 12:48)</span> <span class="comment-user userinfo">snakehead28</span></div></div><span id="54272"></span><div id="comment-54272" class="comment"><div id="post-54272-score" class="comment-score"></div><div class="comment-text"><p>EDIT: I would like to add that I did it as grahamb told me. About converting a .txt to .pcap I just changed the file extension from .txt to .pcap and I think it worked.</p><p>Than I imported it in the wireshark ad frame lenght was only 127 insted of 128. One last byte was missing (but it was written in the orixinal .txt/pcap). It may be the bug that "sindy" mentioned.</p><p>Do you, guys, have any idea what to do about it ?</p><p>thanks :-)</p></div><div id="comment-54272-info" class="comment-info"><span class="comment-age">(24 Jul '16, 12:57)</span> <span class="comment-user userinfo">snakehead28</span></div></div><span id="54273"></span><div id="comment-54273" class="comment"><div id="post-54273-score" class="comment-score"></div><div class="comment-text"><p><span></span><span>@sindy</span>, your observation about the offset being per packet is correct, any offset of 0 indicates a new packet. I think the docs needs an update here as they do state it's per file.</p><p><span>@snakehead28</span>,</p><p>text2pcap was the original Wireshark utility for converting hex dumps to capture files, I have a long memory. text2pcap would be used from the command line and is usually installed alongside Wireshark.</p><p>Wireshark at some point also learnt this behaviour possibly in 2.x, as described in the answer from <span></span><span>@sindy</span>.</p></div><div id="comment-54273-info" class="comment-info"><span class="comment-age">(24 Jul '16, 13:01)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="54276"></span><div id="comment-54276" class="comment"><div id="post-54276-score" class="comment-score"></div><div class="comment-text"><p><span>@snakehead</span>, to get that last byte, I simply added an extra byte to the text file, e.g.</p><pre><code>0080 00</code></pre></div><div id="comment-54276-info" class="comment-info"><span class="comment-age">(24 Jul '16, 14:30)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="54284"></span><div id="comment-54284" class="comment not_top_scorer"><div id="post-54284-score" class="comment-score"></div><div class="comment-text"><p><span></span><span>@snakehead</span>, two options:</p><ul><li><p>after the hexdump of your last (or only) frame, put one more line like this:<br />
<code>0 00</code><br />
This will add one more frame (of zero size thanks to the bug so not actually imported), making the actual last frame not the last one in the file, so if you then copy-paste more frames into the file, you will not have to think about which one of them was the last one before and thus which one needs to be modified</p></li><li><p>simply place <code>00</code> to the end of the last frame. This is easier if you import a single one but may cause confusion if you edit the same file multiple times, adding frames to be imported.</p></li></ul><p>BTW, as <span></span><span>@grahamb</span> has stated somewhere above, much more than a single byte is missing in you hex dump - the IP header says the total size of the IP portion of the frame is 432 bytes whereas the hex dump only contains the first 114 bytes of them.</p></div><div id="comment-54284-info" class="comment-info"><span class="comment-age">(25 Jul '16, 00:28)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="54550"></span><div id="comment-54550" class="comment not_top_scorer"><div id="post-54550-score" class="comment-score"></div><div class="comment-text"><p><span>@grahamb</span>, you are right that the offset is described in quite a confusing way at <a href="https://www.wireshark.org/docs/man-pages/text2pcap.html">the text2pcap man page</a>:</p><ul><li><p>first, there is an unambiguous statement "Each line begins with an offset describing the position in the file" (so any diagonal reading stops right here)</p></li><li><p>further in the text, there is another statement, "An offset of zero is indicative of starting a new packet, so a single text file with a series of hexdumps can be converted into a packet capture with multiple packets".</p></li></ul><p>So if you have the power and will, please fix the first statement.</p></div><div id="comment-54550-info" class="comment-info"><span class="comment-age">(03 Aug '16, 04:25)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="54551"></span><div id="comment-54551" class="comment not_top_scorer"><div id="post-54551-score" class="comment-score"></div><div class="comment-text"><p><span></span><span>@sindy</span>, I think the first statement should be changed to:</p><ul><li>Each line begins with an offset describing the position in the packet, each new packet starts with an offset of 0 and there is a space separating the offset from the following bytes.</li></ul></div><div id="comment-54551-info" class="comment-info"><span class="comment-age">(03 Aug '16, 05:19)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="54552"></span><div id="comment-54552" class="comment not_top_scorer"><div id="post-54552-score" class="comment-score"></div><div class="comment-text"><p><a href="https://code.wireshark.org/review/#/c/16856/">Change 16856</a> submitted and merged.</p></div><div id="comment-54552-info" class="comment-info"><span class="comment-age">(03 Aug '16, 05:51)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="54553"></span><div id="comment-54553" class="comment not_top_scorer"><div id="post-54553-score" class="comment-score"></div><div class="comment-text"><p>If I may,</p><ul><li>Each line begins with an offset describing the position <strong>of its first data byte</strong> in the packet, <strong>followed by a space separating it from the data bytes</strong>.</li></ul><p>This already implicitly says that the offsets are valid within a single packet, and an explicit confirmation follows in the next paragraphs. But you are the native speaker, so feel free to make it sound more English ;-)</p><p>It would be also nice if you could express somehow that the last byte of the last line must be followed by at least a &lt;lf&gt; character because &lt;eof&gt; is not enough to make text2pcap interpret the last two hex characters before the &lt;eof&gt; as a data byte (which <span>@Pascal Quantin</span> considers a feature as per his comment to <a href="https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=12674">Bug 12674</a>).</p></div><div id="comment-54553-info" class="comment-info"><span class="comment-age">(03 Aug '16, 05:54)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="54556"></span><div id="comment-54556" class="comment not_top_scorer"><div id="post-54556-score" class="comment-score"></div><div class="comment-text"><p>I tried to pack the relevant info into the first paragraph as no one reads the ones after the diagram!</p><p>I'll add another change for the trailing character, on Windows it seems a space or a line-ending (\r\n) will suffice.</p></div><div id="comment-54556-info" class="comment-info"><span class="comment-age">(03 Aug '16, 07:27)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div></div><div id="comment-tools-54268" class="comment-tools"><span class="comments-showing"> showing 5 of 11 </span> <a href="#" class="show-all-comments-link">show 6 more comments</a></div><div class="clear"></div><div id="comment-54268-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

