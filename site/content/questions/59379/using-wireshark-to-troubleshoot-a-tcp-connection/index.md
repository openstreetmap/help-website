+++
type = "question"
title = "Using wireshark to troubleshoot a tcp connection?"
description = '''Is it possible to use wireshark to troubleshoot a TCP connection? To clarify, i have looked at the FAQ/Wiki but i am overwhelmed by it, and the program doesn&#x27;t seem very user friendly. The problem i am encountering is this : I am getting very bad connections to certain players in a P2P game. All pla...'''
date = "2017-02-13T08:33:00Z"
lastmod = "2017-02-16T08:02:00Z"
weight = 59379
keywords = [ "connection", "p2p", "tcp", "troubleshooting" ]
aliases = [ "/questions/59379" ]
osqa_answers = 0
osqa_accepted = false
+++

<div class="headNormal">

# [Using wireshark to troubleshoot a tcp connection?](/questions/59379/using-wireshark-to-troubleshoot-a-tcp-connection)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-59379-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-59379-score" class="post-score" title="current number of votes">0</div><span id="post-59379-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Is it possible to use wireshark to troubleshoot a TCP connection? To clarify, i have looked at the FAQ/Wiki but i am overwhelmed by it, and the program doesn't seem very user friendly.</p><p>The problem i am encountering is this : I am getting very bad connections to certain players in a P2P game. All players are in Australia, the host has fiber internet, and I am the only one having problems. I have no problems with other players. This leads me to believe there is some kind of routing problem between me and these players specifically, but all tracerts that i have done (including TCP tracerts) are inconclusive as some hops are not configured to respond to ICMP or TCP requests).</p><p>I was hoping that wired shark might be able to point towards what is causing the problem, for example lots of problematic packets of some kind, or something.</p><p>Would anyone happen to know if wired shark can help, and if yes, how exactly to use it to identify the problem?</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-connection" rel="tag" title="see questions tagged &#39;connection&#39;">connection</span> <span class="post-tag tag-link-p2p" rel="tag" title="see questions tagged &#39;p2p&#39;">p2p</span> <span class="post-tag tag-link-tcp" rel="tag" title="see questions tagged &#39;tcp&#39;">tcp</span> <span class="post-tag tag-link-troubleshooting" rel="tag" title="see questions tagged &#39;troubleshooting&#39;">troubleshooting</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>13 Feb '17, 08:33</strong></p><img src="https://secure.gravatar.com/avatar/f01cadc0a7fb703a9ad769c129cc405e?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Question&#39;s gravatar image" /><p><span>Question</span><br />
<span class="score" title="6 reputation points">6</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Question has no accepted answers">0%</span></p></div></div><div id="comments-container-59379" class="comments-container"><span id="59413"></span><div id="comment-59413" class="comment"><div id="post-59413-score" class="comment-score"></div><div class="comment-text"><p>Yes, Wireshark can help troubleshoot these connections. As you've noted, it is an advanced troubleshooting tool though that usually requires a little patience and learning. Before digging in, have you done the basic troubleshooting (opened appropriate ports on your routers, looked at the game's FAQs and support, etc)? Also, if you know their IP addresses, can you ping them with 100 or 1000 packets? Does the ping test show drops or latency spikes?</p><p>If none of these yield results then I would move to Wireshark. You can filter on their IP addresses (capture or display filters...syntax is different!) and look for retransmissions, dropped packets, MTU issues, and more. The expert infos section is a great place to start after you've captured. Click on the circle in the bottom-left of the window. This will classify the various levels of detected issues and tell you what they are, how often they occurred, and take you to the packets in question. However, this too requires some knowledge to decipher true problems.</p><p>It can be a bit overwhelming at first, but it's a great tool once you get the hang of it! Just being here and asking the question is a great start! If you're looking for a 5-minute quick diagnosis though, this probably isn't for you.</p></div><div id="comment-59413-info" class="comment-info"><span class="comment-age">(14 Feb '17, 09:57)</span> <span class="comment-user userinfo">csereno</span></div></div><span id="59477"></span><div id="comment-59477" class="comment"><div id="post-59477-score" class="comment-score"></div><div class="comment-text"><p><span></span><span>@csereno</span> : Yes, but i dont have access to the router (i live at a boarding house type of place). Every search ive tried on the issue has basically hit a dead end as nobody has any clue on what causes it, just some speculation.</p><p>I know the hosts IP addresses and the IPs of the game servers. I've done TCP tracerts to both, but they dont show any obvious packet loss or anything. The only thing in common is that I get really bad connection to certain hosts, all the time. Other players are fine, or mostly fine.</p><p>I'm not sure whether i should be doing UDP tracerts as well (if thats even possible).</p><p>This is a typical TCP tracert that i did to the game server : <a href="http://pastebin.com/GLuuC0TM">http://pastebin.com/GLuuC0TM</a></p><p>The only suspicious thing is the huge spike in latency from hop 4 to 5. I did a more detailed tracert with pingplotter, and it showed that hop 4 also keeps changing to different IPs, but apparently thats normal.</p><p>Ive done a couple of packet captures, but i don't see anything really obvious. Is there any chance you or someone else can help take a quick look?</p><p>The relevant ports are TCP 27023, 27005 and 27015. Not sure if UDP is relevant as well. These packet captures were done when I was trying to connect to a host and was experiencing problems (connection was established but was VERY laggy, consistently laggy, not spiking).</p><p>Wired shark capture data:</p><p><a href="http://www.mediafire.com/file/1a43o4i3awrcmvu/rhyka.pcapng">http://www.mediafire.com/file/1a43o4i3awrcmvu/rhyka.pcapng</a></p><p><a href="http://www.mediafire.com/file/04sr0ictuehlw6j/kelly.pcapng">http://www.mediafire.com/file/04sr0ictuehlw6j/kelly.pcapng</a></p><p><a href="http://www.mediafire.com/file/cy5x5q0qwccwsak/wireshark.pcapng">http://www.mediafire.com/file/cy5x5q0qwccwsak/wireshark.pcapng</a></p></div><div id="comment-59477-info" class="comment-info"><span class="comment-age">(16 Feb '17, 08:02)</span> <span class="comment-user userinfo">Question</span></div></div></div><div id="comment-tools-59379" class="comment-tools"></div><div class="clear"></div><div id="comment-59379-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

</div>

