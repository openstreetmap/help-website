+++
type = "question"
title = "SCCP decode problem"
description = '''Hi! I am using last version of Wireshrk. So, i have a hex dump of one packet (SCCP): 09 81 03 10 1B 0D 12 06 00 72 04 73 21 85 25 03 00 79 24 0B 12 07 00 11 04 53 97 79 10 00 00 46 62 44 48 04 0E 00 03 77 6B 1E 28 1C 06 07 00 11 86 05 01 01 01 A0 11 60 0F 80 02 07 80 A1 09 06 07 04 00 00 01 00 0E 03...'''
date = "2012-08-28T06:21:00Z"
lastmod = "2015-05-07T08:34:00Z"
weight = 13933
keywords = [ "sccp" ]
aliases = [ "/questions/13933" ]
osqa_answers = 2
osqa_accepted = false
+++

<div class="headNormal">

# [SCCP decode problem](/questions/13933/sccp-decode-problem)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-13933-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-13933-score" class="post-score" title="current number of votes">0</div><span id="post-13933-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hi!</p><p>I am using last version of Wireshrk. So, i have a hex dump of one packet (SCCP):</p><p>09 81 03 10 1B 0D 12 06 00 72 04 73 21 85 25 03 00 79 24 0B 12 07 00 11 04 53 97 79 10 00 00 46 62 44 48 04 0E 00 03 77 6B 1E 28 1C 06 07 00 11 86 05 01 01 01 A0 11 60 0F 80 02 07 80 A1 09 06 07 04 00 00 01 00 0E 03 6C 80 A1 18 02 01 01 02 01 38 30 10 80 08 42 06 22 03 00 79 24 F5 02 01 01 83 01 00 00 00 00 00 03 65 8B 80 02 73 81 70 00 6E F9 A0 01 7B 2A F8 01 12 FA 18 02 73 81 80 01 13 07 88 04 73 21 85 25 03 00 79 02 73 82 38 00 11 04 53 97 79 10 00 00 46 62 44 48 04 0E 00 03 77 6B 1E 01 1B BE F8 00 00 00 00 01 01 01 A0 11 60 0F 80 02 73 82 20 09 06 07 04 00 00 01 00 0E 03 6C 80 A1 18 02 01 01 02 01 38 30 10 80 08 01 7A D8 80 00 79 24 F5 02 01 01 83 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 03 5E 76 0C 00 00 00 02 02 73 82 30 00 A4 32 5C 02 73 82 30 00 A4 2E 64 03 65 8B 80 00 81 F7 58 00 00 00 00 00 00 00 00 03 65 8B 80 00 A4 2D DC 02 73 82 38 00 A4 2E 08 02 73 82 48 00 81 F7 6C 00 00 00 00 00 00 00 02 02 73 82 58 00 81 F6 C4 00 00 90 32 00 00 00 00 02 73 82 60 00 80 5A E8 02 73 82 70 01 12 F6 C0 00 00</p><p>With Text2pcap tool i converted this dump to pcap file (text2pcap -l 142 <a href="http://hd.txt">hd.txt</a> hd.pcap). And all seems ok... I can see SCCP part, TCAP part and GSM MAP Part. All this parts are in first 70 bytes. But how about the rest?.. That all the rest bytes mean?..</p><p>I'll be very grateful, if some one could help me to understand this message or to point me to some good direction.</p><p>Thanks.</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-sccp" rel="tag" title="see questions tagged &#39;sccp&#39;">sccp</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>28 Aug '12, 06:21</strong></p><img src="https://secure.gravatar.com/avatar/fe2e03366c2c2fe2f8de8b6aeeccc772?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="SerijVeter&#39;s gravatar image" /><p><span>SerijVeter</span><br />
<span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="bronze">●</span><span class="badgecount">1</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="SerijVeter has no accepted answers">0%</span></p></div></div><div id="comments-container-13933" class="comments-container"><span id="14034"></span><div id="comment-14034" class="comment"><div id="post-14034-score" class="comment-score"></div><div class="comment-text"><p>Hello again.</p><p>This hex dump was created from incoming message on our audiocodes. With perl help. Something like...</p><p>Step 1 - check is it sccp message or not.</p><p>my $si = uc(unpack('H*', substr($msg,$si_offset,1))); return if $si !~ /^\d3$/;</p><p>Step 2 - Cut off offset = 40</p><p>my $sccp = substr($msg,$offset); $pkt-&gt;{print} = uc(unpack('H*', $sccp)); $pkt-&gt;{print} =~ s/(\w{2})/$1 /g; $pkt-&gt;{print} =~ s/\s+$//;</p><p>This is not my solution, but it works. After this two steps we have hex dump, similar to dump example in my previous post. So, we cut offset, uses Text2pcap and after that wireshark understands first 70 bytes as sccp message. And appears a clue - that all the rest bytes means.</p><p>If you are still interested in this question, i can provide some example of the full hex dump of message on our audiocodes.</p><p>Our main problem is that we can't understand there is one packet or two and how to divide them by some sort of concatenation mark.</p><p>01 91 FD 54 FF FF 80 E0 00 00 00 01 00 00 00 02 01 0E C1 B8 02 73 80 F0 00 01 0F B8 00 00 00 69 A5 CC 3F 83 B2 D3 EB F4 09 81 03 11 1C 0E 12 06 00 71 04 73 21 85 25 03 00 48 72 01 0B 12 07 00 11 04 23 94 05 00 12 00 40 62 3E 48 04 00 1F 06 F4 6B 1A 28 18 06 07 00 11 86 05 01 01 01 A0 0D 60 0B A1 09 06 07 04 00 00 01 00 0E 03 6C 1A A1 18 02 01 22 02 01 38 30 10 80 08 42 06 22 03 00 48 72 F1 02 01 04 83 01 00 00 00 00 00 00 00 00 03 65 99 80 02 73 81 70 00 69 A5 CC 01 7B 2A F8 01 12 FA 18 02 73 81 80 01 13 07 88 04 73 21 85 25 03 00 48 02 73 82 38 07 00 11 04 23 94 05 00 12 00 40 62 3E 48 04 00 1F 06 F4 6B 01 1B BE F8 00 00 00 00 05 01 01 01 A0 0D 60 0B 02 73 82 20 04 00 00 01 00 0E 03 6C 1A A1 18 02 01 22 02 01 38 30 10 80 08 42 06 22 01 7A D8 80 F1 02 01 04 83 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 03 5E 68 0C 00 00 00 02 02 73 82 30 00 A4 32 5C 02 73 82 30 00 A4 2E 64 03 65 99 80 00 81 F7 58 00 00 00 00 00 00 00 00 03 65 99 80 00 A4 2D DC 02 73 82 38 00 A4 2E 08 02 73 82 48 00 81 F7 6C 00 00 00 00 00 00 00 02 02 73 82 58 00 81 F6 C4 00 00 90 32 00 00 00 00 02 73 82 60 00 80 5A E8 02 73 82 70 01</p></div><div id="comment-14034-info" class="comment-info"><span class="comment-age">(04 Sep '12, 07:06)</span> <span class="comment-user userinfo">SerijVeter</span></div></div><span id="14039"></span><div id="comment-14039" class="comment"><div id="post-14039-score" class="comment-score"></div><div class="comment-text"><p>That does not explain where the data comes from ($msg in your perl script) and that's the place where the concatenation of several packets most certainly takes place. Can you please be more specific?</p></div><div id="comment-14039-info" class="comment-info"><span class="comment-age">(04 Sep '12, 14:32)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="14054"></span><div id="comment-14054" class="comment"><div id="post-14054-score" class="comment-score"></div><div class="comment-text"><p>More specific? Ok. On one side - Huawei GGSN02 node. On other side - Mediant 3000. And all i have for now is perl script that tries to decode incoming messages. All we cant tell for sure is 5 bytes from 36 to 40 - MTP3 header. All the rest mast be the SCCP part. But for now i can't understand first 35 bytes and i can't tell for sure is thee one packet with some garbage, or there are two packets.</p></div><div id="comment-14054-info" class="comment-info"><span class="comment-age">(05 Sep '12, 01:41)</span> <span class="comment-user userinfo">SerijVeter</span></div></div><span id="14055"></span><div id="comment-14055" class="comment"><div id="post-14055-score" class="comment-score"></div><div class="comment-text"><p>O.K., by "specific" I meant something different ;-). How do you get the data into the perl script? Do you read from a pipe, a log file, etc.? Maybe there is a bug in your perl script or the component that provides the data.</p></div><div id="comment-14055-info" class="comment-info"><span class="comment-age">(05 Sep '12, 03:06)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="14057"></span><div id="comment-14057" class="comment"><div id="post-14057-score" class="comment-score"></div><div class="comment-text"><p>Sorry. Some misunderstanding :) Script listens a socket, opened to our Mediant, and waits for incoming UDP messages. So it is a pipe.</p></div><div id="comment-14057-info" class="comment-info"><span class="comment-age">(05 Sep '12, 03:32)</span> <span class="comment-user userinfo">SerijVeter</span></div></div><span id="14058"></span><div id="comment-14058" class="comment not_top_scorer"><div id="post-14058-score" class="comment-score"></div><div class="comment-text"><p>O.K. then it could be a problem with your perl script. Is it possible to capture that socket with Wireshark in parallel and then compare that with the hexdump delivered by the script?</p></div><div id="comment-14058-info" class="comment-info"><span class="comment-age">(05 Sep '12, 03:56)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="14059"></span><div id="comment-14059" class="comment not_top_scorer"><div id="post-14059-score" class="comment-score"></div><div class="comment-text"><p>I'll see what can be done. Also i can show your more then one dump. Maybe it generates some more ideas. As i can see that 12 byte is always 00 or 01. Our mediant has two channels. So may be 12 byte indicates channel - first or second. Also bytes 2 and 3 are some sort of counter. Don't know...</p></div><div id="comment-14059-info" class="comment-info"><span class="comment-age">(05 Sep '12, 04:09)</span> <span class="comment-user userinfo">SerijVeter</span></div></div><span id="14060"></span><div id="comment-14060" class="comment not_top_scorer"><div id="post-14060-score" class="comment-score"></div><div class="comment-text"><p>40 bytes from the beginning in four variants, one by one:</p><p>01 95 29 54 FF FF 00 00 00 00 00 01 00 00 00 02 02 3A 7F 18 02 3A 7F 18 03 65 95 00 00 00 00 6D F2 99 3F 83 B2 D3 EB 44</p><p>01 95 2A 54 FF FF 00 00 00 00 00 00 00 00 00 02 02 3A 7F 18 02 3A 7F 18 03 65 95 00 00 00 00 6D 99 F3 3F 83 AF 93 EC 84</p><p>01 A6 2B 54 FF FF 00 00 00 00 00 01 00 00 00 02 02 3A 7F 18 02 3A 7F 18 03 65 95 00 00 00 00 7E F2 9A 3F 83 B2 D3 EB F4</p><p>01 A6 2C 54 FF FF 00 00 00 00 00 00 00 00 00 02 02 3A 7F 18 02 3A 7F 18 03 65 95 00 00 00 00 7E 9A F4 3F 83 AF 93 EC 94</p></div><div id="comment-14060-info" class="comment-info"><span class="comment-age">(05 Sep '12, 04:11)</span> <span class="comment-user userinfo">SerijVeter</span></div></div><span id="14061"></span><div id="comment-14061" class="comment not_top_scorer"><div id="post-14061-score" class="comment-score"></div><div class="comment-text"><p>well, I think it will help more to comapre the wireshark data with the hex dump of the script first. Only if that comparison delivers the same result, I would suggest to digg into the script or to analyze the way data is sent to that socket.</p></div><div id="comment-14061-info" class="comment-info"><span class="comment-age">(05 Sep '12, 04:38)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="42187"></span><div id="comment-42187" class="comment not_top_scorer"><div id="post-42187-score" class="comment-score"></div><div class="comment-text"><p>First thing that jumped out at me is the TCAP length is 0x64 (70 bytes). Wireshark is being told to find 70 octets after that length field. Look near the beginning of that dump for the string "46 62 44 48 04 0E 00 03 77". That says "70 octets, TCAP BEGIN, 68 octets, OrigTransId, length 4 octets, TID: 0e000377". This appears to be a SendAuthInfo (opcode 0x38). With IMSI: 246022300097425.</p><p>Neither I now Wireshark have a clue how to interpret the noise that occurs after the 70 octets.</p></div><div id="comment-42187-info" class="comment-info"><span class="comment-age">(07 May '15, 08:34)</span> <span class="comment-user userinfo">tiger762</span></div></div></div><div id="comment-tools-13933" class="comment-tools"><span class="comments-showing"> showing 5 of 10 </span> <a href="#" class="show-all-comments-link">show 5 more comments</a></div><div class="clear"></div><div id="comment-13933-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

2 Answers:

</div>

</div>

<span id="13936"></span>

<div id="answer-container-13936" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-13936-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-13936-score" class="post-score" title="current number of votes">0</div><span id="post-13936-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>Hmmm, well, the SCCP, TCAP, and MAP parts all look fine to me. And you've got a total of 374 octets there which is bigger than a single SCCP message could be (well, okay, an LUDT could be that big but this is not an LUDT). I'd guess that whatever follows the end of the message isn't really part of that message but something else entirely (maybe just junk left by whatever recorded the message).</p><p>It does not look to me (based on some rough scanning) that the following bytes are not another SCCP message.</p><p>I'd suggest checking with whatever tool recorded the message to see what it thinks those extra octets are.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>28 Aug '12, 08:35</strong></p><img src="https://secure.gravatar.com/avatar/e0564001bb7deb960d5d9d9c1e0ba074?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="JeffMorriss&#39;s gravatar image" /><p><span>JeffMorriss ♦</span><br />
<span class="score" title="6219 reputation points"><span>6.2k</span></span><span title="5 badges"><span class="silver">●</span><span class="badgecount">5</span></span><span title="72 badges"><span class="bronze">●</span><span class="badgecount">72</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="JeffMorriss has 103 accepted answers">27%</span></p></div></div><div id="comments-container-13936" class="comments-container"></div><div id="comment-tools-13936" class="comment-tools"></div><div class="clear"></div><div id="comment-13936-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="13941"></span>

<div id="answer-container-13941" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-13941-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-13941-score" class="post-score" title="current number of votes">0</div><span id="post-13941-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>Whatever it is, it's probably a concatenation of serveral messages, as serveral byte pattern are repeated in the byte stream. How did you create the hex dump?</p><p><strong>TCAP</strong>, as displayed in Wireshark<br />
</p><blockquote><pre><code>0020  62 44 48 04 0e 00 03 77  6b 1e 28 1c 06 07 00 11   bDH....w k.(.....
0030  86 05 01 01 01 a0 11 60  0f 80 02 07 80 a1 09 06   .......` ........
0040  07 04 00 00 01 00 0e 03  6c 80 a1 18 02 01 01 02   ........ l.......
0050  01 38 30 10 80 08 42 06  22 03 00 79 24 f5 02 01   .80...B. &quot;..y$...
0060  01 83 01 00 00 0</code></pre></blockquote><p>Same byte pattern, later in the byte stream. Could be TCAP as well.<br />
</p><blockquote><pre><code>0090                                 62 44 48 04 0e 00             FbDH...
00a0  03 77 6b 1e 01 1b be f8  00 00 00 00 01 01 01 a0   .wk..... ........
00b0  11 60 0f 80 02 73 82 20  09 06 07 04 00 00 01 00   .`...s.  ........
00c0  0e 03 6c 80 a1 18 02 01  01 02 01 38 30 10 80 08   ..l..... ...80...
00d0  01 7a d8 80 00 79 24 f5  02 01 01 83 01 00 00 00   .z...y$. ........</code></pre></blockquote><p>The same for <strong>parts</strong> of the SCCP message (as displayed in Wireshark)<br />
</p><blockquote><pre><code>0000                                 04 73 21 85 25 03   ........ .r.s!.%.
0010  00 79 24 0b 12 07 00 11  04 53 97 79 10 00 00 46   .y$..... .S.y...F</code></pre></blockquote><p>later in the byte stream<br />
</p><blockquote><pre><code>0080              04 73 21 85  25 03 00 79 02 73 82 38   .....s!. %..y.s.8
0090  00 11 04 53 97 79 10 00  00 46                     ...S.y.. .FbDH...</code></pre></blockquote><p>Regards<br />
Kurt</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>28 Aug '12, 10:32</strong></p><img src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Kurt%20Knochner&#39;s gravatar image" /><p><span>Kurt Knochner ♦</span><br />
<span class="score" title="24767 reputation points"><span>24.8k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">●</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">●</span><span class="badgecount">237</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Kurt Knochner has 344 accepted answers">15%</span> </br></br></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>28 Aug '12, 10:33</strong> </span></p></div></div><div id="comments-container-13941" class="comments-container"></div><div id="comment-tools-13941" class="comment-tools"></div><div class="clear"></div><div id="comment-13941-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

