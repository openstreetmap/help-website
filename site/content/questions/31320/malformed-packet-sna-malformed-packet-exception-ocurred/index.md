+++
type = "question"
title = "Malformed Packet: SNA; Malformed Packet (Exception ocurred)"
description = '''Viewing a trace of an SNA RJE transmisssion, SNA over UDP. Many packets decode with the error message above. I believe the issue is with an Optional Segment, a status segment in the RTP Transport section. The odd thing is that another user at the vendor uses Wireshark and can view the trace without ...'''
date = "2014-03-31T10:59:00Z"
lastmod = "2014-04-04T09:54:00Z"
weight = 31320
keywords = [ "sna", "malformed", "error" ]
aliases = [ "/questions/31320" ]
osqa_answers = 1
osqa_accepted = false
+++

<div class="headNormal">

# [Malformed Packet: SNA; Malformed Packet (Exception ocurred)](/questions/31320/malformed-packet-sna-malformed-packet-exception-ocurred)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-31320-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-31320-score" class="post-score" title="current number of votes">0</div><span id="post-31320-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Viewing a trace of an SNA RJE transmisssion, SNA over UDP. Many packets decode with the error message above. I believe the issue is with an Optional Segment, a status segment in the RTP Transport section. The odd thing is that another user at the vendor uses Wireshark and can view the trace without this issue.</p><p>The port being used is 12000 - 12004. I've tried to "Decode As" and specify SNA, but it does not have this option for "transport". I've tried RTP and LLC, neither work.</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-sna" rel="tag" title="see questions tagged &#39;sna&#39;">sna</span> <span class="post-tag tag-link-malformed" rel="tag" title="see questions tagged &#39;malformed&#39;">malformed</span> <span class="post-tag tag-link-error" rel="tag" title="see questions tagged &#39;error&#39;">error</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>31 Mar '14, 10:59</strong></p><img src="https://secure.gravatar.com/avatar/49167ce6880d8ac9ce18f4d3f15e9480?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="dwsmithjr&#39;s gravatar image" /><p><span>dwsmithjr</span><br />
<span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="dwsmithjr has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>31 Mar '14, 10:59</strong> </span></p></div></div><div id="comments-container-31320" class="comments-container"><span id="31321"></span><div id="comment-31321" class="comment"><div id="post-31321-score" class="comment-score"></div><div class="comment-text"><p>So you say another user can look at the same packet without this problem? What is your wireshark Version and Operating System? Can you paste a small sample here or to <a href="http://cloudshark.org">http://cloudshark.org</a> ?</p></div><div id="comment-31321-info" class="comment-info"><span class="comment-age">(31 Mar '14, 11:25)</span> <span class="comment-user userinfo">mrEEde</span></div></div><span id="31322"></span><div id="comment-31322" class="comment"><div id="post-31322-score" class="comment-score"></div><div class="comment-text"><p>We are both using 1.10.6 on Windows 7, 64bit version. I'll have to see if I can get permission to post a picture.</p></div><div id="comment-31322-info" class="comment-info"><span class="comment-age">(31 Mar '14, 11:59)</span> <span class="comment-user userinfo">dwsmithjr</span></div></div><span id="31323"></span><div id="comment-31323" class="comment"><div id="post-31323-score" class="comment-score"></div><div class="comment-text"><p><img src="https://osqa-ask.wireshark.org/upfiles/Safe_Capture.PNG" alt="alt text" /></p><p><img src="https://osqa-ask.wireshark.org/upfiles/Safe_Capture_2.PNG" alt="alt text" /></p></div><div id="comment-31323-info" class="comment-info"><span class="comment-age">(31 Mar '14, 12:25)</span> <span class="comment-user userinfo">dwsmithjr</span></div></div><span id="31324"></span><div id="comment-31324" class="comment"><div id="post-31324-score" class="comment-score"></div><div class="comment-text"><p>These are images of the relevant portion of the same packet. The top is decoding properly, the bottom shows the error.</p></div><div id="comment-31324-info" class="comment-info"><span class="comment-age">(31 Mar '14, 12:26)</span> <span class="comment-user userinfo">dwsmithjr</span></div></div><span id="31328"></span><div id="comment-31328" class="comment"><div id="post-31328-score" class="comment-score"></div><div class="comment-text"><p>"We are both using 1.10.6 on Windows 7, 64bit version." IP and SNA both have preferences controlling whether to do re-assembly; do both of your versions of Wireshark have the same settings for the IP and SNA preferences?</p></div><div id="comment-31328-info" class="comment-info"><span class="comment-age">(31 Mar '14, 17:49)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="31329"></span><div id="comment-31329" class="comment not_top_scorer"><div id="post-31329-score" class="comment-score"></div><div class="comment-text"><p>"I've tried to "Decode As" and specify SNA" Wireshark is <em>already</em> decoding them as SNA, so that wouldn't make a difference.</p></div><div id="comment-31329-info" class="comment-info"><span class="comment-age">(31 Mar '14, 17:50)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="31334"></span><div id="comment-31334" class="comment not_top_scorer"><div id="post-31334-score" class="comment-score"></div><div class="comment-text"><p>Does this packet format ok with your wireshark: <a href="https://www.cloudshark.org/captures/d12e6090e938">https://www.cloudshark.org/captures/d12e6090e938</a> ?</p></div><div id="comment-31334-info" class="comment-info"><span class="comment-age">(31 Mar '14, 22:08)</span> <span class="comment-user userinfo">mrEEde</span></div></div><span id="31339"></span><div id="comment-31339" class="comment not_top_scorer"><div id="post-31339-score" class="comment-score"></div><div class="comment-text"><p>Guy, Yes, SNA was not a choice in the Decode As. Since we were using ports 12000 - 12004, I thought I might have to indicate to Wireshark these ports were SNA. That is what I had to do with my other Protocol Analyzer, Observer. However, Wireshark was already showing the SNA portion, so, as you say, it would not have done any good anyway.</p></div><div id="comment-31339-info" class="comment-info"><span class="comment-age">(01 Apr '14, 03:06)</span> <span class="comment-user userinfo">dwsmithjr</span></div></div><span id="31340"></span><div id="comment-31340" class="comment not_top_scorer"><div id="post-31340-score" class="comment-score"></div><div class="comment-text"><p>Guy, I'll check the preferences when I get into work this morning and post. I'll have to check with the other user, who is remote, to check the preferences.</p></div><div id="comment-31340-info" class="comment-info"><span class="comment-age">(01 Apr '14, 03:07)</span> <span class="comment-user userinfo">dwsmithjr</span></div></div><span id="31341"></span><div id="comment-31341" class="comment not_top_scorer"><div id="post-31341-score" class="comment-score"></div><div class="comment-text"><p>mrEEde, I work for a bank which is paranoid about security. I have to be very careful about anything that goes out of the bank. Although the packet does not, as far as I can determine, contain any information that is readable and pertains to customer information, that is a huge, huge concern. I'd like to keep my job, so I don't think I can post the packet as a whole.</p></div><div id="comment-31341-info" class="comment-info"><span class="comment-age">(01 Apr '14, 03:10)</span> <span class="comment-user userinfo">dwsmithjr</span></div></div><span id="31342"></span><div id="comment-31342" class="comment not_top_scorer"><div id="post-31342-score" class="comment-score"></div><div class="comment-text"><p>mrEEde, I'll check the packet when I get to work and see if it decodes.</p></div><div id="comment-31342-info" class="comment-info"><span class="comment-age">(01 Apr '14, 03:12)</span> <span class="comment-user userinfo">dwsmithjr</span></div></div><span id="31344"></span><div id="comment-31344" class="comment not_top_scorer"><div id="post-31344-score" class="comment-score"></div><div class="comment-text"><p>mrEEde, the packet DOES display correctly in my Wireshark at work. It does not display as a malformed packet.</p></div><div id="comment-31344-info" class="comment-info"><span class="comment-age">(01 Apr '14, 04:47)</span> <span class="comment-user userinfo">dwsmithjr</span></div></div><span id="31346"></span><div id="comment-31346" class="comment not_top_scorer"><div id="post-31346-score" class="comment-score"></div><div class="comment-text"><p>Could you paste the frame section indicating the lengths and ethernet mac addresses as well as ip.len and udp.length please ?</p></div><div id="comment-31346-info" class="comment-info"><span class="comment-age">(01 Apr '14, 06:39)</span> <span class="comment-user userinfo">mrEEde</span></div></div><span id="31494"></span><div id="comment-31494" class="comment not_top_scorer"><div id="post-31494-score" class="comment-score"></div><div class="comment-text"><p>We haven't heard anything back from you, so here's another suggestion:</p><p>If this capture file is the result of a conversion using IPCS could you try converting with OPTION((SNIFFER(1500 TCPDUMP))) and see if this makes a difference.</p></div><div id="comment-31494-info" class="comment-info"><span class="comment-age">(03 Apr '14, 09:37)</span> <span class="comment-user userinfo">mrEEde</span></div></div></div><div id="comment-tools-31320" class="comment-tools"><span class="comments-showing"> showing 5 of 14 </span> <a href="#" class="show-all-comments-link">show 9 more comments</a></div><div class="clear"></div><div id="comment-31320-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="31444"></span>

<div id="answer-container-31444" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-31444-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-31444-score" class="post-score" title="current number of votes">0</div><span id="post-31444-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><blockquote><p>The odd thing is that another user at the vendor uses Wireshark and can view the trace without this issue.</p></blockquote><p>If you assume it is the <strong>same</strong> capture file, I would double-check the following things</p><ul><li>compare the SHA1/MD5 hashes of the capture files. Maybe your copy got modified somehow</li><li>compare the configuration of both Wireshark installations. Just run a diff (with WinMerge) of the folders %APPDATA%\Wireshark</li></ul><p>Regards<br />
Kurt</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>02 Apr '14, 14:43</strong></p><img src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Kurt%20Knochner&#39;s gravatar image" /><p><span>Kurt Knochner ♦</span><br />
<span class="score" title="24767 reputation points"><span>24.8k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">●</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">●</span><span class="badgecount">237</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Kurt Knochner has 344 accepted answers">15%</span> </br></p></img></div></div><div id="comments-container-31444" class="comments-container"><span id="31520"></span><div id="comment-31520" class="comment"><div id="post-31520-score" class="comment-score"></div><div class="comment-text"><p>Sorry for the delay. I appreciate the responses. The security policies of the bank will not allow me to post even one packet of the trace. Recently a guy "disappeared" for violating policy.</p><p>So, I'll see what I can do with what you guys have provided and will post again.</p></div><div id="comment-31520-info" class="comment-info"><span class="comment-age">(04 Apr '14, 09:54)</span> <span class="comment-user userinfo">dwsmithjr</span></div></div></div><div id="comment-tools-31444" class="comment-tools"></div><div class="clear"></div><div id="comment-31444-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

