+++
type = "question"
title = "Wireshark on Win7 Machine not capturing all traffic"
description = '''I have Wireshark 1.10.7 running on a win7 machine with an Intel Pro/1000T NIC. I have the NIC configured without an IPv4 or IPv6 address and have the interface options set to promiscuous mode. The NIC is connected to a switch port that is configured to mirror all traffic to it from 1 other port. On ...'''
date = "2014-06-09T17:17:00Z"
lastmod = "2014-06-12T06:11:00Z"
weight = 33597
keywords = [ "intelpro1000" ]
aliases = [ "/questions/33597" ]
osqa_answers = 1
osqa_accepted = false
+++

<div class="headNormal">

# [Wireshark on Win7 Machine not capturing all traffic](/questions/33597/wireshark-on-win7-machine-not-capturing-all-traffic)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-33597-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-33597-score" class="post-score" title="current number of votes">0</div><span id="post-33597-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I have Wireshark 1.10.7 running on a win7 machine with an Intel Pro/1000T NIC. I have the NIC configured without an IPv4 or IPv6 address and have the interface options set to promiscuous mode. The NIC is connected to a switch port that is configured to mirror all traffic to it from 1 other port. On that other port I have host sending a ping through the switch to another device that is responding. The Wireshark capture shows the ICMP requests, plus other background traffic from the same host, and some broadcast and multicast traffic, but no unicast traffic from any other host, including replies from the ping target. I have another Wireshark instance on an old Win31 laptop that, if plugged in place of the win7 machine, shows all traffic (ICMP requests, and responses, plus broadcast, multicast and traffic from other hosts). How do I fix the Win7 machine to capture all traffic? I've uninstalled and reinstalled Wireshark and WinPcap twice, including removing all user settings, and have updated the NIC driver, without success.</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-intelpro1000" rel="tag" title="see questions tagged &#39;intelpro1000&#39;">intelpro1000</span></div><div id="question-controls" class="post-controls"><div class="community-wiki">This question is marked "community wiki".</div></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>09 Jun '14, 17:17</strong></p><img src="https://secure.gravatar.com/avatar/ecbc64a66b7af842debb6e8acb9d7f16?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Jeff%20J&#39;s gravatar image" /><p><span>Jeff J</span><br />
<span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="bronze">●</span><span class="badgecount">1</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Jeff J has no accepted answers">0%</span></p></div></div><div id="comments-container-33597" class="comments-container"><span id="33632"></span><div id="comment-33632" class="comment"><div id="post-33632-score" class="comment-score"></div><div class="comment-text"><p>I ran into this same issue while assisting someone remotely troubleshoot a SIP softphone registration issue.</p><p>The Wireshark trace running on the customer PC along with the SIP softphone would show the responses from the server to the client, but never any of the Registration requests from the client to the server.</p><p>I then ping'd the server from the Win7 machine, and wireshark only showed the replies, not the requests.</p><p>Changed from wireless adapter to wired Ethernet port, and same results.</p><p>OS is win7 32-bit. No 3rd party firewall/AV/A-MW. Disabled windows firewall, uninstalled wireshark 1.10.7 and winpcap. Reinstalled...same thing.</p><p>This issue seems to not be going away and only increasing in reports. I completely understand the troubleshooting process of asking people to uninstall AV/Firewalls/VPN Clients, but are there any reports of anyone zeroing in on the source of the issue?</p></div><div id="comment-33632-info" class="comment-info"><span class="comment-age">(10 Jun '14, 20:45)</span> <span class="comment-user userinfo">Rooster_50</span></div></div><span id="33655"></span><div id="comment-33655" class="comment"><div id="post-33655-score" class="comment-score"></div><div class="comment-text"><blockquote><p>but are there any reports of anyone zeroing in on the source of the issue?</p></blockquote><p>Yes, VPN clients and Endpoint Security!</p></div><div id="comment-33655-info" class="comment-info"><span class="comment-age">(11 Jun '14, 10:30)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="33657"></span><div id="comment-33657" class="comment"><div id="post-33657-score" class="comment-score">1</div><div class="comment-text"><p>Some of it is the way WinPCap fits into the network stack. WinPCap is an NDIS 5 Driver, if someone were to rewrite it to NDIS 6 then things might get better.</p><p>NDIS is explained <a href="http://msdn.microsoft.com/en-gb/library/windows/hardware/ff565448(v=vs.85).aspx">here</a>.</p></div><div id="comment-33657-info" class="comment-info"><span class="comment-age">(11 Jun '14, 10:37)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="33685"></span><div id="comment-33685" class="comment"><div id="post-33685-score" class="comment-score"></div><div class="comment-text"><p><span>@grahamb</span>,</p><p>Thank you for taking the time to respond with a very informative and helpful explanation for people like me who are simply trying to further their understanding of this issue.</p><p>I noticed that Microsoft Network Monitor uses NDIS 5 and NDIS 6. If I have read correctly, NDIS 6 supports wifi monitor mode which is why MNM can capture 802.11 traffic and Wireshark (windows) cannot.</p><p>If the above is true, I am extremely surprised it has not already been written with NDIS 6+ support.</p><p>Again, thanks for the education.</p><p>Travis</p></div><div id="comment-33685-info" class="comment-info"><span class="comment-age">(11 Jun '14, 22:05)</span> <span class="comment-user userinfo">Rooster_50</span></div></div><span id="33689"></span><div id="comment-33689" class="comment not_top_scorer"><div id="post-33689-score" class="comment-score"></div><div class="comment-text"><p>It takes time, and unfortunately those who have the ability don't have the spare time. It's a non-trivial undertaking.</p></div><div id="comment-33689-info" class="comment-info"><span class="comment-age">(12 Jun '14, 03:02)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="33695"></span><div id="comment-33695" class="comment"><div id="post-33695-score" class="comment-score">2</div><div class="comment-text"><p>To me it looks like the Winpcap project has stalled or is abandoned. People with an intrest to contribute should make their voice heard or do a fork. Just my 2 cents.</p></div><div id="comment-33695-info" class="comment-info"><span class="comment-age">(12 Jun '14, 04:28)</span> <span class="comment-user userinfo">Anders ♦</span></div></div><span id="33696"></span><div id="comment-33696" class="comment not_top_scorer"><div id="post-33696-score" class="comment-score"></div><div class="comment-text"><p>I agree. There seems to be no interest in developing WinPcap any further. I guess packet capturing on Windows is not a big business, neither commercially nor for an open source project.</p><p>As <span>@grahamb</span> said: re-writing the code for NDIS6 is a non-trivial undertaking. As there is not much 'fame' to earn by that kind of projects, the motivation to invest is probably not very high. Even Microsoft dropped 'support' for Network Monitor, as there was not much attention to that project, although it had some interesting aspects, especially that the dissectors (parser) were generated from a DSL and executed in a virtual machine. I wish they would donate the whole source code to the public, not just the parsers.</p></div><div id="comment-33696-info" class="comment-info"><span class="comment-age">(12 Jun '14, 04:55)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="33697"></span><div id="comment-33697" class="comment not_top_scorer"><div id="post-33697-score" class="comment-score"></div><div class="comment-text"><p>Network Monitor lives on in the guise of the new uber app <a href="http://www.microsoft.com/en-gb/download/details.aspx?id=40308">Message Analyzer</a> that can also handle log files and other Windows trace files.</p><p>I would love to have the time to space to rewrite WinPCap, I made a start to get it running with the latest WDK but it's quite a task.</p></div><div id="comment-33697-info" class="comment-info"><span class="comment-age">(12 Jun '14, 04:58)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="33701"></span><div id="comment-33701" class="comment not_top_scorer"><div id="post-33701-score" class="comment-score"></div><div class="comment-text"><blockquote><p>Network Monitor lives on in the guise of the new uber app Message Analyzer</p></blockquote><p>well, that's the official story ;-) However, capturing network traffic with Message Analyzer is a total mess.</p><p>As they wrote in one of their blogs, <a href="http://blogs.technet.com/b/messageanalyzer/archive/2013/03/04/network-capture-is-dead.aspx">they consider network packet capturing to be dead</a>, so my interpretation is: they don't care too much about tools supporting network traffic capturing and/or analysis, that's why they abandoned Network Monitor and that's why support for packet analysis in Message Analyzer is less than worse, which in turn is good for Wireshark ;-)</p><p>Nevertheless, WinPcap needs a refresh to support Win 8.1 properly, as there have already been reports here about problems on Windows 8.1. The same holds true if Microsoft is going to release Windows 9. So, I wonder what the future of WinPcap and Wireshark will be on the Windows platform?</p></div><div id="comment-33701-info" class="comment-info"><span class="comment-age">(12 Jun '14, 05:12)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="33704"></span><div id="comment-33704" class="comment not_top_scorer"><div id="post-33704-score" class="comment-score"></div><div class="comment-text"><p>I personally have had no issues with WinPCap on two separate 8.1 machines.</p><p>I haven't tried Message Analyzer. As the blog then says in the first line "Long live capture". The essence is they are fusing all kinds of capture together in one interface, whether it works well at all I couldn't say. Wireshark is also moving in this direction for some things.</p></div><div id="comment-33704-info" class="comment-info"><span class="comment-age">(12 Jun '14, 05:28)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="33706"></span><div id="comment-33706" class="comment not_top_scorer"><div id="post-33706-score" class="comment-score"></div><div class="comment-text"><p>Adding links that may be of interest <a href="http://www.winpcap.org/pipermail/winpcap-users/2014-January/004855.html">http://www.winpcap.org/pipermail/winpcap-users/2014-January/004855.html</a></p><p><a href="http://www.winpcap.org/pipermail/winpcap-users/2014-February/004865.html">http://www.winpcap.org/pipermail/winpcap-users/2014-February/004865.html</a></p></div><div id="comment-33706-info" class="comment-info"><span class="comment-age">(12 Jun '14, 05:42)</span> <span class="comment-user userinfo">Anders ♦</span></div></div><span id="33707"></span><div id="comment-33707" class="comment not_top_scorer"><div id="post-33707-score" class="comment-score"></div><div class="comment-text"><p><span>@Anders</span>: thanks for the links.</p><p>Here is the download link for NPcap 1.x (NDIS 6 'enhanced' WinPcap): <a href="https://svn.nmap.org/nmap-exp/yang/NPcap-LWF/installer/">https://svn.nmap.org/nmap-exp/yang/NPcap-LWF/installer/</a></p></div><div id="comment-33707-info" class="comment-info"><span class="comment-age">(12 Jun '14, 05:50)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="33708"></span><div id="comment-33708" class="comment not_top_scorer"><div id="post-33708-score" class="comment-score"></div><div class="comment-text"><blockquote><p>As <span>@grahamb</span> said: re-writing the code for NDIS6 is a non-trivial &gt;undertaking. As there is not much 'fame' to earn by that kind of &gt;projects, the motivation to invest is probably not very high.</p></blockquote><p>I'm not sure there is much fame to be gained by writing for Wireshark either :-)</p></div><div id="comment-33708-info" class="comment-info"><span class="comment-age">(12 Jun '14, 05:53)</span> <span class="comment-user userinfo">Anders ♦</span></div></div><span id="33709"></span><div id="comment-33709" class="comment not_top_scorer"><div id="post-33709-score" class="comment-score"></div><div class="comment-text"><p>well... it's up to you to make that judgement. At least it's more 'fame' than for WinPcap ;-)) Only few people have ever heard of WinPcap and even fewer know what it is good for. <strong>A lot more</strong> know Wireshark. So, please keep contributing :-) I wish I had the time (and patience) to contribute code myself. Maybe some time ....</p></div><div id="comment-33709-info" class="comment-info"><span class="comment-age">(12 Jun '14, 06:11)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div></div><div id="comment-tools-33597" class="comment-tools"><span class="comments-showing"> showing 5 of 14 </span> <a href="#" class="show-all-comments-link">show 9 more comments</a></div><div class="clear"></div><div id="comment-33597-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="33608"></span>

<div id="answer-container-33608" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-33608-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-33608-score" class="post-score" title="current number of votes">0</div><span id="post-33608-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>Sounds like 'something' on your Win7 system prevents Wireshark from seeing all traffic. Please read the other questions tagged with 'outbound'.</p><blockquote><p><a href="http://ask.wireshark.org/tags/outbound/">http://ask.wireshark.org/tags/outbound/</a></p></blockquote><p>Usually its some piece of security software that causes the trouble</p><ul><li>AV</li><li>Local Firewall</li><li>Local VPN client</li><li>Endpoint Security</li><li>etc.</li></ul><p>If any of that is installed on your Win7 system, disable or better uninstall it and then try again.</p><p>Regards<br />
Kurt</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>10 Jun '14, 03:28</strong></p><img src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Kurt%20Knochner&#39;s gravatar image" /><p><span>Kurt Knochner ♦</span><br />
<span class="score" title="24767 reputation points"><span>24.8k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">●</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">●</span><span class="badgecount">237</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Kurt Knochner has 344 accepted answers">15%</span> </br></p></div></div><div id="comments-container-33608" class="comments-container"></div><div id="comment-tools-33608" class="comment-tools"></div><div class="clear"></div><div id="comment-33608-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

