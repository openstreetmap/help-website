+++
type = "question"
title = "best way to custom render osm .png tiles in Windows environment"
description = '''Hello All, In a Windows environment we were able to successfully loaded our data into a PostGIS database using osm2pgsql. Also successfully downloaded all the requisite shapefiles. Were able to create .png tiles using generate_tiles.py and mapnik-stylesheets-master&#x27;s osm.xml file. We are wondering w...'''
date = "2017-10-20T01:30:00Z"
lastmod = "2018-12-13T10:31:00Z"
weight = 60188
keywords = [ "windows", ".png", "render" ]
aliases = [ "/questions/60188" ]
osqa_answers = 6
osqa_accepted = false
+++

<div class="headNormal">

# [best way to custom render osm .png tiles in Windows environment](/questions/60188/best-way-to-custom-render-osm-png-tiles-in-windows-environment)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr>
<td style="width: 30px; vertical-align: top"><div class="vote-buttons">
<span id="post-60188-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span>
<div id="post-60188-score" class="post-score" title="current number of votes">
3
</div>
<span id="post-60188-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span>
<div id="favorite-count" class="favorite-count">
&#10;</div>
</div></td>
<td><div id="item-right">
<div class="question-body">
<p>Hello All,</p>
<p>In a Windows environment we were able to successfully loaded our data into a PostGIS database using osm2pgsql. Also successfully downloaded all the requisite shapefiles. Were able to create .png tiles using generate_tiles.py and mapnik-stylesheets-master's osm.xml file.</p>
<p>We are wondering what is the best way to custom render .png tiles? Should we use Komstik or TileMill? Or just manually edit mapnik-stylesheets-master's .xml.inc files? Please let us know your opinion and why. The more details the better. We have to work in a Windows environment and in the end must have the .png tiles in the standard OSM directory structure - z/x/y.png.</p>
<p>Thanks,<br />
SeattleHeather</p>
</div>
<div id="question-tags" class="tags-container tags">
<span class="post-tag tag-link-windows" rel="tag" title="see questions tagged &#39;windows&#39;">windows</span> <span class="post-tag tag-link-.png" rel="tag" title="see questions tagged &#39;.png&#39;">.png</span> <span class="post-tag tag-link-render" rel="tag" title="see questions tagged &#39;render&#39;">render</span>
</div>
<div id="question-controls" class="post-controls">
&#10;</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p>asked <strong>20 Oct '17, 01:30</strong></p>
<img src="https://secure.gravatar.com/avatar/41a7fedf2793f657dcef6efefeb10b49?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="SeattleHeather&#39;s gravatar image" />
<p><span>SeattleHeather</span><br />
<span class="score" title="220 reputation points">220</span><span title="6 badges"><span class="badge1">●</span><span class="badgecount">6</span></span><span title="9 badges"><span class="silver">●</span><span class="badgecount">9</span></span><span title="15 badges"><span class="bronze">●</span><span class="badgecount">15</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="SeattleHeather has no accepted answers">0%</span> </br></p>
</div>
<div class="post-update-info post-update-info-edited">
<p><span> edited <strong>08 Dec '18, 11:50</strong> </span></p>
<img src="https://secure.gravatar.com/avatar/66f0dc05b44574e3894be07b0b37cf37?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="aseerel4c26&#39;s gravatar image" />
<p><span>aseerel4c26 ♦</span><br />
<span class="score" title="32615 reputation points"><span>32.6k</span></span><span title="18 badges"><span class="badge1">●</span><span class="badgecount">18</span></span><span title="248 badges"><span class="silver">●</span><span class="badgecount">248</span></span><span title="554 badges"><span class="bronze">●</span><span class="badgecount">554</span></span></p>
</div>
</div>
<div id="comments-container-60188" class="comments-container">
<span id="67110"></span>
<div id="comment-67110" class="comment">
<div id="post-67110-score" class="comment-score">
&#10;</div>
<div class="comment-text">
<p>meta: hi all, please note that this <em>help</em> site <span>works different</span> from forums with discussion threads. Please stick to real questions, answers (answers to the original question) and comments (on question or on answers) next time - or use the <a href="http://forum.openstreetmap.org">OSM forum</a> instead, for such a discussion.</p>
</div>
<div id="comment-67110-info" class="comment-info">
<span class="comment-age">(08 Dec '18, 11:47)</span> <span class="comment-user userinfo">aseerel4c26 ♦</span>
</div>
</div>
</div>
<div id="comment-tools-60188" class="comment-tools">
&#10;</div>
<div class="clear">
&#10;</div>
<div id="comment-60188-form-container" class="comment-form-container">
&#10;</div>
<div class="clear">
&#10;</div>
</div></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

6 Answers:

</div>

</div>

<span id="64899"></span>

<div id="answer-container-64899" class="answer answered-by-owner">

<table style="width:100%;">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr>
<td style="width: 30px; vertical-align: top"><div class="vote-buttons">
<span id="post-64899-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span>
<div id="post-64899-score" class="post-score" title="current number of votes">
3
</div>
<span id="post-64899-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span>
</div></td>
<td><div class="item-right">
<div class="answer-body">
<p>Hi MapViking,</p>
<p>I ended up using shapefiles from <a href="http://download.geofabrik.de/index.html,">http://download.geofabrik.de/index.html,</a> TileMill, MBUtil, Python and my own custom style.mss. This worked and everything lines up correctly. This tutorial outlines everything quite well <a href="https://www.e-education.psu.edu/geog585/node/711.">https://www.e-education.psu.edu/geog585/node/711.</a> My understanding is that TileMill is old and not supported anymore however, it is free and does the work correctly. I also found it much easier to work with shapefiles as opposed to PostgreSQL/PostGIS/QGIS.</p>
<p>I added the shapefiles as Layers to TileMill. In the Add layer dialog box I specified them as File and then I only had to enter the ID and Datasource properties and left SRS at Autodetect. All of my shapefiles are in the same projection/datum.</p>
<p>I wrote my own style.mss and added it to the TileMill project. My style.mss is much simpler than OpenStreetMap's. There are examples on the Web as to how to render different things with a style.mss and I often referred to these to figure out how to do things.</p>
<p>Then in TileMill in the Project settings (wrench tool) I set the following.</p>
<p>Format: Optimized png (256 colors) Zoom: 9-11 Center: -121.0988,47.5023,12 Bounds: -125.584,43.3610,-115.723,49.5930 Scale Factor: 1 MetaTile size: 2</p>
<p>I saved these settings.</p>
<p>Under the Export menu dropdown I selected MBTiles. I then clicked the Export button. When the Export was done, I selected 'View exports' in TileMill's Export menu dropdown. Then, I clicked 'Save' in TileMill to save the file. For instance, c:\MyFiles\WaSt.mbtiles.<br />
I then downloaded and unzipped MBUtil to c:\mbutil. You can get mbutil at <a href="https://github.com/mapbox/mbutil">https://github.com/mapbox/mbutil</a></p>
<p>I already had python installed on my machine. I open a command prompt with administrator’s rights. At the command prompt I entered c:\python27\python.exe c:\mbutil\mb-util c:\MyFiles\WaSt.mbtiles c:\MyFiles\MyTiles</p>
<p>When mb-util was finished running I had the .png tiles for the specified bounds for zoom levels 9, 10 and 11 in the c:\MyFiles\MyTiles directory in the appropriate format.</p>
<p>TileMill can take awhile to render .pngs at the higher zoom levels. Sometimes I had to divide the area up that I wanted .pngs for so TileMill wouldn't bomb. I did this by changing the Bounds in the Project Settings to only generate parts of the whole area at a time.</p>
<p>Feel free to ask me any specific questions. Heather</p>
</div>
<div class="answer-controls post-controls">
&#10;</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p>answered <strong>24 Jul '18, 22:08</strong></p>
<img src="https://secure.gravatar.com/avatar/41a7fedf2793f657dcef6efefeb10b49?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="SeattleHeather&#39;s gravatar image" />
<p><span>SeattleHeather</span><br />
<span class="score" title="220 reputation points">220</span><span title="6 badges"><span class="badge1">●</span><span class="badgecount">6</span></span><span title="9 badges"><span class="silver">●</span><span class="badgecount">9</span></span><span title="15 badges"><span class="bronze">●</span><span class="badgecount">15</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="SeattleHeather has no accepted answers">0%</span> </br></p>
</div>
<div class="post-update-info post-update-info-edited">
<p><span> edited <strong>24 Jul '18, 22:20</strong> </span></p>
</div>
</div>
<div id="comments-container-64899" class="comments-container">
<span id="64912"></span>
<div id="comment-64912" class="comment">
<div id="post-64912-score" class="comment-score">
3
</div>
<div class="comment-text">
<p>Unfortunately TileMill is not supported anymore. It is therefore sensible to use Kosmtik for further use because TileMill does not interface to current versions of Mapnik. If you want static tiles at specific zoom levels QGIS querying your osm2pgsql database is a decent option as you can save the rendered data as MBTiles.</p>
</div>
<div id="comment-64912-info" class="comment-info">
<span class="comment-age">(25 Jul '18, 12:51)</span> <span class="comment-user userinfo">SK53 ♦</span>
</div>
</div>
<span id="64914"></span>
<div id="comment-64914" class="comment">
<div id="post-64914-score" class="comment-score">
&#10;</div>
<div class="comment-text">
<p>Hi Heather, and thank you very much for taking the time to answer my question the way you did. I will read through the walkthrough you linked to, and see if I can get it to work. I'll come back laiter with information on how it went.</p>
</div>
<div id="comment-64914-info" class="comment-info">
<span class="comment-age">(25 Jul '18, 13:50)</span> <span class="comment-user userinfo">MapViking</span>
</div>
</div>
<span id="64917"></span>
<div id="comment-64917" class="comment">
<div id="post-64917-score" class="comment-score">
&#10;</div>
<div class="comment-text">
<p>SK53, Is Kosmtik completely free? Can you use shapefiles with Kosmtik?</p>
</div>
<div id="comment-64917-info" class="comment-info">
<span class="comment-age">(25 Jul '18, 17:09)</span> <span class="comment-user userinfo">SeattleHeather</span>
</div>
</div>
<span id="64924"></span>
<div id="comment-64924" class="comment">
<div id="post-64924-score" class="comment-score">
1
</div>
<div class="comment-text">
<p>Kosmtik is completely free, and you can use shapefiles: it's pretty much the tool used by developers of the main map style on OSM. It basically offers a similar front-end onto Carto-CSS to that of TileMill. It is open source and was developed by an OSM contributor. Setting up Kosmtik requires more work than TileMill, but there are decent instructions on the github project page, and some notes on switch2osm.</p>
<p>(One further fly in the ointment, which I wouldnt worry about too much, is that Carto-CSS is itself getting long in the tooth. There are some interesting discussions on the subject in some OSM forums).</p>
</div>
<div id="comment-64924-info" class="comment-info">
<span class="comment-age">(25 Jul '18, 19:13)</span> <span class="comment-user userinfo">SK53 ♦</span>
</div>
</div>
<span id="64928"></span>
<div id="comment-64928" class="comment">
<div id="post-64928-score" class="comment-score">
1
</div>
<div class="comment-text">
<p>SK53, Is there a good 'How To' as to how to install Komstik, load a few locally stored shapefiles and export it all to .pngs in the Windows environment?</p>
</div>
<div id="comment-64928-info" class="comment-info">
<span class="comment-age">(25 Jul '18, 21:01)</span> <span class="comment-user userinfo">SeattleHeather</span>
</div>
</div>
<span id="66297"></span>
<div id="comment-66297" class="comment not_top_scorer">
<div id="post-66297-score" class="comment-score">
&#10;</div>
<div class="comment-text">
<p>Hello friends,</p>
<p>Which one of you could do that service to get tile render png osm?</p>
</div>
<div id="comment-66297-info" class="comment-info">
<span class="comment-age">(11 Oct '18, 19:00)</span> <span class="comment-user userinfo">CLAGOS</span>
</div>
</div>
<span id="66305"></span>
<div id="comment-66305" class="comment not_top_scorer">
<div id="post-66305-score" class="comment-score">
&#10;</div>
<div class="comment-text">
<p>The <a href="https://github.com/gravitystorm/openstreetmap-carto/blob/master/DOCKER.md">Docker</a> environment that's part of OSM Carto should work on Windows, and does include Kosmtik.</p>
<p>Windows Subsystem for Linux (see <a href="https://www.openstreetmap.org/user/SomeoneElse/diary/42617">here</a>) is another option.</p>
</div>
<div id="comment-66305-info" class="comment-info">
<span class="comment-age">(11 Oct '18, 22:52)</span> <span class="comment-user userinfo">SomeoneElse ♦</span>
</div>
</div>
</div>
<div id="comment-tools-64899" class="comment-tools">
<span class="comments-showing"> showing 5 of 7 </span> <a href="#" class="show-all-comments-link">show 2 more comments</a>
</div>
<div class="clear">
&#10;</div>
<div id="comment-64899-form-container" class="comment-form-container">
&#10;</div>
<div class="clear">
&#10;</div>
</div></td>
</tr>
</tbody>
</table>

</div>

<span id="64895"></span>

<div id="answer-container-64895" class="answer">

<table style="width:100%;">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr>
<td style="width: 30px; vertical-align: top"><div class="vote-buttons">
<span id="post-64895-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span>
<div id="post-64895-score" class="post-score" title="current number of votes">
1
</div>
<span id="post-64895-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span>
</div></td>
<td><div class="item-right">
<div class="answer-body">
<p>Hi. Did you have any success in generating png tiles using mapnik on windows? I found this: <a href="https://openstreetmapserverwindows.blogspot.com/2015/11/osmopenstreetmap-tile-server.html">https://openstreetmapserverwindows.blogspot.com/2015/11/osmopenstreetmap-tile-server.html</a></p>
<p>And managed to generate png tiles using mapnik in the way your are asking. But not really usable since many roads are not rendered correct, and there is also some misalignment of the content internally in the generated tiles. I suspect stylesheet problem, but information about how to accomplish this in a windows environment is not to good.</p>
<p>So If you have made any progress and want to share some of your experience - please do so.</p>
<p>Here is an example area from the map from my server, using the generated tiles and leaflet. Compared to the next image, which is from same area and same zoom level (but from the Openstreetmap.org server, there is still some more work to be done before it's usable:</p>
<p><img src="http://www.monsanto.no/images/osm/Reykjavik-area-mapnik-windows-tiles.jpg" alt="1 An area consisting of tiles from my server" /></p>
<p><img src="http://www.monsanto.no/images/osm/Reykjavik-area-from-openstreetmap.org.jpg" alt="2. Same area but now viewed using Openstreetmap.org" /></p>
</div>
<div class="answer-controls post-controls">
&#10;</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p>answered <strong>24 Jul '18, 20:44</strong></p>
<img src="https://secure.gravatar.com/avatar/0da1f043b943c87172fb4dc60f017440?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="MapViking&#39;s gravatar image" />
<p><span>MapViking</span><br />
<span class="score" title="56 reputation points">56</span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="4 badges"><span class="silver">●</span><span class="badgecount">4</span></span><span title="7 badges"><span class="bronze">●</span><span class="badgecount">7</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="MapViking has no accepted answers">0%</span></p>
</img>
</div>
</div>
<div id="comments-container-64895" class="comments-container">
<span id="64913"></span>
<div id="comment-64913" class="comment">
<div id="post-64913-score" class="comment-score">
3
</div>
<div class="comment-text">
<p>You are referencing very old technology. The image you produce strongly suggests to me that you are using an old software stack which does not handle 64-bit integers used for OSM elements. There is a relatively recent post by SomeoneElse (one of the maintainers &amp; testers of the switch2osm website) as a diary entry about setting up the current stack to run under Windows.</p>
</div>
<div id="comment-64913-info" class="comment-info">
<span class="comment-age">(25 Jul '18, 12:54)</span> <span class="comment-user userinfo">SK53 ♦</span>
</div>
</div>
<span id="64937"></span>
<div id="comment-64937" class="comment">
<div id="post-64937-score" class="comment-score">
&#10;</div>
<div class="comment-text">
<p>Thanks for tips. Do you have a link to that recent post about setting up the current stack to run under windows?</p>
</div>
<div id="comment-64937-info" class="comment-info">
<span class="comment-age">(26 Jul '18, 08:39)</span> <span class="comment-user userinfo">MapViking</span>
</div>
</div>
<span id="67108"></span>
<div id="comment-67108" class="comment">
<div id="post-67108-score" class="comment-score">
&#10;</div>
<div class="comment-text">
<p>Hello everybody, I wanted to ask if someone got the link mentioned or if you have an answer to handle 64 bit integer, I am having the same issue of missing data on map tiles</p>
</div>
<div id="comment-67108-info" class="comment-info">
<span class="comment-age">(08 Dec '18, 11:31)</span> <span class="comment-user userinfo">questionosmuser</span>
</div>
</div>
</div>
<div id="comment-tools-64895" class="comment-tools">
&#10;</div>
<div class="clear">
&#10;</div>
<div id="comment-64895-form-container" class="comment-form-container">
&#10;</div>
<div class="clear">
&#10;</div>
</div></td>
</tr>
</tbody>
</table>

</div>

<span id="64929"></span>

<div id="answer-container-64929" class="answer">

<table style="width:100%;">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr>
<td style="width: 30px; vertical-align: top"><div class="vote-buttons">
<span id="post-64929-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span>
<div id="post-64929-score" class="post-score" title="current number of votes">
1
</div>
<span id="post-64929-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span>
</div></td>
<td><div class="item-right">
<div class="answer-body">
<p>Hi again Heather, I have now read the tutorial. And have been able to import the osm-bright style into TileMill, as well as connect to the database where I have the planet data (not the whole planet though) from Geofabrik.de.</p>
<p>Then I exported to an mbtiles file from TileMill and used mbutil to create the tiles. The map tiles now render without any artifacts, misalignment and such. You can see same area as I added to my first comment in this thread - for comparison (below).</p>
<p>In between the work with TileMill, I checked what version of osm2pgsql I was using when importing data to the postgis db, and found out that is was quite an old version. I installed the previos version using a link in an online tutorial on how to get it to work on Windows. After I downloaded the latest version of it, and then imported data into the db - and used mapnik to generate tiles again, then the map was allmost perfect. But still some misalignment of road numbers.</p>
<p>I have also exported an xml file from the osm-bright project I imported to TileMill. I would now like to try to use the OSMBright-style (xml) exported from TileMill in my previous workflow - to see if that actually produces the same end result. If it does it would be interesting to see which of the two - mapnik or mbutil, produces the tiles faster, and if there is any difference in the size of the png tiles (in bytes).</p>
<p>When I use osm2pgsql to import data to the PostGis db, I specify a style to use. I use something called default.style in the osm2pgsql folder. What is this? Can I produce such a file from the generated OSMBright.xml from TileMill or some other tool? I also get some errors when I try to use the OSMBright.xml with the generate_tiles.py in mapnik. The current error is:</p>
<p>RuntimeError: Failed to find font face 'Arundina Sans Regular' in FontSet 'fontset-0' in FontSet at line 15 of 'OSMBright.xml'</p>
<p>When I look in the folders of TileMill I have not been able to locate that font face. Do you know how to get this fixed, and where to find the font / fontset? And where do I store these fontset / fonts in mapnik?</p>
<p>Anyway... using TileMill and Mbutil, as you suggested, I can now generate png tiles where a comparable area of the previously posted faulty looking map (from my first comment in this thread) - now look like this (so if not able to produce perfect tiles in mapnik under windows with the OSMBright.xml style, then I can definitely use your solution to generate the tiles):</p>
<p><img src="http://www.monsanto.no/images/osm/Reykjavik-area-tilemill-mbutil-tiles.jpg" alt="Map area from tiles generated using TileMill mbtiles file and mbutil." /></p>
</div>
<div class="answer-controls post-controls">
&#10;</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p>answered <strong>25 Jul '18, 22:23</strong></p>
<img src="https://secure.gravatar.com/avatar/0da1f043b943c87172fb4dc60f017440?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="MapViking&#39;s gravatar image" />
<p><span>MapViking</span><br />
<span class="score" title="56 reputation points">56</span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="4 badges"><span class="silver">●</span><span class="badgecount">4</span></span><span title="7 badges"><span class="bronze">●</span><span class="badgecount">7</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="MapViking has no accepted answers">0%</span></p>
</img>
</div>
<div class="post-update-info post-update-info-edited">
<p><span> edited <strong>25 Jul '18, 22:47</strong> </span></p>
</div>
</div>
<div id="comments-container-64929" class="comments-container">
&#10;</div>
<div id="comment-tools-64929" class="comment-tools">
&#10;</div>
<div class="clear">
&#10;</div>
<div id="comment-64929-form-container" class="comment-form-container">
&#10;</div>
<div class="clear">
&#10;</div>
</div></td>
</tr>
</tbody>
</table>

</div>

<span id="64950"></span>

<div id="answer-container-64950" class="answer answered-by-owner">

<table style="width:100%;">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr>
<td style="width: 30px; vertical-align: top"><div class="vote-buttons">
<span id="post-64950-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span>
<div id="post-64950-score" class="post-score" title="current number of votes">
1
</div>
<span id="post-64950-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span>
</div></td>
<td><div class="item-right">
<div class="answer-body">
<p>Hi MapViking. I did the export in pieces. So, I would select a medium sized geographic extent and export several zoom levels. Then, I would export the same geographic extent with several other zoom levels. After I ran mbutil for both exports I combined the resultant .pngs into one directory. This was easy to do. From the first export mbutil might produce directories 9, 10 and 11. From the second export mbutil might might produce directories 12 and 13. When I copied directories 9, 10, 11, 12 and 13 all into the same directory it was just as though TileMill had generated those .pngs all at the same time. I too found that TileMill bombed when I had it generate too many .pngs at once. Geographically dividing the area up and doing different zoom levels at a time was a solution that worked for me.</p>
</div>
<div class="answer-controls post-controls">
&#10;</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p>answered <strong>26 Jul '18, 17:16</strong></p>
<img src="https://secure.gravatar.com/avatar/41a7fedf2793f657dcef6efefeb10b49?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="SeattleHeather&#39;s gravatar image" />
<p><span>SeattleHeather</span><br />
<span class="score" title="220 reputation points">220</span><span title="6 badges"><span class="badge1">●</span><span class="badgecount">6</span></span><span title="9 badges"><span class="silver">●</span><span class="badgecount">9</span></span><span title="15 badges"><span class="bronze">●</span><span class="badgecount">15</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="SeattleHeather has no accepted answers">0%</span></p>
</img>
</div>
</div>
<div id="comments-container-64950" class="comments-container">
&#10;</div>
<div id="comment-tools-64950" class="comment-tools">
&#10;</div>
<div class="clear">
&#10;</div>
<div id="comment-64950-form-container" class="comment-form-container">
&#10;</div>
<div class="clear">
&#10;</div>
</div></td>
</tr>
</tbody>
</table>

</div>

<span id="64943"></span>

<div id="answer-container-64943" class="answer">

<table style="width:100%;">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr>
<td style="width: 30px; vertical-align: top"><div class="vote-buttons">
<span id="post-64943-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span>
<div id="post-64943-score" class="post-score" title="current number of votes">
0
</div>
<span id="post-64943-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span>
</div></td>
<td><div class="item-right">
<div class="answer-body">
<p>I have now imported the osm file for South America into the PostGis DB: <a href="http://download.geofabrik.de/south-america-latest.osm.pbf">http://download.geofabrik.de/south-america-latest.osm.pbf</a></p>
<p>When I open TileMill I can zoom and pan within the imported data. It takes a while for the UI to update, but eventually TileMill show the map for selected zoom-level and pan area nicely.</p>
<p>I now want to export all of the data in the DB (for South America) to an mbtiles file.</p>
<p>If I set a larger area (bounds) than is showing on the geofabrik site for South America (which I have to do (I guess) if I want to cover the whole area that is in the osm file), what will TileMill do with all the area which is outside the area in the osm file? Will TileMill generate tiles for none-existent data in the DB?</p>
<p>How do I specify export bounds that make sure I only generate mbtiles data for the data (area) in the database, and not area outside the OSM data from geofabrik ? Would be nice to get this clarified before I start the export process, since I suspect that process will take many hours, zoom level 1 - 11.</p>
<p><strong>UPDATE:</strong> I now set bound so I covered the main land of South America, and activated the export to mbtiles in Tilemill. After a short while I got the message in TileMill that the export failed. At the end of the TileMill log I see this: [Error: socket hang up] code: 'ECONNRESET'</p>
<p>So what can be the reason for this? Any tips on what I could do to resolve this issue? What I want to do is to render tiles region by region, and eventually end up with a map (png tiles) for the whole world (zoom level 1-11) except for Antarctica region. I use: Windows 7 8 x Intel(R) Core(TM) i7 CPU 960 @ 3.20GHz 12.9GB RAM /</p>
<p>Then I imported norway-latest.osm.pbf into database. Opened a new project with the same OSMBright style (as I used for Iceland). After a while I get a detailed map visible in editor and exporter window of TileMill. Then I create a bounding box just around Norway and export. After a minute or so, TileMill report Export process failed. In the tilemill log I find this at the end:</p>
<p>bad allocation [tilemill] Export process failed [tilemill] [tilemill] no crash logs found</p>
<p><strong>SECOND UPDATE</strong></p>
<p>I do not know why tilemill complain about bad allocation and fail in the export process of mbtiles file. But in this last test I'm still using data fra the datbase (as I did when I managed to create an mbtilesfile for Iceland). I started with South America (high in spirit), but that failed when exporting from TileMill.</p>
<p>Then I imported Norway into the datase and selected norway bounds, and that failed.</p>
<p>Now in my last try to get something usable out of tilemill for something else than Iceland, I thought I could try to export just a tiny part of Norway. That also resulted in failed export and this message at the end of the tilemill log file: bad allocation [tilemill] Export process failed [tilemill] [tilemill] no crash logs found [tilemill] Closing child process: core (pid:11088) Exiting TileMill due to fatal error...</p>
<p>Here is the tiny area that I selected. If I have to select smaller areas than this in the export process, then I believe it is going to be a very long way to generate tiles for all the regions and countries I want. I have looked at memory and CPU usage in the export process. Memory usage are quite low, but CPU reaches 100% in a short time.</p>
<p>If anyone has some suggestions on how find out the cause for tilemill keeps failing the export - it would be awesome.</p>
<p><strong>THIRD UPDATE:</strong> Now I used the same tiny area as below, but selected zoom level 1-8. Then it generated the mbtiles file without any errors. I will now try to move the export dir for TileMill to an SSD disk, to see if that make it possible to export the whole zoom range I want (1-11), and perhaps choosing larger bounding box. If not, I will have to find another way to pre-generate the image tiles.</p>
<p><strong>FOURTH UPDATE:</strong> I moved the export dir of TileMill to an SSD disk. Then I used same area (bounds) as in the image below, and selected zoom level 9-11. Then that generated the mbtiles file whithout errors.</p>
<p>Then I dragged the right edge of the selected area, to the left side of Norway, to get the western part of this lower area of Norway. Here I tried first with zoom level 1-11. Which failed. Then I tried with zoom level 1-8. Which also failed.</p>
<p>Memory usage is around 3-4 GB. CPU usage is popping up to around 99-100% when I activate the export.</p>
<p>Since it is not possible for me to get consistent exports here without to much trouble, then I probably have to find another solution.</p>
<p>Another thing that might be an issue for me, is that In order to get tiles across borders to match in the final map (map for most of the world), I will have to import region by region to the database, and then select my bounding boxes for the tile generation carefully.</p>
<p>I suspect that if I import e.g. only Norway, and then produce tiles for that country. Then import Sweden and produce tiles for that country. Then there will be some tiles which will miss data for the area which fall outside the data in the database and still are within the set bounding box - causing some of these neighbouring tiles to loose data (please correct me if this is wrong).</p>
<p>Shapefiles are not available from the geofabrik.de for other regions than Antarctica. So working with shapefiles from geofabrik - is not an option for me.</p>
<p>I have seen the suggestion to use Kosmtik. Maybe I will have to look into that as well.</p>
<p><img src="http://www.monsanto.no/images/osm/Norway-L1-East.jpg" alt="alt text" /></p>
</div>
<div class="answer-controls post-controls">
&#10;</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p>answered <strong>26 Jul '18, 13:20</strong></p>
<img src="https://secure.gravatar.com/avatar/0da1f043b943c87172fb4dc60f017440?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="MapViking&#39;s gravatar image" />
<p><span>MapViking</span><br />
<span class="score" title="56 reputation points">56</span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="4 badges"><span class="silver">●</span><span class="badgecount">4</span></span><span title="7 badges"><span class="bronze">●</span><span class="badgecount">7</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="MapViking has no accepted answers">0%</span></p>
</img>
</div>
<div class="post-update-info post-update-info-edited">
<p><span> edited <strong>26 Jul '18, 17:50</strong> </span></p>
</div>
</div>
<div id="comments-container-64943" class="comments-container">
&#10;</div>
<div id="comment-tools-64943" class="comment-tools">
&#10;</div>
<div class="clear">
&#10;</div>
<div id="comment-64943-form-container" class="comment-form-container">
&#10;</div>
<div class="clear">
&#10;</div>
</div></td>
</tr>
</tbody>
</table>

</div>

<span id="67107"></span>

<div id="answer-container-67107" class="answer">

<table style="width:100%;">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr>
<td style="width: 30px; vertical-align: top"><div class="vote-buttons">
<span id="post-67107-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span>
<div id="post-67107-score" class="post-score" title="current number of votes">
-1
</div>
<span id="post-67107-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span>
</div></td>
<td><div class="item-right">
<div class="answer-body">
<p>Hello, I had the same problem on rendering the tiles as MapViking, can anyone help with the link to setting up the current stack to run under windows to work with 64 bit integers? Thank you</p>
</div>
<div class="answer-controls post-controls">
<div class="community-wiki">
This answer is marked "community wiki".
</div>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p>answered <strong>08 Dec '18, 11:26</strong></p>
<img src="https://secure.gravatar.com/avatar/65ddd6860a97e2018415c5fd0a7dc212?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="questionosmuser&#39;s gravatar image" />
<p><span>questionosmuser</span><br />
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="bronze">●</span><span class="badgecount">1</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="questionosmuser has no accepted answers">0%</span></p>
</div>
</div>
<div id="comments-container-67107" class="comments-container">
<span id="67109"></span>
<div id="comment-67109" class="comment">
<div id="post-67109-score" class="comment-score">
1
</div>
<div class="comment-text">
<p>Possible options include <a href="https://www.openstreetmap.org/user/SomeoneElse/diary/45070">using Docker</a> or <a href="https://www.openstreetmap.org/user/SomeoneElse/diary/42617">Windows subsystem for Linux</a>.</p>
</div>
<div id="comment-67109-info" class="comment-info">
<span class="comment-age">(08 Dec '18, 11:34)</span> <span class="comment-user userinfo">SomeoneElse ♦</span>
</div>
</div>
<span id="67156"></span>
<div id="comment-67156" class="comment">
<div id="post-67156-score" class="comment-score">
&#10;</div>
<div class="comment-text">
<p>Finally got all your tutorials and directions right SomeoneElse, from installing Ubuntu on Win 10 (lot of win upgrades and time) until switch2osm tutorial for Ubuntu 18.04 (I am new on linux so yes, it got me time to get it right). Thank you very much for the hard work, great tutorials and fast answer.</p>
</div>
<div id="comment-67156-info" class="comment-info">
<span class="comment-age">(13 Dec '18, 10:31)</span> <span class="comment-user userinfo">questionosmuser</span>
</div>
</div>
</div>
<div id="comment-tools-67107" class="comment-tools">
&#10;</div>
<div class="clear">
&#10;</div>
<div id="comment-67107-form-container" class="comment-form-container">
&#10;</div>
<div class="clear">
&#10;</div>
</div></td>
</tr>
</tbody>
</table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

