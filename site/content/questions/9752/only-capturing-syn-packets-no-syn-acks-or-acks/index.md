+++
type = "question"
title = "Only Capturing SYN packets, no SYN-ACKs or ACKs"
description = '''Been having an issue on my network for a few days and can&#x27;t quite seem to figure out the issue here. In a nutshell, from my cable modem I have an outer router, switch and an inner router. All hosts connect to the inner router and all traffic flows out through the outer router. The 5-port switch is t...'''
date = "2012-03-25T19:15:00Z"
lastmod = "2012-10-02T12:00:00Z"
weight = 9752
keywords = [ "ack", "syn", "packet" ]
aliases = [ "/questions/9752" ]
osqa_answers = 2
osqa_accepted = false
+++

<div class="headNormal">

# [Only Capturing SYN packets, no SYN-ACKs or ACKs](/questions/9752/only-capturing-syn-packets-no-syn-acks-or-acks)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-9752-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-9752-score" class="post-score" title="current number of votes">0</div><span id="post-9752-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Been having an issue on my network for a few days and can't quite seem to figure out the issue here. In a nutshell, from my cable modem I have an outer router, switch and an inner router. All hosts connect to the inner router and all traffic flows out through the outer router. The 5-port switch is technically a hardwired TAP, (everything ingressing/degressing) on port 1 (plugged to the outer router) is mirrored on port 5 (where I have an IDS). Running Wireshark on the IDS and pulling up websites I can see 3-way handshakes, ARP, IGMP, etc traffic all day long. I can also see traffic from hosts (connected to the inner router) outbound. The only thing I don't see is most of the return traffic from the other hosts on the network. For instance, host connects to a website, on the IDS using Wireshark I see the typical SYN packet but no return SYN-ACK/ACK. The host connects fine and I can surf all day long. If I ping my outer router from the same host I see the outbound ICMP traffic, but no return ICMP traffic from the IDS.<br />
2 main things that are not jiving here is that I have SNORT running on the IDS rig and it is alerting off of inbound and outbound traffic with no issues. Also, I run Microsoft's Network Monitor 3.4 and it picks up all the traffic I don't see in Wireshark - meaning I can see the 3-way handshake when connecting to websites with other hosts. If I run TShark and WinDump - I am also NOT able to capture all of the packets. I find it hard to believe that I have three programs that are not able to capture all packets on the wire but the Microsoft's app does? Love the tool but I would prefer Wireshark. Perhaps I am having an issue with my NIC not compatible with the other programs. I am running a Realtek RTL 8168;</p><p>Help me Obi-Wan Kenobi .... you're my only hope!<br />
</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-ack" rel="tag" title="see questions tagged &#39;ack&#39;">ack</span> <span class="post-tag tag-link-syn" rel="tag" title="see questions tagged &#39;syn&#39;">syn</span> <span class="post-tag tag-link-packet" rel="tag" title="see questions tagged &#39;packet&#39;">packet</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>25 Mar '12, 19:15</strong></p><img src="https://secure.gravatar.com/avatar/8d0e91732a69c04694b3e883d9ab6002?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="DigitalSyn&#39;s gravatar image" /><p><span>DigitalSyn</span><br />
<span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="DigitalSyn has one accepted answer">33%</span> </br></br></p></div></div><div id="comments-container-9752" class="comments-container"></div><div id="comment-tools-9752" class="comment-tools"></div><div class="clear"></div><div id="comment-9752-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

2 Answers:

</div>

</div>

<span id="14632"></span>

<div id="answer-container-14632" class="answer accepted-answer answered-by-owner">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-14632-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-14632-score" class="post-score" title="current number of votes">0</div><span id="post-14632-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span class="accept-answer on" rel="nofollow" title="DigitalSyn has selected this answer as the correct answer"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>Can I answer my own question?</p><p>Anyways for everyone\anyone interested in the solution that I came up. Apparently the issue lies within Win 7 X64 and in the deep abyss of how it handles its NIC card drivers and associated applications (at least on all of my hosts as every one of them is running Win 7 x64). I did not get to the actual root of the problem (I could have loaded a customized driver and I did not try another version of Microsoft); I went ahead and scrapped the OS and loaded Ubuntu 12.04 and everything is coming up gloriously.</p><p>All I have to do now is return $300 worth of networking equipment I thought was the culprit.<br />
</p><p>Thanks everyone for taking the time to read.<br />
</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>01 Oct '12, 16:30</strong></p><img src="https://secure.gravatar.com/avatar/8d0e91732a69c04694b3e883d9ab6002?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="DigitalSyn&#39;s gravatar image" /><p><span>DigitalSyn</span><br />
<span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="DigitalSyn has one accepted answer">33%</span> </br></br></p></div></div><div id="comments-container-14632" class="comments-container"><span id="14635"></span><div id="comment-14635" class="comment"><div id="post-14635-score" class="comment-score"></div><div class="comment-text"><p>What you didn't report is which version of Wireshark you were using, and whether it was 32 or 64 bit. As noted elsewhere on a similar question, I and many colleagues capture on Win7 x64 using the 32 bit version of Wireshark (1.6.x, 1.8.x and dev trunk) without any issues.</p></div><div id="comment-14635-info" class="comment-info"><span class="comment-age">(01 Oct '12, 23:49)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="14642"></span><div id="comment-14642" class="comment"><div id="post-14642-score" class="comment-score"></div><div class="comment-text"><p>That is good to know grahamb, I was running Wireshark x64 (1.8.2) on my hosts at the time.</p></div><div id="comment-14642-info" class="comment-info"><span class="comment-age">(02 Oct '12, 12:00)</span> <span class="comment-user userinfo">DigitalSyn</span></div></div></div><div id="comment-tools-14632" class="comment-tools"></div><div class="clear"></div><div id="comment-14632-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="9771"></span>

<div id="answer-container-9771" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-9771-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-9771-score" class="post-score" title="current number of votes">0</div><span id="post-9771-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>Might there be some interfering software installed on the IDS box? VPN client, Personal FW, AV software, etc? Please have a look at the <a href="http://wiki.wireshark.org/CaptureSetup/InterferingSoftware">wireshark wiki</a></p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>26 Mar '12, 12:55</strong></p><img src="https://secure.gravatar.com/avatar/7901a94d8fdd1f9f47cda9a32fcfa177?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="SYN-bit&#39;s gravatar image" /><p><span>SYN-bit ♦♦</span><br />
<span class="score" title="17094 reputation points"><span>17.1k</span></span><span title="9 badges"><span class="badge1">●</span><span class="badgecount">9</span></span><span title="57 badges"><span class="silver">●</span><span class="badgecount">57</span></span><span title="245 badges"><span class="bronze">●</span><span class="badgecount">245</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="SYN-bit has 174 accepted answers">20%</span></p></div></div><div id="comments-container-9771" class="comments-container"><span id="9818"></span><div id="comment-9818" class="comment"><div id="post-9818-score" class="comment-score"></div><div class="comment-text"><p>Thanks SYN-bit for the post. I thought the same thing as well but I am running nothing out of the ordinary on the IDS box. It's a very basic load; also I have Ubuntu installed on the IDS box and when I run Wireshark it is not able to pick up any return traffic either.<br />
</p></div><div id="comment-9818-info" class="comment-info"><span class="comment-age">(28 Mar '12, 06:24)</span> <span class="comment-user userinfo">DigitalSyn</span></div></div><span id="9823"></span><div id="comment-9823" class="comment"><div id="post-9823-score" class="comment-score"></div><div class="comment-text"><p>Were you running MS Netmon on the same box in a different partition? Or on another box on the same switchport?</p><p>I assume you are running the captures without any capture filters?</p></div><div id="comment-9823-info" class="comment-info"><span class="comment-age">(28 Mar '12, 12:37)</span> <span class="comment-user userinfo">SYN-bit ♦♦</span></div></div><span id="9842"></span><div id="comment-9842" class="comment"><div id="post-9842-score" class="comment-score"></div><div class="comment-text"><p>Running MS NETMON on the same rig but different partition - I think I see where you are going with this. Perhaps swap in a different rig - I haven't tried that yet and will see what the results are.<br />
</p><p>And Yes I am running Wireshark without any capture filters and after a fresh clean install.<br />
</p><p>Thank you and will update shortly.</p></div><div id="comment-9842-info" class="comment-info"><span class="comment-age">(29 Mar '12, 09:21)</span> <span class="comment-user userinfo">DigitalSyn</span></div></div><span id="10018"></span><div id="comment-10018" class="comment"><div id="post-10018-score" class="comment-score"></div><div class="comment-text"><p>My apologies for the long delay - was out on a family vacation and never finished my troubleshooting.</p><p>Recently, I disconnected my IDS rig and plugged the network cable into a new system. Running Wireshark again on that new system I am unable to see return SYN-ACKs or the ACKs; just the SYNs from internal to external. Checking ICMP traffic I am still only able to see outgoing traffic, nothing coming back even though the host is receiving those packets.</p></div><div id="comment-10018-info" class="comment-info"><span class="comment-age">(08 Apr '12, 15:46)</span> <span class="comment-user userinfo">DigitalSyn</span></div></div><span id="10019"></span><div id="comment-10019" class="comment"><div id="post-10019-score" class="comment-score"></div><div class="comment-text"><p>My only option is to start playing around with the TAP, maybe something is not working correctly. It just bothers me that MS NETMON is able to see all the traffic, including the SYN-ACKs and ACKs but no other program. With MS NETMON working as it should, logic tells me that the TAP is working as it should too.</p><p>Where is that "EASY" button ....</p></div><div id="comment-10019-info" class="comment-info"><span class="comment-age">(08 Apr '12, 15:46)</span> <span class="comment-user userinfo">DigitalSyn</span></div></div><span id="10020"></span><div id="comment-10020" class="comment not_top_scorer"><div id="post-10020-score" class="comment-score"></div><div class="comment-text"><p>Could you capture for a short while with Netmon and also with Wireshark (pinging the same system) and post them to <a href="http://www.cloudshark.org">http://www.cloudshark.org</a>? You can then paste the two URL's in a comment.</p></div><div id="comment-10020-info" class="comment-info"><span class="comment-age">(08 Apr '12, 16:55)</span> <span class="comment-user userinfo">SYN-bit ♦♦</span></div></div><span id="10077"></span><div id="comment-10077" class="comment not_top_scorer"><div id="post-10077-score" class="comment-score"></div><div class="comment-text"><p>SYN-bit, my sincere apologies again. I didn't see the 'Show All" comment button below my comments until tonight. Thanks for sticking with me on this ..... SYN-adventure. Here are the links - first one is from Wireshark and the second is from MS NETMON. Both turned on about 3 secs apart around the same time. The focus is on host 192.168.77.8; after a clean load of Win7 on the host I simply opened Firefox to google; afterwards I ran CMD and pinged <a href="http://www.cdrom.com">www.cdrom.com</a>; see the difference in the two?<br />
</p><p><a href="http://www.cloudshark.org/captures/00d23de0e59d">http://www.cloudshark.org/captures/00d23de0e59d</a></p><p><a href="http://www.cloudshark.org/captures/18fd2441a03d">http://www.cloudshark.org/captures/18fd2441a03d</a></p></div><div id="comment-10077-info" class="comment-info"><span class="comment-age">(11 Apr '12, 19:50)</span> <span class="comment-user userinfo">DigitalSyn</span></div></div><span id="10078"></span><div id="comment-10078" class="comment not_top_scorer"><div id="post-10078-score" class="comment-score"></div><div class="comment-text"><p>Captures were done on the IDS rig looking at my network; as a recap here is my network setup.</p><p>CableModem --&gt; Router1 --&gt; Switch --&gt; Router 2</p><p>Host: 192.168.778 is hanging off of Router 2</p><p>IDS: 192.168.77.3 is hanging off the switch which is a Dualcomm DCGS-2005L. Router 1 is plugged into port 1 of the switch, port 2 goes to Router 2 and the IDS is off of port 5. Port 1 is mirrored to port 5.</p></div><div id="comment-10078-info" class="comment-info"><span class="comment-age">(11 Apr '12, 19:55)</span> <span class="comment-user userinfo">DigitalSyn</span></div></div><span id="10219"></span><div id="comment-10219" class="comment not_top_scorer"><div id="post-10219-score" class="comment-score"></div><div class="comment-text"><p>Still no luck with my issue. I went ahead and replaced all of the network cables (just out of curisoity) and started to test other devices in lieu of my Dualcomm switch. I recently inserted a TAP in place of the Switch and again could only see outbound traffic, nothing inbound. I moved away from sitting in between the two routers and started sniffing between the cable modem and router 1 with the same results. I even brought in a third system using Wireshark and I still have the issue. I'm wondering if maybe my Outside Router is stripping off some of traffic information somehow?</p></div><div id="comment-10219-info" class="comment-info"><span class="comment-age">(17 Apr '12, 10:15)</span> <span class="comment-user userinfo">DigitalSyn</span></div></div><span id="10220"></span><div id="comment-10220" class="comment not_top_scorer"><div id="post-10220-score" class="comment-score"></div><div class="comment-text"><p>I have recently put in for a manageable switch and a new Router and will see how this changes things up.</p></div><div id="comment-10220-info" class="comment-info"><span class="comment-age">(17 Apr '12, 10:19)</span> <span class="comment-user userinfo">DigitalSyn</span></div></div><span id="14556"></span><div id="comment-14556" class="comment not_top_scorer"><div id="post-14556-score" class="comment-score"></div><div class="comment-text"><p>Bringing sexy back -</p><p>After all of these months I am still having the same issue. I have completely scrapped my entire network with new devices, ran Wireshark on multiple hosts and I still can't seem to find the issue. I have replaced the tap twice and I still see the same issue. I went basic and ran 3 hosts on my old tap and new tap with no routers involved and using static IPs. The monitoring host using Wireshark could only pick up half of the traffic while Microsoft NETMON picked up all of the traffic on all three hosts.</p><p>What am I doing wrong here?</p></div><div id="comment-14556-info" class="comment-info"><span class="comment-age">(26 Sep '12, 14:34)</span> <span class="comment-user userinfo">DigitalSyn</span></div></div></div><div id="comment-tools-9771" class="comment-tools"><span class="comments-showing"> showing 5 of 11 </span> <a href="#" class="show-all-comments-link">show 6 more comments</a></div><div class="clear"></div><div id="comment-9771-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

