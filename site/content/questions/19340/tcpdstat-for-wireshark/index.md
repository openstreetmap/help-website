+++
type = "question"
title = "TCPdSTAT for Wireshark?"
description = '''I have been working with some fun forensic command line tools. I have realized that while wireshark is fabulously powerful, it is not the easiest to get a &quot;baseline&quot; network reading or easily analyze network traffic for forensic evidence. I have used TCPdSTAT for a while, but it seems to be under de...'''
date = "2013-03-10T14:10:00Z"
lastmod = "2013-03-11T12:25:00Z"
weight = 19340
keywords = [ "lua", "dissector", "forensics", "tcpdstat" ]
aliases = [ "/questions/19340" ]
osqa_answers = 0
osqa_accepted = false
+++

<div class="headNormal">

# [TCPdSTAT for Wireshark?](/questions/19340/tcpdstat-for-wireshark)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-19340-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-19340-score" class="post-score" title="current number of votes">0</div><span id="post-19340-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I have been working with some fun forensic command line tools. I have realized that while wireshark is fabulously powerful, it is not the easiest to get a "baseline" network reading or easily analyze network traffic for forensic evidence. I have used TCPdSTAT for a while, but it seems to be under developed for PCAP-NG file formats (at least as far as i can tell). I have since been working on one of my own LUA scripts as a TCPdSTAT-esque port. It is called TCPdShark. It needs some more development. But I have focused it on IRC, FTP, SSH, Telnet, ARP, and a few others. I created a simple dissector that looks for protocol names in the packet. I have been wanting to parse text captured from IRC packets much like how follow tcp stream does. However, it appears that dissectors only go partway into the packet details, and in order to get to the irc.request.trailer section of the packet wireshark only dissects the packet when its been clicked on.</p><p>I am trying to write my script that is more for offline analysis, and very automated. Is there a way to get wireshark to rip every packet down to its basic elements automatically, without requiring the user to click on each one? or use follow tcp stream?</p><p>I was also wondering if there is a way to make packet counts more accurate? I have a packet counting method to perform statistical analysis on the pcap file. However, some times TCP and UDP packet counts add ip to over 100% of the total packets captured. does anyone know how to explain this discrepancy?</p><p>I would also like to donate this script to the wireshark community for further use and development. is there a forum for that kind of stuff?</p><p>thanks again!</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-lua" rel="tag" title="see questions tagged &#39;lua&#39;">lua</span> <span class="post-tag tag-link-dissector" rel="tag" title="see questions tagged &#39;dissector&#39;">dissector</span> <span class="post-tag tag-link-forensics" rel="tag" title="see questions tagged &#39;forensics&#39;">forensics</span> <span class="post-tag tag-link-tcpdstat" rel="tag" title="see questions tagged &#39;tcpdstat&#39;">tcpdstat</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>10 Mar '13, 14:10</strong></p><img src="https://secure.gravatar.com/avatar/6f40a438bd6cf5fc655e25a757ed867b?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="T3CHKOMMIE&#39;s gravatar image" /><p><span>T3CHKOMMIE</span><br />
<span class="score" title="11 reputation points">11</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="3 badges"><span class="silver">●</span><span class="badgecount">3</span></span><span title="5 badges"><span class="bronze">●</span><span class="badgecount">5</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="T3CHKOMMIE has no accepted answers">0%</span></p></div></div><div id="comments-container-19340" class="comments-container"><span id="19341"></span><div id="comment-19341" class="comment"><div id="post-19341-score" class="comment-score"></div><div class="comment-text"><blockquote><p>I have used TCPdSTAT for a while, but it seems to be under developed for PCAP-NG file formats</p></blockquote><p>The two versions of tcpdstat I've seen both use libpcap to read the capture file, so they should be able to read single-link-layer-header-type pcap-ng files on systems with libpcap 1.1.0 or later, such as OS X Snow Leopard or later, Solaris 11, sufficiently recent *BSDs and Linux distributions, and systems that don't come with libpcap on which you've installed libpcap 1.1.0 or later.</p></div><div id="comment-19341-info" class="comment-info"><span class="comment-age">(10 Mar '13, 15:30)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="19342"></span><div id="comment-19342" class="comment"><div id="post-19342-score" class="comment-score"></div><div class="comment-text"><blockquote><p>I created a simple dissector that looks for protocol names in the packet.</p></blockquote><p>If you want to look at what protocols appear in the packet, create a tap that looks at the "frame.protocols" field, which is a string containing a colon-separated list of protocol names ("filter names", so TCP shows up as "tcp", for example).</p></div><div id="comment-19342-info" class="comment-info"><span class="comment-age">(10 Mar '13, 15:32)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="19353"></span><div id="comment-19353" class="comment"><div id="post-19353-score" class="comment-score"></div><div class="comment-text"><p>Note that there's a bug in the IRC dissector in which it looses track of where it's dissecting, causing a malformed exception. Bug report has yet to be filed.</p></div><div id="comment-19353-info" class="comment-info"><span class="comment-age">(11 Mar '13, 05:50)</span> <span class="comment-user userinfo">Jaap ♦</span></div></div><span id="19362"></span><div id="comment-19362" class="comment"><div id="post-19362-score" class="comment-score"></div><div class="comment-text"><p>Good to know guys. Thank you for the heads up. Anyone know where I can put my script to allow people to collaborate? is there a wireshark repo? or should i just host it and post a link?</p><p>thanks again for the IRC bug. I have noticed those error I thought it was just the way I was taking in the dissected chunks!</p></div><div id="comment-19362-info" class="comment-info"><span class="comment-age">(11 Mar '13, 12:25)</span> <span class="comment-user userinfo">T3CHKOMMIE</span></div></div></div><div id="comment-tools-19340" class="comment-tools"></div><div class="clear"></div><div id="comment-19340-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

</div>

