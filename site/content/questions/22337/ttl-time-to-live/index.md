+++
type = "question"
title = "TTL (Time To Live)"
description = '''Dear all, what is the purpose of TTL on the Internet Protocol message? it live which conversation. regards, Hafiz!'''
date = "2013-06-25T20:24:00Z"
lastmod = "2013-06-26T20:46:00Z"
weight = 22337
keywords = [ "ip", "ttl" ]
aliases = [ "/questions/22337" ]
osqa_answers = 3
osqa_accepted = false
+++

<div class="headNormal">

# [TTL (Time To Live)](/questions/22337/ttl-time-to-live)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-22337-score" class="post-score" title="current number of votes">1</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Dear all,</p><p>what is the purpose of TTL on the Internet Protocol message? it live which conversation.</p><p>regards,</p><p>Hafiz!</p></div><div id="question-tags" class="tags-container tags">ip ttl</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>25 Jun '13, 20:24</strong></p><img src="https://secure.gravatar.com/avatar/3758b972d853e9581da61ce3f7ae12bf?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Hafiz&#39;s gravatar image" /><p>Hafiz<br />
<span class="score" title="26 reputation points">26</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Hafiz has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 27 Jun '13, 02:31</p><img src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="grahamb&#39;s gravatar image" /><p>grahamb ♦<br />
<span class="score" title="19834 reputation points"><span>19.8k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">●</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">●</span><span class="badgecount">206</span></span></p></div></div><div id="comments-container-22337" class="comments-container"><span id="22354"></span><div id="comment-22354" class="comment"><div id="post-22354-score" class="comment-score"></div><div class="comment-text"><p>Hafiz, can you explain what is the flow/test that you are performing, and the error generated to your HS and ussd app? Also, transaction id's would be appreciated (related to the trace you have provided).</p></div><div id="comment-22354-info" class="comment-info"><span class="comment-age">(26 Jun '13, 05:20)</span> Edmond</div></div></div><div id="comment-tools-22337" class="comment-tools"></div><div class="clear"></div><div id="comment-22337-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

3 Answers:

</div>

</div>

<span id="22338"></span>

<div id="answer-container-22338" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-22338-score" class="post-score" title="current number of votes">2</div></div></td><td><div class="item-right"><div class="answer-body"><p>TTL indicates the remaining life time of a packet when it is floating on a network.</p><p>If a packet arrives at a router with TTL Value 1 then that router should discard(as TTL becomes 0) it and send back ICMP Type 11 and Code 0 message(Time to live exceeded).</p><p>One advantage/purpose i can think of is to avoid Looping at Layer3 .If there is any packet loop in the network and each time it hits a routing interface it's value will be decremented and eventually this unhealthy packet perishes.</p><p>Moreover TraceRoute make use of this TTL mechanism.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>25 Jun '13, 20:53</strong></p><img src="https://secure.gravatar.com/avatar/2b038237e64839261fcc88e9fdef2b68?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="krishnayeddula&#39;s gravatar image" /><p>krishnayeddula<br />
<span class="score" title="629 reputation points">629</span><span title="35 badges"><span class="badge1">●</span><span class="badgecount">35</span></span><span title="41 badges"><span class="silver">●</span><span class="badgecount">41</span></span><span title="48 badges"><span class="bronze">●</span><span class="badgecount">48</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="krishnayeddula has 3 accepted answers">6%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 25 Jun '13, 21:25</p></div></div><div id="comments-container-22338" class="comments-container"><span id="22341"></span><div id="comment-22341" class="comment"><div id="post-22341-score" class="comment-score"></div><div class="comment-text"><p>Dear Krishnayeddula,</p><p>thanks from your support and help.</p><p>my issue is in a GSM network and below is my scenario.</p><p>{{{{{{Mobile Station====&gt; (MSC=TTL=63)====&gt;(STP=TTL=255)====&gt;(HLR=TTL=62)====&gt;(STP=TTL=255)====&gt;USSD}}}}}}</p><pre><code>                                   on the revert path</code></pre><p>{{{{{(USSD=TTL=62)====&gt;(STP=TTL=255)====&gt;(HLR=TTL=62)====&gt;STP=TTL=255)====&gt;MSC=-------===&gt;Mobile Station}}}}}}</p><p>MS send *303# to USSD USSD send back to MS please enter you facebook ID/// while i am typing my facebook on the screen of mobile my transection disconnecting. as i check on the trace release is coming from Mobile side. but i don't know to blame which platform.</p><p>best Regards,</p><p>Hafiz AWCC Afghanistan</p><p>i don't know how to attached my trace.</p></div><div id="comment-22341-info" class="comment-info"><span class="comment-age">(25 Jun '13, 23:51)</span> Hafiz</div></div></div><div id="comment-tools-22338" class="comment-tools"></div><div class="clear"></div><div id="comment-22338-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="22342"></span>

<div id="answer-container-22342" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-22342-score" class="post-score" title="current number of votes">1</div></div></td><td><div class="item-right"><div class="answer-body"><p>The IP TTL is a time-to-live at the IP layer to prevent packet destined for an undeliverable address from looping through the network forever. It is defined as:</p><pre><code>Time to Live:  8 bits

This field indicates the maximum time the datagram is allowed to
remain in the internet system.  If this field contains the value
zero, then the datagram must be destroyed.  This field is modified
in internet header processing.  The time is measured in units of
seconds, but since every module that processes a datagram must
decrease the TTL by at least one even if it process the datagram in
less than a second, the TTL must be thought of only as an upper
bound on the time a datagram may exist.  The intention is to cause
undeliverable datagrams to be discarded, and to bound the maximum
datagram lifetime.</code></pre><p>(see: <a href="http://tools.ietf.org/html/rfc791#page-14">RFC 791 page 14</a>)</p><p>I believe the hops you are drawing in your response to @krishnayeddula are hop at the application layer and not at the IP layer. Between these application layer hops are routers to get the IP packet from one server to the other. Each of these routers will decrement the IP TTL, but each server will create a new IP packet, with a new TTL value.</p><p>(You can share traces by uploading the trace to www.cloudshark.org and then paste the link to the trace here)</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>26 Jun '13, 00:02</strong></p><img src="https://secure.gravatar.com/avatar/7901a94d8fdd1f9f47cda9a32fcfa177?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="SYN-bit&#39;s gravatar image" /><p>SYN-bit ♦♦<br />
<span class="score" title="17094 reputation points"><span>17.1k</span></span><span title="9 badges"><span class="badge1">●</span><span class="badgecount">9</span></span><span title="57 badges"><span class="silver">●</span><span class="badgecount">57</span></span><span title="245 badges"><span class="bronze">●</span><span class="badgecount">245</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="SYN-bit has 174 accepted answers">20%</span></p></div></div><div id="comments-container-22342" class="comments-container"><span id="22350"></span><div id="comment-22350" class="comment"><div id="post-22350-score" class="comment-score"></div><div class="comment-text"><p>thanks Mr. SYN,</p><p><a href="http://www.cloudshark.org/captures/96a78386e75a">http://www.cloudshark.org/captures/96a78386e75a</a></p></div><div id="comment-22350-info" class="comment-info"><span class="comment-age">(26 Jun '13, 02:13)</span> Hafiz</div></div><span id="22351"></span><div id="comment-22351" class="comment"><div id="post-22351-score" class="comment-score"></div><div class="comment-text"><p>kindly please put some more light on:(each server will create a new IP packet, with a new TTL value)in my network</p></div><div id="comment-22351-info" class="comment-info"><span class="comment-age">(26 Jun '13, 02:16)</span> Hafiz</div></div><span id="22352"></span><div id="comment-22352" class="comment"><div id="post-22352-score" class="comment-score">2</div><div class="comment-text"><p>Consider the following setup:</p><p>srvA -&gt; rtr1 -&gt; rtr2 -&gt; srvB -&gt; rtr3 -&gt; srvC</p><p>Different systems use different initial TTL values (mostly 64, 128 or 255), for now, assume they all use 64.</p><p>A message from srvA to srvB will have the following headers:</p><pre><code>mac-srvA -&gt; mac-rtr1, ip-srvA -&gt; ip-srvB, TTL=64 (arriving at rtr1)
mac-rtr1 -&gt; mac-rtr2, ip-srvA -&gt; ip-srvB, TTL=63 (arriving at rtr2)
mac-rtr2 -&gt; mac-srvB, ip-srvA -&gt; ip-srvB, TTL=62 (arriving at srvB)</code></pre><p>Then if srvA has an application that somehow forwards the message to srvC, the following headers can be seen:</p><pre><code>mac-srvB -&gt; mac-rtr3, ip-srvB -&gt; ip-srvC, TTL=64 (arriving at rtr3)
mac-rtr3 -&gt; mac-srvC, ip-srvB -&gt; ip-srvC, TTL=63 (arriving at srvC)</code></pre><p>So you need to make a distinction in your analysis between routing hops and application hops. I believe you were mentioning application hops in your example.</p><p>In your example capture, made on 172.18.8.69 you can see that it communicates with 3 other systems:</p><p>Packets from 172.21.40.31 have a TTL of 63, which means there is one router in between 172.21.40.31 and 172.18.8.69 (assuming the 64 start value of the IP TTL).</p><p>Packets from 172.17.90.5 have a TTL of 62, which means there are two routers in between 172.17.90.5 and 172.18.8.69 (assuming the 64 start value of the IP TTL).</p><p>Packets from 192.168.236.5 have a TTL of 62, which means there are two routers in between 192.168.236.5 and 172.18.8.69 (assuming the 64 start value of the IP TTL).</p><p>The problem you are researching is not at the IP layer but in one of your application layers. I have very little knowledge of the mobile networking protocols. But I see an error in frame 17 with a 60 second delta, this looks like a timeout on that server to me. Could that be your problem source?</p></div><div id="comment-22352-info" class="comment-info"><span class="comment-age">(26 Jun '13, 03:10)</span> SYN-bit ♦♦</div></div><span id="22356"></span><div id="comment-22356" class="comment"><div id="post-22356-score" class="comment-score"></div><div class="comment-text"><p>Thanks Mr. SYN,</p><p>TTL is now cleared for me. appreciate for your support.</p><p>I looking to the other part of trace if faced any confusion i will come to you.</p><p>Regards,</p><p>Hafiz AWCC Afghanistan</p></div><div id="comment-22356-info" class="comment-info"><span class="comment-age">(26 Jun '13, 06:21)</span> Hafiz</div></div><span id="22360"></span><div id="comment-22360" class="comment"><div id="post-22360-score" class="comment-score"></div><div class="comment-text"><p>Thanks Mr. Edmond,</p><p>my test scenario is:</p><p>from MS i am sending *303# toward USSD getway USSD getway replaying press 1 to confirm from MS i press 1 and send to USSD USSD replay enter you Facebook ID while i am typing my Facebook ID its not waiting for some more secounds its disconnecting after 45 secound before i complete my ID.</p><p>our USSD team is saying that they have increased this time to 2 minutes. our HLR/MSC and STP teams are saying we don't have timer for this.</p><p>{{{{{{Mobile Station====&gt; ((MSC=TTL=63)SPC=5300)====&gt;((STP=TTL=255)SPC=7100 or 7200)====&gt;((HLR=TTL=62)SPC=5001)====&gt;((STP=TTL=255)====&gt;(USSD=SPC=5252)}}}}}}</p><pre><code>                               on the revert path</code></pre><p>{{{{{(USSD=TTL=62)====&gt;(STP=TTL=255)====&gt;(HLR=TTL=62)====&gt;STP=TTL=255)====&gt;MSC=-------===&gt;Mobile</p><p>there are many different packets in one transaction i don't know how to describe it, i attached an snapshoot of sorting the trace by time on the image place of YOUR ANSWER box.</p></div><div id="comment-22360-info" class="comment-info"><span class="comment-age">(26 Jun '13, 07:25)</span> Hafiz</div></div><span id="22382"></span><div id="comment-22382" class="comment not_top_scorer"><div id="post-22382-score" class="comment-score"></div><div class="comment-text"><p>also, note that ICMP embeds the original packet <em>inside</em> the ICMP data. So the IP address that you see in Wireshark is the actual device that sent you the ICMP type 11 code 0 (TTL Exceeded) message. So it's pretty easy to figure out who sent you the error message and why. It has nothing to do with your problem, and Sake (syn-bit) already explained some of this for you. But in case others are wondering, ICMP's ability to embed the original pkt header can be quite useful.</p></div><div id="comment-22382-info" class="comment-info"><span class="comment-age">(26 Jun '13, 19:21)</span> hansangb</div></div></div><div id="comment-tools-22342" class="comment-tools"><span class="comments-showing"> showing 5 of 6 </span> <a href="#" class="show-all-comments-link">show 1 more comments</a></div><div class="clear"></div><div id="comment-22342-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="22383"></span>

<div id="answer-container-22383" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-22383-score" class="post-score" title="current number of votes">1</div></div></td><td><div class="item-right"><div class="answer-body"><p>National laws may vary, but those are public point codes in that trace file and you have subscriber IMSIs in there, including their mobility procedures and an SMS delivery. That includes SMS text payload, which looks like it might be clear-text though it doesn't decode well into this alphabet. I just want you to be very aware of that before proceeding further - Since you're including all TCAP transactions within a given IP packet toward an STP in that trace (even if you're just searching for the one subscriber), you are including all of your IN traffic, your SMSC signaling and potentially sensitive/compromising data for the carrier and subscribers.</p><p>Having said that, a couple things to be clarified: The path you have drawn is not the path of any single routed IP packet, but rather they are paths that individual signaling messages in a call flow will take between the systems you are talking about, as SYN-Bit correctly surmised. Since this is SS7 over IP, you may be routing at a point code or GT level but the SS7 messages that the STP is routing are going to get their own separate IP packets. Between end points in each M3UA association there is a new IP packet, from this perspective. Also there is a separate IP packet between RNC/BSC and MSC (RANAP packet), and between base station and RNC/BSC (NBAP packet), each carrying this same USSD/NAS message along its way. Different IP packet, different TTL.</p><p>So now, finally, for your actual signaling problem :)</p><p>We can see in the trace that the USSD message got routed across the STP just fine and got sent to HLR. The invoke goes through and gets a response. The problem is that the return at packet 17 for TCAP transaction 0003bc30 (this USSD invoke) is a return error, with code 34 (System Failure). Therefor the question is:</p><ul><li>Why does the HLR with point code 5001 return the USSD invoke with error 34 (System Failure)? I'm guessing the 60 seconds it takes between invoke and return has something to do with it (timeout between HLR and USSD system)? The problem seems to be between HLR and USSD which doesn't appear in that trace file as far as I can tell.</li></ul><p>My suggestion is to step back from the noise in that trace file and focus here on packets 14 and 17, where the invoke is sent to HLR, it receives it, waits 60 seconds, then returns the error. So, focus on the content of TCAP transaction 0003bc30 ("tcap.tid == 00:03:bc:30" filter in Wireshark) and why it failed.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>26 Jun '13, 20:46</strong></p><img src="https://secure.gravatar.com/avatar/f533c5f20f9c9afbf4b03de08a100e11?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Quadratic&#39;s gravatar image" /><p>Quadratic<br />
<span class="score" title="1885 reputation points"><span>1.9k</span></span><span title="6 badges"><span class="badge1">●</span><span class="badgecount">6</span></span><span title="9 badges"><span class="silver">●</span><span class="badgecount">9</span></span><span title="28 badges"><span class="bronze">●</span><span class="badgecount">28</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Quadratic has 23 accepted answers">13%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 26 Jun '13, 21:03</p></div></div><div id="comments-container-22383" class="comments-container"><span id="22392"></span><div id="comment-22392" class="comment"><div id="post-22392-score" class="comment-score"></div><div class="comment-text"><p>Thanks Sir Quadratic and All,</p><p>actually the packet follows are correct i don't have complain.the issue is that while i am typing my Facebook ID on the screen of phone the connection shuld waite utill to i sumit my Facebook ID, but my connection intrupting after 45 second before to i submit my Facebook ID.</p><p>And as i check on the trace the release starting from Mobile phone not any other network node.</p><p>if you kindly tell me that do we can change TTL value in any kindly of Platforms?</p><p>Best Regards,</p><p>Hafiz</p></div><div id="comment-22392-info" class="comment-info"><span class="comment-age">(26 Jun '13, 23:51)</span> Hafiz</div></div><span id="22400"></span><div id="comment-22400" class="comment"><div id="post-22400-score" class="comment-score"></div><div class="comment-text"><p>Look at TCAP transaction 0003BC30 in packet number 17 in the trace file. In that message, we see a return on the USSD transaction after 60 seconds with a return error for system failure. Compare with the transaction of the same number in packet 14 and see that the error was indeed a response for the USSD invoke, so in my mind you have a clear error returned by HLR after a 60 second timeout. In that call flow, HLR should be sending to your USSD system at that point but tht is not in the trace file.</p><p>For TTL, I really think you're looking at the wrong thing here. If there was an issue with IP TTL, you'd see it decrement down to 1 and you would not see a return message sent in response to your invokes between MSC and HLR. The fact that you see the SS7 routing between point codes proves that each IP packet is being sent and received correctly between MsC and zsTP, and between STP and HLR.</p><p>For the MS-initiated release you're talking about, what protocol are you referring to? For sure the user device will eventually release RRC control and time out at the NAS layer if it has to (in this case) wait a whole minute and not see anything, but the question at hand is why you see a 60-second delay between invoke and return, why the return is system failure and really what is happening between HLR and USSD system. Why do you believe there is any TTL problem, or IP level problem at all? Is there any request not responded to at MAP level? It does not appear so in that trace.</p></div><div id="comment-22400-info" class="comment-info"><span class="comment-age">(27 Jun '13, 03:41)</span> Quadratic</div></div><span id="22479"></span><div id="comment-22479" class="comment"><div id="post-22479-score" class="comment-score"></div><div class="comment-text"><p>I am very sorry, that i did not provide all details at first. On the previous trace it was really correct that HLR send Error toward USSD and we took a wireshark trace from HLR there we saw that error is coming from MS and we took a trace from MSC its format is different i couldn’t attached it to cloudshark there the error is coming from BSS side with (Radio Interface Failure)</p><p>At this point USSD team expanded the time to 2 minutes but NSS STP and HLR teams are not accepting the error on there side According to the traces as far as i know on BSS there is no timer. so i was thinking that TTL is any kind of timer which is Releasing the connection, thanks to all that cleared my mind about it specially Mr.Quadratic last comment.<br />
</p><p>new attached trace details</p><p>At packet number 10 on the TCAP message Transaction ID=08240705 show an (abort by user) from MSC while you can see the MSC GT (93702993007) at SCCP message above the mentioned TCAP message.</p><p>And on packet 3 we can see the HLR-GT(93702980007) forward the error message which is coming from MSC side toward USSD-GT(93702992006) and we took a trace from MSC its format is different i couldn't attached it to cloudshark. there Mentioned that the error is coming from BSS side with (Radio Interface Failure) Error.</p><p>at this point if anyone have idea about timer expansion on NSN MSC, Hwawei STP, and NSN HLR or BSS kindly help and comment.</p><p><a href="http://www.cloudshark.org/captures/da0a025d550d">http://www.cloudshark.org/captures/da0a025d550d</a></p><p>Best Regards,</p><p>Hafiz</p></div><div id="comment-22479-info" class="comment-info"><span class="comment-age">(29 Jun '13, 22:52)</span> Hafiz</div></div><span id="22489"></span><div id="comment-22489" class="comment"><div id="post-22489-score" class="comment-score"></div><div class="comment-text"><p>Ah, I see thanks for clearing that up. If the system failure in the trace is being caused by MS-initiated abort then it sounds to me like something that needs to be handled at the USSD application level. While the systems in this call flow can have timeout timers at a TCAP transaction level, and at a MAP level for invoke/return exchanges, the end-to-end session would be controlled by the USSD application at the MS and USSD gateway.</p><p>Is the device timing out at a USSD level? The RRC connection on the radio side is also stateful (thus could potentially time out), as would the MS' mobility state with the serving MSC technically, but really this sounds like a USSD, application-specific timer problem.</p><p>Also for the final question on TTL, the IP protocol itself is stateless. There is no "session" at an IP level and no timer that can expire.</p></div><div id="comment-22489-info" class="comment-info"><span class="comment-age">(30 Jun '13, 13:03)</span> Quadratic</div></div></div><div id="comment-tools-22383" class="comment-tools"></div><div class="clear"></div><div id="comment-22383-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

