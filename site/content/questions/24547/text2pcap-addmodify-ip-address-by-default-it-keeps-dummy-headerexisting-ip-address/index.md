+++
type = "question"
title = "text2Pcap :- add/modify ip address. by default it keeps dummy header/existing ip address."
description = '''Hello, How can we add/modify ip address of pcap that is generated by text2pcap? which switch/parameter to use ?'''
date = "2013-09-10T22:32:00Z"
lastmod = "2013-09-11T03:30:00Z"
weight = 24547
keywords = [ "text2pcap", "ip", "address" ]
aliases = [ "/questions/24547" ]
osqa_answers = 0
osqa_accepted = false
+++

<div class="headNormal">

# [text2Pcap :- add/modify ip address. by default it keeps dummy header/existing ip address.](/questions/24547/text2pcap-addmodify-ip-address-by-default-it-keeps-dummy-headerexisting-ip-address)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-24547-score" class="post-score" title="current number of votes">0</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hello, How can we add/modify ip address of pcap that is generated by text2pcap? which switch/parameter to use ?</p></div><div id="question-tags" class="tags-container tags">text2pcap ip address</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>10 Sep '13, 22:32</strong></p><img src="https://secure.gravatar.com/avatar/a647b227e75e6126dd01db5440c11dc9?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="cbhatt&#39;s gravatar image" /><p>cbhatt<br />
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="cbhatt has no accepted answers">0%</span></p></div></div><div id="comments-container-24547" class="comments-container"></div><div id="comment-tools-24547" class="comment-tools"></div><div class="clear"></div><div id="comment-24547-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="24554"></span>

<div id="answer-container-24554" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-24554-score" class="post-score" title="current number of votes">2</div></div></td><td><div class="item-right"><div class="answer-body"><p>I'm not sure I understand your question correctly, but if you have a text file that you convert to pcap you can just edit the text file before converting it. If you already have the pcap file and want to modify an IP you can use trace editing tools like <a href="http://bittwist.sourceforge.net/">bittwiste</a>, <a href="http://tcpreplay.synfin.net/wiki/tcprewrite">tcprewrite</a> or <a href="http://www.tracewrangler.com">TraceWrangler</a>.</p><p>"Adding" an IP address is most likely not an option, unless you have a very specific (and realistic) place in the frame for this kind of thing.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>11 Sep '13, 03:30</strong></p><img src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Jasper&#39;s gravatar image" /><p>Jasper ♦♦<br />
<span class="score" title="23806 reputation points"><span>23.8k</span></span><span title="5 badges"><span class="badge1">●</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">●</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">●</span><span class="badgecount">284</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Jasper has 263 accepted answers">18%</span></p></div></div><div id="comments-container-24554" class="comments-container"><span id="24569"></span><div id="comment-24569" class="comment"><div id="post-24569-score" class="comment-score"></div><div class="comment-text"><p>In other words, the IP addresses that text2pcap puts in (when you use <code>-i</code>) aren't configurable. If you want to specify the IP addresses, don't use <code>-i</code> but rather build a complete packet yourself (so you can specify the IP addresses yourself).</p></div><div id="comment-24569-info" class="comment-info"><span class="comment-age">(11 Sep '13, 06:04)</span> JeffMorriss ♦</div></div><span id="24580"></span><div id="comment-24580" class="comment"><div id="post-24580-score" class="comment-score"></div><div class="comment-text"><p>replace the following bytes in the text2pcap binary with a Hex editor.</p><blockquote><p>45 00 00 00 12 34 00 00 FF 00 00 00 0A 01 01 01 0A 02 02 02 00</p></blockquote><p>Src: 192.168.1.1<br />
Dst: 192.168.2.2</p><p>would be:</p><blockquote><p>45 00 00 00 12 34 00 00 FF 00 00 00 <strong>C0 A8 01 01 C0 A8 02 02</strong> 00<br />
</p></blockquote><p>:-))</p></div><div id="comment-24580-info" class="comment-info"><span class="comment-age">(11 Sep '13, 09:39)</span> Kurt Knochner ♦</div></div><span id="24584"></span><div id="comment-24584" class="comment"><div id="post-24584-score" class="comment-score"></div><div class="comment-text"><p>You can prepend a dummy IP header using <a href="http://www.wireshark.org/docs/man-pages/text2pcap.html">text2pcap</a>'s "<code>-i &lt;proto&gt;</code>" option. See <a href="http://www.iana.org/assignments/protocol-numbers/protocol-numbers.xhtml">IANA's Protocol Numbers</a> page for the complete list of assigned internet protocol numbers.</p></div><div id="comment-24584-info" class="comment-info"><span class="comment-age">(11 Sep '13, 10:20)</span> cmaynard ♦♦</div></div></div><div id="comment-tools-24554" class="comment-tools"></div><div class="clear"></div><div id="comment-24554-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

