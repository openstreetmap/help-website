+++
type = "question"
title = "How a sub-dissector under SSL is supposed to reassemble split TCP Packets?"
description = '''I&#x27;ve followed the described way in WIreshark&#x27;s Guide but it didn&#x27;t work. Is there any hint about how the reassembling should be implemented in a sub dissector works under SSL. I&#x27;ve given more details about the problem in a question in Wireshark but I haven&#x27;t received any comments or answers about it...'''
date = "2015-08-06T09:28:00Z"
lastmod = "2015-08-07T05:31:00Z"
weight = 44908
keywords = [ "ssl", "subdissector", "reassemble", "wireshark" ]
aliases = [ "/questions/44908" ]
osqa_answers = 0
osqa_accepted = false
+++

<div class="headNormal">

# [How a sub-dissector under SSL is supposed to reassemble split TCP Packets?](/questions/44908/how-a-sub-dissector-under-ssl-is-supposed-to-reassemble-split-tcp-packets)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-44908-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-44908-score" class="post-score" title="current number of votes">0</div><span id="post-44908-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I've followed the described way in <a href="https://www.wireshark.org/docs/wsdg_html_chunked/ChDissectReassemble.html">WIreshark's Guide</a> but it didn't work. Is there any hint about how the reassembling should be implemented in a sub dissector works under SSL. I've given more details about the problem in <a href="https://ask.wireshark.org/questions/44826/what-is-the-problem-with-reassembling-in-this-pcap">a question</a> in Wireshark but I haven't received any comments or answers about it. I thought my question was too specific that no body can answer or go through it so I decided to ask a more general question hoping that it could lead me to some tips to solve my problem :)</p><p>The most <a href="https://ask.wireshark.org/questions/18082/tcp_dissect_pdus-doesnt-work-well-tcp-segment-of-a-reassembled-pdu">similar question</a> in Wireshark to mine is here but it wasn't helpful for me.</p><p>Thank you. Flora</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-ssl" rel="tag" title="see questions tagged &#39;ssl&#39;">ssl</span> <span class="post-tag tag-link-subdissector" rel="tag" title="see questions tagged &#39;subdissector&#39;">subdissector</span> <span class="post-tag tag-link-reassemble" rel="tag" title="see questions tagged &#39;reassemble&#39;">reassemble</span> <span class="post-tag tag-link-wireshark" rel="tag" title="see questions tagged &#39;wireshark&#39;">wireshark</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>06 Aug '15, 09:28</strong></p><img src="https://secure.gravatar.com/avatar/5642d9fe33d29ee47043f7e5796e67aa?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="flora&#39;s gravatar image" /><p><span>flora</span><br />
<span class="score" title="156 reputation points">156</span><span title="31 badges"><span class="badge1">●</span><span class="badgecount">31</span></span><span title="33 badges"><span class="silver">●</span><span class="badgecount">33</span></span><span title="38 badges"><span class="bronze">●</span><span class="badgecount">38</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="flora has 2 accepted answers">100%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>06 Aug '15, 22:53</strong> </span></p></div></div><div id="comments-container-44908" class="comments-container"><span id="44912"></span><div id="comment-44912" class="comment"><div id="post-44912-score" class="comment-score"></div><div class="comment-text"><p>I think it not, as in, the SSL layer is supposed to manage reassembly at the TCP layer, while it handles the reasembly of SSL (application) records. See also the various TCP and SSL preference settings. It may well be a bug in that part of the code, this is complicated stuff to make/test.</p></div><div id="comment-44912-info" class="comment-info"><span class="comment-age">(06 Aug '15, 22:40)</span> <span class="comment-user userinfo">Jaap ♦</span></div></div><span id="44914"></span><div id="comment-44914" class="comment"><div id="post-44914-score" class="comment-score"></div><div class="comment-text"><p>" while it handles the reasembly of SSL (application) records"</p><p>So is it like SSL handles the reassembly of TCP and the sub-dissector under SSL should handle the reassembly of SSL?</p></div><div id="comment-44914-info" class="comment-info"><span class="comment-age">(06 Aug '15, 22:52)</span> <span class="comment-user userinfo">flora</span></div></div><span id="44918"></span><div id="comment-44918" class="comment"><div id="post-44918-score" class="comment-score"></div><div class="comment-text"><p>Ah no, the SSL dissector, like other dissectors on top of the TCP dissector, can use the facilities provided by the TCP dissector to do reassembly (like you've seen documented). From the looks of it (derived from the SSL preferences) the SSL dissector takes care of its own, and should pass full application segments. But I haven't looked at the code in detail, so I might miss some important details.</p></div><div id="comment-44918-info" class="comment-info"><span class="comment-age">(07 Aug '15, 05:31)</span> <span class="comment-user userinfo">Jaap ♦</span></div></div></div><div id="comment-tools-44908" class="comment-tools"></div><div class="clear"></div><div id="comment-44908-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

</div>

