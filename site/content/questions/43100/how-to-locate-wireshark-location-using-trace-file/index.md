+++
type = "question"
title = "How to locate wireshark location using trace-file?"
description = '''I&#x27;m currently preparing for WCNA exam, I&#x27;m half way through the book &quot;Wireshark Network Analysis second edition&quot; on page 254, in chapter regarding TCP, laura (the author) has asked a question at end in exercise section which is very appealing and at same time I have no clue how to answer. The crux o...'''
date = "2015-06-12T12:18:00Z"
lastmod = "2015-06-15T03:56:00Z"
weight = 43100
keywords = [ "packetloss" ]
aliases = [ "/questions/43100" ]
osqa_answers = 4
osqa_accepted = true
+++

<div class="headNormal">

# [How to locate wireshark location using trace-file?](/questions/43100/how-to-locate-wireshark-location-using-trace-file)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-43100-score" class="post-score" title="current number of votes">0</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I'm currently preparing for WCNA exam, I'm half way through the book "Wireshark Network Analysis second edition" on page 254, in chapter regarding TCP, laura (the author) has asked a question at end in exercise section which is very appealing and at same time I have no clue how to answer.</p><p>The crux of it "<em>using trace-file how can I tell where the location of wireshark was either downstream (closer to host receiving packets) or upstream (closer to host sending packets). This is in regard to packet loss."</em></p><p>How can it be done?</p><p>Question from book</p><p>"<em>Does this connection support SACK? Does this connection support window scaling? The TCP Selective ACK option is used in packet 136. What do the left and right edge values indicate? In packet 679, what sequence number is 10.0.52.164 waiting for from 61.8.0.17? Is Wireshark downstream (closer to the client receiving the data) or upstream (closer to the TCP host that is sending data) from packet loss?</em>"</p></div><div id="question-tags" class="tags-container tags">packetloss</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>12 Jun '15, 12:18</strong></p><img src="https://secure.gravatar.com/avatar/a5e36ef8cc4416aa199a3a82dcb1deb4?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="lazerz&#39;s gravatar image" /><p>lazerz<br />
<span class="score" title="41 reputation points">41</span><span title="8 badges"><span class="badge1">●</span><span class="badgecount">8</span></span><span title="10 badges"><span class="silver">●</span><span class="badgecount">10</span></span><span title="14 badges"><span class="bronze">●</span><span class="badgecount">14</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="lazerz has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 14 Jun '15, 06:04</p></div></div><div id="comments-container-43100" class="comments-container"></div><div id="comment-tools-43100" class="comment-tools"></div><div class="clear"></div><div id="comment-43100-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

4 Answers:

</div>

</div>

<span id="43105"></span>

<div id="answer-container-43105" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-43105-score" class="post-score" title="current number of votes">2</div></div></td><td><div class="item-right"><div class="answer-body"><p>So in a TCP packet loss situation you will see retransmissions. But will you see the original packet? Or should I ask where will you see the original packet?</p><p>Sorry I am trying to lead you to the answer rather than giving it directly.</p><p>Can I ask how your studying is going? I am also studying for the WCNA, I have completed the books and the on-line material and most of the labs.</p><p>Good luck.</p><p>Now the answer, but its <a href="http://rot13.com">rot13</a> encoded, so you can choose to read it when you are ready; Vs lbhe jverfunexvat orsber gur cnpxrg ybff, gura lbh jvyy frr obgu gur bevtvany cnpxrg naq gur ergenafzvffvba. Vs lbh ner nsgre gur cnpxrg ybff lbh jvyy bayl frr gur ergenafzvffvbaf.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>12 Jun '15, 14:04</strong></p><img src="https://secure.gravatar.com/avatar/e4a81395f6649e064887d7f57ee653eb?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="chillypenguin&#39;s gravatar image" /><p>chillypenguin<br />
<span class="score" title="91 reputation points">91</span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="chillypenguin has one accepted answer">25%</span></p></div></div><div id="comments-container-43105" class="comments-container"><span id="43116"></span><div id="comment-43116" class="comment"><div id="post-43116-score" class="comment-score"></div><div class="comment-text"><p>Thanks chilly:)Preparations are fine so far. I really wish I can take more time from job for the end-chapter exercise they teach so much.</p><p>Interesting, you mentioned about labs? Is there a separate book or manual for lab work If yes please guide me through. I know that there is this 300 questions book for exam prep haven't read it yet.</p><p>For the answer thanks for old skool encryption:) I'm afraid reading your response I still can't say it answer the question. Did you view the trace file I hot-linked above? Best to move forward contact me a.alii85 at gmail dot com.</p></div><div id="comment-43116-info" class="comment-info"><span class="comment-age">(13 Jun '15, 01:11)</span> lazerz</div></div><span id="43119"></span><div id="comment-43119" class="comment"><div id="post-43119-score" class="comment-score"></div><div class="comment-text"><p>I have just responded via e-mail, with a more detailed tutorial of how to obtain the answer.</p></div><div id="comment-43119-info" class="comment-info"><span class="comment-age">(13 Jun '15, 09:46)</span> chillypenguin</div></div><span id="43134"></span><div id="comment-43134" class="comment"><div id="post-43134-score" class="comment-score">1</div><div class="comment-text"><p>@chillypenguin,</p><p>Your answer indicates the location of the capture against the location of the hop that's dropping the packet, I'm not sure that's what the original question asked, i.e. is the capture closer to the sender or receiver.</p></div><div id="comment-43134-info" class="comment-info"><span class="comment-age">(14 Jun '15, 01:59)</span> grahamb ♦</div></div><span id="43136"></span><div id="comment-43136" class="comment"><div id="post-43136-score" class="comment-score">1</div><div class="comment-text"><p>My interpretation of the question, was where the the capture being taken, up or down stream of the loss.</p></div><div id="comment-43136-info" class="comment-info"><span class="comment-age">(14 Jun '15, 04:43)</span> chillypenguin</div></div><span id="43137"></span><div id="comment-43137" class="comment"><div id="post-43137-score" class="comment-score"></div><div class="comment-text"><p>did you got the email i send you?</p></div><div id="comment-43137-info" class="comment-info"><span class="comment-age">(14 Jun '15, 06:03)</span> lazerz</div></div><span id="43138"></span><div id="comment-43138" class="comment not_top_scorer"><div id="post-43138-score" class="comment-score"></div><div class="comment-text"><p>@grahamb please see the question review.</p></div><div id="comment-43138-info" class="comment-info"><span class="comment-age">(14 Jun '15, 06:04)</span> lazerz</div></div></div><div id="comment-tools-43105" class="comment-tools"><span class="comments-showing"> showing 5 of 6 </span> <a href="#" class="show-all-comments-link">show 1 more comments</a></div><div class="clear"></div><div id="comment-43105-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="43101"></span>

<div id="answer-container-43101" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-43101-score" class="post-score" title="current number of votes">2</div></div></td><td><div class="item-right"><div class="answer-body"><p>Fairly obviously you're looking for some visible difference in the captures depending on where it's been taken.</p><p>Try to think about what changes in the packets might be visible as you move from the sending host to the receiving host. Is there something in the packets that changes as it traverses the route from the sender to the receiver via intermediate hops?</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>12 Jun '15, 12:44</strong></p><img src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="grahamb&#39;s gravatar image" /><p>grahamb ♦<br />
<span class="score" title="19834 reputation points"><span>19.8k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">●</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">●</span><span class="badgecount">206</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="grahamb has 274 accepted answers">22%</span></p></div></div><div id="comments-container-43101" class="comments-container"><span id="43103"></span><div id="comment-43103" class="comment"><div id="post-43103-score" class="comment-score"></div><div class="comment-text"><p>I have seen the trace file in terms of conversations, endpoints under statistics option and see the only communication is between host A and B only, no intermediate device were listed. Even so no icmp prot detected as well.</p></div><div id="comment-43103-info" class="comment-info"><span class="comment-age">(12 Jun '15, 13:38)</span> lazerz</div></div><span id="43104"></span><div id="comment-43104" class="comment"><div id="post-43104-score" class="comment-score"></div><div class="comment-text"><p>here is the link to trace-file <a href="http://www.filedropper.com/home_6">http://www.filedropper.com/home_6</a></p></div><div id="comment-43104-info" class="comment-info"><span class="comment-age">(12 Jun '15, 13:49)</span> lazerz</div></div><span id="43107"></span><div id="comment-43107" class="comment"><div id="post-43107-score" class="comment-score"></div><div class="comment-text"><p>Wireshark does only show the two endpoints as that's all that's available at any point in the route.</p><p>However, what MUST each intermediate router do to something in the packet as it transits that router from the sender to the receiver?</p></div><div id="comment-43107-info" class="comment-info"><span class="comment-age">(12 Jun '15, 14:36)</span> grahamb ♦</div></div><span id="43117"></span><div id="comment-43117" class="comment"><div id="post-43117-score" class="comment-score"></div><div class="comment-text"><p>Yes, its TTL, but then there is no icmp ttl expired messages or more the field values are both static for each host.</p></div><div id="comment-43117-info" class="comment-info"><span class="comment-age">(13 Jun '15, 01:15)</span> lazerz</div></div><span id="43118"></span><div id="comment-43118" class="comment"><div id="post-43118-score" class="comment-score"></div><div class="comment-text"><p>Please let me know if my understanding is correct using the time column set for "time since last display packet" is see 1.333 delta between SYN and syn/ack response, so If i was more closer to host sending this packet would the response comes more fast considering there is problem with network or congestion?</p></div><div id="comment-43118-info" class="comment-info"><span class="comment-age">(13 Jun '15, 01:23)</span> lazerz</div></div><span id="43133"></span><div id="comment-43133" class="comment not_top_scorer"><div id="post-43133-score" class="comment-score"></div><div class="comment-text"><p>I wasn't thinking of ICMP TTL exceeded, but the actual TTL in the packet that is being sent from sender to receiver.</p><p>Although absolute values are hard to determine, the TTL will be higher the nearer the capture is made to the server.</p><p>The absolute value is difficult as different OS's have a different default value. One table of default values is <a href="https://subinsb.com/default-device-ttl-values">here</a>.</p><p>If you can see a complete request\response from client to server and back, i.e. SYN and SYN ACK then looking at the delay between them can also be a clue, a shorter delay is closer to the server.</p></div><div id="comment-43133-info" class="comment-info"><span class="comment-age">(14 Jun '15, 01:56)</span> grahamb ♦</div></div><span id="43139"></span><div id="comment-43139" class="comment not_top_scorer"><div id="post-43139-score" class="comment-score"></div><div class="comment-text"><p>Yes true indeed. This is how I worked around the problem.The way I was able to answer this, was as you said got some help from laura heavily commented trace-file. In the handshake process, you can establish that there exists an issue of link latency ( see the round trip time values).</p><p>See frame 5 in home.pcapng you would see the client waited 155 ms or more for a response to come from server. Now here is the catch, considering if the wireshark was present on the server side,the delayed would never be seen in terms of response (server) right? the delayed in that case would be ACKs coming from the client side. Finding delta time between server last send data to client and response ACK from the client.</p><p>A SYN/ACK packet for a wireshark installed on server wouldn't ever have to wait for 167 ms considering there is pre-exisining path latency issues.</p><p>This is how and why I say that wireshark is on the client side not on server side. Please add anything to this analysis ,i'm open to your views/suggestions.</p></div><div id="comment-43139-info" class="comment-info"><span class="comment-age">(14 Jun '15, 06:08)</span> lazerz</div></div><span id="43143"></span><div id="comment-43143" class="comment not_top_scorer"><div id="post-43143-score" class="comment-score"></div><div class="comment-text"><p>Sometimes you do see delays on the server side, as it may be processing the request, but in the case of frame 5\6 the ACK in 6 will be handled by the TCP stack on the server so no processing delay is likely to be involved.</p><p>To remove server processing (or client for that matter) concentrating on things such as the 3 way handshake which only involves the TCP stacks gives a clear indication of RTT.</p></div><div id="comment-43143-info" class="comment-info"><span class="comment-age">(14 Jun '15, 09:08)</span> grahamb ♦</div></div></div><div id="comment-tools-43101" class="comment-tools"><span class="comments-showing"> showing 5 of 8 </span> <a href="#" class="show-all-comments-link">show 3 more comments</a></div><div class="clear"></div><div id="comment-43101-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="43170"></span>

<div id="answer-container-43170" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-43170-score" class="post-score" title="current number of votes">1</div></div></td><td><div class="item-right"><div class="answer-body"><p>Hi, just a quick Info from what I understood when doing this: The question was where was wireshark in regard to packet loss, the answer lies in the sequence analysis of a retransmission and is not really as complicated as it seems.</p><ol><li>Find a retransmission and click it</li><li>In the packet Details pane right click on Sequence number and apply filter</li></ol><p>If you see the original + retransmissions you are upstream, if only retransmissions, you are downstream. This was also not very clear for me until I got the Chappell University pass where this is then explained in full. (Core 2 Part 7 TCP Loss and retransmissions) It's expensive, but well worth the money.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>15 Jun '15, 03:56</strong></p><img src="https://secure.gravatar.com/avatar/05ba95262a3352e3af4ba69c0ec0dff2?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="DarrenWright&#39;s gravatar image" /><p>DarrenWright<br />
<span class="score" title="216 reputation points">216</span><span title="14 badges"><span class="badge1">●</span><span class="badgecount">14</span></span><span title="15 badges"><span class="silver">●</span><span class="badgecount">15</span></span><span title="20 badges"><span class="bronze">●</span><span class="badgecount">20</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="DarrenWright has 5 accepted answers">26%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 15 Jun '15, 04:02</p></div></div><div id="comments-container-43170" class="comments-container"></div><div id="comment-tools-43170" class="comment-tools"></div><div class="clear"></div><div id="comment-43170-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="43141"></span>

<div id="answer-container-43141" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-43141-score" class="post-score" title="current number of votes">0</div></div></td><td><div class="item-right"><div class="answer-body"><p><strong>"Is Wireshark downstream (closer to the client receiving the data) or upstream (closer to the TCP host that is sending data) from packet loss?"</strong><br />
To determine the proximity to either the client or the server you need to inspect the 3-way handshake packets and look at the RTTs "towards the server" vs. "towards the client".<br />
In addition, as grahamb indicated, there are fields in the ip header that change as they travel through the network and can give you a clue where the trace was taken - if you can guess their initial value at the origin ;-)<br />
<img src="https://osqa-ask.wireshark.org/upfiles/Screenshot-245.png" alt="alt text" /></p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>14 Jun '15, 08:44</strong></p><img src="https://secure.gravatar.com/avatar/5500bd1decb766660522dfb347eedc49?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="mrEEde&#39;s gravatar image" /><p>mrEEde<br />
<span class="score" title="3892 reputation points"><span>3.9k</span></span><span title="15 badges"><span class="badge1">●</span><span class="badgecount">15</span></span><span title="22 badges"><span class="silver">●</span><span class="badgecount">22</span></span><span title="70 badges"><span class="bronze">●</span><span class="badgecount">70</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="mrEEde has 48 accepted answers">20%</span> </br></br></p></img></div><div class="post-update-info post-update-info-edited"><p>edited 14 Jun '15, 08:47</p></div></div><div id="comments-container-43141" class="comments-container"><span id="43142"></span><div id="comment-43142" class="comment"><div id="post-43142-score" class="comment-score"></div><div class="comment-text"><p>In the case illustrated, the original SYN TTL is 64 which is one of the cardinal values, and the SYN, ACK is 55 confirming that it was most likely taken on the originator of the SYN, in this case the client.</p></div><div id="comment-43142-info" class="comment-info"><span class="comment-age">(14 Jun '15, 09:01)</span> grahamb ♦</div></div><span id="44585"></span><div id="comment-44585" class="comment"><div id="post-44585-score" class="comment-score"></div><div class="comment-text"><p>Hi Graham, cool. Learning is fun ;) I never really bothered to think about using the TTL for this.. Filed under "good to know"</p><p>A quick question that may require a separate thread.. is the RTT time from NIC out to NIC in or does it include the time spent Buffered / going up the stack as well?</p></div><div id="comment-44585-info" class="comment-info"><span class="comment-age">(29 Jul '15, 03:13)</span> DarrenWright</div></div><span id="44588"></span><div id="comment-44588" class="comment"><div id="post-44588-score" class="comment-score"></div><div class="comment-text"><p>RTT is calculated using the packet timestamps. The accuracy of the packet timestamps depends on your capture mechanism, so it outwith Wireshark.</p></div><div id="comment-44588-info" class="comment-info"><span class="comment-age">(29 Jul '15, 04:31)</span> grahamb ♦</div></div></div><div id="comment-tools-43141" class="comment-tools"></div><div class="clear"></div><div id="comment-43141-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

