+++
type = "question"
title = "Wireless traffic to/from another device is not getting captured"
description = '''Hi, I&#x27;m trying to use Wireshark on a Win8 laptop to capture the wifi traffic of an MSP430/CC3100 iot device on my network, The IP/MAC of the device, as reported via the serial port, matches the IP assigned to that MAC in the router&#x27;s DHCP table. However, I while I see a bunch of Wireshark traffic, I...'''
date = "2015-12-13T20:32:00Z"
lastmod = "2015-12-14T01:08:00Z"
weight = 48500
keywords = [ "filter", "ip", "wireless" ]
aliases = [ "/questions/48500" ]
osqa_answers = 0
osqa_accepted = true
+++

<div class="headNormal">

# [Wireless traffic to/from another device is not getting captured](/questions/48500/wireless-traffic-tofrom-another-device-is-not-getting-captured)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-48500-score" class="post-score" title="current number of votes">0</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hi,</p><p>I'm trying to use Wireshark on a Win8 laptop to capture the wifi traffic of an MSP430/CC3100 iot device on my network,</p><p>The IP/MAC of the device, as reported via the serial port, matches the IP assigned to that MAC in the router's DHCP table.</p><p>However, I while I see a bunch of Wireshark traffic, I don't see ANY traffic to/from that IP, despite the iot device working and application communicating to the net fine. Since there's lots of other IP traffic, I thought maybe I'm just missing it, so tried filtering to only that IP but it also shows no traffic.</p><p>The laptop and the iot device, both connect to the internet via the same wireless router, so not sure why it wouldn't see that traffic?</p><p><a href="http://i.imgur.com/eFrvn89.jpg">http://i.imgur.com/eFrvn89.jpg</a></p></div><div id="question-tags" class="tags-container tags">filter ip wireless</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>13 Dec '15, 20:32</strong></p><img src="https://secure.gravatar.com/avatar/ed4e218a4f08a17c9ba1bf2c2fd6e214?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="benn%20n&#39;s gravatar image" /><p>benn n<br />
<span class="score" title="6 reputation points">6</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="benn n has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 16 Dec '15, 03:58</p><img src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="grahamb&#39;s gravatar image" /><p>grahamb ♦<br />
<span class="score" title="19834 reputation points"><span>19.8k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">●</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">●</span><span class="badgecount">206</span></span></p></div></div><div id="comments-container-48500" class="comments-container"></div><div id="comment-tools-48500" class="comment-tools"></div><div class="clear"></div><div id="comment-48500-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="48502"></span>

<div id="answer-container-48502" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-48502-score" class="post-score" title="current number of votes">1</div></div></td><td><div class="item-right"><div class="answer-body"><p>It is a common misconception that promiscuous mode on a wireless interface is enough to capture traffic between any two pieces of equipment the WLAN to which the capturing device is connected. Unfortunately, this is not the case, and you would have to use monitoring mode which is not supported on Windows (because WinPcap doesn't support it, see details <a href="https://wiki.wireshark.org/CaptureSetup/WLAN">here</a>).</p><p>So if you need to capture the network communication of Your Device, your options are to use another OS on your laptop for the purpose, or use a dedicated device to capture, or run tcpdump on the WiFi router through which Your Device talks to the 'net. A WiFi router which can be flashed with an open software like e.g. <a href="http://openwrt.org/">OpenWrt</a> may be easier to obtain than an <a href="http://www.riverbed.com/products/steelcentral/steelcentral-riverbed-airpcap.html">AirPcap dedicated device</a> and still sufficient for your purpose.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>14 Dec '15, 01:08</strong></p><img src="https://secure.gravatar.com/avatar/00fc6e2633725bd871ff636f0175eabc?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="sindy&#39;s gravatar image" /><p>sindy<br />
<span class="score" title="6049 reputation points"><span>6.0k</span></span><span title="4 badges"><span class="badge1">●</span><span class="badgecount">4</span></span><span title="8 badges"><span class="silver">●</span><span class="badgecount">8</span></span><span title="51 badges"><span class="bronze">●</span><span class="badgecount">51</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="sindy has 110 accepted answers">24%</span></p></div></div><div id="comments-container-48502" class="comments-container"><span id="48508"></span><div id="comment-48508" class="comment"><div id="post-48508-score" class="comment-score"></div><div class="comment-text"><p>Thanks for clarifying, I was definately misconceived! So I've got an old laptop (wifi Ralink RT3290) that I could repurpose with a live (ubuntu?) linux distro.. but is there a usb-wifi adapter you'd recommend that should work out of the box for this application? Something based on the Realtek RTL8188cus?</p></div><div id="comment-48508-info" class="comment-info"><span class="comment-age">(14 Dec '15, 09:21)</span> benn n</div></div><span id="48510"></span><div id="comment-48510" class="comment"><div id="post-48510-score" class="comment-score"></div><div class="comment-text"><p>If you actually don't need the monitor mode, i.e. if what you really need is just to capture the communication of Your Device, it should be enough to make the old laptop an access point for Your Device (using a different SSID and channel from the main WiFi, and setting the Ethernet port as uplink to the 'net), so you wouldn't have to buy another WiFi in hope it will support monitor mode better than the onboard one.</p><p>If the WiFi is your only connection to the 'net or if you strongly prefer to run Wireshark on the Windows laptop, you may provide the cable connection for the Ubuntu laptop by setting up "internet connection sharing" on the Win8 laptop - with the WiFi as the "shared connection" and the Ethernet as the interface through which it is shared. This effectively means that Windows set up 192.168.138.1/24 on the Ethernet and run as DHCP server, and apply NAT on the traffic coming from the Ethernet and forwarded out through WiFi. You would then capture on the Win 8's Ethernet port, saving yourself the burden of decrypting wireless communication.</p><p>If you choose this way, you may most likely set up a bridge (instead of routing) between Ethernet and Wifi on the Ubuntu laptop.</p></div><div id="comment-48510-info" class="comment-info"><span class="comment-age">(14 Dec '15, 11:50)</span> sindy</div></div><span id="48514"></span><div id="comment-48514" class="comment"><div id="post-48514-score" class="comment-score"></div><div class="comment-text"><p>...an afterthought, if you use the old laptop the way I've suggested, you may even keep Windows on it.</p></div><div id="comment-48514-info" class="comment-info"><span class="comment-age">(15 Dec '15, 01:48)</span> sindy</div></div><span id="48542"></span><div id="comment-48542" class="comment"><div id="post-48542-score" class="comment-score"></div><div class="comment-text"><p>Thanks, I hadn't thought of that but using the Win8 machine as a proxy to the iot device seems like a better way to get around my wireshark/network issue. Haven't tried either yet, but Connectify's Hotspot or Codeplex's Virtual-Router/Plus might have this functionality built-in.. i.e. win8 software that creates a wifi hotspot, and bridges it to another wifi network.</p></div><div id="comment-48542-info" class="comment-info"><span class="comment-age">(15 Dec '15, 11:46)</span> benn n</div></div><span id="48543"></span><div id="comment-48543" class="comment"><div id="post-48543-score" class="comment-score"></div><div class="comment-text"><p>Might be, just bear in mind the following:</p><ul><li><p>if the software really "bridges" (i.e. works as a WDS repeater on a single SSID), the transit of the WiFi traffic may happen completely "inside the driver", so the transit traffic may again be unavailable on the Win8's network interface for capture,</p></li><li><p>not every WiFi card supports mixed mode (client for one SSID and AP for another),</p></li><li><p>if your one does, so you can run more than one SSID on it, thus creating more than one network interface at OS level (one per SSID) and bridging or routing between them as between any other Ethernet-like network interfaces, you still have to use the same frequency channel for all of them, which implies that they share the common bandwidth. This may be a problem if the "donor" WiFi is already close to congestion.</p></li></ul><p>So a piece of good'ol' cable between two machines, where one would be a clean client on one SSID &amp; channel and the other one a clean AP on another SSID &amp; channel, is a better option in my opinion.</p></div><div id="comment-48543-info" class="comment-info"><span class="comment-age">(15 Dec '15, 12:24)</span> sindy</div></div><span id="48637"></span><div id="comment-48637" class="comment not_top_scorer"><div id="post-48637-score" class="comment-score"></div><div class="comment-text"><p>Haven't had much luck getting it to work.. I've got the the iot connected to the laptop's wifi nic, and the laptop connected via wire to the router. I've tried Connectify Hotspot, Virtual Router/Plus, mhotspot, and mypublicwifi, yet in all cases, the iot is connecting to the internet, meaning the hotspot works, yet Wireshark doesn't see that wifi traffic. I'm guessing that's because the briding is done in the software/driver like you warned. How would you recommend to create a non-software driver based wifi proxy?</p></div><div id="comment-48637-info" class="comment-info"><span class="comment-age">(18 Dec '15, 22:11)</span> benn n</div></div><span id="48638"></span><div id="comment-48638" class="comment not_top_scorer"><div id="post-48638-score" class="comment-score"></div><div class="comment-text"><p>That sounds strange to me. My remark about bridging inside the driver was related and only relevant to a case where you would bridge between two WLANs on a single WiFi interface. When we talk about two distinct physical interfaces (one WiFi and one wired Ethernet, or even two distinct WiFi cards), the bridging or routing is almost certainly done by the operating system, so Wireshark should be able to access the packets.</p><p>I admit that I haven't checked whether it was possible to use AP mode of a WiFi card in plain Win7 before answering (apparently it is not, I remembered from WinXP that it could be done and have never needed it since starting to use Win7), but it seems there is a bunch of 3pty applications substituting that missing Win7 functionality. But I don't think these would control the wired interface directly, bypassing the driver.</p><p>So although there may be some peculiarities in capturing at the WiFi interface, capturing on the wired interface should be possible and enough for the purpose. However, it depends on whether the 3pty software activates bridging or routing between the WiFi and the wired Ethernet interface. Bridging would mean that you would be able to use the iot's MAC and/or IP address as capture filter at the wired Ethernet; routing would most likely come along with NAT so neither the MAC nor the IP of the iot would be visible there, as they would be translated to the wired Ethernet interface's own ones, and you would have to use different criteria (remote IPs or ports if you know them) to tell the iot's traffic from the laptop's own one.</p><p>Another speculation - couldn't it simply be that something went wrong and the iot continued to use the SSID of the original router, instead of the one of the laptop?</p></div><div id="comment-48638-info" class="comment-info"><span class="comment-age">(19 Dec '15, 05:55)</span> sindy</div></div></div><div id="comment-tools-48502" class="comment-tools"><span class="comments-showing"> showing 5 of 7 </span> <a href="#" class="show-all-comments-link">show 2 more comments</a></div><div class="clear"></div><div id="comment-48502-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

