+++
type = "question"
title = "Error in tshark command using -T fields"
description = '''I would like to save it, but there is an error in this command, do you have any idea about it? tshark -r /root/Desktop/a.pcap -T fields -e frame.number -e _ws.col.Info |grep &quot;sogou&quot; -E header=y -E separator=, &amp;gt;/root/Desktop/veri.csv '''
date = "2017-08-01T06:23:00Z"
lastmod = "2017-08-03T07:12:00Z"
weight = 63289
keywords = [ "fields", "grep", "tshark" ]
aliases = [ "/questions/63289" ]
osqa_answers = 1
osqa_accepted = true
+++

<div class="headNormal">

# [Error in tshark command using -T fields](/questions/63289/error-in-tshark-command-using-t-fields)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-63289-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-63289-score" class="post-score" title="current number of votes">0</div><span id="post-63289-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I would like to save it, but there is an error in this command, do you have any idea about it?</p><pre><code>tshark -r /root/Desktop/a.pcap -T fields -e frame.number -e _ws.col.Info |grep &quot;sogou&quot; -E header=y -E separator=, &gt;/root/Desktop/veri.csv</code></pre></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-fields" rel="tag" title="see questions tagged &#39;fields&#39;">fields</span> <span class="post-tag tag-link-grep" rel="tag" title="see questions tagged &#39;grep&#39;">grep</span> <span class="post-tag tag-link-tshark" rel="tag" title="see questions tagged &#39;tshark&#39;">tshark</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>01 Aug '17, 06:23</strong></p><img src="https://secure.gravatar.com/avatar/27656fc332042371be221c4f54880666?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="alfrego129&#39;s gravatar image" /><p><span>alfrego129</span><br />
<span class="score" title="10 reputation points">10</span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="3 badges"><span class="silver">●</span><span class="badgecount">3</span></span><span title="6 badges"><span class="bronze">●</span><span class="badgecount">6</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="alfrego129 has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>01 Aug '17, 06:33</strong> </span></p><img src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="grahamb&#39;s gravatar image" /><p><span>grahamb ♦</span><br />
<span class="score" title="19834 reputation points"><span>19.8k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">●</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">●</span><span class="badgecount">206</span></span></p></div></div><div id="comments-container-63289" class="comments-container"></div><div id="comment-tools-63289" class="comment-tools"></div><div class="clear"></div><div id="comment-63289-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="63290"></span>

<div id="answer-container-63290" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-63290-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-63290-score" class="post-score" title="current number of votes">1</div><span id="post-63290-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span class="accept-answer on" rel="nofollow" title="cmaynard has selected this answer as the correct answer"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>You are mixing tshark arguments and another command "grep". You can't do that, you should read up some more on using pipelines to join commands together. Move the grep to the end:</p><pre><code>tshark -r /root/Desktop/a.pcap -T fields -e frame.number -e _ws.col.Info -E header=y -E separator=, | grep &quot;sogou&quot; &gt;/root/Desktop/veri.csv</code></pre></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>01 Aug '17, 06:29</strong></p><img src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="grahamb&#39;s gravatar image" /><p><span>grahamb ♦</span><br />
<span class="score" title="19834 reputation points"><span>19.8k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">●</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">●</span><span class="badgecount">206</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="grahamb has 274 accepted answers">22%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>01 Aug '17, 06:29</strong> </span></p></div></div><div id="comments-container-63290" class="comments-container"><span id="63291"></span><div id="comment-63291" class="comment not_top_scorer"><div id="post-63291-score" class="comment-score"></div><div class="comment-text"><p>It also looks like you are running tshark as root. <strong>Don't do that</strong></p></div><div id="comment-63291-info" class="comment-info"><span class="comment-age">(01 Aug '17, 06:30)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="63292"></span><div id="comment-63292" class="comment not_top_scorer"><div id="post-63292-score" class="comment-score"></div><div class="comment-text"><p>Finally, please don't "spam" any other question that might possibly using -T fields with your specific question, that will only get you banned, instead raise a new question for your specific question.</p></div><div id="comment-63292-info" class="comment-info"><span class="comment-age">(01 Aug '17, 06:32)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="63294"></span><div id="comment-63294" class="comment not_top_scorer"><div id="post-63294-score" class="comment-score"></div><div class="comment-text"><p>Okey, sorry. "It also looks like you are running tshark as root. Don't do that" why it not proper? Thank you.</p></div><div id="comment-63294-info" class="comment-info"><span class="comment-age">(01 Aug '17, 07:12)</span> <span class="comment-user userinfo">alfrego129</span></div></div><span id="63295"></span><div id="comment-63295" class="comment"><div id="post-63295-score" class="comment-score">1</div><div class="comment-text"><p>See the wiki item on security <a href="https://wiki.wireshark.org/Security#Administrator.2Froot_account_not_required.21">here</a>.</p><p>Basically doing so exposes your system to running lots of code fed by external (possibly malicious) network traffic, all with root privileges and is totally unnecessary.</p></div><div id="comment-63295-info" class="comment-info"><span class="comment-age">(01 Aug '17, 07:32)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="63298"></span><div id="comment-63298" class="comment not_top_scorer"><div id="post-63298-score" class="comment-score"></div><div class="comment-text"><p>I used wmware, therefore, feel relax always. Thank you very much, for safe mode, do you recommend any way?</p></div><div id="comment-63298-info" class="comment-info"><span class="comment-age">(01 Aug '17, 07:50)</span> <span class="comment-user userinfo">alfrego129</span></div></div><span id="63299"></span><div id="comment-63299" class="comment not_top_scorer"><div id="post-63299-score" class="comment-score"></div><div class="comment-text"><p>What's the OS you're using?</p></div><div id="comment-63299-info" class="comment-info"><span class="comment-age">(01 Aug '17, 08:10)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="63300"></span><div id="comment-63300" class="comment not_top_scorer"><div id="post-63300-score" class="comment-score"></div><div class="comment-text"><p>Kali Linux</p></div><div id="comment-63300-info" class="comment-info"><span class="comment-age">(01 Aug '17, 08:36)</span> <span class="comment-user userinfo">alfrego129</span></div></div><span id="63302"></span><div id="comment-63302" class="comment not_top_scorer"><div id="post-63302-score" class="comment-score"></div><div class="comment-text"><p>What was the initial goal of having grep in the middle of the parameters? Did you intend to filter by contents of <code>_ws.col.Info</code>?</p></div><div id="comment-63302-info" class="comment-info"><span class="comment-age">(01 Aug '17, 08:42)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="63303"></span><div id="comment-63303" class="comment not_top_scorer"><div id="post-63303-score" class="comment-score"></div><div class="comment-text"><p>For Kali, try this (untested by me): <a href="https://sathisharthars.com/2014/06/04/running-wireshark-with-non-root-user-in-kali-linux/">https://sathisharthars.com/2014/06/04/running-wireshark-with-non-root-user-in-kali-linux/</a></p></div><div id="comment-63303-info" class="comment-info"><span class="comment-age">(01 Aug '17, 08:53)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="63307"></span><div id="comment-63307" class="comment not_top_scorer"><div id="post-63307-score" class="comment-score"></div><div class="comment-text"><p><a href="https://ask.wireshark.org/users/19586/sindy">@sindy</a>, I was trying to extract proper packets for DoS attack then I will implement them on Weka. <a href="https://ask.wireshark.org/users/1225/grahamb">@grahamb</a> thank you, it is definitely really useful.</p></div><div id="comment-63307-info" class="comment-info"><span class="comment-age">(01 Aug '17, 10:51)</span> <span class="comment-user userinfo">alfrego129</span></div></div><span id="63312"></span><div id="comment-63312" class="comment not_top_scorer"><div id="post-63312-score" class="comment-score"></div><div class="comment-text"><p>I was wondering whether the "sogou" string is only available in the <code>_ws.col.Info</code> or whether you can use <code>-Y "frame contains sogou"</code> to fulfil the same goal.</p></div><div id="comment-63312-info" class="comment-info"><span class="comment-age">(01 Aug '17, 11:55)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="63313"></span><div id="comment-63313" class="comment not_top_scorer"><div id="post-63313-score" class="comment-score"></div><div class="comment-text"><p><a href="https://ask.wireshark.org/users/19586/sindy">@sindy</a> really it works excellent if I want to add features such as ip.dst -e tcp.dstport -e ip.proto -e tcp.flags.syn -e ip.flags how can I implement them on "tshark -r /root/Desktop/a.pcap -T fields -e frame.number -Y "frame contains sogou" &gt;/root/Desktop/veri.csv" ?</p></div><div id="comment-63313-info" class="comment-info"><span class="comment-age">(01 Aug '17, 12:52)</span> <span class="comment-user userinfo">alfrego129</span></div></div><span id="63314"></span><div id="comment-63314" class="comment not_top_scorer"><div id="post-63314-score" class="comment-score"></div><div class="comment-text"><p>I wonder what is the tshark man page lacking that complicates you the understanding of the concept. <code>tshark</code> takes a list of command line parameters which have names and in most cases values. So <code>-Y "frame contains sogou"</code> is one parameter whose name is <code>Y</code> and whose value is <code>"frame contains sogou"</code>; the quotation marks are there to indicate that the whole string including the spaces is the value of that single parameter.</p><p>Now some of the parameters make sense only once (<code>-T</code>, <code>-Y</code>, <code>-r</code>, <code>-w</code>) while others may be repeated as many times as needed if multiple values of that parameter make sense, like <code>-e</code> whose value is a name of protocol field to show in the output and <strong>only makes sense if value of</strong> <code>-T</code> <strong>is</strong> <code>fields</code>, or like <code>-i</code> which indicates from which interface to capture as you can capture from several interfaces simultaneously.</p><p>So in particular, you can add <code>-e ip.dst -e tcp.dstport -e ip.proto -e tcp.flags.syn -e ip.flags</code> right after <code>-e frame.number</code> and you should get these fields in the output.</p><p>Also important, there is no mandatory relationship between the field names used in display filter and field names listed using <code>-e</code> to be printed in the output - you can display-filter by some group of protocol fields and actually print a completely different group of protocol fields.</p></div><div id="comment-63314-info" class="comment-info"><span class="comment-age">(01 Aug '17, 13:15)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="63346"></span><div id="comment-63346" class="comment not_top_scorer"><div id="post-63346-score" class="comment-score"></div><div class="comment-text"><p>Yes, I have read man page. Thank you very much for all information, definitely, they were too useful.</p></div><div id="comment-63346-info" class="comment-info"><span class="comment-age">(02 Aug '17, 10:22)</span> <span class="comment-user userinfo">alfrego129</span></div></div><span id="63350"></span><div id="comment-63350" class="comment not_top_scorer"><div id="post-63350-score" class="comment-score"></div><div class="comment-text"><p><a href="https://ask.wireshark.org/users/1225/grahamb">@grahamb</a> I would like to ask a question, however, due to your spam warning, I cannot ask, I did not know the rule of the forum and have been learning them. Thank you.</p></div><div id="comment-63350-info" class="comment-info"><span class="comment-age">(02 Aug '17, 11:37)</span> <span class="comment-user userinfo">alfrego129</span></div></div><span id="63351"></span><div id="comment-63351" class="comment"><div id="post-63351-score" class="comment-score">1</div><div class="comment-text"><p>You have misunderstood <a href="https://ask.wireshark.org/users/1225/grahamb">@grahamb</a>. There is nothing bad on asking a new Question - provided that you don't ask the same thing you've already asked before, only in different words. What he had in mind was that you have placed a comment to an already answered, loosely related question, instead of asking a separate Question pinpointed to your particular issue.</p></div><div id="comment-63351-info" class="comment-info"><span class="comment-age">(02 Aug '17, 12:26)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="63353"></span><div id="comment-63353" class="comment not_top_scorer"><div id="post-63353-score" class="comment-score"></div><div class="comment-text"><p>Okey, but I have tried to ask a question today and saw it;</p><p>"Akismet believes your question is spam. We're sorry, but Akismet believes your question is spam. If you believe this is an error, please contact the forum administrator. "</p><p>How can I fix this situation?</p></div><div id="comment-63353-info" class="comment-info"><span class="comment-age">(02 Aug '17, 12:56)</span> <span class="comment-user userinfo">alfrego129</span></div></div><span id="63354"></span><div id="comment-63354" class="comment"><div id="post-63354-score" class="comment-score">1</div><div class="comment-text"><p>This is a known problem, already reported as <a href="https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=13714">Bug 13714</a>. So far, there is no solution, partly because I don't think the cause is clear.</p><p>You could try re-wording your question or leaving out most text when creating it then try editing it afterward.</p><p>In your case, I wonder if it's possible that because you awarded all of your reputation points to <a href="https://ask.wireshark.org/users/1225/grahamb">@grahamb</a> that it's causing a problem for users with 0 reputation?</p></div><div id="comment-63354-info" class="comment-info"><span class="comment-age">(02 Aug '17, 13:14)</span> <span class="comment-user userinfo">cmaynard ♦♦</span></div></div><span id="63355"></span><div id="comment-63355" class="comment"><div id="post-63355-score" class="comment-score">1</div><div class="comment-text"><p>You can easily check whether <a href="https://ask.wireshark.org/users/402/cmaynard">@cmaynard</a> is right regarding the 0 reputation as a cause. If you consider <a href="https://ask.wireshark.org/users/1225/grahamb"></a><a href="https://ask.wireshark.org/users/1225/grahamb">@grahamb</a>'s Answer to which this Comment belongs a correct one to your Question (I do but the decision is yours), click the checkmark icon next to it. Doing so awards some reputation points not only to <a href="https://ask.wireshark.org/users/1225/grahamb"></a><a href="https://ask.wireshark.org/users/1225/grahamb">@grahamb</a> but also to you. And then you can try to ask a new Question again.</p></div><div id="comment-63355-info" class="comment-info"><span class="comment-age">(02 Aug '17, 13:24)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="63356"></span><div id="comment-63356" class="comment"><div id="post-63356-score" class="comment-score">1</div><div class="comment-text"><p><a href="https://ask.wireshark.org/users/40982/alfrego129">@alfrego129</a>,</p><p>By devious means I have returned the 10 points you awarded me, try posting your question now. Also take note of <a href="https://ask.wireshark.org/users/19586/sindy">@sindy</a>'s comment on accepting my answer.</p></div><div id="comment-63356-info" class="comment-info"><span class="comment-age">(02 Aug '17, 13:55)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="63366"></span><div id="comment-63366" class="comment not_top_scorer"><div id="post-63366-score" class="comment-score"></div><div class="comment-text"><p>Thank you <a href="https://ask.wireshark.org/users/1225/grahamb">@grahamb</a></p></div><div id="comment-63366-info" class="comment-info"><span class="comment-age">(03 Aug '17, 02:57)</span> <span class="comment-user userinfo">alfrego129</span></div></div><span id="63379"></span><div id="comment-63379" class="comment not_top_scorer"><div id="post-63379-score" class="comment-score"></div><div class="comment-text"><p><a href="https://ask.wireshark.org/users/40982/alfrego129">@alfrego129</a>, I've removed your last few comments as they really were related to your other question and had no place here.</p></div><div id="comment-63379-info" class="comment-info"><span class="comment-age">(03 Aug '17, 05:45)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="63386"></span><div id="comment-63386" class="comment not_top_scorer"><div id="post-63386-score" class="comment-score"></div><div class="comment-text"><p><a href="https://ask.wireshark.org/users/40982/alfrego129">@alfrego129</a>, if an answer has solved your issue, please accept the answer for the benefit of other users by clicking the checkmark icon next to the answer. Please read the FAQ for more information.</p></div><div id="comment-63386-info" class="comment-info"><span class="comment-age">(03 Aug '17, 07:12)</span> <span class="comment-user userinfo">cmaynard ♦♦</span></div></div></div><div id="comment-tools-63290" class="comment-tools"><span class="comments-showing"> showing 5 of 23 </span> <a href="#" class="show-all-comments-link">show 18 more comments</a></div><div class="clear"></div><div id="comment-63290-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

