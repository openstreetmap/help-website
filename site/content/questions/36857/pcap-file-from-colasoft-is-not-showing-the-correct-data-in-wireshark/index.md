+++
type = "question"
title = "pcap file from Colasoft is not showing the correct data in Wireshark"
description = '''Hi, I use Colasoft to analyze Packets on my router. When I open .cap (generated by colasoft) in Wireshark, the info says Ethernet II. But In colasoft, when I run it on my System IP, the data shows fine in Wireshark..... Here is the link for .cap file. https://drive.google.com/file/d/0B2MDYkJV41GMcnh...'''
date = "2014-10-05T14:31:00Z"
lastmod = "2014-10-06T21:13:00Z"
weight = 36857
keywords = [ "colasoft" ]
aliases = [ "/questions/36857" ]
osqa_answers = 1
osqa_accepted = true
+++

<div class="headNormal">

# [pcap file from Colasoft is not showing the correct data in Wireshark](/questions/36857/pcap-file-from-colasoft-is-not-showing-the-correct-data-in-wireshark)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-36857-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-36857-score" class="post-score" title="current number of votes">0</div><span id="post-36857-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hi, I use Colasoft to analyze Packets on my router. When I open .cap (generated by colasoft) in Wireshark, the info says Ethernet II. But In colasoft, when I run it on my System IP, the data shows fine in Wireshark.....</p><p>Here is the link for .cap file. <a href="https://drive.google.com/file/d/0B2MDYkJV41GMcnh4OTAyVUFZUXM/view?usp=sharing">https://drive.google.com/file/d/0B2MDYkJV41GMcnh4OTAyVUFZUXM/view?usp=sharing</a> Please help me with this one</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-colasoft" rel="tag" title="see questions tagged &#39;colasoft&#39;">colasoft</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>05 Oct '14, 14:31</strong></p><img src="https://secure.gravatar.com/avatar/20b31d6cf505821f019b0e0966f36323?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Points&#39;s gravatar image" /><p><span>Points</span><br />
<span class="score" title="6 reputation points">6</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Points has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>05 Oct '14, 15:02</strong> </span></p><img src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Guy%20Harris&#39;s gravatar image" /><p><span>Guy Harris ♦♦</span><br />
<span class="score" title="17443 reputation points"><span>17.4k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">●</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">●</span><span class="badgecount">196</span></span></p></div></div><div id="comments-container-36857" class="comments-container"></div><div id="comment-tools-36857" class="comment-tools"></div><div class="clear"></div><div id="comment-36857-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="36858"></span>

<div id="answer-container-36858" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-36858-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-36858-score" class="post-score" title="current number of votes">1</div><span id="post-36858-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span class="accept-answer on" rel="nofollow" title="Points has selected this answer as the correct answer"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>Those aren't Ethernet packets, they're 802.11 packets, but whatever Colasoft program wrote them (Capsa? nGenius?) put a link-layer header type of LINKTYPE_ETHERNET into the file header.</p><p>I.e., whatever Colasoft program wrote that file is buggy. Report the bug to Colasoft and tell them that if they're writing 802.11 packets to a pcap file, they must set the link-layer header type in the pcap file header to 105, which is LINKTYPE_IEEE802_11, not to 1, which is LINKTYPE_ETHERNET. The lists of link-layer header types for pcap and pcap-ng files is at <a href="http://www.tcpdump.org/linktypes.html;">http://www.tcpdump.org/linktypes.html;</a> please point them to that page.</p><p>As a workaround, you can use the editcap program, which is a command-line program that comes with Wireshark. Run the command</p><pre><code>editcap -F pcap -T ieee-802-11 kl.cap kl.pcap</code></pre><p>(you may have to give the full path to <code>kl.cap</code> if you don't run that command in the directory containing the kl.cap file). It will write out a file <code>kl.pcap</code>, which has the same packets but has a link-layer header type of LINKTYPE_IEEE802_11, so that programs reading the file know that it has 802.11 packets rather than being falsely told that it has Ethernet packets.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>05 Oct '14, 14:51</strong></p><img src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Guy%20Harris&#39;s gravatar image" /><p><span>Guy Harris ♦♦</span><br />
<span class="score" title="17443 reputation points"><span>17.4k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">●</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">●</span><span class="badgecount">196</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Guy Harris has 216 accepted answers">19%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>05 Oct '14, 15:01</strong> </span></p></div></div><div id="comments-container-36858" class="comments-container"><span id="36859"></span><div id="comment-36859" class="comment"><div id="post-36859-score" class="comment-score"></div><div class="comment-text"><p>Thank you. That Worked perfectly. You are a genius. I have one more question, Is there any possibility where I can analyze the packets on the router instead of using Colasoft ?. (I have been able to analyze packets on my local machine not the router. so, i decided to go for Colosoft).</p></div><div id="comment-36859-info" class="comment-info"><span class="comment-age">(05 Oct '14, 15:38)</span> <span class="comment-user userinfo">Points</span></div></div><span id="36861"></span><div id="comment-36861" class="comment"><div id="post-36861-score" class="comment-score"></div><div class="comment-text"><blockquote><p>Is there any possibility where I can analyze the packets on the router instead of using Colasoft ?</p></blockquote><p>I.e., run a program <em>on the router</em> to analyze the packets? Or run a program on the router to capture the packets and then move the capture to another machine to read it?</p></div><div id="comment-36861-info" class="comment-info"><span class="comment-age">(05 Oct '14, 16:03)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="36862"></span><div id="comment-36862" class="comment"><div id="post-36862-score" class="comment-score"></div><div class="comment-text"><p>No, I meant how to capture packets on the router instead of capturing on the local machine?( Run a program on PC to capture packets on the router) wiki.wireshark.org says this can be possible by enabling Adapter into Promiscuous mode. but i dont understand how to set my adapter to Promiscuous mode. please help</p></div><div id="comment-36862-info" class="comment-info"><span class="comment-age">(05 Oct '14, 16:05)</span> <span class="comment-user userinfo">Points</span></div></div><span id="36868"></span><div id="comment-36868" class="comment"><div id="post-36868-score" class="comment-score"></div><div class="comment-text"><blockquote><p>I meant how to capture packets on the router instead of capturing on the local machine?</p></blockquote><p>What type of router do you have? The answer would depend on that (and the answer might, for at least some routers, be "that's not possible").</p><blockquote><p>Run a program on PC to capture packets on the router</p></blockquote><p>Ultimately, some program on the <em>router</em> will have to capture the packets; perhaps a program on the PC can send a network message to the software on the router to tell it to capture packets, but as the interface on which you're capturing is on the router, the software will have to run on the router.</p><blockquote><p>wiki.wireshark.org says this can be possible by enabling Adapter into Promiscuous mode</p></blockquote><p>I doubt it says that. If you are on a non-switched Ethernet, or have plugged your machine into a "mirrored port" on a switched Ethernet, you can, in a program <em>running on your machine</em>, capture traffic going to and coming from another host on your Ethernet, by putting your the Ethernet interface on your machine into promiscuous mode, and if you are on a Wi-Fi network, you can, in a program <em>running on your machine</em>, capture traffic going to and coming from another host on your Wi-Fi network, by putting the Wi-Fi interface on your machin einto monitor mode - Wireshark (and TShark and tcpdump) will put the adapter into promiscuous mode by default, and can be told to put - but that's not doing the capture on that other machine itself. Colasoft's programs will probably do the same thing that Wireshark/TShark/tcpdump/etc. do, by putting the adapter into promiscuous or monitor mode.</p></div><div id="comment-36868-info" class="comment-info"><span class="comment-age">(05 Oct '14, 23:18)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="36873"></span><div id="comment-36873" class="comment"><div id="post-36873-score" class="comment-score"></div><div class="comment-text"><p>You do so by using <a href="http://www.microsoft.com/en-us/download/details.aspx?id=4865">Microsoft Network Monitor</a> or possibly <a href="http://www.microsoft.com/en-us/download/details.aspx?id=40308">Microsoft Message Analyzer</a>, <a href="http://www.tamos.com/products/commwifi/">CommView for WiFi</a>, or some other packet analyzer that supports monitor mode, and using whatever UI it has for capturing in monitor mode, or by getting an <a href="http://www.riverbed.com/products/performance-management-control/network-performance-management/wireless-packet-capture.html">AirPcap adapter</a> and using that to do the capturing with Wireshark.</p></div><div id="comment-36873-info" class="comment-info"><span class="comment-age">(06 Oct '14, 10:50)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="36879"></span><div id="comment-36879" class="comment not_top_scorer"><div id="post-36879-score" class="comment-score"></div><div class="comment-text"><p>but then, thats not using wireshark. Microsoft Network Monitor does the same as colasoft.... I want Wireshark to be in monitor mode to capture the data. Is it possible?</p></div><div id="comment-36879-info" class="comment-info"><span class="comment-age">(06 Oct '14, 20:19)</span> <span class="comment-user userinfo">Points</span></div></div><span id="36880"></span><div id="comment-36880" class="comment not_top_scorer"><div id="post-36880-score" class="comment-score"></div><div class="comment-text"><blockquote><p>I want Wireshark to be in monitor mode to capture the data. Is it possible?</p></blockquote><p>Not on Windows with a regular Wi-Fi adapter.</p></div><div id="comment-36880-info" class="comment-info"><span class="comment-age">(06 Oct '14, 21:13)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div></div><div id="comment-tools-36858" class="comment-tools"><span class="comments-showing"> showing 5 of 7 </span> <a href="#" class="show-all-comments-link">show 2 more comments</a></div><div class="clear"></div><div id="comment-36858-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

