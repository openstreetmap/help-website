+++
type = "question"
title = "fatal error C1189: #error :  Your MSVC_VARIANT setting in config.nmake doesn&#x27;t match the MS compiler version!"
description = '''Hello guys. I got some faults, which i described above in the title. I know that i have to change the MSVC_VARIANT in the config.nmake, but nothing helped. I&#x27;m doing the steps like described in the developer-guide of wireshark. I had a lot of issues and a lot of troubleshooting too. Another problem ...'''
date = "2013-06-25T04:16:00Z"
lastmod = "2013-07-10T02:00:00Z"
weight = 22313
keywords = [ "dissector", "windowsxp", "wireshark" ]
aliases = [ "/questions/22313" ]
osqa_answers = 1
osqa_accepted = true
+++

<div class="headNormal">

# [fatal error C1189: \#error : Your MSVC\_VARIANT setting in config.nmake doesn't match the MS compiler version!](/questions/22313/fatal-error-c1189-error-your-msvc_variant-setting-in-confignmake-doesnt-match-the-ms-compiler-version)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-22313-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-22313-score" class="post-score" title="current number of votes">0</div><span id="post-22313-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hello guys.</p><p>I got some faults, which i described above in the title. I know that i have to change the MSVC_VARIANT in the config.nmake, but nothing helped. I'm doing the steps like described in the developer-guide of wireshark. I had a lot of issues and a lot of troubleshooting too. Another problem is, that i just want to change the $(FrameworkSdkDir) from v7.0A to v7.1. I use the MS Visual Studio EE 2010, but i cant change this value. I was coding the dissector example, want to compile it and create a dll. But i earn a lot of issues. I'm real tired of them. Can anyone give me a tip or something else? That would be so fine.</p><p>Greetings</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-dissector" rel="tag" title="see questions tagged &#39;dissector&#39;">dissector</span> <span class="post-tag tag-link-windowsxp" rel="tag" title="see questions tagged &#39;windowsxp&#39;">windowsxp</span> <span class="post-tag tag-link-wireshark" rel="tag" title="see questions tagged &#39;wireshark&#39;">wireshark</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>25 Jun '13, 04:16</strong></p><img src="https://secure.gravatar.com/avatar/d0ac69e168cf9c7b9865bc3e2005773e?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="bprogrammer&#39;s gravatar image" /><p><span>bprogrammer</span><br />
<span class="score" title="16 reputation points">16</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="5 badges"><span class="bronze">●</span><span class="badgecount">5</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="bprogrammer has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>25 Jun '13, 04:24</strong> </span></p></div></div><div id="comments-container-22313" class="comments-container"></div><div id="comment-tools-22313" class="comment-tools"></div><div class="clear"></div><div id="comment-22313-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="22315"></span>

<div id="answer-container-22315" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-22315-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-22315-score" class="post-score" title="current number of votes">2</div><span id="post-22315-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span class="accept-answer on" rel="nofollow" title="bprogrammer has selected this answer as the correct answer"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>The usual answer is that you <strong>must</strong> follow the instructions in the <a href="http://www.wireshark.org/docs/wsdg_html_chunked/">Developers Guide</a> to the letter. Any deviation may lead to issues.</p><p>If you are using VS EE 2010, you should set <code>MSVC_VARIANT=MSVC2010EE</code> and ensure all the other versions are commented out.</p><p>What is the $(FrameworkSdkDir) you refer to and why do you think you need to change it? You should try to build Wireshark as per the instructions with no changes at all, and only when you succeed at that can you go ahead and modify things.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>25 Jun '13, 04:38</strong></p><img src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="grahamb&#39;s gravatar image" /><p><span>grahamb ♦</span><br />
<span class="score" title="19834 reputation points"><span>19.8k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">●</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">●</span><span class="badgecount">206</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="grahamb has 274 accepted answers">22%</span></p></div></div><div id="comments-container-22315" class="comments-container"><span id="22317"></span><div id="comment-22317" class="comment"><div id="post-22317-score" class="comment-score"></div><div class="comment-text"><p>Hello,</p><p>thanks for the quick answer. Yes, i'm sure that I commented the other versons out. Hm, i think i have to install the "Microsoft SDK v7.1" ?. When I install die VS EE 2010 it installs the Microsoft SDK v7.0A by itself. So, i thought i have to change this path to this --&gt; C:\Programme\Microsoft SDKs\Windows\v7.1.</p><p>Is that the wrong way?</p><p>Thanks..</p></div><div id="comment-22317-info" class="comment-info"><span class="comment-age">(25 Jun '13, 04:49)</span> <span class="comment-user userinfo">bprogrammer</span></div></div><span id="22318"></span><div id="comment-22318" class="comment"><div id="post-22318-score" class="comment-score"></div><div class="comment-text"><p>Your answer has been converted to a comment as that's how this site works. Please read the FAQ for more information.</p><p>Unless you planned changes require something in the Windows API that is introduced by the SDK 7.1 then there is no need to change. My current build env also uses VS 2010 EE and in the command prompt used to compile I have the following env vars:</p><p><code> ComSpec=C:\WINDOWS\system32\cmd.exe CYGWIN=nodosfilewarning DevEnvDir=C:\Program Files\Microsoft Visual Studio 10.0\Common7\IDE\ FP_NO_HOST_CHECK=NO Framework35Version=v3.5 FrameworkDir=C:\WINDOWS\Microsoft.NET\Framework\ FrameworkDIR32=C:\WINDOWS\Microsoft.NET\Framework\ FrameworkVersion=v4.0.30319 FrameworkVersion32=v4.0.30319 INCLUDE=C:\Program Files\Microsoft Visual Studio 10.0\VC\INCLUDE;C:\Program Files\Microsoft SDKs\Windows\v7.0A\include; LIB=C:\Program Files\Microsoft Visual Studio 10.0\VC\LIB;C:\Program Files\Microsoft SDKs\Windows\v7.0A\lib; LIBPATH=C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319;C:\WINDOWS\Microsoft.NET\Framework\v3.5;C:\Program Files\Microsoft Visual Studio 10.0\VC\LIB; NUMBER_OF_PROCESSORS=4 OS=Windows_NT Path=C:\Program Files\Microsoft Visual Studio 10.0\Common7\IDE\;C:\Program Files\Microsoft Visual Studio 10.0\VC\BIN;C:\Program Files\Microsoft Visual Studio 10.0\Common7\Tools;C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319;C:\WINDOWS\Microsoft.NET\Framework\v3.5;C:\Program Files\Microsoft Visual Studio 10.0\VC\VCPackages;C:\Program Files\Microsoft SDKs\Windows\v7.0A\bin\NETFX 4.0 Tools;C:\ProgramFiles\Microsoft SDKs\Windows\v7.0A\bin;C:\WINDOWS\system32;C:\WINDOWS;C:\WINDOWS\System32\Wbem;C:\WINDOWS\system32\WindowsPowerShell\v1.0;C:\Program Files\CMake 2.8\bin;C:\Program Files\TortoiseSVN\bin PATHEXT=.COM;.EXE;.BAT;.CMD;.VBS;.VBE;.JS;.JSE;.WSF;.WSH;.PSC1 PROCESSOR_ARCHITECTURE=x86 PROCESSOR_IDENTIFIER=x86 Family 6 Model 42 Stepping 7, GenuineIntel PROCESSOR_LEVEL=6 PROCESSOR_REVISION=2a07 ProgramFiles=C:\Program Files PROMPT=$P$G PSModulePath=C:\WINDOWS\system32\WindowsPowerShell\v1.0\Modules\ SESSIONNAME=Console SVN_SSH="C:\Program Files\PuTTY\plink.exe" SystemDrive=C: SystemRoot=C:\WINDOWS VCINSTALLDIR=C:\Program Files\Microsoft Visual Studio 10.0\VC\ VS100COMNTOOLS=C:\Program Files\Microsoft Visual Studio 10.0\Common7\Tools\ VSINSTALLDIR=C:\Program Files\Microsoft Visual Studio 10.0\ windir=C:\WINDOWS WindowsSdkDir=C:\Program Files\Microsoft SDKs\Windows\v7.0A\</code></p></div><div id="comment-22318-info" class="comment-info"><span class="comment-age">(25 Jun '13, 05:03)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="22343"></span><div id="comment-22343" class="comment"><div id="post-22343-score" class="comment-score"></div><div class="comment-text"><p>Okay, i can see that you are using the SDK version v7.0A. I tried some things and read some passages of the developer-guide.pdf again. So, i got some questions again. The document describes i should prepare my cmd.exe. Sounds great. In my case i will insert in the cmd: "C:\Programme\Microsoft SDKs\Windows\v7.1\Bin\SetEnv.Cmd" /Release /x86</p><p>But, v7.0A has not a "SetEnv.cmd". Next step, the describe: "If your version of the compiler does not have SetEnv.Cmd, you may need to use vcvarsall.bat or vcvars32.bat which do much the same thing as SetEnv.cmd."</p><p>I haven't vcvarsall.bat and also no vcvars32.bat?!</p><p>Thanks for your patience.</p></div><div id="comment-22343-info" class="comment-info"><span class="comment-age">(26 Jun '13, 00:25)</span> <span class="comment-user userinfo">bprogrammer</span></div></div><span id="22345"></span><div id="comment-22345" class="comment"><div id="post-22345-score" class="comment-score">1</div><div class="comment-text"><p>As explained in Sect 2.2.6 of the Developers Guide, vcvarsall and vcvars come from Visual Studio. The Guide lists the path for a 64 bit OS with VS 2010.</p><p>I believe that SDK v7.0A gets installed as part of VS 2010 and is a cut-down version, hence the the lack of a SetEnv.</p><p>If you go digging in the start menu you'll find a 'Visual Studio Command Prompt (2010)' under the Visual Studio entry and a 'Windows SDK 7.1 Command Prompt' under the SDK entry. If you have installed the x64 bits (or have an x64 OS) you'll probably have x64 versions of the prompts as well. These prompts are what I use rather than typing the path in an ordinary command prompt.</p></div><div id="comment-22345-info" class="comment-info"><span class="comment-age">(26 Jun '13, 00:49)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="22545"></span><div id="comment-22545" class="comment not_top_scorer"><div id="post-22545-score" class="comment-score"></div><div class="comment-text"><p>Yesterday, i have reinstalled all Components(MSVC10EE,WINSDK7,MSVC Service Pack1 and the SP1 Compiler Setup). I guess something was wrong of the cygwin installation (the packages). Now, i can build my packet-foo.c.. It was a really nice hint to use the Command Prompt's. Thanks..</p><p>However, now i get some issues by starting wireshark. I copied the .dll in the "wireshark\wireshark-gtk2\plugins" directory. The errormessage is that the wiretap-1.11.dll is missing. So, i copied the wireshark.exe in the wireshark-gtk2 directory and it works. Seems like a ugly fix..</p><p>Is there another way? If i copy my builded .dll in the "normal" Wireshark i get the fault, that this dll(1.11.myProtocoll.dll) is missing.</p><p>Greetings</p></div><div id="comment-22545-info" class="comment-info"><span class="comment-age">(02 Jul '13, 00:40)</span> <span class="comment-user userinfo">bprogrammer</span></div></div><span id="22553"></span><div id="comment-22553" class="comment"><div id="post-22553-score" class="comment-score">1</div><div class="comment-text"><p>You get the error because your newly built plugin dll is linked to the wiretap-1.11 dll as you've built your dll from a copy of the main trunk.</p><p>If you're using svn to get the Wireshark sources, either switch to the trunk-1.10 branch (svn switch ...) or checkout a copy of that branch. If you're using git you'll have to do the git equivalent whatever magic that is,</p><p>If you're using a source package grab the one for 1.10.</p><p>This is a drawback of a privately maintained plugin, you'll need to build a copy for each distributed version of Wireshark your users have, e.g. 1.8, 1.10 etc.</p><p>If an answer has solved your issue, please accept the answer for the benefit of other users by clicking the checkmark icon next to the answer. Please read the FAQ for more information.</p></div><div id="comment-22553-info" class="comment-info"><span class="comment-age">(02 Jul '13, 02:09)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="22790"></span><div id="comment-22790" class="comment not_top_scorer"><div id="post-22790-score" class="comment-score"></div><div class="comment-text"><p>Thanks a lot.. You're great. =)</p></div><div id="comment-22790-info" class="comment-info"><span class="comment-age">(10 Jul '13, 02:00)</span> <span class="comment-user userinfo">bprogrammer</span></div></div></div><div id="comment-tools-22315" class="comment-tools"><span class="comments-showing"> showing 5 of 7 </span> <a href="#" class="show-all-comments-link">show 2 more comments</a></div><div class="clear"></div><div id="comment-22315-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

