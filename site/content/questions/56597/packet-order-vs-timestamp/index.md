+++
type = "question"
title = "packet order vs timestamp"
description = '''In some of the traces (taken by tcpdump) the packet order (sorted by packet number) is not always same as the timestamp order, any reason this would happen?'''
date = "2016-10-23T23:09:00Z"
lastmod = "2016-10-26T14:23:00Z"
weight = 56597
keywords = [ "ordering", "timestamp" ]
aliases = [ "/questions/56597" ]
osqa_answers = 0
osqa_accepted = true
+++

<div class="headNormal">

# [packet order vs timestamp](/questions/56597/packet-order-vs-timestamp)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-56597-score" class="post-score" title="current number of votes">0</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>In some of the traces (taken by tcpdump) the packet order (sorted by packet number) is not always same as the timestamp order, any reason this would happen?</p></div><div id="question-tags" class="tags-container tags">ordering timestamp</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>23 Oct '16, 23:09</strong></p><img src="https://secure.gravatar.com/avatar/1e84fb88c367cef82ae127b8c164750e?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="yhzs8&#39;s gravatar image" /><p>yhzs8<br />
<span class="score" title="11 reputation points">11</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="6 badges"><span class="bronze">●</span><span class="badgecount">6</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="yhzs8 has no accepted answers">0%</span></p></div></div><div id="comments-container-56597" class="comments-container"><span id="56599"></span><div id="comment-56599" class="comment"><div id="post-56599-score" class="comment-score"></div><div class="comment-text"><p>Is timestamp part of a protocol header?</p></div><div id="comment-56599-info" class="comment-info"><span class="comment-age">(23 Oct '16, 23:15)</span> koundi</div></div><span id="56604"></span><div id="comment-56604" class="comment"><div id="post-56604-score" class="comment-score"></div><div class="comment-text"><p>No, timestamp is generated by the capturing hardware/software. Do you capture on only one interface or more?</p></div><div id="comment-56604-info" class="comment-info"><span class="comment-age">(24 Oct '16, 05:10)</span> sindy</div></div><span id="56657"></span><div id="comment-56657" class="comment"><div id="post-56657-score" class="comment-score"></div><div class="comment-text"><p>@Luffy: No I didnt mean the "TCP option Timestamp", rather the "time" field shown on the Wireshark for each packet.</p><p>@Sindy: No, it was just taken on a single interface.</p></div><div id="comment-56657-info" class="comment-info"><span class="comment-age">(25 Oct '16, 13:38)</span> yhzs8</div></div><span id="56670"></span><div id="comment-56670" class="comment"><div id="post-56670-score" class="comment-score"></div><div class="comment-text"><p>On what OS is tcpdump running?</p></div><div id="comment-56670-info" class="comment-info"><span class="comment-age">(25 Oct '16, 23:19)</span> Guy Harris ♦♦</div></div><span id="56717"></span><div id="comment-56717" class="comment"><div id="post-56717-score" class="comment-score"></div><div class="comment-text"><p>It is taken on Linux, SUSE</p></div><div id="comment-56717-info" class="comment-info"><span class="comment-age">(26 Oct '16, 14:07)</span> yhzs8</div></div></div><div id="comment-tools-56597" class="comment-tools"></div><div class="clear"></div><div id="comment-56597-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="56719"></span>

<div id="answer-container-56719" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-56719-score" class="post-score" title="current number of votes">1</div></div></td><td><div class="item-right"><div class="answer-body"><p>At least some versions of Linux, when running on a multiprocessor machine - which means any multi-core machine - may process two packets on different CPU cores, and the first packet to arrive may take longer to process, for whatever reason, than the second packet to arrive, and therefore the second packet may be queued up on a socket before the first one is.</p><p>tcpdump and Wireshark capture traffic using the libpcap library, and libpcap uses PF_PACKET sockets on Linux, so libpcap may, therefore, see the second packet before the first packet; libpcap just presents packets to the application as they arrive, without sorting them by the time stamp, and both tcpdump and Wireshark write out packets as they arrive, without sorting them by the time stamp.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>26 Oct '16, 14:23</strong></p><img src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Guy%20Harris&#39;s gravatar image" /><p>Guy Harris ♦♦<br />
<span class="score" title="17443 reputation points"><span>17.4k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">●</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">●</span><span class="badgecount">196</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Guy Harris has 216 accepted answers">19%</span></p></div></div><div id="comments-container-56719" class="comments-container"><span id="56729"></span><div id="comment-56729" class="comment"><div id="post-56729-score" class="comment-score"></div><div class="comment-text"><p>So if the traces is based on the socket-queue-ordering, there must be another entity that "timestamps" the packets which timestamps them differently than the socket-queue-ordering, which entity is it?</p></div><div id="comment-56729-info" class="comment-info"><span class="comment-age">(27 Oct '16, 01:12)</span> yhzs8</div></div></div><div id="comment-tools-56719" class="comment-tools"></div><div class="clear"></div><div id="comment-56719-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

