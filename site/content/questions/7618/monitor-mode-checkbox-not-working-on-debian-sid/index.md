+++
type = "question"
title = "Monitor mode checkbox not working on Debian Sid"
description = '''Hello, I&#x27;m using Debian, when I go to &quot;Capture Options&quot; and select the wlan0 interface, if I try to set it to monitor mode clicking on the checkbox &quot;Capture packets in monitor mode&quot;, the &quot;Link-layer header type&quot; menu blinks for a second and the checkbox remains blank. The &quot;Link-layer header type&quot; me...'''
date = "2011-11-24T17:38:00Z"
lastmod = "2012-01-01T18:19:00Z"
weight = 7618
keywords = [ "capture", "debian", "options", "monitor" ]
aliases = [ "/questions/7618" ]
osqa_answers = 1
osqa_accepted = true
+++

<div class="headNormal">

# [Monitor mode checkbox not working on Debian Sid](/questions/7618/monitor-mode-checkbox-not-working-on-debian-sid)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-7618-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-7618-score" class="post-score" title="current number of votes">0</div><span id="post-7618-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hello, I'm using Debian, when I go to "Capture Options" and select the wlan0 interface, if I try to set it to monitor mode clicking on the checkbox "Capture packets in monitor mode", the "Link-layer header type" menu blinks for a second and the checkbox remains blank. The "Link-layer header type" menu shows only two options: "Ethernet" and "DOCSIS", with both options the monitor mode checkbox has the same behaviour. If I do the following:</p><pre><code>ifconfig wlan0 down
iwconfig wlan0 mode monitor
ifconfig wlan0 up</code></pre><p>then the only option in the "Link-layer header type" menu is "802.11 plus radiotap header" but the behaviour of the monitor checkbox remains the same. Does anyone have any idea about what the problem is? Thanks in advance.</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-capture" rel="tag" title="see questions tagged &#39;capture&#39;">capture</span> <span class="post-tag tag-link-debian" rel="tag" title="see questions tagged &#39;debian&#39;">debian</span> <span class="post-tag tag-link-options" rel="tag" title="see questions tagged &#39;options&#39;">options</span> <span class="post-tag tag-link-monitor" rel="tag" title="see questions tagged &#39;monitor&#39;">monitor</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>24 Nov '11, 17:38</strong></p><img src="https://secure.gravatar.com/avatar/25d342de5f9c3ef87c9520833bcf527f?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Rael&#39;s gravatar image" /><p><span>Rael</span><br />
<span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Rael has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>08 Dec '11, 01:56</strong> </span></p><img src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Guy%20Harris&#39;s gravatar image" /><p><span>Guy Harris ♦♦</span><br />
<span class="score" title="17443 reputation points"><span>17.4k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">●</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">●</span><span class="badgecount">196</span></span></p></div></div><div id="comments-container-7618" class="comments-container"><span id="7619"></span><div id="comment-7619" class="comment"><div id="post-7619-score" class="comment-score"></div><div class="comment-text"><p>Maybe it's important to add that I have the following wireless interface:</p><p><span class="__cf_email__" data-cfemail="e29083878ea2878787">[email protected]</span>:~$ lspci</p><p>[...]</p><p>02:00.0 Ethernet controller: Atheros Communications Inc. AR242x / AR542x Wireless Network Adapter (PCI-Express) (rev 01)</p><p>and I'm using the ath5k module which should support monitor mode, according to this list <a href="http://linuxwireless.org/en/users/Drivers">http://linuxwireless.org/en/users/Drivers</a></p></div><div id="comment-7619-info" class="comment-info"><span class="comment-age">(24 Nov '11, 18:03)</span> <span class="comment-user userinfo">Rael</span></div></div><span id="7623"></span><div id="comment-7623" class="comment"><div id="post-7623-score" class="comment-score"></div><div class="comment-text"><p>Debian lenny, squeeze, wheezy or sid ?</p><p>Wireshark from Debian repo or own build? 1.0.2, 1.2.11 or 1.6.3?</p></div><div id="comment-7623-info" class="comment-info"><span class="comment-age">(24 Nov '11, 23:48)</span> <span class="comment-user userinfo">Jaap ♦</span></div></div><span id="7628"></span><div id="comment-7628" class="comment"><div id="post-7628-score" class="comment-score"></div><div class="comment-text"><p>Debian sid, Wireshark from Debian repo. I'm quite sure it's 1.6.3 but I do not have access to my machine at the moment so I can't check.</p></div><div id="comment-7628-info" class="comment-info"><span class="comment-age">(25 Nov '11, 04:17)</span> <span class="comment-user userinfo">Rael</span></div></div><span id="7751"></span><div id="comment-7751" class="comment"><div id="post-7751-score" class="comment-score"></div><div class="comment-text"><p>So what happens if you turn monitor mode off with <code>iwconfig</code> and then install aircrack-ng (the current version for unstable is 1.0~rc3-2) and run <code>airmon-ng start wlan0</code>. Let us know what it prints and, if it prints "(monitor mode enabled on mon0)" amongst its output, try capturing on <code>mon0</code> rather than <code>wlan0</code>.</p></div><div id="comment-7751-info" class="comment-info"><span class="comment-age">(02 Dec '11, 18:40)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="7757"></span><div id="comment-7757" class="comment not_top_scorer"><div id="post-7757-score" class="comment-score"></div><div class="comment-text"><p>It prints 3 applications that might interact with the card in monitor mode (NetworkManager, dhclient and wpa_supplicant), so I ran "airmon-ng stop mon0", killed the 3 applications and ran "airmon-ng start wlan0" again. In the capture options for mon0 the "Link-layer header type" menu says "Not supported" and the monitor mode checkbox is grey and it is impossible to select it.</p></div><div id="comment-7757-info" class="comment-info"><span class="comment-age">(03 Dec '11, 17:55)</span> <span class="comment-user userinfo">Rael</span></div></div><span id="7758"></span><div id="comment-7758" class="comment"><div id="post-7758-score" class="comment-score">1</div><div class="comment-text"><p>So what happens if you restart the three applications, do <code>airmon-ng start wlan0</code>, <em>don't</em> kill any of the applications, start up Wireshark, do Capture -&gt; Options, <em>IGNORE</em> the "Monitor mode" checkbox, and try capturing on <code>mon0</code>?</p></div><div id="comment-7758-info" class="comment-info"><span class="comment-age">(03 Dec '11, 20:52)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="7761"></span><div id="comment-7761" class="comment not_top_scorer"><div id="post-7761-score" class="comment-score"></div><div class="comment-text"><p>It looks like it works! Thank you very much.</p></div><div id="comment-7761-info" class="comment-info"><span class="comment-age">(04 Dec '11, 03:35)</span> <span class="comment-user userinfo">Rael</span></div></div><span id="7779"></span><div id="comment-7779" class="comment not_top_scorer"><div id="post-7779-score" class="comment-score"></div><div class="comment-text"><p>What does <code>ldd /usr/lib/libpcap.so</code> print?</p></div><div id="comment-7779-info" class="comment-info"><span class="comment-age">(05 Dec '11, 14:23)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="7781"></span><div id="comment-7781" class="comment not_top_scorer"><div id="post-7781-score" class="comment-score"></div><div class="comment-text"><p><span class="__cf_email__" data-cfemail="ef9d8e8a83af9d8e8a83">[email protected]</span># ldd /usr/lib/libpcap.so</p><p>ldd: /usr/lib/libpcap.so: File o directory non esistente</p><p>which is italian for "File not found"</p></div><div id="comment-7781-info" class="comment-info"><span class="comment-age">(05 Dec '11, 16:08)</span> <span class="comment-user userinfo">Rael</span></div></div><span id="7782"></span><div id="comment-7782" class="comment not_top_scorer"><div id="post-7782-score" class="comment-score"></div><div class="comment-text"><p>So what does <code>ls /usr/lib/libpcap.*</code> print?</p></div><div id="comment-7782-info" class="comment-info"><span class="comment-age">(05 Dec '11, 17:10)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="7783"></span><div id="comment-7783" class="comment not_top_scorer"><div id="post-7783-score" class="comment-score"></div><div class="comment-text"><p><span class="__cf_email__" data-cfemail="3e4c5f5b527e4c5f5b52">[email protected]</span># ls /usr/lib/libpcap.*</p><p>ls: impossibile accedere a /usr/lib/libpcap.*: File o directory non esistente</p><p>in english: "ls: unable to access /usr/lib/libpcap.*: File not found"</p></div><div id="comment-7783-info" class="comment-info"><span class="comment-age">(05 Dec '11, 17:28)</span> <span class="comment-user userinfo">Rael</span></div></div><span id="7785"></span><div id="comment-7785" class="comment not_top_scorer"><div id="post-7785-score" class="comment-score"></div><div class="comment-text"><p>OK, what is printed if you run <code>ldd</code> on the <code>dumpcap</code> executable that is installed as part of Wireshark? Libpcap has to be hidden <em>somewhere</em> in order to allow Wireshark to capture network traffic at all.</p></div><div id="comment-7785-info" class="comment-info"><span class="comment-age">(05 Dec '11, 18:06)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="7786"></span><div id="comment-7786" class="comment not_top_scorer"><div id="post-7786-score" class="comment-score"></div><div class="comment-text"><p>Where can I find the dumpcap executable installed as part of Wireshark?</p></div><div id="comment-7786-info" class="comment-info"><span class="comment-age">(05 Dec '11, 18:20)</span> <span class="comment-user userinfo">Rael</span></div></div><span id="7787"></span><div id="comment-7787" class="comment not_top_scorer"><div id="post-7787-score" class="comment-score"></div><div class="comment-text"><p>It should be in the same directory as the Wireshark executable.</p></div><div id="comment-7787-info" class="comment-info"><span class="comment-age">(05 Dec '11, 18:27)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="7797"></span><div id="comment-7797" class="comment not_top_scorer"><div id="post-7797-score" class="comment-score"></div><div class="comment-text"><p>Ok:</p><p><span class="__cf_email__" data-cfemail="74061511183406151118">[email protected]</span># which wireshark</p><p>/usr/bin/wireshark</p><p><span class="__cf_email__" data-cfemail="b7c5d6d2dbf7c5d6d2db">[email protected]</span># ldd /usr/bin/dumpcap</p><pre><code>linux-vdso.so.1 =&gt;  (0x00007fff66dff000)
libwsutil.so.1 =&gt; /usr/lib/libwsutil.so.1 (0x00007fd23aedf000)
libgthread-2.0.so.0 =&gt; /usr/lib/x86_64-linux-gnu/libgthread-2.0.so.0 (0x00007fd23acda000)
libglib-2.0.so.0 =&gt; /lib/x86_64-linux-gnu/libglib-2.0.so.0 (0x00007fd23a9e3000)
libpcap.so.0.8 =&gt; /usr/lib/x86_64-linux-gnu/libpcap.so.0.8 (0x00007fd23a7ac000)
libcap.so.2 =&gt; /lib/libcap.so.2 (0x00007fd23a5a7000)
libz.so.1 =&gt; /lib/x86_64-linux-gnu/libz.so.1 (0x00007fd23a38e000)</code></pre><p>[...continues on next comment...]</p></div><div id="comment-7797-info" class="comment-info"><span class="comment-age">(06 Dec '11, 04:58)</span> <span class="comment-user userinfo">Rael</span></div></div><span id="7798"></span><div id="comment-7798" class="comment not_top_scorer"><div id="post-7798-score" class="comment-score"></div><div class="comment-text"><p>[...continues from previous comment...]</p><pre><code>libpthread.so.0 =&gt; /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007fd23a171000)
libc.so.6 =&gt; /lib/x86_64-linux-gnu/libc.so.6 (0x00007fd239dd2000)
librt.so.1 =&gt; /lib/x86_64-linux-gnu/librt.so.1 (0x00007fd239bc9000)
libpcre.so.3 =&gt; /lib/x86_64-linux-gnu/libpcre.so.3 (0x00007fd23998d000)
/lib64/ld-linux-x86-64.so.2 (0x00007fd23b312000)</code></pre></div><div id="comment-7798-info" class="comment-info"><span class="comment-age">(06 Dec '11, 04:59)</span> <span class="comment-user userinfo">Rael</span></div></div><span id="7805"></span><div id="comment-7805" class="comment not_top_scorer"><div id="post-7805-score" class="comment-score"></div><div class="comment-text"><p>OK, I guess Sid is using a different pathname scheme for libraries, presumably to better handle running both 32-bit and 64-bit binaries on the same machine. I vaguely remember reading something about Debian adopting a scheme such as that.</p><p>What does <code>ldd /usr/lib/x86_64-linux-gnu/libpcap.so.0.8</code> print?</p></div><div id="comment-7805-info" class="comment-info"><span class="comment-age">(06 Dec '11, 10:00)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="7809"></span><div id="comment-7809" class="comment not_top_scorer"><div id="post-7809-score" class="comment-score"></div><div class="comment-text"><p>/usr/lib/x86_64-linux-gnu/ is an empty directory, the system is 32 bit so I found the file you suggested inside /usr/lib/i386-linux-gnu, the command prints the following:</p><pre><code>[email protected]# ldd /usr/lib/i386-linux-gnu/libpcap.so.0.8
linux-gate.so.1 =&gt; (0xb7703000)
libc.so.6 =&gt; /lib/i386-linux-gnu/i686/cmov/libc.so.6 (0xb755e000)
/lib/ld-linux.so.2 (0xb7704000)</code></pre></div><div id="comment-7809-info" class="comment-info"><span class="comment-age">(06 Dec '11, 16:25)</span> <span class="comment-user userinfo">Rael</span></div></div><span id="7810"></span><div id="comment-7810" class="comment not_top_scorer"><div id="post-7810-score" class="comment-score"></div><div class="comment-text"><p>How can I format my command line output to make it look clearer here?</p></div><div id="comment-7810-info" class="comment-info"><span class="comment-age">(06 Dec '11, 16:27)</span> <span class="comment-user userinfo">Rael</span></div></div><span id="7813"></span><div id="comment-7813" class="comment not_top_scorer"><div id="post-7813-score" class="comment-score"></div><div class="comment-text"><p>I'm not sure what "clearer" means; if you mean "how can I make it look like something in a terminal emulator", just put 4 spaces before each line. The syntax used in sites using <a href="http://www.osqa.net/">OSQA</a>, such as ask.wireshark.org, is <a href="http://daringfireball.net/projects/markdown/syntax">markdown</a>, and the syntax for <a href="http://daringfireball.net/projects/markdown/syntax#precode">code blocks</a> is 4-space indentation.</p></div><div id="comment-7813-info" class="comment-info"><span class="comment-age">(06 Dec '11, 22:27)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="8171"></span><div id="comment-8171" class="comment not_top_scorer"><div id="post-8171-score" class="comment-score"></div><div class="comment-text"><p>I have exactly the same problem (running on linux mint which is an ubuntu dist., wireshark v1.4.6, installed it just a week ago). Using wlan0, I can only monitor my own traffic. Tried to check the "capture in monitor mode", it blinks and remains blank. Tried to enable the monitor mode via airmon-ng so I get the mon0 interface, I can use it but it does not scan http traffic, shows only IEEE 802.11 as protocol during scanning, and again the "capture in monitor mode" option does not work. Is there something I can do?</p></div><div id="comment-8171-info" class="comment-info"><span class="comment-age">(01 Jan '12, 12:25)</span> <span class="comment-user userinfo">John mech</span></div></div><span id="8172"></span><div id="comment-8172" class="comment not_top_scorer"><div id="post-8172-score" class="comment-score"></div><div class="comment-text"><p>Sorry for posting this as an answer, I'm new :P</p></div><div id="comment-8172-info" class="comment-info"><span class="comment-age">(01 Jan '12, 17:14)</span> <span class="comment-user userinfo">John mech</span></div></div><span id="8174"></span><div id="comment-8174" class="comment not_top_scorer"><div id="post-8174-score" class="comment-score"></div><div class="comment-text"><p>@John, You should <a href="http://ask.wireshark.org/questions/ask/">ask a new question</a> instead of piggy-backing off this one. You can always reference this question from your new question. Plus, your question-comment is buried under a mound of comments, so you're less likely to get an answer here.</p></div><div id="comment-8174-info" class="comment-info"><span class="comment-age">(01 Jan '12, 18:19)</span> <span class="comment-user userinfo">helloworld</span></div></div></div><div id="comment-tools-7618" class="comment-tools"><span class="comments-showing"> showing 5 of 23 </span> <a href="#" class="show-all-comments-link">show 18 more comments</a></div><div class="clear"></div><div id="comment-7618-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="7814"></span>

<div id="answer-container-7814" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-7814-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-7814-score" class="post-score" title="current number of votes">2</div><span id="post-7814-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span class="accept-answer on" rel="nofollow" title="Rael has selected this answer as the correct answer"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>OK, this is a combination of several problems:</p><ol><li><p>Debian sid does not build libpcap 1.1.1 with libnl, which means that libpcap's monitor-mode APIs don't support the Shiny New mac80211 Mechanism, and end up using the old Wireless Extensions stuff;</p></li><li><p>libpcap 1.1.1's code to use the old Wireless Extension stuff to handle monitor mode had a number of bugs, which means that its monitor-mode APIs don't work correctly when using the old Wireless Extension stuff, and cause dumpcap to report an error;</p></li><li><p>Wireshark wasn't reporting the error it got from dumpcap in that case - it was briefly disabling the "monitor mode" checkbox (because its attempt to get information such as the link-layer header types in monitor mode failed because libpcap couldn't put the interface in monitor mode), then clearing the checkbox (because it failed to put the interface in monitor mode), and then re-enabling it (because the API it originally used to check whether monitor mode was supported <em>without</em> actually attempting to put the interface into monitor mode said monitor mode <em>is</em> supported).</p></li></ol><p>I've checked into the trunk and 1.6 branches a fix for the third problem; it should now pop up an error message box if you try to check the monitor mode checkbox on platforms with the libpcap problems in question. The error message will refer you to the <a href="http://wiki.wireshark.org/CaptureSetup/WLAN">CaptureSetup/WLAN</a> page in the Wireshark Wiki, but it should really specifically refer you to <a href="http://wiki.wireshark.org/CaptureSetup/WLAN#Linux">the Linux section of that page</a>. I'll fix it to do so later. The 1.6 branch changes should also go into 1.4, so they show up in the next 1.4.x release as well as the next 1.6.x release.</p><p>I've checked into the libpcap trunk and 1.2 branches a fix for the second problem, so they should show up in any future 1.2.x release (there are enough bug fixes that tcpdump.org should consider doing a 1.2.x release - and announce it so that various OSes pick it up) as well as any 1.3.0 release when it comes out. When that'll happen, I don't know, and I don't know whether any of the Linux distributions with this issue would pick it up as an update to existing releases or whether you'd have to wait for a future release. Given that anything short of Sid appears to have Wireshark 1.<em>2</em>.x as the Wireshark version, people who run into this are probably building Wireshark from source anyway, so they might end up picking up the fix for the third problem - monitor mode won't work well with the checkbox or the <code>-I</code> option, but at least it'll let you know something went wrong and point you at the Wireshark Wiki, which suggests using airmon-ng in that case.</p><p>I've sent mail to Romain Francoise, the Debian maintainer for libpcap, about the first problem. Hopefully the fix is as simple as declaring libnl to be one of libpcap's dependencies.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>06 Dec '11, 22:42</strong></p><img src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Guy%20Harris&#39;s gravatar image" /><p><span>Guy Harris ♦♦</span><br />
<span class="score" title="17443 reputation points"><span>17.4k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">●</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">●</span><span class="badgecount">196</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Guy Harris has 216 accepted answers">19%</span></p></div></div><div id="comments-container-7814" class="comments-container"></div><div id="comment-tools-7814" class="comment-tools"></div><div class="clear"></div><div id="comment-7814-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

