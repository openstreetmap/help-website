+++
type = "question"
title = "Detect which user is making requests"
description = '''Hello, I have an Ubuntu virtual machine where my developers are logging in to connect. I am using WireShark to be able to monitor if they are trying to upload/send the code somewhere else, as it is forbidden. Having more than one users on the same servers, how could i detect which one is trying to u...'''
date = "2016-09-02T03:52:00Z"
lastmod = "2016-09-02T03:52:00Z"
weight = 55279
keywords = [ "detect", "traffic", "user", "network" ]
aliases = [ "/questions/55279" ]
osqa_answers = 0
osqa_accepted = false
+++

<div class="headNormal">

# [Detect which user is making requests](/questions/55279/detect-which-user-is-making-requests)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-55279-score" class="post-score" title="current number of votes">0</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hello,</p><p>I have an Ubuntu virtual machine where my developers are logging in to connect. I am using WireShark to be able to monitor if they are trying to upload/send the code somewhere else, as it is forbidden.</p><p>Having more than one users on the same servers, how could i detect which one is trying to upload the file? I am looking in the traffic log and i cannot see anything about the system user.</p><p>Is that possible?</p><p>Thanks</p></div><div id="question-tags" class="tags-container tags">detect traffic user network</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>02 Sep '16, 03:52</strong></p><img src="https://secure.gravatar.com/avatar/1b7877c3f563ce8aaa31cbef15456c81?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="alexsmith&#39;s gravatar image" /><p>alexsmith<br />
<span class="score" title="6 reputation points">6</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="alexsmith has no accepted answers">0%</span></p></div></div><div id="comments-container-55279" class="comments-container"><span id="55291"></span><div id="comment-55291" class="comment"><div id="post-55291-score" class="comment-score"></div><div class="comment-text"><blockquote><blockquote><p>how could i detect which one is trying to upload the file?</p></blockquote></blockquote><p>It's not obvious that you can without adding things to the system. If I understand correctly, you want to link a user to some information in some network traffic. If the user just executes a command to move data, not sure that link exists. Maybe you could detect that a specific command was invoked in the Linux system logs by a user, but not sure that would catch everything. If they used a different command that you are not aware of yet, you might miss it.</p><p>What I could imagine adding to your network is an authenticated outbound proxy. This way, if that VM wants to access the Internet, the only way to do so is through a proxy which authenticates the user. This would force a link between a user - assuming all your users have unique usernames/passwords and good security practice says they do - and network traffic outbound.</p></div><div id="comment-55291-info" class="comment-info"><span class="comment-age">(02 Sep '16, 06:12)</span> Bob Jones</div></div><span id="55293"></span><div id="comment-55293" class="comment"><div id="post-55293-score" class="comment-score"></div><div class="comment-text"><p>I already have that. All users connect through a VNC and they have a different port.</p></div><div id="comment-55293-info" class="comment-info"><span class="comment-age">(02 Sep '16, 06:42)</span> alexsmith</div></div><span id="55301"></span><div id="comment-55301" class="comment"><div id="post-55301-score" class="comment-score"></div><div class="comment-text"><blockquote><blockquote><p>I already have that. All users connect through a VNC and they have a different port.</p></blockquote></blockquote><p>But this inbound. You can identify a user coming in, then, I guess. What if they try to use someone else's port? Do you link entered credentials, per user, to a specific port? Or are you depending on the user obeying your precise instructions to use only a certain port? As you probably know, expecting malicious users to obey your instructions all the time is not a good assumption. Sounds like some companies I know and their approach to Cybersecurity - we told people not to hack us in our user guide, so we must be secure!</p><p>Anyway I am not sure that is your issue. You need to track outbound traffic if you are worried about someone pushing data out of the system. How about just blocking all outbound traffic not related to VNC? I don't know what access they need otherwise, so this may not be a valid solution.<br />
</p><p>Does VNC allow copy/paste from remote to local (I think so, but don't really use it)? If it does, then is there really anything you can do about this? I would just copy the content out of the remote system you want protected and paste locally, then upload wherever I want. No amount of access control at your secure end will prevent that.</p></div><div id="comment-55301-info" class="comment-info"><span class="comment-age">(02 Sep '16, 09:17)</span> Bob Jones</div></div><span id="55302"></span><div id="comment-55302" class="comment"><div id="post-55302-score" class="comment-score"></div><div class="comment-text"><p>Yes, user credentials are linked to a specific port. They cannot use their credentials to connect to a different user's port, only if the other users shares their credentials with them, which is forbidden. Now we are only depending on them to not share their credentials, or they will be fired if they do that.</p><p>Yes, exactly, i need to track outbound traffic. It's not a good choice to block all outbound traffic because they are web developers and they need to be able to access a browser on their virtual machine for development purposes. Also they need to be able to commit their code to our Git server.</p><p>Yes, some VNC clients allow copy/paste, but only text, not files. Which is fine because we have thousands and thousands of files, so they won't go and copy/paste the contents of each file one by one.. They'd have to be insane lol.</p></div><div id="comment-55302-info" class="comment-info"><span class="comment-age">(02 Sep '16, 09:23)</span> alexsmith</div></div></div><div id="comment-tools-55279" class="comment-tools"></div><div class="clear"></div><div id="comment-55279-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

</div>

