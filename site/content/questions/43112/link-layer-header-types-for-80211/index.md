+++
type = "question"
title = "Link Layer Header Types for 802.11"
description = '''Hello, Regarding the Wifi 802.11 with different variants (a, b, g, n, ac , and ad). What is the best Link Layer Header Type to use to convey as much information as possible to the upper layer applications? Is it better to use RadioTap header over PPI, or what?'''
date = "2015-06-12T16:56:00Z"
lastmod = "2015-06-13T14:15:00Z"
weight = 43112
keywords = [ "radiotap", "ppi", "802.11" ]
aliases = [ "/questions/43112" ]
osqa_answers = 2
osqa_accepted = false
+++

<div class="headNormal">

# [Link Layer Header Types for 802.11](/questions/43112/link-layer-header-types-for-80211)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-43112-score" class="post-score" title="current number of votes">0</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hello,</p><p>Regarding the Wifi 802.11 with different variants (a, b, g, n, ac , and ad). What is the best Link Layer Header Type to use to convey as much information as possible to the upper layer applications? Is it better to use RadioTap header over PPI, or what?</p></div><div id="question-tags" class="tags-container tags">radiotap ppi 802.11</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>12 Jun '15, 16:56</strong></p><img src="https://secure.gravatar.com/avatar/566cfe38b17a31f0dc825c86538cf3d4?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Hany%20Assasa&#39;s gravatar image" /><p>Hany Assasa<br />
<span class="score" title="21 reputation points">21</span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="11 badges"><span class="silver">●</span><span class="badgecount">11</span></span><span title="14 badges"><span class="bronze">●</span><span class="badgecount">14</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Hany Assasa has no accepted answers">0%</span></p></div></div><div id="comments-container-43112" class="comments-container"></div><div id="comment-tools-43112" class="comment-tools"></div><div class="clear"></div><div id="comment-43112-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

2 Answers:

</div>

</div>

<span id="43113"></span>

<div id="answer-container-43113" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-43113-score" class="post-score" title="current number of votes">1</div></div></td><td><div class="item-right"><div class="answer-body"><p>PPI provides more data than Radiotap, especially for 11n networks.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>12 Jun '15, 17:59</strong></p><img src="https://secure.gravatar.com/avatar/d9cf592a79eafbc3b2a8b3f38cf38362?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Amato_C&#39;s gravatar image" /><p>Amato_C<br />
<span class="score" title="1098 reputation points"><span>1.1k</span></span><span title="14 badges"><span class="badge1">●</span><span class="badgecount">14</span></span><span title="20 badges"><span class="silver">●</span><span class="badgecount">20</span></span><span title="32 badges"><span class="bronze">●</span><span class="badgecount">32</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Amato_C has 15 accepted answers">14%</span></p></div></div><div id="comments-container-43113" class="comments-container"><span id="43114"></span><div id="comment-43114" class="comment"><div id="post-43114-score" class="comment-score"></div><div class="comment-text"><p>And what about the new standard 802.11ad? In addition, if A-MPDU aggregation is enabled would PPI would be more informative than RadioTap for this particular feature?</p></div><div id="comment-43114-info" class="comment-info"><span class="comment-age">(12 Jun '15, 18:12)</span> Hany Assasa</div></div><span id="43115"></span><div id="comment-43115" class="comment"><div id="post-43115-score" class="comment-score">1</div><div class="comment-text"><p>What information does PPI provide that's not supported by <a href="http://www.radiotap.org">the radiotap specification</a>?</p><p>If the answer is "none", then the problem is with the drivers that supply radiotap information, not with radiotap itself, and the maintainers of the drivers should be told to fix their drivers. (Given which vendors support PPI and which vendors support radiotap, the way to tell them is probably to use the site mentioned <a href="https://developer.apple.com/bug-reporting/">here</a>.)</p></div><div id="comment-43115-info" class="comment-info"><span class="comment-age">(12 Jun '15, 18:25)</span> Guy Harris ♦♦</div></div><span id="43124"></span><div id="comment-43124" class="comment"><div id="post-43124-score" class="comment-score"></div><div class="comment-text"><p>The most important information to me is the MPDU Aggregation and I would like the header to be supportive for 802.11ad. During my inspection in RadioTap and PPI, I did not find fields that contain information related to 802.11ad like PPDU Aggregation, Beamforming, PHY LAyer Type.</p></div><div id="comment-43124-info" class="comment-info"><span class="comment-age">(13 Jun '15, 14:28)</span> Hany Assasa</div></div><span id="43127"></span><div id="comment-43127" class="comment not_top_scorer"><div id="post-43127-score" class="comment-score"></div><div class="comment-text"><blockquote><p>The most important information to me is the MPDU Aggregation</p></blockquote><p>What MPDU aggregation information does PPI provide that's not provided by the radiotap <a href="http://www.radiotap.org/defined-fields/A-MPDU%20status">A-MPDU status</a> field?</p><blockquote><p>I would like the header to be supportive for 802.11ad. During my inspection in RadioTap and PPI, I did not find fields that contain information related to 802.11ad like PPDU Aggregation, Beamforming, PHY LAyer Type.</p></blockquote><p>No, there's no 802.11ad support in either <a href="https://www.cacetech.com/documents/PPI%20Header%20format%201.0.10.pdf">version 1.0.10 of the PPI spec</a> or <a href="http://www.radiotap.org">the radiotap spec</a>. Radiotap <em>does</em> have some 802.11ac support, such as <a href="http://www.radiotap.org/defined-fields/VHT">the VHT field</a>; I don't see any 802.11ac support in the PPI spec.</p></div><div id="comment-43127-info" class="comment-info"><span class="comment-age">(13 Jun '15, 17:22)</span> Guy Harris ♦♦</div></div><span id="43128"></span><div id="comment-43128" class="comment not_top_scorer"><div id="post-43128-score" class="comment-score"></div><div class="comment-text"><p>@Amato_C So what 802.11n information does PPI provide that's not provided by radiotap?</p></div><div id="comment-43128-info" class="comment-info"><span class="comment-age">(13 Jun '15, 17:28)</span> Guy Harris ♦♦</div></div><span id="43129"></span><div id="comment-43129" class="comment not_top_scorer"><div id="post-43129-score" class="comment-score"></div><div class="comment-text"><p>"@Guy Harris" Here is a link to the PPI Header Specification: <a href="https://www.cacetech.com/documents/PPI%20Header%20format%201.0.7.pdf">https://www.cacetech.com/documents/PPI%20Header%20format%201.0.7.pdf</a></p><p>Unfortunately I could only find the version from 2008. But when I open a trace with PPI I see the following main headers: 802.11-Common 802.11n MAC 802.11n MAC+PHY</p><p>In contrast, Radiotap has only MCS information.</p><p>I understand that both PPI and Radiotap depends on the driver. But whenever viewing a capture with PPI, the information is more extensive.</p></div><div id="comment-43129-info" class="comment-info"><span class="comment-age">(13 Jun '15, 19:18)</span> Amato_C</div></div><span id="43130"></span><div id="comment-43130" class="comment"><div id="post-43130-score" class="comment-score">1</div><div class="comment-text"><p>Looking at the 2009 1.0.10 spec, as linked in an earlier comment of mine:</p><ul><li>the 802.11-Common fields are in the radiotap <a href="http://www.radiotap.org/defined-fields/Channel">Channel</a>, <a href="http://www.radiotap.org/defined-fields/FHSS?highlight=%28hop%29">FHSS</a>, <a href="http://www.radiotap.org/defined-fields/Antenna%20signal">Antenna signal</a>, and <a href="http://www.radiotap.org/defined-fields/Antenna%20noise">Antenna noise</a>;</li><li>the 802.11n MAC fields are in the radiotap <a href="http://www.radiotap.org/defined-fields/MCS">MCS</a> and <a href="http://www.radiotap.org/defined-fields/A-MPDU%20status">A-MPDU status</a> fields;</li><li>the 802.11 MAC+PHY fields are in those headers and the antenna noise/signal headers, with the <a href="http://www.radiotap.org/defined-fields/Antenna">Antenna</a> field used to indicate to which antenna the signal information refers, but the error vector magnitudes and extension channel information isn't there. However, is the extension channel information useful, or do you determine it from the main channel information and the +20/-20 flag?</li></ul><p>If you don't have the fields listed, that sounds like a rather severe driver bug. I get Channel, Flags, and MCS on my MacBook Pro when I capture in monitor mode; that's with a Broadcom BCM43xx AirPort adapter and the Mountain Lion driver.</p></div><div id="comment-43130-info" class="comment-info"><span class="comment-age">(13 Jun '15, 19:37)</span> Guy Harris ♦♦</div></div><span id="43140"></span><div id="comment-43140" class="comment not_top_scorer"><div id="post-43140-score" class="comment-score"></div><div class="comment-text"><p>I found that PPI provides different type of information regarding MPDU Aggregation than RadioTap. My main issue is I am generating Wifi traffic in ns3 tool. These traffic contains aggregated MPDU frames. When I try to display generated PCAP file by ns3 in Wireshark, the frames are not being decoded correctly. ns3 uses RadioTap to provide information regarding the captured frames. So I was thinking is it a problem of ns3 or it is the RadioTap problem</p></div><div id="comment-43140-info" class="comment-info"><span class="comment-age">(14 Jun '15, 07:58)</span> Hany Assasa</div></div><span id="43144"></span><div id="comment-43144" class="comment"><div id="post-43144-score" class="comment-score">1</div><div class="comment-text"><blockquote><p>When I try to display generated PCAP file by ns3 in Wireshark, the frames are not being decoded correctly</p></blockquote><p>This could be a bug in the Wireshark dissector. Please file a bug on <a href="http://bugs.wireshark.org">the Wireshark bugzilla</a> and attach one of the captures that Wireshark isn't decoding correctly. Without that capture, we have no way of determining whether 1) radiotap can't convey enough information to decode it correctly, 2) radiotap can do so but ns3 isn't using it correctly, or 3) radiotap can do so, ns3 is using it correctly, but Wireshark isn't using the radiotap information at all or isn't using it correctly.</p></div><div id="comment-43144-info" class="comment-info"><span class="comment-age">(14 Jun '15, 10:04)</span> Guy Harris ♦♦</div></div><span id="43154"></span><div id="comment-43154" class="comment not_top_scorer"><div id="post-43154-score" class="comment-score"></div><div class="comment-text"><p>@Guy Harris: Is the extension channel information useful, or do you determine it from the main channel information and the +20/-20 flag? Yes, the extension channel information is required to set-up my wireless capture. The adapter needs to know whether the extension channel is above or below the primary channel. Sometimes it is easy to determine this information (e.g., primary channel is 36 then extension must be +20). For other occasions, I use the Beacons from the AP: HT Information Element (ID = 61)</p><p>@HA87: Sorry that Guy and I are having a side conversations on your original post.</p></div><div id="comment-43154-info" class="comment-info"><span class="comment-age">(14 Jun '15, 13:43)</span> Amato_C</div></div><span id="43155"></span><div id="comment-43155" class="comment not_top_scorer"><div id="post-43155-score" class="comment-score"></div><div class="comment-text"><blockquote><p>The adapter needs to know whether the extension channel is above or below the primary channel.</p></blockquote><p>That's indicated by the "bandwidth" value in the "flags" subfield of the <a href="http://www.radiotap.org/defined-fields/MCS">MCS</a> field in radiotap, so that information <em>is</em> supplied by radiotap. For 802.11ac, it's more complicated, but see the "bandwidth" subfield of the <a href="http://www.radiotap.org/defined-fields/VHT">VHT</a> raditap field.</p><p>(I.e., the "+20/-20 flag" <em>is</em> what says whether the extension channel is above - +20 or below - -20 - the primary channel.)</p></div><div id="comment-43155-info" class="comment-info"><span class="comment-age">(14 Jun '15, 13:49)</span> Guy Harris ♦♦</div></div><span id="43165"></span><div id="comment-43165" class="comment not_top_scorer"><div id="post-43165-score" class="comment-score"></div><div class="comment-text"><p>@Amato_C it is OK, no problem to have discussion here.</p><p>@Guy Harris: I am working on generating trace file to check if the decoding problem is from wireshark or ns3. I will update you ASAP.</p></div><div id="comment-43165-info" class="comment-info"><span class="comment-age">(15 Jun '15, 02:04)</span> Hany Assasa</div></div><span id="43169"></span><div id="comment-43169" class="comment not_top_scorer"><div id="post-43169-score" class="comment-score"></div><div class="comment-text"><p>@Guy Harris: I can confirm the problem I reported before is from Wireshark dissector. I have filed a bug on Wireshark Bugzilla. Please find the following link to it with the capture file: <a href="https://bugs.wireshark.org/bugzilla/show_bug.cgi?id=11277">Bug 11277</a></p></div><div id="comment-43169-info" class="comment-info"><span class="comment-age">(15 Jun '15, 03:54)</span> Hany Assasa</div></div></div><div id="comment-tools-43113" class="comment-tools"><span class="comments-showing"> showing 5 of 13 </span> <a href="#" class="show-all-comments-link">show 8 more comments</a></div><div class="clear"></div><div id="comment-43113-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="43123"></span>

<div id="answer-container-43123" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-43123-score" class="post-score" title="current number of votes">1</div></div></td><td><div class="item-right"><div class="answer-body"><p>My personal preference is Radiotap. That is using AirPCAP. But it does depend on what information you are looking for.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>13 Jun '15, 14:15</strong></p><img src="https://secure.gravatar.com/avatar/e4a81395f6649e064887d7f57ee653eb?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="chillypenguin&#39;s gravatar image" /><p>chillypenguin<br />
<span class="score" title="91 reputation points">91</span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="chillypenguin has one accepted answer">25%</span></p></div></div><div id="comments-container-43123" class="comments-container"></div><div id="comment-tools-43123" class="comment-tools"></div><div class="clear"></div><div id="comment-43123-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

