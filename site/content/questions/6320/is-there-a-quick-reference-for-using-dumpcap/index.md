+++
type = "question"
title = "Is there a &quot;Quick Reference&quot; for using DUMPCAP?"
description = '''I have need to run captures for a protracted period of time to try and catch an elusive problem. I need to be able to set capture filters for two IP hosts and I want to span multiple files, changing every 4 hours and I would like to be able to leave this running for several days without manual inter...'''
date = "2011-09-13T08:11:00Z"
lastmod = "2011-09-15T07:39:00Z"
weight = 6320
keywords = [ "dumpcap" ]
aliases = [ "/questions/6320" ]
osqa_answers = 2
osqa_accepted = false
+++

<div class="headNormal">

# [Is there a "Quick Reference" for using DUMPCAP?](/questions/6320/is-there-a-quick-reference-for-using-dumpcap)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-6320-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-6320-score" class="post-score" title="current number of votes">1</div><span id="post-6320-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I have need to run captures for a protracted period of time to try and catch an elusive problem. I need to be able to set capture filters for two IP hosts and I want to span multiple files, changing every 4 hours and I would like to be able to leave this running for several days without manual intervention.</p><p>I've been using Wireshark and have hit the "End of Memory" bug a few times now... The instructions for DUMPCAP are not terribly intuitive.</p><p>Is there a "Quick Reference" for dumpcap with sample commands to do specific sorts of tasks? I could try and hack my way thru this, but I'm hoping there is an easier way... I just lack the time to become a dumpcap specialist and meet my current deadlines.</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-dumpcap" rel="tag" title="see questions tagged &#39;dumpcap&#39;">dumpcap</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>13 Sep '11, 08:11</strong></p><img src="https://secure.gravatar.com/avatar/5e08be60267d16d727d058a0eb799c94?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="NCPman&#39;s gravatar image" /><p><span>NCPman</span><br />
<span class="score" title="16 reputation points">16</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="NCPman has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>13 Sep '11, 09:00</strong> </span></p><img src="https://secure.gravatar.com/avatar/362ba1008ad9a075d1556d33e97dfed6?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="helloworld&#39;s gravatar image" /><p><span>helloworld</span><br />
<span class="score" title="3149 reputation points"><span>3.1k</span></span><span title="4 badges"><span class="badge1">●</span><span class="badgecount">4</span></span><span title="20 badges"><span class="silver">●</span><span class="badgecount">20</span></span><span title="41 badges"><span class="bronze">●</span><span class="badgecount">41</span></span></p></div></div><div id="comments-container-6320" class="comments-container"></div><div id="comment-tools-6320" class="comment-tools"></div><div class="clear"></div><div id="comment-6320-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

2 Answers:

</div>

</div>

<span id="6322"></span>

<div id="answer-container-6322" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-6322-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-6322-score" class="post-score" title="current number of votes">2</div><span id="post-6322-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>Run $ dumpcap -h or see the <a href="http://www.wireshark.org/docs/man-pages/dumpcap.html">man-page</a> for more information.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>13 Sep '11, 08:36</strong></p><img src="https://secure.gravatar.com/avatar/fac200552b0c24be2bc93a740bd54d0d?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="joke&#39;s gravatar image" /><p><span>joke</span><br />
<span class="score" title="1278 reputation points"><span>1.3k</span></span><span title="4 badges"><span class="badge1">●</span><span class="badgecount">4</span></span><span title="9 badges"><span class="silver">●</span><span class="badgecount">9</span></span><span title="34 badges"><span class="bronze">●</span><span class="badgecount">34</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="joke has 6 accepted answers">9%</span></p></div></div><div id="comments-container-6322" class="comments-container"><span id="6351"></span><div id="comment-6351" class="comment"><div id="post-6351-score" class="comment-score">1</div><div class="comment-text"><p>The manual page could use an Examples section.</p></div><div id="comment-6351-info" class="comment-info"><span class="comment-age">(14 Sep '11, 03:55)</span> <span class="comment-user userinfo">Jaap ♦</span></div></div></div><div id="comment-tools-6322" class="comment-tools"></div><div class="clear"></div><div id="comment-6322-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="6323"></span>

<div id="answer-container-6323" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-6323-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-6323-score" class="post-score" title="current number of votes">2</div><span id="post-6323-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>If by "the instructions for DUMPCAP are not terribly intuitive" you mean the instructions you get when you click on Help &gt; Manual Pages &gt; Dumpcap, well, that is the quick reference. Everything you want to do is listed there.</p><p>First, run "dumpcap -D" to get a list of the interfaces on your system.</p><p>You'll want these options:</p><p>-i n Where 'n' is the number of the interface you want to capture on.</p><p>-b duration:14400 To specify that dumpcap should start a new file after four hours (14400 seconds).</p><p>-f "ip host 192.168.1.1 or ip host 192.168.10.10" To specify a capture filter for two IP hosts.</p><p>-w filename.pcap To specify the base filename for your capture files.</p><p>So, putting it all together, you'll have something like:</p><p>dumpcap -i 1 -b duration:14400 -f "ip host 192.168.1.1 or ip host 192,168.10.10" -w filename.pcap</p><p>It sounds like you already are able to do this in the GUI, but you run into End of Memory errors. Four hours is a long time to capture on a busy network. Perhaps you could do this successfully from the GUI if you shortened the time interval so that the amount of data Wireshark has to keep in memory at one time is smaller.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>13 Sep '11, 08:50</strong></p><img src="https://secure.gravatar.com/avatar/071fe61f64868d98bdf4eb060b63b6ca?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Jim%20Aragon&#39;s gravatar image" /><p><span>Jim Aragon</span><br />
<span class="score" title="7187 reputation points"><span>7.2k</span></span><span title="7 badges"><span class="badge1">●</span><span class="badgecount">7</span></span><span title="33 badges"><span class="silver">●</span><span class="badgecount">33</span></span><span title="118 badges"><span class="bronze">●</span><span class="badgecount">118</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Jim Aragon has 70 accepted answers">24%</span></p></div></div><div id="comments-container-6323" class="comments-container"><span id="6325"></span><div id="comment-6325" class="comment"><div id="post-6325-score" class="comment-score">2</div><div class="comment-text"><blockquote><p>if you shortened the time interval so that the amount of data Wireshark has to keep in memory at one time is smaller.</p></blockquote><p>Uh, actually, Wireshark (the GUI) does not free up state (i.e., memory) each time a new file is opened when using multiple files.</p><p>Update: I'm wrong: state <em>is</em> freed up each time a new file is opened when using multiple files.</p><p>Dumpcap with multiple files is the way to go when doing extended captures.</p></div><div id="comment-6325-info" class="comment-info"><span class="comment-age">(13 Sep '11, 09:30)</span> <span class="comment-user userinfo">Bill Meier ♦♦</span></div></div><span id="6327"></span><div id="comment-6327" class="comment"><div id="post-6327-score" class="comment-score"></div><div class="comment-text"><p>I didn't know that. What determines how much memory Wireshark (GUI) uses? Even though Wireshark doesn't fee up memory when you start a new file, doesn't it re-use the memory that has already been allocated, and doesn't it have to allocate less memory if you start a new file sooner rather than later?</p><p>If you use the multiple files option and start a new file every 10,000 packets, will that use less memory than if you start a new file every 50,000 packets?</p><p>I agree that dumpcap is the way to go for extended captures.</p></div><div id="comment-6327-info" class="comment-info"><span class="comment-age">(13 Sep '11, 12:03)</span> <span class="comment-user userinfo">Jim Aragon</span></div></div><span id="6366"></span><div id="comment-6366" class="comment"><div id="post-6366-score" class="comment-score"></div><div class="comment-text"><p>Wireshark (and tshark) accumulate "dissection state information" as they dissect input data (depending upon the protocol, things like "re-assembled" data, "conversation" information, and so on).</p><p>This happens independently of how the input may have been broken up into multiple files.</p><p>See <a href="http://wiki.wireshark.org/KnownBugs/OutOfMemory">OutOfMemory</a> for more details.</p><p>Update: I should have read the link myself; My statement above is incorrect.</p></div><div id="comment-6366-info" class="comment-info"><span class="comment-age">(14 Sep '11, 12:22)</span> <span class="comment-user userinfo">Bill Meier ♦♦</span></div></div><span id="6380"></span><div id="comment-6380" class="comment"><div id="post-6380-score" class="comment-score"></div><div class="comment-text"><p>I read the "Known Bugs - Out of Memory" page linked to above. It certainly implies that splitting the capture into smaller files will help.</p><p>Under "Workaround(s)" it states:</p><p>"If you encounter problems that Wireshark is running out of memory, you can do the following:"</p><p>"Split the capture file into several smaller ones. This can be done while capturing using the 'Use multiple files' setting in the capture options, or using the editcap command line tool. Switching to a new file while capturing won't release all memory (some memory leaks currently remain), but it will release a lot of it."</p></div><div id="comment-6380-info" class="comment-info"><span class="comment-age">(14 Sep '11, 19:16)</span> <span class="comment-user userinfo">Jim Aragon</span></div></div><span id="6389"></span><div id="comment-6389" class="comment"><div id="post-6389-score" class="comment-score"></div><div class="comment-text"><p>Oops: I got this one completely wrong. Wireshark <em>does</em> clear saved state for each new file when capturing to multiple files.</p><p>Jim: Thanks ...</p></div><div id="comment-6389-info" class="comment-info"><span class="comment-age">(15 Sep '11, 07:39)</span> <span class="comment-user userinfo">Bill Meier ♦♦</span></div></div></div><div id="comment-tools-6323" class="comment-tools"></div><div class="clear"></div><div id="comment-6323-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

