+++
type = "question"
title = "Identifying traffic of cloud-services"
description = '''Hi all, I&#x27;m working on my master thesis about computer forensic and cloud-computing. Actually I&#x27;m trying to identify cloud-related traffic in pcap-files, e.g. dropbox-sync or the usage of Google Drive. My first idea was to extract relevant information like Dest-IP, FQDN or ports out of the pcap-stre...'''
date = "2013-10-10T01:15:00Z"
lastmod = "2013-10-14T11:12:00Z"
weight = 25859
keywords = [ "dropbox", "cloud" ]
aliases = [ "/questions/25859" ]
osqa_answers = 1
osqa_accepted = false
+++

<div class="headNormal">

# [Identifying traffic of cloud-services](/questions/25859/identifying-traffic-of-cloud-services)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-25859-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-25859-score" class="post-score" title="current number of votes">0</div><span id="post-25859-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hi all,</p><p>I'm working on my master thesis about computer forensic and cloud-computing. Actually I'm trying to identify cloud-related traffic in pcap-files, e.g. dropbox-sync or the usage of Google Drive. My first idea was to extract relevant information like Dest-IP, FQDN or ports out of the pcap-stream. Does anybody know other solutions? For forensic work the usage of encrypted traffic is not as good as it is for "normal" user...</p><p>Regards</p><p>Dan</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-dropbox" rel="tag" title="see questions tagged &#39;dropbox&#39;">dropbox</span> <span class="post-tag tag-link-cloud" rel="tag" title="see questions tagged &#39;cloud&#39;">cloud</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>10 Oct '13, 01:15</strong></p><img src="https://secure.gravatar.com/avatar/4b1f2c39bcd57f1d5cacde5dce55528c?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="dsp&#39;s gravatar image" /><p><span>dsp</span><br />
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="dsp has no accepted answers">0%</span></p></div></div><div id="comments-container-25859" class="comments-container"><span id="25872"></span><div id="comment-25872" class="comment"><div id="post-25872-score" class="comment-score"></div><div class="comment-text"><blockquote><p>I'm working on my master thesis about computer forensic and cloud-computing.</p></blockquote><p>what is the goal of the thesis? Based on your question, it sounds like you are trying to detect the use of a cloud service in a capture file? However I'm not quite sure.</p></div><div id="comment-25872-info" class="comment-info"><span class="comment-age">(10 Oct '13, 05:48)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="25876"></span><div id="comment-25876" class="comment"><div id="post-25876-score" class="comment-score"></div><div class="comment-text"><p>Hi Kurt,</p><p>you guess right, sorry for the dubiety. Sometimes you have not enough data fragments on your harddisk to guarantee the use of cloud services, which could be particularly important in digital evidence; e.g you can "hide" the presence of software like dropbox with tools like truecrypt. I try to figure out, if you can certainly detect some hints for the usage of these cloudsoftware in the capture file. I've found a link here to the blog of Jasper Bongertz, where he talked about the analysis of pcap-files with GeoIP. Seems to be worth a try.</p></div><div id="comment-25876-info" class="comment-info"><span class="comment-age">(10 Oct '13, 06:43)</span> <span class="comment-user userinfo">dsp</span></div></div></div><div id="comment-tools-25859" class="comment-tools"></div><div class="clear"></div><div id="comment-25859-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="25880"></span>

<div id="answer-container-25880" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-25880-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-25880-score" class="post-score" title="current number of votes">0</div><span id="post-25880-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><blockquote><p>which could be particularly important in digital evidence; e.g you can "hide" the presence of software like dropbox with tools like truecrypt.</p></blockquote><p>O.K. so, you really just need information if a cloud service has been used, <strong>without</strong> information <strong>what</strong> has been transmitted.</p><p>Well, then your first approach is pretty straight forward. What you can extract from a capture file, given the fact that you captured enough data, is kind of limited to:</p><ul><li>IP addresses of the cloud service. GeoIP is nice, but not really necessary to map the IP address to the owner (see RIPE, ARIN, etc.)</li><li>DNS names in queries and responses</li><li>Certificates in HTTPS connections, which will (most certainly) contain the name of the service.</li><li>If you're lucky and the cloud service client software (if there is one) tries to find updates via plain text HTTP, you can use that information as well (server/domain name from the HTTP request, etc.)</li></ul><p>That's basically it, because the rest of the communication is (most certainly) encrypted. So, yes you will know if a piece of software on the PC had a connection to a cloud service, but you will never be able to prove that the user itself started the connection (the software could have a periodic connection check to its home base) and <strong>what</strong> the user transferred to/from the cloud, as the data is encrypted. So, this will only be a small piece of information in the whole forensic investigation.</p><p>Regards<br />
Kurt</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>10 Oct '13, 07:28</strong></p><img src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Kurt%20Knochner&#39;s gravatar image" /><p><span>Kurt Knochner ♦</span><br />
<span class="score" title="24767 reputation points"><span>24.8k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">●</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">●</span><span class="badgecount">237</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Kurt Knochner has 344 accepted answers">15%</span> </br></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>10 Oct '13, 07:36</strong> </span></p></div></div><div id="comments-container-25880" class="comments-container"><span id="25889"></span><div id="comment-25889" class="comment"><div id="post-25889-score" class="comment-score"></div><div class="comment-text"><p>Hi Kurt,</p><p>thanks for your answer, I think, there are some good advices (especially the certificate-data looks interesting). I know that there is just a little chance to see all data, which is transferred between the client and server, but for me the first step is important. Perhaps the periodic updates and checks of client and server are a problem for me, but imho there could be a difference between a full communication for a data transfer and a "smaller", with less data, communication for an update or just checking. hypothetical I have to count the amount of transferred data between client and server, maybe this is the solution for some problems, e.g. does the client send the data to the cloud or is the client just downloading some data... And of course, digital investigation is more or less a combination of tools and tries, especially in the "new" world cloud-computing.</p><p>Regards Dan</p></div><div id="comment-25889-info" class="comment-info"><span class="comment-age">(10 Oct '13, 10:53)</span> <span class="comment-user userinfo">dsp</span></div></div><span id="25908"></span><div id="comment-25908" class="comment"><div id="post-25908-score" class="comment-score"></div><div class="comment-text"><blockquote><p>but imho there could be a difference between a full communication for a data transfer and a "smaller", with less data, communication for an update or just checking.</p></blockquote><p>Well, the amount of data and the 'connection pattern' might help to differentiate update checking and data up-/downloading.</p><blockquote><p>e.g. does the <strong>client send the data</strong> to the cloud or is the <strong>client just downloading</strong> some data.</p></blockquote><p>that's easy, as you can see the direction of data flow in Wireshark (src/dst IP).</p></div><div id="comment-25908-info" class="comment-info"><span class="comment-age">(11 Oct '13, 01:33)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="25973"></span><div id="comment-25973" class="comment"><div id="post-25973-score" class="comment-score"></div><div class="comment-text"><p>Hi Kurt,</p><p>I tried that the last days and it works fine till now. Now I'm going to implement it with tshark and something like python or php. Just to get some code to automate the investigation. After that I have to identify some more cloud-providers.</p><p>Thanks for your time Dan</p></div><div id="comment-25973-info" class="comment-info"><span class="comment-age">(14 Oct '13, 10:20)</span> <span class="comment-user userinfo">dsp</span></div></div><span id="25974"></span><div id="comment-25974" class="comment"><div id="post-25974-score" class="comment-score"></div><div class="comment-text"><p>Good.</p><p>Hint: If a supplied answer resolves your question can you please "accept" it by clicking the checkmark icon next to it. This highlights good answers for the benefit of subsequent users with the same or similar questions.</p></div><div id="comment-25974-info" class="comment-info"><span class="comment-age">(14 Oct '13, 11:12)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div></div><div id="comment-tools-25880" class="comment-tools"></div><div class="clear"></div><div id="comment-25880-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

