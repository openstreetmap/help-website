+++
type = "question"
title = "Server 2012 R2 - Wireshark Crashes"
description = '''Hi, New to this forum, any help is much appreciated.  Has anyone seen Wireshark crash on Server 2012 R2 I have tried both the 64 and 32 version and they both crash at load when they reach 100%.  Then when you go into the Task Manager the dumpcap is suck at 0% CPU cannot be quit. You have to reboot t...'''
date = "2014-09-19T05:52:00Z"
lastmod = "2014-09-19T05:52:00Z"
weight = 36441
keywords = [ "wireshark_crashed", "server2012" ]
aliases = [ "/questions/36441" ]
osqa_answers = 0
osqa_accepted = false
+++

<div class="headNormal">

# [Server 2012 R2 - Wireshark Crashes](/questions/36441/server-2012-r2-wireshark-crashes)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-36441-score" class="post-score" title="current number of votes">0</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hi, New to this forum, any help is much appreciated.</p><p>Has anyone seen Wireshark crash on Server 2012 R2 I have tried both the 64 and 32 version and they both crash at load when they reach 100%.</p><p>Then when you go into the Task Manager the dumpcap is suck at 0% CPU cannot be quit. You have to reboot the server to uninstall.</p><p><img src="https://osqa-ask.wireshark.org/upfiles/Wireshark1_Sdawof4.PNG" alt="alt text" /></p><p><img src="https://osqa-ask.wireshark.org/upfiles/wireshark2_xo9GziR.PNG" alt="alt text" /></p></div><div id="question-tags" class="tags-container tags">wireshark_crashed server2012</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>19 Sep '14, 05:52</strong></p><img src="https://secure.gravatar.com/avatar/5be8b39df5a2a447288cb0df357fb87d?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="djorpheus&#39;s gravatar image" /><p>djorpheus<br />
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="djorpheus has no accepted answers">0%</span></p></img></div><div class="post-update-info post-update-info-edited"><p>edited 19 Sep '14, 06:16</p></div></div><div id="comments-container-36441" class="comments-container"><span id="36442"></span><div id="comment-36442" class="comment"><div id="post-36442-score" class="comment-score"></div><div class="comment-text"><p>What do you mean by "reach 100%" - is that while already capturing, or still loading/starting Wireshark itself?</p></div><div id="comment-36442-info" class="comment-info"><span class="comment-age">(19 Sep '14, 06:01)</span> Jasper ♦♦</div></div><span id="36444"></span><div id="comment-36444" class="comment"><div id="post-36444-score" class="comment-score"></div><div class="comment-text"><p>1.12.1 x64 works perfectly fine for me on 2K12 R2.</p></div><div id="comment-36444-info" class="comment-info"><span class="comment-age">(19 Sep '14, 06:29)</span> grahamb ♦</div></div><span id="36445"></span><div id="comment-36445" class="comment"><div id="post-36445-score" class="comment-score"></div><div class="comment-text"><p>Hi Jasper,</p><p>Thanks for responding, When Wireshark is still loading it reaches 100% and then crashes.</p></div><div id="comment-36445-info" class="comment-info"><span class="comment-age">(19 Sep '14, 06:30)</span> djorpheus</div></div><span id="36446"></span><div id="comment-36446" class="comment"><div id="post-36446-score" class="comment-score"></div><div class="comment-text"><p>I have attempted to remotely debug a similar issue on Win 8, where the call into dumpcap at startup to determine what interfaces exist hangs. Unfortunately the problem appeared to be in WinPCap and as such isn't a Wireshark problem.</p><p>None of my Win 8.x, Server 2012 systems exhibit the problem.</p><p>Does Wireshark actually crash, or just hang?</p></div><div id="comment-36446-info" class="comment-info"><span class="comment-age">(19 Sep '14, 06:33)</span> grahamb ♦</div></div><span id="36447"></span><div id="comment-36447" class="comment"><div id="post-36447-score" class="comment-score"></div><div class="comment-text"><p>Hi Grahamb,</p><p>Thanks for responding, I guess you would call it a hang. It just never loads, and then I cannot end the Dumpcap process.</p></div><div id="comment-36447-info" class="comment-info"><span class="comment-age">(19 Sep '14, 06:37)</span> djorpheus</div></div><span id="36448"></span><div id="comment-36448" class="comment not_top_scorer"><div id="post-36448-score" class="comment-score"></div><div class="comment-text"><p>I was thinking of trying an older version. Have you seen any issues with those?</p></div><div id="comment-36448-info" class="comment-info"><span class="comment-age">(19 Sep '14, 06:41)</span> djorpheus</div></div><span id="36449"></span><div id="comment-36449" class="comment not_top_scorer"><div id="post-36449-score" class="comment-score"></div><div class="comment-text"><p>You can try, but the issue seems to be with WinPCap, not Wireshark. I have never been able to reproduce the issue on any machine.</p><p>Can you confirm you're installing 1.12.1? You might want to remove Wireshark and \ or WinPCap and reboot and ensure there is no trace of either before re-installing again.</p><p>Do you have anything out of the ordinary on the server, e.g. teamed or multiport NIC's?</p></div><div id="comment-36449-info" class="comment-info"><span class="comment-age">(19 Sep '14, 06:47)</span> grahamb ♦</div></div><span id="36450"></span><div id="comment-36450" class="comment not_top_scorer"><div id="post-36450-score" class="comment-score"></div><div class="comment-text"><p>We are running Websense on these Servers. We are trying to capture a packet that tells the machine to go to the blocked Website of Websense. There are 2 NICs in use on these machines. One is configured for regular IPV4 traffic and the other NIC is a monitoring NIC that is configured just to look at the traffic, the port on the switch this NIC is plugged into also is configured just to monitor all traffic.</p></div><div id="comment-36450-info" class="comment-info"><span class="comment-age">(19 Sep '14, 06:54)</span> djorpheus</div></div><span id="36452"></span><div id="comment-36452" class="comment not_top_scorer"><div id="post-36452-score" class="comment-score"></div><div class="comment-text"><p>We are definitely installing version 1.12.1 and Yes I have uninstalled rebooted, even done a Regedit to make sure all Traces of Wireshark and WinPCap are completely removed and rebooted again.</p></div><div id="comment-36452-info" class="comment-info"><span class="comment-age">(19 Sep '14, 07:03)</span> djorpheus</div></div><span id="38620"></span><div id="comment-38620" class="comment not_top_scorer"><div id="post-38620-score" class="comment-score"></div><div class="comment-text"><p>I have the same issue on a Windows Server 2012 R2 system. Wireshark hangs (both 1.12.2 and 1.99.1) and the dumpcap process freezes.</p><p>After killing the Wireshark process it is not possible to kill the dumpcap process and a reboot is required.</p><p>On the system there is not Winpcap installed (the Wireshark is only used to display captured data and not to capture new data). =&gt; It's not a Winpcap issue.</p><p>The issue is reproducible when calling Wireshark by the "Riverbed SteelCentral Packet Analyzer" (formerly Cascade Pilot) software (function "Send to Wireshark").</p></div><div id="comment-38620-info" class="comment-info"><span class="comment-age">(18 Dec '14, 05:28)</span> Uli</div></div><span id="38621"></span><div id="comment-38621" class="comment not_top_scorer"><div id="post-38621-score" class="comment-score"></div><div class="comment-text"><p>The only way to proceed with this is to debug using the afflicted machine, either with a debugger on that machine or create a crash dump and making that available.</p><p>Note that unless you know you're way around WinDbg and are prepared to install the Wireshark source files, the first option isn't really practical, and the second option requires you to make the crashdump available which may be quite large and contains all the Wireshark process memory that may contain things you don't want to make public.</p></div><div id="comment-38621-info" class="comment-info"><span class="comment-age">(18 Dec '14, 05:45)</span> grahamb ♦</div></div></div><div id="comment-tools-36441" class="comment-tools"><span class="comments-showing"> showing 5 of 11 </span> <a href="#" class="show-all-comments-link">show 6 more comments</a></div><div class="clear"></div><div id="comment-36441-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

</div>

