+++
type = "question"
title = "extract voice from pcap file"
description = '''how can i separate voice from text in raw data (GSM captured packets) within a pcap file using wireshark'''
date = "2016-04-09T03:35:00Z"
lastmod = "2016-04-18T01:41:00Z"
weight = 51529
keywords = [ "pcap" ]
aliases = [ "/questions/51529" ]
osqa_answers = 0
osqa_accepted = false
+++

<div class="headNormal">

# [extract voice from pcap file](/questions/51529/extract-voice-from-pcap-file)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-51529-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-51529-score" class="post-score" title="current number of votes">0</div><span id="post-51529-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count">2</div></div></td><td><div id="item-right"><div class="question-body"><p>how can i separate voice from text in raw data (GSM captured packets) within a pcap file using wireshark</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-pcap" rel="tag" title="see questions tagged &#39;pcap&#39;">pcap</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>09 Apr '16, 03:35</strong></p><img src="https://secure.gravatar.com/avatar/812cadb95310d457ac67159b4b7cbd07?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Maha%20Salman&#39;s gravatar image" /><p><span>Maha Salman</span><br />
<span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="1 badges"><span class="bronze">●</span><span class="badgecount">1</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Maha Salman has no accepted answers">0%</span></p></div></div><div id="comments-container-51529" class="comments-container"><span id="51532"></span><div id="comment-51532" class="comment"><div id="post-51532-score" class="comment-score">1</div><div class="comment-text"><p>Are you sure you have captured any voice at all? There is no such thing as "GSM voice packet" as in GSM, voice is carried by TDM channels, not packets. At what kind of equipment do you take your capture, and what is the lowest layer of the frames you capture?</p></div><div id="comment-51532-info" class="comment-info"><span class="comment-age">(09 Apr '16, 05:33)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="51534"></span><div id="comment-51534" class="comment not_top_scorer"><div id="post-51534-score" class="comment-score"></div><div class="comment-text"><p>Do you mean GSM frames?</p></div><div id="comment-51534-info" class="comment-info"><span class="comment-age">(09 Apr '16, 10:07)</span> <span class="comment-user userinfo">Ghaida Daya</span></div></div><span id="51535"></span><div id="comment-51535" class="comment"><div id="post-51535-score" class="comment-score">2</div><div class="comment-text"><p>I don't mean anything in particular. He may be capturing MTP frames carrying MAP etc., he may be capturing at A-interface, he may be capturing some Ethernet frames carrying TDM over packet... without the actual capture, it's all just guessing.</p></div><div id="comment-51535-info" class="comment-info"><span class="comment-age">(09 Apr '16, 10:18)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="51720"></span><div id="comment-51720" class="comment"><div id="post-51720-score" class="comment-score">1</div><div class="comment-text"><p>we are at UM layer 3 on the interface between BSC and MSC layer, we have these protocols BSSAP and SCCP</p></div><div id="comment-51720-info" class="comment-info"><span class="comment-age">(17 Apr '16, 01:53)</span> <span class="comment-user userinfo">Ghaida Daya</span></div></div><span id="51723"></span><div id="comment-51723" class="comment"><div id="post-51723-score" class="comment-score">1</div><div class="comment-text"><p>Please publish the capture, login-free, somewhere like at cloudshark (preferred), Google drive, MS One Drive... and put a link to it here.</p><p>From what you wrote (Um Layer 3, SCCP and above) it still seems you only capture the signalling traffic, not the audio.</p></div><div id="comment-51723-info" class="comment-info"><span class="comment-age">(17 Apr '16, 02:33)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="51725"></span><div id="comment-51725" class="comment not_top_scorer"><div id="post-51725-score" class="comment-score"></div><div class="comment-text"><p>Here is my pcap file: <a href="https://www.dropbox.com/s/wsoop3zpe201w3r/t2.pcap?dl=0">https://www.dropbox.com/s/wsoop3zpe201w3r/t2.pcap?dl=0</a></p><p>If I capture the signalling traffic ,How can I extract the audio and text messeges?</p></div><div id="comment-51725-info" class="comment-info"><span class="comment-age">(17 Apr '16, 05:18)</span> <span class="comment-user userinfo">Ghaida Daya</span></div></div><span id="51727"></span><div id="comment-51727" class="comment"><div id="post-51727-score" class="comment-score">1</div><div class="comment-text"><p>This capture contains nothing but network signalling traffic (<code>Eth-&gt;IP-&gt;SCTP-&gt;Sigtran M3UA-&gt;SCCP(-&gt;BSSAP(-&gt;various application protocols))</code>), so neither voice nor SMSes can be extracted from it.</p><p>You would have to capture the traffic channels to get to the voice and the dedicated control channels to get to the SMSes.</p><p>The fact that you've taken this capture on Ethernet suggests that you might be able to capture the TCH and DCCH on Ethernet as well, but without knowledge of the network it remains only a guess.</p><p>And don't forget that GSM transmission is usually ciphered.</p></div><div id="comment-51727-info" class="comment-info"><span class="comment-age">(17 Apr '16, 06:03)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="51743"></span><div id="comment-51743" class="comment not_top_scorer"><div id="post-51743-score" class="comment-score">1</div><div class="comment-text"><p>Just one more point, there is a flag</p><p><code>1... .... = FI(Full IP): AoIP with compressed speech via RTP/UDP/IP is supported by the BSS/Preferred by the MSC</code></p><p>in the codec attributes, so there is a good chance that the voice channels should be available as RTP, but I haven't found any information allowing to correlate a particular RTP stream with the signalling exchange.</p><p>But if you are interested in the particular call from 2013 which you've sent as an example, I'm afraid there is nothing more you could do about it unless you have a wider capture from that time.</p></div><div id="comment-51743-info" class="comment-info"><span class="comment-age">(18 Apr '16, 01:41)</span> <span class="comment-user userinfo">sindy</span></div></div></div><div id="comment-tools-51529" class="comment-tools"><span class="comments-showing"> showing 5 of 8 </span> <a href="#" class="show-all-comments-link">show 3 more comments</a></div><div class="clear"></div><div id="comment-51529-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

</div>

