+++
type = "question"
title = "DNP3 display filter - Can you filter based on a point&#x27;s value?"
description = '''I am pretty familiar with DNP3, slightly less familiar with Wireshark though I am comfortable with it. I am just starting to use Wireshark to decode DNP3 data. I noticed that the filter includes &quot;dnp3.al.ana&quot; which seems to specify that a particular analog point offset exist in any filtered packets....'''
date = "2016-04-04T12:44:00Z"
lastmod = "2016-04-04T16:15:00Z"
weight = 51400
keywords = [ "display-filter", "dnp3", "dnp" ]
aliases = [ "/questions/51400" ]
osqa_answers = 0
osqa_accepted = true
+++

<div class="headNormal">

# [DNP3 display filter - Can you filter based on a point's value?](/questions/51400/dnp3-display-filter-can-you-filter-based-on-a-points-value)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-51400-score" class="post-score" title="current number of votes">0</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I am pretty familiar with DNP3, slightly less familiar with Wireshark though I am comfortable with it. I am just starting to use Wireshark to decode DNP3 data. I noticed that the filter includes "dnp3.al.ana" which seems to specify that a particular analog point offset exist in any filtered packets. However, I do not see how to also specify a value. The descriptions at the <a href="https://www.wireshark.org/docs/dfref/d/dnp3.html">DNP3 Wireshark Display Filter Reference</a> are pretty vague, perhaps it is there and I am missing it.</p><p>Some example use cases where this would be handy: An example use case is when a serial number is passed back as a point, in case you know the device serial number you're interested in but don't have a cross reference sheet to find the device's DNP3 address. Or, troubleshooting an issue and identifying exactly when a particular value came across. Another example with particular worth is identifying binary values (e.g. reporting a local operation) that came in unsolicited; you can filter on the unsolicited flag, but unless the binary value came back as "with flags" instead of packed I cannot see how to filter on its value.</p><p>Any help is appreciated. I can also generate DNP3 pcap files if anyone wants to see what I'm working with.</p></div><div id="question-tags" class="tags-container tags">display-filter dnp3 dnp</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>04 Apr '16, 12:44</strong></p><img src="https://secure.gravatar.com/avatar/80f06420e0232e582a8324d1d7164088?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="DerekGuenther&#39;s gravatar image" /><p>DerekGuenther<br />
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="DerekGuenther has no accepted answers">0%</span></p></div></div><div id="comments-container-51400" class="comments-container"></div><div id="comment-tools-51400" class="comment-tools"></div><div class="clear"></div><div id="comment-51400-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="51401"></span>

<div id="answer-container-51401" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-51401-score" class="post-score" title="current number of votes">1</div></div></td><td><div class="item-right"><div class="answer-body"><p>The filter you mentioned, as do all Wireshark display filters, matches against the value of the specified field, e.g. a filter of <code>dnp3.al.ana == 42</code> will display all packets that contain any analog input with the value 42.</p><p>Note that this field has changed recently in the nightly builds and whenever 2.2 is released. Currently you can just use <code>dnp3.al.ana</code> to match against all analog input variations, but the change will force you to specify the data type of the field, e.g. <code>dnp3.al.ana.int</code> for 16 &amp; 32 bit integers, <code>dnp3.al.ana.float</code> for 32 bit floats and <code>dnp3.al.ana.double</code> for 64 bit floats.</p><p>For (single-bit) binary values you can only search for 0 or 1, using <code>dnp3.al.bit</code> so whichever value you choose will likely generate a lot of <em>false</em> matches. I think, (don't have docs to hand at the moment) that any index that has an <em>error</em> bit set in status should be reported with the status, so to check for single bit inputs that are in local forced mode try a filter of <code>dnp3.al.biq.b4 == 1</code>.</p><p>Arguably the filter names for status bits should reflect the status name not the bit position, but changing them now would upset folks with working filters using the current names.</p><p>Also note that often the easiest way to determine a filter is to find a field with the value you want in the packet details pane, right click the field and choose "Apply as a filter -&gt; Selected".</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>04 Apr '16, 16:15</strong></p><img src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="grahamb&#39;s gravatar image" /><p>grahamb ♦<br />
<span class="score" title="19834 reputation points"><span>19.8k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">●</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">●</span><span class="badgecount">206</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="grahamb has 274 accepted answers">22%</span></p></div></div><div id="comments-container-51401" class="comments-container"><span id="51427"></span><div id="comment-51427" class="comment"><div id="post-51427-score" class="comment-score"></div><div class="comment-text"><p>Thank you, this is helpful, particularly the bit about right-clicking and applying as a filter. However, if I apply a display filter "dnp3.al.point_index == 6 &amp;&amp; dnp3.al.ana == 1317" (sorry, I don't know how to format in a comment) it seems to display all packets that contain the specified analog point index and does not actually filter on the value. That is why I was confused about what dnp3.al.ana did, because it does not seem to work. It is also definitely broken for 32-bit values, right-clicking on one and applying as a filter causes no packets to appear even though that particular point (a serial number) only ever has one value in all of the messages.<br />
</p><p>If it matters, I used a comms log from our head-end software and ran it through text2pcap. The DNP data should be the same either way, I believe. If you would like me to provide a capture file or screenshots I'd be happy to, I am still open to the possibility that I might be doing something wrong.</p><p>Thanks again for your help, it is much appreciated.</p></div><div id="comment-51427-info" class="comment-info"><span class="comment-age">(05 Apr '16, 16:18)</span> DerekGuenther</div></div><span id="51471"></span><div id="comment-51471" class="comment"><div id="post-51471-score" class="comment-score"></div><div class="comment-text"><p>Can you try one of the more recent nightly builds? This may be a reason for the change I mentioned.</p></div><div id="comment-51471-info" class="comment-info"><span class="comment-age">(07 Apr '16, 06:34)</span> grahamb ♦</div></div><span id="51690"></span><div id="comment-51690" class="comment"><div id="post-51690-score" class="comment-score"></div><div class="comment-text"><p>Sorry for the delay in responding. I installed "Version 2.1.0-2685-ga7e04fc (v2.1.0rc0-2685-ga7e04fc from master)" just now and tried again. The "dnp3.al.ana.int" filter seems to work a lot better. It works for 32-bit values now, and seems to filter properly for 16-bit as well where the old filter just seemed to give you every packet.</p><p>However, I'm still having an issue - let's say that I apply the filter "dnp3.al.point_index == 13 &amp;&amp; dnp3.al.ana.int == 1235" as I am trying to find times that the reported voltage (with a x10 multiplier) on point offset 13 was 123.5 Volts. Instead of "show me only the packets where analog input point 13 was 1235" I get "show me the packets where analog input offset 13 was present, and any random analog input point happened to have a value of 1235". For example, I have a packet where the value of offset 13 was 1236 (but it is present in the scan return) and point offset 11 had a value of 1235. Both conditions are satisfied, there is a point with that offset and there is a point with that value, but they are not one in the same which is what I want.</p><p>Any thoughts on that? I'm guessing since the filters have changed so much in the new version that it is a work in progress and I'll just have to wait until it gets fixed. If you have a way to let them know about the problem or can tell me how to report this bug, that would be awesome.</p><p>Thanks for your help, grahamb. I'm accepting your answer as you have definitely steered me in the right direction, it is a limitation in the current builds of Wireshark that I cannot get what I want.</p></div><div id="comment-51690-info" class="comment-info"><span class="comment-age">(14 Apr '16, 16:20)</span> DerekGuenther</div></div><span id="51698"></span><div id="comment-51698" class="comment"><div id="post-51698-score" class="comment-score"></div><div class="comment-text"><p>This is a limitation of Wireshark filters, both display and capture in that the filter is used as a packet matcher, and as long as the filter expression returns true when tested against a packet, then the packet is good.</p><p>For protocols such as DNP3 with multiple repeated elements, there is no ability (currently) to express the requirement that the point index and value must be constrained to the same data element (i.e. same sub-tree in the packet detail pane).</p><p>The DNP3 dissector could be modified to add a synthesised field for each data element that combines the index and value. such as "index:value", then a filter could be written to match against that, e.g. dnp3.data_element == "13:1235" which would work for digitals and integers but be somewhat difficult for floating point values as you would have to specify the digits exactly as we've now switched to a string comparison.</p></div><div id="comment-51698-info" class="comment-info"><span class="comment-age">(15 Apr '16, 04:27)</span> grahamb ♦</div></div></div><div id="comment-tools-51401" class="comment-tools"></div><div class="clear"></div><div id="comment-51401-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

