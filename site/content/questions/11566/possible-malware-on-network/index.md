+++
type = "question"
title = "Possible malware on network"
description = '''Some windows machine on our network is constantly broadcasting UDP packets to the port numbers 10019 and 10007. It also constantly changes its source port number. Seems suspicious to me, although I can&#x27;t find any information of malware having this behavior. The content of the packages is always the ...'''
date = "2012-06-02T09:59:00Z"
lastmod = "2012-11-05T03:06:00Z"
weight = 11566
keywords = [ "malware" ]
aliases = [ "/questions/11566" ]
osqa_answers = 5
osqa_accepted = true
+++

<div class="headNormal">

# [Possible malware on network](/questions/11566/possible-malware-on-network)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-11566-score" class="post-score" title="current number of votes">1</div><div id="favorite-count" class="favorite-count">1</div></div></td><td><div id="item-right"><div class="question-body"><p>Some windows machine on our network is constantly broadcasting UDP packets to the port numbers 10019 and 10007. It also constantly changes its source port number. Seems suspicious to me, although I can't find any information of malware having this behavior.</p><p>The content of the packages is always the same:</p><pre><code>0000   f0 ff 00 00 12 00 00 00 00 00 00 00 00 00 00 00  ................
0010   37 34 2d 65 35 2d 30 62 2d 61 66 2d 65 66 2d 32  74-e5-0b-af-ef-2
0020   30 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  0...............
0030   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
0040   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
0050   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
0060   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................
0070   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00                                                  ................</code></pre><p>Any thoughts?</p></div><div id="question-tags" class="tags-container tags">malware</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>02 Jun '12, 09:59</strong></p><img src="https://secure.gravatar.com/avatar/5f0920f2b1612567931708ff17c2dc8b?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="billybob&#39;s gravatar image" /><p>billybob<br />
<span class="score" title="21 reputation points">21</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="billybob has no accepted answers">0%</span></p></div></div><div id="comments-container-11566" class="comments-container"><span id="12392"></span><div id="comment-12392" class="comment"><div id="post-12392-score" class="comment-score"></div><div class="comment-text"><p>Any updates on this one ? I just saw this thing happen on one of my networks and the only info I could find is this thread. I do not have physical access to that PC (guest laptop) but it looks highly suspicious.</p></div><div id="comment-12392-info" class="comment-info"><span class="comment-age">(03 Jul '12, 06:08)</span> docdocdoc9</div></div><span id="12393"></span><div id="comment-12393" class="comment"><div id="post-12393-score" class="comment-score"></div><div class="comment-text"><p>can you please post a full capture of the traffic on <a href="http://cloudshark.org">cloudshark.org</a>?</p></div><div id="comment-12393-info" class="comment-info"><span class="comment-age">(03 Jul '12, 06:26)</span> Kurt Knochner ♦</div></div><span id="12436"></span><div id="comment-12436" class="comment"><div id="post-12436-score" class="comment-score"></div><div class="comment-text"><p>Sure thing - <a href="http://www.cloudshark.org/captures/a7174265ab29">http://www.cloudshark.org/captures/a7174265ab29</a> It broadcasts every second...</p><p>There are also a suspicious LAN scan mixed in but I traced that back to McAfee (<a href="https://community.mcafee.com/thread/27750).">https://community.mcafee.com/thread/27750).</a> The broadcasts seem to be unrelated.</p></div><div id="comment-12436-info" class="comment-info"><span class="comment-age">(04 Jul '12, 02:37)</span> docdocdoc9</div></div></div><div id="comment-tools-11566" class="comment-tools"></div><div class="clear"></div><div id="comment-11566-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

5 Answers:

</div>

</div>

<span id="11567"></span>

<div id="answer-container-11567" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-11567-score" class="post-score" title="current number of votes">3</div></div></td><td><div class="item-right"><div class="answer-body"><p>If I'd think that that kind of traffic is not to be expected as part of normal day to day operations, I would try to identify the machine first. You have the sending MAC address, so you can track it down by searching for it in the MAC address tables of your Switches. You might find that it lives on a port with a lot of other MAC addresses, which usually means that it is coming in from another switch - which means you have to track it down on the next switch and so on, until you find the definitive port. Then track the cabling to the PC that is connected at that port.</p><p>On the PC, run <code>netstat -ano</code> or <code>netstat -anb</code> in a command prompt window. Both tell you either the process ID of the program using the strange ports (which you can identify in the task manager or in Process Explorer), or even the name of the binary directly. From that on, you should be able to tell what is happening, and if the program is bad or not.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>02 Jun '12, 10:16</strong></p><img src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Jasper&#39;s gravatar image" /><p>Jasper ♦♦<br />
<span class="score" title="23806 reputation points"><span>23.8k</span></span><span title="5 badges"><span class="badge1">●</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">●</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">●</span><span class="badgecount">284</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Jasper has 263 accepted answers">18%</span></p></div></div><div id="comments-container-11567" class="comments-container"><span id="11568"></span><div id="comment-11568" class="comment"><div id="post-11568-score" class="comment-score"></div><div class="comment-text"><p>I've tracked down the computer, and ran the command you told me. However, I can't find the udp port numbers listed in netstat. I think the best thing to do will be restoring a backup. Thanks for the help anyhow!</p></div><div id="comment-11568-info" class="comment-info"><span class="comment-age">(02 Jun '12, 10:42)</span> billybob</div></div><span id="11570"></span><div id="comment-11570" class="comment"><div id="post-11570-score" class="comment-score"></div><div class="comment-text"><p>if it's UDP you will only see a process with netstat if it does a listen on that port. You won't see a process that's just sending data via UDP. You could install Microsoft Network Monitor 3.4. It's comparable to wireshark (with less/other features). Netmon will show the name and PID of the process that created the UDP packet. Maybe that helps to track down what is causing the broadcast traffic.</p></div><div id="comment-11570-info" class="comment-info"><span class="comment-age">(02 Jun '12, 13:06)</span> Kurt Knochner ♦</div></div></div><div id="comment-tools-11567" class="comment-tools"></div><div class="clear"></div><div id="comment-11567-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="11579"></span>

<div id="answer-container-11579" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-11579-score" class="post-score" title="current number of votes">0</div></div></td><td><div class="item-right"><div class="answer-body"><p>You could also look into a couple of SysInternals tools, <a href="http://technet.microsoft.com/en-us/sysinternals/bb896645">Process Monitor</a> and <a href="http://technet.microsoft.com/en-us/sysinternals/bb897437">TCPView</a>, which despite the name does handle UDP as well.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>03 Jun '12, 03:45</strong></p><img src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="grahamb&#39;s gravatar image" /><p>grahamb ♦<br />
<span class="score" title="19834 reputation points"><span>19.8k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">●</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">●</span><span class="badgecount">206</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="grahamb has 274 accepted answers">22%</span></p></div></div><div id="comments-container-11579" class="comments-container"></div><div id="comment-tools-11579" class="comment-tools"></div><div class="clear"></div><div id="comment-11579-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="11588"></span>

<div id="answer-container-11588" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-11588-score" class="post-score" title="current number of votes">0</div></div></td><td><div class="item-right"><div class="answer-body"><p>I would also try looking at wireshark output from another machine, maybe booting from a livecd and see if there is any communication from that possibly infected PC.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>03 Jun '12, 13:19</strong></p><img src="https://secure.gravatar.com/avatar/2b1d4ebc68ff2908f81bbfd9a43aaf78?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="pluribus&#39;s gravatar image" /><p>pluribus<br />
<span class="score" title="1 reputation points">1</span><span title="4 badges"><span class="badge1">●</span><span class="badgecount">4</span></span><span title="4 badges"><span class="silver">●</span><span class="badgecount">4</span></span><span title="6 badges"><span class="bronze">●</span><span class="badgecount">6</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="pluribus has no accepted answers">0%</span></p></div></div><div id="comments-container-11588" class="comments-container"></div><div id="comment-tools-11588" class="comment-tools"></div><div class="clear"></div><div id="comment-11588-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="12443"></span>

<div id="answer-container-12443" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-12443-score" class="post-score" title="current number of votes">0</div></div></td><td><div class="item-right"><div class="answer-body"><blockquote><p>Sure thing - <a href="http://www.cloudshark.org/captures/a7174265ab29">http://www.cloudshark.org/captures/a7174265ab29</a> It broadcasts every second...</p></blockquote><p>I believe this could be the Steam Network client (a games network). I found several hints about very similar behaviour.</p><blockquote><p><code>http://community.norton.com/t5/Norton-Internet-Security-Norton/Steam-games-setting-off-NIS-2009-Intrusion-Prevention-system/td-p/93317</code><br />
<code>http://community.norton.com/t5/Norton-360/Left-4-Dead-Portscan/m-p/93102</code><br />
</p></blockquote><p>Logs from a Team Fortress 2 log server:</p><blockquote><p><code>www.tf2logs.com/logs/6815/logfile</code><br />
</p><p><code>L 12/05/2011 - 19:30:26: "Susan Kelley&lt;8&gt;&lt;STEAM_0:0:39787289&gt;&lt;&gt;"</code> <strong><code>connected, address "255.255.255.255:10019"</code></strong><br />
</p></blockquote><p>Please check if the Steam client is installed on the computer (192.168.8.192) who is sending those packets.</p><p>Search the disk for <strong><code>steam.exe</code></strong> and/or <strong><code>steam.dll</code></strong>.</p><p>Regards<br />
Kurt</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>04 Jul '12, 10:22</strong></p><img src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Kurt%20Knochner&#39;s gravatar image" /><p>Kurt Knochner ♦<br />
<span class="score" title="24767 reputation points"><span>24.8k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">●</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">●</span><span class="badgecount">237</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Kurt Knochner has 344 accepted answers">15%</span> </br></br></p></div><div class="post-update-info post-update-info-edited"><p>edited 04 Jul '12, 10:22</p></div></div><div id="comments-container-12443" class="comments-container"></div><div id="comment-tools-12443" class="comment-tools"></div><div class="clear"></div><div id="comment-12443-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="15540"></span>

<div id="answer-container-15540" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-15540-score" class="post-score" title="current number of votes">0</div></div></td><td><div class="item-right"><div class="answer-body"><p>Hello,</p><p>I found following:</p><p>(on a PC Dell inspiron windows seven 64 bits)</p><p>process C:\Program Files (x86)\Dell\Stage Remote\StageRemoteService.exe is the one who is responsible for sending those UDP frames on ports 10007 and 10019 every second.</p><p>this process is part of program "dell stage remote" (by arcsoft)</p><p>more info about it: (in french) <a href="http://content.dell.com/fr/fr/corp/d/press-releases/2011-07-27-nouvelle-version-de-stage">http://content.dell.com/fr/fr/corp/d/press-releases/2011-07-27-nouvelle-version-de-stage</a></p><p>i do not need it, and i could not find how to set it to off in windows services manager, so i inhibate it with following workaround:</p><p>rename file C:\Program Files (x86)\Dell\Stage Remote\StageRemoteService.exe C:\Program Files (x86)\Dell\Stage Remote\StageRemoteService-DoNotRun.exe</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>05 Nov '12, 03:06</strong></p><img src="https://secure.gravatar.com/avatar/8daf1431b6390ca5625144f7e1964ee6?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="bcat&#39;s gravatar image" /><p>bcat<br />
<span class="score" title="1 reputation points">1</span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="bcat has no accepted answers">0%</span> </br></br></p></div></div><div id="comments-container-15540" class="comments-container"><span id="15542"></span><div id="comment-15542" class="comment"><div id="post-15542-score" class="comment-score"></div><div class="comment-text"><p>Dell Stage Remote is a music/video streaming software.</p><blockquote><p><code>http://www.arcsoft.com/intouch/dellstageremote/index.asp?languageCode2=EN</code></p></blockquote></div><div id="comment-15542-info" class="comment-info"><span class="comment-age">(05 Nov '12, 04:24)</span> Kurt Knochner ♦</div></div></div><div id="comment-tools-15540" class="comment-tools"></div><div class="clear"></div><div id="comment-15540-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

