+++
type = "question"
title = "Unable To Save Decryption Keys"
description = '''I am running Wireshark 1.8.2 on a Windows 7 x64 client and I am trying to add a new wireless decription key for WPA-PWD. After specifying the type, passphrase and SSID, I click the Ok button and the key shows up in the &quot;Decryption Key Management&quot; window as a new key. I then click the Ok button which...'''
date = "2012-12-06T09:39:00Z"
lastmod = "2013-02-20T10:09:00Z"
weight = 16641
keywords = [ "decryption", "key" ]
aliases = [ "/questions/16641" ]
osqa_answers = 1
osqa_accepted = false
+++

<div class="headNormal">

# [Unable To Save Decryption Keys](/questions/16641/unable-to-save-decryption-keys)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-16641-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-16641-score" class="post-score" title="current number of votes">0</div><span id="post-16641-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I am running Wireshark 1.8.2 on a Windows 7 x64 client and I am trying to add a new wireless decription key for WPA-PWD. After specifying the type, passphrase and SSID, I click the Ok button and the key shows up in the "Decryption Key Management" window as a new key. I then click the Ok button which closes the window but then when I go back to the decryption keys, it is gone. How do I save the encryption keys? Is there a Registry entry that I can manually create?</p><p>Thanks in advance for any help you can provide.</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-decryption" rel="tag" title="see questions tagged &#39;decryption&#39;">decryption</span> <span class="post-tag tag-link-key" rel="tag" title="see questions tagged &#39;key&#39;">key</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>06 Dec '12, 09:39</strong></p><img src="https://secure.gravatar.com/avatar/01e681d40410ad56b094e86f75afd18e?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="eagle3089&#39;s gravatar image" /><p><span>eagle3089</span><br />
<span class="score" title="1 reputation points">1</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="eagle3089 has no accepted answers">0%</span></p></div></div><div id="comments-container-16641" class="comments-container"></div><div id="comment-tools-16641" class="comment-tools"></div><div class="clear"></div><div id="comment-16641-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="16643"></span>

<div id="answer-container-16643" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-16643-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-16643-score" class="post-score" title="current number of votes">0</div><span id="post-16643-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>The keys should be saved, at least that's what my version of Wireshark does.</p><p>Anyway: The keys are stored in this file:</p><blockquote><p><code>%APPDATA%\Wireshark\80211_keys</code><br />
</p></blockquote><p>or</p><blockquote><p><code>%APPDATA%\Wireshark\profiles\xxxx\80211_keys</code><br />
</p></blockquote><p>where <strong>xxxx</strong> is the name of your pofile. The syntax of the file is like this:</p><pre><code># This file is automatically generated, DO NOT MODIFY.
&quot;wep&quot;,&quot;01:02:03:04:05:06&quot;
&quot;wep&quot;,&quot;02:02:02:02:02:02&quot;</code></pre><p>Instead of <strong>wep</strong>, you can use whatever is available in the drop-down list in the GUI. The key format is as shown in the GUI (Preferences).</p><p>Regards<br />
Kurt</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>06 Dec '12, 10:01</strong></p><img src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Kurt%20Knochner&#39;s gravatar image" /><p><span>Kurt Knochner ♦</span><br />
<span class="score" title="24767 reputation points"><span>24.8k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">●</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">●</span><span class="badgecount">237</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Kurt Knochner has 344 accepted answers">15%</span> </br></br></p></div></div><div id="comments-container-16643" class="comments-container"><span id="16645"></span><div id="comment-16645" class="comment"><div id="post-16645-score" class="comment-score"></div><div class="comment-text"><p>Thanks Kurt but after modifying the file, when I started Wireshark, I got an error as shown in the following screen shot.</p><p><img src="https://osqa-ask.wireshark.org/upfiles/WiresharkError.png" alt="alt text" /></p><p>The entry I made was as follows.</p><p>"wpa-pwd","MyPassphrase","MySSID"</p><p>What is the propper syntax for a WPA-PWD entry?</p></div><div id="comment-16645-info" class="comment-info"><span class="comment-age">(06 Dec '12, 10:32)</span> <span class="comment-user userinfo">eagle3089</span></div></div><span id="16660"></span><div id="comment-16660" class="comment"><div id="post-16660-score" class="comment-score"></div><div class="comment-text"><p>according to the code, the key should be in this format.</p><blockquote><p><code>WPA-PWD should be in the form</code><br />
<code>&lt;key data&gt;[:&lt;ssid&gt;]</code><br />
</p></blockquote><p>So, the file should be:</p><blockquote><p><code>"wpa-pwd","MyPassphrase:MySSID"</code><br />
</p></blockquote><p>However, Wireshark 1.8.4 does not accept that format, so there seems to be a bug in the key parsing function or the wrong string is passed to that function.</p><blockquote><p><code>airpdcap.c:parse_key_string()</code><br />
</p></blockquote><p>Please file a bug report at <a href="http://bugs.wireshark.org">bugs.wireshark.org</a>.</p><p>Regards<br />
Kurt</p></div><div id="comment-16660-info" class="comment-info"><span class="comment-age">(06 Dec '12, 14:35)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="16681"></span><div id="comment-16681" class="comment"><div id="post-16681-score" class="comment-score"></div><div class="comment-text"><p>Hi Kurt. I will go ahead and get a bug filed as you suggested. However, I will be flying cross country to a customer site next month to troubleshoot wireless networking issues they are having between their access points and our product and will need to be able to decrypt the traffic (they are using WPA-PWD). Is there an older version that works?</p><p>Thanks for the help.</p></div><div id="comment-16681-info" class="comment-info"><span class="comment-age">(07 Dec '12, 07:34)</span> <span class="comment-user userinfo">eagle3089</span></div></div><span id="16682"></span><div id="comment-16682" class="comment"><div id="post-16682-score" class="comment-score"></div><div class="comment-text"><p>1.6.12 seems to be working. The key is entered in a different way, but it is stored correctly in the <strong>preferences</strong> file.</p><p><code>wlan.wep_key1: wpa-pwd:mypasswd:myssi</code></p></div><div id="comment-16682-info" class="comment-info"><span class="comment-age">(07 Dec '12, 07:43)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="18779"></span><div id="comment-18779" class="comment"><div id="post-18779-score" class="comment-score"></div><div class="comment-text"><p>I have the same problem still with 1.8.5 are there any updates to this?</p></div><div id="comment-18779-info" class="comment-info"><span class="comment-age">(20 Feb '13, 10:09)</span> <span class="comment-user userinfo">wmann</span></div></div></div><div id="comment-tools-16643" class="comment-tools"></div><div class="clear"></div><div id="comment-16643-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

