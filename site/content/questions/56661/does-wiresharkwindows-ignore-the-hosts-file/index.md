+++
type = "question"
title = "Does WireShark/Windows ignore the hosts file?"
description = '''Hi, i&#x27;m using wireshark (Windows 10 Pro x64 1607) to track my internet traffic and after 10 hours i got 30 outgoing hostnames (after some filtering) which i want to block, so i add them to my hosts file: 0.0.0.0 localhost 0.0.0.0 gateway.skyprod.akadns.net 0.0.0.0 db5wns1b.wns.windows.com 0.0.0.0 ts...'''
date = "2016-10-25T15:35:00Z"
lastmod = "2016-10-27T19:56:00Z"
weight = 56661
keywords = [ "outgoing", "hostnames", "block", "dns", "wireshark" ]
aliases = [ "/questions/56661" ]
osqa_answers = 1
osqa_accepted = false
+++

<div class="headNormal">

# [Does WireShark/Windows ignore the hosts file?](/questions/56661/does-wiresharkwindows-ignore-the-hosts-file)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-56661-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-56661-score" class="post-score" title="current number of votes">0</div><span id="post-56661-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hi, i'm using wireshark (Windows 10 Pro x64 1607) to track my internet traffic and after 10 hours i got 30 <strong>outgoing</strong> hostnames (after some filtering) which i want to block, so i add them to my hosts file:</p><p>0.0.0.0 localhost<br />
0.0.0.0 gateway.skyprod.akadns.net<br />
0.0.0.0 db5wns1b.wns.windows.com<br />
0.0.0.0 tsfe.tsws.mp.microsoft.com.nsatc.net<br />
0.0.0.0 DB5SCH101100127.wns.windows.com<br />
0.0.0.0 msnbot-191-232-139-174.search.msn.com<br />
0.0.0.0 time.microsoft.akadns.net<br />
0.0.0.0 login.live.com.nsatc.net<br />
0.0.0.0 fe2.update.microsoft.com.nsatc.net<br />
0.0.0.0 sls.update.microsoft.com.nsatc.net<br />
0.0.0.0 fe3.delivery.dsp.mp.microsoft.com.nsatc.net<br />
0.0.0.0 a1856.dspw65.akamai.net<br />
0.0.0.0 a767.dscd.akamai.net<br />
0.0.0.0 a1683.dspw65.akamai.net<br />
0.0.0.0 e10198.b.akamaiedge.net<br />
0.0.0.0 db5.settings.data.microsoft.com.akadns.net<br />
0.0.0.0 fg.download.windowsupdate.com.c.footprint.net<br />
0.0.0.0 e9659.dspg.akamaiedge.net<br />
0.0.0.0 c-0001.c-msedge.net<br />
0.0.0.0 4-c-0003.c-msedge.net<br />
0.0.0.0 a1621.g.akamai.net<br />
0.0.0.0 g.msn.com.nsatc.net<br />
0.0.0.0 msnbot-191-232-139-174.search.msn.com<br />
0.0.0.0 a23-60-200-231.deploy.static.akamaitechnologies.com<br />
</p><p>At least i disabled the service DNS-Client. After that i restarted the tracking with wireshark over 10 hours and after filtering again i got the same hostnames. I think that the hosts file works because when i ping the hostnames "ping a1621.g.akamai.net" its unreachable. Now iam confused. Can someone explain whats wrong here...why wireshark tracks the same hostnames which i already blocked?</p><p>Thanks in advance :)</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-outgoing" rel="tag" title="see questions tagged &#39;outgoing&#39;">outgoing</span> <span class="post-tag tag-link-hostnames" rel="tag" title="see questions tagged &#39;hostnames&#39;">hostnames</span> <span class="post-tag tag-link-block" rel="tag" title="see questions tagged &#39;block&#39;">block</span> <span class="post-tag tag-link-dns" rel="tag" title="see questions tagged &#39;dns&#39;">dns</span> <span class="post-tag tag-link-wireshark" rel="tag" title="see questions tagged &#39;wireshark&#39;">wireshark</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>25 Oct '16, 15:35</strong></p><img src="https://secure.gravatar.com/avatar/a056611ad554055cb676db5f2feb53c8?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Trolleule&#39;s gravatar image" /><p><span>Trolleule</span><br />
<span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Trolleule has no accepted answers">0%</span> </br></br></p></div></div><div id="comments-container-56661" class="comments-container"><span id="56669"></span><div id="comment-56669" class="comment"><div id="post-56669-score" class="comment-score"></div><div class="comment-text"><p>Is that the <em>Windows</em> hosts file (<code>%SystemRoot%\System32\drivers\etc\hosts</code>, on all NT versions - so including Windows 10 - if the Wikipedia article is to be believed)?</p></div><div id="comment-56669-info" class="comment-info"><span class="comment-age">(25 Oct '16, 23:19)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="56706"></span><div id="comment-56706" class="comment"><div id="post-56706-score" class="comment-score"></div><div class="comment-text"><p>yes it is. The path is %SystemRoot%\System32\drivers\etc\hosts</p></div><div id="comment-56706-info" class="comment-info"><span class="comment-age">(26 Oct '16, 09:44)</span> <span class="comment-user userinfo">Trolleule</span></div></div><span id="56707"></span><div id="comment-56707" class="comment"><div id="post-56707-score" class="comment-score"></div><div class="comment-text"><p>Is the entry <code>0.0.0.0 localhost</code> going to be helpful?</p></div><div id="comment-56707-info" class="comment-info"><span class="comment-age">(26 Oct '16, 10:20)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="56708"></span><div id="comment-56708" class="comment"><div id="post-56708-score" class="comment-score"></div><div class="comment-text"><p><span>@grahamb</span>, my understanding of the quest is the following: to prevent connections to some server (fqdn) from establishing, instead of using an external firewall, we use a record in <code>hosts</code> file, believing it will prevent the machine from resolving the fqdn using an external DNS. Therefore, the 0.0.0.0 may be a good value if the whole model works.</p><p>Wireshark is used here as a tool to verify whether it works or not.</p><p><span>@Trolleule</span>, I am afraid some caching in browser may interfere with the idea, as you say that <code>ping f.qd.n</code> indicates that the idea works, while the browser still manages to establish the sessions.</p></div><div id="comment-56708-info" class="comment-info"><span class="comment-age">(26 Oct '16, 10:48)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="56709"></span><div id="comment-56709" class="comment"><div id="post-56709-score" class="comment-score"></div><div class="comment-text"><p><span></span><span>@sindy</span>, I understand the intent, playing whack-a-mole with MS "phone-home" connections, but still don't think that null routing <code>localhost</code> is going to be a good idea.</p></div><div id="comment-56709-info" class="comment-info"><span class="comment-age">(26 Oct '16, 11:18)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="56714"></span><div id="comment-56714" class="comment not_top_scorer"><div id="post-56714-score" class="comment-score"></div><div class="comment-text"><p><span></span><span>@sindy</span> i think iam lacking in basic Windows/Network knowledge cause i don't understand, why the browser relates to these connections that i try to block :/ like <span></span><span></span><span></span><span>@grahamb</span> said the intent is to stop that w10 spy and the only way i know to prove that is currently wireshark -&gt; "Wireshark is used here as a tool to verify whether it works or not."</p><p>so thats the reason why i dont understand the role the browser has in this case? -&gt; i don't want to block internet sites, i want to block the hidden traffic of windows.</p><p><span></span><span></span><span></span><span>@grahamb</span> i will delete the "0.0.0.0 localhost" entry...that was only hopeless try :D</p></div><div id="comment-56714-info" class="comment-info"><span class="comment-age">(26 Oct '16, 13:53)</span> <span class="comment-user userinfo">Trolleule</span></div></div></div><div id="comment-tools-56661" class="comment-tools"><span class="comments-showing"> showing 5 of 6 </span> <a href="#" class="show-all-comments-link">show 1 more comments</a></div><div class="clear"></div><div id="comment-56661-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="56710"></span>

<div id="answer-container-56710" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-56710-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-56710-score" class="post-score" title="current number of votes">1</div><span id="post-56710-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>The answer to your question is "yes". Wireshark does address -&gt; host name resolution by itself, rather than by relying on the OS's resolution routines, and does it using its own hosts file (if you've provided one - Wireshark doesn't ship with one), your own personal hosts file (if you've provided one), and <a href="https://c-ares.haxx.se">the C-ARES DNS resolution library</a>. It does <em>not</em> use the system's hosts file.</p><p>And this isn't just on Windows - it's the same on UN*Xes.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>26 Oct '16, 11:25</strong></p><img src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Guy%20Harris&#39;s gravatar image" /><p><span>Guy Harris ♦♦</span><br />
<span class="score" title="17443 reputation points"><span>17.4k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">●</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">●</span><span class="badgecount">196</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Guy Harris has 216 accepted answers">19%</span> </br></br></p></div></div><div id="comments-container-56710" class="comments-container"><span id="56716"></span><div id="comment-56716" class="comment"><div id="post-56716-score" class="comment-score"></div><div class="comment-text"><p>Thank you. Consider pls that iam not interested in resolving ips. I use the windows hosts file to block hostnames. But if we mean the same: does this mean that my hosts file solution block the traffic but only wireshark still tracks these connections cause it ignores the file. So how can i check if the hidden traffic is really blocked ?</p></div><div id="comment-56716-info" class="comment-info"><span class="comment-age">(26 Oct '16, 14:00)</span> <span class="comment-user userinfo">Trolleule</span></div></div><span id="56718"></span><div id="comment-56718" class="comment"><div id="post-56718-score" class="comment-score"></div><div class="comment-text"><blockquote><p>does this mean that my hosts file solution block the traffic but only wireshark still tracks these connections cause it ignores the file.</p></blockquote><p>Probably not. If Wireshark is showing packets going to those host names, it probably means that, for whatever reason, your machine is still trying to contact those hosts. Perhaps some software has their IP addresses saved somewhere. Perhaps there are <em>incoming</em> connections or other <em>incoming</em> packets <em>from</em> those hosts, so that your machine gets the IP address from there.</p></div><div id="comment-56718-info" class="comment-info"><span class="comment-age">(26 Oct '16, 14:19)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="56755"></span><div id="comment-56755" class="comment"><div id="post-56755-score" class="comment-score"></div><div class="comment-text"><p>Hmm iam helpless now :/ Meanwhile i did some further tweaks and tests:<br />
1. I have the hosts file, that seems to work cause pings are unreachable<br />
2. The router iam using is a Fritzbox 4790 and i added these hostnames to a blacklist that i can assign to the standard user profile<br />
3. I unchecked IPv6 in LAN adapter properties<br />
4. I played around woith windows firewall, blocked internet explorer and edge<br />
</p><p>I took some screenshots, i think they are helpfully:<br />
<a href="http://imageshack.com/a/img922/3200/lgoF6N.png">http://imageshack.com/a/img922/3200/lgoF6N.png</a><br />
<a href="http://imageshack.com/a/img922/4277/Yc3O2R.png">http://imageshack.com/a/img922/4277/Yc3O2R.png</a><br />
<a href="http://imageshack.com/a/img922/2189/fQnWTZ.png">http://imageshack.com/a/img922/2189/fQnWTZ.png</a><br />
<a href="http://imageshack.com/a/img923/2483/MbLJIh.png">http://imageshack.com/a/img923/2483/MbLJIh.png</a><br />
<a href="http://imageshack.com/a/img922/2471/8m5QPU.png">http://imageshack.com/a/img922/2471/8m5QPU.png</a><br />
<a href="http://imageshack.com/a/img921/7680/PmWG8U.png">http://imageshack.com/a/img921/7680/PmWG8U.png</a><br />
<a href="http://imageshack.com/a/img923/8880/DdJtca.png">http://imageshack.com/a/img923/8880/DdJtca.png</a><br />
<a href="http://imageshack.com/a/img924/3395/BdbT3R.png">http://imageshack.com/a/img924/3395/BdbT3R.png</a><br />
</p><p>When i start capturing with wireshark over 5 hours, still getting these hostnames :/ Does somone have an idea what i can try now?</p></div><div id="comment-56755-info" class="comment-info"><span class="comment-age">(27 Oct '16, 14:37)</span> <span class="comment-user userinfo">Trolleule</span></div></div><span id="56756"></span><div id="comment-56756" class="comment"><div id="post-56756-score" class="comment-score"></div><div class="comment-text"><p>What exactly means you are "getting those hostnames"? To me, it should mean that the IP addresses to which these hostnames resolve occur in your captures, and Wireshark reverse-translates them to hostnames (or, more precisely, fqdns).</p><p>Now can you see from the capture whether the information exchanges with these IPs are initiated by your PC or by that IP?</p><p>I've missed that you were attempting to handle the "Windows 10 calling home" issue, so I've mentioned browser cache, but Windows may also cache DNS responses (and, unlike in the browser, it won't be easy to empty their cache).</p><p>Blocking Internet Explorer and Edge doesn't prevent the Microsoft Update or some other background process from establishing connections - the browsers are just applications like any other one, not the sole channels to internet which all other applications would have to use to get there.</p></div><div id="comment-56756-info" class="comment-info"><span class="comment-age">(27 Oct '16, 14:45)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="56757"></span><div id="comment-56757" class="comment"><div id="post-56757-score" class="comment-score"></div><div class="comment-text"><p>"To me, it should mean that the IP addresses to which these hostnames resolve occur in your captures, and Wireshark reverse-translates them to hostnames (or, more precisely, fqdns)." -&gt; yes thats what i mean. One of the screenshots shows the query i did with phpmyadmin (all outgoing ips with ports and hostnames that i captured within the 5 hours).</p><p>"Now can you see from the capture whether the information exchanges with these IPs are initiated by your PC or by that IP?" I dont really understand the question, sorry...engl is not my mother lang :/ maybe it helps if you have a look on the screenshot with the phpmyadmin query</p><p>Btw i disabled the windows service DNS Client.</p></div><div id="comment-56757-info" class="comment-info"><span class="comment-age">(27 Oct '16, 15:28)</span> <span class="comment-user userinfo">Trolleule</span></div></div><span id="56763"></span><div id="comment-56763" class="comment not_top_scorer"><div id="post-56763-score" class="comment-score"></div><div class="comment-text"><blockquote><p>Btw i disabled the windows service DNS Client.</p></blockquote><p>That won't affect Wireshark, which uses its own DNS client.</p></div><div id="comment-56763-info" class="comment-info"><span class="comment-age">(27 Oct '16, 16:11)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="56764"></span><div id="comment-56764" class="comment not_top_scorer"><div id="post-56764-score" class="comment-score"></div><div class="comment-text"><p>None of the screenshots help, as none of them are Wireshark screenshots.</p><p>You said</p><blockquote><p>After that i restarted the tracking with wireshark over 10 hours and after filtering again i got the same hostnames.</p></blockquote><p>Could you show a screenshot from that, where Wireshark is displaying those host names?</p></div><div id="comment-56764-info" class="comment-info"><span class="comment-age">(27 Oct '16, 16:14)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="56765"></span><div id="comment-56765" class="comment not_top_scorer"><div id="post-56765-score" class="comment-score"></div><div class="comment-text"><p>of course :)<br />
<a href="http://imageshack.com/a/img923/6486/ZTh3MH.png">http://imageshack.com/a/img923/6486/ZTh3MH.png</a><br />
<a href="http://imageshack.com/a/img924/5884/mLEuVX.png">http://imageshack.com/a/img924/5884/mLEuVX.png</a><br />
</p><p>hope this helps</p><p>Edit: <a href="http://imageshack.com/a/img922/1386/UlwoN1.png">http://imageshack.com/a/img922/1386/UlwoN1.png</a><br />
if you need the information col</p></div><div id="comment-56765-info" class="comment-info"><span class="comment-age">(27 Oct '16, 17:24)</span> <span class="comment-user userinfo">Trolleule</span></div></div><span id="56766"></span><div id="comment-56766" class="comment not_top_scorer"><div id="post-56766-score" class="comment-score"></div><div class="comment-text"><p>Yes, it indicates that editing the hosts file does not prevent some piece of software on 192.168.178.51 from sending traffic to 157.55.240.89. Trying to look up that IP address on my machine fails, and attempting to resolve the host name "sls.update.microsoft.com" gets 134.170.51.188, but perhaps Microsoft resolves sls.update.microsoft.com resolves to different addresses at different times or in different locations.</p></div><div id="comment-56766-info" class="comment-info"><span class="comment-age">(27 Oct '16, 17:38)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="56767"></span><div id="comment-56767" class="comment not_top_scorer"><div id="post-56767-score" class="comment-score"></div><div class="comment-text"><p>I think if i would block some of these IPs, windows would take another route and we don't know how often one blocked IP will be replaced with another one :/ so thats the reason why i try to block the hostname instead of the IP -&gt; correct me if iam wrong...a host like sls.update.microsoft.com.nsatc.net can be resolved to serveral IPs or?</p><p>As you can see here...same hostname<br />
<a href="http://imageshack.com/a/img924/5884/mLEuVX.png">http://imageshack.com/a/img924/5884/mLEuVX.png</a><br />
</p><p>191.234.72.183 fe2.update.microsoft.com.nsatc.net<br />
134.170.58.125 fe2.update.microsoft.com.nsatc.net<br />
</p><p>What would you suggest now?</p></div><div id="comment-56767-info" class="comment-info"><span class="comment-age">(27 Oct '16, 19:56)</span> <span class="comment-user userinfo">Trolleule</span></div></div></div><div id="comment-tools-56710" class="comment-tools"><span class="comments-showing"> showing 5 of 10 </span> <a href="#" class="show-all-comments-link">show 5 more comments</a></div><div class="clear"></div><div id="comment-56710-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

