+++
type = "question"
title = "No Server Hello, Certificate, but works"
description = '''Running version 1.8.0. I have a trace of my client connecting to its server successfully. The WireShark trace does not have a Server Hello, Certificate, Server Hello Done. There is a Client Hello, followed by 1494 bytes [TCP segment of a reassembled PDU] followed by 967 bytes of &quot;Ignored unknown Rec...'''
date = "2012-06-26T09:08:00Z"
lastmod = "2012-06-29T09:25:00Z"
weight = 12187
keywords = [ "done", "hello" ]
aliases = [ "/questions/12187" ]
osqa_answers = 2
osqa_accepted = false
+++

<div class="headNormal">

# [No Server Hello, Certificate, but works](/questions/12187/no-server-hello-certificate-but-works)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-12187-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-12187-score" class="post-score" title="current number of votes">0</div><span id="post-12187-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Running version 1.8.0. I have a trace of my client connecting to its server successfully. The WireShark trace does not have a Server Hello, Certificate, Server Hello Done. There is a Client Hello, followed by 1494 bytes [TCP segment of a reassembled PDU] followed by 967 bytes of "Ignored unknown Record" followed by Client Key Exchange. I can see the certificate info in the data preceding the Client Key Exchange but Wireshark doesn't recognize it. The operation works, but Wireshark isn't decoding the packets correctly.</p><p>I'd attach the trace data but I can't figure how to.</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-done" rel="tag" title="see questions tagged &#39;done&#39;">done</span> <span class="post-tag tag-link-hello" rel="tag" title="see questions tagged &#39;hello&#39;">hello</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>26 Jun '12, 09:08</strong></p><img src="https://secure.gravatar.com/avatar/90ace4ca58ca53e9c64e6713d5950cf2?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="tcoder&#39;s gravatar image" /><p><span>tcoder</span><br />
<span class="score" title="0 reputation points">0</span><span title="5 badges"><span class="badge1">●</span><span class="badgecount">5</span></span><span title="6 badges"><span class="silver">●</span><span class="badgecount">6</span></span><span title="8 badges"><span class="bronze">●</span><span class="badgecount">8</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="tcoder has no accepted answers">0%</span></p></div></div><div id="comments-container-12187" class="comments-container"><span id="12193"></span><div id="comment-12193" class="comment"><div id="post-12193-score" class="comment-score"></div><div class="comment-text"><p>you can upload the file to <a href="http://cloudshark.org">cloudshark.org</a>.</p><p>HINT: You cannot delete an anonymous upload!</p></div><div id="comment-12193-info" class="comment-info"><span class="comment-age">(26 Jun '12, 12:16)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="12198"></span><div id="comment-12198" class="comment"><div id="post-12198-score" class="comment-score"></div><div class="comment-text"><p>I went to <a href="http://cloudshark.org">cloudshark.org</a> and I can't see where I would upload my captured file.</p></div><div id="comment-12198-info" class="comment-info"><span class="comment-age">(26 Jun '12, 12:49)</span> <span class="comment-user userinfo">tcoder</span></div></div><span id="12201"></span><div id="comment-12201" class="comment"><div id="post-12201-score" class="comment-score"></div><div class="comment-text"><p>Please use Firefox or Chrome. IE does not work properly.<br />
</p><p><img src="https://osqa-ask.wireshark.org/upfiles/cloudshark_small.org.jpg" alt="Screenshot" />.</p></div><div id="comment-12201-info" class="comment-info"><span class="comment-age">(26 Jun '12, 12:57)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="12212"></span><div id="comment-12212" class="comment"><div id="post-12212-score" class="comment-score"></div><div class="comment-text"><p>I uploaded the file. It starts at frame 22710. My filter is "ip.addr == 192.168.5.103".</p></div><div id="comment-12212-info" class="comment-info"><span class="comment-age">(26 Jun '12, 14:58)</span> <span class="comment-user userinfo">tcoder</span></div></div><span id="12215"></span><div id="comment-12215" class="comment"><div id="post-12215-score" class="comment-score"></div><div class="comment-text"><p>please post the link.</p></div><div id="comment-12215-info" class="comment-info"><span class="comment-age">(26 Jun '12, 16:23)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="12218"></span><div id="comment-12218" class="comment not_top_scorer"><div id="post-12218-score" class="comment-score"></div><div class="comment-text"><p>Sorry, I don't know how this thing works. Here's the link I hope: <a href="http://cloudshark.org/captures/6a47effe6552?filter=ip.addr%20%3D%3D%20192.168.5.103">http://cloudshark.org/captures/6a47effe6552?filter=ip.addr%20%3D%3D%20192.168.5.103</a></p></div><div id="comment-12218-info" class="comment-info"><span class="comment-age">(26 Jun '12, 17:21)</span> <span class="comment-user userinfo">tcoder</span></div></div><span id="12219"></span><div id="comment-12219" class="comment not_top_scorer"><div id="post-12219-score" class="comment-score"></div><div class="comment-text"><p>I noticed that on Wireshark, frame 22719 shows as "ignored unknown Record". On Cloudshark, the same frame states "Continuation Record".</p></div><div id="comment-12219-info" class="comment-info"><span class="comment-age">(26 Jun '12, 17:29)</span> <span class="comment-user userinfo">tcoder</span></div></div><span id="12241"></span><div id="comment-12241" class="comment not_top_scorer"><div id="post-12241-score" class="comment-score"></div><div class="comment-text"><p>Kurt, I don't see your comment on this page. I see it in the email that was sent to me though.</p><p>First of all, I'm just learning about certificates so I don't know much. I get the same trace data on Apache and IIS.</p><p>On the attempt the client going to 207.25.252.200, Wireshark doesn't show Server Hello. On the connection to 207.25.252.204 the Wireshark trace does show Server Hello, but doesn't show the description like your trace. It seems that your trace shows a lot more detail than Wireshark does.</p><p>As to why you see the packets twice, I didn't notice.</p></div><div id="comment-12241-info" class="comment-info"><span class="comment-age">(27 Jun '12, 13:04)</span> <span class="comment-user userinfo">tcoder</span></div></div><span id="12242"></span><div id="comment-12242" class="comment not_top_scorer"><div id="post-12242-score" class="comment-score"></div><div class="comment-text"><p>My first answer was not correct, so I deleted it. Hold on....</p><p>BTW: How did you capture?</p></div><div id="comment-12242-info" class="comment-info"><span class="comment-age">(27 Jun '12, 13:38)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div></div><div id="comment-tools-12187" class="comment-tools"><span class="comments-showing"> showing 5 of 9 </span> <a href="#" class="show-all-comments-link">show 4 more comments</a></div><div class="clear"></div><div id="comment-12187-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

2 Answers:

</div>

</div>

<span id="12244"></span>

<div id="answer-container-12244" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-12244-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-12244-score" class="post-score" title="current number of votes">0</div><span id="post-12244-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>There is a problem with your capture file.</p><p>Capture file with Filter <strong><code>tcp.stream eq 2</code></strong>, AND with duplicate packets</p><blockquote><p><code>http://cloudshark.org/captures/492b22ee7f57</code><br />
</p></blockquote><p>Look at Frame #2 and #3. It's the same packet with a different source MAC address.</p><blockquote><p>Frame #2 MAC address: Source: Netgear_51:c0:54 (e0:91:f5:51:c0:54)<br />
Frame #3 MAC address: Source: PcPartne_31:0c:a6 (00:01:2e:31:0c:a6)<br />
</p></blockquote><ul><li>Do you have any explanation for this?<br />
</li><li>That MAC address (00:01:2e:31:0c:a6) appears several times in the capture file with different IP addresses!! Maybe some kind of MAC/IP spoofing. <strong>Please check</strong> !!!<br />
</li></ul><blockquote><p><code>http://cloudshark.org/captures/6a47effe6552?filter=eth.addr%20%3D%3D%2000%3A01%3A2e%3A31%3A0c%3Aa6</code><br />
</p></blockquote><ul><li>Can you identify that MAC address on your network?</li><li>The subject in the certificate you got is different than in my test with curl.</li></ul><blockquote><p><code>curl test: Certificate (id-at-commonName=207.25.252.200,id-at-organizationName=IBM,id-at-localityName=Armonk,id-at-stateOrProvinceName=New York,id-at-countryName=US,id-at-serialNumber=</code><strong><code>fleRakbayAlG8AP-jh3-xkyBPpwYMPab</code></strong><code>)</code></p><p><code>your capture: Certificate (id-at-commonName=207.25.252.200,id-at-organizationName=IBM,id-at-localityName=Armonk,id-at-stateOrProvinceName=New York,id-at-countryName=US,id-at-serialNumber=</code><strong><code>izt26fL9ceWum7uCe3Wzwh/g7mXtrFsH</code></strong><code>)</code></p></blockquote><p>Strange. Either the server hands out different certs for different geo regions (<strong>can somebody else please check</strong>), or 'something' is tampering with your SSL connection. Together with the duplicate packets, this looks <strong>at least</strong> kind of strange !??!<br />
</p><ul><li>do you get SSL warnings in the browser?</li><li>How did you capture?<br />
</li></ul><p><strong>SOLUTION:</strong> If I remove the duplicate packets with MAC address 00:01:2e:31:0c:a6, the SSL dissector detects the <code>Server Hello</code>.</p><p>Capture file with Filter <strong><code>tcp.stream eq 2 and not eth.src == 00:01:2e:31:0c:a6</code></strong><br />
</p><blockquote><p><code>http://cloudshark.org/captures/ced9c9b5bd11</code><br />
</p></blockquote><p><strong>HINT</strong>: You will see the <code>Server Hello</code> only, if you save the filtered packets and re-open it in Wireshark.</p><p>I'm not sure if this is a bug in Wireshark or not. You could file a bug report at <a href="https://bugs.wireshark.org/bugzilla/">https://bugs.wireshark.org/bugzilla/</a> and upload both capture files (links above) and a reference (link) to this question.</p><p>At least the duplicate packets are more than strange and could cause "confusion" in the SSL dissector.</p><p>Regards<br />
Kurt</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>27 Jun '12, 14:29</strong></p><img src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Kurt%20Knochner&#39;s gravatar image" /><p><span>Kurt Knochner ♦</span><br />
<span class="score" title="24767 reputation points"><span>24.8k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">●</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">●</span><span class="badgecount">237</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Kurt Knochner has 344 accepted answers">15%</span> </br></br></p></img></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>27 Jun '12, 15:02</strong> </span></p></div></div><div id="comments-container-12244" class="comments-container"><span id="12245"></span><div id="comment-12245" class="comment"><div id="post-12245-score" class="comment-score"></div><div class="comment-text"><p>The server machine has two network interfaces. One is hard wired and the other is WiFi. Could this be my problem? I never thought about it or even looked at the MAC addresses.</p><p>What is curl?</p><p>I've only uploaded the one capture file I saved.</p><p>I'll disable the WiFi interface and see what happens.</p></div><div id="comment-12245-info" class="comment-info"><span class="comment-age">(27 Jun '12, 14:39)</span> <span class="comment-user userinfo">tcoder</span></div></div><span id="12246"></span><div id="comment-12246" class="comment"><div id="post-12246-score" class="comment-score"></div><div class="comment-text"><blockquote><p>One is hard wired and the other is WiFi. Could this be my problem?</p></blockquote><p>In general yes, but your capture file looks really strange. Several packets with different IP addresses but with the same MAC address. This is either a bug in the capture engine, or someone is doing MAC/IP spoofing on your network. You should really try to find that MAC address on the network. Ask the network admins.</p><blockquote><p>What is curl?</p></blockquote><p>A commandline HTTP(S) client: <a href="http://curl.haxx.se">http://curl.haxx.se</a><br />
</p><blockquote><p>I'll disable the WiFi interface and see what happens.</p></blockquote><p>Good luck!</p></div><div id="comment-12246-info" class="comment-info"><span class="comment-age">(27 Jun '12, 14:50)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="12261"></span><div id="comment-12261" class="comment"><div id="post-12261-score" class="comment-score"></div><div class="comment-text"><p>From <a href="http://ask.wireshark.org/questions/12248/bad-certificate">this question</a>:</p><blockquote><p>You mentioned the two MAC addresses. One is the MAC of the router and the other is the MAC of the Ethernet card in the server. They are the two MACs between the router and the server.</p></blockquote><p>regarding the MAC address of the router: What is your netmask on the LAN?</p><p>Based on <a href="http://cloudshark.org/captures/492b22ee7f57">your capture file</a> I would say, that this MAC address is the one of your netgear router (Netgear_51:c0:54 (e0:91:f5:51:c0:54) and this is the MAC address of your client (Ibm_24:4c:f4 (00:0d:60:24:4c:f4)) found in Frame #1. Is that correct?</p><p>If so, then who owns this MAC address on your network (the duplicate packets): PcPartne_31:0c:a6 (00:01:2e:31:0c:a6), found in Frame #3? PcPartner is a manufacturer of motherboards. That's most certainly not your router, is it?</p><p>I wonder why there have been these duplicate packets. Did you find an explanation for it or did you find that device on the network? That still looks strange.</p></div><div id="comment-12261-info" class="comment-info"><span class="comment-age">(28 Jun '12, 01:37)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="12275"></span><div id="comment-12275" class="comment"><div id="post-12275-score" class="comment-score"></div><div class="comment-text"><p>As far as the duplicate packets go, I've always had them.</p><p>I could put the server on another machine in the same network or I can disable the routers connection to the Internet.</p><p>My netmask is 255.255.255.0</p><p>Server is PcPartne_31:0c:a6 (00:01:2e:31:0c:a6) 192.168.5.104.</p><p>Netgear router Netgear_51:c0:54 (e0:91:f5:51:c0:54) FVS318G</p><p>Client is Ibm_24:4c:f4 (00:0d:60:24:4c:f4)) 192.168.5.103</p><p>Why would the Netgear router be reporting? I looked at other traces I have and they also show duplicate packets. I will look into this.</p><p>As far as the capture file goes, I'm using Wireshark version 1.8.0.</p></div><div id="comment-12275-info" class="comment-info"><span class="comment-age">(28 Jun '12, 08:39)</span> <span class="comment-user userinfo">tcoder</span></div></div><span id="12282"></span><div id="comment-12282" class="comment"><div id="post-12282-score" class="comment-score"></div><div class="comment-text"><p>Let's walk through it:</p><p><strong>Frame #1:</strong></p><p>Src IP: 192.168.5.103 :: Client<br />
Dst IP: 207.25.252.200 :: Internet server</p><p>Src MAC: Ibm_24:4c:f4 (00:0d:60:24:4c:f4) :: Client<br />
Dst MAC: Netgear_51:c0:54 (e0:91:f5:51:c0:54) :: Router</p><p>That's all O.K.</p><p><strong>Frame #2:</strong></p><p>Src IP: 207.25.252.200 :: Internet server<br />
Dst IP: 192.168.5.103 :: Client</p><p>Src MAC: Netgear_51:c0:54 (e0:91:f5:51:c0:54) :: Router<br />
Dst MAC: Ibm_24:4c:f4 (00:0d:60:24:4c:f4) :: Client</p><p>That's all O.K.</p><p><strong>Frame #3:</strong></p><p>Src IP: 207.25.252.200 :: Internet server<br />
Dst IP: 192.168.5.103 :: Client</p><p>Src MAC: <strong>PcPartne_31:0c:a6 (00:01:2e:31:0c:a6)</strong> :: <strong>Server</strong><br />
Dst MAC: Ibm_24:4c:f4 (00:0d:60:24:4c:f4) :: Client</p><p>That's NOT O.K. How comes your <strong>server</strong> (192.168.5.104) is involved here? It should not interfere with a connection between an internal client and a system on the internet.</p><p>Without further information, it's hard to understand what's going on. If you look at the capture file, you will see a lot of packets with the MAC address of the server, but with a different IP address.</p><ul><li>What is the OS of your server?<br />
</li><li>You said, that the server has several interfaces. What is the output of: ifconfig -a (Linux) or ipconfig /all (Windows)?</li><li>What is the default route on your clients (according to the capture file it should be the netgear router).</li><li>Do you mirror traffic (on a switch) to the interfaces of the server? Maybe it just forwards those mirrored packets !??!</li><li>Where did you capture the traffic? Client, Server, different PC?</li></ul></div><div id="comment-12282-info" class="comment-info"><span class="comment-age">(28 Jun '12, 11:17)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="12283"></span><div id="comment-12283" class="comment not_top_scorer"><div id="post-12283-score" class="comment-score"></div><div class="comment-text"><p>The OS is WindowsXP</p><p>Windows IP Configuration</p><pre><code>    Host Name . . . . . . . . . . . . : pds-1
    Primary Dns Suffix  . . . . . . . :
    Node Type . . . . . . . . . . . . : Unknown
    IP Routing Enabled. . . . . . . . : No
    WINS Proxy Enabled. . . . . . . . : No
    DNS Suffix Search List. . . . . . : netgear.com</code></pre></div><div id="comment-12283-info" class="comment-info"><span class="comment-age">(28 Jun '12, 11:26)</span> <span class="comment-user userinfo">tcoder</span></div></div><span id="12284"></span><div id="comment-12284" class="comment not_top_scorer"><div id="post-12284-score" class="comment-score"></div><div class="comment-text"><p>I can't get the rest of the ipconfig /all on here because there is not enough characters allotted.</p><p>The default route is through the Netgear router. I'm not mirroring traffic.</p><p>I just found that 00:01:2E:31:0C:A6 IP = 192.168.5.10 is my monitoring PC. How can I stop it from being a part of the trace?</p><p>I can't trace from the HMC as it is a Linux OS and you can't break into the form and execute other programs. It's totally locked from running terminal commands.</p></div><div id="comment-12284-info" class="comment-info"><span class="comment-age">(28 Jun '12, 11:52)</span> <span class="comment-user userinfo">tcoder</span></div></div><span id="12286"></span><div id="comment-12286" class="comment not_top_scorer"><div id="post-12286-score" class="comment-score"></div><div class="comment-text"><p>I have the HMC, server and my monitoring PC connected to a Netgear hub. The hub output goes to the Netgear router model FVS318G. The reason for the hub is so I can monitor the traffic. If I connected them directly to the router, I couldn't see the traffic. It looks like most tcp packets get resent.</p><p>Could the hub be causing the problem?</p></div><div id="comment-12286-info" class="comment-info"><span class="comment-age">(28 Jun '12, 12:01)</span> <span class="comment-user userinfo">tcoder</span></div></div><span id="12288"></span><div id="comment-12288" class="comment not_top_scorer"><div id="post-12288-score" class="comment-score"></div><div class="comment-text"><blockquote><p>I just found that 00:01:2E:31:0C:A6 IP = 192.168.5.10 is my monitoring PC</p></blockquote><p>Did'nt you say it's the server?</p><blockquote><p>I can't get the rest of the ipconfig /all on here because there is not enough characters allotted.</p></blockquote><p>Post it as an answer. I will convert it to a comment. Please post the output of <code>ipconfig /all</code> on the capturing PC.</p><p>If the monitoring PC is a Windows system, disable the TCP/IP binding on the adpater where you are capturing. Open the properties of your LAN adapter and uncheck the TCP/IP binding. You can still capture on that interface, but it will not interact with the network.</p></div><div id="comment-12288-info" class="comment-info"><span class="comment-age">(28 Jun '12, 13:47)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="12289"></span><div id="comment-12289" class="comment not_top_scorer"><div id="post-12289-score" class="comment-score"></div><div class="comment-text"><p>I realized that I gave you wrong info for the server IP and MAC address. I had the server PC on TeamViewer and didn't realize that I was actually looking at my PC. What it should have been is: Server MAC 00:01:2E:2C:D0:5C IP = 192.168.5.104 and my PC MAC 00:01:2E:31:0C:A6 IP = 192.168.5.10 (monitoring PC). I'm sorry for the bad info.</p></div><div id="comment-12289-info" class="comment-info"><span class="comment-age">(28 Jun '12, 13:55)</span> <span class="comment-user userinfo">tcoder</span></div></div><span id="12290"></span><div id="comment-12290" class="comment not_top_scorer"><div id="post-12290-score" class="comment-score"></div><div class="comment-text"><p>can you please ping the following systems from your client (192.168.5.103) and the post the output of <code>arp -a</code></p><ul><li>192.168.5.104</li><li>192.168.5.10</li></ul></div><div id="comment-12290-info" class="comment-info"><span class="comment-age">(28 Jun '12, 13:56)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="12291"></span><div id="comment-12291" class="comment not_top_scorer"><div id="post-12291-score" class="comment-score"></div><div class="comment-text"><blockquote><p>I'm sorry for the bad info.</p></blockquote><p>never mind. I don't need the output of <code>arp -a</code> anymore.</p><p>BTW: Does your capturing PC have two interfaces as well? If so, what's the value of <code>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Tcpip\Parameters\IPEnableRouter</code>?</p></div><div id="comment-12291-info" class="comment-info"><span class="comment-age">(28 Jun '12, 13:57)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="12293"></span><div id="comment-12293" class="comment not_top_scorer"><div id="post-12293-score" class="comment-score"></div><div class="comment-text"><p>Yes, it has the motherboard connection (192.168.5.10) and a wireless connection (192.168.1.11). It's also running Windows7.</p><p>The value of IPEnableRouter does not exist. The possible values are Adapters, DNSRegisteredAdapters, Interfaces, PersistentRoutes and Winsock.</p><p>As for pinging from the client of 192.168.5.103, I can't because I can't break into the program. It's running Linux and they made it so no one could get out of the program. I can however, boot up KNOPPIX and do it from there.</p></div><div id="comment-12293-info" class="comment-info"><span class="comment-age">(28 Jun '12, 14:56)</span> <span class="comment-user userinfo">tcoder</span></div></div><span id="12294"></span><div id="comment-12294" class="comment not_top_scorer"><div id="post-12294-score" class="comment-score"></div><div class="comment-text"><p>Here is the arp command from the monitoring PC Interface: 192.168.5.10 --- 0xa Internet Address Physical Address Type 192.168.5.1 e0-91-f5-51-c0-54 dynamic 192.168.5.100 00-90-a9-5e-c2-c8 dynamic 192.168.5.101 c4-3d-c7-98-2a-12 dynamic 192.168.5.103 00-0d-60-24-23-a9 dynamic 192.168.5.104 00-01-2e-2c-d0-5c dynamic 192.168.5.255 ff-ff-ff-ff-ff-ff static</p></div><div id="comment-12294-info" class="comment-info"><span class="comment-age">(28 Jun '12, 14:59)</span> <span class="comment-user userinfo">tcoder</span></div></div><span id="12295"></span><div id="comment-12295" class="comment not_top_scorer"><div id="post-12295-score" class="comment-score"></div><div class="comment-text"><p>Interface: 192.168.1.11 --- 0x18 Internet Address Physical Address Type 192.168.1.1 c4-3d-c7-98-2a-11 dynamic 192.168.1.6 00-26-ab-89-b1-36 dynamic 192.168.1.7 2c-81-58-f1-33-51 dynamic 192.168.1.12 00-12-7b-4c-f1-8b dynamic 192.168.1.14 c0-cb-38-67-98-26 dynamic 192.168.1.16 00-0d-4b-63-10-f3 dynamic 192.168.1.19 5c-d9-98-04-20-93 dynamic 192.168.1.255 ff-ff-ff-ff-ff-ff static</p></div><div id="comment-12295-info" class="comment-info"><span class="comment-age">(28 Jun '12, 15:00)</span> <span class="comment-user userinfo">tcoder</span></div></div><span id="12297"></span><div id="comment-12297" class="comment not_top_scorer"><div id="post-12297-score" class="comment-score"></div><div class="comment-text"><pre><code>Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\Users\Terry&gt;ipconfig /all

Windows IP Configuration

   Host Name . . . . . . . . . . . . : TERRY-DESKTOP
   Primary Dns Suffix  . . . . . . . :
   Node Type . . . . . . . . . . . . : Hybrid
   IP Routing Enabled. . . . . . . . : Yes  &lt;&lt;===== HERE !!
   WINS Proxy Enabled. . . . . . . . : No</code></pre></div><div id="comment-12297-info" class="comment-info"><span class="comment-age">(28 Jun '12, 18:47)</span> <span class="comment-user userinfo">tcoder</span></div></div><span id="12300"></span><div id="comment-12300" class="comment not_top_scorer"><div id="post-12300-score" class="comment-score"></div><div class="comment-text"><p>As you can see, IP Routing is enabled on your machine. I believe your sniffer PC forwards the packets it sees in promicuous mode (capturing mode), as it 'thinks' it is a router. I wonder why the registry value does not exist on that system!??! Please check again. Search for 'IPEnableRouter' in regedit.</p><p>Anyway, this makes all sense now. Simple solution: Disable the TCP/IP bindings on the LAN adapter and capture again. You should not see duplicate packets.</p></div><div id="comment-12300-info" class="comment-info"><span class="comment-age">(28 Jun '12, 23:11)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div></div><div id="comment-tools-12244" class="comment-tools"><span class="comments-showing"> showing 5 of 17 </span> <a href="#" class="show-all-comments-link">show 12 more comments</a></div><div class="clear"></div><div id="comment-12244-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="12315"></span>

<div id="answer-container-12315" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-12315-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-12315-score" class="post-score" title="current number of votes">0</div><span id="post-12315-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>Every packet from the server is sent twice, once through the router and once direct. If you select all the directly sent packets (filter: eth.src == 00:01:2e:31:0c:a6) and then Ignore them from dissection (Edit -&gt; Ignore All Displayed Packets), then Wireshark is able to dissect the SSL traffic perfectly.</p><p>Wireshark does not handle SSL reassembly well when there are retransmissions (or "duplicates" as in this tracefle.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>29 Jun '12, 08:06</strong></p><img src="https://secure.gravatar.com/avatar/7901a94d8fdd1f9f47cda9a32fcfa177?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="SYN-bit&#39;s gravatar image" /><p><span>SYN-bit ♦♦</span><br />
<span class="score" title="17094 reputation points"><span>17.1k</span></span><span title="9 badges"><span class="badge1">●</span><span class="badgecount">9</span></span><span title="57 badges"><span class="silver">●</span><span class="badgecount">57</span></span><span title="245 badges"><span class="bronze">●</span><span class="badgecount">245</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="SYN-bit has 174 accepted answers">20%</span> </br></br></p></div></div><div id="comments-container-12315" class="comments-container"><span id="12317"></span><div id="comment-12317" class="comment"><div id="post-12317-score" class="comment-score"></div><div class="comment-text"><p>How do I get rid of the duplicate packets? They're coming from the monitoring PC running Wireshark.</p></div><div id="comment-12317-info" class="comment-info"><span class="comment-age">(29 Jun '12, 08:13)</span> <span class="comment-user userinfo">tcoder</span></div></div><span id="12326"></span><div id="comment-12326" class="comment"><div id="post-12326-score" class="comment-score"></div><div class="comment-text"><p>see the solution in my answer ;-) However, ignoring the packets is a good one! I did not try that :-)</p></div><div id="comment-12326-info" class="comment-info"><span class="comment-age">(29 Jun '12, 09:22)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="12327"></span><div id="comment-12327" class="comment"><div id="post-12327-score" class="comment-score"></div><div class="comment-text"><blockquote><p>How do I get rid of the duplicate packets? They're coming from the monitoring PC running Wireshark.</p></blockquote><p>As I said, don't capture from a PC that has IP Forwarding enabled. Solution for that: Disable IP Forwarding or disable TCP/IP binding on the capturing interface.</p></div><div id="comment-12327-info" class="comment-info"><span class="comment-age">(29 Jun '12, 09:25)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div></div><div id="comment-tools-12315" class="comment-tools"></div><div class="clear"></div><div id="comment-12315-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

