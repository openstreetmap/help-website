+++
type = "question"
title = "Self compiled Wireshark does not start"
description = '''Hello, I built Wirehark with the newest source (wireshark-1.12.3), there are no errors or warnings, but it does not open. (Using the Wireshark.exe in wireshark-gtk2.) No error message shows up, also there is no wireshark process running. Thankfully lal12'''
date = "2015-01-13T11:11:00Z"
lastmod = "2015-01-17T10:31:00Z"
weight = 39099
keywords = [ "start", "build" ]
aliases = [ "/questions/39099" ]
osqa_answers = 1
osqa_accepted = true
+++

<div class="headNormal">

# [Self compiled Wireshark does not start](/questions/39099/self-compiled-wireshark-does-not-start)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-39099-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-39099-score" class="post-score" title="current number of votes">0</div><span id="post-39099-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hello,</p><p>I built Wirehark with the newest source (wireshark-1.12.3), there are no errors or warnings, but it does not open. (Using the Wireshark.exe in wireshark-gtk2.) No error message shows up, also there is no wireshark process running.</p><p>Thankfully lal12</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-start" rel="tag" title="see questions tagged &#39;start&#39;">start</span> <span class="post-tag tag-link-build" rel="tag" title="see questions tagged &#39;build&#39;">build</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>13 Jan '15, 11:11</strong></p><img src="https://secure.gravatar.com/avatar/cc56ba9bd225bd68cea09a404ecc0b6e?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="lal12&#39;s gravatar image" /><p><span>lal12</span><br />
<span class="score" title="36 reputation points">36</span><span title="7 badges"><span class="badge1">●</span><span class="badgecount">7</span></span><span title="7 badges"><span class="silver">●</span><span class="badgecount">7</span></span><span title="12 badges"><span class="bronze">●</span><span class="badgecount">12</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="lal12 has 2 accepted answers">33%</span></p></div></div><div id="comments-container-39099" class="comments-container"><span id="39103"></span><div id="comment-39103" class="comment"><div id="post-39103-score" class="comment-score"></div><div class="comment-text"><p>Did you get your sources using git or some other means?</p></div><div id="comment-39103-info" class="comment-info"><span class="comment-age">(13 Jan '15, 14:39)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="39109"></span><div id="comment-39109" class="comment"><div id="post-39109-score" class="comment-score"></div><div class="comment-text"><p>I download the sources as .tar.gz from the website.</p></div><div id="comment-39109-info" class="comment-info"><span class="comment-age">(13 Jan '15, 21:34)</span> <span class="comment-user userinfo">lal12</span></div></div><span id="39124"></span><div id="comment-39124" class="comment"><div id="post-39124-score" class="comment-score"></div><div class="comment-text"><p>And what OS and build system are you using?</p></div><div id="comment-39124-info" class="comment-info"><span class="comment-age">(14 Jan '15, 03:12)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="39125"></span><div id="comment-39125" class="comment"><div id="post-39125-score" class="comment-score"></div><div class="comment-text"><p>I am using Windows 8.1 and a 64bit environment as described in <a href="https://www.wireshark.org/docs/wsdg_html_chunked/ChSetupWin32.html">https://www.wireshark.org/docs/wsdg_html_chunked/ChSetupWin32.html</a></p></div><div id="comment-39125-info" class="comment-info"><span class="comment-age">(14 Jan '15, 06:17)</span> <span class="comment-user userinfo">lal12</span></div></div><span id="39129"></span><div id="comment-39129" class="comment"><div id="post-39129-score" class="comment-score"></div><div class="comment-text"><p>I just compiled up the source from the .tar.gz using VS2013 to make an x64 copy of wireshark and it started OK.</p><p>So, something up with your build. Can you post a listing of the wireshark-gtk2 directory?</p></div><div id="comment-39129-info" class="comment-info"><span class="comment-age">(14 Jan '15, 10:34)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="39130"></span><div id="comment-39130" class="comment not_top_scorer"><div id="post-39130-score" class="comment-score"></div><div class="comment-text"><p>I recommend running <code>nmake -f Makefile.nmake distclean</code> first before running <code>nmake -f Makefile.nmake all</code>.</p></div><div id="comment-39130-info" class="comment-info"><span class="comment-age">(14 Jan '15, 10:54)</span> <span class="comment-user userinfo">cmaynard ♦♦</span></div></div><span id="39132"></span><div id="comment-39132" class="comment not_top_scorer"><div id="post-39132-score" class="comment-score"></div><div class="comment-text"><p>I just used nmake without a target and it built without an issue.</p></div><div id="comment-39132-info" class="comment-info"><span class="comment-age">(14 Jan '15, 13:26)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="39201"></span><div id="comment-39201" class="comment not_top_scorer"><div id="post-39201-score" class="comment-score"></div><div class="comment-text"><p>I already did nmake -f Makefile.nmake distclean before, I uploaded my wireshark-gtk2 folder here: <a href="http://lucalindhorst.de/wireshark-gtk2.zip">http://lucalindhorst.de/wireshark-gtk2.zip</a></p></div><div id="comment-39201-info" class="comment-info"><span class="comment-age">(16 Jan '15, 04:59)</span> <span class="comment-user userinfo">lal12</span></div></div><span id="39203"></span><div id="comment-39203" class="comment not_top_scorer"><div id="post-39203-score" class="comment-score"></div><div class="comment-text"><p>Your build starts without any issue on my PC, so this seems really related to your PC. You might look at the Windows Event Viewer to see if any error is reported, or deactivate temporarily your antivirus software and see if it helps.</p></div><div id="comment-39203-info" class="comment-info"><span class="comment-age">(16 Jan '15, 06:30)</span> <span class="comment-user userinfo">Pascal Quantin</span></div></div><span id="39212"></span><div id="comment-39212" class="comment not_top_scorer"><div id="post-39212-score" class="comment-score"></div><div class="comment-text"><p>Just throwing this out there, but is it possible that there's a problem with one or more preferences? Maybe try to remove all preferences and start Wireshark in a pristine state?</p></div><div id="comment-39212-info" class="comment-info"><span class="comment-age">(16 Jan '15, 08:28)</span> <span class="comment-user userinfo">cmaynard ♦♦</span></div></div></div><div id="comment-tools-39099" class="comment-tools"><span class="comments-showing"> showing 5 of 10 </span> <a href="#" class="show-all-comments-link">show 5 more comments</a></div><div class="clear"></div><div id="comment-39099-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="39204"></span>

<div id="answer-container-39204" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-39204-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-39204-score" class="post-score" title="current number of votes">1</div><span id="post-39204-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span class="accept-answer on" rel="nofollow" title="lal12 has selected this answer as the correct answer"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>I examined the build in your zip file using the VS2013 debugger creating an exe solution. It crashed in glib. I then suspected incompatible libries and used <a href="http://www.dependencywalker.com/">Dependency Walker</a> to look at what is loaded with Wireshark.exe.</p><p>The version of Lua you have in lua52.dll was built with VS2010 and is loading msvcr100.dll. The other components of your build (built with VS2013 RTM, which you should really update to Update 4) as expected load msvcr120.dll. Mixing the two MSVC runtimes is not permitted.</p><p>There's a bug in the 1.2.3 sources that don't correctly define the version of lua to use with VS2013, hence the automagic download pulled in the 2010 version of lua.</p><p>So your options are:</p><ol><li>Fix config.nmake to use the correct version of lua for VS2013 (basically copy the corresponding part from the current master version), see code below, and then run <code>nmake -f Makefile.nmake setup</code> to download the correct version of lua.</li><li>Disable lua in your build (comment out setting of LUA_DIR in config.nmake).</li><li>Build with VS2012 or earlier.</li><li>Switch to building from master (1.99.x) which does build with VS2013.</li></ol><p>Config.nmake changes to support lua in 1.12.x when building with VS2013 (note this is the x64 bit, there is similar for x86):</p><pre><code>!IF &quot;$(MSVC_VARIANT)&quot; == &quot;MSVC2013&quot; ||  &quot;$(MSVC_VARIANT)&quot; == &quot;MSVC2013EE&quot;
LUA_DIST=-5.2.3_Win64_dll12
!ELSEIF &quot;$(MSVC_VARIANT)&quot; == &quot;MSVC2012&quot; ||  &quot;$(MSVC_VARIANT)&quot; == &quot;MSVC2012EE&quot;
LUA_DIST=-5.2.3_Win64_dll11
!ELSE
LUA_DIST=-5.2.3_Win64_dll10
!ENDIF
LUA_DIR=$(WIRESHARK_LIB_DIR)\lua5.2.3</code></pre></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>16 Jan '15, 06:39</strong></p><img src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="grahamb&#39;s gravatar image" /><p><span>grahamb ♦</span><br />
<span class="score" title="19834 reputation points"><span>19.8k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">●</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">●</span><span class="badgecount">206</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="grahamb has 274 accepted answers">22%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>16 Jan '15, 06:45</strong> </span></p></div></div><div id="comments-container-39204" class="comments-container"><span id="39207"></span><div id="comment-39207" class="comment"><div id="post-39207-score" class="comment-score"></div><div class="comment-text"><p>Another possibility could be to install the MSVC2010 Redistributable, right?</p><p>The MSVC2013 Lua DLL is not part of the 1.12.X source tree because I added it after 1.12 branch creation. As the official release is built with MSVC2010, I (maybe wrongly) did not consider this as a bug and did not backport it.</p></div><div id="comment-39207-info" class="comment-info"><span class="comment-age">(16 Jan '15, 07:02)</span> <span class="comment-user userinfo">Pascal Quantin</span></div></div><span id="39210"></span><div id="comment-39210" class="comment"><div id="post-39210-score" class="comment-score"></div><div class="comment-text"><p>It's not the redistributable, it's because the process loads up both versions and they are incompatible. If the redistributable wasn't present the process would refuse to start complaining about the missing DLL.</p><p>The fix to config.nmake is very simple (required in 2 places though, for x86 &amp; x64) and probably should be done.</p></div><div id="comment-39210-info" class="comment-info"><span class="comment-age">(16 Jan '15, 07:30)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="39211"></span><div id="comment-39211" class="comment"><div id="post-39211-score" class="comment-score"></div><div class="comment-text"><p>I updated as you recommended to Update 4, run setup and distclean and builded again. But still the same problem, Wireshark doesn't start. I will debug it myself later, maybe I find the problem. If not I will upload it again.</p></div><div id="comment-39211-info" class="comment-info"><span class="comment-age">(16 Jan '15, 08:23)</span> <span class="comment-user userinfo">lal12</span></div></div><span id="39214"></span><div id="comment-39214" class="comment"><div id="post-39214-score" class="comment-score"></div><div class="comment-text"><p>You need to fix config.nmake and then run the 'setup' step as I've described above so that the correct version of lua for VS2013 will be downloaded and used.</p></div><div id="comment-39214-info" class="comment-info"><span class="comment-age">(16 Jan '15, 09:56)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="39230"></span><div id="comment-39230" class="comment"><div id="post-39230-score" class="comment-score"></div><div class="comment-text"><p>Sorry, forgot to mention it, but of course I changed the config.nmake before.</p></div><div id="comment-39230-info" class="comment-info"><span class="comment-age">(17 Jan '15, 01:55)</span> <span class="comment-user userinfo">lal12</span></div></div><span id="39231"></span><div id="comment-39231" class="comment not_top_scorer"><div id="post-39231-score" class="comment-score"></div><div class="comment-text"><p>I uploaded it again: <a href="http://lucalindhorst.de/wireshark-gtk2_v2.zip">http://lucalindhorst.de/wireshark-gtk2_v2.zip</a></p></div><div id="comment-39231-info" class="comment-info"><span class="comment-age">(17 Jan '15, 02:24)</span> <span class="comment-user userinfo">lal12</span></div></div><span id="39232"></span><div id="comment-39232" class="comment not_top_scorer"><div id="post-39232-score" class="comment-score"></div><div class="comment-text"><p>Do you have (in the wireshark-win64-libs directory) lua-5.2.3_Win64_dll12_lib.zib? If not then you haven't got the correct version of lua.</p></div><div id="comment-39232-info" class="comment-info"><span class="comment-age">(17 Jan '15, 02:45)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="39233"></span><div id="comment-39233" class="comment not_top_scorer"><div id="post-39233-score" class="comment-score"></div><div class="comment-text"><p>I downloaded your zip and lua looks OK, but it still crashes in a call into libgobject.</p><p>The call stack:</p><pre><code>libgobject-2.0-0.dll!0000000075b9562b() Unknown
libgobject-2.0-0.dll!0000000075b804c6() Unknown
libgobject-2.0-0.dll!0000000075b84367() Unknown
libgdk-win32-2.0-0.dll!00000000511744d3()   Unknown
libgobject-2.0-0.dll!0000000075b92927() Unknown
libgobject-2.0-0.dll!0000000075b7c2ce() Unknown
libgobject-2.0-0.dll!0000000075b7c862() Unknown
libgdk-win32-2.0-0.dll!00000000511746e4()   Unknown
libgtk-win32-2.0-0.dll!000000007467e8a3()   Unknown
libgtk-win32-2.0-0.dll!000000007466563c()   Unknown
libglib-2.0-0.dll!000000005126b5d7()    Unknown
libgtk-win32-2.0-0.dll!0000000074665a8b()   Unknown
libgtk-win32-2.0-0.dll!0000000074665ae9()   Unknown
libgtk-win32-2.0-0.dll!0000000074665b19()   Unknown
Wireshark.exe!main(int argc, char * * argv) Line 2444   C
Wireshark.exe!WinMain(HINSTANCE__ * hInstance, HINSTANCE__ * hPrevInstance, char * lpszCmdLine, int nCmdShow) Line 3347 C</code></pre><p>This requires some more work to debug. Having the pdb's for GTK would give function names, but as GTK for Windows is compiled with MinGW it appears that they aren't available. Yet another reason to drop GTK.</p><p>For now I can only suggest that you delete the entire contents of wireshark-win64-libs, delete your build directory and start with a fresh copy of the sources. There is something in your environment that isn't correct but I can't see what it is yet.</p></div><div id="comment-39233-info" class="comment-info"><span class="comment-age">(17 Jan '15, 02:57)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="39234"></span><div id="comment-39234" class="comment not_top_scorer"><div id="post-39234-score" class="comment-score"></div><div class="comment-text"><p>The "lua-5.2.3_Win64_dll12_lib.zip" file is in the lib folder.</p></div><div id="comment-39234-info" class="comment-info"><span class="comment-age">(17 Jan '15, 10:31)</span> <span class="comment-user userinfo">lal12</span></div></div></div><div id="comment-tools-39204" class="comment-tools"><span class="comments-showing"> showing 5 of 9 </span> <a href="#" class="show-all-comments-link">show 4 more comments</a></div><div class="clear"></div><div id="comment-39204-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

