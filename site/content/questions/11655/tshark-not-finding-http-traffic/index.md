+++
type = "question"
title = "TShark not finding http traffic"
description = '''Hi. I&#x27;m new to Wireshark, so be warned that this is a newbie question. I&#x27;m using Wireshark on an Ubuntu server, and have enabled dumpcap to collect raw data and store to files: /usr/bin/dumpcap -i eth1 -w /var/tracefiles/eth1.pcap -b duration:3600 When trying to analyze the files produced, I would f...'''
date = "2012-06-05T03:35:00Z"
lastmod = "2012-06-05T15:25:00Z"
weight = 11655
keywords = [ "tshark" ]
aliases = [ "/questions/11655" ]
osqa_answers = 2
osqa_accepted = false
+++

<div class="headNormal">

# [TShark not finding http traffic](/questions/11655/tshark-not-finding-http-traffic)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-11655-score" class="post-score" title="current number of votes">0</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hi.</p><p>I'm new to Wireshark, so be warned that this is a newbie question.</p><p>I'm using Wireshark on an Ubuntu server, and have enabled dumpcap to collect raw data and store to files:</p><p><code>/usr/bin/dumpcap -i eth1 -w /var/tracefiles/eth1.pcap -b duration:3600</code></p><p>When trying to analyze the files produced, I would for instance like to see http requests and the resulting status code. I think I have found an example on how to do this on <a href="http://www.codealias.info/technotes/the_tshark_capture_and_filter_example_page">1</a>:</p><p><code>tshark -R http.response \ -z "proto,colinfo,http.content_length,http.content_length" \ -z "proto,colinfo,http.content_type,http.content_type" \ -r &lt;myfile.pcap&gt;</code></p><p>This produces nothing. I have actually tried a number of examples, but it seems I can never use any application level filters, as they produce nothing.</p><p>Anything obvious I'm missing here?</p><p>Best regards, Chocolate Eater</p></div><div id="question-tags" class="tags-container tags">tshark</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>05 Jun '12, 03:35</strong></p><img src="https://secure.gravatar.com/avatar/6362f3d15bbf00f30572a1e41f4bbcde?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Chocolate%20Eater&#39;s gravatar image" /><p>Chocolate Eater<br />
<span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Chocolate Eater has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 05 Jun '12, 16:04</p><img src="https://secure.gravatar.com/avatar/362ba1008ad9a075d1556d33e97dfed6?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="helloworld&#39;s gravatar image" /><p>helloworld<br />
<span class="score" title="3149 reputation points"><span>3.1k</span></span><span title="4 badges"><span class="badge1">●</span><span class="badgecount">4</span></span><span title="20 badges"><span class="silver">●</span><span class="badgecount">20</span></span><span title="41 badges"><span class="bronze">●</span><span class="badgecount">41</span></span></p></div></div><div id="comments-container-11655" class="comments-container"><span id="11659"></span><div id="comment-11659" class="comment"><div id="post-11659-score" class="comment-score"></div><div class="comment-text"><p>Couple of questions:</p><ol><li>Are you sure your capture contains http responses?</li><li>What is the version of tshark you are using?</li></ol></div><div id="comment-11659-info" class="comment-info"><span class="comment-age">(05 Jun '12, 04:28)</span> grahamb ♦</div></div><span id="11662"></span><div id="comment-11662" class="comment"><div id="post-11662-score" class="comment-score"></div><div class="comment-text"><p>Hi, Grahamb.</p><ol><li>Not exactly. The packets coming in on eth1 is from a span containing tx and rx packets, in other words everything. Do I need to set any specific options on dumpcap? This is from a dump of one of the pcaps:</li></ol><p>3516 13.944675 207.x.x.x -&gt; 192.168.20.101 TCP 1506 http &gt; 57010 [ACK] Seq=1765050 Ack=1 Win=64912 Len=1452 3517 13.944724 192.168.20.101 -&gt; 207.x.x.x TCP 60 57010 &gt; http [ACK] Seq=1 Ack=1765050 Win=65340 Len=0</p><p>Don't know if it's relevant. Goes on and on.</p><ol><li>Version 1.6.7.</li></ol></div><div id="comment-11662-info" class="comment-info"><span class="comment-age">(05 Jun '12, 04:51)</span> Chocolate Eater</div></div><span id="11664"></span><div id="comment-11664" class="comment"><div id="post-11664-score" class="comment-score"></div><div class="comment-text"><p>re Q1, I'm trying to confirm the capture actually has the data you're looking for, i.e. http responses, as the <code>-R http.response</code> part of the command is a filter that will only use packets that contain an http.response field.</p><p>The command string works fine for me on trunk (1.7.2) on a capture with http responses in it.</p></div><div id="comment-11664-info" class="comment-info"><span class="comment-age">(05 Jun '12, 05:01)</span> grahamb ♦</div></div><span id="11676"></span><div id="comment-11676" class="comment"><div id="post-11676-score" class="comment-score"></div><div class="comment-text"><p>I fired up wireshark with the exact same file as I tried parsing with tshark. I can actually see that it lists an HTTP/1.1 200 OK (text/html), and I can also browse into the details on it.</p><p>Could there be something with tshark? Maybe I should go ahead and try the trunk version.</p></div><div id="comment-11676-info" class="comment-info"><span class="comment-age">(05 Jun '12, 12:11)</span> Chocolate Eater</div></div><span id="11679"></span><div id="comment-11679" class="comment"><div id="post-11679-score" class="comment-score"></div><div class="comment-text"><p>Try removing the <code>-z options</code> to check you can see the http response codes.</p></div><div id="comment-11679-info" class="comment-info"><span class="comment-age">(05 Jun '12, 12:40)</span> grahamb ♦</div></div><span id="11680"></span><div id="comment-11680" class="comment not_top_scorer"><div id="post-11680-score" class="comment-score"></div><div class="comment-text"><p>Ran this command:</p><p>tshark -r eth1_00258_20120605185617.pcap -R http.response</p><p>No output...</p></div><div id="comment-11680-info" class="comment-info"><span class="comment-age">(05 Jun '12, 12:44)</span> Chocolate Eater</div></div><span id="11686"></span><div id="comment-11686" class="comment not_top_scorer"><div id="post-11686-score" class="comment-score"></div><div class="comment-text"><p>I can't think what's wrong here unless your capture really doesn't have any http responses. If the capture doesn't contain sensitive info can you post the capture on <a href="http://www.cloudshark.org/">CloudShark</a> and give us a link to it?</p></div><div id="comment-11686-info" class="comment-info"><span class="comment-age">(05 Jun '12, 13:33)</span> grahamb ♦</div></div><span id="11687"></span><div id="comment-11687" class="comment not_top_scorer"><div id="post-11687-score" class="comment-score"></div><div class="comment-text"><p>I really appreciate you helping, grahamb.</p><p>The file is unfortunately quite large, and may contain some sensitive data. If I could e-mail you a link though, I can make the file available for download from one of my web servers.</p></div><div id="comment-11687-info" class="comment-info"><span class="comment-age">(05 Jun '12, 14:26)</span> Chocolate Eater</div></div></div><div id="comment-tools-11655" class="comment-tools"><span class="comments-showing"> showing 5 of 8 </span> <a href="#" class="show-all-comments-link">show 3 more comments</a></div><div class="clear"></div><div id="comment-11655-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

2 Answers:

</div>

</div>

<span id="11690"></span>

<div id="answer-container-11690" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-11690-score" class="post-score" title="current number of votes">1</div></div></td><td><div class="item-right"><div class="answer-body"><p>One thing that might be causing these troubles is that somehow the reassembly of the HTTP PDU's is not working (this might happen when using a snap length). If Wireshark (or Tshark) has reassembly enabled, sees part of the HTTP protocol, but is not able to reconstruct the full PDU's, then all data will be listed as "[TCP segment of a reassembled PDU]" and all the HTTP filters won't work.</p><p>You may try the following to check whether the HTTP responses are indeed recognized without reassembly enabled:</p><pre><code>tshark -r &lt;file&gt; -o tcp.desegment_tcp_streams:FALSE -R http.response</code></pre><p>If this command does show output, then we need to find out why reassembly is failing in your case...</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>05 Jun '12, 15:25</strong></p><img src="https://secure.gravatar.com/avatar/7901a94d8fdd1f9f47cda9a32fcfa177?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="SYN-bit&#39;s gravatar image" /><p>SYN-bit ♦♦<br />
<span class="score" title="17094 reputation points"><span>17.1k</span></span><span title="9 badges"><span class="badge1">●</span><span class="badgecount">9</span></span><span title="57 badges"><span class="silver">●</span><span class="badgecount">57</span></span><span title="245 badges"><span class="bronze">●</span><span class="badgecount">245</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="SYN-bit has 174 accepted answers">20%</span></p></div></div><div id="comments-container-11690" class="comments-container"><span id="11707"></span><div id="comment-11707" class="comment"><div id="post-11707-score" class="comment-score"></div><div class="comment-text"><p>The OP reported teh captures being made with:</p><p><code>/usr/bin/dumpcap -i eth1 -w /var/tracefiles/eth1.pcap -b duration:3600</code></p><p>Would that have a reduced snaplen?</p></div><div id="comment-11707-info" class="comment-info"><span class="comment-age">(05 Jun '12, 23:43)</span> grahamb ♦</div></div><span id="11738"></span><div id="comment-11738" class="comment"><div id="post-11738-score" class="comment-score"></div><div class="comment-text"><p>@Graham, AFAIK dumpcap uses snaplength 0, so with the mentioned command all data should be there. But there are other causes for reassembly to fail, I just mentioned snaplength as a possible cause :-)</p></div><div id="comment-11738-info" class="comment-info"><span class="comment-age">(07 Jun '12, 04:51)</span> SYN-bit ♦♦</div></div></div><div id="comment-tools-11690" class="comment-tools"></div><div class="clear"></div><div id="comment-11690-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="11667"></span>

<div id="answer-container-11667" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-11667-score" class="post-score" title="current number of votes">0</div></div></td><td><div class="item-right"><div class="answer-body"><p>May be you wana try this.</p><p>tshark.exe -r capturee.pcap -T fields -e http.request.method -e http.response.code &gt; <a href="http://test.txt">test.txt</a></p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>05 Jun '12, 06:39</strong></p><img src="https://secure.gravatar.com/avatar/a8aa1b50bd4e70fe64d8c9612d100eb4?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Deepak&#39;s gravatar image" /><p>Deepak<br />
<span class="score" title="31 reputation points">31</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="5 badges"><span class="bronze">●</span><span class="badgecount">5</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Deepak has one accepted answer">25%</span></p></div></div><div id="comments-container-11667" class="comments-container"><span id="11675"></span><div id="comment-11675" class="comment"><div id="post-11675-score" class="comment-score"></div><div class="comment-text"><p>This actually produces a large, blank file. It contains only line breaks, as far as I can see.</p></div><div id="comment-11675-info" class="comment-info"><span class="comment-age">(05 Jun '12, 12:00)</span> Chocolate Eater</div></div></div><div id="comment-tools-11667" class="comment-tools"></div><div class="clear"></div><div id="comment-11667-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

