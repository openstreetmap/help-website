+++
type = "question"
title = "How to change openstreetmap-tiles-update-expire to use Geofabrik updates"
description = '''hi someoneelse could you tell how can i use your modified mod_tile from https://github.com/SomeoneElseOSM/mod_tile and edit the &quot;openstreetmap-tiles-update-expire&quot; file to fetch edits from download.geofabrik.de/africa/egypt-updates/ so that i can update my tile server i have tried to follow your pag...'''
date = "2018-01-14T23:01:00Z"
lastmod = "2018-01-14T23:33:00Z"
weight = 61630
keywords = [ "geofabrik", "expiry" ]
aliases = [ "/questions/61630" ]
osqa_answers = 1
osqa_accepted = false
+++

<div class="headNormal">

# [How to change openstreetmap-tiles-update-expire to use Geofabrik updates](/questions/61630/how-to-change-openstreetmap-tiles-update-expire-to-use-geofabrik-updates)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr>
<td style="width: 30px; vertical-align: top"><div class="vote-buttons">
<span id="post-61630-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span>
<div id="post-61630-score" class="post-score" title="current number of votes">
0
</div>
<span id="post-61630-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span>
<div id="favorite-count" class="favorite-count">
&#10;</div>
</div></td>
<td><div id="item-right">
<div class="question-body">
<p>hi someoneelse could you tell how can i use your modified mod_tile from <a href="https://github.com/SomeoneElseOSM/mod_tile">https://github.com/SomeoneElseOSM/mod_tile</a></p>
<p>and edit the "openstreetmap-tiles-update-expire" file to fetch edits from download.geofabrik.de/africa/egypt-updates/ so that i can update my tile server</p>
<p>i have tried to follow your page for installing tile server on ubuntu 1604, but whenever i try to update the tiles i get errors</p>
</div>
<div id="question-tags" class="tags-container tags">
<span class="post-tag tag-link-geofabrik" rel="tag" title="see questions tagged &#39;geofabrik&#39;">geofabrik</span> <span class="post-tag tag-link-expiry" rel="tag" title="see questions tagged &#39;expiry&#39;">expiry</span>
</div>
<div id="question-controls" class="post-controls">
&#10;</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p>asked <strong>14 Jan '18, 23:01</strong></p>
<img src="https://secure.gravatar.com/avatar/f8c47b3830f7447fdc5ebd166eb210c6?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="engragy&#39;s gravatar image" />
<p><span>engragy</span><br />
<span class="score" title="11 reputation points">11</span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="3 badges"><span class="silver">●</span><span class="badgecount">3</span></span><span title="5 badges"><span class="bronze">●</span><span class="badgecount">5</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="engragy has no accepted answers">0%</span></p>
</div>
<div class="post-update-info post-update-info-edited">
<p><span> converted <strong>14 Jan '18, 23:11</strong> </span></p>
<img src="https://secure.gravatar.com/avatar/0bf1aa22f7f5e045b0eb8beb79fe7907?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="SomeoneElse&#39;s gravatar image" />
<p><span>SomeoneElse ♦</span><br />
<span class="score" title="36866 reputation points"><span>36.9k</span></span><span title="71 badges"><span class="badge1">●</span><span class="badgecount">71</span></span><span title="370 badges"><span class="silver">●</span><span class="badgecount">370</span></span><span title="866 badges"><span class="bronze">●</span><span class="badgecount">866</span></span></p>
</div>
</div>
<div id="comments-container-61630" class="comments-container">
<span id="61631"></span>
<div id="comment-61631" class="comment">
<div id="post-61631-score" class="comment-score">
&#10;</div>
<div class="comment-text">
<p>This was originally a comment on <a href="https://help.openstreetmap.org/questions/60986/openstreetmap-website-production-depolyment">https://help.openstreetmap.org/questions/60986/openstreetmap-website-production-depolyment</a> but isn't really related to the original question there, so I created a new question from it.</p>
</div>
<div id="comment-61631-info" class="comment-info">
<span class="comment-age">(14 Jan '18, 23:12)</span> <span class="comment-user userinfo">SomeoneElse ♦</span>
</div>
</div>
</div>
<div id="comment-tools-61630" class="comment-tools">
&#10;</div>
<div class="clear">
&#10;</div>
<div id="comment-61630-form-container" class="comment-form-container">
&#10;</div>
<div class="clear">
&#10;</div>
</div></td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="61633"></span>

<div id="answer-container-61633" class="answer">

<table style="width:100%;">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr>
<td style="width: 30px; vertical-align: top"><div class="vote-buttons">
<span id="post-61633-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span>
<div id="post-61633-score" class="post-score" title="current number of votes">
1
</div>
<span id="post-61633-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span>
</div></td>
<td><div class="item-right">
<div class="answer-body">
<p>There are probably a couple of different reasons why you might want to apply updates from Geofabrik's Egypt updates rather than the whole planet - one is to minimise the size of the database as it grows, the other is to minimise the amount of data fetched from a remote server.</p>
<p>It's perhaps worth mentioning that if database size is the main concern, you don't need to worry since openstreetmap-tiles-update-expire <a href="https://github.com/SomeoneElseOSM/mod_tile/blob/1d243f397ae27e4aaead057f379c59546d49870e/openstreetmap-tiles-update-expire#L136">trims</a> the update being applied to just the boundaries you're interested in (you'll need to edit that line to match the latitude and longitude of Egypt).</p>
<p>Assuming you really do want to use Geofabrik's Egypt updates you'll need to edit the "baseurl" line in /var/lib/mod_tile/.osmosis/configuration.txt . That will normally look like this:</p>
<pre><code>baseUrl=https://planet.openstreetmap.org/replication/minute</code></pre>
<p>and that file is created like that by <a href="https://github.com/SomeoneElseOSM/mod_tile/blob/1d243f397ae27e4aaead057f379c59546d49870e/openstreetmap-tiles-update-expire#L98">this line</a> in the script, which calls "osmosis". You can either change osmosis to create the default differently (have a look at the parameters that osmosis supports, maybe there's an easy way of doing it) or manually change it - there's actually a line in the script that does <a href="https://github.com/SomeoneElseOSM/mod_tile/blob/1d243f397ae27e4aaead057f379c59546d49870e/openstreetmap-tiles-update-expire#L101">just that</a> in order to change the URL to use https (which is now required at osm.org), so you could modify it to use your desired location.</p>
<p>You'd then want to remove the <code>trim_osc</code> <a href="https://github.com/SomeoneElseOSM/mod_tile/blob/1d243f397ae27e4aaead057f379c59546d49870e/openstreetmap-tiles-update-expire#L136">code</a> as you no longer need to call it, and only call the resulting script once a day because that's the <a href="http://download.geofabrik.de/africa/egypt-updates/000/001/">frequency of updates</a>. You may also want to increase "maxinterval" in <code>configuration.txt</code> because you want to apply more than an hour's worth of changes at a time.</p>
<p>I haven't actually tested any of this, so I've left this answer editable to you can add in any missing steps.</p>
</div>
<div class="answer-controls post-controls">
<div class="community-wiki">
This answer is marked "community wiki".
</div>
</div>
<div class="post-update-info-container">
<div class="post-update-info post-update-info-user">
<p>answered <strong>14 Jan '18, 23:33</strong></p>
<img src="https://secure.gravatar.com/avatar/0bf1aa22f7f5e045b0eb8beb79fe7907?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="SomeoneElse&#39;s gravatar image" />
<p><span>SomeoneElse ♦</span><br />
<span class="score" title="36866 reputation points"><span>36.9k</span></span><span title="71 badges"><span class="badge1">●</span><span class="badgecount">71</span></span><span title="370 badges"><span class="silver">●</span><span class="badgecount">370</span></span><span title="866 badges"><span class="bronze">●</span><span class="badgecount">866</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="SomeoneElse has 228 accepted answers">16%</span></p>
</div>
</div>
<div id="comments-container-61633" class="comments-container">
&#10;</div>
<div id="comment-tools-61633" class="comment-tools">
&#10;</div>
<div class="clear">
&#10;</div>
<div id="comment-61633-form-container" class="comment-form-container">
&#10;</div>
<div class="clear">
&#10;</div>
</div></td>
</tr>
</tbody>
</table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

