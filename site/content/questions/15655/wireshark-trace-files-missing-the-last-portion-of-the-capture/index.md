+++
type = "question"
title = "Wireshark trace files missing the last portion of the capture"
description = '''Hi all. Big fan, and user, of the &#x27;shark, but haven&#x27;t had a need to post in quite a while... I have run into a strange problem - perhaps someone has some ideas. Here it is... I&#x27;m in the U.S., and I&#x27;m working with colleagues in India, who are running wireshark on their workstations, and sending me th...'''
date = "2012-11-07T10:25:00Z"
lastmod = "2012-11-08T05:54:00Z"
weight = 15655
keywords = [ "missing_packets" ]
aliases = [ "/questions/15655" ]
osqa_answers = 1
osqa_accepted = false
+++

<div class="headNormal">

# [Wireshark trace files missing the last portion of the capture](/questions/15655/wireshark-trace-files-missing-the-last-portion-of-the-capture)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-15655-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-15655-score" class="post-score" title="current number of votes">0</div><span id="post-15655-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hi all. Big fan, and user, of the 'shark, but haven't had a need to post in quite a while...</p><p>I have run into a strange problem - perhaps someone has some ideas. Here it is...</p><p>I'm in the U.S., and I'm working with colleagues in India, who are running wireshark on their workstations, and sending me the files when they are done. What I'm finding is the Wireshark files I receive are missing a significant portion of the capture, at the end of the file. For example, after capturing for 20 minutes today, the file I receive has packets spanning the first 6 minutes.<br />
</p><p>The packets that ARE in the file all look fine - no missing packets, timestamps are chronologically ordered, delta times between packets are all subsecond and reasonably spaced, etc. It appears to be a perfectly healthy trace file... Except that the last packet's timestamp is 14 minutes before they stopped capturing.</p><p>In a previous activity, we set up Wireshark to capture multiple files, creating a new one every 10 minutes. (I even saw their Capture Options screen - it looked correct.) When I received the resultant files, each of them was approximately 2 minutes long.</p><p>And... This is happening on more than one workstation.</p><p>Obviously, I'm limited in what I can do to troubleshoot, due to remoteness.</p><p>I'd love for someone to say, "I've seen this before", or something equally helpful.</p><p>thx all, feenyman99</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-missing_packets" rel="tag" title="see questions tagged &#39;missing_packets&#39;">missing_packets</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>07 Nov '12, 10:25</strong></p><img src="https://secure.gravatar.com/avatar/ba0791e3a82c059268b46a45ae90989f?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="feenyman99&#39;s gravatar image" /><p><span>feenyman99</span><br />
<span class="score" title="96 reputation points">96</span><span title="22 badges"><span class="badge1">●</span><span class="badgecount">22</span></span><span title="22 badges"><span class="silver">●</span><span class="badgecount">22</span></span><span title="26 badges"><span class="bronze">●</span><span class="badgecount">26</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="feenyman99 has one accepted answer">25%</span> </br></p></div></div><div id="comments-container-15655" class="comments-container"><span id="15657"></span><div id="comment-15657" class="comment"><div id="post-15657-score" class="comment-score"></div><div class="comment-text"><p>Is there a maximum file size imposed in addition to a maximum capture time duration? Maybe the max size is reached before the time duration has elapsed?</p></div><div id="comment-15657-info" class="comment-info"><span class="comment-age">(07 Nov '12, 11:49)</span> <span class="comment-user userinfo">cmaynard ♦♦</span></div></div></div><div id="comment-tools-15655" class="comment-tools"></div><div class="clear"></div><div id="comment-15655-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="15656"></span>

<div id="answer-container-15656" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-15656-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-15656-score" class="post-score" title="current number of votes">0</div><span id="post-15656-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>You say they "send" the file.</p><p>Some questions:</p><ul><li>How exactly do they send the file?</li><li>Is the file size of the transmitted capture file identical on both sides?</li><li>Did you calculate a MD5/SHA1 checksum of the capture file on both sides? Are the checksums identical?</li></ul><p>Reason: The file might be truncated/modified while it is transferred to you. Example: If you use FTP and don't choose BINARY transfer mode, ASCII mode might be used, which <strong>might modify</strong> the capture file.</p><p>Regards<br />
Kurt</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>07 Nov '12, 10:56</strong></p><img src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Kurt%20Knochner&#39;s gravatar image" /><p><span>Kurt Knochner ♦</span><br />
<span class="score" title="24767 reputation points"><span>24.8k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">●</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">●</span><span class="badgecount">237</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Kurt Knochner has 344 accepted answers">15%</span> </br></p></div></div><div id="comments-container-15656" class="comments-container"><span id="15658"></span><div id="comment-15658" class="comment"><div id="post-15658-score" class="comment-score"></div><div class="comment-text"><p>Kurt - Thx for the quick response!</p><p>Files have been transferred via 2 methods: NetMeeting File Transfer &amp; Sharepoint.</p><p>I have compared file sizes, and they are the same on both sides. (I have not compared checksum's).</p><p>It seems that, when we expect Wireshark to create a file with "n" minutes' worth of traffic, the resultant file has only the first "less than n/2" minutes.</p><p>Yeah - I know... Weird. I've been using Wireshark/Ethereal for 10+ years, and haven't seen anything like this.</p><p>I was just hoping I'd get real lucky, and someone in this forum would have seen this.</p><p>Anybody else have ideas???</p><p>Thx all!!!</p></div><div id="comment-15658-info" class="comment-info"><span class="comment-age">(07 Nov '12, 12:10)</span> <span class="comment-user userinfo">feenyman99</span></div></div><span id="15659"></span><div id="comment-15659" class="comment"><div id="post-15659-score" class="comment-score"></div><div class="comment-text"><ul><li>What is your Wireshark version in India and US (wireshark -v)?</li></ul><blockquote><p>(I have not compared checksum's).</p></blockquote><p>please check them, just to make sure they are indeed identical.</p><p>Then I recommend to transfer the file in a ZIP container. If the ZIP container gets corrupted (truncated, modified, etc.), the ZIP tool will tell you. I use 7-Zip most of the time (<a href="http://7-zip.org">7-zip.org</a>).</p><ul><li>Is the output of the following command <strong>identical</strong> on both systems (india and US)? Are there frames missing at the end?</li></ul><blockquote><p><code>tshark -r input.cap -T fields -e frame.number -e frame.time_relative -e frame.time_epoch</code></p></blockquote></div><div id="comment-15659-info" class="comment-info"><span class="comment-age">(07 Nov '12, 13:24)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="15664"></span><div id="comment-15664" class="comment"><div id="post-15664-score" class="comment-score"></div><div class="comment-text"><p>Again... Thx Kurt for responding. I can execute those checks - I hope - when India folks wake up (it's 4:30am there now) and I can get some time from them.</p><p>HOWEVER... Is there any possibility that the <strong>capture buffer size is too small?</strong> Would that cause behavior like this??</p><p>Thx again...</p></div><div id="comment-15664-info" class="comment-info"><span class="comment-age">(07 Nov '12, 15:08)</span> <span class="comment-user userinfo">feenyman99</span></div></div><span id="15665"></span><div id="comment-15665" class="comment"><div id="post-15665-score" class="comment-score"></div><div class="comment-text"><blockquote><p>Is there any possibility that the capture buffer size is too small?</p></blockquote><p>I don't think so.</p><p>What is your Wireshark version and OS?</p></div><div id="comment-15665-info" class="comment-info"><span class="comment-age">(07 Nov '12, 15:12)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="15670"></span><div id="comment-15670" class="comment"><div id="post-15670-score" class="comment-score"></div><div class="comment-text"><p>MY Wireshark, where the file is being READ, is version 1.5.6 (SVN Rev 40429 from /trunk-1.6), running on XP Pro Version 2002, Service Pack 3.</p><p>THEIR Wireshark, where the file is being WRITTEN... I must wait till I reconnoiter w/ the India folks to answer this.</p><p>After I asked about a possible buffer size problem, I did some reading and I agree that this is very unlikely. I gather that if the buffer were too small, I would see "missing" packets amongst the existing packets. I see none of this. Instead, the packets that are missing all belong after the last packet in the file.</p></div><div id="comment-15670-info" class="comment-info"><span class="comment-age">(07 Nov '12, 16:31)</span> <span class="comment-user userinfo">feenyman99</span></div></div><span id="15681"></span><div id="comment-15681" class="comment not_top_scorer"><div id="post-15681-score" class="comment-score"></div><div class="comment-text"><blockquote><p>MY Wireshark, where the file is being READ, is version 1.5.6</p></blockquote><p>O.K. can you please try the latest stable version 1.8.3?</p></div><div id="comment-15681-info" class="comment-info"><span class="comment-age">(08 Nov '12, 00:21)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="15709"></span><div id="comment-15709" class="comment not_top_scorer"><div id="post-15709-score" class="comment-score"></div><div class="comment-text"><p>Kurt... the files are being captured and written on Windows XP, Wireshark version 1.0.5.</p><p>thx again for all ur help.</p><p>feenyman99</p></div><div id="comment-15709-info" class="comment-info"><span class="comment-age">(08 Nov '12, 05:47)</span> <span class="comment-user userinfo">feenyman99</span></div></div><span id="15710"></span><div id="comment-15710" class="comment not_top_scorer"><div id="post-15710-score" class="comment-score"></div><div class="comment-text"><blockquote><p>version 1.0.5.</p></blockquote><p>a pretty old version. If there is no good reason to use that old version, I really recommend to use the latest official release 1.8.3. With that version you should see none of these problems.</p><blockquote><p>thx again for all ur help.</p></blockquote><p>Does that mean your problem is solved? If so, how?</p></div><div id="comment-15710-info" class="comment-info"><span class="comment-age">(08 Nov '12, 05:54)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div></div><div id="comment-tools-15656" class="comment-tools"><span class="comments-showing"> showing 5 of 8 </span> <a href="#" class="show-all-comments-link">show 3 more comments</a></div><div class="clear"></div><div id="comment-15656-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

