+++
type = "question"
title = "TPC: New fragment overlaps old data (retransmission?) - RESET - ERR_CONNECTION_RESET"
description = '''Since a few days I get &quot;ERR_CONNECTION_RESET&quot; errors in Chrome and Firefox. Mainly with wikia.com and imgur.com After trying a lot of different approaches DNS flush, switching to openDNS, Router / Modem reset, registry cleaning, disable anti virus / firewall and whatnot I came up with no solution as...'''
date = "2016-04-29T16:08:00Z"
lastmod = "2016-07-09T22:07:00Z"
weight = 52091
keywords = [ "connection_reset", "fragment", "retransmissions", "timeout", "reset" ]
aliases = [ "/questions/52091" ]
osqa_answers = 2
osqa_accepted = false
+++

<div class="headNormal">

# [TPC: New fragment overlaps old data (retransmission?) - RESET - ERR\_CONNECTION\_RESET](/questions/52091/tpc-new-fragment-overlaps-old-data-retransmission-reset-err_connection_reset)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-52091-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-52091-score" class="post-score" title="current number of votes">0</div><span id="post-52091-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Since a few days I get "ERR_CONNECTION_RESET" errors in Chrome and Firefox. Mainly with wikia.com and imgur.com</p><p>After trying a lot of different approaches DNS flush, switching to openDNS, Router / Modem reset, registry cleaning, disable anti virus / firewall and whatnot I came up with no solution as of yet. I'm pretty sure it's not my PC though, since I have similar problems from my mobile phone. PC is connected via LAN, phone via WLAN. I did a capture and noticed a couple of errors:</p><ul><li>[TCP Spurious Retransmission]</li><li>[TCP Retransmission]</li><li>[TCP Previous segment not captured]</li><li>[TCP Out-of-order]</li></ul><p>And a lot of red and black bars in general. (I'm a total WS beginner) I uploaded the capture to my Dropbox <a href="https://www.dropbox.com/s/8enrzxbypbhmrfy/30.04.16.pcapng?dl=0">( Link to capture file )</a> and hopefully someone can finally tell me what the hell is wrong with my network.</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-connection_reset" rel="tag" title="see questions tagged &#39;connection_reset&#39;">connection_reset</span> <span class="post-tag tag-link-fragment" rel="tag" title="see questions tagged &#39;fragment&#39;">fragment</span> <span class="post-tag tag-link-retransmissions" rel="tag" title="see questions tagged &#39;retransmissions&#39;">retransmissions</span> <span class="post-tag tag-link-timeout" rel="tag" title="see questions tagged &#39;timeout&#39;">timeout</span> <span class="post-tag tag-link-reset" rel="tag" title="see questions tagged &#39;reset&#39;">reset</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>29 Apr '16, 16:08</strong></p><img src="https://secure.gravatar.com/avatar/a7f49bc80cd7cf57938fbbd10e1eb3f9?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Tiiara&#39;s gravatar image" /><p><span>Tiiara</span><br />
<span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="6 badges"><span class="bronze">●</span><span class="badgecount">6</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Tiiara has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>30 Apr '16, 14:21</strong> </span></p></div></div><div id="comments-container-52091" class="comments-container"></div><div id="comment-tools-52091" class="comment-tools"></div><div class="clear"></div><div id="comment-52091-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

2 Answers:

</div>

</div>

<span id="52094"></span>

<div id="answer-container-52094" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-52094-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-52094-score" class="post-score" title="current number of votes">1</div><span id="post-52094-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>Looks to me like someone is preventing you from accessing certain web pages. E.g. if you filter on "tcp.stream==4" for the fourth TCP session you'll see that your GET request for "http://diealdor.wikia.com/wiki/Piixy" leads to a connection abort by a RESET packet from 23.235.37.194 (well, two actually), but right after that you get retransmissions for the SYN/ACK from that same IP. This makes no sense - if the server aborts the connection it won't try to resend "normal" packets afterwards.</p><p>What seems to happen is that someone is monitoring/intercepting your network traffic and injecting reset packets to force connections to fail. The server doesn't know about that, of course, and tries getting the real packets through to you, which is why you see them coming in after the resets. It's interesting that other web page calls (e.g. to imgur.com) work, so it looks like only specific URLs are messed with. I don't know what network you're on, but if this at work, it may be a "prevent employees from accessing non-business websites" mechanism, but that's usually done via filtering proxy, not forged resets.</p><p>So my guess is someone is messing with you, or just doesn't want you to visit certain resources. It must be someone with access to your communication, so check if there's something/someone in your own network who may be reponsible. Otherwise it would have to be someone outside your network who can monitor what you're doing. Maybe try to switch to HTTPS connections if you can, which makes it much harder to do something like this.</p><p>Of course this can also be some sort of misconfiguration, but the incoming packets after the resets are very uncommon.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>30 Apr '16, 00:18</strong></p><img src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Jasper&#39;s gravatar image" /><p><span>Jasper ♦♦</span><br />
<span class="score" title="23806 reputation points"><span>23.8k</span></span><span title="5 badges"><span class="badge1">●</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">●</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">●</span><span class="badgecount">284</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Jasper has 263 accepted answers">18%</span></p></div></div><div id="comments-container-52094" class="comments-container"><span id="52097"></span><div id="comment-52097" class="comment"><div id="post-52097-score" class="comment-score"></div><div class="comment-text"><p>I am at home on my personal computer and I get Internet from our local cable provider. I checked again an the same happens on all our computers here. We use the following hardware to get online:</p><p><code>- Thomson TCM420 Cable Modem - SW Version:  ST52.05.51 - SW Model:  a806 - Bootloader:  2.1.6d  - D-Link Systems DIR-645 Router - HW Version : A1 - FW Version : 1.01</code></p><p>I checked the router and found no sign of any activity from this end that looks like someone monitoring / intercepting my traffic. The strangest thing is, that those websites not working in the log will work for a minute or two if I hit the refresh button often enough in rapid succession.</p><p>The idea of someone monitoring/intercepting my traffic and injecting stuff into my connection is horrible.</p><p>Any idea how I could confirm/refute this theory? Or even better, what I can do about it?</p></div><div id="comment-52097-info" class="comment-info"><span class="comment-age">(30 Apr '16, 03:22)</span> <span class="comment-user userinfo">Tiiara</span></div></div><span id="52098"></span><div id="comment-52098" class="comment"><div id="post-52098-score" class="comment-score">1</div><div class="comment-text"><p>It's not that uncommon that rapid retries will get through every once in a while - injecting packets is not working 100% all the time, depending on the timing and other things.</p><p>I don't think the cable modem is at fault - modems just transfer data without messing with it. Maybe your router has a problem or even got hijacked. It has quite a list of known vulnerabilties, and some of them are affecting your FW version:</p><p><a href="https://www.cvedetails.com/vulnerability-list/vendor_id-899/D-link.html">https://www.cvedetails.com/vulnerability-list/vendor_id-899/D-link.html</a></p><p>You should make a backup of the configuration of the router, then wipe it/factory reset it, and flash the latest firmware before reconfiguring it. Check if the problems goes away.</p></div><div id="comment-52098-info" class="comment-info"><span class="comment-age">(30 Apr '16, 03:30)</span> <span class="comment-user userinfo">Jasper ♦♦</span></div></div><span id="52099"></span><div id="comment-52099" class="comment"><div id="post-52099-score" class="comment-score"></div><div class="comment-text"><p>Thank you, I will try this over after lunch today.</p><p>Another thing, I just tried visiting those problematic websites via a free VPN from hide.me and didn't get any ERR_CONNECTION_RESET errors at all. I'll capture some tries later if the same problem occurs again but first I'll try the firmware update.</p></div><div id="comment-52099-info" class="comment-info"><span class="comment-age">(30 Apr '16, 03:42)</span> <span class="comment-user userinfo">Tiiara</span></div></div><span id="52100"></span><div id="comment-52100" class="comment"><div id="post-52100-score" class="comment-score">1</div><div class="comment-text"><p>Depending on where the VPN starts encrypting (I guess on your PC) the intercept can't detect the URLs anymore you're accessing, so it doesn't react I guess.</p></div><div id="comment-52100-info" class="comment-info"><span class="comment-age">(30 Apr '16, 04:00)</span> <span class="comment-user userinfo">Jasper ♦♦</span></div></div><span id="52102"></span><div id="comment-52102" class="comment"><div id="post-52102-score" class="comment-score"></div><div class="comment-text"><p>I updated the firmware from 1.01 to 1.06 and so far it seems this did the trick. All this is really strange and I kinda fail to see a motive behind any deliberate attempt by some random person to block me from using some specific URLs. Whatever this was, I don't get it. Thanks for the help though!</p></div><div id="comment-52102-info" class="comment-info"><span class="comment-age">(30 Apr '16, 04:40)</span> <span class="comment-user userinfo">Tiiara</span></div></div><span id="52103"></span><div id="comment-52103" class="comment not_top_scorer"><div id="post-52103-score" class="comment-score"></div><div class="comment-text"><p>Sooo.... no, this was kinda premature. Just a minute after the firmware update I get the same errors in my browser again.</p><p>This sucks. Any new ideas?</p></div><div id="comment-52103-info" class="comment-info"><span class="comment-age">(30 Apr '16, 04:44)</span> <span class="comment-user userinfo">Tiiara</span></div></div><span id="52104"></span><div id="comment-52104" class="comment not_top_scorer"><div id="post-52104-score" class="comment-score"></div><div class="comment-text"><p>If you can, replace the router to see if that helps (maybe someone has a spare you can try). It's possible that a Firmwareupgrade and Factory Reset isn't good enough to get rid of whatever embedded itself.</p><p>You can also try to capture between Modem and Router (on the router's WAN side so to speak), but you'll need a TAP or Switch with a SPAN port for that, which may be not available to you. The idea is to see if the Reset packets are also seen on the WAN side, because if they're not, you know for sure that your router is doing it.</p><p>You also need to consider that whoever managed to get into the router has spread further into your network and is able to reestablish it's foothold by using other backdoors placed in PCs or other devices. It's kind of a nightmare scenario, but it would be unwise to totally deny it as a possibility.</p></div><div id="comment-52104-info" class="comment-info"><span class="comment-age">(30 Apr '16, 04:51)</span> <span class="comment-user userinfo">Jasper ♦♦</span></div></div><span id="52105"></span><div id="comment-52105" class="comment not_top_scorer"><div id="post-52105-score" class="comment-score"></div><div class="comment-text"><p>A nightmare scenario indeed.</p><p>I did another capture just now and get the same error messages I got earlier. <a href="https://www.dropbox.com/s/hwz4c80le67islr/30.04.16_2.pcapng?dl=0">https://www.dropbox.com/s/hwz4c80le67islr/30.04.16_2.pcapng?dl=0</a> So now what do I do ... I'll order a new router from amazon (wanted a fritzbox anyway), which will arrive on monday, and hopefully this will help.</p><p>Another idea I just came up with: Can I try to unplug the router and connect my PC directly with the modem? Is that even possible? Then I would also know if it's the router's fault, right?</p></div><div id="comment-52105-info" class="comment-info"><span class="comment-age">(30 Apr '16, 05:04)</span> <span class="comment-user userinfo">Tiiara</span></div></div><span id="52106"></span><div id="comment-52106" class="comment not_top_scorer"><div id="post-52106-score" class="comment-score"></div><div class="comment-text"><p>yes, good idea, connecting the PC directly should work. Maybe you need to reboot the modem when you do - I've seen modems only talking to one LAN MAC, so if it learned the router's MAC it will not accept your PC without a restart. And make sure the local firewall on your PC is running, because you're now directly connected to the BBI (Big Bad Internet) with it.</p><p>Fritzbox is a good move, they're much better when it comes to handling security the right way.</p></div><div id="comment-52106-info" class="comment-info"><span class="comment-age">(30 Apr '16, 05:07)</span> <span class="comment-user userinfo">Jasper ♦♦</span></div></div><span id="52112"></span><div id="comment-52112" class="comment not_top_scorer"><div id="post-52112-score" class="comment-score"></div><div class="comment-text"><p>I connected the PC directly to the modem with nothing else active in the network. No router, no other devices, just the cable modem connected with a LAN cable to my pc. Same result. I still get the same <code>[TCP Spurious Retransmission], [TCP Retransmission], [TCP Previous segment not captured],[TCP Out-of-order]</code> errors over an over again.</p><p>So, if I understand it correctly, that means the problem is either with my PC in the form of some kind of malware / virus / trojan whatever that ALSO affected ALL other devices in our network (since I got the same errors with my android phone, tablet and second PC) or it is something wrong with my cable provider. Right?</p><p>Would the fact, that the VPN solution results in no errors at all conform with that?</p></div><div id="comment-52112-info" class="comment-info"><span class="comment-age">(30 Apr '16, 06:06)</span> <span class="comment-user userinfo">Tiiara</span></div></div><span id="52113"></span><div id="comment-52113" class="comment not_top_scorer"><div id="post-52113-score" class="comment-score"></div><div class="comment-text"><p>According to the pcap file in dropbox, the TCP stream 4 has two RST. Note that they are not RST/ACK. This is strange too. As TCP RST (not RST/ACK, the ack numbers are 0). According to <a href="http://superuser.com/questions/602645/are-there-any-requirements-for-the-sequence-numbers-on-tcp-reset-packets,">http://superuser.com/questions/602645/are-there-any-requirements-for-the-sequence-numbers-on-tcp-reset-packets,</a> RFC 793 requires the ACK bit.</p></div><div id="comment-52113-info" class="comment-info"><span class="comment-age">(30 Apr '16, 06:42)</span> <span class="comment-user userinfo">pktUser1001</span></div></div><span id="52114"></span><div id="comment-52114" class="comment not_top_scorer"><div id="post-52114-score" class="comment-score"></div><div class="comment-text"><p>I just stumbled upon something while trying to find some more information about those strange reset flags. Something about Comcast in the US in late 2008. Then I noticed all those errors occurred on ports with really high numbers. For example:</p><p><code>Transmission Control Protocol, Src Port: http (80), Dst Port: 57877 (57877), Seq: 6506, Len: 0 Transmission Control Protocol, Src Port: http (80), Dst Port: 59305 (59305), Seq: 110627, Len: 0</code></p><p>Could this be my ISP trying to use some kind of blocking system for the higher port ranges to counter p2p, file sharing or something like that? I still don't understand why it only happens on the wikia.com and imgur.com URLs though. Any way to test this?</p></div><div id="comment-52114-info" class="comment-info"><span class="comment-age">(30 Apr '16, 07:07)</span> <span class="comment-user userinfo">Tiiara</span></div></div><span id="52120"></span><div id="comment-52120" class="comment not_top_scorer"><div id="post-52120-score" class="comment-score"></div><div class="comment-text"><p>Formally, no ports are "really high", as the port numbers range from 0 to 65535 (all the values that can be expressed in 16 bits) and the range currently suggested for ephemeral ports (those which TCP clients use locally to establish sessions towards servers) is 49152 - 65535.</p><p>To test whether the ephemeral port number plays a role in your puzzle, <a href="https://support.microsoft.com/en-us/kb/929851">this</a> is an article on how to set a different range for ephemeral ports on Windows; on other operating system, the way to do it is different but the goal is the same, to use lower port numbers.</p><p>Bear in mind that you should not restrict too much the total number of ephemeral ports to be used, as doing so could cause other issues - TCP uses protection mechanisms which require a certain rest time before the same port can be reused to set up a new session to the same server. So I'd recommend to set, say, 5000 ports starting from 40000, and before doing so, to close any other browser windows than the one necessary for testing. A single browser window may open many TCP sessions, with all those advertisement networks.</p><p>But I don't believe it will be the reason. The p2p filtering mechanism would normally act on sessions where both ends use high port numbers. If it is a broken one and so it only looks at one of them, 40000-44999 is still too high.</p><blockquote><p>So, if I understand it correctly, that means the problem is either with my PC in the form of some kind of malware / virus / trojan whatever that ALSO affected ALL other devices in our network (since I got the same errors with my android phone, tablet and second PC) or it is something wrong with my cable provider. Right?</p></blockquote><p>You've almost answered yourself, so much effort spent to ban you from two sites isn't proportional, so I'd suspect something at the ISP side (or at the side where the sites in question are hosted, I've seen such issues too).</p><blockquote><p>Would the fact that the VPN solution results in no errors at all conform with that?</p></blockquote><p>As <span></span><span>@Jasper</span> wrote, unless the hypothetical malware is a stealth one and would like to hide from you, it should act the same on a VPN interface of your PC like on a physical interface. So the fact that with VPN the issue doesn't appear almost excludes that it would be caused by a malware on your PC. Besides, the incoming RST packets are shown in the capture, which is also not easy to accomplish for a software running on the PC on which you capture.</p></div><div id="comment-52120-info" class="comment-info"><span class="comment-age">(01 May '16, 01:31)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="52184"></span><div id="comment-52184" class="comment not_top_scorer"><div id="post-52184-score" class="comment-score"></div><div class="comment-text"><p>Thanks a lot for the link provided. I will try this tomorrow.</p><p>I also called my ISP yesterday but on their end everything is fine. I figured as much. They suggested sending a technician over to take a look at my network setup, but if he finds something wrong with it I have to pay the whole thing. I'm not looking forward to it, Murphy's Law an all that, but if nothing else gets me any results, might as well.</p></div><div id="comment-52184-info" class="comment-info"><span class="comment-age">(03 May '16, 11:47)</span> <span class="comment-user userinfo">Tiiara</span></div></div><span id="52195"></span><div id="comment-52195" class="comment not_top_scorer"><div id="post-52195-score" class="comment-score"></div><div class="comment-text"><p>I doubt your ISP has technicians that can do packet analysis on a level as required (I may be wrong, though) - the ones I have seen are basically electrical engineers that can read a db/m graph to check if the physical signal is strong enough.</p><p>BTW I asked some other network forensics specialists for their thoughts on your trace and here's a quote from one of them:</p><p>"That's odd. I don't see a motive for someone to inject RST packets in those sessions, but that is clearly what is happening. My guess is that the RST packets are coming from the ISP rather than being a hacked cable modem."</p></div><div id="comment-52195-info" class="comment-info"><span class="comment-age">(03 May '16, 13:50)</span> <span class="comment-user userinfo">Jasper ♦♦</span></div></div><span id="52240"></span><div id="comment-52240" class="comment not_top_scorer"><div id="post-52240-score" class="comment-score"></div><div class="comment-text"><p>As expected changing the port range didn't do anything. Talking to tech support was just as useless. The lady on the technical hotline tried to make me believe it's the modem dying of age. Yeah, right. I bet she didn't even understand half of what I told her about the problem. <em>sigh</em> Nevertheless I send the trace to tech support yesterday anyway and I'm really curious about what they'll say. Hopefully something useful.</p><p>I also noticed the error occurring more while using firefox and less while using chrome. They still occur on all browsers, I even installed IE and Safari to try those, but if I had to name a number I'd say on FF it's a 95% failure rate and on chrome only about 70%. Sometimes I can't reach those sites on FF but chrome works fine. A minute later both don't get response other than connection reset.</p><p>I really don't know where this will get me, but is there any way to be sure where those RST injects are coming from?</p></div><div id="comment-52240-info" class="comment-info"><span class="comment-age">(04 May '16, 15:53)</span> <span class="comment-user userinfo">Tiiara</span></div></div><span id="52241"></span><div id="comment-52241" class="comment not_top_scorer"><div id="post-52241-score" class="comment-score"></div><div class="comment-text"><blockquote><p>is there any way to be sure where those RST injects are coming from?</p></blockquote><p>There is no way to be sure (as the injected packets have to look as if sent by the server in order to work, you cannot "geolocate" their source by their contents), but you could get some further inditia if you can extend your search.</p><p>At near end, it could be possible for you to ask a neighbouring friend who uses the same ISP to try the same. At far end, you'd have to contact the administrators of those affected sites and ask them for assistance.</p><p>A useful tool here is <code>traceroute</code> (or <code>tracert</code> on Windows) which should disclose you the nodes (routers) on the paths through the internet between you and the servers. If the beginnings (the closest nodes) of these paths are the same at your friend's like your own ones, and the issue doesn't happen at your friend's, then the RST spoofing is most likely triggered by your network's public address; if the beginning of the path is different and the issue happens anyway, it is related to something else. In any case, the information from traceroute would be interesting for the site administrator.</p><p>In my case, it looks like this (information about first 7 nodes manually removed):</p><p><code>Tracing route to wikia.com [23.235.37.194] over a maximum of 30 hops:   1     1 ms     1 ms     1 ms  xxxx private xxxx   2     1 ms     1 ms     1 ms  xxxx private xxxx   3    87 ms    57 ms    67 ms  xxxx private xxxx   4     *       69 ms    82 ms  xxxx private xxxx   5   107 ms   102 ms    79 ms  xxxx private xxxx   6    96 ms   100 ms    94 ms  xxxx private xxxx   7   79 ms    88 ms   102 ms  xxxx private xxxx   8    86 ms    81 ms    52 ms  supernetwork.peering.cz [91.213.211.101]   9    90 ms   193 ms    89 ms  vl5.sit-c76-edge2.superhosting.cz [88.86.96.209]   10     *       93 ms    89 ms  be4402.ccr21.prg01.atlas.cogentco.com [149.6.24.41]   11   106 ms    90 ms   101 ms  be2078.ccr42.ham01.atlas.cogentco.com [130.117.0.165]   12   206 ms    88 ms   104 ms  be2798.ccr42.fra03.atlas.cogentco.com [154.54.58.229]   13   104 ms   102 ms   143 ms  be2846.rcr22.fra06.atlas.cogentco.com [154.54.37.30]   14   147 ms    95 ms   234 ms  be2844.rcr21.fra06.atlas.cogentco.com [130.117.0.30]   15     *        *        *     Request timed out.   16    77 ms    92 ms    77 ms  23.235.37.194 Trace complete.</code></p><p>And I have no problems whatsoever to access the first link on that site from your capture from Mozilla Firefox.</p></div><div id="comment-52241-info" class="comment-info"><span class="comment-age">(05 May '16, 00:48)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="52242"></span><div id="comment-52242" class="comment not_top_scorer"><div id="post-52242-score" class="comment-score"></div><div class="comment-text"><p>Before going to your friend's, use <code>traceroute</code> while using the VPN connection; unless the RST spoofer watches for your public IP, the nodes closer to the far end which are common for the "normal" and "VPN" paths are not guilty.</p></div><div id="comment-52242-info" class="comment-info"><span class="comment-age">(05 May '16, 00:54)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="52243"></span><div id="comment-52243" class="comment not_top_scorer"><div id="post-52243-score" class="comment-score"></div><div class="comment-text"><p>Strange Site. Can reproduce it. If I open the page, the computer produces more load then I have expected. And I can see the "RST Only" Packets in my trace, too.</p></div><div id="comment-52243-info" class="comment-info"><span class="comment-age">(05 May '16, 01:17)</span> <span class="comment-user userinfo">Christian_R</span></div></div><span id="52245"></span><div id="comment-52245" class="comment not_top_scorer"><div id="post-52245-score" class="comment-score"></div><div class="comment-text"><p>It is in a way funny to see German users to be prevented from access to an obviously German site while an user from another country experiences no problems. Maybe someone has inverted the condition in <code>unless (hostname_by_ip($source_ip) matches ".de|.ch|.at") then ban()</code>?</p><p>Let's be serious again, <span>@Christian_R</span>, would you mind sharing <em>your</em> results of traceroute, to see what part of the path is common for both of us?</p></div><div id="comment-52245-info" class="comment-info"><span class="comment-age">(05 May '16, 04:02)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="52246"></span><div id="comment-52246" class="comment not_top_scorer"><div id="post-52246-score" class="comment-score"></div><div class="comment-text"><p>I tested the site as well before I wrote my first answer text, no problems at all (from Germany). Just tested again, still working.</p></div><div id="comment-52246-info" class="comment-info"><span class="comment-age">(05 May '16, 04:13)</span> <span class="comment-user userinfo">Jasper ♦♦</span></div></div><span id="52247"></span><div id="comment-52247" class="comment not_top_scorer"><div id="post-52247-score" class="comment-score"></div><div class="comment-text"><p>Strange...Hm ok. The trace is gone I forgot to save... The only evidence that is left is a screenshot of the flag column... Ok it is a good example how a problem must not be analyzed. But what I can remember is that the page has loaded fine. And a moment later the browser shows me a blank window and the trace began to show me the Resets. I have made the test with Firefox at Mac OS 10.11</p><p>I will try to test it again as soon as possible. As I was in hurry I can't say for sure if I missed something while I have tested it.</p></div><div id="comment-52247-info" class="comment-info"><span class="comment-age">(05 May '16, 04:51)</span> <span class="comment-user userinfo">Christian_R</span></div></div><span id="52248"></span><div id="comment-52248" class="comment not_top_scorer"><div id="post-52248-score" class="comment-score"></div><div class="comment-text"><p><span></span><span>@Jasper</span> and <span></span><span>@sindy</span> In short: I can´t reproduce it. Because <strong>I missed</strong> one of the basic rule; <strong>Double check your findings.</strong><br />
So the most likely reason is that I mixed this two points:<br />
<br />
- Sometimes I see, that the server sends a "RST only" after the 4Way session closing, to close his socket (As shown in Picture1:)<br />
<br />
- If I open the page first time ever in a browser (tried 3 times) the User gets a blan browser tab (As shown in Picture2):<br />
<br />
</p><p>Picture1:<br />
<img src="https://osqa-ask.wireshark.org/upfiles/05-05-_2016_16-52-45.png" alt="alt text" /><br />
<br />
Picture2:<br />
<img src="https://osqa-ask.wireshark.org/upfiles/05-05-_2016_16-32-11.png" alt="alt text" /></p></div><div id="comment-52248-info" class="comment-info"><span class="comment-age">(05 May '16, 08:09)</span> <span class="comment-user userinfo">Christian_R</span></div></div><span id="52249"></span><div id="comment-52249" class="comment not_top_scorer"><div id="post-52249-score" class="comment-score"></div><div class="comment-text"><p>Okay... the aspect which has attracted my attention in your results is that while in your case, the server is 54.174.225.26, when taking my traceroute, the same fqdn got resolved to 23.235.37.194.</p><p>And now, from the office (still in .cz), I've got</p><p><code>;; ANSWER SECTION: wikia.com. 1511 IN A 23.235.33.194 wikia.com. 1511 IN A 23.235.37.194 wikia.com. 1511 IN A 104.156.81.194 wikia.com. 1511 IN A 104.156.85.194</code></p><p>i.e. four distinct addresses but none of them matches yours... what does your <code>dig wikia.com</code> answer?</p><p>Just to be sure, I've asked for the SRV record for _http._tcp.wikia.com, the DNS answer says "CNAME wikia.com.", so this is not the source of the difference.</p><p><span>@Tiiara</span>, can you capture several attempts and check whether the successful ones differ from the unsuccessful ones by the IP of the server to which the session has been established? It's a shame but have no clue how Mozilla and other browsers handle the case when the DNS returns multiple IP addresses as an answer to an A-type query.</p><p>Two traceroutes:</p><p><code>Tracing route to wikia.com [104.156.85.194] over a maximum of 30 hops:   (...censored...)   7     3 ms     8 ms    17 ms  cz-prg-asbr1-be4.dialtelecom.cz [82.119.246.29]    8     2 ms     2 ms     2 ms  prag-b3-link.telia.net [80.239.193.37]   9     3 ms     3 ms     2 ms  prag-bb1-link.telia.net [213.155.132.164]  10    38 ms   159 ms    20 ms  ffm-bb1-link.telia.net [213.155.132.240]  11    21 ms    20 ms    20 ms  ffm-b1-link.telia.net [62.115.116.160]  12     *        *        *     Request timed out.  13    21 ms    23 ms    21 ms  104.156.85.194 Trace complete.</code></p><p><code>Tracing route to 23.235.37.194 over a maximum of 30 hops   (...censored...)   7    12 ms    12 ms     2 ms  cz-prg-asbr1-be4.dialtelecom.cz [82.119.246.29]    8     2 ms     2 ms     2 ms  prag-b3-link.telia.net [80.239.193.37]   9     2 ms     2 ms     2 ms  prag-bb1-link.telia.net [213.155.131.62]  10    20 ms    20 ms    20 ms  ffm-bb1-link.telia.net [213.155.133.50]  11    20 ms    20 ms    20 ms  ffm-b1-link.telia.net [62.115.116.164]  12     *        *        *     Request timed out.  13    27 ms    28 ms    24 ms  23.235.37.194 Trace complete.</code></p><p>So regardless the final destination, I go through telia, while from home I went through cogentco. In both cases I have no issues, but I don't know to which server I was actually connecting from home. In the office, Mozilla FF connected to 104.156.81.194 in all three attempts in new browser tabs.</p></div><div id="comment-52249-info" class="comment-info"><span class="comment-age">(05 May '16, 08:50)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="52251"></span><div id="comment-52251" class="comment not_top_scorer"><div id="post-52251-score" class="comment-score"></div><div class="comment-text"><p><span>@sindy</span>: Forget the IP 54.... the IP has nothing to do with that case. It just sends an RST. That is what I wanted to tell with that example.</p><p>Of course I got the same 4 IP adresses for wikia.com as you. And I always go through telia with the last telia hop <code>ffm-b1-link.telia.net</code>, too.</p></div><div id="comment-52251-info" class="comment-info"><span class="comment-age">(05 May '16, 09:23)</span> <span class="comment-user userinfo">Christian_R</span></div></div><span id="52253"></span><div id="comment-52253" class="comment not_top_scorer"><div id="post-52253-score" class="comment-score"></div><div class="comment-text"><p>A DNS lookup for wikia results in those 4 IPs:</p><p><code>104.156.85.194 104.156.81.194 23.235.33.194 23.235.37.194</code></p><p>I did 4 trace routs to each of the IP addresses</p><p><code> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ Tracing route to 104.156.85.194 over a maximum of 30 hops   1     7 ms     9 ms     8 ms  xxxx private xxxx   2    11 ms    13 ms    17 ms  xxxx private xxxx   3    13 ms    13 ms    14 ms  xxxx private xxxx   4    13 ms    14 ms    11 ms  5-2-28.ear2.frankfurt1.level3.net [195.16.160.93]   5    13 ms    12 ms     *     te0-0-0-20.rcr21.fra06.atlas.cogentco.com [154.25.7.141]   6     *        *        *     Request timed out.   7    13 ms    17 ms    13 ms  104.156.85.194 Trace complete. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ Tracing route to 23.235.37.194 over a maximum of 30 hops   1    16 ms     6 ms     5 ms  xxxx private xxxx   2    10 ms    12 ms    10 ms  xxxx private xxxx   3    11 ms    11 ms    12 ms  xxxx private xxxx   4    18 ms     *       17 ms  gi0-0-0-19.nr12.b015760-1.fra06.atlas.cogentco.com [149.11.21.145]   5    12 ms    12 ms    12 ms  te0-0-0-20.rcr21.fra06.atlas.cogentco.com [154.25.7.141]   6     *       13 ms    10 ms  23.235.37.194 Trace complete. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ Tracing route to 23.235.33.194 over a maximum of 30 hops   1     8 ms    12 ms    12 ms  xxxx private xxxx   2    14 ms    11 ms     9 ms  xxxx private xxxx   3    11 ms    14 ms    11 ms  xxxx private xxxx   4    14 ms     *       13 ms  gi0-0-0-19.nr12.b015760-1.fra06.atlas.cogentco.com [149.11.21.145]   5    14 ms    14 ms    12 ms  te0-4-0-5.rcr21.fra06.atlas.cogentco.com [154.25.7.145]   6    15 ms     *       12 ms  23.235.33.194 Trace complete. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ Tracing route to 104.156.81.194 over a maximum of 30 hops   1     7 ms    10 ms     6 ms  xxxx private xxxx   2    10 ms    13 ms     9 ms  xxxx private xxxx   3    13 ms    11 ms    12 ms  xxxx private xxxx   4    14 ms    17 ms    17 ms  5-2-28.ear2.frankfurt1.level3.net [195.16.160.93]   5     *        *       13 ms  te0-4-0-5.rcr21.fra06.atlas.cogentco.com [154.25.7.145]   6    13 ms    13 ms    12 ms  104.156.81.194 Trace complete. ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</code></p><p>I also did some trace routs with nettols5 which resulted in the following screenshot:</p><p><img src="https://osqa-ask.wireshark.org/upfiles/tracert_9XdjiVy.png" alt="alt text" /></p></div><div id="comment-52253-info" class="comment-info"><span class="comment-age">(05 May '16, 10:54)</span> <span class="comment-user userinfo">Tiiara</span></div></div><span id="52255"></span><div id="comment-52255" class="comment not_top_scorer"><div id="post-52255-score" class="comment-score"></div><div class="comment-text"><blockquote><span></span><span>@Tiiara</span>, can you capture several attempts and check whether the successful ones differ from the unsuccessful ones by the IP of the server to which the session has been established? It's a shame but have no clue how Mozilla and other browsers handle the case when the DNS returns multiple IP addresses as an answer to an A-type query.</blockquote><p>I can try. Though I'm not entirely sure how. I hope those trace routs helped some already.</p></div><div id="comment-52255-info" class="comment-info"><span class="comment-age">(05 May '16, 10:55)</span> <span class="comment-user userinfo">Tiiara</span></div></div><span id="52256"></span><div id="comment-52256" class="comment not_top_scorer"><div id="post-52256-score" class="comment-score"></div><div class="comment-text"><p>OK, so the first one is an <strong>unsuccessful</strong> try to connect to wikia.com</p><ul><li><a href="https://www.cloudshark.org/captures/a8de557256ab">https://www.cloudshark.org/captures/a8de557256ab</a></li></ul><p>the second one is a <strong>successful</strong> attempt to connect to the site:</p><ul><li><a href="https://www.cloudshark.org/captures/1368f0042876">https://www.cloudshark.org/captures/1368f0042876</a></li></ul><p>And the third one is something strange I saw after I just signed up for cloudshark but had the browser already closed. WS still tried to keep the connection alive and I think there are some RST flags in there too:</p><ul><li><a href="https://www.cloudshark.org/captures/5618ff446df8">https://www.cloudshark.org/captures/5618ff446df8</a></li></ul></div><div id="comment-52256-info" class="comment-info"><span class="comment-age">(05 May '16, 11:15)</span> <span class="comment-user userinfo">Tiiara</span></div></div><span id="52258"></span><div id="comment-52258" class="comment not_top_scorer"><div id="post-52258-score" class="comment-score"></div><div class="comment-text"><p>And here is WS capture while using my free hide.me vpn over the netherlands:</p><ul><li><a href="https://www.cloudshark.org/captures/2231dd4c082d">https://www.cloudshark.org/captures/2231dd4c082d</a></li></ul></div><div id="comment-52258-info" class="comment-info"><span class="comment-age">(05 May '16, 11:25)</span> <span class="comment-user userinfo">Tiiara</span></div></div><span id="52260"></span><div id="comment-52260" class="comment not_top_scorer"><div id="post-52260-score" class="comment-score"></div><div class="comment-text"><p>Maybe I missed it but I wanted to ask: If you got the error message, do you see a white browser screen before the error message is shown?</p><p>And what does the statusbar of the browser shows to you?</p></div><div id="comment-52260-info" class="comment-info"><span class="comment-age">(05 May '16, 11:50)</span> <span class="comment-user userinfo">Christian_R</span></div></div><span id="52261"></span><div id="comment-52261" class="comment not_top_scorer"><div id="post-52261-score" class="comment-score"></div><div class="comment-text"><blockquote><p>I hope those trace routes helped some already.</p></blockquote><p>The traceroutes gave us the information that both you and me (from home) get to wikia's servers via cogentco but I don't have any issue while you do. So I would exclude the cogentco network as the source of non-targeted TCP reset spoofing. Your ISP and wikia administrators themselves remain the main candidates to me, as a network of a large interconnect operator seems a really unlikely source of targeted TCP reset spoofing to me.</p><blockquote><p>WS still tried to keep the connection alive and I think there are some RST flags in there too</p></blockquote><p>There are no frames matching <code>tcp.flags.reset == 1</code>. What do you mean by "WS still tried to keep the connection alive"? If WS means Wireshark, then no, Wireshark doesn't keep any connection as it only monitors the traffic (unless there is some Wireshark plugin unknown to me which allows to export files to Cloudshark directly and you had that one in mind). So I'd suspect most the browser process to shut down slowly and still perform some activity although its screen window has already been closed.</p><blockquote><p>And here is WS capture while using my free hide.me vpn over the Netherlands</p></blockquote><p>If the VPN creates a virtual interface in your PC, you should capture at that interface. Otherwise there is no way to see the http (or any other) communication inside the VPN packets. It's one of main purposes of the VPN to encrypt the traffic, so the "plaintext" version of the traffic is only available between the VPN far end and the wikia servers, and at the VPN's virtual interface on your PC if it exists and WinPcap/libpcap can capture on it.</p></div><div id="comment-52261-info" class="comment-info"><span class="comment-age">(05 May '16, 11:50)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="52263"></span><div id="comment-52263" class="comment not_top_scorer"><div id="post-52263-score" class="comment-score"></div><div class="comment-text"><blockquote><p>There are no frames matching <code>tcp.flags.reset == 1</code>.</p></blockquote><p>Sorry, I was too impatient. They are there, but they follow a FIN packet sent by your PC and are not followed by other packets sent by the server, so I wouldn't base any deep conclusions on them.</p></div><div id="comment-52263-info" class="comment-info"><span class="comment-age">(05 May '16, 12:04)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="52422"></span><div id="comment-52422" class="comment not_top_scorer"><div id="post-52422-score" class="comment-score"></div><div class="comment-text"><p>The "specialists" from my ISP called today and will change my cable modem. If that doesn't help they'll call me again an provide me with exact instructions on how to perform some specific tests with Wireshark. I'll keep you up to date if the modem exchange solved the problem.</p></div><div id="comment-52422-info" class="comment-info"><span class="comment-age">(11 May '16, 01:04)</span> <span class="comment-user userinfo">Tiiara</span></div></div><span id="52713"></span><div id="comment-52713" class="comment not_top_scorer"><div id="post-52713-score" class="comment-score"></div><div class="comment-text"><p>Just as expected. Changing the cable modem did jack. <em>sigh</em> Tech support hotline it is. Again.</p></div><div id="comment-52713-info" class="comment-info"><span class="comment-age">(18 May '16, 02:53)</span> <span class="comment-user userinfo">Tiiara</span></div></div><span id="52742"></span><div id="comment-52742" class="comment not_top_scorer"><div id="post-52742-score" class="comment-score"></div><div class="comment-text"><p>Just out of curiosity, have you ever tried to delet the cookies in your browser? And well I know, it has nothing to do with the RST, but maybe with the KEEP ALIVES.</p></div><div id="comment-52742-info" class="comment-info"><span class="comment-age">(18 May '16, 11:31)</span> <span class="comment-user userinfo">Christian_R</span></div></div></div><div id="comment-tools-52094" class="comment-tools"><span class="comments-showing"> showing 5 of 35 </span> <a href="#" class="show-all-comments-link">show 30 more comments</a></div><div class="clear"></div><div id="comment-52094-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="53960"></span>

<div id="answer-container-53960" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-53960-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-53960-score" class="post-score" title="current number of votes">0</div><span id="post-53960-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>How to fix ERR_CONNECTION_RESET Error Code Problem:-</p><ol><li><p>Setup the Maximum Transmission Unit (MTU) –Go to the start menu Type ‘run’ there &amp; click on it Open it &amp; type ” ncpa.cpl ” there Click on OK button or press enter there A pop-up will open, and you will see the wireless networks there Again go to the Run &amp; open it Type “cmd” there &amp; press ok In the Command prompt, type this below the following command netsh interface IPv4 set subinterface “Wireless Network Connection 4” mtu=1472 store=persitent Replace the Local Area Connection with the name of your network adapter Then, Press Enter That’s it, Done</p></li><li><p>By netsh winsock reset Method in Cmd – Go to the start menu Search or type cmd there Go to the cmd &amp; right-click on it Then, click on ‘Run as administrator.’ Type ” netsh winsock reset ” &amp; press enter there Restart your computer again That’s it, done</p></li><li><p>Deactivate your Antivirus or Update &amp; S..... Check out more at; Techinpost.com/fixed-error-<a href="http://www.techinpost.com/fixed-error-err_connection_reset-code-problem"><strong><em>ERR_CONNECTION_RESET</em></strong></a>-code-problem</p></li></ol></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>09 Jul '16, 22:07</strong></p><img src="https://secure.gravatar.com/avatar/bf9fb8a55f334f96ce90b16c2fa033e5?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="rs372433&#39;s gravatar image" /><p><span>rs372433</span><br />
<span class="score" title="1 reputation points">1</span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="rs372433 has no accepted answers">0%</span> </br></br></p></img></div></div><div id="comments-container-53960" class="comments-container"></div><div id="comment-tools-53960" class="comment-tools"></div><div class="clear"></div><div id="comment-53960-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

