+++
type = "question"
title = "Oversized ethernet frames on Crubuntu Chromebook"
description = '''I have a Chromebook that is running chrubuntu. I&#x27;ve tried capturing my traffic (on my host) with Wireshark and tcpdump with the same result - I&#x27;m getting a lot of frames that are over 1700 bytes in size. This is highly unusual as the network doesn&#x27;t support jumbo frames and the MTU on the NIC is set...'''
date = "2013-05-31T07:31:00Z"
lastmod = "2013-06-07T13:51:00Z"
weight = 21653
keywords = [ "chrubuntu" ]
aliases = [ "/questions/21653" ]
osqa_answers = 3
osqa_accepted = false
+++

<div class="headNormal">

# [Oversized ethernet frames on Crubuntu Chromebook](/questions/21653/oversized-ethernet-frames-on-crubuntu-chromebook)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-21653-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-21653-score" class="post-score" title="current number of votes">0</div><span id="post-21653-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I have a Chromebook that is running chrubuntu. I've tried capturing my traffic (on my host) with Wireshark and tcpdump with the same result - I'm getting a lot of frames that are over 1700 bytes in size. This is highly unusual as the network doesn't support jumbo frames and the MTU on the NIC is set to 1500. Wireshark also complains that these packets have a ethernet frame check sequence error.</p><p>I've tried updating libpcap to the latest version and built Wireshark from the latest source.<br />
If I capture upstream of the host, I get normal sized frames.<br />
</p><p>Based on the ARM version of Ubuntu not receiving a lot of attention, I'm speculating this could be a NIC driver issue (it's version 1.0).<br />
</p><p>Any ideas on how to resolve this?</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-chrubuntu" rel="tag" title="see questions tagged &#39;chrubuntu&#39;">chrubuntu</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>31 May '13, 07:31</strong></p><img src="https://secure.gravatar.com/avatar/3f5794cc6defcf8f3fd7949581bfd721?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="randrews_01&#39;s gravatar image" /><p><span>randrews_01</span><br />
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="randrews_01 has no accepted answers">0%</span> </br></br></p></div></div><div id="comments-container-21653" class="comments-container"><span id="21763"></span><div id="comment-21763" class="comment"><div id="post-21763-score" class="comment-score"></div><div class="comment-text"><p>Pcap is shared here: <a href="http://snk.to/f-ctn86ppz">http://snk.to/f-ctn86ppz</a> Again, this is a capture running from the host itself i.e. Wireshark on Chrubuntu</p></div><div id="comment-21763-info" class="comment-info"><span class="comment-age">(05 Jun '13, 06:29)</span> <span class="comment-user userinfo">randrews_01</span></div></div></div><div id="comment-tools-21653" class="comment-tools"></div><div class="clear"></div><div id="comment-21653-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

3 Answers:

</div>

</div>

<span id="21654"></span>

<div id="answer-container-21654" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-21654-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-21654-score" class="post-score" title="current number of votes">0</div><span id="post-21654-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p><a href="http://en.wikipedia.org/wiki/TCP_offload_engine">TCP Offload</a>? The NIC hardware may be segmenting the data into proper size segments and calculating the FCS so at the point of capture this hasn't yet been done, hence the effects you see. Try capturing communications to another device connected to your Chromebook on the other device at the same time to see if this is true. See the Wiki page on <a href="http://wiki.wireshark.org/CaptureSetup/Offloading">offloading</a>.</p><p>Update:</p><p>Are the frames that are affected (size and fcs) all outgoing from your Chromebook? If that's the case it's definitely an offloading issue of some sort.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>31 May '13, 07:44</strong></p><img src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="grahamb&#39;s gravatar image" /><p><span>grahamb ♦</span><br />
<span class="score" title="19834 reputation points"><span>19.8k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">●</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">●</span><span class="badgecount">206</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="grahamb has 274 accepted answers">22%</span> </br></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>31 May '13, 09:02</strong> </span></p></div></div><div id="comments-container-21654" class="comments-container"><span id="21676"></span><div id="comment-21676" class="comment"><div id="post-21676-score" class="comment-score"></div><div class="comment-text"><p>They are all inbound frames.</p></div><div id="comment-21676-info" class="comment-info"><span class="comment-age">(31 May '13, 09:12)</span> <span class="comment-user userinfo">randrews_01</span></div></div><span id="21677"></span><div id="comment-21677" class="comment"><div id="post-21677-score" class="comment-score"></div><div class="comment-text"><p>Inbound frames with an FCS error? That's very odd.</p></div><div id="comment-21677-info" class="comment-info"><span class="comment-age">(31 May '13, 09:26)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div></div><div id="comment-tools-21654" class="comment-tools"></div><div class="clear"></div><div id="comment-21654-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="21655"></span>

<div id="answer-container-21655" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-21655-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-21655-score" class="post-score" title="current number of votes">0</div><span id="post-21655-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>That's most certainly the effect of TCP offloading into the driver. In that case Wireshark will see large packets and the nic driver will take care about TCP segementation.</p><p>You can check/disable TCP offloading on Linux with ethtool.</p><blockquote><p><code>Check: ethtool -k eth0</code><br />
<code>Disable: ethtool -K eth0 tso off</code><br />
</p></blockquote><p>See also here:</p><blockquote><p><a href="http://wiki.wireshark.org/CaptureSetup/Offloading">http://wiki.wireshark.org/CaptureSetup/Offloading</a><br />
<a href="http://linux.die.net/man/8/ethtool">http://linux.die.net/man/8/ethtool</a></p></blockquote><p>Regards<br />
Kurt</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>31 May '13, 07:46</strong></p><img src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Kurt%20Knochner&#39;s gravatar image" /><p><span>Kurt Knochner ♦</span><br />
<span class="score" title="24767 reputation points"><span>24.8k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">●</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">●</span><span class="badgecount">237</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Kurt Knochner has 344 accepted answers">15%</span> </br></br></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>31 May '13, 07:50</strong> </span></p></div></div><div id="comments-container-21655" class="comments-container"><span id="21673"></span><div id="comment-21673" class="comment"><div id="post-21673-score" class="comment-score"></div><div class="comment-text"><p>Hi,</p><p>Thanks for the tips. I checked with ethtool and TSO was already set to off. The only thing set to on was generic-receive-offload.</p></div><div id="comment-21673-info" class="comment-info"><span class="comment-age">(31 May '13, 08:57)</span> <span class="comment-user userinfo">randrews_01</span></div></div><span id="21748"></span><div id="comment-21748" class="comment"><div id="post-21748-score" class="comment-score"></div><div class="comment-text"><p>well, then turn that off ;-))</p></div><div id="comment-21748-info" class="comment-info"><span class="comment-age">(04 Jun '13, 13:02)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="21753"></span><div id="comment-21753" class="comment"><div id="post-21753-score" class="comment-score"></div><div class="comment-text"><p>Turned it off - no difference. I think I'm going to file an OS bug.</p></div><div id="comment-21753-info" class="comment-info"><span class="comment-age">(04 Jun '13, 15:37)</span> <span class="comment-user userinfo">randrews_01</span></div></div><span id="21758"></span><div id="comment-21758" class="comment"><div id="post-21758-score" class="comment-score"></div><div class="comment-text"><blockquote><p>I <strong>have a Chromebook</strong> that is running chrubuntu. I've tried <strong>capturing</strong> my traffic (<strong>on my host</strong>) with Wireshark</p></blockquote><p>Wait a moment? Did you capture the traffic <strong>on</strong> the Chromebook or did you capture the traffic <strong>off</strong> the Chromebook on another system?</p></div><div id="comment-21758-info" class="comment-info"><span class="comment-age">(04 Jun '13, 22:34)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="21759"></span><div id="comment-21759" class="comment"><div id="post-21759-score" class="comment-score"></div><div class="comment-text"><p>Is this traffic possibly internal loopback traffic not leaving the chromebook?</p></div><div id="comment-21759-info" class="comment-info"><span class="comment-age">(04 Jun '13, 23:01)</span> <span class="comment-user userinfo">mrEEde2</span></div></div></div><div id="comment-tools-21655" class="comment-tools"></div><div class="clear"></div><div id="comment-21655-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="21774"></span>

<div id="answer-container-21774" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-21774-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-21774-score" class="post-score" title="current number of votes">0</div><span id="post-21774-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>"frame.len gt 1506 and !eth.trailer gt 0" vs. "frame.len gt 1506 and eth.trailer gt 0" shows that the enlarged packets are due to an added ethernet trailer on inbound packets coming from MAC address "Sonicwal_59:9f:6d". The frame.len is exceeding the standard 1506 (1492 MTU+14 MAC) by an eth.trailer (+ padding) that is obviously added on all inbound frames by a sonicwall VPN client that seems to be running on the chromebook. So, even though this sets off wireshark's expert logic, it should not do any harm to your real data traffic. I suggest you contact sonicwall to get this 'fixed'.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>05 Jun '13, 11:59</strong></p><img src="https://secure.gravatar.com/avatar/d6607c3aca20db751d019d8bbd2da893?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="mrEEde2&#39;s gravatar image" /><p><span>mrEEde2</span><br />
<span class="score" title="336 reputation points">336</span><span title="4 badges"><span class="badge1">●</span><span class="badgecount">4</span></span><span title="6 badges"><span class="silver">●</span><span class="badgecount">6</span></span><span title="14 badges"><span class="bronze">●</span><span class="badgecount">14</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="mrEEde2 has 5 accepted answers">20%</span> </br></br></p></div></div><div id="comments-container-21774" class="comments-container"><span id="21775"></span><div id="comment-21775" class="comment"><div id="post-21775-score" class="comment-score"></div><div class="comment-text"><p>There isn't a VPN client on the Chromebook. In fact Sonicwall doesn't even support ARM and Chrubuntu so it would be impossible to install :)</p><p>Like I mentioned earlier - if I capture upstream of the host I get normal sized frames. I also get normal sized frames from hosts on the other segments.</p></div><div id="comment-21775-info" class="comment-info"><span class="comment-age">(05 Jun '13, 12:07)</span> <span class="comment-user userinfo">randrews_01</span></div></div><span id="21776"></span><div id="comment-21776" class="comment"><div id="post-21776-score" class="comment-score"></div><div class="comment-text"><p>Sorry for the confusion then. Wonder how this MAC address prefix comes from then... What exactly do you mean by "if I capture upstream of the host". Is that tracing externally in the ethernet? And then also your inbound frames going to 192.183.3.11 look 'normal'?</p></div><div id="comment-21776-info" class="comment-info"><span class="comment-age">(05 Jun '13, 12:16)</span> <span class="comment-user userinfo">mrEEde2</span></div></div><span id="21777"></span><div id="comment-21777" class="comment"><div id="post-21777-score" class="comment-score"></div><div class="comment-text"><p>Ok, there is one other ARP packet arriving that also has an ethernet padding/trailer added to the MAC header which comes from an Intel machine: eth.src == c0:ea:e4:59:9f:6d. This one also has a wrong FCS. So the SonicWall is not the only one and therefore is not causing this.</p></div><div id="comment-21777-info" class="comment-info"><span class="comment-age">(05 Jun '13, 13:09)</span> <span class="comment-user userinfo">mrEEde2</span></div></div><span id="21801"></span><div id="comment-21801" class="comment"><div id="post-21801-score" class="comment-score"></div><div class="comment-text"><p>Ok, we're getting closer. The problem seems to be that the packet capture software fills every inbound frame with some residual data when writing it to the pcap file. Wireshark interprets those as ethernet padding/trailer/FCS. How exactly did you capture the trace data?</p></div><div id="comment-21801-info" class="comment-info"><span class="comment-age">(06 Jun '13, 07:57)</span> <span class="comment-user userinfo">mrEEde2</span></div></div><span id="21802"></span><div id="comment-21802" class="comment"><div id="post-21802-score" class="comment-score"></div><div class="comment-text"><p>Boot laptop. Start Wireshark on laptop. Capture on mlan0. Surf websites on same laptop. Stop capture.</p></div><div id="comment-21802-info" class="comment-info"><span class="comment-age">(06 Jun '13, 08:46)</span> <span class="comment-user userinfo">randrews_01</span></div></div><span id="21803"></span><div id="comment-21803" class="comment not_top_scorer"><div id="post-21803-score" class="comment-score"></div><div class="comment-text"><p>.. and using tcpdump you are getting the same results?</p></div><div id="comment-21803-info" class="comment-info"><span class="comment-age">(06 Jun '13, 09:00)</span> <span class="comment-user userinfo">mrEEde2</span></div></div><span id="21804"></span><div id="comment-21804" class="comment not_top_scorer"><div id="post-21804-score" class="comment-score"></div><div class="comment-text"><p>tcpdump = same results</p></div><div id="comment-21804-info" class="comment-info"><span class="comment-age">(06 Jun '13, 09:11)</span> <span class="comment-user userinfo">randrews_01</span></div></div><span id="21827"></span><div id="comment-21827" class="comment not_top_scorer"><div id="post-21827-score" class="comment-score"></div><div class="comment-text"><p>ok, so the problem seems to be in writing additonal bytes to the capture file which were never received by the mlan0 adapter. This is generating false alerts in wireshark but should not have any adverse effect in your traffic. The easiest way is to disable the FCS validation in the ethernet preferences. In addition (ch)ubuntu experts should be looking at this to ...</p></div><div id="comment-21827-info" class="comment-info"><span class="comment-age">(07 Jun '13, 13:51)</span> <span class="comment-user userinfo">mrEEde2</span></div></div></div><div id="comment-tools-21774" class="comment-tools"><span class="comments-showing"> showing 5 of 8 </span> <a href="#" class="show-all-comments-link">show 3 more comments</a></div><div class="clear"></div><div id="comment-21774-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

