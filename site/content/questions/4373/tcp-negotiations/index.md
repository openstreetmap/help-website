+++
type = "question"
title = "TCP Negotiations"
description = '''I read this statement from a supposed Cisco employee on LinkedIn this morning: &quot;I don&#x27;t know how many times I&#x27;ve had to say this but there is NO NEGOTIATION in tcp window sizes. In fact, there is NO NEGOTIATION in tcp period. The closest parameter that might come to tcp negotiation is the SACK optio...'''
date = "2011-06-04T08:54:00Z"
lastmod = "2014-02-23T05:57:00Z"
weight = 4373
keywords = [ "negotiation", "semantics", "tcp" ]
aliases = [ "/questions/4373" ]
osqa_answers = 4
osqa_accepted = true
+++

<div class="headNormal">

# [TCP Negotiations](/questions/4373/tcp-negotiations)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-4373-score" class="post-score" title="current number of votes">3</div><div id="favorite-count" class="favorite-count">2</div></div></td><td><div id="item-right"><div class="question-body"><p>I read this statement from a supposed Cisco employee on LinkedIn this morning:</p><p>"I don't know how many times I've had to say this but there is NO NEGOTIATION in tcp window sizes. In fact, there is NO NEGOTIATION in tcp period. The closest parameter that might come to tcp negotiation is the SACK option at the beginning of the connection."</p><p>I often find myself in arguments of semantics..I've found that most people in professions dealing with this level of detail do also. My knee jerk reaction was to post this reply:</p><p>"Stating that "there is NO NEGOTIATION in tcp period" is, at best, an argument of semantics. MSS is negotiated, the three-way handshake is, itself, a negotiation, someone mentioned SACK, and what about Window Scaling?"</p><p>Someone else in the thread agreed with the Cisco fellow, and I've seen no follow up comments yet.</p><p>So I'm asking this community - are there negotiations in TCP? Or are there only notifications of state?</p></div><div id="question-tags" class="tags-container tags">negotiation semantics tcp</div><div id="question-controls" class="post-controls"><div class="community-wiki">This question is marked "community wiki".</div></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>04 Jun '11, 08:54</strong></p><img src="https://secure.gravatar.com/avatar/9e493496d59bb4ce33c37cd6e7a26a4d?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="GeonJay&#39;s gravatar image" /><p>GeonJay<br />
<span class="score" title="470 reputation points">470</span><span title="5 badges"><span class="badge1">●</span><span class="badgecount">5</span></span><span title="9 badges"><span class="silver">●</span><span class="badgecount">9</span></span><span title="22 badges"><span class="bronze">●</span><span class="badgecount">22</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="GeonJay has 2 accepted answers">5%</span></p></div></div><div id="comments-container-4373" class="comments-container"></div><div id="comment-tools-4373" class="comment-tools"></div><div class="clear"></div><div id="comment-4373-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

4 Answers:

</div>

</div>

<span id="4375"></span>

<div id="answer-container-4375" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-4375-score" class="post-score" title="current number of votes">6</div></div></td><td><div class="item-right"><div class="answer-body"><p>I don't think you're going to get a definitive answer here, or anywhere else, because it's very much a matter of semantics. Any response is going to be a matter of opinion, and it depends on exactly where you split the hair. I tend to come down on the side of those who say that there is no negotiation, only announcements of state. To me, "negotiation" means that the two sides have to agree on something, and negotiation is the process by which one or both sides proposes one or more values for a parameter, and then an agreed upon value is selected.</p><p>So, MSS is definitely not negotiated. Each system announces its MSS, and the other system abides by it. When computer A sends a SYN packet with an MSS of 1,460 and computer B responds with a SYN/ACK that has an MSS of 1,380, computer A is not "proposing" that they use 1,460, and computer B is not countering with a different proposal; they are simply each announcing their own limit. B will not send any packets with a segment larger than 1,460 bytes to A, and A will not send any packets with a segment larger than 1,380 bytes to B. (There is no requirement that B send 1,460 byte segments to A; only that B not EXCEED 1,460 bytes. B can limit itself to 1,380 bytes if it chooses.)</p><p>Compare this with the CIFS Protocol Dialect Negotiation. The client sends a list of the CIFS dialects that it supports; the server compares the list with the dialects that the server supports, and then it selects a common dialect to be used by both the client and server and notifies the client of its selection. That seems to me to be a classic example of negotiation. It results in the use of a common value that both sides agree upon.</p><p>How about window scaling? Well, here we get deep into the semantic pit. I would say that each side that supports window scaling announces that fact. But this is English, not binary, and there isn't always precise agreement on definitions, so if you want to describe it by saying that they negotiate the use of window scaling, I'm not going to quibble with your terminology.</p><p>However, whether or not window scaling is used, there is no negotiation of the actual window size values. Each side simply announces its window size (and scaling factor, if window scaling is used) and the other side abides by it.</p><p>Same for TCP timestamps and selective ACK. Whether you want to say that the two systems "announce" their support for timestamps and/or SACK, or they "negotiate" the use of timestamps and/or SACK is a matter of semantics upon which reasonable people can disagree. However, it is clear that when either timestamps or SACK is used, there is no negotiation of the values. Each side announces its value(s) and the other side accepts it.</p><p>Between the two sides of a TCP connection, there is no agreement--negotiated or otherwise--between initial sequence numbers, maximum segment size, timestamp values, window sizes, and selective ACK values. Each side's values are independent of the other's.</p><p>Whether you take the position that there is or isn't negotiation in TCP depends on your definition of "negotiation," and we're in a gray area where either definition is defensible. I'm a proponent of precise language in technical areas, but in this case to insist that there is or isn't negotiation in TCP is overly pedantic. The important thing is that we understand and agree about what is happening; not that we agree on whether it can be characterized as "negotiation."</p><p>So, while I wouldn't do so, if you want to say that the three-way handshake is a negotiation, have at it. (Although, of course, you're wrong; and BTW, exactly 3,417 angels can fit on the head of a pin. :&lt;) )</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>04 Jun '11, 14:09</strong></p><img src="https://secure.gravatar.com/avatar/071fe61f64868d98bdf4eb060b63b6ca?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Jim%20Aragon&#39;s gravatar image" /><p>Jim Aragon<br />
<span class="score" title="7187 reputation points"><span>7.2k</span></span><span title="7 badges"><span class="badge1">●</span><span class="badgecount">7</span></span><span title="33 badges"><span class="silver">●</span><span class="badgecount">33</span></span><span title="118 badges"><span class="bronze">●</span><span class="badgecount">118</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Jim Aragon has 70 accepted answers">24%</span></p></div></div><div id="comments-container-4375" class="comments-container"><span id="4377"></span><div id="comment-4377" class="comment"><div id="post-4377-score" class="comment-score">1</div><div class="comment-text"><p>Excellent response Jim!!! I have a history of pedantic arguments of semantics. I also have an aversion to absolutes. The language used by that particular submitter struck me as potentially confusing and misleading to folks who are less experienced.</p></div><div id="comment-4377-info" class="comment-info"><span class="comment-age">(04 Jun '11, 20:26)</span> GeonJay</div></div></div><div id="comment-tools-4375" class="comment-tools"></div><div class="clear"></div><div id="comment-4375-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="4382"></span>

<div id="answer-container-4382" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-4382-score" class="post-score" title="current number of votes">2</div></div></td><td><div class="item-right"><div class="answer-body"><p>Absolutism's are never my favorite, I don't think there is anything absolute in this universe :-)</p><p>However, in protocol analysis, it is good to practice to use precise wording to enhance your own understanding and that of others.</p><p>If someone thinks of the sending of TCP MSS options as a negotiation, he will think that when A announced a MSS to B of 1460 (as seen at host B) and B announced a MSS of 1380 back to B, it is faulty for B to send a packet with 1460 bytes of TCP payload to A, while in fact it is perfectly OK.</p><p>Most exchanges of information in TCP tend to be announcements and not negotiations. However, there are indeed some negotiations. Although things can get a bit misty. Window scaling is a nice hybrid example of a misty situation.</p><p>Sending window scaling options can be seen both as a negotiation and as an announcement. The WS option in the SYN packet is the start of the negotiation whether to use window scaling or not. At the same time it is the announcement of which scaling factor the client is going to use (if WS is accepted by the server). The WS in the SYN/ACK is part two of the negotiation telling the client that the server agrees on using window scaling and it is also the announcement of the scaling factor that the server is going to use in its window size announcements.</p><p>All in all, I think it all boils down to getting to know the workings of the protocols and trying to use the right wording in each case. It also means helping others understand the little intricacies of a protocol when they do not choose the right wording (I think Guy Harris is a hero in this respect!). The Cisco guy did not get this IMHO (even though I understand that it can become tiresome to explain over and over again to customers how MSS is not a negotiation for example).</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>05 Jun '11, 03:38</strong></p><img src="https://secure.gravatar.com/avatar/7901a94d8fdd1f9f47cda9a32fcfa177?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="SYN-bit&#39;s gravatar image" /><p>SYN-bit ♦♦<br />
<span class="score" title="17094 reputation points"><span>17.1k</span></span><span title="9 badges"><span class="badge1">●</span><span class="badgecount">9</span></span><span title="57 badges"><span class="silver">●</span><span class="badgecount">57</span></span><span title="245 badges"><span class="bronze">●</span><span class="badgecount">245</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="SYN-bit has 174 accepted answers">20%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 05 Jun '11, 22:24</p></div></div><div id="comments-container-4382" class="comments-container"><span id="4405"></span><div id="comment-4405" class="comment"><div id="post-4405-score" class="comment-score"></div><div class="comment-text"><p>I've considered MSS to be negotiated because of my observations and NOT because I actually did my homework and reviewed the process. Usually when Side B announces a smaller MSS, I will also see him adhere to it when he sends large packets. I ASSumed this was required..but it's not. I've thought about it and unless Side B is hardcoded to use a smaller MTU then it's likely that the small MSS was actually set by some network device in the middle of the stream and NOT by SideB itself. Thanks for making me think SYNbit!</p></div><div id="comment-4405-info" class="comment-info"><span class="comment-age">(06 Jun '11, 07:38)</span> GeonJay</div></div></div><div id="comment-tools-4382" class="comment-tools"></div><div class="clear"></div><div id="comment-4382-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="4389"></span>

<div id="answer-container-4389" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-4389-score" class="post-score" title="current number of votes">2</div></div></td><td><div class="item-right"><div class="answer-body"><p>I said above that I tend to come down on the side of those who say that there are announcements of state, not negotiation, in TCP. After thinking about this some more, and reading Sake's comment, I'm going to move a little more toward the center.</p><p>Sticking with my definition of "negotiation" as the process by which two systems agree on something, it's clear that MSS is not negotiated, and initial sequence numbers are not negotiated.</p><p>In the case of window scaling, TCP timestamps, and SACK, I think it's fair terminology to say that the USE of these options is negotiated, but the VALUES to be used are announced. (And you can go so far as to consider these announcements to be part of, not separate from, the negotiation process. Have we slogged far enough into the semantic swamp yet?)</p><p>So, yes, LinkedIn Cisco guy, there is negotiation in TCP.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>05 Jun '11, 16:59</strong></p><img src="https://secure.gravatar.com/avatar/071fe61f64868d98bdf4eb060b63b6ca?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Jim%20Aragon&#39;s gravatar image" /><p>Jim Aragon<br />
<span class="score" title="7187 reputation points"><span>7.2k</span></span><span title="7 badges"><span class="badge1">●</span><span class="badgecount">7</span></span><span title="33 badges"><span class="silver">●</span><span class="badgecount">33</span></span><span title="118 badges"><span class="bronze">●</span><span class="badgecount">118</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Jim Aragon has 70 accepted answers">24%</span></p></div></div><div id="comments-container-4389" class="comments-container"><span id="4406"></span><div id="comment-4406" class="comment"><div id="post-4406-score" class="comment-score"></div><div class="comment-text"><p>Would calling myself pedantically childish be redundant? ;-) I poked the bear and replied back to the LinkedIn thread..I know that I probably shouldn't have, but I did anyway.</p></div><div id="comment-4406-info" class="comment-info"><span class="comment-age">(06 Jun '11, 07:39)</span> GeonJay</div></div><span id="4409"></span><div id="comment-4409" class="comment"><div id="post-4409-score" class="comment-score">1</div><div class="comment-text"><p>@GeonJay, I have joined the fray and added my own comment. Again, this is a matter of semantics, which is why I object to Cisco guy's absolute statement.</p><p>The real argument here is not over technology, it's over language, which is inherently imprecise.</p><p>I don't think anyone disagrees about what happens; the whole argument is about what to call it.</p><p>Now go poke the bear some more.</p></div><div id="comment-4409-info" class="comment-info"><span class="comment-age">(06 Jun '11, 09:15)</span> Jim Aragon</div></div></div><div id="comment-tools-4389" class="comment-tools"></div><div class="clear"></div><div id="comment-4389-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="30105"></span>

<div id="answer-container-30105" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-30105-score" class="post-score" title="current number of votes">1</div></div></td><td><div class="item-right"><div class="answer-body"><p>It is right in the <a href="http://tools.ietf.org/html/rfc879#section-3">RFC 879 from 1983</a></p><blockquote><p>This Maximum Segment Size (MSS) announcement (often mistakenly called a negotiation)...</p></blockquote><p>For that part...</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>23 Feb '14, 05:57</strong></p><img src="https://secure.gravatar.com/avatar/7389b90dc1858e673a6f6dc8d31e7648?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="TRNCFRMCN&#39;s gravatar image" /><p>TRNCFRMCN<br />
<span class="score" title="16 reputation points">16</span><span title="1 badges"><span class="bronze">●</span><span class="badgecount">1</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="TRNCFRMCN has no accepted answers">0%</span></p></div></div><div id="comments-container-30105" class="comments-container"></div><div id="comment-tools-30105" class="comment-tools"></div><div class="clear"></div><div id="comment-30105-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

