+++
type = "question"
title = "How can I determine if ip is compromised?"
description = '''I recently installed Wireshark on my computer after having a major security breach. I have run several scans on my computer including Malwarebytes, Superantispyware, CC cleaner, adw cleaner, McAfee Life save, and windows defender. Still, when I open Wireshark, it would appear there is still an excha...'''
date = "2016-11-08T22:29:00Z"
lastmod = "2016-11-09T09:31:00Z"
weight = 57197
keywords = [ "security", "network", "ask.wireshark.org" ]
aliases = [ "/questions/57197" ]
osqa_answers = 2
osqa_accepted = false
+++

<div class="headNormal">

# [How can I determine if ip is compromised?](/questions/57197/how-can-i-determine-if-ip-is-compromised)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-57197-score" class="post-score" title="current number of votes">0</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I recently installed Wireshark on my computer after having a major security breach. I have run several scans on my computer including Malwarebytes, Superantispyware, CC cleaner, adw cleaner, McAfee Life save, and windows defender. Still, when I open Wireshark, it would appear there is still an exchange of packets with ip address all over the USA and a couple in Hong Kong (found via iplocation.net). I looked up some of these iPs on mxtoolbox.com, and none were blacklisted, so that is somewhat reassuring. Still, I wonder if this traffic is malicious or not? Is there any surefire way to tell? Is there someone I can trust to share the captured packet exchange with?</p></div><div id="question-tags" class="tags-container tags">security network ask.wireshark.org</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>08 Nov '16, 22:29</strong></p><img src="https://secure.gravatar.com/avatar/f16f45dc3f0f5e7325ade5cc5af202b3?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="bmgguy&#39;s gravatar image" /><p>bmgguy<br />
<span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="bmgguy has no accepted answers">0%</span></p></div></div><div id="comments-container-57197" class="comments-container"></div><div id="comment-tools-57197" class="comment-tools"></div><div class="clear"></div><div id="comment-57197-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

2 Answers:

</div>

</div>

<span id="57216"></span>

<div id="answer-container-57216" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-57216-score" class="post-score" title="current number of votes">2</div></div></td><td><div class="item-right"><div class="answer-body"><p>If you had a "major security breach" you should consider to reinstall your workstation / server from scratch. If the attacker had administrative rights on your computer, it is very hard to identify all the activities on the computer.</p><p>Installing Wireshark on a compromised system is often useless: Several malware families will change their behavior when they see signs of an ongoing analysis. They will detect and react to software like Wireshark or Sysinternals tools.</p><p>Running Malware bytes or Anti Virus will not really help: Many malware families have the ability to download and run additional programs. Regular malware / crimeware that is found in any spam honeypot can evade a virus scanner for a week, sometimes longer.</p><p>A serious attacker will store malware outside of the Windows file systems. Typical candidates are the Master Boot Record, unpartitioned areas of the hard disk or even the BIOS. The somewhat outdated TDL4 or the more recent Lighteater are two of more elaborate programs.</p><p>As far as the traffic is involved, this can be part of a routine traffic. All Windows systems pull down patches, query the status of SSL certificates or update virus patterns. Your application mix might add extra packets. Messaging applications like Skype are known to send packets to a surprisingly large number of seemingly random destination IP addresses.</p><p>A full analysis would be a major consulting job. Again: The best advise is to reinstall the system from scratch.</p><p>Good hunting</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>09 Nov '16, 09:31</strong></p><img src="https://secure.gravatar.com/avatar/3b60e92020a427bb24332efc0b560943?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="packethunter&#39;s gravatar image" /><p>packethunter<br />
<span class="score" title="2137 reputation points"><span>2.1k</span></span><span title="7 badges"><span class="badge1">●</span><span class="badgecount">7</span></span><span title="15 badges"><span class="silver">●</span><span class="badgecount">15</span></span><span title="48 badges"><span class="bronze">●</span><span class="badgecount">48</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="packethunter has 8 accepted answers">8%</span></p></div></div><div id="comments-container-57216" class="comments-container"><span id="57219"></span><div id="comment-57219" class="comment"><div id="post-57219-score" class="comment-score"></div><div class="comment-text"><p>Thanks packethunter</p><p>This is just a personal pc we are talking about. I was thinking about running a full factory reset to give me piece of mind. Is this what you mean by a re-install?</p></div><div id="comment-57219-info" class="comment-info"><span class="comment-age">(09 Nov '16, 10:41)</span> bmgguy</div></div><span id="57224"></span><div id="comment-57224" class="comment"><div id="post-57224-score" class="comment-score">2</div><div class="comment-text"><p>Full factory reset of a notebook PC actually means a re-install from some hidden installation partition; the question is whether it is hidden enough that the malware couldn't find and infect it.</p><p>So if you cannot install the OS from an external R/O media, the "full factory reset" may not be a guarantee that you get rid of the infection.</p></div><div id="comment-57224-info" class="comment-info"><span class="comment-age">(09 Nov '16, 13:22)</span> sindy</div></div><span id="57228"></span><div id="comment-57228" class="comment"><div id="post-57228-score" class="comment-score">1</div><div class="comment-text"><p>Sindy hit the nail right on the head. You want to use a CD-ROM/DVD or other read-only media. Or a recovery image that was created before the infection.</p></div><div id="comment-57228-info" class="comment-info"><span class="comment-age">(09 Nov '16, 13:58)</span> packethunter</div></div><span id="57229"></span><div id="comment-57229" class="comment"><div id="post-57229-score" class="comment-score"></div><div class="comment-text"><p>I have the full system reset going atm. Does this not wipe the entire hard drive and build up again from scratch? I think this may wipe any recovery save on the computers recovery disk. Thankfully I have the system backed-up a few months prior to the incident on an external hard drive. Do you suggest I restore the system from the external hard drive? Should I contact Microsoft and ask them to send me a read-only version of the OS?</p><p>Another idea I had was upgrading to windows 10 once the system reset is complete. The default OS for this machine is windows 8 which is less than desirable. Not sure how this upgrade might impact things.</p><p>Also meant to add this is not a notebook PC. This an hp all-in-one desk top</p></div><div id="comment-57229-info" class="comment-info"><span class="comment-age">(09 Nov '16, 14:34)</span> bmgguy</div></div><span id="57243"></span><div id="comment-57243" class="comment"><div id="post-57243-score" class="comment-score">1</div><div class="comment-text"><blockquote><p>this is not a notebook PC. This an hp all-in-one desk top</p></blockquote><p>It is not important what the hardware looks like mechanically. It is important whether the media on which the image used for "full factory reset" were connected to the machine while the malware was active, which is the case for most contemporary workstations which are shipped pre-installed, and whether the embedded recovery media are write-protected enough that the malware could not bypass that write-protection. The hardware vendor should be able to give you details about this (but they may use a pink filter) and, more important, tell you how to check integrity of the image if you boot from external R/O media. Any such check performed while booted from the compromised media may be "improved" by the malware.</p><p>If you have made a recovery image yourself on some RW media (an external USB HDD as an example) prior to getting infected, the key to success is that those media would have never been connected to the machine after it got infected. So to use that image for recovery, you need to boot from R/O media first, otherwise the malware will activate at boot, survive in RAM and infect both the recovered system and the recovery image.</p></div><div id="comment-57243-info" class="comment-info"><span class="comment-age">(10 Nov '16, 01:53)</span> sindy</div></div><span id="57280"></span><div id="comment-57280" class="comment not_top_scorer"><div id="post-57280-score" class="comment-score"></div><div class="comment-text"><p>Thanks all for you help. Just to give the story a somewhat happy ending. I took the computer to a local Best Buy (comp store) and they wiped the Hard drive and reloaded the OS from one of their many USBs. Should be good to go know I would think.</p><p>Wireshark has been an informative tool and I plan to use it from time to time again</p></div><div id="comment-57280-info" class="comment-info"><span class="comment-age">(10 Nov '16, 13:53)</span> bmgguy</div></div></div><div id="comment-tools-57216" class="comment-tools"><span class="comments-showing"> showing 5 of 6 </span> <a href="#" class="show-all-comments-link">show 1 more comments</a></div><div class="clear"></div><div id="comment-57216-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="57200"></span>

<div id="answer-container-57200" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-57200-score" class="post-score" title="current number of votes">1</div></div></td><td><div class="item-right"><div class="answer-body"><p>Try to write down these suspected IPs and then use Sysinternals TCPView or Procmon utility to figure out what exact Windows process is initiating them. Also you can look through these flows ("follow TCP/UDP stream" feature) to spot if there any clear-text data inside of them.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>09 Nov '16, 00:42</strong></p><img src="https://secure.gravatar.com/avatar/1e22670f8d643ca08d658b80a6782932?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Packet_vlad&#39;s gravatar image" /><p>Packet_vlad<br />
<span class="score" title="436 reputation points">436</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="6 badges"><span class="silver">●</span><span class="badgecount">6</span></span><span title="13 badges"><span class="bronze">●</span><span class="badgecount">13</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Packet_vlad has 5 accepted answers">20%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 09 Nov '16, 00:43</p></div></div><div id="comments-container-57200" class="comments-container"><span id="57218"></span><div id="comment-57218" class="comment"><div id="post-57218-score" class="comment-score"></div><div class="comment-text"><p>Thanks for the response.</p><p>I installed TCPView, and it was somewhat helpful. I don't see any illicit remote addresses that have established communications with my pc.</p><p>SO final question is then is it normal to have a little bit of 'data' (~1% of packets) in the protocol hierarchy under each of TCP, IPV4, TCP? When I filter for the 'data' from the hierarchy, none of the communications appear illicit. Occasionally there is some kind of packet with [TCP Keep-Alive] in it. Otherwise, it just seems to be exchanges between my computer and my ISP. Some of the youtube videos I watched on WireShard we saying that seeing this 'data' under the protocol hierarchy is bad, but perhaps just seeing a lot of it, like &gt;5% of packets perhaps is a sign for concern?</p><p>Thanks again</p></div><div id="comment-57218-info" class="comment-info"><span class="comment-age">(09 Nov '16, 10:26)</span> bmgguy</div></div></div><div id="comment-tools-57200" class="comment-tools"></div><div class="clear"></div><div id="comment-57200-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

