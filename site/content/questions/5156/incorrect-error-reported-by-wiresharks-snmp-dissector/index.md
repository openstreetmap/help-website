+++
type = "question"
title = "Incorrect error reported by Wireshark&#x27;s SNMP dissector"
description = '''In the MIB extract below, SNMP variable radarName, used as INDEX, is defined as DisplayString (SIZE (4)) in the OBJECT-TYPE definition. DisplayString is imported from SNMPv2-TC and defined as OCTET STRING (SIZE(0..255)). In the ASN1 SEQUENCE radarName is defined with SYNTAX DisplayString and this is...'''
date = "2011-07-21T09:18:00Z"
lastmod = "2011-07-21T09:18:00Z"
weight = 5156
keywords = [ "incorrect_error_msg", "snmp" ]
aliases = [ "/questions/5156" ]
osqa_answers = 0
osqa_accepted = false
+++

<div class="headNormal">

# [Incorrect error reported by Wireshark's SNMP dissector](/questions/5156/incorrect-error-reported-by-wiresharks-snmp-dissector)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-5156-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-5156-score" class="post-score" title="current number of votes">0</div><span id="post-5156-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>In the MIB extract below, SNMP variable radarName, used as INDEX, is defined as DisplayString (SIZE (4)) in the OBJECT-TYPE definition. DisplayString is imported from SNMPv2-TC and defined as OCTET STRING (SIZE(0..255)). In the ASN1 SEQUENCE radarName is defined with SYNTAX DisplayString and this is where the trouble starts. According to the ASN SEQUENCE definition the radarName will be encoded as variable string, so 1 length bytes and "length" databytes. According to the OBJECT TYPE definition, specializing the type, radarName will be encoded as a fixed string of 4 bytes.</p><p>Send over the wire is indeed a fixed 4 byte string, which is correctly interpreted by our management station using SNMP++ and libsmi. However wireshark is reporting a problem because it expects a variable length string and puts an error message "index string should not be longer than remaining oid size" on the screen. It interprets the first string byte as length. To my opinion wireshark's implementation is incorrect. The SNMP dissector (epan/dissectors/packet-snmp.c) is generated automatically by the ASN.1 to Wireshark dissector compiler and so misses the specialization to a fixed string variable as defined in the OBJECT-TYPE. I have checked the MIB on the internet with the libsmi online checker, which does not report an error on the used constructs. Does someone agree with me that the wireshark's implementation is incorrect ?</p><p>radarEntry OBJECT-TYPE SYNTAX RadarEntry MAX-ACCESS not-accessible STATUS current DESCRIPTION "A radar managed by ART-DACO. " INDEX { radarName } ::= { radarTable 1 }</p><p>RadarEntry ::= SEQUENCE { radarName DisplayString, radarActConfStatus RadConfType, radarIntConfStatus RadConfType, radarActOperationalPath PathIdType, radarIntOperationalPath PathIdType, sensorPsrStatus SensorRadStatusType, sensorSsrStatus SensorRadStatusType, sensorMdsStatus SensorRadStatusType, sensorRadarOverload RadOverloadType, sensorRadarError RadErrorType, artasRadarSiteStatus ArtasRadStatusType, artasRadarOverload RadOverloadType, artasRadarSsrRangeGain Integer32, artasRadarSsrRangeBias Integer32, artasRadarSsrAzimuthBias Integer32, artasRadarPsrRangeGain Integer32, artasRadarPsrRangeBias Integer32, artasRadarPsrAzimuthBias Integer32, artasRadarTimeBias Integer32, radarNbScan Integer32, radarOutGlobalTotalSnd Integer32, radarOutGlobalNbSndAst001 Integer32, radarOutGlobalNbSndAst002 Integer32, radarOutGlobalNbSndAst034 Integer32, radarOutGlobalNbSndAst048 Integer32, radarOutGlobalNbScanMarkerMsg Integer32, radarOutGlobalNbSectorMsg Integer32, radarOutGlobalNbPsrTarget Integer32, radarOutGlobalNbSsrTarget Integer32, radarOutGlobalNbMdsTarget Integer32, radarOutGlobalNbPsrSsrTarget Integer32, radarOutGlobalNbPsrMdsTarget Integer32, radarOutGlobalNbCancelMsg Integer32, radarOutScanTotalSnd Integer32, radarOutScanNbSndAst001 Integer32, radarOutScanNbSndAst002 Integer32, radarOutScanNbSndAst034 Integer32, radarOutScanNbSndAst048 Integer32, radarOutScanNbScanMarkerMsg Integer32, radarOutScanNbSectorMsg Integer32, radarOutScanNbPsrTarget Integer32, radarOutScanNbSsrTarget Integer32, radarOutScanNbMdsTarget Integer32, radarOutScanNbPsrSsrTarget Integer32, radarOutScanNbPsrMdsTarget Integer32, radarOutScanNbCancelMsg Integer32, radarOutScanCmbRate Integer32, radarBiasStartTime DisplayString, radarBiasNumSamples Integer32, radarBiasRangeMean DisplayString, radarBiasRangeConfidenceStart DisplayString, radarBiasRangeConfidenceEnd DisplayString, radarBiasAzimuthMean DisplayString, radarBiasAzimuthConfidenceStart DisplayString, radarBiasAzimuthConfidenceEnd DisplayString, radarAlarm AlarmSeverityType, radarAlarmSummary AlarmSummaryType, radarAlarmDetails AlarmDetailsType }</p><p>radarName OBJECT-TYPE SYNTAX DisplayString (SIZE (4)) MAX-ACCESS read-only STATUS current DESCRIPTION "Name of this radar. This variable is used as an index for the radarTable. " ::= { radarEntry 1 }</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-incorrect_error_msg" rel="tag" title="see questions tagged &#39;incorrect_error_msg&#39;">incorrect_error_msg</span> <span class="post-tag tag-link-snmp" rel="tag" title="see questions tagged &#39;snmp&#39;">snmp</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>21 Jul '11, 09:18</strong></p><img src="https://secure.gravatar.com/avatar/2dd33b4989df484f715465f5c90b2184?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="MommersMHA&#39;s gravatar image" /><p><span>MommersMHA</span><br />
<span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="bronze">●</span><span class="badgecount">1</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="MommersMHA has no accepted answers">0%</span></p></div></div><div id="comments-container-5156" class="comments-container"></div><div id="comment-tools-5156" class="comment-tools"></div><div class="clear"></div><div id="comment-5156-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

</div>

