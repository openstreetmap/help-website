+++
type = "question"
title = "tshark -z follow stops after missing package"
description = '''I analyze .pcap and .cap files using tshark&#x27;s -z follow option. This works mighty fine on most of the streams, however in some streams I get there can be one or more missing/broken packages. In this case the -z option prints only the content up to the first missing/damaged package and everything aft...'''
date = "2014-02-12T06:03:00Z"
lastmod = "2014-02-26T03:48:00Z"
weight = 29761
keywords = [ "follow", "broken", "z", "tshark", "package" ]
aliases = [ "/questions/29761" ]
osqa_answers = 2
osqa_accepted = false
+++

<div class="headNormal">

# [tshark -z follow stops after missing package](/questions/29761/tshark-z-follow-stops-after-missing-package)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-29761-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-29761-score" class="post-score" title="current number of votes">0</div><span id="post-29761-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I analyze .pcap and .cap files using tshark's -z follow option. This works mighty fine on most of the streams, however in some streams I get there can be one or more missing/broken packages. In this case the -z option prints only the content up to the first missing/damaged package and everything after that is skipped. How can I get tshark to continue after the missing packets?</p><p><strong>UPDATE:</strong> As it seems tcpflow and all the other tools I tested face the same problem as tshark... Is there another way to get the tcp data then "-z follow"? Where is this option implemented in the Wireshark source?</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-follow" rel="tag" title="see questions tagged &#39;follow&#39;">follow</span> <span class="post-tag tag-link-broken" rel="tag" title="see questions tagged &#39;broken&#39;">broken</span> <span class="post-tag tag-link-z" rel="tag" title="see questions tagged &#39;z&#39;">z</span> <span class="post-tag tag-link-tshark" rel="tag" title="see questions tagged &#39;tshark&#39;">tshark</span> <span class="post-tag tag-link-package" rel="tag" title="see questions tagged &#39;package&#39;">package</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>12 Feb '14, 06:03</strong></p><img src="https://secure.gravatar.com/avatar/ffb8d28ab79b30964586fba1dc7e2696?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="tonivalac&#39;s gravatar image" /><p><span>tonivalac</span><br />
<span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="5 badges"><span class="bronze">●</span><span class="badgecount">5</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="tonivalac has one accepted answer">100%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>17 Feb '14, 02:15</strong> </span></p></div></div><div id="comments-container-29761" class="comments-container"><span id="29762"></span><div id="comment-29762" class="comment"><div id="post-29762-score" class="comment-score"></div><div class="comment-text"><p>Some questions:</p><ul><li>what is your OS and OS version of the Wireshark system?</li><li>what is your Wireshark version?</li><li>how do you capture the traffic (with Wireshark, or other tools)?</li><li>is it possible to post a sample capture file somewhere (google drive, dropbox, cloudshark.org)?</li></ul></div><div id="comment-29762-info" class="comment-info"><span class="comment-age">(12 Feb '14, 06:22)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="29765"></span><div id="comment-29765" class="comment"><div id="post-29765-score" class="comment-score"></div><div class="comment-text"><p>I need something that runs on Windows and Linux, the capture is done with a different tool and I am really sorry, but for various reasons I can not post a sample capture file.</p><p>To make my point clearer: I have running code and I know the flows contain more data then the -z follow option (or Wiresharks follow tcp stream) display. This is caused by missing or malformed packages. As far as I know tshark/wireshark is configured to stop extracting the data from a flow on such packages by default.</p><p>What I would like best would be a solution where I can keep using tshark -z follow, but configure it to skip the missing/malformed packages and reconstruct all the correct data in a flow</p></div><div id="comment-29765-info" class="comment-info"><span class="comment-age">(12 Feb '14, 06:42)</span> <span class="comment-user userinfo">tonivalac</span></div></div><span id="29769"></span><div id="comment-29769" class="comment"><div id="post-29769-score" class="comment-score"></div><div class="comment-text"><p>what is your Wireshark version?</p></div><div id="comment-29769-info" class="comment-info"><span class="comment-age">(12 Feb '14, 06:53)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="29770"></span><div id="comment-29770" class="comment"><div id="post-29770-score" class="comment-score"></div><div class="comment-text"><p>On Windows it's 1.10.1, but I think it has nothing to do with the version, but is the same for all versions since the -z follow option was implemented</p></div><div id="comment-29770-info" class="comment-info"><span class="comment-age">(12 Feb '14, 06:55)</span> <span class="comment-user userinfo">tonivalac</span></div></div><span id="29771"></span><div id="comment-29771" class="comment"><div id="post-29771-score" class="comment-score"></div><div class="comment-text"><p>That version should not show the effect you are describing (at least it does not in my tests), that's why I asked for a capture file sample.</p></div><div id="comment-29771-info" class="comment-info"><span class="comment-age">(12 Feb '14, 06:56)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="29772"></span><div id="comment-29772" class="comment not_top_scorer"><div id="post-29772-score" class="comment-score"></div><div class="comment-text"><p>BTW: do you need the ascii/hex output of <code>tshark -z follow</code> or just one new capture file per tcp stream of the original capture file?</p></div><div id="comment-29772-info" class="comment-info"><span class="comment-age">(12 Feb '14, 06:58)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="29774"></span><div id="comment-29774" class="comment not_top_scorer"><div id="post-29774-score" class="comment-score"></div><div class="comment-text"><p>Hmm... actually I found quite a lot people stating it can't handle missing packets and as I said posting pcaps is unfortunately not an option</p></div><div id="comment-29774-info" class="comment-info"><span class="comment-age">(12 Feb '14, 07:01)</span> <span class="comment-user userinfo">tonivalac</span></div></div><span id="29776"></span><div id="comment-29776" class="comment not_top_scorer"><div id="post-29776-score" class="comment-score"></div><div class="comment-text"><blockquote><p>it can't handle missing packets</p></blockquote><p>it depends on your definition on "can't handle" and "missing packets".</p><p>BTW: do you need the ascii/hex output of tshark -z follow or just one new capture file per tcp stream of the original capture file?</p></div><div id="comment-29776-info" class="comment-info"><span class="comment-age">(12 Feb '14, 07:04)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="29778"></span><div id="comment-29778" class="comment not_top_scorer"><div id="post-29778-score" class="comment-score"></div><div class="comment-text"><p>I need the ascii output and can't handle means tshark knows there's more data in the flow, because I can see the data if I select the individual package in wireshark, but if I use -s follow or follow tcp stream on a package after a missing one, the ascii/hex/raw output stops where the first missing package should have been</p></div><div id="comment-29778-info" class="comment-info"><span class="comment-age">(12 Feb '14, 07:15)</span> <span class="comment-user userinfo">tonivalac</span></div></div></div><div id="comment-tools-29761" class="comment-tools"><span class="comments-showing"> showing 5 of 9 </span> <a href="#" class="show-all-comments-link">show 4 more comments</a></div><div class="clear"></div><div id="comment-29761-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

2 Answers:

</div>

</div>

<span id="30206"></span>

<div id="answer-container-30206" class="answer accepted-answer answered-by-owner">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-30206-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-30206-score" class="post-score" title="current number of votes">0</div><span id="post-30206-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span class="accept-answer on" rel="nofollow" title="tonivalac has selected this answer as the correct answer"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>I now found a way to do it that works with almost any protocol. Here the tcp example:</p><p>tshark -e tcp.stream eq [stream number] -e data -T fields -r [path to pcap]</p><p>This writes a lot of hex numbers to stdout, which can be easily converted to ASCII using for example python's binascii.unhexlify</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>26 Feb '14, 03:48</strong></p><img src="https://secure.gravatar.com/avatar/ffb8d28ab79b30964586fba1dc7e2696?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="tonivalac&#39;s gravatar image" /><p><span>tonivalac</span><br />
<span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="5 badges"><span class="bronze">●</span><span class="badgecount">5</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="tonivalac has one accepted answer">100%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>27 Feb '14, 01:12</strong> </span></p></div></div><div id="comments-container-30206" class="comments-container"></div><div id="comment-tools-30206" class="comment-tools"></div><div class="clear"></div><div id="comment-30206-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="29780"></span>

<div id="answer-container-29780" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-29780-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-29780-score" class="post-score" title="current number of votes">1</div><span id="post-29780-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><blockquote><p>but if I use -s follow or follow tcp stream on a package after a missing one, the ascii/hex/raw output stops where the first missing package should have been</p></blockquote><p>O.K. then you cannot use tshark and you should take a look at other tools, like one of the following</p><blockquote><p><a href="https://isc.sans.edu/diary/Tools+for+extracting+files+from+pcaps/6961">https://isc.sans.edu/diary/Tools+for+extracting+files+from+pcaps/6961</a></p></blockquote><p>Regards<br />
Kurt</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>12 Feb '14, 07:29</strong></p><img src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Kurt%20Knochner&#39;s gravatar image" /><p><span>Kurt Knochner ♦</span><br />
<span class="score" title="24767 reputation points"><span>24.8k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">●</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">●</span><span class="badgecount">237</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Kurt Knochner has 344 accepted answers">15%</span> </br></p></div></div><div id="comments-container-29780" class="comments-container"><span id="29821"></span><div id="comment-29821" class="comment"><div id="post-29821-score" class="comment-score"></div><div class="comment-text"><p>Sad but true. Thx for the link.</p></div><div id="comment-29821-info" class="comment-info"><span class="comment-age">(13 Feb '14, 00:12)</span> <span class="comment-user userinfo">tonivalac</span></div></div><span id="29823"></span><div id="comment-29823" class="comment"><div id="post-29823-score" class="comment-score"></div><div class="comment-text"><p>Hint: If a supplied answer resolves your question can you please "accept" it by clicking the checkmark icon next to it. This highlights good answers for the benefit of subsequent users with the same or similar questions.</p></div><div id="comment-29823-info" class="comment-info"><span class="comment-age">(13 Feb '14, 00:18)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="29826"></span><div id="comment-29826" class="comment"><div id="post-29826-score" class="comment-score"></div><div class="comment-text"><p>Ok. Unfortunately no tools supports the data link type I use... now I'm wondering why tshark can't just skip those packages and continue with resembling the stream. Any ideas on how to make this possible (for example by changing some lines in the tshark source code)?</p></div><div id="comment-29826-info" class="comment-info"><span class="comment-age">(13 Feb '14, 03:04)</span> <span class="comment-user userinfo">tonivalac</span></div></div><span id="29828"></span><div id="comment-29828" class="comment"><div id="post-29828-score" class="comment-score"></div><div class="comment-text"><p>Can you change the DLT with editcap?</p></div><div id="comment-29828-info" class="comment-info"><span class="comment-age">(13 Feb '14, 04:13)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="29930"></span><div id="comment-29930" class="comment"><div id="post-29930-score" class="comment-score"></div><div class="comment-text"><blockquote><p>"-z follow"? Where is this option implemented in the Wireshark source?</p></blockquote><p><a href="http://code.wireshark.org/git/?p=wireshark;a=blob;f=ui/cli/tap-follow.c;h=e17feebfb5e1d3d9da31d8e28e837e0a6bc42e8b;hb=HEAD">ui/cli/tap-follow.c</a></p><p>BTW: please don't update your original question with new sub-questions, as it's extremely hard to follow the 'flow' that way.</p></div><div id="comment-29930-info" class="comment-info"><span class="comment-age">(17 Feb '14, 04:04)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="29935"></span><div id="comment-29935" class="comment not_top_scorer"><div id="post-29935-score" class="comment-score"></div><div class="comment-text"><p><strong>++ UPDATE ++</strong><br />
</p><p>I did some tests with capture files that contain Retransmissions, missing frames, DUP ACK, etc.</p><p>In all cases the function "Follow TCP stream" did <strong>not stop</strong> before the end of the conversation, as far as I can tell (Wireshark 1.10.5 and 1.11.2).</p><p>Example files:</p><ul><li><strong><a href="http://cloudshark.org/captures/879b2ab2bd4f">ask.wireshark.org.with_get.pcap</a></strong></li><li><strong><a href="http://cloudshark.org/captures/e0e9e6115b52">ask.wireshark.org.no_get.pcap</a></strong> - HTTP GET removed</li></ul><p>Running the following tshark command on both files,</p><blockquote><p>tshark -nr ask.wireshark.org.with_get.pcap -q -z follow,tcp,ascii,0 &gt; output1.txt<br />
tshark -nr ask.wireshark.org.no_get.pcap -q -z follow,tcp,ascii,0 &gt; output2.txt<br />
</p></blockquote><p>gives almost the same output. Obviously the HTTP GET request is missing in the 2nd output file.</p><blockquote><p>but for various reasons <strong>I can not post a sample capture file.</strong></p></blockquote><p>Looks like the problem you are describing is not easy to reproduce. Maybe it's related to the content ('strange characters' in the output) or the protocol being used in your capture file, or anything else...</p><p>Unless you can reproduce the problem with <strong>a capture file you can share</strong>, it's kind of difficult to help you,</p></div><div id="comment-29935-info" class="comment-info"><span class="comment-age">(17 Feb '14, 07:38)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="29954"></span><div id="comment-29954" class="comment not_top_scorer"><div id="post-29954-score" class="comment-score"></div><div class="comment-text"><p>I have missing frames similar to your "TCP previous segment not captured" and even in your sample, the ascii output is cut after this frame on my system, even with Wireshark 1.10.5 and with 1.11.2 tshark -q -z follow,tcp,ascii,0 is not working at all</p><p>EDIT: Ok, somehow I got it working now under 1.10.5 with your pcap... however not with mine. I guess I'll write a script for analysing pcaps myself. Thx anyway</p></div><div id="comment-29954-info" class="comment-info"><span class="comment-age">(17 Feb '14, 23:08)</span> <span class="comment-user userinfo">tonivalac</span></div></div><span id="29956"></span><div id="comment-29956" class="comment not_top_scorer"><div id="post-29956-score" class="comment-score"></div><div class="comment-text"><p>So, what did you change to make it work with my pcap??</p></div><div id="comment-29956-info" class="comment-info"><span class="comment-age">(17 Feb '14, 23:59)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="29966"></span><div id="comment-29966" class="comment not_top_scorer"><div id="post-29966-score" class="comment-score"></div><div class="comment-text"><p>I reinstalled Version 1.10.5 after having installed 1.11.2</p></div><div id="comment-29966-info" class="comment-info"><span class="comment-age">(18 Feb '14, 06:23)</span> <span class="comment-user userinfo">tonivalac</span></div></div><span id="29968"></span><div id="comment-29968" class="comment not_top_scorer"><div id="post-29968-score" class="comment-score"></div><div class="comment-text"><p>strange. It works with both versions on my system.</p><p>Anyway, as I said: unless you can provide a sample capture that shows the problem (I was unable to find/create one), it's kind of difficult to help you.</p></div><div id="comment-29968-info" class="comment-info"><span class="comment-age">(18 Feb '14, 06:35)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="29993"></span><div id="comment-29993" class="comment not_top_scorer"><div id="post-29993-score" class="comment-score"></div><div class="comment-text"><p>Ok. I wrote a script now, which analyzes the pcaps for me, so I guess we can close this now and maybe in a future tshark Version my misterious problem will disappear all by itself...</p></div><div id="comment-29993-info" class="comment-info"><span class="comment-age">(19 Feb '14, 00:18)</span> <span class="comment-user userinfo">tonivalac</span></div></div><span id="30077"></span><div id="comment-30077" class="comment not_top_scorer"><div id="post-30077-score" class="comment-score"></div><div class="comment-text"><p>I just found the reason, why "follow tcp stream" aborts. My files have only one direction. If I use "ip.src eq 192.168.158.139" as filter in your example files and then use "Export Specified Packets", I get the same error I have in my pcaps.</p><p>Is there any way to easily fix this? Or can I use some other tshark command to get the ascii data of the tcp stream? I keep thinking that this really shouldn't be too hard for Wireshark "sees" all the right packets using "tcp.stream eq 0" as display filter</p><p>EDIT: Just realized that there IS no data in the direction containing the error. Could you please provide a pcap where there is a "TCP Previous segment not captured" error in a conversation containing real ascii data, which was captured unidirectional?</p></div><div id="comment-30077-info" class="comment-info"><span class="comment-age">(21 Feb '14, 01:22)</span> <span class="comment-user userinfo">tonivalac</span></div></div><span id="30079"></span><div id="comment-30079" class="comment not_top_scorer"><div id="post-30079-score" class="comment-score"></div><div class="comment-text"><p>I know deleted one packet in Kurt's "no_get.pcap" and confirmed my suspicion: A missing packet in a bidirectional capture is no problem for "-z follow" and "follow tcp stream". The same packet in the same conversation in a unidirectional capture breaks "-z follow" and "follow tcp stream"</p><p>However in both uni- and bidirectional captures a display filter "tcp.stream eq &lt;number&gt;" shows all the captured packets, not only those before the missing one. I consider this a bug in tshark and would really appreciate if anybody could either help me solving this problem or provide a good work around (preferably using tshark)</p></div><div id="comment-30079-info" class="comment-info"><span class="comment-age">(21 Feb '14, 03:35)</span> <span class="comment-user userinfo">tonivalac</span></div></div><span id="30081"></span><div id="comment-30081" class="comment not_top_scorer"><div id="post-30081-score" class="comment-score"></div><div class="comment-text"><p><span></span><span>@tonivalac</span></p><p>Your "answer" has been converted to a comment as that's how this site works. Please read the FAQ for more information.</p></div><div id="comment-30081-info" class="comment-info"><span class="comment-age">(21 Feb '14, 05:07)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="30084"></span><div id="comment-30084" class="comment not_top_scorer"><div id="post-30084-score" class="comment-score"></div><div class="comment-text"><p>I'm not sure if this is a bug, as a unidirectional conversation is not a full TCP conversation. Of course you can file an enhancement bug at <a href="https://bugs.wireshark.org">https://bugs.wireshark.org</a> to add support for unidirectional filtered capture files.</p></div><div id="comment-30084-info" class="comment-info"><span class="comment-age">(21 Feb '14, 08:50)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="30117"></span><div id="comment-30117" class="comment not_top_scorer"><div id="post-30117-score" class="comment-score"></div><div class="comment-text"><p>Well, I think it is, for wireshark "knows" the frames after the missing one belong to the same tcp stream and if it simply ignores the missing frame in "follow tcp stream" with both directions, it should do the same for one direction. However I still don't know how to extract the ascii data content from my pcap...</p></div><div id="comment-30117-info" class="comment-info"><span class="comment-age">(23 Feb '14, 23:59)</span> <span class="comment-user userinfo">tonivalac</span></div></div><span id="30121"></span><div id="comment-30121" class="comment not_top_scorer"><div id="post-30121-score" class="comment-score"></div><div class="comment-text"><blockquote><p>it should do the same for one direction.</p></blockquote><p>as that functionality is apparently not implemented, you should file an enhancement bug, as explained in my last comment.</p></div><div id="comment-30121-info" class="comment-info"><span class="comment-age">(24 Feb '14, 01:32)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="30122"></span><div id="comment-30122" class="comment not_top_scorer"><div id="post-30122-score" class="comment-score"></div><div class="comment-text"><p>Thx Kurt, I did that of course, but this still does not solve my original problem.</p></div><div id="comment-30122-info" class="comment-info"><span class="comment-age">(24 Feb '14, 01:56)</span> <span class="comment-user userinfo">tonivalac</span></div></div><span id="30126"></span><div id="comment-30126" class="comment not_top_scorer"><div id="post-30126-score" class="comment-score"></div><div class="comment-text"><p>I know. So, let's go back to your problem. Maybe there is totally different solution. So, here are some more questions.</p><ul><li>why do you filter the conversation to have only one direction?</li><li>did you try the other tools I mentioned in my answer with a bi-directional capture file? Some of the tools will split the stream anyways into c-&gt;s and s-&gt;c.</li><li>what exactly do you need from the TCP stream? Is it the full 'text', or just some 'keywords'?</li><li>what kind of protocol is this (http, etc.?)</li></ul></div><div id="comment-30126-info" class="comment-info"><span class="comment-age">(24 Feb '14, 05:10)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="30165"></span><div id="comment-30165" class="comment not_top_scorer"><div id="post-30165-score" class="comment-score"></div><div class="comment-text"><p>Actually I do not really filter the conversation, I only capture one direction and this is something I can't and won't change.</p><p>I need the full 'text' and the protocol can be almost anything</p></div><div id="comment-30165-info" class="comment-info"><span class="comment-age">(24 Feb '14, 22:46)</span> <span class="comment-user userinfo">tonivalac</span></div></div><span id="30166"></span><div id="comment-30166" class="comment not_top_scorer"><div id="post-30166-score" class="comment-score"></div><div class="comment-text"><p>Any protocol? In many protocols there is no readable 'text'. So, what are you actually trying to do? Maybe there is a totally different solution.</p></div><div id="comment-30166-info" class="comment-info"><span class="comment-age">(24 Feb '14, 23:48)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="30168"></span><div id="comment-30168" class="comment not_top_scorer"><div id="post-30168-score" class="comment-score"></div><div class="comment-text"><p>I want all ASCII chars in the highest layer of a TCP stream. Other protocols should work, too, but I guess I could spare that</p></div><div id="comment-30168-info" class="comment-info"><span class="comment-age">(24 Feb '14, 23:59)</span> <span class="comment-user userinfo">tonivalac</span></div></div><span id="30170"></span><div id="comment-30170" class="comment not_top_scorer"><div id="post-30170-score" class="comment-score"></div><div class="comment-text"><p>O.K. let me ask the other way round. How much sense does it make to look for ASCII text in <strong>any</strong> TCP protocol?</p><p>So, again: what are you actually trying to do? <strong>Maybe there is a totally different solution.</strong></p></div><div id="comment-30170-info" class="comment-info"><span class="comment-age">(25 Feb '14, 00:14)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="30171"></span><div id="comment-30171" class="comment not_top_scorer"><div id="post-30171-score" class="comment-score"></div><div class="comment-text"><p>I already tried that solution, but it is not satisfying. I want the same intelligence in handling the packets as tshark, which is why I'd really like to find a workaround using the current tshark version.</p><p>What am I trying to do? I guess I told you what I am trying to do... at least I tried. What did I forget to mention? What exactly was vague?</p></div><div id="comment-30171-info" class="comment-info"><span class="comment-age">(25 Feb '14, 00:32)</span> <span class="comment-user userinfo">tonivalac</span></div></div><span id="30186"></span><div id="comment-30186" class="comment not_top_scorer"><div id="post-30186-score" class="comment-score"></div><div class="comment-text"><p>O.K. here comes my last attempt ;-))</p><p><strong>Why</strong> do you need the ASCII text of TCP connections, regardless of the protocol? <strong>What</strong> are you going to do with that data?</p><p>Build some kind of IDS (Intrusion detection system) or DLP (data leakage 'prevention' - actually leakage detection)?</p><p>If yes, neither tshark nor Wireshark is the right tool for you, for several reasons.<br />
</p><p>If no, please add more details if you want any further help!!!</p></div><div id="comment-30186-info" class="comment-info"><span class="comment-age">(25 Feb '14, 09:56)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div></div><div id="comment-tools-29780" class="comment-tools"><span class="comments-showing"> showing 5 of 25 </span> <a href="#" class="show-all-comments-link">show 20 more comments</a></div><div class="clear"></div><div id="comment-29780-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

