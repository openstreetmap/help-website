+++
type = "question"
title = "Client Handshake is missing"
description = '''I used WireShark 1.10.13, 1.12.4 and 1.99.5 -- none of them produce Client Hello handshake on UI, Server Hello is present. The only filter used is &quot;ip.addr==?&quot;. What am I missing ?'''
date = "2015-04-14T05:15:00Z"
lastmod = "2015-04-17T07:24:00Z"
weight = 41424
keywords = [ "hello" ]
aliases = [ "/questions/41424" ]
osqa_answers = 1
osqa_accepted = false
+++

<div class="headNormal">

# [Client Handshake is missing](/questions/41424/client-handshake-is-missing)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-41424-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-41424-score" class="post-score" title="current number of votes">0</div><span id="post-41424-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I used WireShark 1.10.13, 1.12.4 and 1.99.5 -- none of them produce Client Hello handshake on UI, Server Hello is present. The only filter used is "ip.addr==?". What am I missing ?</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-hello" rel="tag" title="see questions tagged &#39;hello&#39;">hello</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>14 Apr '15, 05:15</strong></p><img src="https://secure.gravatar.com/avatar/9c0f857bf0a68ddb2664353f2437f09f?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Tikker&#39;s gravatar image" /><p><span>Tikker</span><br />
<span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Tikker has no accepted answers">0%</span></p></div></div><div id="comments-container-41424" class="comments-container"><span id="41425"></span><div id="comment-41425" class="comment"><div id="post-41425-score" class="comment-score"></div><div class="comment-text"><p>What OS? Are all client generated packets missing?</p></div><div id="comment-41425-info" class="comment-info"><span class="comment-age">(14 Apr '15, 05:21)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="41430"></span><div id="comment-41430" class="comment"><div id="post-41430-score" class="comment-score"></div><div class="comment-text"><p>Can you please upload a sample capture file somewhere (google drive, dropbox, cloudshark.org) and post the link here?</p></div><div id="comment-41430-info" class="comment-info"><span class="comment-age">(14 Apr '15, 08:47)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="41431"></span><div id="comment-41431" class="comment"><div id="post-41431-score" class="comment-score"></div><div class="comment-text"><p>WireShark doesn't show me that any Client Hello Handshake is being done prior to Server Hello. I need to see the cipher list that is being sent over to server. OS is Windows 7, 64-bit. WireShark is also 64-bit.</p></div><div id="comment-41431-info" class="comment-info"><span class="comment-age">(14 Apr '15, 09:05)</span> <span class="comment-user userinfo">Tikker</span></div></div><span id="41432"></span><div id="comment-41432" class="comment"><div id="post-41432-score" class="comment-score"></div><div class="comment-text"><p>See my earlier question about all client packets.</p><p>Are you capturing on the server or the client?</p></div><div id="comment-41432-info" class="comment-info"><span class="comment-age">(14 Apr '15, 09:07)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="41435"></span><div id="comment-41435" class="comment"><div id="post-41435-score" class="comment-score"></div><div class="comment-text"><p>I am capturing on client side. I use openssl s_client -connect servername:443 to generate SSL traffic. SSL traffic is valid, other wise I would get an error with openssl.</p></div><div id="comment-41435-info" class="comment-info"><span class="comment-age">(14 Apr '15, 10:31)</span> <span class="comment-user userinfo">Tikker</span></div></div><span id="41436"></span><div id="comment-41436" class="comment not_top_scorer"><div id="post-41436-score" class="comment-score"></div><div class="comment-text"><p>I've converted your "answers" to comments. Please read the FAQ for more details.</p></div><div id="comment-41436-info" class="comment-info"><span class="comment-age">(14 Apr '15, 10:40)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div></div><div id="comment-tools-41424" class="comment-tools"><span class="comments-showing"> showing 5 of 6 </span> <a href="#" class="show-all-comments-link">show 1 more comments</a></div><div class="clear"></div><div id="comment-41424-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="41437"></span>

<div id="answer-container-41437" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-41437-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-41437-score" class="post-score" title="current number of votes">2</div><span id="post-41437-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>Likely that some AV or Endpoint Protection or VPN software on the client is preventing capture of the client originated packets.</p><p>Fairly frequent question here, see the answer by <span>@Kurt Knochner</span> to this <a href="http://ask.wireshark.org/questions/33597/wireshark-on-win7-machine-not-capturing-all-traffic">question</a>.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>14 Apr '15, 10:43</strong></p><img src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="grahamb&#39;s gravatar image" /><p><span>grahamb ♦</span><br />
<span class="score" title="19834 reputation points"><span>19.8k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">●</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">●</span><span class="badgecount">206</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="grahamb has 274 accepted answers">22%</span></p></div></div><div id="comments-container-41437" class="comments-container"><span id="41487"></span><div id="comment-41487" class="comment"><div id="post-41487-score" class="comment-score"></div><div class="comment-text"><ul><li>I have no AV installed nor any other endpoint protection</li><li>I disabled FireWall (Netsh advfirewall set allprofiles state off)</li><li>Uninstalled Cisco's VPN client</li><li>Resetted TCP/IP (netsh int ip reset)</li><li>Rebooted</li></ul><p>Wireshark is still not able to capture Client Handshake. Any other ideas ? I am using Intel(R) 82579LM NIC. On Windows 2008 R2 I am able to see Client Handshake.</p></div><div id="comment-41487-info" class="comment-info"><span class="comment-age">(16 Apr '15, 04:23)</span> <span class="comment-user userinfo">Tikker</span></div></div><span id="41495"></span><div id="comment-41495" class="comment"><div id="post-41495-score" class="comment-score"></div><div class="comment-text"><p>As I mentioned earlier: Can you please upload a sample capture file somewhere (google drive, dropbox, cloudshark.org) and post the link here?</p></div><div id="comment-41495-info" class="comment-info"><span class="comment-age">(16 Apr '15, 12:00)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="41522"></span><div id="comment-41522" class="comment"><div id="post-41522-score" class="comment-score"></div><div class="comment-text"><p>I don't think that a capture file will help you. Because the Client Handshake is simply missing.</p><p>Capture file generated on Windows 2008 R2 and opened on Windows 7 is fine and the Client Handshake record is present.</p><p>So, the question is the Windwos 7 and some kind of protection "hiding" the Client Handshake.</p></div><div id="comment-41522-info" class="comment-info"><span class="comment-age">(16 Apr '15, 23:41)</span> <span class="comment-user userinfo">Tikker</span></div></div><span id="41526"></span><div id="comment-41526" class="comment"><div id="post-41526-score" class="comment-score"></div><div class="comment-text"><p>You still haven't confirmed if only the Client Handshake is missing from the capture, or all client generated packets.</p></div><div id="comment-41526-info" class="comment-info"><span class="comment-age">(17 Apr '15, 02:03)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="41528"></span><div id="comment-41528" class="comment"><div id="post-41528-score" class="comment-score"></div><div class="comment-text"><blockquote><p>Because the Client Handshake is simply missing.</p></blockquote><p>Do you see the SYN <strong>and</strong> SYN-ACK?</p></div><div id="comment-41528-info" class="comment-info"><span class="comment-age">(17 Apr '15, 02:05)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="41535"></span><div id="comment-41535" class="comment not_top_scorer"><div id="post-41535-score" class="comment-score"></div><div class="comment-text"><p>So, no client packets at all.</p><p>Every time this has come up before, it's been some other software installation interfering with capture of the locally generated packets.</p><p>You'll have to recheck what's been installed on the machine.</p></div><div id="comment-41535-info" class="comment-info"><span class="comment-age">(17 Apr '15, 05:17)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="41537"></span><div id="comment-41537" class="comment not_top_scorer"><div id="post-41537-score" class="comment-score"></div><div class="comment-text"><p>TCP Offloading?</p></div><div id="comment-41537-info" class="comment-info"><span class="comment-age">(17 Apr '15, 05:31)</span> <span class="comment-user userinfo">Kurt Knochner ♦</span></div></div><span id="41540"></span><div id="comment-41540" class="comment not_top_scorer"><div id="post-41540-score" class="comment-score"></div><div class="comment-text"><p>I am pretty conservative what is being installed. Don't see "TCP Offload" setting on NIC either -- only Protocol ARP/NS Offload and these are disabled.</p></div><div id="comment-41540-info" class="comment-info"><span class="comment-age">(17 Apr '15, 07:24)</span> <span class="comment-user userinfo">Tikker</span></div></div></div><div id="comment-tools-41437" class="comment-tools"><span class="comments-showing"> showing 5 of 8 </span> <a href="#" class="show-all-comments-link">show 3 more comments</a></div><div class="clear"></div><div id="comment-41437-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

