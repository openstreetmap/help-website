+++
type = "question"
title = "Can&#x27;t decode HTTPS with jSSLKeyLog"
description = '''I&#x27;m debugging a Java application using HTTPS. I exported a pre-master secret file using jSSLKeylog. The file looks like this: # SSL/TLS secrets log file, generated by jSSLKeyLog CLIENT_RANDOM 56b5f099ea88a29f1a53b0f7c8586f864d92f3ec1a9d2ef686e659dba350f7df 74c5b828fe52a45056ea5fa6fbb19b76d2197d3d6d0...'''
date = "2016-02-06T05:59:00Z"
lastmod = "2016-02-09T09:02:00Z"
weight = 49928
keywords = [ "ssl" ]
aliases = [ "/questions/49928" ]
osqa_answers = 0
osqa_accepted = false
+++

<div class="headNormal">

# [Can't decode HTTPS with jSSLKeyLog](/questions/49928/cant-decode-https-with-jsslkeylog)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-49928-score" class="post-score" title="current number of votes">0</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I'm debugging a Java application using HTTPS. I exported a pre-master secret file using <a href="http://jsslkeylog.sourceforge.net/">jSSLKeylog</a>. The file looks like this:</p><pre><code># SSL/TLS secrets log file, generated by jSSLKeyLog
CLIENT_RANDOM 56b5f099ea88a29f1a53b0f7c8586f864d92f3ec1a9d2ef686e659dba350f7df 74c5b828fe52a45056ea5fa6fbb19b76d2197d3d6d09fb0f5f42e73cec0e7ba6cffd51c16677e50edc6003ab19d5aafe
# SSL/TLS secrets log file, generated by jSSLKeyLog
CLIENT_RANDOM 56b5f7556567faa714cae03bdb2fba5e2a773dc46fd1a4cfd943379367dbc728 8ddf0cfcf27a95e15137800c24c2c74a47fcc51edd0585fcb4b97945fce21fb4d3d5201df1654ff0747f9344263c696c
# SSL/TLS secrets log file, generated by jSSLKeyLog
CLIENT_RANDOM 56b5f7f5091f8c3269a3f14298112c180f18adc531a8c210373681197fb427e6 0a5a546e636d1d666fed91565c198fed186a607e674ef8cfe887cdeb0159890e20a32d030a81677e92ac2b675fb62c7c</code></pre><p>I load the file into Wireshark, but it cannot decode the SSL stream. In the SSL debug file it gives this error:</p><pre><code>trying to use SSL keylog in /home/mero/workspace/bnet/portal/keylog
  checking keylog line: # SSL/TLS secrets log file, generated by jSSLKeyLog
    line does not match
  checking keylog line: CLIENT_RANDOM  56b5f099ea88a29f1a53b0f7c8586f864d92f3ec1a9d2ef686e659dba350f7df   74c5b828fe52a45056ea5fa6fbb19b76d2197d3d6d09fb0f5f42e73cec0e7ba6cffd51c16677e50edc6003ab19d5aafe
    line does not match client random
    line does not match
  checking keylog line: # SSL/TLS secrets log file, generated by jSSLKeyLog
    line does not match
  checking keylog line: CLIENT_RANDOM 56b5f7556567faa714cae03bdb2fba5e2a773dc46fd1a4cfd943379367dbc728 8ddf0cfcf27a95e15137800c24c2c74a47fcc51edd0585fcb4b97945fce21fb4d3d5201df1654ff0747f9344263c696c
    line does not match client random
    line does not match
  checking keylog line: # SSL/TLS secrets log file, generated by jSSLKeyLog
    line does not match
  checking keylog line: CLIENT_RANDOM 56b5f7f5091f8c3269a3f14298112c180f18adc531a8c210373681197fb427e6 0a5a546e636d1d666fed91565c198fed186a607e674ef8cfe887cdeb0159890e20a32d030a81677e92ac2b675fb62c7c
    line does not match</code></pre><p>How could I decode this stream? I have access to the client source code, if that helps.</p><p>This is the output of <code>wireshark -v</code></p><pre><code>wireshark 1.10.6 (v1.10.6 from master-1.10)

Copyright 1998-2014 Gerald Combs &lt;[email protected]&gt; and contributors.
This is free software; see the source for copying conditions. There is NO
warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.

Compiled (64-bit) with GTK+ 3.10.7, with Cairo 1.13.1, with Pango 1.36.1, with
GLib 2.39.91, with libpcap, with libz 1.2.8, with POSIX capabilities (Linux),
without libnl, with SMI 0.4.8, with c-ares 1.10.0, with Lua 5.2, without Python,
with GnuTLS 2.12.23, with Gcrypt 1.5.3, with MIT Kerberos, with GeoIP, with
PortAudio V19-devel (built Feb 25 2014 21:09:53), with AirPcap.

Running on Linux 3.13.0-76-generic, with locale en_US.UTF-8, with libpcap
version 1.5.3, with libz 1.2.8, GnuTLS 2.12.23, Gcrypt 1.5.3, without AirPcap.
   Intel(R) Core(TM) i5-3230M CPU @ 2.60GHz

Built using gcc 4.8.2.</code></pre></div><div id="question-tags" class="tags-container tags">ssl</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>06 Feb '16, 05:59</strong></p><img src="https://secure.gravatar.com/avatar/1b44c88667c69c46dafb1fe6068ed432?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="laci37&#39;s gravatar image" /><p>laci37<br />
<span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="laci37 has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 08 Feb '16, 03:08</p></div></div><div id="comments-container-49928" class="comments-container"><span id="49930"></span><div id="comment-49930" class="comment"><div id="post-49930-score" class="comment-score"></div><div class="comment-text"><p>What version of Wireshark?</p></div><div id="comment-49930-info" class="comment-info"><span class="comment-age">(06 Feb '16, 06:37)</span> grahamb ♦</div></div><span id="49958"></span><div id="comment-49958" class="comment"><div id="post-49958-score" class="comment-score"></div><div class="comment-text"><p>I added the version info to the question.</p></div><div id="comment-49958-info" class="comment-info"><span class="comment-age">(08 Feb '16, 03:09)</span> laci37</div></div><span id="49959"></span><div id="comment-49959" class="comment"><div id="post-49959-score" class="comment-score"></div><div class="comment-text"><p>That's an old and unsupported version, I'm not sure that it can even decrypt with pre-master secret. Is it possible to try with a newer version?</p></div><div id="comment-49959-info" class="comment-info"><span class="comment-age">(08 Feb '16, 03:18)</span> grahamb ♦</div></div></div><div id="comment-tools-49928" class="comment-tools"></div><div class="clear"></div><div id="comment-49928-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="50021"></span>

<div id="answer-container-50021" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-50021-score" class="post-score" title="current number of votes">0</div></div></td><td><div class="item-right"><div class="answer-body"><p>Wireshark 1.10.6 is able to decrypt using a SSL keylog file, but that version is picky on the formatting of key log files: lines must be terminated by a LF (<code>\n</code>) instead of a CRLF (<code>\r\n</code>). It appears that jSSLKeyLog is writing CRLFs (see <code>logLine</code> in <code>src/main/java/net/sf/jsslkeylog/LogWriter.java</code>).</p><p>To solve your problem, pick any of these solutions:</p><ul><li>Patch jSSLKeyLog to write <code>\n</code> instead of <code>\r\n</code> as line separator.</li><li>Post-process your SSL key log file, stripping the carriage returns: <code>sed 's/\r//' -i yourfile.txt</code></li><li>Upgrade to Wireshark 1.12 or newer. On Ubuntu 14.04, you can install the Wireshark PPA for this purpose: <a href="https://launchpad.net/~wireshark-dev/+archive/ubuntu/stable">https://launchpad.net/~wireshark-dev/+archive/ubuntu/stable</a></li></ul></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>09 Feb '16, 09:02</strong></p><img src="https://secure.gravatar.com/avatar/285b1f0f4caadc088a38c40aea22feba?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Lekensteyn&#39;s gravatar image" /><p>Lekensteyn<br />
<span class="score" title="2213 reputation points"><span>2.2k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="7 badges"><span class="silver">●</span><span class="badgecount">7</span></span><span title="24 badges"><span class="bronze">●</span><span class="badgecount">24</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Lekensteyn has 32 accepted answers">30%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 09 Feb '16, 09:02</p></div></div><div id="comments-container-50021" class="comments-container"></div><div id="comment-tools-50021" class="comment-tools"></div><div class="clear"></div><div id="comment-50021-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

