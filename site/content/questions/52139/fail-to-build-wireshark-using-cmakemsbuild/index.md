+++
type = "question"
title = "Fail to build Wireshark using cmake/msbuild"
description = '''Hi! I&#x27;ve seen similar issues but don&#x27;t want to hijack those threads, as they did not solve my problem... I have just started trying to build Wireshark using cmake/msbuild but I fail (64 bit Windows 7, MSVC2015). I try making my build directory with the following command: cmake -D ENABLE_CHM_GUIDES=o...'''
date = "2016-05-02T00:35:00Z"
lastmod = "2016-05-02T13:35:00Z"
weight = 52139
keywords = [ "releasenotes", "msbuild", "cmake", "vs2015" ]
aliases = [ "/questions/52139" ]
osqa_answers = 1
osqa_accepted = true
+++

<div class="headNormal">

# [Fail to build Wireshark using cmake/msbuild](/questions/52139/fail-to-build-wireshark-using-cmakemsbuild)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-52139-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-52139-score" class="post-score" title="current number of votes">0</div><span id="post-52139-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hi!</p><p>I've seen similar issues but don't want to hijack those threads, as they did not solve my problem...</p><p>I have just started trying to build Wireshark using cmake/msbuild but I fail (64 bit Windows 7, MSVC2015). I try making my build directory with the following command:</p><pre><code>cmake -D ENABLE_CHM_GUIDES=on -G &quot;Visual Studio 14 2015 Win64&quot; ..\trunk</code></pre><p>However, when I try to build it (<code>msbuild /m /p:Configuration=RelWithDebInfo Wireshark.sln</code>) I end up with release note and user guide issues, although I have Cygwin Text/asciidoc and Text/docbook-xml45 installed.</p><p>I then made my build directory without the guides (<code>cmake -D ENABLE_CHM_GUIDES=off -D ENABLE_HTML_GUIDES=off -D ENABLE_PDF_GUIDES=off -G "Visual Studio 14 2015 Win64" ..\trunk</code>) but still end up with release notes failing.</p><p>I then tried to build only that one, as per suggestion ion another thread:</p><pre><code>msbuild /p:Configuration=RelWithDebInfo .\docbook\release_notes_html.vcxproj /fl /flp:logfile=fail2build.20160502.log;verbosity=diagnostic</code></pre><p>Checking the log file, I get the following errors:</p><pre><code>Generating release-notes.html (TaskId:35)
/cygdrive/c/username/Wireshark/eWireshark/trunk/tools/runa2x.sh: line 2: $&#39;\r&#39;: command not found (TaskId:35)
/cygdrive/c/username/Wireshark/eWireshark/trunk/tools/runa2x.sh: line 25: $&#39;\r&#39;: command not found (TaskId:35)
/cygdrive/c/username/Wireshark/eWireshark/trunk/tools/runa2x.sh: line 30: $&#39;\r&#39;: command not found (TaskId:35)
/cygdrive/c/username/Wireshark/eWireshark/trunk/tools/runa2x.sh: line 54: syntax error: unexpected end of file (TaskId:35)
C:\Program Files (x86)\MSBuild\Microsoft.Cpp\v4.0\V140\Microsoft.CppCommon.targets(171,5): error MSB6006: &quot;cmd.exe&quot; exited with code 2.     [C:\username\Wireshark\eWireshark\Build\docbook\release_notes_html.vcxproj]
Done executing task &quot;CustomBuild&quot; -- FAILED. (TaskId:35)*</code></pre><p>Does anyone have an idea of why this is failing? Seems there is some input to the runa2x.sh missing; could I be missing some environment variable!?</p><p>Thanks in advance, /Johan</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-releasenotes" rel="tag" title="see questions tagged &#39;releasenotes&#39;">releasenotes</span> <span class="post-tag tag-link-msbuild" rel="tag" title="see questions tagged &#39;msbuild&#39;">msbuild</span> <span class="post-tag tag-link-cmake" rel="tag" title="see questions tagged &#39;cmake&#39;">cmake</span> <span class="post-tag tag-link-vs2015" rel="tag" title="see questions tagged &#39;vs2015&#39;">vs2015</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>02 May '16, 00:35</strong></p><img src="https://secure.gravatar.com/avatar/ac4879834a805f8ca72ead532b4e340e?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="w8lle&#39;s gravatar image" /><p><span>w8lle</span><br />
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="w8lle has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>02 May '16, 01:16</strong> </span></p><img src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="grahamb&#39;s gravatar image" /><p><span>grahamb ♦</span><br />
<span class="score" title="19834 reputation points"><span>19.8k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">●</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">●</span><span class="badgecount">206</span></span></p></div></div><div id="comments-container-52139" class="comments-container"></div><div id="comment-tools-52139" class="comment-tools"></div><div class="clear"></div><div id="comment-52139-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="52141"></span>

<div id="answer-container-52141" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-52141-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-52141-score" class="post-score" title="current number of votes">1</div><span id="post-52141-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span class="accept-answer on" rel="nofollow" title="w8lle has selected this answer as the correct answer"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>You're attempting to build with VS2015 which is not yet officially supported, VS2013 is still the "official" compiler for Windows builds.</p><p>Having said that, the issue you have doesn't seem to be related to VS2015, but rather that the Cygwin bash shell is having difficulties executing the runa2x.sh script, in particular the line endings in the script.</p><p>How did you get your sources, from a git clone or from a zip\tarball? Can you check the line-endings of tools\runa2x.sh? My copy, in my git repo, has Unix line endings.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>02 May '16, 01:22</strong></p><img src="https://secure.gravatar.com/avatar/d2a7e24ca66604c749c7c88c1da8ff78?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="grahamb&#39;s gravatar image" /><p><span>grahamb ♦</span><br />
<span class="score" title="19834 reputation points"><span>19.8k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="30 badges"><span class="silver">●</span><span class="badgecount">30</span></span><span title="206 badges"><span class="bronze">●</span><span class="badgecount">206</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="grahamb has 274 accepted answers">22%</span></p></div></div><div id="comments-container-52141" class="comments-container"><span id="52142"></span><div id="comment-52142" class="comment"><div id="post-52142-score" class="comment-score"></div><div class="comment-text"><p>Hi and thanks for the prompt reply!</p><p>I get my source code using TortoiseSVN. I've seen in another thread that using GIT could solve the issue, so maybe that's the way to go!?</p><p>My script looks like it has Unix line endings; moving it over to a Linux machine and printing it with cat -v did not show any "^M" characters, at least.</p></div><div id="comment-52142-info" class="comment-info"><span class="comment-age">(02 May '16, 01:31)</span> <span class="comment-user userinfo">w8lle</span></div></div><span id="52144"></span><div id="comment-52144" class="comment"><div id="post-52144-score" class="comment-score">1</div><div class="comment-text"><p>I'm mildly surprised that the SVN repo still works, so you're now doing 2 things differently from the Developers Guide instructions, 3 strikes and you're out.</p><p>What happens if you execute the command (<code>path\to\cygwin\bin\bash.exe path/to/runa2x.sh ...</code>) from the release_notes_html.vcxproj directly? Note you'll have to cd to the sources docbook directory first, and might need to add the Cygwin bin directory to your path.</p></div><div id="comment-52144-info" class="comment-info"><span class="comment-age">(02 May '16, 01:51)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="52145"></span><div id="comment-52145" class="comment"><div id="post-52145-score" class="comment-score"></div><div class="comment-text"><p>Well, obviously it doesn't work... -As I previously said, maybe I should try to get TurtoiseGIT working...</p><p>I went in to the "....\Build\docbook" directory and executed: "C:\cygwin64\bin\base32.exe" "C:\user\Wireshark\eWireshark\trunk\tools\runa2x.sh"</p><p>It doesn't report errors; gives me some encoded(?) string...</p></div><div id="comment-52145-info" class="comment-info"><span class="comment-age">(02 May '16, 02:56)</span> <span class="comment-user userinfo">w8lle</span></div></div><span id="52146"></span><div id="comment-52146" class="comment"><div id="post-52146-score" class="comment-score"></div><div class="comment-text"><p>Hmm. Still not following instructions :-)</p><p>cd to the <strong>source</strong> docbook directory not the build one, and execute the <strong>full</strong> command as found in the project file. There's not much point showing you what I have as a command as we have different paths to Cygwin and the sources and build directories.</p></div><div id="comment-52146-info" class="comment-info"><span class="comment-age">(02 May '16, 05:04)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="52153"></span><div id="comment-52153" class="comment"><div id="post-52153-score" class="comment-score"></div><div class="comment-text"><p>I downloaded Wireshark using GIT and I don't have this issue any longer. I'll keep looking in to this though, as it is annoying that I don't understand...</p><p>Thanks for your help!</p><p>Anyway, just as an FYI...</p><p>Sorry about the confusion! -I'm more used to using Wireshark than actually building it...</p><p>I get the same error:</p><p>C:\username\Wireshark\eWireshark\trunk\docbook&gt; C:\cygwin64\bin\bash.exe /cygdrive/c/username/Wireshark/eWireshark/trunk/tools/runa2x.sh --format=xhtml --destination-dir=/cygdrive/c/username/Wireshark/eWireshark/Build/docbook --asciidoc-opts= --fop --stylesheet=ws.css release-notes.asciidoc /cygdrive/c/username/Wireshark/eWireshark/trunk/tools/runa2x.sh: line 2: $'\r': command not found /cygdrive/c/username/Wireshark/eWireshark/trunk/tools/runa2x.sh: line 25: $'\r': command not found /cygdrive/c/username/Wireshark/eWireshark/trunk/tools/runa2x.sh: line 30: $'\r': command not found /cygdrive/c/username/Wireshark/eWireshark/trunk/tools/runa2x.sh: line 54: syntax error: unexpected end of file</p></div><div id="comment-52153-info" class="comment-info"><span class="comment-age">(02 May '16, 07:56)</span> <span class="comment-user userinfo">w8lle</span></div></div><span id="52154"></span><div id="comment-52154" class="comment not_top_scorer"><div id="post-52154-score" class="comment-score"></div><div class="comment-text"><p>It was the EOL style that was the issue, as you already suspected! -Changing it to Unix style solved the issue!</p></div><div id="comment-52154-info" class="comment-info"><span class="comment-age">(02 May '16, 08:56)</span> <span class="comment-user userinfo">w8lle</span></div></div><span id="52155"></span><div id="comment-52155" class="comment not_top_scorer"><div id="post-52155-score" class="comment-score"></div><div class="comment-text"><p>If an answer has solved your issue, please accept the answer for the benefit of other users by clicking the checkmark icon next to the answer. Please read the FAQ for more information.</p></div><div id="comment-52155-info" class="comment-info"><span class="comment-age">(02 May '16, 09:37)</span> <span class="comment-user userinfo">Jaap ♦</span></div></div><span id="52160"></span><div id="comment-52160" class="comment not_top_scorer"><div id="post-52160-score" class="comment-score"></div><div class="comment-text"><p>Shell scripts in Git checkouts should have UNIX-style line endings on all platforms because we have <code>*.sh eol=lf</code> in <code>.gitattributes</code>. Tarballs are created from a Git checkout on Linux, so they should have UNIX-style line endings as well.</p><p>I'm not sure how you'd translate Git's <code>eol=lf</code> attribute to an <code>svn:eol-style</code> property.</p></div><div id="comment-52160-info" class="comment-info"><span class="comment-age">(02 May '16, 13:35)</span> <span class="comment-user userinfo">Gerald Combs ♦♦</span></div></div></div><div id="comment-tools-52141" class="comment-tools"><span class="comments-showing"> showing 5 of 8 </span> <a href="#" class="show-all-comments-link">show 3 more comments</a></div><div class="clear"></div><div id="comment-52141-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

