+++
type = "question"
title = "Capturing JUST http filter"
description = '''There are many packets captured by wireshark and it uses lots of memory. I just want to capture HTTP packets, how can I do that? I understand you can just type http in the filter input, but wireshark still captures all the packets.'''
date = "2014-05-02T06:48:00Z"
lastmod = "2014-05-02T08:19:00Z"
weight = 32399
keywords = [ "wpa2" ]
aliases = [ "/questions/32399" ]
osqa_answers = 1
osqa_accepted = true
+++

<div class="headNormal">

# [Capturing JUST http filter](/questions/32399/capturing-just-http-filter)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-32399-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-32399-score" class="post-score" title="current number of votes">0</div><span id="post-32399-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>There are many packets captured by wireshark and it uses lots of memory. I just want to capture HTTP packets, how can I do that? I understand you can just type <code>http</code> in the filter input, but wireshark still captures all the packets.</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-wpa2" rel="tag" title="see questions tagged &#39;wpa2&#39;">wpa2</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>02 May '14, 06:48</strong></p><img src="https://secure.gravatar.com/avatar/eeca75356089d0569c63dfc514d7f19d?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="tttttttttttt2&#39;s gravatar image" /><p><span>tttttttttttt2</span><br />
<span class="score" title="34 reputation points">34</span><span title="7 badges"><span class="badge1">●</span><span class="badgecount">7</span></span><span title="9 badges"><span class="silver">●</span><span class="badgecount">9</span></span><span title="12 badges"><span class="bronze">●</span><span class="badgecount">12</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="tttttttttttt2 has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>02 May '14, 06:48</strong> </span></p></div></div><div id="comments-container-32399" class="comments-container"></div><div id="comment-tools-32399" class="comment-tools"></div><div class="clear"></div><div id="comment-32399-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="32401"></span>

<div id="answer-container-32401" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-32401-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-32401-score" class="post-score" title="current number of votes">1</div><span id="post-32401-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span class="accept-answer on" rel="nofollow" title="tttttttttttt2 has selected this answer as the correct answer"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>What you need to use are <strong>capture filters</strong>, not display filters. Capture filters are applied on the interface you start the capture on and will only accept packets that match the filter. The syntax is different from display filters (it's using the TCPDump syntax instead), so to filter on port 80 you'd use the string "tcp port 80" as a capture filter.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>02 May '14, 06:54</strong></p><img src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Jasper&#39;s gravatar image" /><p><span>Jasper ♦♦</span><br />
<span class="score" title="23806 reputation points"><span>23.8k</span></span><span title="5 badges"><span class="badge1">●</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">●</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">●</span><span class="badgecount">284</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Jasper has 263 accepted answers">18%</span></p></div></div><div id="comments-container-32401" class="comments-container"><span id="32402"></span><div id="comment-32402" class="comment"><div id="post-32402-score" class="comment-score"></div><div class="comment-text"><p><span>@Jasper</span>: do you not know something?</p></div><div id="comment-32402-info" class="comment-info"><span class="comment-age">(02 May '14, 06:57)</span> <span class="comment-user userinfo">tttttttttttt2</span></div></div><span id="32403"></span><div id="comment-32403" class="comment"><div id="post-32403-score" class="comment-score"></div><div class="comment-text"><p>how to add more filters? for example eapol?</p></div><div id="comment-32403-info" class="comment-info"><span class="comment-age">(02 May '14, 06:59)</span> <span class="comment-user userinfo">tttttttttttt2</span></div></div><span id="32404"></span><div id="comment-32404" class="comment"><div id="post-32404-score" class="comment-score"></div><div class="comment-text"><p>Capture filter syntax is getting really complicated if you try to filter on things that are not very low level, so I rarely use anything beyond IP and port filters. I have no idea how to filter eapol, but maybe Google can help ;-)</p></div><div id="comment-32404-info" class="comment-info"><span class="comment-age">(02 May '14, 07:01)</span> <span class="comment-user userinfo">Jasper ♦♦</span></div></div><span id="32405"></span><div id="comment-32405" class="comment"><div id="post-32405-score" class="comment-score"></div><div class="comment-text"><p>i just want to capture all the http traffic, but it requires eapol handshakes to decrypt it.</p></div><div id="comment-32405-info" class="comment-info"><span class="comment-age">(02 May '14, 07:03)</span> <span class="comment-user userinfo">tttttttttttt2</span></div></div><span id="32407"></span><div id="comment-32407" class="comment"><div id="post-32407-score" class="comment-score"></div><div class="comment-text"><p>In that case you'll probably have to live with capturing all of it and filter it out later I'm afraid.</p></div><div id="comment-32407-info" class="comment-info"><span class="comment-age">(02 May '14, 07:19)</span> <span class="comment-user userinfo">Jasper ♦♦</span></div></div><span id="32411"></span><div id="comment-32411" class="comment not_top_scorer"><div id="post-32411-score" class="comment-score"></div><div class="comment-text"><p><span></span><span>@Jasper</span> how many millions of packets can i catch before it exists? i guess it depends on the resources?</p></div><div id="comment-32411-info" class="comment-info"><span class="comment-age">(02 May '14, 07:35)</span> <span class="comment-user userinfo">tttttttttttt2</span></div></div><span id="32412"></span><div id="comment-32412" class="comment not_top_scorer"><div id="post-32412-score" class="comment-score"></div><div class="comment-text"><p>As many as your disk has room for. See my blog post at <a href="http://blog.packet-foo.com/2013/05/the-notorious-wireshark-out-of-memory-problem">http://blog.packet-foo.com/2013/05/the-notorious-wireshark-out-of-memory-problem</a> on how to do it best.</p></div><div id="comment-32412-info" class="comment-info"><span class="comment-age">(02 May '14, 07:37)</span> <span class="comment-user userinfo">Jasper ♦♦</span></div></div><span id="32416"></span><div id="comment-32416" class="comment not_top_scorer"><div id="post-32416-score" class="comment-score"></div><div class="comment-text"><p><span></span><span>@Jasper</span> why doesn't tcp port 80 or ether proto 0x888e work :( shows only eapol first 4 packets</p></div><div id="comment-32416-info" class="comment-info"><span class="comment-age">(02 May '14, 07:58)</span> <span class="comment-user userinfo">tttttttttttt2</span></div></div><span id="32418"></span><div id="comment-32418" class="comment not_top_scorer"><div id="post-32418-score" class="comment-score"></div><div class="comment-text"><p>If the packets are encrypted (which I guess they are) the capture filter will not be able to match "tcp port 80" because it needs them to be clear text for that.</p></div><div id="comment-32418-info" class="comment-info"><span class="comment-age">(02 May '14, 08:02)</span> <span class="comment-user userinfo">Jasper ♦♦</span></div></div><span id="32419"></span><div id="comment-32419" class="comment not_top_scorer"><div id="post-32419-score" class="comment-score"></div><div class="comment-text"><p>I understand and that's why I added <code>or ether proto 0x888e</code> which should add handshakes :( but instead it shows JUST handshakes and not http requests</p></div><div id="comment-32419-info" class="comment-info"><span class="comment-age">(02 May '14, 08:04)</span> <span class="comment-user userinfo">tttttttttttt2</span></div></div><span id="32420"></span><div id="comment-32420" class="comment not_top_scorer"><div id="post-32420-score" class="comment-score"></div><div class="comment-text"><p>Wireshark does not decrypt packets at the time of the capture to see if capture filters match. Capture filters are applied to the raw frames coming in, so if they are encrypted the filter will not match. Decryption happens later, so only display filters will be able to match.</p></div><div id="comment-32420-info" class="comment-info"><span class="comment-age">(02 May '14, 08:07)</span> <span class="comment-user userinfo">Jasper ♦♦</span></div></div><span id="32421"></span><div id="comment-32421" class="comment not_top_scorer"><div id="post-32421-score" class="comment-score"></div><div class="comment-text"><p>Oh, got it, it makes sense now. It's so sad that there's no filter that would apply handshake first.</p></div><div id="comment-32421-info" class="comment-info"><span class="comment-age">(02 May '14, 08:08)</span> <span class="comment-user userinfo">tttttttttttt2</span></div></div><span id="32422"></span><div id="comment-32422" class="comment not_top_scorer"><div id="post-32422-score" class="comment-score"></div><div class="comment-text"><p>@Japer I will apply <code>not arp and port not 53 and not broadcast and not multicast</code> to remove unnecessary packets. What else could I remove?</p></div><div id="comment-32422-info" class="comment-info"><span class="comment-age">(02 May '14, 08:12)</span> <span class="comment-user userinfo">tttttttttttt2</span></div></div><span id="32423"></span><div id="comment-32423" class="comment not_top_scorer"><div id="post-32423-score" class="comment-score"></div><div class="comment-text"><p>Hard to say, it depends on what's on your network ;-)</p></div><div id="comment-32423-info" class="comment-info"><span class="comment-age">(02 May '14, 08:13)</span> <span class="comment-user userinfo">Jasper ♦♦</span></div></div><span id="32424"></span><div id="comment-32424" class="comment not_top_scorer"><div id="post-32424-score" class="comment-score"></div><div class="comment-text"><p><span>@Jasper</span>: I mostly see just 802.11 and tcp protocols. But it's much better than before, it'd be great if it were possible to remove 802.11 and/or tcp.</p></div><div id="comment-32424-info" class="comment-info"><span class="comment-age">(02 May '14, 08:15)</span> <span class="comment-user userinfo">tttttttttttt2</span></div></div><span id="32425"></span><div id="comment-32425" class="comment not_top_scorer"><div id="post-32425-score" class="comment-score"></div><div class="comment-text"><p>It is probably possible, but I don't have anything to test it, especially without knowing what your traffic really looks like. You'll either have to try&amp;error or live with the results you get, and filter the rest later through display filters.</p></div><div id="comment-32425-info" class="comment-info"><span class="comment-age">(02 May '14, 08:19)</span> <span class="comment-user userinfo">Jasper ♦♦</span></div></div></div><div id="comment-tools-32401" class="comment-tools"><span class="comments-showing"> showing 5 of 16 </span> <a href="#" class="show-all-comments-link">show 11 more comments</a></div><div class="clear"></div><div id="comment-32401-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

