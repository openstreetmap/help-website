+++
type = "question"
title = "can anyone help me before i pull my hair out!"
description = '''yes i am a bit new to this. i thought i knew what was in front of me, i realize i do not. bpf syntax makes me want to scream! i hate it. anyway this is what i want to accomplish. this is a TSHARK question on a win 7 machine i simply want to OMIT THE DISPLAY/CAPTURE OF THIS&amp;gt;&amp;gt; [TCP segment of a ...'''
date = "2014-11-17T02:29:00Z"
lastmod = "2014-11-20T00:45:00Z"
weight = 37896
keywords = [ "help", "syntax" ]
aliases = [ "/questions/37896" ]
osqa_answers = 2
osqa_accepted = false
+++

<div class="headNormal">

# [can anyone help me before i pull my hair out!](/questions/37896/can-anyone-help-me-before-i-pull-my-hair-out)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-37896-score" class="post-score" title="current number of votes">0</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>yes i am a bit new to this. i thought i knew what was in front of me, i realize i do not. bpf syntax makes me want to scream! i hate it. anyway this is what i want to accomplish. this is a TSHARK question on a win 7 machine</p><p>i simply want to OMIT THE DISPLAY/CAPTURE OF THIS&gt;&gt; [TCP segment of a reassembled PDU]</p><p>that is what i see endlessly in SSL traffic. it drives me nuts. i am suing this syntax and tshark totally ignores it and bypasses it</p><p>tshark -Y !tcp.continuation_to !port 53 or udp ( i wish to keep seeing UDP when i need to)</p><p>it also ignores this</p><p>!tcp.reassembled_in</p><p>my question is WHY?????? does anyone know the damn syntax to drop retransmitted PDUs??????</p><p>thank you immensely!</p><p>extra bonus help: do we know of a way to also have tshark not post the number of packets to the screen? like 1,2,3,4 like it keeps doing also, why in the world has no one ever came up with a way to put SPACES between packet line output? wheter it be in ngrep/this/ or tcpdump!</p></div><div id="question-tags" class="tags-container tags">help syntax</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>17 Nov '14, 02:29</strong></p><img src="https://secure.gravatar.com/avatar/91879a16d398f907c691aa7d2e0edd31?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="McKittrick&#39;s gravatar image" /><p>McKittrick<br />
<span class="score" title="11 reputation points">11</span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="3 badges"><span class="silver">●</span><span class="badgecount">3</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="McKittrick has no accepted answers">0%</span></p></div></div><div id="comments-container-37896" class="comments-container"><span id="37995"></span><div id="comment-37995" class="comment"><div id="post-37995-score" class="comment-score"></div><div class="comment-text"><blockquote><p>why in the world has no one ever came up with a way to put SPACES between packet line output?</p></blockquote><p>Spaces meaning blanks? What's an example of output that doesn't have spaces?</p></div><div id="comment-37995-info" class="comment-info"><span class="comment-age">(19 Nov '14, 22:25)</span> Guy Harris ♦♦</div></div></div><div id="comment-tools-37896" class="comment-tools"></div><div class="clear"></div><div id="comment-37896-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

2 Answers:

</div>

</div>

<span id="37905"></span>

<div id="answer-container-37905" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-37905-score" class="post-score" title="current number of votes">0</div></div></td><td><div class="item-right"><div class="answer-body"><p>You are asking several questions; in the future, it would be better to submit a separate question for each query rather than to lump a bunch of them into a single question.</p><p>I'll start with the first one:</p><p><em>i simply want to OMIT THE DISPLAY/CAPTURE OF THIS&gt;&gt; [TCP segment of a reassembled PDU]</em></p><p>You need to de-select the "<code>Allow subdissector to reassemble TCP streams</code>" TCP preference, which is done via:</p><pre><code>Edit -&gt; Preferences -&gt; Protocols -&gt; TCP -&gt; Allow subdissector to reassemble TCP streams</code></pre><p>If you don't want to change the preference permanently, you can change it on the <a href="https://www.wireshark.org/docs/man-pages/tshark.html">tshark</a> command-line by using the <code>-o tcp.desegment_tcp_streams:FALSE</code> option.</p><hr /><p>As for your second question:</p><p><em>do we know of a way to also have tshark not post the number of packets to the screen?</em></p><p>One way of accomplihsing this is to manually specify the column format using the <code>-o "gui.column.format</code> command-line option. For example, to specify all the default column except for the packet number, you can use:</p><ul><li><p>On Windows:</p><p><code>tshark.exe -o "gui.column.format:\"Time\",\"%t\",\"Source\",\"%s\",\"Destination\",\"%d\",\"Protocol\",\"%p\",\"Length\",\"%L\",\"Info\",\"%i\""</code></p></li><li><p>On *nix:</p><p><code>tshark -o 'gui.column.format:"Time","%t","Source","%s","Destination","%d","Protocol","%p","Length","%L","Info","%i"'</code></p></li></ul><p>Run <code>tshark -G column-formats</code> for more information.</p><hr /><p>Finally:</p><p><em>why in the world has no one ever came up with a way to put SPACES between packet line output?</em></p><p>Probably because nobody has ever expressed a desire for it before nor took the time to implement such a feature. You are welcome to do so. The <code>-S</code> option does allow the user to specify a packet separator, but it currently only applies when printing packet details. It could be enhanced to allow a separator to be specified even when only printing packet summary information.</p><hr /></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>17 Nov '14, 10:14</strong></p><img src="https://secure.gravatar.com/avatar/55158e2322c4e365a5e0a4a0ac3fbcef?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="cmaynard&#39;s gravatar image" /><p>cmaynard ♦♦<br />
<span class="score" title="9361 reputation points"><span>9.4k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="38 badges"><span class="silver">●</span><span class="badgecount">38</span></span><span title="142 badges"><span class="bronze">●</span><span class="badgecount">142</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="cmaynard has 108 accepted answers">20%</span></p></div></div><div id="comments-container-37905" class="comments-container"><span id="37989"></span><div id="comment-37989" class="comment"><div id="post-37989-score" class="comment-score"></div><div class="comment-text"><p>thank you so much! you got rid of the issue i had with seeing the retransmitted PDUs. the other question still seems to linger. the column output you threw up i typed exact and still see those pesky numbers. ill show you</p><p>C:\Users\McKittrick\Desktop&gt;tshark -o "gui.column.format:\"Time\",\"%t\",\"Source\",\"%s\",\"Destination\",\"%d\",\"Protocol\",\"%p\",\"Length\",\"%L\",\"Info\" ,\"%i\""</p><p>Capturing on 'Local Area Connection'</p><p>fe80::21b:54ff:feca:fdd9 -&gt; ff02::1:ff2a:93ed ICMPv6 86 Neighbor Solicitation fo r 2001:48f8:24:452:5510:d93:8c2a:93ed from 00:1b:54:ca:fd:d9</p><p>1 192.168.0.1 -&gt; 224.0.0.1 IGMPv3 60 Membership Query, general</p><p>2 fe80::21b:54ff:feca:fdd9 -&gt; ff02::1:ff16:2063 ICMPv6 86 Neighbor Solicitation</p><p>see the 1 and 2? lastly, and this will be my last question in relation to what i posted, how do i use an -o flag to omit seeing this&gt; 192.168.0.16 SSL 1514 Continuation Data (the CONTINUATION DATA i just need one instance of it, not an entire screen full, lol)</p><p>and once again, ty!</p></div><div id="comment-37989-info" class="comment-info"><span class="comment-age">(19 Nov '14, 21:15)</span> McKittrick</div></div><span id="37993"></span><div id="comment-37993" class="comment"><div id="post-37993-score" class="comment-score"></div><div class="comment-text"><blockquote><p>the column output you threw up i typed exact and still see those pesky numbers</p></blockquote><p>What version of tshark is this? (What does <code>tshark -v</code> print?) Your output appears not to show a packet number before the first line, but shows one before the second and third lines; there <em>might</em> be a bug that causes tshark to print the packet counter - normally printed, by default, only if you're capturing to a binary file with <code>-w</code>, rather than capturing and dissecting and printing - even when capturing and dissecting and printing.</p></div><div id="comment-37993-info" class="comment-info"><span class="comment-age">(19 Nov '14, 22:23)</span> Guy Harris ♦♦</div></div><span id="38017"></span><div id="comment-38017" class="comment"><div id="post-38017-score" class="comment-score"></div><div class="comment-text"><p>Regarding the packet counts, you can also refer to my answer to <a href="https://ask.wireshark.org/questions/31564/tshark-output-refining">this</a> question, which has links to the fix for the bug that Guy referred to, as well as listing some possible options for avoiding this problem.</p></div><div id="comment-38017-info" class="comment-info"><span class="comment-age">(20 Nov '14, 06:15)</span> cmaynard ♦♦</div></div></div><div id="comment-tools-37905" class="comment-tools"></div><div class="clear"></div><div id="comment-37905-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="37997"></span>

<div id="answer-container-37997" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-37997-score" class="post-score" title="current number of votes">0</div></div></td><td><div class="item-right"><div class="answer-body"><pre><code>tshark -Y !tcp.continuation_to !port 53 or udp</code></pre><p>There are several problems with that.</p><p>First of all, you probably means something such as</p><pre><code>tshark -Y &quot;!tcp.continuation_to and (!port 53 or udp)&quot;</code></pre><p>Furthermore, however, if you're capturing and printing, or reading through the capture file in one pass, it's impossible for TShark to determine what the <em>last</em> frame is in a reassembled packet, as that would require predicting the contents of future packets, <a href="http://www.goodreads.com/quotes/261863-it-s-tough-to-make-predictions-especially-about-the-future">which is a bit difficult</a>. You would have to do a two-pass analysis of an already-captured trace to do that; this means you can't do it in a live capture, and would have to use the <code>-2</code> flag for a two-pass analysis, and use the <code>-R</code> flag rather than the <code>-Y</code> flag.</p><p>It might be useful for *shark to put a field into the dissection indicating whether a frame is not at the end of a reassembled packet, so it could be used in a filter. Sadly, it doesn't do so currently.</p><p>So about the only thing you can currently do is disable reassembly, as per the other answer.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>20 Nov '14, 00:45</strong></p><img src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Guy%20Harris&#39;s gravatar image" /><p>Guy Harris ♦♦<br />
<span class="score" title="17443 reputation points"><span>17.4k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">●</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">●</span><span class="badgecount">196</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Guy Harris has 216 accepted answers">19%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 20 Nov '14, 00:47</p></div></div><div id="comments-container-37997" class="comments-container"></div><div id="comment-tools-37997" class="comment-tools"></div><div class="clear"></div><div id="comment-37997-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

