+++
type = "question"
title = "Wireshark not capturing Probe Request?"
description = '''I&#x27;m doing a little Pen-Testing using my Laptop, phone (HTC Droid), and Desktop with a Wireless NIC. When running Wireshark while my HTC Droid and Laptop are unassociated with a wireless network, I&#x27;m not picking up any Probes from any of these devices. The only traffic I&#x27;m seeing from them are null B...'''
date = "2011-08-30T14:10:00Z"
lastmod = "2011-08-31T07:58:00Z"
weight = 5973
keywords = [ "broadcast", "problem", "probe", "help", "wireshark" ]
aliases = [ "/questions/5973" ]
osqa_answers = 1
osqa_accepted = true
+++

<div class="headNormal">

# [Wireshark not capturing Probe Request?](/questions/5973/wireshark-not-capturing-probe-request)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-5973-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-5973-score" class="post-score" title="current number of votes">0</div><span id="post-5973-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I'm doing a little Pen-Testing using my Laptop, phone (HTC Droid), and Desktop with a Wireless NIC.</p><p>When running Wireshark while my HTC Droid and Laptop are unassociated with a wireless network, I'm not picking up any Probes from any of these devices. The only traffic I'm seeing from them are null Broadcast frames that are announcing their presence.</p><p>Is there something I'm doing wrong, something I'm unaware of, or are my devices simply not broadcasting networks that are in its PNL (preferred network list) or cached networks?</p><p>Thanks, Bokeh</p><p>P.S. On another note, the only time I see a Probe Request to any particular Access Point is when my laptop is actually associated to that Access Point.</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-broadcast" rel="tag" title="see questions tagged &#39;broadcast&#39;">broadcast</span> <span class="post-tag tag-link-problem" rel="tag" title="see questions tagged &#39;problem&#39;">problem</span> <span class="post-tag tag-link-probe" rel="tag" title="see questions tagged &#39;probe&#39;">probe</span> <span class="post-tag tag-link-help" rel="tag" title="see questions tagged &#39;help&#39;">help</span> <span class="post-tag tag-link-wireshark" rel="tag" title="see questions tagged &#39;wireshark&#39;">wireshark</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>30 Aug '11, 14:10</strong></p><img src="https://secure.gravatar.com/avatar/085bfa887d7c6231e9b2fb78faa0bbc2?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Bokeh&#39;s gravatar image" /><p><span>Bokeh</span><br />
<span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Bokeh has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>30 Aug '11, 14:19</strong> </span></p></div></div><div id="comments-container-5973" class="comments-container"><span id="5979"></span><div id="comment-5979" class="comment"><div id="post-5979-score" class="comment-score"></div><div class="comment-text"><p>What version of what operating system (if it's a Linux distribution, give the kernel version as well) are you running?</p><p>Are you capturing in monitor mode?</p><p>What type of wireless adapter do you have?</p></div><div id="comment-5979-info" class="comment-info"><span class="comment-age">(30 Aug '11, 16:50)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="5980"></span><div id="comment-5980" class="comment"><div id="post-5980-score" class="comment-score"></div><div class="comment-text"><p>Sorry for not providing that information earlier.</p><p>I'm running BackTrack 5 release (Based on Ubuntu 10.04 LTS, Linux kernel 2.6.38) in a Virtualization.</p><p>Yes, I'm setting my Wireless Adapter on Monitor Mode via airmon-ng on my wlan0 (and then sniffing with the mon0 interface created by airmon-ng).</p><p>Finally, it is an Alfa AWUS036H Wireless Adapter.</p></div><div id="comment-5980-info" class="comment-info"><span class="comment-age">(30 Aug '11, 17:57)</span> <span class="comment-user userinfo">Bokeh</span></div></div><span id="6000"></span><div id="comment-6000" class="comment"><div id="post-6000-score" class="comment-score"></div><div class="comment-text"><p>I tried and tried again last night with no luck. I was even intentionally forcing my "victim" machines to refresh networks (send probes) while unassociated and they still only sent out null broadcast frames.</p><p>And again, the only time I would see a probe request for any of the networks in the PNL is when that "victim" was actually connected that that particular network.</p></div><div id="comment-6000-info" class="comment-info"><span class="comment-age">(31 Aug '11, 06:51)</span> <span class="comment-user userinfo">Bokeh</span></div></div><span id="6001"></span><div id="comment-6001" class="comment"><div id="post-6001-score" class="comment-score"></div><div class="comment-text"><p>I let the packet capture run for a good 10 minutes... nothing.</p><p>But I think it might be my devices... This morning I ran airodump-ng and let it sit for 6 minutes... at 6 minutes airodump-ng recorded some probes for my home network essid "StayOffMyWireless" while connected to my work network essid "Mercado". Maybe it was just dumb luck, but I don't know.</p></div><div id="comment-6001-info" class="comment-info"><span class="comment-age">(31 Aug '11, 06:55)</span> <span class="comment-user userinfo">Bokeh</span></div></div><span id="6002"></span><div id="comment-6002" class="comment"><div id="post-6002-score" class="comment-score"></div><div class="comment-text"><p>Refreshing your PNL doesn't neccessarily mean that your device has to send Probe Requests, although that would be (like u assumed it) normal. I would try and look if one of your devices (which is NOT the one airodump-ng is actively capturing) sends out the Probe Request when you ask the device to actually connect to a wireless network, because that's the time when Probe Requests have to be sent right before Authentication and Association Request/Response.</p><p>Maybe that gives u a hint</p></div><div id="comment-6002-info" class="comment-info"><span class="comment-age">(31 Aug '11, 07:02)</span> <span class="comment-user userinfo">Landi</span></div></div><span id="6003"></span><div id="comment-6003" class="comment not_top_scorer"><div id="post-6003-score" class="comment-score"></div><div class="comment-text"><p>Are you suggesting sending a de-auth broadcast, forcing them to re-auth/re-associate (an invariably sending a probe request in the process)?</p></div><div id="comment-6003-info" class="comment-info"><span class="comment-age">(31 Aug '11, 07:04)</span> <span class="comment-user userinfo">Bokeh</span></div></div><span id="6004"></span><div id="comment-6004" class="comment not_top_scorer"><div id="post-6004-score" class="comment-score"></div><div class="comment-text"><p>No, I meant just to check whether your devices send the Probe Request only in the process of connecting to a wireless network (which I would expect to happen) and thereby to verify if it's just those systems <em>not</em> probing every SSID in their PNL which is what afaik all windows OS are doing when refreshing their network lists.</p></div><div id="comment-6004-info" class="comment-info"><span class="comment-age">(31 Aug '11, 07:12)</span> <span class="comment-user userinfo">Landi</span></div></div><span id="6005"></span><div id="comment-6005" class="comment not_top_scorer"><div id="post-6005-score" class="comment-score"></div><div class="comment-text"><p>I think you're right Landi.</p><p>It appears that my devices are only sending out Probe Requests when connecting to an access point. I confirmed this by doing two things:</p><ol><li><p>I disconnected my Droid (phone) from the network, started a packet trace, then reconnected. I did see probe requests during the whole probe/authentication/association phase for the network that I just connected to.</p></li><li><p>Hard way - I did a deauth flood. However, this time I did see Probes to two networks in the PNL DURING the deauth flood. Strange... only two (not all 4 in my PNL)</p></li></ol><p>Well, I think I have this figured out... sorta.</p></div><div id="comment-6005-info" class="comment-info"><span class="comment-age">(31 Aug '11, 07:27)</span> <span class="comment-user userinfo">Bokeh</span></div></div><span id="6006"></span><div id="comment-6006" class="comment not_top_scorer"><div id="post-6006-score" class="comment-score"></div><div class="comment-text"><p>So, let me confirm that I understand. I was under the assumption that, if unassociated to any network, devices would occasionally probe networks in the PNL for connection/discovery... this was incorrect. Right?</p><p>So, for various reasons, some devices only send probes when actually connected to that network... and for general network discovery they send out broadcast frames (with a SSID tagged parameter as null)?</p><p>Please correct me if I'm wrong. I'm a beginner and I have much to learn... much that I want to learn.</p></div><div id="comment-6006-info" class="comment-info"><span class="comment-age">(31 Aug '11, 07:37)</span> <span class="comment-user userinfo">Bokeh</span></div></div><span id="6010"></span><div id="comment-6010" class="comment not_top_scorer"><div id="post-6010-score" class="comment-score"></div><div class="comment-text"><p>too little space here -&gt; answer section</p></div><div id="comment-6010-info" class="comment-info"><span class="comment-age">(31 Aug '11, 07:58)</span> <span class="comment-user userinfo">Landi</span></div></div></div><div id="comment-tools-5973" class="comment-tools"><span class="comments-showing"> showing 5 of 10 </span> <a href="#" class="show-all-comments-link">show 5 more comments</a></div><div class="clear"></div><div id="comment-5973-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="6009"></span>

<div id="answer-container-6009" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-6009-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-6009-score" class="post-score" title="current number of votes">2</div><span id="post-6009-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span class="accept-answer on" rel="nofollow" title="Bokeh has selected this answer as the correct answer"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>Basically there is no need for wireless devices to probe networks just to see which are available. Every access point periodically sends out Beacon Frames (10 per second), from which the wireless clients can read all neccessary information like channel, SSID name, Encryption settings etc.</p><p><em>IF</em> you have a wireless network <em>not</em> sending it's SSID in plaintext (hidden SSID), then your wireless device of course can't see it the network if there. For that + other reasons (on windows OS) networks in your PNL get probed to see if there is a probe response from the AP (meaning the network is in range). Why your HTC behaves different -&gt; sorry no idea</p><p>So basically it's beacon frames every 100ms from every AP with or without plaintext SSID. Then when a client wants to connect you have the wireless 'handshake'</p><ul><li>Probe Request / Response</li><li>Authentication Request / Response ( &lt;-- nothing really happens here, relict from shared auth. times)</li><li>Association Request / Response followed by EAPoL packets if WPA(2) Auth. is enabled</li></ul></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>31 Aug '11, 07:58</strong></p><img src="https://secure.gravatar.com/avatar/36b41326bff63eb5ad73a0436914e05c?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Landi&#39;s gravatar image" /><p><span>Landi</span><br />
<span class="score" title="2269 reputation points"><span>2.3k</span></span><span title="5 badges"><span class="badge1">●</span><span class="badgecount">5</span></span><span title="14 badges"><span class="silver">●</span><span class="badgecount">14</span></span><span title="42 badges"><span class="bronze">●</span><span class="badgecount">42</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Landi has 28 accepted answers">28%</span></p></div></div><div id="comments-container-6009" class="comments-container"></div><div id="comment-tools-6009" class="comment-tools"></div><div class="clear"></div><div id="comment-6009-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

