+++
type = "question"
title = "Cannot use gsm_map with tshark - only gsmtap will work ..."
description = '''I am running airprobe and while it is running, I open up the GUI wireshark and I can successfully view gsmtap ... and everything is working great. I see a packet marked &quot;system information type 3&quot; and I open that packet up and I can drill all the way down to: GSM CCCH - System Information Type 3 -&amp;g...'''
date = "2015-12-04T18:39:00Z"
lastmod = "2015-12-08T11:10:00Z"
weight = 48277
keywords = [ "gsmtap", "airprobe", "tshark", "gsm_map" ]
aliases = [ "/questions/48277" ]
osqa_answers = 1
osqa_accepted = true
+++

<div class="headNormal">

# [Cannot use gsm\_map with tshark - only gsmtap will work ...](/questions/48277/cannot-use-gsm_map-with-tshark-only-gsmtap-will-work)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-48277-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-48277-score" class="post-score" title="current number of votes">0</div><span id="post-48277-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I am running airprobe and while it is running, I open up the GUI wireshark and I can successfully view gsmtap ... and everything is working great. I see a packet marked "system information type 3" and I open that packet up and I can drill all the way down to:</p><p>GSM CCCH - System Information Type 3 -&gt; LAI -&gt; Location Area Code (LAC)</p><p>... but I would like to see that information in tshark.</p><p>I looked up the gsmtap reference here: <a href="https://www.wireshark.org/docs/dfref/g/gsmtap.html">https://www.wireshark.org/docs/dfref/g/gsmtap.html</a> ... but there are only 18 fields in gsmtap, so I don't understand where all the info is coming from that I see in the GUI ...</p><p>I <em>do</em> see the fields I want in gsm_map, but when I use tshark with gsm_map:</p><pre><code># tshark -Y &#39;!icmp &amp;&amp; gsm_map&#39; -i lo</code></pre><p>I get no output at all. So I am confused ...</p><p>If gsmtap is very limited and has only 18 fields, how am I getting all this information in the wireshark GUI that doesn't seem to be included in gsmtap ?</p><p>Also, why do I get no output at all when I try to run tshark with gsm_map ?</p><p>Thanks.</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-gsmtap" rel="tag" title="see questions tagged &#39;gsmtap&#39;">gsmtap</span> <span class="post-tag tag-link-airprobe" rel="tag" title="see questions tagged &#39;airprobe&#39;">airprobe</span> <span class="post-tag tag-link-tshark" rel="tag" title="see questions tagged &#39;tshark&#39;">tshark</span> <span class="post-tag tag-link-gsm_map" rel="tag" title="see questions tagged &#39;gsm_map&#39;">gsm_map</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>04 Dec '15, 18:39</strong></p><img src="https://secure.gravatar.com/avatar/3948989c3c37b2439d799349175f2211?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="wshuser&#39;s gravatar image" /><p><span>wshuser</span><br />
<span class="score" title="11 reputation points">11</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="5 badges"><span class="bronze">●</span><span class="badgecount">5</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="wshuser has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>04 Dec '15, 19:55</strong> </span></p><img src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Guy%20Harris&#39;s gravatar image" /><p><span>Guy Harris ♦♦</span><br />
<span class="score" title="17443 reputation points"><span>17.4k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">●</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">●</span><span class="badgecount">196</span></span></p></div></div><div id="comments-container-48277" class="comments-container"></div><div id="comment-tools-48277" class="comment-tools"></div><div class="clear"></div><div id="comment-48277-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="48281"></span>

<div id="answer-container-48281" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-48281-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-48281-score" class="post-score" title="current number of votes">0</div><span id="post-48281-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span class="accept-answer on" rel="nofollow" title="wshuser has selected this answer as the correct answer"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>It is not a fault of Wireshark that GSM MAP is not used on the air interface (i.e. between the mobile terminal and base station) but only inside the core network, between the MSC, HLR, VLR etc.</p><p>So in the GUI, select one of the packets which is not dissected nicely enough by tshark, and in the packet dissection pane, unfold the "frame" level (the topmost one). There, you shall see a line called "Protocols in frame". Its value part is a semicolon-separated list of protocols which the Wireshark dissection engine has detected in the frame.</p><p>Similarly, you can identify the names of individual fields of each protocol: whenever you click a line decoding a field in the dissection pane, you'll see the field's name in the status line at the bottom of the GUI window. These are the names to be used to compose your tshark display, using <code>-T fields -e field_1_name -e field_2_name ...</code> For copy-paste, you may right-click the line decoding a field, and choose Prepare a filter -&gt; Selected from the context menu.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>05 Dec '15, 00:02</strong></p><img src="https://secure.gravatar.com/avatar/00fc6e2633725bd871ff636f0175eabc?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="sindy&#39;s gravatar image" /><p><span>sindy</span><br />
<span class="score" title="6049 reputation points"><span>6.0k</span></span><span title="4 badges"><span class="badge1">●</span><span class="badgecount">4</span></span><span title="8 badges"><span class="silver">●</span><span class="badgecount">8</span></span><span title="51 badges"><span class="bronze">●</span><span class="badgecount">51</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="sindy has 110 accepted answers">24%</span></p></div></div><div id="comments-container-48281" class="comments-container"><span id="48284"></span><div id="comment-48284" class="comment"><div id="post-48284-score" class="comment-score"></div><div class="comment-text"><p>Thanks sindy ... for some reason in wireshark GUI (in kali linux) I cannot right-click the lines ... right-click works in other places, but not there. But you are saying I can still look down in the status line at the bottom of the window and see my -e field names there ?</p></div><div id="comment-48284-info" class="comment-info"><span class="comment-age">(05 Dec '15, 07:34)</span> <span class="comment-user userinfo">wshuser</span></div></div><span id="48286"></span><div id="comment-48286" class="comment"><div id="post-48286-score" class="comment-score"></div><div class="comment-text"><p>It sounds weird to me that the "non-right-clickability" should be an issue of a particular linux distribution. Would you mind sharing a packet or the whole capture (publishing it somewhere and putting a link here)?</p><p>Bear in mind that not each of the lines in packet dissection pane represents a protocol field. So if you select a line (by left-clicking it) and the status line shows some kind of (xxx.yyy) information different from (text), that dissection line should be right-clickable.</p><p>But I think you've also misunderstood the meaning of -Y parameter of tshark. The name "display filter" (associated to -Y) may not be self-explanatory itself. It is rather a "filter used at display <em>time</em>", in contrary to a filter used during capture (a capture filter). This distinction comes from the GUI version where you can capture once and change display filter many times. So it does not define which parts of the packet will be displayed but what fields must be present in the packet so that the packet as a whole would be chosen for showing. To choose the fields for display, you can use -V, -O, -T, -e, -E options, while -R or -Y options are used to choose whether a given packet will be displayed or not. The field names to be used both for -Y, -R and -e are the same, but for -Y and -R, you can define conditions for these fields (like <code>-Y frame.len &gt; 20</code>, which obviously makes no sense with -e.</p><p>So as you used "-Y gsm_map", tshark would have displayed gsm_map packets if there were any; as there weren't, it has shown nothing.</p><p>So look at the list of protocols as I've suggested in the answer (in the "frame" part of the packet dissection), where you should see something like eth:ethertype:ip:udp:gsmtap:...., and look at the meaning of -O and -V options to tshark. So <code>tshark -V -Y gsmtap</code> could be your starting point.</p></div><div id="comment-48286-info" class="comment-info"><span class="comment-age">(05 Dec '15, 08:27)</span> <span class="comment-user userinfo">sindy</span></div></div><span id="48356"></span><div id="comment-48356" class="comment"><div id="post-48356-score" class="comment-score"></div><div class="comment-text"><p>Ok, this worked - thank you - I was able to find the names of what I was seeing in the gui, and my eventual command looked like:</p><h1 id="tshark--y-icmp-gsmtap--i-lo--t-ad--t-fields--e-gsmtap.signal_dbm--e-e212.mnc">tshark -Y '!icmp &amp;&amp; gsmtap' -i lo -t ad -T fields -e gsmtap.signal_dbm -e e212.mnc</h1><p>However, in the wireshark GUI, e212.mnc gives me a number <em>and</em> a human readable output, like this:</p><p>Mobile Network Code (MNC): Cingular Wireless (410)</p><p>... but in tshark, I just get the number:</p><p>410</p><p>Is there a way to instruct tshark to decode that number and output the human readable lookup for it, just like it does in wireshark gui ?</p><p>Thanks.</p></div><div id="comment-48356-info" class="comment-info"><span class="comment-age">(08 Dec '15, 10:15)</span> <span class="comment-user userinfo">wshuser</span></div></div><span id="48358"></span><div id="comment-48358" class="comment"><div id="post-48358-score" class="comment-score"></div><div class="comment-text"><p>If you can post somewhere a capture with this single packet and put here a link, I may be able to answer. Someone else may be able to answer from the top of his head but definitely not me.</p></div><div id="comment-48358-info" class="comment-info"><span class="comment-age">(08 Dec '15, 11:10)</span> <span class="comment-user userinfo">sindy</span></div></div></div><div id="comment-tools-48281" class="comment-tools"></div><div class="clear"></div><div id="comment-48281-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

