+++
type = "question"
title = "Timestamp issue in 1.10.2 on windows"
description = '''I have started seeing a strange issue on a new platform I am using. It is a Microsoft hyper-v environment with virtual guests running XP. I installed the latest wireshark/winpcap and started testing some applications but noticed that the timestamps do two very strange things.  A conversation might b...'''
date = "2013-09-24T12:28:00Z"
lastmod = "2013-09-24T13:38:00Z"
weight = 25168
keywords = [ "windows", "timestamp" ]
aliases = [ "/questions/25168" ]
osqa_answers = 0
osqa_accepted = false
+++

<div class="headNormal">

# [Timestamp issue in 1.10.2 on windows](/questions/25168/timestamp-issue-in-1102-on-windows)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-25168-score" class="post-score" title="current number of votes">1</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I have started seeing a strange issue on a new platform I am using. It is a Microsoft hyper-v environment with virtual guests running XP. I installed the latest wireshark/winpcap and started testing some applications but noticed that the timestamps do two very strange things.</p><ol><li>A conversation might be 'out of sync' by 3.14 seconds. That is, the request will show what appears to be the "right" time and the response (which must have been sent pretty close, and after, the request) is stamped 3.14 seconds <em>Before</em> the request, but appears after it in the list of packets. This happens across many conversations in the same capture, the request shows a normal stamp and the response shows a stamp 3.14 seconds before the request.</li><li>The stamp might roll back 1200 seconds. Sometimes, not every time, after a brief time of capturing (sometimes only a few seconds in, sometimes 5 minutes in) has elapsed the stamp jumps down 1200 (going negative) and starts counting again.</li></ol><p>In both of these instances, I am running it in a pretty focused way (no more than about 4000 packets/hour) and often Wireshark will crash with the "Microsoft visual c++ runtime error" message.</p></div><div id="question-tags" class="tags-container tags">windows timestamp</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>24 Sep '13, 12:28</strong></p><img src="https://secure.gravatar.com/avatar/9ee282b379860571958ec7b61855d7d6?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="ipchains1&#39;s gravatar image" /><p>ipchains1<br />
<span class="score" title="16 reputation points">16</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="ipchains1 has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 24 Sep '13, 12:34</p></div></div><div id="comments-container-25168" class="comments-container"></div><div id="comment-tools-25168" class="comment-tools"></div><div class="clear"></div><div id="comment-25168-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="25174"></span>

<div id="answer-container-25174" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-25174-score" class="post-score" title="current number of votes">1</div></div></td><td><div class="item-right"><div class="answer-body"><p>Strange, indeed. I have seen things like that when capturing on multiple NICs at the same time - do you capture on a single card, or are there multiple cards involved? Out of sync by 3.14 seconds is A LOT - are you sure that it's not milliseconds or microseconds (just making sure)?</p><p>I suspect that the system time of your VM gets adjusted by the host, and that causes the jump in time. Keeping time in VMs is a big problem because the OS doesn't get hardware interupts in regular intervals to advance the time, because the hardware interupts are received by the virtualization host. So the time of the VMs is often advanced in unregular intervals, and sometimes the virtualization host has to "push" the time ahead. This can lead to time jumps into the future. If the VMs use other time setting mechanisms like NTP or the time from the Domain Controller, it may get adjusted backwards. All in all, this can lead to very strange timestamps when you capture inside a VM.</p><p>If your timestamps are off, but the frames are in the correct order when sorting by time, you can use reordercap (installed together with Wireshark) to create a correctly ordered trace file from your existing file.</p><p>Oh, and the "packets per hour" do not count with regard to Wireshark crashes, it's the total sum of packets that does it. See my blog post at <a href="http://blog.packet-foo.com/2013/05/the-notorious-wireshark-out-of-memory-problem/">http://blog.packet-foo.com/2013/05/the-notorious-wireshark-out-of-memory-problem/</a> about the reasons for this behavior.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>24 Sep '13, 13:38</strong></p><img src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Jasper&#39;s gravatar image" /><p>Jasper ♦♦<br />
<span class="score" title="23806 reputation points"><span>23.8k</span></span><span title="5 badges"><span class="badge1">●</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">●</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">●</span><span class="badgecount">284</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Jasper has 263 accepted answers">18%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 24 Sep '13, 22:27</p></div></div><div id="comments-container-25174" class="comments-container"><span id="25215"></span><div id="comment-25215" class="comment"><div id="post-25215-score" class="comment-score"></div><div class="comment-text"><p>Thanks for the feedback. The hosts are doing NTP time sync but I suspect that doesn't stop the VM host from messing with their clock; but why would it be doing it on a strange 20 minute pattern? The problem with the timestamps is that they are demonstrably false, request/reply sequences are shown in order (I am mostly looking at snmp traffic) but the time stamp insists the reply arrived before the request. As to the 3.14 figure, I got that by switching to "time since last captured packet" and many of them show up as -3.14... and while it seemed odd that they were right around pi, I doubt that there are relevant trig functions in wireshark (or are there?)</p><p>I do mostly capture with two interfaces selected but I have tried one session (I will do more after your suggestion) with only one interface and it still crashed. The captures are always "goofing" in less than 20 minutes, and always crash after less than two hours (less than 10,000 packets total, barely over 1MB of data).</p></div><div id="comment-25215-info" class="comment-info"><span class="comment-age">(25 Sep '13, 07:11)</span> ipchains1</div></div><span id="25216"></span><div id="comment-25216" class="comment"><div id="post-25216-score" class="comment-score"></div><div class="comment-text"><p>Can you check the memory use of the Wireshark process during the run too determine if it is running out of memory?</p></div><div id="comment-25216-info" class="comment-info"><span class="comment-age">(25 Sep '13, 07:22)</span> grahamb ♦</div></div><span id="25218"></span><div id="comment-25218" class="comment"><div id="post-25218-score" class="comment-score"></div><div class="comment-text"><blockquote><p>but why would it be doing it on a strange 20 minute pattern?</p></blockquote><p>I have seen broken NTP servers that distributed a false time. You could monitor the NTP traffic with Wireshark to figure out if there are time leap signs in the NTP protocol.</p></div><div id="comment-25218-info" class="comment-info"><span class="comment-age">(25 Sep '13, 07:44)</span> Kurt Knochner ♦</div></div><span id="25219"></span><div id="comment-25219" class="comment"><div id="post-25219-score" class="comment-score"></div><div class="comment-text"><p>Regarding the two interfaces - I asked that in correlation to the negative time stamps, not the crashing. Crashing is a out-of-memory situation caused by the amount of packets and their meta data. Can you confirm that there are no negative time stamps if you capture on just one interface?</p></div><div id="comment-25219-info" class="comment-info"><span class="comment-age">(25 Sep '13, 07:55)</span> Jasper ♦♦</div></div><span id="25226"></span><div id="comment-25226" class="comment"><div id="post-25226-score" class="comment-score"></div><div class="comment-text"><p>The NTP is the windows default which I think only updates every 7 days or something like that. The captures don't show any NTP traffic, the time jumps do seem to be common during a group of STP packets but those are constant anyway so it is probably not related. The rollback is always 1200 sec and is never on a wall clock interval (i.e. never on the hour or half hour or even to the minute). And yes, the invalid timestamps/jumps have so far only happened during captures across two interfaces.</p><p>As for memory yes that does seem to be causing the crashes. The memory usage is growing by about 2 <em>megabytes</em> per packet received, so after 30 seconds of capture I have about 30 packets (a quiet day on the network) and the memory has skyrocketed, from about 100mb at startup to almost 200mb.</p></div><div id="comment-25226-info" class="comment-info"><span class="comment-age">(25 Sep '13, 09:41)</span> ipchains1</div></div><span id="25227"></span><div id="comment-25227" class="comment not_top_scorer"><div id="post-25227-score" class="comment-score"></div><div class="comment-text"><p>okay, then the time jumps are explained. They happen because frame time stamping is done by the NIC, and then delivered to the capturing program. When two NICs compete to deliver frames it sometimes happens that one NIC delivers sooner than the other, basically leading to older frames appearing after newer frames in the trace. Since the time stamp was already assigned you'll end up with negative delta times. Use reordercap to reorder your captures after recording them, so that the TCP expert doesn't get crazy :-)</p></div><div id="comment-25227-info" class="comment-info"><span class="comment-age">(25 Sep '13, 10:13)</span> Jasper ♦♦</div></div><span id="25231"></span><div id="comment-25231" class="comment not_top_scorer"><div id="post-25231-score" class="comment-score"></div><div class="comment-text"><p>I was capturing on two interfaces but all the packets for that particular exchange should have only been on one interface since it was specific to one subnet (the two interfaces are used in a multihome setup and not a redundancy setup) so unless there is something untoward going on with the way hyper-v manages the network cards, I would think the offset cant be explained that way. Also, the -1200s offset happened today on a capture set up for just one interface (I am using dumpcapgui now to avoid crashes and only specify one interface in a session).</p></div><div id="comment-25231-info" class="comment-info"><span class="comment-age">(25 Sep '13, 11:41)</span> ipchains1</div></div><span id="25246"></span><div id="comment-25246" class="comment not_top_scorer"><div id="post-25246-score" class="comment-score"></div><div class="comment-text"><blockquote><p>I am using dumpcapgui</p></blockquote><p>what is dumpcapgui?</p></div><div id="comment-25246-info" class="comment-info"><span class="comment-age">(25 Sep '13, 14:08)</span> Kurt Knochner ♦</div></div><span id="25247"></span><div id="comment-25247" class="comment not_top_scorer"><div id="post-25247-score" class="comment-score"></div><div class="comment-text"><blockquote><p>Also, the -1200s offset happened today on a capture set up for just one interface</p></blockquote><p>BTW: Where do you capture the traffic? In the virtual machine (XP) or on the hyper-v host?</p></div><div id="comment-25247-info" class="comment-info"><span class="comment-age">(25 Sep '13, 14:10)</span> Kurt Knochner ♦</div></div><span id="25257"></span><div id="comment-25257" class="comment not_top_scorer"><div id="post-25257-score" class="comment-score"></div><div class="comment-text"><p>@Kurt: DumpcapGUI - <a href="http://www.netskillz.com/dumpcapui/">http://www.netskillz.com/dumpcapui/</a> I also added it with a screen shot at the end of my post at <a href="http://blog.packet-foo.com/2013/05/the-notorious-wireshark-out-of-memory-problem/">http://blog.packet-foo.com/2013/05/the-notorious-wireshark-out-of-memory-problem/</a></p></div><div id="comment-25257-info" class="comment-info"><span class="comment-age">(25 Sep '13, 22:23)</span> Jasper ♦♦</div></div><span id="25262"></span><div id="comment-25262" class="comment not_top_scorer"><div id="post-25262-score" class="comment-score"></div><div class="comment-text"><p>Thanks. <a href="http://bit.ly/184xOj2">http://bit.ly/184xOj2</a> did not show that much when I was searching. It's showing up now, maybe due to this question :-))</p></div><div id="comment-25262-info" class="comment-info"><span class="comment-age">(26 Sep '13, 00:39)</span> Kurt Knochner ♦</div></div><span id="25292"></span><div id="comment-25292" class="comment not_top_scorer"><div id="post-25292-score" class="comment-score"></div><div class="comment-text"><p>Dumpcapgui is great since I have had so much crash trouble lately. I can start dumpcapgui working, and open the cap file in wireshark and refresh it as needed. Sadly wireshark still likes to crash when browsing files &gt; 20k-30k packets but I can restart it easily, and the capture marches on without losing anything.</p><p>To Kurt's question re: the capture location, I am capturing within the XP guest and not on the Hyper-v host so I can see what the OS experiences, since Hyper-v has none of the really cool promiscuity features like VMware to make off-guest capturing practical.</p></div><div id="comment-25292-info" class="comment-info"><span class="comment-age">(26 Sep '13, 11:26)</span> ipchains1</div></div><span id="25293"></span><div id="comment-25293" class="comment not_top_scorer"><div id="post-25293-score" class="comment-score"></div><div class="comment-text"><blockquote><p>I am capturing within the XP guest</p></blockquote><p>O.K. to figure out if you experience time jumps, you could write a short script that records the current date/time into a file. As soon as you detect those time stamp jumps, you could check the file to see if it was the OS time that jumped. If the OS time is 'stable', it must be another strange effect. Is it possible for you to do that and report back, as I'm always interested in these little nasty hard to kill bugs :-))</p></div><div id="comment-25293-info" class="comment-info"><span class="comment-age">(26 Sep '13, 11:33)</span> Kurt Knochner ♦</div></div><span id="25381"></span><div id="comment-25381" class="comment not_top_scorer"><div id="post-25381-score" class="comment-score"></div><div class="comment-text"><p>Sure, I will run a script for 1 hour that takes the windows timestamp from a vbscript timer function call (the best way I can think of on short notice) and also run a wireshark cap for the hour and see how the two compare. If you have a more specific test I would be happy to try it.</p><p>-update: I just ran the test, it only took a few minutes before I saw the first time jump. The data the script gathered is pitch perfect, the vbscript timer stamped out values that matched the wall clock during the same time that the wireshark stamp jumped back 1200 seconds.</p></div><div id="comment-25381-info" class="comment-info"><span class="comment-age">(30 Sep '13, 07:18)</span> ipchains1</div></div><span id="25382"></span><div id="comment-25382" class="comment not_top_scorer"><div id="post-25382-score" class="comment-score"></div><div class="comment-text"><blockquote><p>vbscript timer function</p></blockquote><p>O.K. Actually you just need the time with a resolution of a second, as the time leaps are much bigger than a second. However, you should record the time every second, if possible with vbscript, every 1/10 of a seconds, just to be sure not to miss short time leaps.</p><blockquote><p>If you have a more specific test I would be happy to try it.</p></blockquote><p>let's wait for the results and then think about more/other tests ;-)</p></div><div id="comment-25382-info" class="comment-info"><span class="comment-age">(30 Sep '13, 07:21)</span> Kurt Knochner ♦</div></div><span id="25386"></span><div id="comment-25386" class="comment not_top_scorer"><div id="post-25386-score" class="comment-score"></div><div class="comment-text"><p>Argh, I cant post imgur links and as punishment it throws away my comment? Is there a good way to share images? I took a screenshot of the shark cap and the log file formatted in excel, that shows the weird loop in 'shark and a normal march of time in the vbscript log.</p><p>How about this, if you want to see it make your way to imgur and use the image code CPUYCp5 (just put it after the normal url of that site).</p></div><div id="comment-25386-info" class="comment-info"><span class="comment-age">(30 Sep '13, 07:56)</span> ipchains1</div></div><span id="25388"></span><div id="comment-25388" class="comment not_top_scorer"><div id="post-25388-score" class="comment-score"></div><div class="comment-text"><blockquote><p>Is there a good way to share images? I</p></blockquote><p>well, anyone of these.</p><blockquote><p><a href="http://tinypic.com/">http://tinypic.com/</a><br />
<a href="http://postimage.org/">http://postimage.org/</a><br />
<a href="http://imgur.com/">http://imgur.com/</a><br />
</p></blockquote><p>or any other ;-)</p><p>BTW: I 'upped' your question, which gave you some karma. Can you please try to upload an image now?</p><p>If it still does not work, use one of the above.</p></div><div id="comment-25388-info" class="comment-info"><span class="comment-age">(30 Sep '13, 08:01)</span> Kurt Knochner ♦</div></div><span id="25390"></span><div id="comment-25390" class="comment not_top_scorer"><div id="post-25390-score" class="comment-score"></div><div class="comment-text"><p>Nope, it still throws it away.</p></div><div id="comment-25390-info" class="comment-info"><span class="comment-age">(30 Sep '13, 08:20)</span> ipchains1</div></div><span id="25392"></span><div id="comment-25392" class="comment not_top_scorer"><div id="post-25392-score" class="comment-score"></div><div class="comment-text"><blockquote><p>Nope, it still throws it away.</p></blockquote><p>O.K. can you upload on one of the sites I mentioned and post the link?</p></div><div id="comment-25392-info" class="comment-info"><span class="comment-age">(30 Sep '13, 08:27)</span> Kurt Knochner ♦</div></div><span id="25393"></span><div id="comment-25393" class="comment not_top_scorer"><div id="post-25393-score" class="comment-score"></div><div class="comment-text"><p>I think any url I use is flagged as spam. Tried tinypic and imgur and both were rejected.</p></div><div id="comment-25393-info" class="comment-info"><span class="comment-age">(30 Sep '13, 08:36)</span> ipchains1</div></div><span id="25400"></span><div id="comment-25400" class="comment not_top_scorer"><div id="post-25400-score" class="comment-score"></div><div class="comment-text"><p>can you send me an e-mail? click on my name for the address.</p></div><div id="comment-25400-info" class="comment-info"><span class="comment-age">(30 Sep '13, 10:10)</span> Kurt Knochner ♦</div></div><span id="25410"></span><div id="comment-25410" class="comment not_top_scorer"><div id="post-25410-score" class="comment-score"></div><div class="comment-text"><p>May I post the images here?</p></div><div id="comment-25410-info" class="comment-info"><span class="comment-age">(30 Sep '13, 12:34)</span> Kurt Knochner ♦</div></div><span id="25411"></span><div id="comment-25411" class="comment not_top_scorer"><div id="post-25411-score" class="comment-score"></div><div class="comment-text"><p>@Kurt, sure, you can post the images there is no sensitive info in those packets.</p></div><div id="comment-25411-info" class="comment-info"><span class="comment-age">(30 Sep '13, 13:08)</span> ipchains1</div></div><span id="25421"></span><div id="comment-25421" class="comment not_top_scorer"><div id="post-25421-score" class="comment-score"></div><div class="comment-text"><blockquote><p><a href="https://osqa-ask.wireshark.org/users/2593/kurt-knochner"></a><a href="https://osqa-ask.wireshark.org/users/2593/kurt-knochner">@Kurt</a>, sure, you can post the images there is no sensitive info in those packets.</p></blockquote><p>Here we go. As we can see, there is a time leap in the capture file, but not in the recorded time (see graph). Can you please filter the capture file you sent me (filter: tcp.stream eq 0) and post the exported frames on cloudshark.org ? Maybe somebody else has an idea. I can't explains what's going wrong here.</p><p>One last idea: Did you check the properties of the virtual interface in the virtual machine. Does the driver support TCP/IP Offloading or anything that sounds like time stamping? If so, please disable all of those features and try again (maybe after a reboot).</p><p><img src="http://osqa-ask.wireshark.org/upfiles/timertest_1.png" alt="timertest_1" /></p><p><img src="http://osqa-ask.wireshark.org/upfiles/timertest_2.png" alt="timertest_2" /></p></div><div id="comment-25421-info" class="comment-info"><span class="comment-age">(30 Sep '13, 14:46)</span> Kurt Knochner ♦</div></div><span id="25468"></span><div id="comment-25468" class="comment not_top_scorer"><div id="post-25468-score" class="comment-score"></div><div class="comment-text"><p>Was there a reason to focus on tcp stream 0? I took a capture and filtered for STP (since it is a constant heartbeat every 2 seconds) which demonstrates the issue nicely. I also posted it to cloudshark but as usual I cant post any URL since it is rejected as spam. So, if you want to see it you can use this tag at the URL of cloudshark: <a href="http://www.cloudshark.org/captures/e8ecdd72fcf2">http://www.cloudshark.org/captures/e8ecdd72fcf2</a></p><p>Interestingly, cloudshark doesn't recognize the negative timestamps, instead it starts again at 0 and it also ignores the last 200 packets or so (the capture has 866, the cloudshark window only shows 664) so apparently they don't decode the same way wireshark does.</p></div><div id="comment-25468-info" class="comment-info"><span class="comment-age">(01 Oct '13, 07:21)</span> ipchains1</div></div><span id="25471"></span><div id="comment-25471" class="comment not_top_scorer"><div id="post-25471-score" class="comment-score"></div><div class="comment-text"><blockquote><p>Was there a reason to focus on tcp stream 0?</p></blockquote><p>Just to limit the amount of data.</p><blockquote><p>I also posted it to cloudshark but as usual I cant post any URL since it is rejected as spam.</p></blockquote><p>I added the link for you.</p><p>BTW: Did you check the TCP/IP Offloading (see my last comment)?</p></div><div id="comment-25471-info" class="comment-info"><span class="comment-age">(01 Oct '13, 07:57)</span> Kurt Knochner ♦</div></div><span id="25484"></span><div id="comment-25484" class="comment not_top_scorer"><div id="post-25484-score" class="comment-score"></div><div class="comment-text"><p>I checked the interface info in Wireshark and at the OS level, and there appear to be no offloading options. It is using the "Microsoft virtual machine bus network adapter".</p></div><div id="comment-25484-info" class="comment-info"><span class="comment-age">(01 Oct '13, 13:10)</span> ipchains1</div></div><span id="25505"></span><div id="comment-25505" class="comment not_top_scorer"><div id="post-25505-score" class="comment-score"></div><div class="comment-text"><p>well, then it's either a bug in WinPcap or a bug in Hyper-V. Can you please capture with Microsoft Network Monitor and check if you see the same effect.</p><p>If no, I'd say there could be a WinPcap bug.<br />
If yes, it's more likely to be a 'bug' of Hyper-V.</p></div><div id="comment-25505-info" class="comment-info"><span class="comment-age">(02 Oct '13, 06:00)</span> Kurt Knochner ♦</div></div><span id="25534"></span><div id="comment-25534" class="comment not_top_scorer"><div id="post-25534-score" class="comment-score"></div><div class="comment-text"><p>After running the two side by side the Microsoft NM 3.4 capture doesn't show any strange rollback when Wireshark does. It does have an odd stamp that runs 44 seconds faster than the clock on the virtual OS (so packets appear timestamped 44 seconds in the future). The "offset" column does not appear to be accurate since the first packet (seen &lt;2 sec after start) is stamped with an offset of 44s-45s. The clocks in the virtual guest and virtual host are synced to the same NTP server (And I forced them both at the start of this test) so it is not explainable by clock drift. After observing through a rollback in Wireshark (where wireshark started stamping 20m in the past) the MS NM window still showed the same +44 offset.</p></div><div id="comment-25534-info" class="comment-info"><span class="comment-age">(02 Oct '13, 09:19)</span> ipchains1</div></div><span id="25539"></span><div id="comment-25539" class="comment not_top_scorer"><div id="post-25539-score" class="comment-score"></div><div class="comment-text"><p>O.K. sounds like a big problem with WinPcap and a minor problem with Network Monitor ;-) Maybe you just replace your hypervisor with a product that does not cause any trouble :-))</p></div><div id="comment-25539-info" class="comment-info"><span class="comment-age">(02 Oct '13, 09:45)</span> Kurt Knochner ♦</div></div><span id="25547"></span><div id="comment-25547" class="comment not_top_scorer"><div id="post-25547-score" class="comment-score"></div><div class="comment-text"><p>If it were my hypervisor I would do that, but alas. I tried one last effort at gathering clues, I ran the capture from two different guests at the exact same time (as near as I could get, &lt; 2 sec start difference) and they both looped -1200s at close to the same time, 13 seconds apart, which is outside the window that would be explained by the startup delay. So, whatever is doing this is slightly nondeterminstic and not instigated by the hypervisor.</p><p>Prior to this test I also synced all clocks via NTP, and then disabled NTP on the host and guests just to avoid re-sync issues.</p></div><div id="comment-25547-info" class="comment-info"><span class="comment-age">(02 Oct '13, 11:55)</span> ipchains1</div></div><span id="25548"></span><div id="comment-25548" class="comment not_top_scorer"><div id="post-25548-score" class="comment-score"></div><div class="comment-text"><p>What is your host OS version?</p></div><div id="comment-25548-info" class="comment-info"><span class="comment-age">(02 Oct '13, 12:08)</span> Kurt Knochner ♦</div></div><span id="25551"></span><div id="comment-25551" class="comment not_top_scorer"><div id="post-25551-score" class="comment-score"></div><div class="comment-text"><p>Server 2008 R2 STD with SP1. One other clue I gathered (in case anyone else comes along to pick up the torch) after looking at way too many capture files is that the loop is actually -1199.85 seconds (+/- 10ms) which I thought was odd, it never centered on 1200 +/-.</p></div><div id="comment-25551-info" class="comment-info"><span class="comment-age">(02 Oct '13, 12:27)</span> ipchains1</div></div><span id="25555"></span><div id="comment-25555" class="comment not_top_scorer"><div id="post-25555-score" class="comment-score"></div><div class="comment-text"><blockquote><p>after looking at way too many capture files is that the loop is actually -1199.85 seconds (+/- 10ms) which I thought was odd, it never centered on 1200 +/-.</p></blockquote><p>maybe a pcap modifying hoax malware ;-))</p></div><div id="comment-25555-info" class="comment-info"><span class="comment-age">(02 Oct '13, 13:47)</span> Kurt Knochner ♦</div></div></div><div id="comment-tools-25174" class="comment-tools"><span class="comments-showing"> showing 5 of 34 </span> <a href="#" class="show-all-comments-link">show 29 more comments</a></div><div class="clear"></div><div id="comment-25174-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

