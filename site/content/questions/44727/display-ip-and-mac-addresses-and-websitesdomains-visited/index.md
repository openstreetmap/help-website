+++
type = "question"
title = "Display IP and MAC addresses and websites/domains visited"
description = '''What is needed is a end-of-day filter that displays the following. (IP, MAC addresses and Websites / domains visited) This is for a summary report for management. To be clear, the need is for ALL of this data not just the MAC address related data from One system. The visible illustrations of this su...'''
date = "2015-08-01T20:04:00Z"
lastmod = "2015-08-02T10:36:00Z"
weight = 44727
keywords = [ "mac", "display" ]
aliases = [ "/questions/44727" ]
osqa_answers = 2
osqa_accepted = false
+++

<div class="headNormal">

# [Display IP and MAC addresses and websites/domains visited](/questions/44727/display-ip-and-mac-addresses-and-websitesdomains-visited)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-44727-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-44727-score" class="post-score" title="current number of votes">0</div><span id="post-44727-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>What is needed is a end-of-day filter that displays the following. (IP, MAC addresses and Websites / domains visited) This is for a summary report for management. To be clear, the need is for ALL of this data not just the MAC address related data from One system. The visible illustrations of this subject seem to be focused on ONE MAC address instead of Everyone within the capture.</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-mac" rel="tag" title="see questions tagged &#39;mac&#39;">mac</span> <span class="post-tag tag-link-display" rel="tag" title="see questions tagged &#39;display&#39;">display</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>01 Aug '15, 20:04</strong></p><img src="https://secure.gravatar.com/avatar/a2f30eb72ddd653c54920b7727b1af66?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="chasster123&#39;s gravatar image" /><p><span>chasster123</span><br />
<span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="chasster123 has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>02 Aug '15, 14:42</strong> </span></p><img src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Guy%20Harris&#39;s gravatar image" /><p><span>Guy Harris ♦♦</span><br />
<span class="score" title="17443 reputation points"><span>17.4k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">●</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">●</span><span class="badgecount">196</span></span></p></div></div><div id="comments-container-44727" class="comments-container"></div><div id="comment-tools-44727" class="comment-tools"></div><div class="clear"></div><div id="comment-44727-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

2 Answers:

</div>

</div>

<span id="44728"></span>

<div id="answer-container-44728" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-44728-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-44728-score" class="post-score" title="current number of votes">0</div><span id="post-44728-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>You can only see MAC addresses for systems that are on your network; that is, the network where the traffic was captured. So unless the web servers are all on your network, the only MAC address you will see will be for the router(s).</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>01 Aug '15, 20:21</strong></p><img src="https://secure.gravatar.com/avatar/071fe61f64868d98bdf4eb060b63b6ca?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Jim%20Aragon&#39;s gravatar image" /><p><span>Jim Aragon</span><br />
<span class="score" title="7187 reputation points"><span>7.2k</span></span><span title="7 badges"><span class="badge1">●</span><span class="badgecount">7</span></span><span title="33 badges"><span class="silver">●</span><span class="badgecount">33</span></span><span title="118 badges"><span class="bronze">●</span><span class="badgecount">118</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Jim Aragon has 70 accepted answers">24%</span></p></div></div><div id="comments-container-44728" class="comments-container"><span id="44729"></span><div id="comment-44729" class="comment"><div id="post-44729-score" class="comment-score"></div><div class="comment-text"><p>OK, I need that list of MAC addresses, associated IP addresses and websites / domains visited by all internal systems.</p></div><div id="comment-44729-info" class="comment-info"><span class="comment-age">(01 Aug '15, 20:57)</span> <span class="comment-user userinfo">chasster123</span></div></div></div><div id="comment-tools-44728" class="comment-tools"></div><div class="clear"></div><div id="comment-44728-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="44731"></span>

<div id="answer-container-44731" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-44731-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-44731-score" class="post-score" title="current number of votes">0</div><span id="post-44731-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><p>You could add a column for the MAC address and a custom column displaying the "http.host". That way your packet list will have all the details. Export that via "File" -&gt; "Export Packet Dissections" -&gt; "as CSV" and use Excel (or any other Spreadsheet application) to work with the results.</p><p>You could also leverage tshark with e.g. on a file called "HTTPSample.pcapng":</p><p><code>tshark -r "HTTPSample.pcapng" -Tfields -e eth.src -e ip.src -e http.host</code></p><p>which will give you something like this:</p><p><code>a8:60:00:16:7a:aa       192.168.0.1 00:0d:b9:21:95:18       10.10.10.10 a8:60:00:16:7a:aa       192.168.0.1 a8:60:00:16:7a:aa       192.168.0.1 www.tracewrangler.com 00:0d:b9:21:95:18       10.10.10.10 00:0d:b9:21:95:18       10.10.10.10 a8:60:00:16:7a:aa       192.168.0.1 00:0d:b9:21:95:18       10.10.10.10 00:0d:b9:21:95:18       10.10.10.10 a8:60:00:16:7a:aa       192.168.0.1 00:0d:b9:21:95:18       10.10.10.10 a8:60:00:16:7a:aa       192.168.0.1 a8:60:00:16:7a:aa       192.168.0.1 www.tracewrangler.com 00:0d:b9:21:95:18       10.10.10.10 a8:60:00:16:7a:aa       192.168.0.1 a8:60:00:16:7a:aa       192.168.0.1 00:0d:b9:21:95:18       10.10.10.10 00:0d:b9:21:95:18       10.10.10.10 a8:60:00:16:7a:aa       192.168.0.1</code></p><p>If that's too much, reduce it with sort and uniq, e.g. like this:</p><p><code>tshark -r "HTTPSample.pcapng" -Tfields -e eth.src -e ip.src -e http.host | sort | uniq</code></p><p>which gets you:</p><p><code>00:0d:b9:21:95:18       10.10.10.10 a8:60:00:16:7a:aa       192.168.0.1 a8:60:00:16:7a:aa       192.168.0.1 www.tracewrangler.com</code></p><p>You may have to install <strong>sort</strong> and <strong>uniq</strong> from a Unix tool collection if running this on Windows.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>02 Aug '15, 06:38</strong></p><img src="https://secure.gravatar.com/avatar/c578ba2967741f25aebd6afef702f432?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Jasper&#39;s gravatar image" /><p><span>Jasper ♦♦</span><br />
<span class="score" title="23806 reputation points"><span>23.8k</span></span><span title="5 badges"><span class="badge1">●</span><span class="badgecount">5</span></span><span title="51 badges"><span class="silver">●</span><span class="badgecount">51</span></span><span title="284 badges"><span class="bronze">●</span><span class="badgecount">284</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Jasper has 263 accepted answers">18%</span></p></div></div><div id="comments-container-44731" class="comments-container"><span id="44732"></span><div id="comment-44732" class="comment"><div id="post-44732-score" class="comment-score"></div><div class="comment-text"><p>Great - lots of feedback. Found that I could create a New Expression (edit - preferences). On selecting it (http.host) I get a display of source &amp; destination IP where destination is either an IP or domain name. Regarding "add a column for the MAC address" I've explored the Column Field Types and don't see MAC or the http.post reference. I do see the http.host icon on the main desktop and it works when selected. I've tried selecting "hardware src addr" but don't see a list of MAC addresses. Did verify that Ubuntu has uniq / sort available - have not explored the tshark process as yet.</p><p>Please expand on the column for the MAC address.</p></div><div id="comment-44732-info" class="comment-info"><span class="comment-age">(02 Aug '15, 07:39)</span> <span class="comment-user userinfo">chasster123</span></div></div><span id="44733"></span><div id="comment-44733" class="comment"><div id="post-44733-score" class="comment-score"></div><div class="comment-text"><p>Works for me, but you can always add a custom column with the column setting of "eth.src".</p></div><div id="comment-44733-info" class="comment-info"><span class="comment-age">(02 Aug '15, 07:44)</span> <span class="comment-user userinfo">Jasper ♦♦</span></div></div><span id="44734"></span><div id="comment-44734" class="comment"><div id="post-44734-score" class="comment-score"></div><div class="comment-text"><p>ref tshark, I get a file does not exist reference to "HTTPSample.pcapng". Tried altering the pcapng name - same results. Where dropping the pcapng reference I get a Tfields not specified error.</p><p>cs</p></div><div id="comment-44734-info" class="comment-info"><span class="comment-age">(02 Aug '15, 08:20)</span> <span class="comment-user userinfo">chasster123</span></div></div><span id="44735"></span><div id="comment-44735" class="comment"><div id="post-44735-score" class="comment-score"></div><div class="comment-text"><p>Sorry, I assumed you wanted to read an existing capture file, so I chose that name as an example. So capture first, then run tshark on the file you get.</p></div><div id="comment-44735-info" class="comment-info"><span class="comment-age">(02 Aug '15, 08:30)</span> <span class="comment-user userinfo">Jasper ♦♦</span></div></div><span id="44736"></span><div id="comment-44736" class="comment"><div id="post-44736-score" class="comment-score"></div><div class="comment-text"><p>This runs but no designated output file. tshark -Tfields -e eth.src -e ip.src -e http.host | sort | uniq</p></div><div id="comment-44736-info" class="comment-info"><span class="comment-age">(02 Aug '15, 08:35)</span> <span class="comment-user userinfo">chasster123</span></div></div><span id="44737"></span><div id="comment-44737" class="comment not_top_scorer"><div id="post-44737-score" class="comment-score"></div><div class="comment-text"><p>changed -r to -w "-w HTTPSample.pcapng" and the output file is created. Opened the file in wireshark and see IP addresses but not the MAC numbers.</p></div><div id="comment-44737-info" class="comment-info"><span class="comment-age">(02 Aug '15, 08:41)</span> <span class="comment-user userinfo">chasster123</span></div></div><span id="44738"></span><div id="comment-44738" class="comment not_top_scorer"><div id="post-44738-score" class="comment-score"></div><div class="comment-text"><p>Bingo. First you have to run with a -w to create the pcapng file. Then you run with a -r to read the pcapng file. Now I get the following from tshark and the above basic script. MAC IP Domain (or IP/port)</p><p>Will test more in a session that is using the Browser some to evaluate the result toward that of the goal of creating a report.</p></div><div id="comment-44738-info" class="comment-info"><span class="comment-age">(02 Aug '15, 08:49)</span> <span class="comment-user userinfo">chasster123</span></div></div><span id="44739"></span><div id="comment-44739" class="comment not_top_scorer"><div id="post-44739-score" class="comment-score"></div><div class="comment-text"><p><span>@chasster123</span></p><p>Your "answers" have been converted to comments as that's how this site works. Please read the FAQ for more information.</p></div><div id="comment-44739-info" class="comment-info"><span class="comment-age">(02 Aug '15, 09:02)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="44740"></span><div id="comment-44740" class="comment not_top_scorer"><div id="post-44740-score" class="comment-score"></div><div class="comment-text"><p>That's OK as you drove me in the right direction. I've opened the tshark file in wireshark but as yet don't see the MAC addresses so still exploring there.</p></div><div id="comment-44740-info" class="comment-info"><span class="comment-age">(02 Aug '15, 09:24)</span> <span class="comment-user userinfo">chasster123</span></div></div><span id="44741"></span><div id="comment-44741" class="comment not_top_scorer"><div id="post-44741-score" class="comment-score"></div><div class="comment-text"><p>So now I have src / dst IP &amp; MAC displaying in wireshark from the tshark pcap file. In the tshark display the domain name (name.com) is displayed as the 3rd column. In wireshark the domain name is displayed within the INFO column. Can the Info column be edited or replaced with another Display column showing Only the domain name?</p></div><div id="comment-44741-info" class="comment-info"><span class="comment-age">(02 Aug '15, 10:36)</span> <span class="comment-user userinfo">chasster123</span></div></div></div><div id="comment-tools-44731" class="comment-tools"><span class="comments-showing"> showing 5 of 10 </span> <a href="#" class="show-all-comments-link">show 5 more comments</a></div><div class="clear"></div><div id="comment-44731-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

