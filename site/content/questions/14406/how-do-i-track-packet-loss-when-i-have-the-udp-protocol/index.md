+++
type = "question"
title = "How do I track packet loss when I have the UDP protocol ?"
description = '''How do I track packet loss when I have the UDP protocol?'''
date = "2012-09-20T11:02:00Z"
lastmod = "2012-09-21T07:30:00Z"
weight = 14406
keywords = [ "loss", "udp", "packet" ]
aliases = [ "/questions/14406" ]
osqa_answers = 3
osqa_accepted = true
+++

<div class="headNormal">

# [How do I track packet loss when I have the UDP protocol ?](/questions/14406/how-do-i-track-packet-loss-when-i-have-the-udp-protocol)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-14406-score" class="post-score" title="current number of votes">0</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>How do I track packet loss when I have the UDP protocol?</p></div><div id="question-tags" class="tags-container tags">loss udp packet</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>20 Sep '12, 11:02</strong></p><img src="https://secure.gravatar.com/avatar/ef848df11661133e157e3711063e4562?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="souss&#39;s gravatar image" /><p>souss<br />
<span class="score" title="6 reputation points">6</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="2 badges"><span class="silver">●</span><span class="badgecount">2</span></span><span title="4 badges"><span class="bronze">●</span><span class="badgecount">4</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="souss has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 20 Sep '12, 13:54</p><img src="https://secure.gravatar.com/avatar/071fe61f64868d98bdf4eb060b63b6ca?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Jim%20Aragon&#39;s gravatar image" /><p>Jim Aragon<br />
<span class="score" title="7187 reputation points"><span>7.2k</span></span><span title="7 badges"><span class="badge1">●</span><span class="badgecount">7</span></span><span title="33 badges"><span class="silver">●</span><span class="badgecount">33</span></span><span title="118 badges"><span class="bronze">●</span><span class="badgecount">118</span></span></p></div></div><div id="comments-container-14406" class="comments-container"><span id="14457"></span><div id="comment-14457" class="comment"><div id="post-14457-score" class="comment-score"></div><div class="comment-text"><p>Hello Jim, When you said : then you could display that number in a custom column and manually look for missing numbers. Can you explain to me how can I do or where in Wireshark ? Thanks for all the answers !</p></div><div id="comment-14457-info" class="comment-info"><span class="comment-age">(22 Sep '12, 23:50)</span> souss</div></div><span id="14464"></span><div id="comment-14464" class="comment"><div id="post-14464-score" class="comment-score"></div><div class="comment-text"><p>First, there must be a dissector for the higher-level protocol so that Wireshark puts the unique number into its own field. If so, in the Packet Details pane, right-click on the field you want to use and select "Apply as Column."</p></div><div id="comment-14464-info" class="comment-info"><span class="comment-age">(23 Sep '12, 14:15)</span> Jim Aragon</div></div><span id="14465"></span><div id="comment-14465" class="comment"><div id="post-14465-score" class="comment-score"></div><div class="comment-text"><p>Which is unfortunate. It would be nice if [t|Wire]shark supported being able to display the hex bytes from a <a href="http://www.wireshark.org/docs/wsug_html_chunked/ChWorkBuildDisplayFilterSection.html">display filter expression</a> such as "frame[n:m]". If it did, then you wouldn't necessarily need to have a higher-level protocol with a registered field.</p><p>Well, in the absence of a higher-level protocol and the above feature, it may also be possible to achieve this with <a href="http://wiki.wireshark.org/Lua">Lua</a>, although I have no experience with it so I can't offer much help there.</p></div><div id="comment-14465-info" class="comment-info"><span class="comment-age">(23 Sep '12, 16:16)</span> cmaynard ♦♦</div></div></div><div id="comment-tools-14406" class="comment-tools"></div><div class="clear"></div><div id="comment-14406-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

3 Answers:

</div>

</div>

<span id="14407"></span>

<div id="answer-container-14407" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-14407-score" class="post-score" title="current number of votes">3</div></div></td><td><div class="item-right"><div class="answer-body"><p>Short answer: You don't. UDP does not have anything equivalent to TCP's sequence number / acknowledgement number mechanism to let you track packets and detect packet loss.</p><p>If the higher-level protocol that's running on top of UDP (RTP, TFTP, etc.) has some sort of identification number or sequence number or block number that is unique per packet and that changes in a predictable way, then you could display that number in a custom column and manually look for missing numbers, but there is no way in the UDP protocol itself to identify missing packets.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>20 Sep '12, 13:00</strong></p><img src="https://secure.gravatar.com/avatar/071fe61f64868d98bdf4eb060b63b6ca?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Jim%20Aragon&#39;s gravatar image" /><p>Jim Aragon<br />
<span class="score" title="7187 reputation points"><span>7.2k</span></span><span title="7 badges"><span class="badge1">●</span><span class="badgecount">7</span></span><span title="33 badges"><span class="silver">●</span><span class="badgecount">33</span></span><span title="118 badges"><span class="bronze">●</span><span class="badgecount">118</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Jim Aragon has 70 accepted answers">24%</span></p></div></div><div id="comments-container-14407" class="comments-container"><span id="39684"></span><div id="comment-39684" class="comment"><div id="post-39684-score" class="comment-score"></div><div class="comment-text"><p>There's an easier way; merge 2 packet captures together in Wireshark, if you looking for dropped UDP packets say between 2 routers for example. Go to Statistics&gt;Compare, filter by ip.id then click create, if there are any missed ID packets between both files then the results indicate which ip.id packets were lost and then you know which router interface dropped which packet.</p></div><div id="comment-39684-info" class="comment-info"><span class="comment-age">(06 Feb '15, 07:03)</span> mortirolo</div></div></div><div id="comment-tools-14407" class="comment-tools"></div><div class="clear"></div><div id="comment-14407-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="14410"></span>

<div id="answer-container-14410" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-14410-score" class="post-score" title="current number of votes">0</div></div></td><td><div class="item-right"><div class="answer-body"><p>First, welcome to Wireshark.</p><p>There may be a way if there's nothing in a higher protocol for you to use, but it's fairly implementation specific.</p><p>When I was developing a new piece of network hardware, I noticed that Linux sends out all IP packets with an incrementing identification field in their header, so if you're capturing packets that have been sent out by Linux then you've got a chance. I'm not sure how the Windows or Unix Stacks handle the ident field and not every version of Linux uses the standard stack, so you'll need to check to see if this is happening first.</p><p>Another down side to this is it's the protocol below UDP that's giving you this trackable sequence, which means that even if you suspect a packet has been dropped, there's no way to know whether it was UDP or another protocol.</p><p>I should also mention that if the NIC is using a hardware TSO then the Ident field might not be entirely predictable even with Linux, (some TSO engines don't bother to update it as most network stacks ignore this field.).</p><p>It's not a robust solution, but it may suit your needs.</p><p>Cheers, Craig</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>20 Sep '12, 15:46</strong></p><img src="https://secure.gravatar.com/avatar/7f557535084abef24cd30661f9daefad?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="CTNOBLE&#39;s gravatar image" /><p>CTNOBLE<br />
<span class="score" title="11 reputation points">11</span><span title="2 badges"><span class="badge1">●</span><span class="badgecount">2</span></span><span title="3 badges"><span class="silver">●</span><span class="badgecount">3</span></span><span title="6 badges"><span class="bronze">●</span><span class="badgecount">6</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="CTNOBLE has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 20 Sep '12, 15:48</p></div></div><div id="comments-container-14410" class="comments-container"><span id="14412"></span><div id="comment-14412" class="comment"><div id="post-14412-score" class="comment-score"></div><div class="comment-text"><p>The Identity field in the IP header does indeed increase monotonously. However, it does so for all connections. So yes, if the linux box is not sending out other IP traffic watching the <a href="http://ip.id">ip.id</a> field increase could be an indication of packet loss.</p><p>But if you miss a particular value for the <a href="http://ip.id">ip.id</a>, you have no way of knowing whether there was UDP packet loss or if the linux host sent another IP packet, so this defeats the purpose of using this field for packet loss detection...</p></div><div id="comment-14412-info" class="comment-info"><span class="comment-age">(20 Sep '12, 16:17)</span> SYN-bit ♦♦</div></div><span id="14459"></span><div id="comment-14459" class="comment"><div id="post-14459-score" class="comment-score"></div><div class="comment-text"><p>Also, there are some stack implementations that do not increase the IP ID, but use a value of 0 unless fragmentation happens (OpenBSD, for security reasons). Furthermore, there are Firewalls that randomize the IP ID for the same purpose.</p></div><div id="comment-14459-info" class="comment-info"><span class="comment-age">(23 Sep '12, 04:18)</span> Jasper ♦♦</div></div></div><div id="comment-tools-14410" class="comment-tools"></div><div class="clear"></div><div id="comment-14410-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="14430"></span>

<div id="answer-container-14430" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-14430-score" class="post-score" title="current number of votes">0</div></div></td><td><div class="item-right"><div class="answer-body"><p>Well, if the protocol running atop UDP is "predictable", with every request packet resulting in a fixed number of response packets (or vice versa), then you might be able to count the total number of requests and compare it to the total number of responses. If the values don't correlate, then you can reasonably conclude that some packet loss occurred. An example of this is TFTP, where for every data block transferred, there's an acknowledgement sent in reply. Using TFTP as an example then, if you utilize the Wireshark <strong>"Statistics -&gt; Follow UDP"</strong> feature and then <strong>"Statistics -&gt; Conversations -&gt; UDP"</strong>, selecting also <strong>"Limit to display filter"</strong>, then you can easily see the number of packets transferred in each direction. They should be the same. While your protocol may not work exactly like TFTP, you <em>may</em> be able to use a similar technique.</p><p>Additionally, in the packet details pane, if response packets were lost, you'd see fewer response packets in between requests than expected. If the protocol is "ping-pong", such as TFTP, with 1 response per request, then you'd see back-to-back requests, so that would be something to look for.</p><p>But of course if request packets were lost and not captured by Wireshark, then you might not be able to directly tell if there was any packet loss since there would obviously be no response either, thus the packet counts would seem correct and might mislead you into thinking there's no loss.</p><p>However, you might also be able to surmise possible packet loss if the packets are expected to flow at some more or less steady rate. For example, you could filter just the request packets then sort by <strong>"delta time displayed"</strong> (I suggest you add it as a column if you haven't already). If you notice larger gaps in time than usual, then that may be an indication of packet loss, since, if either the previous request or response packet were lost, the next request would likely be sent after some longer period of time after a response timeout had occurred.</p><p>None of this is guaranteed though and your results will depend greatly on the dynamics of how your UDP-based protocol actually behaves. Still, if you have nothing else to go by, this <em>might</em> help.</p><p>As Jim mentioned though, whenever possible, it's far better to use the information from the payload to help determine packet loss. If you don't have a Wireshark dissector written for this UDP-based protocol, then probably the best solution would be to write one. :)</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>21 Sep '12, 07:30</strong></p><img src="https://secure.gravatar.com/avatar/55158e2322c4e365a5e0a4a0ac3fbcef?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="cmaynard&#39;s gravatar image" /><p>cmaynard ♦♦<br />
<span class="score" title="9361 reputation points"><span>9.4k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="38 badges"><span class="silver">●</span><span class="badgecount">38</span></span><span title="142 badges"><span class="bronze">●</span><span class="badgecount">142</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="cmaynard has 108 accepted answers">20%</span></p></div></div><div id="comments-container-14430" class="comments-container"></div><div id="comment-tools-14430" class="comment-tools"></div><div class="clear"></div><div id="comment-14430-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

