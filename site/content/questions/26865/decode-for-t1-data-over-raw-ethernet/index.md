+++
type = "question"
title = "Decode for T1-data-over-raw-Ethernet"
description = '''Guisys has developed for me an output from a T1 mapped as ethernet payload to a target laptop. The only relation to the data on the T1 is the packet payload. Is there a Wireshark decode for this, or a way to script out the IP addresses and other details in the payload, please? Data is sent by a Cisc...'''
date = "2013-11-11T23:29:00Z"
lastmod = "2013-11-13T16:03:00Z"
weight = 26865
keywords = [ "t1" ]
aliases = [ "/questions/26865" ]
osqa_answers = 1
osqa_accepted = false
+++

<div class="headNormal">

# [Decode for T1-data-over-raw-Ethernet](/questions/26865/decode-for-t1-data-over-raw-ethernet)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-26865-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-26865-score" class="post-score" title="current number of votes">0</div><span id="post-26865-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Guisys has developed for me an output from a T1 mapped as ethernet payload to a target laptop. The only relation to the data on the T1 is the packet payload. Is there a Wireshark decode for this, or a way to script out the IP addresses and other details in the payload, please?</p><p>Data is sent by a Cisco 10k PE router over DS3, inside which channel 16 is the circuit of interest, delivered to another Cisco router as a T1, using Frame-Relay at layer 2, LMI ANSI Annex D.</p><p>My goal is to check for reported packet loss by seeing the original packet and or the retransmitted frame, telling me if the sending or receiving router or telco requires investigtion.</p><p>I do see good data sent from a core router to the PE router.</p><p>Thanks - Brett</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-t1" rel="tag" title="see questions tagged &#39;t1&#39;">t1</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>11 Nov '13, 23:29</strong></p><img src="https://secure.gravatar.com/avatar/8f042a0fdbb2e71193f80e84cdb76c92?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="FSSBrett&#39;s gravatar image" /><p><span>FSSBrett</span><br />
<span class="score" title="11 reputation points">11</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="FSSBrett has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>13 Nov '13, 17:34</strong> </span></p><img src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Guy%20Harris&#39;s gravatar image" /><p><span>Guy Harris ♦♦</span><br />
<span class="score" title="17443 reputation points"><span>17.4k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">●</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">●</span><span class="badgecount">196</span></span></p></div></div><div id="comments-container-26865" class="comments-container"><span id="26913"></span><div id="comment-26913" class="comment"><div id="post-26913-score" class="comment-score"></div><div class="comment-text"><p>What does "an output from a T1 mapped as ethernet payload to a target laptop" mean? Does it mean that they take packets from a T1 and send them out on an Ethernet to your laptop (which is presumably running Wireshark)? If so, in what fashion do they encapsulate that payload? Without knowing that, we're unable to determine whether Wireshark can be made to dissect that without change or if some changes would have to be made to Wireshark.</p></div><div id="comment-26913-info" class="comment-info"><span class="comment-age">(12 Nov '13, 16:46)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="26924"></span><div id="comment-26924" class="comment"><div id="post-26924-score" class="comment-score"></div><div class="comment-text"><p>Guy, Yes, you uderstood me correctly. All the time slots of the T1 are mapped into one Ethernet packet's payload.</p><p>As for encapsulation, pardon, not the best with telco, but the router is sending Frame Relay -</p><p>Serial2/0/2/16:0 is up, line protocol is up Hardware is PMC FREEDM, PMC TEMUX, TDK LIU Description: XXXXXXXXXXXXX Encapsulation FRAME-RELAY IETF, crc 16, loopback not set</p><p>T3 2/0/2 is up. Hardware is C10K Half Height CT3 line card Applique type is Channelized T3 Controller is in channelized mode Description: XXXXXXXXXXXXXXXXX No alarms detected. Framing is M23 (Configured) Line Code is B3ZS, Clock Source is Line</p><p>T1 16 is up timeslots: 1-24 No alarms detected. Framing is ESF, Clock Source is Internal</p><p>Thanks - Brett</p></div><div id="comment-26924-info" class="comment-info"><span class="comment-age">(12 Nov '13, 21:09)</span> <span class="comment-user userinfo">FSSBrett</span></div></div></div><div id="comment-tools-26865" class="comment-tools"></div><div class="clear"></div><div id="comment-26865-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="26927"></span>

<div id="answer-container-26927" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-26927-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-26927-score" class="post-score" title="current number of votes">0</div><span id="post-26927-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span></div></td><td><div class="item-right"><div class="answer-body"><blockquote><p>All the time slots of the T1 are mapped into one Ethernet packet's payload.</p></blockquote><p>That's not something that Wireshark currently understands. If you can get documentation of the packet format, including the Ethernet type used (hopefully they got an official Ethernet type from the IEEE rather than picking one at random...), and can supply a sample capture file for development testing purposes, we might be able to write a dissector for that protocol.</p><p>If you can do that, please file an enhancement request at <a href="http://bugs.wireshark.org/">the Wireshark Bugzilla</a> and attach the documentation to it (or post a link to it) and attach the capture file.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>12 Nov '13, 23:54</strong></p><img src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Guy%20Harris&#39;s gravatar image" /><p><span>Guy Harris ♦♦</span><br />
<span class="score" title="17443 reputation points"><span>17.4k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">●</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">●</span><span class="badgecount">196</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Guy Harris has 216 accepted answers">19%</span></p></div></div><div id="comments-container-26927" class="comments-container"><span id="26951"></span><div id="comment-26951" class="comment"><div id="post-26951-score" class="comment-score"></div><div class="comment-text"><p>Guy,</p><p>In an effort to assist in a solution to query...</p><p>My understanding is that the entire T1-payload is Frame-relay and as such the Ethernet Frame (layer-2) payload is this also fully Frame-relay (the same payload transported from the T1 to the Ethernet frame). No change is made to this Frame-Relay data.</p><p>The continuous/sequential Frame-Relay data resides at 0010 through 0C18 of each and every Ethernet Frame.</p><p>I believe the core question may be, how to configure (or script) Wireshark to decode Frame-Relay at these locations within each Layer-2 Ethernet Frame?</p><p>Mike</p></div><div id="comment-26951-info" class="comment-info"><span class="comment-age">(13 Nov '13, 08:35)</span> <span class="comment-user userinfo">mbp</span></div></div><span id="26954"></span><div id="comment-26954" class="comment"><div id="post-26954-score" class="comment-score"></div><div class="comment-text"><p>Guy, just created bug # 9427</p><p>Attached a copy of the data.</p><p>Tell me what you think please?</p><p>Thanks - Brett</p></div><div id="comment-26954-info" class="comment-info"><span class="comment-age">(13 Nov '13, 10:20)</span> <span class="comment-user userinfo">FSSBrett</span></div></div><span id="26961"></span><div id="comment-26961" class="comment"><div id="post-26961-score" class="comment-score"></div><div class="comment-text"><p>I think it's being transported over TCP, as per my analysis in the bug.</p><p>That makes it unlikely, although not impossible, for the data to be at a particular offset in each frame.</p><p>The transport in the capture is many-layered, with TCP over IP over PPP over L2TP over UDP over IP over MPLS over VLAN-encapsulated Ethernet, so the payload starts well after an offset of 0x0010.</p><p>So either the capture attached to the bug isn't a capture of the traffic in question, or it's not as described by mbp.</p></div><div id="comment-26961-info" class="comment-info"><span class="comment-age">(13 Nov '13, 12:20)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="26963"></span><div id="comment-26963" class="comment"><div id="post-26963-score" class="comment-score"></div><div class="comment-text"><p>Guy, just responded in the bug. Yes, TCP, multilayered (MPLS, etc. too)over L2TP.</p><p>What Mike stated about where the data is mapped is likely where the dissection needs to start. But no being a programmer, I could only guess on the difficulty or success of extracting the Guisys payload and getting to look like the original Ethernet, prior to T1.</p><p>Thanks - Brett</p></div><div id="comment-26963-info" class="comment-info"><span class="comment-age">(13 Nov '13, 12:44)</span> <span class="comment-user userinfo">FSSBrett</span></div></div><span id="26971"></span><div id="comment-26971" class="comment"><div id="post-26971-score" class="comment-score"></div><div class="comment-text"><blockquote><p>So either the capture attached to the bug isn't a capture of the traffic in question</p></blockquote><p>That's the case; the new capture attached to the bug is either running directly atop Ethernet/802.3 (with a length field, but no LLC header) or 802.2. I <em>suspect</em> it's directly atop Ethernet, as, when Wireshark dissects those frames according to the IEEE 802.3 Ethernet specification, the 802.2 headers look somewhat random.</p></div><div id="comment-26971-info" class="comment-info"><span class="comment-age">(13 Nov '13, 15:37)</span> <span class="comment-user userinfo">Guy Harris ♦♦</span></div></div><span id="26972"></span><div id="comment-26972" class="comment not_top_scorer"><div id="post-26972-score" class="comment-score"></div><div class="comment-text"><p>The first file I sent was what the data inside the Guisys output should resemble, once extracted, as indicated in the bug for how the Guisys payload starts.</p><p>So, Guisys ouputs "fake" frames, who's payload is... "1. Only T1 payload or content is transferred to the Ethernet Frame (no T1 Framing or Overhead) 2. The Packets always start with DS0 Channel-1 (unless the T1 slips due to incorrect clocking) 3. and continues through to DS0 channel-24 4. The Packet contains a total of 40-T1's (960-bytes). Starting at 0010 and ending at 03CF. 6. A GUISYS calculated CRC, used ensure payload integrity (4-bytes) - in this example; 8d ae 0c 18 (note that this is not the Ethernet Frame FCS)"</p><p>If I had a serial sniffer, we could see the data expected and perhaps know the dileating characters for the standard network frame/packet structure. But it must be that the Guisys fake frame payload contains with whatever portions of the sending router's data was being delivered to the telco T1, across as many T1 channels per fake frame, for as many fake frames that are needed to transmit a real source router packet.</p><p>Hope this helps - Brett</p></div><div id="comment-26972-info" class="comment-info"><span class="comment-age">(13 Nov '13, 16:03)</span> <span class="comment-user userinfo">FSSBrett</span></div></div></div><div id="comment-tools-26927" class="comment-tools"><span class="comments-showing"> showing 5 of 6 </span> <a href="#" class="show-all-comments-link">show 1 more comments</a></div><div class="clear"></div><div id="comment-26927-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

