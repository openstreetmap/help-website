+++
type = "question"
title = "How to find the symmetric key generated by the browser"
description = '''Hi folks, During an Https connection,our browser will encrypt the randomly generated number with the public key of a website to have an encrypted communication.I just want to know is there any method to find out the randomy generated number of our browser using wireshark. I would also like to know c...'''
date = "2012-06-07T22:19:00Z"
lastmod = "2017-08-31T03:22:00Z"
weight = 11744
keywords = [ "https" ]
aliases = [ "/questions/11744" ]
osqa_answers = 4
osqa_accepted = false
+++

<div class="headNormal">

# [How to find the symmetric key generated by the browser](/questions/11744/how-to-find-the-symmetric-key-generated-by-the-browser)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-11744-score" class="post-score" title="current number of votes">0</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>Hi folks,</p><p>During an Https connection,our browser will encrypt the randomly generated number with the public key of a website to have an encrypted communication.I just want to know is there any method to find out the randomy generated number of our browser using wireshark. I would also like to know can we sniff https connection to see the payload?I heard there are some tools available in market to find what are the datas send via HTTPS.</p><p>Regards, Bluebird</p></div><div id="question-tags" class="tags-container tags">https</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>07 Jun '12, 22:19</strong></p><img src="https://secure.gravatar.com/avatar/e14349cba01140777175a135d83b3842?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="bluebird77&#39;s gravatar image" /><p>bluebird77<br />
<span class="score" title="1 reputation points">1</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="bluebird77 has no accepted answers">0%</span></p></div></div><div id="comments-container-11744" class="comments-container"></div><div id="comment-tools-11744" class="comment-tools"></div><div class="clear"></div><div id="comment-11744-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

4 Answers:

</div>

</div>

<span id="11748"></span>

<div id="answer-container-11748" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-11748-score" class="post-score" title="current number of votes">1</div></div></td><td><div class="item-right"><div class="answer-body"><blockquote><p>I just want to know is there any method to find out the randomy generated number of our browser using wireshark.<br />
I would also like to know can we sniff https connection to see the payload?</p></blockquote><p>No, wireshark can't "find" the key for you (e.g. by searching the computer memory).</p><p>However, you can decrypt an SSL session, if you give wireshark the private key of the webserver (only possible if you have access to that key!). By sniffing the SSL handshake, wireshark is able to extract the session key. See here:</p><blockquote><p><code>http://wiki.wireshark.org/SSL</code><br />
</p></blockquote><p>Follow the instructions and you will be able to decrypt a SSL connection.</p><blockquote><p>I heard there are some tools available in market to find what are the datas send via HTTPS.</p></blockquote><p>That's most certainly plugins for a browser, that are able to capture data in the browser before it gets encrypted. Like these:</p><blockquote><p><code>http://www.httpwatch.com/</code><br />
<code>http://www.iewatch.com/</code><br />
</p></blockquote><p>My preferred tool for web debugging is a proxy that is able to do SSL "decryption".</p><blockquote><p><code>http://www.fiddler2.com/fiddler2/</code><br />
</p></blockquote><p>Fiddler is a good companion to wireshark if you don't have access to the web server's private key and you need to "see" the decrypted communication (URLs, error messages, etc.).</p><p>Regards<br />
Kurt</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>08 Jun '12, 01:30</strong></p><img src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Kurt%20Knochner&#39;s gravatar image" /><p>Kurt Knochner ♦<br />
<span class="score" title="24767 reputation points"><span>24.8k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">●</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">●</span><span class="badgecount">237</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Kurt Knochner has 344 accepted answers">15%</span> </br></br></p></div><div class="post-update-info post-update-info-edited"><p>edited 08 Jun '12, 02:04</p></div></div><div id="comments-container-11748" class="comments-container"><span id="11886"></span><div id="comment-11886" class="comment"><div id="post-11886-score" class="comment-score"></div><div class="comment-text"><p>thanks Kurt.....</p></div><div id="comment-11886-info" class="comment-info"><span class="comment-age">(13 Jun '12, 21:34)</span> bluebird77</div></div></div><div id="comment-tools-11748" class="comment-tools"></div><div class="clear"></div><div id="comment-11748-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="29358"></span>

<div id="answer-container-29358" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-29358-score" class="post-score" title="current number of votes">0</div></div></td><td><div class="item-right"><div class="answer-body"><p>Should the question be about how to find the random number (32 bytes) which client's browser sends to web server and what number (along with server's random number (32 bytes)) is employed to generate the session key (the length depends on cipher suit, which code is not encrypted within the handshake) then this random number (server's random number as well) is sent in unencrypted form too.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>31 Jan '14, 12:59</strong></p><img src="https://secure.gravatar.com/avatar/de409ac68d873aad919bffd6206f8291?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Buktop&#39;s gravatar image" /><p>Buktop<br />
<span class="score" title="11 reputation points">11</span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Buktop has no accepted answers">0%</span> </br></br></p></div><div class="post-update-info post-update-info-edited"><p>edited 31 Jan '14, 13:16</p></div></div><div id="comments-container-29358" class="comments-container"></div><div id="comment-tools-29358" class="comment-tools"></div><div class="clear"></div><div id="comment-29358-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="62770"></span>

<div id="answer-container-62770" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-62770-score" class="post-score" title="current number of votes">0</div></div></td><td><div class="item-right"><div class="answer-body"><p>Actually to be more precise the https site visited gives the browser a certificate which has its public key in it (this can be seen in the certificate). The browser in return makes a pseudo-randomly generated symmetric from mouse clicks a key presses and encrypts the public key with it. On the other side, the site upon receiving the encrypted public key, uses its private key to decrypt it.</p><p>So here the question is on being able to read the symetric key generated by the browser to encrypt the https public key.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>13 Jul '17, 19:24</strong></p><img src="https://secure.gravatar.com/avatar/e303d3d5a6f97302ce4e45cb4b89af08?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="nassim&#39;s gravatar image" /><p>nassim<br />
<span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="bronze">●</span><span class="badgecount">1</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="nassim has no accepted answers">0%</span> </br></br></p></div></div><div id="comments-container-62770" class="comments-container"><span id="62781"></span><div id="comment-62781" class="comment"><div id="post-62781-score" class="comment-score"></div><div class="comment-text"><p>You are trying to describe a <a href="https://tools.ietf.org/html/rfc5246#appendix-F.1.1.2">key exchange based on a RSA cipher suite</a>, but some details are misleading:</p><ol><li>The RSA public key encrypts a randomly generated premaster secret. Not the other way round. The server decrypts the encrypted premaster secret with its private RSA key and obtains the same premaster secret.</li><li>This premaster secret is not generated from just mouse clicks and key presses. It is taken from a <a href="https://tools.ietf.org/html/rfc5246#appendix-D.1">(pseudo)random number generator</a> which could (but does not have to) incorporate things like mouse clicks.</li></ol><p>If you provide the private RSA key file to Wireshark and such a RSA key exchange is in use, then Wireshark can decrypt packets on the fly. If a Diffie-Hellman key exchange is in use, then it becomes a different story.</p></div><div id="comment-62781-info" class="comment-info"><span class="comment-age">(14 Jul '17, 07:45)</span> Lekensteyn</div></div></div><div id="comment-tools-62770" class="comment-tools"></div><div class="clear"></div><div id="comment-62770-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="63540"></span>

<div id="answer-container-63540" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-63540-score" class="post-score" title="current number of votes">0</div></div></td><td><div class="item-right"><div class="answer-body"><p>If you use Chrome or Firefox as your browser, you can set an environment variable, "SSLKEYLOGFILE".</p><p>If that environment variable is set, the browsers will append to the file every time they create a new SSL session key. You can instruct Wireshark to import those keys and it will then decrypt any SSL sessions that match those keys.</p><p>This website gives a good description and "how to" do this.</p><p><a href="https://jimshaver.net/2015/02/11/decrypting-tls-browser-traffic-with-wireshark-the-easy-way/">https://jimshaver.net/2015/02/11/decrypting-tls-browser-traffic-with-wireshark-the-easy-way/</a></p><p>Of course, you can only set this up on a user PC (Windows or Linux) that you have control over and are able to set the variable then extract the keyfiles from.</p><p>The capture doesn't have to be taken on the PC though.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>31 Aug '17, 03:22</strong></p><img src="https://secure.gravatar.com/avatar/35a0c1d0cf15b9d54d73bf54ae28abcd?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Philst&#39;s gravatar image" /><p>Philst<br />
<span class="score" title="431 reputation points">431</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="6 badges"><span class="silver">●</span><span class="badgecount">6</span></span><span title="16 badges"><span class="bronze">●</span><span class="badgecount">16</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Philst has 6 accepted answers">27%</span></p></div></div><div id="comments-container-63540" class="comments-container"><span id="63541"></span><div id="comment-63541" class="comment"><div id="post-63541-score" class="comment-score"></div><div class="comment-text"><p>Or you can go direct to the Wireshark Wiki for information on how to decrypt a TLS\SSL session rather than a 2 year old blog post that will never be updated.</p><p>The Wiki page is <a href="https://wiki.wireshark.org/SSL">here</a> and the section discussing the Pre-Master Secret is <a href="https://wiki.wireshark.org/SSL#Using_the_.28Pre.29-Master-Secret">here</a>.</p></div><div id="comment-63541-info" class="comment-info"><span class="comment-age">(31 Aug '17, 03:52)</span> grahamb ♦</div></div><span id="63542"></span><div id="comment-63542" class="comment"><div id="post-63542-score" class="comment-score"></div><div class="comment-text"><p>The Wiki page actually includes a link to the page I referenced. I just saved a step.</p></div><div id="comment-63542-info" class="comment-info"><span class="comment-age">(31 Aug '17, 05:22)</span> Philst</div></div></div><div id="comment-tools-63540" class="comment-tools"></div><div class="clear"></div><div id="comment-63540-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

