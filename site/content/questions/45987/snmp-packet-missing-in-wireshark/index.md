+++
type = "question"
title = "SNMP packet missing in wireshark"
description = '''I have polled asynchronously a SNMP device in a simulated network using a java file, written with SNMP API. In a 30 seconds of polling time, I have sent around 350000 V1 Get requests. My SNMP API listener showing that all the request have been sent and got success response for each request. But when...'''
date = "2015-09-20T21:35:00Z"
lastmod = "2015-09-21T00:58:00Z"
weight = 45987
keywords = [ "snmpwireshark" ]
aliases = [ "/questions/45987" ]
osqa_answers = 0
osqa_accepted = false
+++

<div class="headNormal">

# [SNMP packet missing in wireshark](/questions/45987/snmp-packet-missing-in-wireshark)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-45987-score" class="post-score" title="current number of votes">0</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I have polled asynchronously a SNMP device in a simulated network using a java file, written with SNMP API. In a 30 seconds of polling time, I have sent around 350000 V1 Get requests.</p><p>My SNMP API listener showing that all the request have been sent and got success response for each request. But when I capture the packets using wireshark, it is not showing that all the packets are sent. When I check the request id of the snmp packets in wireshark,I could able to find out that the last request's requst id is same to the total number of packets sent by SNMP API. But request id of some other SNMP packets are missing in the wireshark.</p><p>For a 1 second polling, all the packets are captured in wireshark successfully. But when the polling time is increased, packet missing is occurred. For a 30 second polling, 350k requests, wireshark missed around 3k requests. If my API showing that 350k requests was sent, the first request id in wireshark is 1 and the last request id is 350k. But in between 1 and 350k, some requests are missing in wireshark.</p><p>Is there any limitation for wireshark like that it can capture only a particular number of packets per second?</p><p>Why this scenario occurred? Please help me to figure out this.</p><p>Thanks in advance.</p></div><div id="question-tags" class="tags-container tags">snmpwireshark</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>20 Sep '15, 21:35</strong></p><img src="https://secure.gravatar.com/avatar/040da8397d22921ef86466dbf7ec5a03?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="BlueMan&#39;s gravatar image" /><p>BlueMan<br />
<span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="BlueMan has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p>edited 21 Sep '15, 06:33</p></div></div><div id="comments-container-45987" class="comments-container"><span id="45988"></span><div id="comment-45988" class="comment"><div id="post-45988-score" class="comment-score"></div><div class="comment-text"><p>What version of what operating system are you capturing on? What does Wireshark show in the "About Wireshark" dialog?</p></div><div id="comment-45988-info" class="comment-info"><span class="comment-age">(20 Sep '15, 22:13)</span> Guy Harris ♦♦</div></div><span id="45989"></span><div id="comment-45989" class="comment"><div id="post-45989-score" class="comment-score"></div><div class="comment-text"><p>I am using Ubuntu 12.04.5 LTS machine. In the "About Wireshark" dialog, its showing that -&gt;</p><p>"Version 1.6.7</p><p>Copyright 1998-2012 Gerald Combs [email protected] and contributors. This is free software; see the source for copying conditions. There is NO warranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</p><p>Compiled (64-bit) with GTK+ 2.24.10, with GLib 2.32.0, with libpcap (version unknown), with libz 1.2.3.4, with POSIX capabilities (Linux), without libpcre, with SMI 0.4.8, with c-ares 1.7.5, with Lua 5.1, without Python, with GnuTLS 2.12.14, with Gcrypt 1.5.0, with MIT Kerberos, with GeoIP, with PortAudio V19-devel (built Dec 10 2011 11:43:10), without AirPcap.</p><p>Running on Linux 3.2.0-23-generic, with libpcap version 1.1.1, with libz 1.2.3.4, GnuTLS 2.12.14, Gcrypt 1.5.0.</p><p>Built using gcc 4.6.3."</p></div><div id="comment-45989-info" class="comment-info"><span class="comment-age">(20 Sep '15, 23:11)</span> BlueMan</div></div><span id="46016"></span><div id="comment-46016" class="comment"><div id="post-46016-score" class="comment-score"></div><div class="comment-text"><p>Does the status bar at the bottom of Wireshark show any information about dropped packets when you stop the capture? I can't remember if your very old version did that?</p></div><div id="comment-46016-info" class="comment-info"><span class="comment-age">(21 Sep '15, 07:21)</span> grahamb ♦</div></div><span id="46044"></span><div id="comment-46044" class="comment"><div id="post-46044-score" class="comment-score"></div><div class="comment-text"><p>I couldn't able to find out any such information in wireshark. Did the latest version have that type of information?</p></div><div id="comment-46044-info" class="comment-info"><span class="comment-age">(21 Sep '15, 22:27)</span> BlueMan</div></div></div><div id="comment-tools-45987" class="comment-tools"></div><div class="clear"></div><div id="comment-45987-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

One Answer:

</div>

</div>

<span id="45993"></span>

<div id="answer-container-45993" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-45993-score" class="post-score" title="current number of votes">1</div></div></td><td><div class="item-right"><div class="answer-body"><blockquote><p>Running on Linux 3.2.0-23-generic, with libpcap version 1.1.1</p></blockquote><p>Then you're running with a version of the Linux kernel with support for versions 1 (TPACKET_V1), 2 (TPACKET_V2), and 3 (TPACKET_V3) of the "turbopacket" memory-mapped capture mechanism and a version of libpcap that only supports versions 1 and 2.</p><p>TPACKET_V3 is a <strong><em>LOT</em></strong> better than TPACKET_V1 and TPACKET_V2 for packet capture; it makes <strong><em>MUCH</em></strong> more efficient use of the kernel capture buffer space. Libpcap 1.1.1 makes better use of the TPACKET_V1/TPACKET_V2 mechanism's buffer space than did even older versions, but that's still not enough to make it work really well.</p><p>If you could download, for example, <a href="http://www.tcpdump.org/#latest-release">the libpcap 1.7.4 source</a>, compile it, install it, <em>and</em> rebuild Wireshark from source, linking it with the installed version of libpcap, that will probably drop a <em>lot</em> fewer packets, as it'll be using TPACKET_V3 - it <em>might</em> even be able to capture the fast burst of traffic (11666 packets per second!) without dropping packets. A worst-case scenario for TPACKET_V1 and TPACKET_V2 is a lot of small packets - each of the slots in the kernel's buffer for TPACKET_V1 and TPACKET_V2 can hold only one packet, no matter how small the packets are, so small packets waste a lot of space, whereas a slot for TPACKET_V3 can hold as many packets as will fit in the slot, and the smaller the packets, the more will fit.</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>21 Sep '15, 00:58</strong></p><img src="https://secure.gravatar.com/avatar/f93de7000747ab5efb5acd3034b2ebd7?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Guy%20Harris&#39;s gravatar image" /><p>Guy Harris ♦♦<br />
<span class="score" title="17443 reputation points"><span>17.4k</span></span><span title="3 badges"><span class="badge1">●</span><span class="badgecount">3</span></span><span title="35 badges"><span class="silver">●</span><span class="badgecount">35</span></span><span title="196 badges"><span class="bronze">●</span><span class="badgecount">196</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Guy Harris has 216 accepted answers">19%</span></p></div></div><div id="comments-container-45993" class="comments-container"><span id="45997"></span><div id="comment-45997" class="comment"><div id="post-45997-score" class="comment-score"></div><div class="comment-text"><p>"If you could download, for example, the libpcap 1.7.4 source, compile it, install it, and rebuild Wireshark from source, linking it with the installed version of libpcap, that will probably drop a lot fewer packets, as it'll be using TPACKET_V3"</p><p>Please explain the detailed steps so that I can do this in my Ubuntu 12.04.5 LTS machine and test it.</p><p>Thanks a lot for your guidance.</p></div><div id="comment-45997-info" class="comment-info"><span class="comment-age">(21 Sep '15, 01:32)</span> BlueMan</div></div><span id="46017"></span><div id="comment-46017" class="comment"><div id="post-46017-score" class="comment-score"></div><div class="comment-text"><p>I'm not sure about libpcap, but for building Wireshark see the <a href="https://www.wireshark.org/docs/wsdg_html_chunked/">Developers Guide</a>.</p><p>On Ubuntu previously I've used <code>sudo apt-get build-dep wireshark</code> to get all the dependencies, and then used CMake to build (look at readme.CMake in the Wireshark top level sources).</p></div><div id="comment-46017-info" class="comment-info"><span class="comment-age">(21 Sep '15, 07:25)</span> grahamb ♦</div></div><span id="46142"></span><div id="comment-46142" class="comment"><div id="post-46142-score" class="comment-score"></div><div class="comment-text"><p>I have updated wireshark from 1.6.7 to 1.8.2 using the commands : "sudo add-apt-repository ppa:eugenesan/ppa sudo apt-get update sudo apt-get install wireshark".</p><p>In this one also the libcap version is 1.1.1. Packet missing is occuring in this 1.8.2 version also, when I used the SNMP API polling java file.</p><p>When I used a script file using the netsnmp command for polling, out of 300000 requests, 287 were missing. The script file content is given below. "for (( i=1; i&lt;=300000; i++ )) do snmpget -v 1 -c public -t 5 1.1.1.1:8001 .1.3.6.1.2.1.1.1.0 done "</p><p>The request per second sent by the netsnmp script file is very much less than the request per second sent by the SNMP API java file. That may be the reason for the missing packet count is reduced for netsnmp request.</p><p>From this can I confirm that wireshark will miss packet capture for a large number of request per second?</p></div><div id="comment-46142-info" class="comment-info"><span class="comment-age">(25 Sep '15, 02:25)</span> BlueMan</div></div><span id="46144"></span><div id="comment-46144" class="comment"><div id="post-46144-score" class="comment-score"></div><div class="comment-text"><p>I tried to install the wireshark 1.12.7 from www.wireshark.org, in my Ubuntu 12.04. I downloaded the source code for installation. But there was no make file present in that tar file, as said in the "https://www.wireshark.org/docs/wsug_html_chunked/ChBuildInstallUnixBuild.html"</p><p>Can you please help me how can I install wireshark 1.12.7 in my machine?</p><p>Is that version contain the latest libcap version so that there should not be any missing packets?</p></div><div id="comment-46144-info" class="comment-info"><span class="comment-age">(25 Sep '15, 02:30)</span> BlueMan</div></div><span id="46145"></span><div id="comment-46145" class="comment"><div id="post-46145-score" class="comment-score"></div><div class="comment-text"><p>libpcap is a separate project, instructions on how to clone the repo and build are at <a href="http://www.tcpdump.org/#source.">http://www.tcpdump.org/#source.</a></p><p>For Wireshark we have the <a href="https://www.wireshark.org/docs/wsdg_html_chunked/">Developers Guide</a>.</p></div><div id="comment-46145-info" class="comment-info"><span class="comment-age">(25 Sep '15, 02:36)</span> grahamb ♦</div></div></div><div id="comment-tools-45993" class="comment-tools"></div><div class="clear"></div><div id="comment-45993-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

