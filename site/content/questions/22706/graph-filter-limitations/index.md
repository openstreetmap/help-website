+++
type = "question"
title = "Graph Filter limitations"
description = '''I&#x27;ve been experimenting with different ways to display certain traffic. First I display traffic trough the IO Graph tool, next I try to add a second line (Red to mark it as unwanted) and add a Filter. The problem however is that the Graph tool does not support as long a filter as regular display fil...'''
date = "2013-07-08T01:27:00Z"
lastmod = "2013-07-08T03:07:00Z"
weight = 22706
keywords = [ "filter", "graph" ]
aliases = [ "/questions/22706" ]
osqa_answers = 2
osqa_accepted = true
+++

<div class="headNormal">

# [Graph Filter limitations](/questions/22706/graph-filter-limitations)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-22706-score" class="post-score" title="current number of votes">0</div><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I've been experimenting with different ways to display certain traffic. First I display traffic trough the IO Graph tool, next I try to add a second line (Red to mark it as unwanted) and add a Filter. The problem however is that the Graph tool does not support as long a filter as regular display filters.</p><p>Is this normal behavior? Is there anyway around this? Perhaps any suggestions how to better show all network traffic and highlight certain (unwanted) traffic in graphs?</p></div><div id="question-tags" class="tags-container tags">filter graph</div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>08 Jul '13, 01:27</strong></p><img src="https://secure.gravatar.com/avatar/25daf811ebe1190b06093b3676a2533f?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="JoepMeloen86&#39;s gravatar image" /><p>JoepMeloen86<br />
<span class="score" title="26 reputation points">26</span><span title="6 badges"><span class="badge1">●</span><span class="badgecount">6</span></span><span title="6 badges"><span class="silver">●</span><span class="badgecount">6</span></span><span title="11 badges"><span class="bronze">●</span><span class="badgecount">11</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="JoepMeloen86 has one accepted answer">50%</span></p></div></div><div id="comments-container-22706" class="comments-container"><span id="22709"></span><div id="comment-22709" class="comment"><div id="post-22709-score" class="comment-score"></div><div class="comment-text"><blockquote><p>The problem however is that the Graph tool does not support as long a filter as regular display filters.</p></blockquote><ul><li>What is your Wireshark version?</li><li>how long are those filters?</li></ul></div><div id="comment-22709-info" class="comment-info"><span class="comment-age">(08 Jul '13, 01:53)</span> Kurt Knochner ♦</div></div><span id="22711"></span><div id="comment-22711" class="comment"><div id="post-22711-score" class="comment-score"></div><div class="comment-text"><p>Version 1.10, Filter = 588 characters (including a lot of spaces and brackets) lets say 16 conditions.</p></div><div id="comment-22711-info" class="comment-info"><span class="comment-age">(08 Jul '13, 02:05)</span> JoepMeloen86</div></div></div><div id="comment-tools-22706" class="comment-tools"></div><div class="clear"></div><div id="comment-22706-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

------------------------------------------------------------------------

<div class="tabBar">

<span id="sort-top"></span>

<div class="headQuestions">

2 Answers:

</div>

</div>

<span id="22717"></span>

<div id="answer-container-22717" class="answer accepted-answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-22717-score" class="post-score" title="current number of votes">1</div></div></td><td><div class="item-right"><div class="answer-body"><p>I have not looked at the source code to see how long the filter strings can be in each GUI element. But you might want to use "Display Filter Macro's". Go to "Analyze -&gt; Display Filter Macros" and then add a macro with your filter.</p><p>I just tried it with your filter in a macro called "excluded" and then I used the filter <code>${excluded}</code> in the IO graph filter box. That worked, but I'm not sure how long filter macros may be though :-)</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>08 Jul '13, 03:07</strong></p><img src="https://secure.gravatar.com/avatar/7901a94d8fdd1f9f47cda9a32fcfa177?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="SYN-bit&#39;s gravatar image" /><p>SYN-bit ♦♦<br />
<span class="score" title="17094 reputation points"><span>17.1k</span></span><span title="9 badges"><span class="badge1">●</span><span class="badgecount">9</span></span><span title="57 badges"><span class="silver">●</span><span class="badgecount">57</span></span><span title="245 badges"><span class="bronze">●</span><span class="badgecount">245</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="SYN-bit has 174 accepted answers">20%</span></p></div></div><div id="comments-container-22717" class="comments-container"><span id="22720"></span><div id="comment-22720" class="comment"><div id="post-22720-score" class="comment-score"></div><div class="comment-text"><p>Hi, just tested it, and it seems to work. (first test I did showed just as high red spikes as black, as if the filtered traffic was exact the same as non-filtered traffic. Second test showed definite change). Thanks so far. I have a workable solution (or workaround if you will).</p></div><div id="comment-22720-info" class="comment-info"><span class="comment-age">(08 Jul '13, 03:43)</span> JoepMeloen86</div></div></div><div id="comment-tools-22717" class="comment-tools"></div><div class="clear"></div><div id="comment-22717-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<span id="22710"></span>

<div id="answer-container-22710" class="answer">

<table style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><div id="post-22710-score" class="post-score" title="current number of votes">1</div></div></td><td><div class="item-right"><div class="answer-body"><blockquote><p>Perhaps any suggestions how to better show all network traffic and highlight certain (unwanted) traffic in graphs?</p></blockquote><p>it depends on your intentions. What is 'unwanted' traffic in your scenario. If the 'wanted' traffic is easier to describe, build a reverse filter. Draw everything that is <strong>not</strong> wanted traffic, which would then be <strong>unwanted</strong> traffic.</p><p>Like this:</p><blockquote><p>Graph 1 (wanted): tcp.port eq 1234 or tcp.port eq 8090<br />
Graph 2 (unwanted): not (tcp.port eq 1234 or tcp.port eq 8090)</p></blockquote><p>Maybe you need to pre-filter (Display Filter) and export (File -&gt; Export Specified Packets) the whole file to remove anything you don't want in the IO graphs. This will also reduce the time to create the graph, if you can eliminate a larger part of the traffic in this step.</p><p>Regards<br />
Kurt</p></div><div class="answer-controls post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>answered <strong>08 Jul '13, 01:59</strong></p><img src="https://secure.gravatar.com/avatar/23b7bf5b13bc2c98b2e8aa9869ca5d75?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Kurt%20Knochner&#39;s gravatar image" /><p>Kurt Knochner ♦<br />
<span class="score" title="24767 reputation points"><span>24.8k</span></span><span title="10 badges"><span class="badge1">●</span><span class="badgecount">10</span></span><span title="39 badges"><span class="silver">●</span><span class="badgecount">39</span></span><span title="237 badges"><span class="bronze">●</span><span class="badgecount">237</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Kurt Knochner has 344 accepted answers">15%</span> </br></br></p></div><div class="post-update-info post-update-info-edited"><p>edited 08 Jul '13, 04:11</p></div></div><div id="comments-container-22710" class="comments-container"><span id="22712"></span><div id="comment-22712" class="comment"><div id="post-22712-score" class="comment-score"></div><div class="comment-text"><p>Ok, thanks for the tip. I will try this. However, the question still remains: Is this normal behavior? Is there anyway around this?</p></div><div id="comment-22712-info" class="comment-info"><span class="comment-age">(08 Jul '13, 02:06)</span> JoepMeloen86</div></div><span id="22714"></span><div id="comment-22714" class="comment"><div id="post-22714-score" class="comment-score"></div><div class="comment-text"><blockquote><p>Is this normal behavior? Is there anyway around this?</p></blockquote><p>There are character limits for a display filter, but they are all much larger than 588 chars (as far as I remember). So, either you found a bug, or your filter is wrong. Is it possible to post the filter here?</p></div><div id="comment-22714-info" class="comment-info"><span class="comment-age">(08 Jul '13, 02:17)</span> Kurt Knochner ♦</div></div><span id="22716"></span><div id="comment-22716" class="comment"><div id="post-22716-score" class="comment-score"></div><div class="comment-text"><p>Had to change a lot of data of course, length of every definition should be the same though. With this I filter all wanted traffic, and get left with all unwanted traffic. Until now I have been exporting all the remaining (and thus unwanted) traffic and build a graph out of that (as you suggested already). Would be nice if I could build a graph of all traffic, and create a second red line using the filter below. It cuts me off in the definition after WPAD, when I try to either paste or select this in the Graph filter.</p><p>(http or ssl) &amp;&amp; !(ip.addr == 100.10.100.1/25) &amp;&amp; !(ip.addr == 100.10.100.1/24) &amp;&amp; !(ip.addr == 10.100.10.100) &amp;&amp; !(http.host contains "WKS1234567") &amp;&amp; !(http.request.uri contains "abcdefg") &amp;&amp; !(http.request.uri contains "wpad") &amp;&amp; !(http.content_type contains "proxy-autoconfig") &amp;&amp; !(ip.dst == 100.100.100.100) &amp;&amp; !(http.proxy_connect_host contains "abcdefg") &amp;&amp; !(http.response.code == 200) &amp;&amp; !ipv6 &amp;&amp; !(http.proxy_connect_host contains "abcdefghijklmn") &amp;&amp; !(http.host contains "abcdefghijklmn") &amp;&amp; !(http.request.uri contains "abc45678") &amp;&amp; !(http.request.uri contains "abcdef78")</p></div><div id="comment-22716-info" class="comment-info"><span class="comment-age">(08 Jul '13, 03:00)</span> JoepMeloen86</div></div><span id="22718"></span><div id="comment-22718" class="comment"><div id="post-22718-score" class="comment-score">1</div><div class="comment-text"><p>O.K. there seems to be a limit of 256 characters in that field.</p><p>My position: Display should have to same limits everywhere in the GUI. As there is a limit for the length of the display filter here, I would consider this as a bug. Please file a bug report at <a href="https://bugs.wireshark.org">https://bugs.wireshark.org</a></p><p>As @SYN-bit mentioned, marcos may (or may not) work, depending on where the restriction is in this case. Please try it with a macro and report the results here for the benefit of others :-)</p></div><div id="comment-22718-info" class="comment-info"><span class="comment-age">(08 Jul '13, 03:34)</span> Kurt Knochner ♦</div></div><span id="22719"></span><div id="comment-22719" class="comment"><div id="post-22719-score" class="comment-score">1</div><div class="comment-text"><p>UPDATE: I did a short test myself with your display filter. It works as a macro. So the limitation is just the input length of that field.</p></div><div id="comment-22719-info" class="comment-info"><span class="comment-age">(08 Jul '13, 03:43)</span> Kurt Knochner ♦</div></div><span id="22744"></span><div id="comment-22744" class="comment not_top_scorer"><div id="post-22744-score" class="comment-score"></div><div class="comment-text"><p>So what would be a more reasonable limit? 1000? 5000? 10000? More?</p></div><div id="comment-22744-info" class="comment-info"><span class="comment-age">(08 Jul '13, 20:07)</span> cmaynard ♦♦</div></div><span id="22751"></span><div id="comment-22751" class="comment not_top_scorer"><div id="post-22751-score" class="comment-score"></div><div class="comment-text"><p>In order to deliver a consistent experience to the users, I would suggest the same limit as the one for the Display filter in the "main menu", whatever that may be.</p></div><div id="comment-22751-info" class="comment-info"><span class="comment-age">(09 Jul '13, 02:54)</span> Kurt Knochner ♦</div></div><span id="22752"></span><div id="comment-22752" class="comment not_top_scorer"><div id="post-22752-score" class="comment-score"></div><div class="comment-text"><p>Currently, there is no limit imposed.</p></div><div id="comment-22752-info" class="comment-info"><span class="comment-age">(09 Jul '13, 05:03)</span> cmaynard ♦♦</div></div></div><div id="comment-tools-22710" class="comment-tools"><span class="comments-showing"> showing 5 of 8 </span> <a href="#" class="show-all-comments-link">show 3 more comments</a></div><div class="clear"></div><div id="comment-22710-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

<div class="paginator-container-left">

</div>

</div>

</div>

