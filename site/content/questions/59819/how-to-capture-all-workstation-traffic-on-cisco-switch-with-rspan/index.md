+++
type = "question"
title = "How to capture all workstation traffic on cisco switch with RSPAN"
description = '''I have setup a remote RSPAN session to monitor all traffic to and from a specific workstations I created a RSPAN vlan 100 and configured both ports: on the source switch *monitor session 1 source interface Gix/y/z both monitor session 1 destination remote vlan 100* On the destination switch *monitor...'''
date = "2017-03-03T01:49:00Z"
lastmod = "2017-03-08T03:27:00Z"
weight = 59819
keywords = [ "vlan", "rspan" ]
aliases = [ "/questions/59819" ]
osqa_answers = 0
osqa_accepted = false
+++

<div class="headNormal">

# [How to capture all workstation traffic on cisco switch with RSPAN](/questions/59819/how-to-capture-all-workstation-traffic-on-cisco-switch-with-rspan)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-59819-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-59819-score" class="post-score" title="current number of votes">0</div><span id="post-59819-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I have setup a remote RSPAN session to monitor all traffic to and from a specific workstations</p><p>I created a RSPAN vlan 100 and configured both ports:</p><p><strong>on the source switch</strong></p><p>*monitor session 1 source interface Gix/y/z both</p><p>monitor session 1 destination remote vlan 100*</p><p><strong>On the destination switch</strong></p><p>*monitor session 1 destination interface Gia/b/c</p><p>monitor session 1 source remote vlan 100*</p><p>I had expected that all traffic coming from and going to the workstation connected to the source interface would be copied to the destination interface.</p><p>In reality it looks like all traffic from the VLAN to which the source port belongs is captured, so including the traffic between other nodes not designated for the workstation on the source port.</p><p>So it looks more like a monitor VLAN instead of monitoring Port.</p><p>I'm sure the traffic on the destination is not coming from an other source because when I disable the monitoring on my source interface, I receive no traffic at all on the destination interface.</p><p>How do I setup RSPAN to capture only the packets which are send to/from the workstation connected to the source port I know I can set up a capture filter in wireshark, but that is not what I want.</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-vlan" rel="tag" title="see questions tagged &#39;vlan&#39;">vlan</span> <span class="post-tag tag-link-rspan" rel="tag" title="see questions tagged &#39;rspan&#39;">rspan</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>03 Mar '17, 01:49</strong></p><img src="https://secure.gravatar.com/avatar/97db42a35e103c6e80c058e1674fa80e?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Jacques%20Schenk&#39;s gravatar image" /><p><span>Jacques Schenk</span><br />
<span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="3 badges"><span class="bronze">●</span><span class="badgecount">3</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Jacques Schenk has no accepted answers">0%</span></p></div><div class="post-update-info post-update-info-edited"><p><span> edited <strong>03 Mar '17, 01:51</strong> </span></p></div></div><div id="comments-container-59819" class="comments-container"><span id="59824"></span><div id="comment-59824" class="comment"><div id="post-59824-score" class="comment-score"></div><div class="comment-text"><p>These seems more like a question for the switch vendor rather than Wireshark.</p></div><div id="comment-59824-info" class="comment-info"><span class="comment-age">(03 Mar '17, 03:55)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="59829"></span><div id="comment-59829" class="comment"><div id="post-59829-score" class="comment-score"></div><div class="comment-text"><p>Can you include the output of:</p><pre><code>show vlan remote-span</code></pre></div><div id="comment-59829-info" class="comment-info"><span class="comment-age">(03 Mar '17, 07:13)</span> <span class="comment-user userinfo">naskop</span></div></div><span id="59881"></span><div id="comment-59881" class="comment"><div id="post-59881-score" class="comment-score"></div><div class="comment-text"><blockquote>Can you include the output of: show vlan remote-span</blockquote><p>Yes no problem, nothing special I can see there</p><pre><code>#sho vlan remote-span
Remote SPAN VLANs
--------------------------------------------
100
#</code></pre><p>What did you expect (not) to see ?</p><p>Jacques</p></div><div id="comment-59881-info" class="comment-info"><span class="comment-age">(07 Mar '17, 00:06)</span> <span class="comment-user userinfo">Jacques Schenk</span></div></div><span id="59882"></span><div id="comment-59882" class="comment"><div id="post-59882-score" class="comment-score"></div><div class="comment-text"><p><em>These seems more like a question for the switch vendor rather than Wireshark.</em></p><p>I also posted this question in the Cisco support forum, from the comments posted there I can only conclude that the setup is ok as it is, so I now hope to learn from the experienced people actually capturing and analyzing.</p><p>Jacques</p></div><div id="comment-59882-info" class="comment-info"><span class="comment-age">(07 Mar '17, 00:09)</span> <span class="comment-user userinfo">Jacques Schenk</span></div></div><span id="59899"></span><div id="comment-59899" class="comment"><div id="post-59899-score" class="comment-score"></div><div class="comment-text"><p>It looks like you've setup you RSPAN correctly. The other question is are you seeing all VLAN traffic or just broadcast/multicast traffic from other devices on that same vlan in addition to the client's traffic you're interested in?</p></div><div id="comment-59899-info" class="comment-info"><span class="comment-age">(07 Mar '17, 11:13)</span> <span class="comment-user userinfo">naskop</span></div></div><span id="59900"></span><div id="comment-59900" class="comment not_top_scorer"><div id="post-59900-score" class="comment-score"></div><div class="comment-text"><p>I see unicast traffic from other workstations to a server (http-TCP) for example. So it is a bit of a mystery to me why I see it ... Jacques</p></div><div id="comment-59900-info" class="comment-info"><span class="comment-age">(07 Mar '17, 11:40)</span> <span class="comment-user userinfo">Jacques Schenk</span></div></div><span id="59915"></span><div id="comment-59915" class="comment not_top_scorer"><div id="post-59915-score" class="comment-score"></div><div class="comment-text"><p>A couple of notes:</p><ol><li>Not sure what hardware you have - did you look in the Cisco bug database? Perhaps it is a known issue. rspan works as expected here in my Cisco infrastructure, and I only ever use it as you intend - from a single source interface. However, vlan tags are not carried through so I prefer local span when it is available, especially if I need to analyze trunk ports.</li><li>Is your source port a trunk port? I believe by default that monitors all vlans on that trunk.</li><li>Could there be another switch in the infrastructure that is actually putting that whole vlan on the rspan? You are managing a single interface on a specific device, but is there any way that a different device that is part of the network could have the whole vlan sent to rspan, perhaps as left over from a previous debug session? Of course if you only have two switches, then this is not likely the scenario. EDIT: you addressed this in your original post so is not likely the issue.</li><li>You may see the occasional unicast packet(s) that you should not in a layer 2 network due to switch forwarding table flushing/learning cycles. As you probably know, unicast is handled as broadcast until learning takes place. I assume you see more than a single packet or two in the unicast stream?</li></ol></div><div id="comment-59915-info" class="comment-info"><span class="comment-age">(08 Mar '17, 03:09)</span> <span class="comment-user userinfo">Bob Jones</span></div></div><span id="59916"></span><div id="comment-59916" class="comment not_top_scorer"><div id="post-59916-score" class="comment-score"></div><div class="comment-text"><p><span>@Jacques Schenk</span></p><p>Your "answers" have been converted to comments as that's how this site works. Please read the FAQ for more information.</p></div><div id="comment-59916-info" class="comment-info"><span class="comment-age">(08 Mar '17, 03:27)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div></div><div id="comment-tools-59819" class="comment-tools"><span class="comments-showing"> showing 5 of 8 </span> <a href="#" class="show-all-comments-link">show 3 more comments</a></div><div class="clear"></div><div id="comment-59819-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

</div>

