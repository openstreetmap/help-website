+++
type = "question"
title = "Multi sequence packet dissector"
description = '''I have a large TCP message that is captured by Wireshark as a sequence of packets. The message is composed of a header with parameter data followed by an image. Wireshark does not apply my dissector to the message. I would like Wireshark to apply the dissector to the first packet or two so that I ca...'''
date = "2015-05-12T06:38:00Z"
lastmod = "2015-05-12T11:57:00Z"
weight = 42330
keywords = [ "dissector", "multi-packet", "sequence" ]
aliases = [ "/questions/42330" ]
osqa_answers = 0
osqa_accepted = false
+++

<div class="headNormal">

# [Multi sequence packet dissector](/questions/42330/multi-sequence-packet-dissector)

</div>

<div id="main-body">

<div id="askform">

<table id="question-table" style="width:100%;"><colgroup><col style="width: 50%" /><col style="width: 50%" /></colgroup><tbody><tr class="odd"><td style="width: 30px; vertical-align: top"><div class="vote-buttons"><span id="post-42330-upvote" class="ajax-command post-vote up" rel="nofollow" title="I like this post (click again to cancel)"> </span><div id="post-42330-score" class="post-score" title="current number of votes">0</div><span id="post-42330-downvote" class="ajax-command post-vote down" rel="nofollow" title="I dont like this post (click again to cancel)"> </span> <span id="favorite-mark" class="ajax-command favorite-mark" rel="nofollow" title="mark/unmark this question as favorite (click again to cancel)"> </span><div id="favorite-count" class="favorite-count"></div></div></td><td><div id="item-right"><div class="question-body"><p>I have a large TCP message that is captured by Wireshark as a sequence of packets. The message is composed of a header with parameter data followed by an image. Wireshark does not apply my dissector to the message. I would like Wireshark to apply the dissector to the first packet or two so that I can see the data in the header. I'm not concerned about the image. I've done a lot of searches and looked for an option in the menus, but haven't been able to find anything that helps. Thanks for any help you can give me!</p></div><div id="question-tags" class="tags-container tags"><span class="post-tag tag-link-dissector" rel="tag" title="see questions tagged &#39;dissector&#39;">dissector</span> <span class="post-tag tag-link-multi-packet" rel="tag" title="see questions tagged &#39;multi-packet&#39;">multi-packet</span> <span class="post-tag tag-link-sequence" rel="tag" title="see questions tagged &#39;sequence&#39;">sequence</span></div><div id="question-controls" class="post-controls"></div><div class="post-update-info-container"><div class="post-update-info post-update-info-user"><p>asked <strong>12 May '15, 06:38</strong></p><img src="https://secure.gravatar.com/avatar/5d5cf9f51d27e4d48fe7eef2e33e7598?s=32&amp;d=identicon&amp;r=g" class="gravatar" width="32" height="32" alt="Vince&#39;s gravatar image" /><p><span>Vince</span><br />
<span class="score" title="6 reputation points">6</span><span title="1 badges"><span class="badge1">●</span><span class="badgecount">1</span></span><span title="1 badges"><span class="silver">●</span><span class="badgecount">1</span></span><span title="2 badges"><span class="bronze">●</span><span class="badgecount">2</span></span><br />
<span class="accept_rate" title="Rate of the user&#39;s accepted answers">accept rate:</span> <span title="Vince has no accepted answers">0%</span></p></div></div><div id="comments-container-42330" class="comments-container"><span id="42331"></span><div id="comment-42331" class="comment"><div id="post-42331-score" class="comment-score"></div><div class="comment-text"><p>How is your dissector implemented, C, Lua or something else.</p><p>What version of wireshark, and what OS.</p><p>Does your dissector ever get called?</p></div><div id="comment-42331-info" class="comment-info"><span class="comment-age">(12 May '15, 06:47)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="42332"></span><div id="comment-42332" class="comment"><div id="post-42332-score" class="comment-score"></div><div class="comment-text"><p>I am using C, Wireshark 1.10.7 on Windows 7. My dissector does not get called even though the message appears to have the correct ID.</p></div><div id="comment-42332-info" class="comment-info"><span class="comment-age">(12 May '15, 07:03)</span> <span class="comment-user userinfo">Vince</span></div></div><span id="42333"></span><div id="comment-42333" class="comment"><div id="post-42333-score" class="comment-score"></div><div class="comment-text"><p>So is your dissector registered for a particular port, or is it just heuristic?</p><p>Why such an old version of Wireshark?</p><p>What do you mean by "the message appears to have the correct ID"?</p></div><div id="comment-42333-info" class="comment-info"><span class="comment-age">(12 May '15, 07:33)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="42334"></span><div id="comment-42334" class="comment"><div id="post-42334-score" class="comment-score"></div><div class="comment-text"><p>My dissector is registered. I am seeing a number of other messages from the same device.<br />
My project started using Wireshark a while back and doesn't want to change now.<br />
The messages from my device all have an ID that I use to dissect different message types. So, the header of the message appears to be correct. Wireshark just won't operate on the first packet in the sequence.</p></div><div id="comment-42334-info" class="comment-info"><span class="comment-age">(12 May '15, 07:53)</span> <span class="comment-user userinfo">Vince</span></div></div><span id="42337"></span><div id="comment-42337" class="comment"><div id="post-42337-score" class="comment-score"></div><div class="comment-text"><p>So you can dissect some messages?</p><p>I would save a capture with both good and bad messages, and then run Wireshark with a debugger loading the saved file and see what's happening with your dissector.</p><p>Either Wireshark isn't calling your dissector, or your dissector is failing to dissect the message.</p></div><div id="comment-42337-info" class="comment-info"><span class="comment-age">(12 May '15, 10:15)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div><span id="42340"></span><div id="comment-42340" class="comment not_top_scorer"><div id="post-42340-score" class="comment-score"></div><div class="comment-text"><p>I have a capture with both good and bad messages. It dissects all other messages fine, just has a problem with the long ones. Wireshark is not calling my dissector.</p></div><div id="comment-42340-info" class="comment-info"><span class="comment-age">(12 May '15, 11:01)</span> <span class="comment-user userinfo">Vince</span></div></div><span id="42342"></span><div id="comment-42342" class="comment not_top_scorer"><div id="post-42342-score" class="comment-score"></div><div class="comment-text"><p>Are you sure it's not calling your dissector, e.g. by using a debugger or printing something out to the console, or are you just assuming?</p></div><div id="comment-42342-info" class="comment-info"><span class="comment-age">(12 May '15, 11:57)</span> <span class="comment-user userinfo">grahamb ♦</span></div></div></div><div id="comment-tools-42330" class="comment-tools"><span class="comments-showing"> showing 5 of 7 </span> <a href="#" class="show-all-comments-link">show 2 more comments</a></div><div class="clear"></div><div id="comment-42330-form-container" class="comment-form-container"></div><div class="clear"></div></div></td></tr></tbody></table>

</div>

</div>

